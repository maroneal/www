%!PS-Adobe-2.0
%%Creator: dvips(k) 5.90a Copyright 2002 Radical Eye Software
%%Title: paper.dvi
%%Pages: 25
%%PageOrder: Ascend
%%BoundingBox: 0 0 596 842
%%DocumentFonts: Palatino-Bold CMMIB10 Palatino-Roman Courier
%%+ Palatino-Italic CMMI6 CMMI10 CMMI7
%%EndComments
%DVIPSWebPage: (www.radicaleye.com)
%DVIPSCommandLine: dvips -f paper
%DVIPSParameters: dpi=600, compressed
%DVIPSSource:  TeX output 2003.07.08:1036
%%BeginProcSet: texc.pro
%!
/TeXDict 300 dict def TeXDict begin/N{def}def/B{bind def}N/S{exch}N/X{S
N}B/A{dup}B/TR{translate}N/isls false N/vsize 11 72 mul N/hsize 8.5 72
mul N/landplus90{false}def/@rigin{isls{[0 landplus90{1 -1}{-1 1}ifelse 0
0 0]concat}if 72 Resolution div 72 VResolution div neg scale isls{
landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div hsize
mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul TR[
matrix currentmatrix{A A round sub abs 0.00001 lt{round}if}forall round
exch round exch]setmatrix}N/@landscape{/isls true N}B/@manualfeed{
statusdict/manualfeed true put}B/@copies{/#copies X}B/FMat[1 0 0 -1 0 0]
N/FBB[0 0 0 0]N/nn 0 N/IEn 0 N/ctr 0 N/df-tail{/nn 8 dict N nn begin
/FontType 3 N/FontMatrix fntrx N/FontBBox FBB N string/base X array
/BitMaps X/BuildChar{CharBuilder}N/Encoding IEn N end A{/foo setfont}2
array copy cvx N load 0 nn put/ctr 0 N[}B/sf 0 N/df{/sf 1 N/fntrx FMat N
df-tail}B/dfs{div/sf X/fntrx[sf 0 0 sf neg 0 0]N df-tail}B/E{pop nn A
definefont setfont}B/Cw{Cd A length 5 sub get}B/Ch{Cd A length 4 sub get
}B/Cx{128 Cd A length 3 sub get sub}B/Cy{Cd A length 2 sub get 127 sub}
B/Cdx{Cd A length 1 sub get}B/Ci{Cd A type/stringtype ne{ctr get/ctr ctr
1 add N}if}B/id 0 N/rw 0 N/rc 0 N/gp 0 N/cp 0 N/G 0 N/CharBuilder{save 3
1 roll S A/base get 2 index get S/BitMaps get S get/Cd X pop/ctr 0 N Cdx
0 Cx Cy Ch sub Cx Cw add Cy setcachedevice Cw Ch true[1 0 0 -1 -.1 Cx
sub Cy .1 sub]/id Ci N/rw Cw 7 add 8 idiv string N/rc 0 N/gp 0 N/cp 0 N{
rc 0 ne{rc 1 sub/rc X rw}{G}ifelse}imagemask restore}B/G{{id gp get/gp
gp 1 add N A 18 mod S 18 idiv pl S get exec}loop}B/adv{cp add/cp X}B
/chg{rw cp id gp 4 index getinterval putinterval A gp add/gp X adv}B/nd{
/cp 0 N rw exit}B/lsh{rw cp 2 copy get A 0 eq{pop 1}{A 255 eq{pop 254}{
A A add 255 and S 1 and or}ifelse}ifelse put 1 adv}B/rsh{rw cp 2 copy
get A 0 eq{pop 128}{A 255 eq{pop 127}{A 2 idiv S 128 and or}ifelse}
ifelse put 1 adv}B/clr{rw cp 2 index string putinterval adv}B/set{rw cp
fillstr 0 4 index getinterval putinterval adv}B/fillstr 18 string 0 1 17
{2 copy 255 put pop}for N/pl[{adv 1 chg}{adv 1 chg nd}{1 add chg}{1 add
chg nd}{adv lsh}{adv lsh nd}{adv rsh}{adv rsh nd}{1 add adv}{/rc X nd}{
1 add set}{1 add clr}{adv 2 chg}{adv 2 chg nd}{pop nd}]A{bind pop}
forall N/D{/cc X A type/stringtype ne{]}if nn/base get cc ctr put nn
/BitMaps get S ctr S sf 1 ne{A A length 1 sub A 2 index S get sf div put
}if put/ctr ctr 1 add N}B/I{cc 1 add D}B/bop{userdict/bop-hook known{
bop-hook}if/SI save N @rigin 0 0 moveto/V matrix currentmatrix A 1 get A
mul exch 0 get A mul add .99 lt{/QV}{/RV}ifelse load def pop pop}N/eop{
SI restore userdict/eop-hook known{eop-hook}if showpage}N/@start{
userdict/start-hook known{start-hook}if pop/VResolution X/Resolution X
1000 div/DVImag X/IEn 256 array N 2 string 0 1 255{IEn S A 360 add 36 4
index cvrs cvn put}for pop 65781.76 div/vsize X 65781.76 div/hsize X}N
/p{show}N/RMat[1 0 0 -1 0 0]N/BDot 260 string N/Rx 0 N/Ry 0 N/V{}B/RV/v{
/Ry X/Rx X V}B statusdict begin/product where{pop false[(Display)(NeXT)
(LaserWriter 16/600)]{A length product length le{A length product exch 0
exch getinterval eq{pop true exit}if}{pop}ifelse}forall}{false}ifelse
end{{gsave TR -.1 .1 TR 1 1 scale Rx Ry false RMat{BDot}imagemask
grestore}}{{gsave TR -.1 .1 TR Rx Ry scale 1 1 false RMat{BDot}
imagemask grestore}}ifelse B/QV{gsave newpath transform round exch round
exch itransform moveto Rx 0 rlineto 0 Ry neg rlineto Rx neg 0 rlineto
fill grestore}B/a{moveto}B/delta 0 N/tail{A/delta X 0 rmoveto}B/M{S p
delta add tail}B/b{S p tail}B/c{-4 M}B/d{-3 M}B/e{-2 M}B/f{-1 M}B/g{0 M}
B/h{1 M}B/i{2 M}B/j{3 M}B/k{4 M}B/w{0 rmoveto}B/l{p -4 w}B/m{p -3 w}B/n{
p -2 w}B/o{p -1 w}B/q{p 1 w}B/r{p 2 w}B/s{p 3 w}B/t{p 4 w}B/x{0 S
rmoveto}B/y{3 2 roll p a}B/bos{/SS save N}B/eos{SS restore}B end

%%EndProcSet
%%BeginProcSet: 8r.enc
% File  8r.enc as of 2001-03-12 for PSNFSS 9
%
% This is the encoding vector for Type1 and TrueType fonts to be used
% with TeX.  This file is part of the PSNFSS bundle, version 9
% 
% Authors: S. Rahtz, P. MacKay, Alan Jeffrey, B. Horn, K. Berry, W. Schmidt
%
% Idea is to have all the characters normally included in Type 1 fonts
% available for typesetting. This is effectively the characters in Adobe
% Standard Encoding + ISO Latin 1 + extra characters from Lucida + Euro.
% 
% Character code assignments were made as follows:
% 
% (1) the Windows ANSI characters are almost all in their Windows ANSI
% positions, because some Windows users cannot easily reencode the
% fonts, and it makes no difference on other systems. The only Windows
% ANSI characters not available are those that make no sense for
% typesetting -- rubout (127 decimal), nobreakspace (160), softhyphen
% (173). quotesingle and grave are moved just because it's such an
% irritation not having them in TeX positions.
% 
% (2) Remaining characters are assigned arbitrarily to the lower part
% of the range, avoiding 0, 10 and 13 in case we meet dumb software.
% 
% (3) Y&Y Lucida Bright includes some extra text characters; in the
% hopes that other PostScript fonts, perhaps created for public
% consumption, will include them, they are included starting at 0x12.
% 
% (4) Remaining positions left undefined are for use in (hopefully)
% upward-compatible revisions, if someday more characters are generally
% available.
% 
% (5) hyphen appears twice for compatibility with both ASCII and Windows.
%
% (6) /Euro was assigned to 128, as in Windows ANSI
% 
/TeXBase1Encoding [
% 0x00 (encoded characters from Adobe Standard not in Windows 3.1)
  /.notdef /dotaccent /fi /fl
  /fraction /hungarumlaut /Lslash /lslash
  /ogonek /ring /.notdef
  /breve /minus /.notdef 
% These are the only two remaining unencoded characters, so may as
% well include them.
  /Zcaron /zcaron 
% 0x10
 /caron /dotlessi 
% (unusual TeX characters available in, e.g., Lucida Bright)
 /dotlessj /ff /ffi /ffl 
 /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef
 % very contentious; it's so painful not having quoteleft and quoteright
 % at 96 and 145 that we move the things normally found there down to here.
 /grave /quotesingle 
% 0x20 (ASCII begins)
 /space /exclam /quotedbl /numbersign
 /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus /comma /hyphen /period /slash
% 0x30
 /zero /one /two /three /four /five /six /seven
 /eight /nine /colon /semicolon /less /equal /greater /question
% 0x40
 /at /A /B /C /D /E /F /G /H /I /J /K /L /M /N /O
% 0x50
 /P /Q /R /S /T /U /V /W
 /X /Y /Z /bracketleft /backslash /bracketright /asciicircum /underscore
% 0x60
 /quoteleft /a /b /c /d /e /f /g /h /i /j /k /l /m /n /o
% 0x70
 /p /q /r /s /t /u /v /w
 /x /y /z /braceleft /bar /braceright /asciitilde
 /.notdef % rubout; ASCII ends
% 0x80
 /Euro /.notdef /quotesinglbase /florin
 /quotedblbase /ellipsis /dagger /daggerdbl
 /circumflex /perthousand /Scaron /guilsinglleft
 /OE /.notdef /.notdef /.notdef
% 0x90
 /.notdef /.notdef /.notdef /quotedblleft
 /quotedblright /bullet /endash /emdash
 /tilde /trademark /scaron /guilsinglright
 /oe /.notdef /.notdef /Ydieresis
% 0xA0
 /.notdef % nobreakspace
 /exclamdown /cent /sterling
 /currency /yen /brokenbar /section
 /dieresis /copyright /ordfeminine /guillemotleft
 /logicalnot
 /hyphen % Y&Y (also at 45); Windows' softhyphen
 /registered
 /macron
% 0xD0
 /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered
 /cedilla /onesuperior /ordmasculine /guillemotright
 /onequarter /onehalf /threequarters /questiondown
% 0xC0
 /Agrave /Aacute /Acircumflex /Atilde /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis
 /Igrave /Iacute /Icircumflex /Idieresis
% 0xD0
 /Eth /Ntilde /Ograve /Oacute
 /Ocircumflex /Otilde /Odieresis /multiply
 /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls
% 0xE0
 /agrave /aacute /acircumflex /atilde
 /adieresis /aring /ae /ccedilla
 /egrave /eacute /ecircumflex /edieresis
 /igrave /iacute /icircumflex /idieresis
% 0xF0
 /eth /ntilde /ograve /oacute
 /ocircumflex /otilde /odieresis /divide
 /oslash /ugrave /uacute /ucircumflex
 /udieresis /yacute /thorn /ydieresis
] def

%%EndProcSet
%%BeginProcSet: texps.pro
%!
TeXDict begin/rf{findfont dup length 1 add dict begin{1 index/FID ne 2
index/UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]/Metrics
exch def dict begin Encoding{exch dup type/integertype ne{pop pop 1 sub
dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get div def}
ifelse}forall Metrics/Metrics currentdict end def[2 index currentdict
end definefont 3 -1 roll makefont/setfont cvx]cvx def}def/ObliqueSlant{
dup sin S cos div neg}B/SlantFont{4 index mul add}def/ExtendFont{3 -1
roll mul exch}def/ReEncodeFont{CharStrings rcheck{/Encoding false def
dup[exch{dup CharStrings exch known not{pop/.notdef/Encoding true def}
if}forall Encoding{]exch pop}{cleartomark}ifelse}if/Encoding exch def}
def end

%%EndProcSet
%%BeginProcSet: special.pro
%!
TeXDict begin/SDict 200 dict N SDict begin/@SpecialDefaults{/hs 612 N
/vs 792 N/ho 0 N/vo 0 N/hsc 1 N/vsc 1 N/ang 0 N/CLIP 0 N/rwiSeen false N
/rhiSeen false N/letter{}N/note{}N/a4{}N/legal{}N}B/@scaleunit 100 N
/@hscale{@scaleunit div/hsc X}B/@vscale{@scaleunit div/vsc X}B/@hsize{
/hs X/CLIP 1 N}B/@vsize{/vs X/CLIP 1 N}B/@clip{/CLIP 2 N}B/@hoffset{/ho
X}B/@voffset{/vo X}B/@angle{/ang X}B/@rwi{10 div/rwi X/rwiSeen true N}B
/@rhi{10 div/rhi X/rhiSeen true N}B/@llx{/llx X}B/@lly{/lly X}B/@urx{
/urx X}B/@ury{/ury X}B/magscale true def end/@MacSetUp{userdict/md known
{userdict/md get type/dicttype eq{userdict begin md length 10 add md
maxlength ge{/md md dup length 20 add dict copy def}if end md begin
/letter{}N/note{}N/legal{}N/od{txpose 1 0 mtx defaultmatrix dtransform S
atan/pa X newpath clippath mark{transform{itransform moveto}}{transform{
itransform lineto}}{6 -2 roll transform 6 -2 roll transform 6 -2 roll
transform{itransform 6 2 roll itransform 6 2 roll itransform 6 2 roll
curveto}}{{closepath}}pathforall newpath counttomark array astore/gc xdf
pop ct 39 0 put 10 fz 0 fs 2 F/|______Courier fnt invertflag{PaintBlack}
if}N/txpose{pxs pys scale ppr aload pop por{noflips{pop S neg S TR pop 1
-1 scale}if xflip yflip and{pop S neg S TR 180 rotate 1 -1 scale ppr 3
get ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg TR}if xflip
yflip not and{pop S neg S TR pop 180 rotate ppr 3 get ppr 1 get neg sub
neg 0 TR}if yflip xflip not and{ppr 1 get neg ppr 0 get neg TR}if}{
noflips{TR pop pop 270 rotate 1 -1 scale}if xflip yflip and{TR pop pop
90 rotate 1 -1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0 get
neg sub neg TR}if xflip yflip not and{TR pop pop 90 rotate ppr 3 get ppr
1 get neg sub neg 0 TR}if yflip xflip not and{TR pop pop 270 rotate ppr
2 get ppr 0 get neg sub neg 0 S TR}if}ifelse scaleby96{ppr aload pop 4
-1 roll add 2 div 3 1 roll add 2 div 2 copy TR .96 dup scale neg S neg S
TR}if}N/cp{pop pop showpage pm restore}N end}if}if}N/normalscale{
Resolution 72 div VResolution 72 div neg scale magscale{DVImag dup scale
}if 0 setgray}N/psfts{S 65781.76 div N}N/startTexFig{/psf$SavedState
save N userdict maxlength dict begin/magscale true def normalscale
currentpoint TR/psf$ury psfts/psf$urx psfts/psf$lly psfts/psf$llx psfts
/psf$y psfts/psf$x psfts currentpoint/psf$cy X/psf$cx X/psf$sx psf$x
psf$urx psf$llx sub div N/psf$sy psf$y psf$ury psf$lly sub div N psf$sx
psf$sy scale psf$cx psf$sx div psf$llx sub psf$cy psf$sy div psf$ury sub
TR/showpage{}N/erasepage{}N/setpagedevice{pop}N/copypage{}N/p 3 def
@MacSetUp}N/doclip{psf$llx psf$lly psf$urx psf$ury currentpoint 6 2 roll
newpath 4 copy 4 2 roll moveto 6 -1 roll S lineto S lineto S lineto
closepath clip newpath moveto}N/endTexFig{end psf$SavedState restore}N
/@beginspecial{SDict begin/SpecialSave save N gsave normalscale
currentpoint TR @SpecialDefaults count/ocount X/dcount countdictstack N}
N/@setspecial{CLIP 1 eq{newpath 0 0 moveto hs 0 rlineto 0 vs rlineto hs
neg 0 rlineto closepath clip}if ho vo TR hsc vsc scale ang rotate
rwiSeen{rwi urx llx sub div rhiSeen{rhi ury lly sub div}{dup}ifelse
scale llx neg lly neg TR}{rhiSeen{rhi ury lly sub div dup scale llx neg
lly neg TR}if}ifelse CLIP 2 eq{newpath llx lly moveto urx lly lineto urx
ury lineto llx ury lineto closepath clip}if/showpage{}N/erasepage{}N
/setpagedevice{pop}N/copypage{}N newpath}N/@endspecial{count ocount sub{
pop}repeat countdictstack dcount sub{end}repeat grestore SpecialSave
restore end}N/@defspecial{SDict begin}N/@fedspecial{end}B/li{lineto}B
/rl{rlineto}B/rc{rcurveto}B/np{/SaveX currentpoint/SaveY X N 1
setlinecap newpath}N/st{stroke SaveX SaveY moveto}N/fil{fill SaveX SaveY
moveto}N/ellipse{/endangle X/startangle X/yrad X/xrad X/savematrix
matrix currentmatrix N TR xrad yrad scale 0 0 1 startangle endangle arc
savematrix setmatrix}N end

%%EndProcSet
%%BeginFont: CMMI7
%!PS-AdobeFont-1.1: CMMI7 1.100
%%CreationDate: 1996 Jul 23 07:53:53
% Copyright (C) 1997 American Mathematical Society. All Rights Reserved.
11 dict begin
/FontInfo 7 dict dup begin
/version (1.100) readonly def
/Notice (Copyright (C) 1997 American Mathematical Society. All Rights Reserved) readonly def
/FullName (CMMI7) readonly def
/FamilyName (Computer Modern) readonly def
/Weight (Medium) readonly def
/ItalicAngle -14.04 def
/isFixedPitch false def
end readonly def
/FontName /CMMI7 def
/PaintType 0 def
/FontType 1 def
/FontMatrix [0.001 0 0 0.001 0 0] readonly def
/Encoding 256 array
0 1 255 {1 index exch /.notdef put} for
dup 99 /c put
dup 118 /v put
readonly def
/FontBBox{0 -250 1171 750}readonly def
/UniqueID 5087382 def
currentdict end
currentfile eexec
D9D66F633B846A97B686A97E45A3D0AA0529731C99A784CCBE85B4993B2EEBDE
3B12D472B7CF54651EF21185116A69AB1096ED4BAD2F646635E019B6417CC77B
532F85D811C70D1429A19A5307EF63EB5C5E02C89FC6C20F6D9D89E7D91FE470
B72BEFDA23F5DF76BE05AF4CE93137A219ED8A04A9D7D6FDF37E6B7FCDE0D90B
986423E5960A5D9FBB4C956556E8DF90CBFAEC476FA36FD9A5C8175C9AF513FE
D919C2DDD26BDC0D99398B9F4D03D77639DF1232A4D6233A9CAF69B151DFD33F
C0962EAC6E3EBFB8AD256A3C654EAAF9A50C51BC6FA90B61B60401C235AFAB7B
B078D20B4B8A6D7F0300CF694E6956FF9C29C84FCC5C9E8890AA56B1BC60E868
DA8488AC4435E6B5CE34EA88E904D5C978514D7E476BF8971D419363125D4811
4D886EDDDCDDA8A6B0FDA5CF0603EA9FA5D4393BEBB26E1AB11C2D74FFA6FEE3
FAFBC6F05B801C1C3276B11080F5023902B56593F3F6B1F37997038F36B9E3AB
76C2E97E1F492D27A8E99F3E947A47166D0D0D063E4E6A9B535DC9F1BED129C5
123775D5D68787A58C93009FD5DA55B19511B95168C83429BD2D878207C39770
012318EA7AA39900C97B9D3859E3D0B04750B8390BF1F1BC29DC22BCAD50ECC6
A3C633D0937A59E859E5185AF9F56704708D5F1C50F78F43DFAC43C4E7DC9413
44CEFE43279AFD3C167C942889A352F2FF806C2FF8B3EB4908D50778AA58CFFC
4D1B14597A06A994ED8414BBE8B26E74D49F6CF54176B7297CDA112A69518050
01337CBA5478EB984CDD22020DAED9CA8311C33FBCC84177F5CE870E709FC608
D28B3A7208EFF72988C136142CE79B4E9C7B3FE588E9824ABC6F04D141E589B3
914A73A42801305439862414F893D5B6C327A7EE2730DEDE6A1597B09C258F05
261BC634F64C9F8477CD51634BA648FC70F659C90DC042C0D6B68CD1DF36D615
24F362B85A58D65A8E6DFD583EF9A79A428F2390A0B5398EEB78F4B5A89D9AD2
A517E0361749554ABD6547072398FFDD863E40501C316F28FDDF8B550FF8D663
9843D0BEA42289F85BD844891DB42EC7C51229D33EE7E83B1290404C799B8E8C
889787CDC0C51802EA1E0C63E6DE20980D3DD206F0536AC73ADA90E29CD93266
DAB3ED549EE4E324B7883BAE98EF717EB14A3ECDC09AE2771BC89C1B7A6C58B9
8C8C3BCD2FDD7DC9DBE4643E29AFAF5FB550054100FC3356905DC7E5E47F7867
4A4EB440160B8411EC4ED8498670279FD7BAACAE483B4E81E7EBCBA1219BD386
2E27E6996762B7921ACAFC03D19A661048D90D890A83D30479E9AA904BC634EA
2E38C42A9429C3F7C9239973B50E30DA64477B0A4063DBB976BD47FB0830E21C
3CD23083C1A8DB9769B42482A159AC12203BB621751BD267D3C12B01B50967D0
2AB34AD1E1CAEEF5F2F057E0DA8DF24D9FDF62ABE7A3A1648658F64FBB4BD02A
31B73C5064E43B2A342A3913A41A9FFEE232EFB06E0CE9441C8CE2004F86E343
E823FE9BE0A8CAA2A9EFDDF61BBBFDBC0A0D37CE522A8FE69BDA880539295E1D
7F5BE408F6C99EAB65E71E847EC2BEB70E1622E823268811C1FF2E0A37DA6C3F
B7EAFBCF080FD95CD5F336D96C7B2E35CEB58F786B37D7CAFC73B2E82AAA88D3
063497C08A8D60C683841AE7667F0CDB6ADE22BB126CB02DEEA16365D771E316
8EBDBA2A637050B4FC70C905468FD4349CBC253C6955ABE5A9E624CEBA7718D9
15DB2602389D
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
cleartomark
%%EndFont 
%%BeginFont: CMMI10
%!PS-AdobeFont-1.1: CMMI10 1.100
%%CreationDate: 1996 Jul 23 07:53:57
% Copyright (C) 1997 American Mathematical Society. All Rights Reserved.
11 dict begin
/FontInfo 7 dict dup begin
/version (1.100) readonly def
/Notice (Copyright (C) 1997 American Mathematical Society. All Rights Reserved) readonly def
/FullName (CMMI10) readonly def
/FamilyName (Computer Modern) readonly def
/Weight (Medium) readonly def
/ItalicAngle -14.04 def
/isFixedPitch false def
end readonly def
/FontName /CMMI10 def
/PaintType 0 def
/FontType 1 def
/FontMatrix [0.001 0 0 0.001 0 0] readonly def
/Encoding 256 array
0 1 255 {1 index exch /.notdef put} for
dup 17 /eta put
dup 21 /lambda put
dup 105 /i put
dup 110 /n put
dup 115 /s put
readonly def
/FontBBox{-32 -250 1048 750}readonly def
/UniqueID 5087385 def
currentdict end
currentfile eexec
D9D66F633B846A97B686A97E45A3D0AA0529731C99A784CCBE85B4993B2EEBDE
3B12D472B7CF54651EF21185116A69AB1096ED4BAD2F646635E019B6417CC77B
532F85D811C70D1429A19A5307EF63EB5C5E02C89FC6C20F6D9D89E7D91FE470
B72BEFDA23F5DF76BE05AF4CE93137A219ED8A04A9D7D6FDF37E6B7FCDE0D90B
986423E5960A5D9FBB4C956556E8DF90CBFAEC476FA36FD9A5C8175C9AF513FE
D919C2DDD26BDC0D99398B9F4D03D5993DFC0930297866E1CD0A319B6B1FD958
9E394A533A081C36D456A09920001A3D2199583EB9B84B4DEE08E3D12939E321
990CD249827D9648574955F61BAAA11263A91B6C3D47A5190165B0C25ABF6D3E
6EC187E4B05182126BB0D0323D943170B795255260F9FD25F2248D04F45DFBFB
DEF7FF8B19BFEF637B210018AE02572B389B3F76282BEB29CC301905D388C721
59616893E774413F48DE0B408BC66DCE3FE17CB9F84D205839D58014D6A88823
D9320AE93AF96D97A02C4D5A2BB2B8C7925C4578003959C46E3CE1A2F0EAC4BF
8B9B325E46435BDE60BC54D72BC8ACB5C0A34413AC87045DC7B84646A324B808
6FD8E34217213E131C3B1510415CE45420688ED9C1D27890EC68BD7C1235FAF9
1DAB3A369DD2FC3BE5CF9655C7B7EDA7361D7E05E5831B6B8E2EEC542A7B38EE
03BE4BAC6079D038ACB3C7C916279764547C2D51976BABA94BA9866D79F13909
95AA39B0F03103A07CBDF441B8C5669F729020AF284B7FF52A29C6255FCAACF1
74109050FBA2602E72593FBCBFC26E726EE4AEF97B7632BC4F5F353B5C67FED2
3EA752A4A57B8F7FEFF1D7341D895F0A3A0BE1D8E3391970457A967EFF84F6D8
47750B1145B8CC5BD96EE7AA99DDC9E06939E383BDA41175233D58AD263EBF19
AFC0E2F840512D321166547B306C592B8A01E1FA2564B9A26DAC14256414E4C8
42616728D918C74D13C349F4186EC7B9708B86467425A6FDB3A396562F7EE4D8
40B43621744CF8A23A6E532649B66C2A0002DD04F8F39618E4F572819DD34837
B5A08E643FDCA1505AF6A1FA3DDFD1FA758013CAED8ACDDBBB334D664DFF5B53
956017667271C1FD06DBA26AC7504FCD81979D968F25EE6F5A63BFEB5644503A
565E3AE376B35638F2F420A682C0976CD2EDFD199C33833CFCCCE166FC1A95E0
C8199ECAD5831C619A1322F51361FC6017A3D638E9CE9CB71B16AD1C963DBFB1
57E9415FA2AF81086C2F4926E08C458565A54902BA6974131C10CBA679056445
180AAAFAE67390108BB23BA3042CFEFDD1302EA3C7CA0623BC8AE4116B1AD6D2
2E0AF0158AC5DC37FA03385623B9C1E7BFE1A72B9E47783F7F5459864A6B96A4
662F532B330A0BEE128B7E8DC8FA039BA0BCC5ABF5909E633DF8FA3F26298268
6E2AFD0FE0C5E2735C5FAA0410D0A59E22F57BEC3F8E68D2E2D2CE56CEC268C6
BB45168BBF5EF0ACF8D11464FD0A5851E2798578103EA0FA574687A76115CB21
60C2F28A7D3F2EEFE708E92FCDCFEDA4F96E1A810ED59634AD7331B20B4AC0D7
013B4CA86F98DB66D559E136F142E45D1D9BE8ADE0090E7D12863E8B304A1C8E
AA09F46EF5B67B912113559CEFF45A07B46BB497DCCEFB6AD5239B7815942F3C
7E05BB6973D0B03DD4BE37987F8AB9E7E3264A8069B57834C0194EC66981A22A
AE145B18ADA834FF9E91081D00A8B792D5D4AFAEB8A81AB03BCC6B5FA0CEA3C6
3BA1140FDDCCC0919A1FD637D4DFA8CE190DF427D6B41A85476CC2623CCBCE09
C4D0F58B700CEB456B2F3631B24D985DFB2659B9BA9F252C3E59A02905990FFE
30085291D256CD714E166F5AC93BB0E14DA3C7B853F7CD1A61F85A770DB2D484
2724F845111943008AB24751A421AAF1B364614E13E935D6A5B7885702C0D4C0
6E2DBD5EE001941941C99502D4BEA22E128565A004B12CE610A79B2F4540360E
BD90B76C780E63AB638ADA40D461BDAFAC0BF56508C6615A2801D0C7BBEC581D
033613A3D892B49F79474F85DCE4D99C1DE2B503D65D563152160B5D5D0DC0FC
9FA692483C7F684D52E12715F0443F57B12DE5904B4D77399D6FDC250B9548A3
53E79F28E6C160A6FB2F8AACA6283ED76BC5C75439972AEF0AE5BD53F1B0331C
0D2408582A0A2AF39BBAD529143C147EBE84A44CF12819AAD35F19EEC07BD427
D40DC12E10B9F9B68679BFFE0B12CA55A215847AD9EA4D969ACED60282C1408D
AA473EACD68A086661A6BF3FE1931A74840551EB925B169755081867408AB99F
DEF6A70D7397FF0F95112C41C17C75BB9AECD195FA5D0BFA977331FBBE545523
FBEDDCBB281B6C5073B06698EF2B5866E99130E7624AFC3EA7BE7E67F252539E
880A1D36A5F4EF055F626EA9AEF78C60C708EA31D5DF0FCF777F18206BD52876
1FFF2D00828F833031526163F6D581427DF765749EEE9B3E19268E9271AF8952
C9216F7F797167C1C04A312D0371062C6306E319B9B387A22A0329CBC2AE3E73
E64EC1B4CA65F680965F4B0A8CCB711A40D9D9B3F954804DDEF9AEC40B2A3566
BBDB5FA9DF103838F8E93A54B6C7D0822577E19A6F2C17C62CEC73F1A979DF0D
E2F8B9C282AB4EB37C0EDF7CBF054EC46D2E568E8608646B76D50E1D2DF6769A
84DD9548051600059062B3EEFCD0F1D75A7E5CEF40C8F72734B1B62CB3DC5403
14
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
cleartomark
%%EndFont 
%%BeginFont: CMMI6
%!PS-AdobeFont-1.1: CMMI6 1.100
%%CreationDate: 1996 Jul 23 07:53:52
% Copyright (C) 1997 American Mathematical Society. All Rights Reserved.
11 dict begin
/FontInfo 7 dict dup begin
/version (1.100) readonly def
/Notice (Copyright (C) 1997 American Mathematical Society. All Rights Reserved) readonly def
/FullName (CMMI6) readonly def
/FamilyName (Computer Modern) readonly def
/Weight (Medium) readonly def
/ItalicAngle -14.04 def
/isFixedPitch false def
end readonly def
/FontName /CMMI6 def
/PaintType 0 def
/FontType 1 def
/FontMatrix [0.001 0 0 0.001 0 0] readonly def
/Encoding 256 array
0 1 255 {1 index exch /.notdef put} for
dup 63 /star put
readonly def
/FontBBox{11 -250 1241 750}readonly def
/UniqueID 5087381 def
currentdict end
currentfile eexec
D9D66F633B846A97B686A97E45A3D0AA0529731C99A784CCBE85B4993B2EEBDE
3B12D472B7CF54651EF21185116A69AB1096ED4BAD2F646635E019B6417CC77B
532F85D811C70D1429A19A5307EF63EB5C5E02C89FC6C20F6D9D89E7D91FE470
B72BEFDA23F5DF76BE05AF4CE93137A219ED8A04A9D7D6FDF37E6B7FCDE0D90B
986423E5960A5D9FBB4C956556E8DF90CBFAEC476FA36FD9A5C8175C9AF513FE
D919C2DDD26BDC0D99398B9F4D03D6A8F05B47AF95EF28A9C561DBDC98C47CF5
5250011D19E9366EB6FD153D3A100CAA6212E3D5D93990737F8D326D347B7EDC
4391C9DF440285B8FC159D0E98D4258FC57892DDF0342CA1080743A076089583
6AD6FB2DC4C13F077F17789476E48402796E685107AF60A63FB0DE0266D55CF1
8D0AD65B9342CB686E564758C96164FFA711B11C1CE8C726F3C7BB1044BBD283
9AA4675747DF61E130A55E297CA5F0182A3F12F9085AF2F503481071724077A9
387E27879A9649AD5F186F33500FAC8F7FA26634BDCE1221EC0ED0E359E5EA5E
6166526FEB90C30D30099FBDC1BC2F9B62EFEEC48345160804AA98F8D0AA54B7
A480E715426651865C8E444EDB798C7E11040AF6E5A7ED1888653C6DBF5E6169
70BCD9C063B63B561EF165BF3AF11F8E519F37C6FDA2827685739DE2C48B5ADE
EE84F067D704D4511DBFA49E166D543CFD9ECD7417055D8A827F51E087CD2927
BAFC7E6CFBD70B0FE969F890A11149D3D44D422C3370495DA9951AEE7253A49F
3A9444C8CD9158D84117299F7F2332FEB0F94E6ED8BC7AA789A3219BC2F227D3
3B5BC75FB53B55D72AF4A6A7BB613FA235B11BB37D059FD87127CEF73D5B3FBF
9F91ABAD78BD9240BD9525EBA78095EA0BDB25D1A19E876F292882EAD5619D46
D20317A345D931F4FF4EAE6216C27044CBA525E3B917CEA25A04C120466C4B93
FC720E6BA832A06CCA0A3916CEF0968D49085AEBD243C41A448289A6F05CE3F5
79148DC112A3CC7E8FF810B8C1A09E05F496C0F1EBA334E42E05C376C98F5F69
C06C71BFC0A2F3AC9951CFBB143C66FB84F9C4ED27DF70869352D61BD5E11508
0797B87C71AC58D7C35AB3247575482E538773F05A105BA2F674E97E391392EC
F80CB2FBB7CA980255ACD0096E51EB8EE24EE47DBF332E73A4D4289A467C5CB9
6B6FCE9B3667271C41EC1FFB54BE06798F122BA17B36EB29455443EFEBCC170C
FB2E43BBA892DEC342FBFE5702E8A8CB31B4396AD759CB316A470EFB0A64F1AA
18F34F4565035447B6B803EB8673DF2A9BD4458AF4473011F836497E83B81980
7F27B554EE4176D147429B4C697B427A9508C41936901C4BC90C30B462374482
1F140DC21B9ED3B27D578B4B2E5D35CFEF4387D87CD7B46970E007BF076CE620
78A547FFD36ECFCDA0C0124E163615966B5F2EE1EAE6CACFA91CEE799306F154
9B255E81C6EDFDBC95881F6D4748CF659A139A94A449C5E45F496BC9B2EFAFC2
E7C1CD4EEDA952D1819DAC0FA999E9EC6BFB8930D54321E3A1F64732A0EACEF9
A757FD60D80A32B62C0D0FE50E87DC17392FCF5B
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
cleartomark
%%EndFont 
%%BeginFont: CMMIB10
%!PS-AdobeFont-1.1: CMMIB10 1.100
%%CreationDate: 1996 Jul 23 07:54:00
% Copyright (C) 1997 American Mathematical Society. All Rights Reserved.
11 dict begin
/FontInfo 7 dict dup begin
/version (1.100) readonly def
/Notice (Copyright (C) 1997 American Mathematical Society. All Rights Reserved) readonly def
/FullName (CMMIB10) readonly def
/FamilyName (Computer Modern) readonly def
/Weight (Bold) readonly def
/ItalicAngle -14.04 def
/isFixedPitch false def
end readonly def
/FontName /CMMIB10 def
/PaintType 0 def
/FontType 1 def
/FontMatrix [0.001 0 0 0.001 0 0] readonly def
/Encoding 256 array
0 1 255 {1 index exch /.notdef put} for
dup 63 /star put
readonly def
/FontBBox{-15 -250 1216 750}readonly def
/UniqueID 5087392 def
currentdict end
currentfile eexec
D9D66F633B846A97B686A97E45A3D0AA0529731C99A784CCBE85B4993B2EEBDE
3B12D472B7CF54651EF21185116A69AB1096ED4BAD2F646635E019B6417CC77B
532F85D811C70D1429A19A5307EF63EB5C5E02C89FC6C20F6D9D89E7D91FE470
B72BEFDA23F5DF76BE05AF4CE93137A219ED8A04A9D7D6FDF37E6B7FCDE0D90B
986423E5960A5D9FBB4C956556E8DF90CBFAEC476FA36FD9A5C8175C9AF513FE
D919C2DDD26BDC0D99398B9F4D004B836D34E88C25F6CE738846C8E2E59A2BCF
4ACF80A26D78872E9343A0537BC3BD7715F32ACD958D5AAED865BFE129278935
063A31C2634DE2F9077E0AAAAEB224466B779096D8E3FF0A12AD5157F6603DED
1A82F3511359143311179080C510740B401C930C96270FD1AB3ECBCFEF5DE53F
E846BAAE95828D5790922640EF8AB9D7CEBE7669FEA02B72F86872D3D8754A18
A1629C40A7C00C956F140BC63362478279C36EE353638CD3E249897207A94504
4400668C8E702058EBF7284C9BDF830A3FC79C7EE900CC4C3664F9767A237275
CEE3671644A75F1E696DA906B4C66870DBE87F5B4A176920C078ADBE24F55C09
3D18CDE21B5FBC1C6A8AB18E05EDBEF9D1C1C18B3E6377BA2A688579D4F708F9
A5CF4F56C5E39E2726106E9713E638775E606464CD674E5DC25CE9A696A65806
C8E9D206B421E246F18013ACC6C7B2985BA93B1B7D7745CCB25B09957F50128C
B523A55ACA6A7A2A0193A536E590291ED9D577B527CAD0372E05BFCA1829FED1
662D06144A5FFA628C587A4FA05B179F1A7E3B23B47765FDC054271A0DBF9C2B
B4F4771F80D1F7AAD9024868C30DAD5CF728DB2A71D86D53B0E674996E8C01F7
EF97B225A28872F8AD4752A466E078C2B020EB832F237CB9B5631EB2D2EDDB00
709D3864CA3A6C3EF18085EAEABC011E9F35C9BE4B5D0B608361F329B5784DAC
5557A602E9E3C204909D84DB988F0BAB914E87CD685C7DA55C5E0B9F0176184F
FC39B570873BBF346A0D1DE3942DA05434949A65CE64D8BAB0A091C40F7FF47A
4FC57CB4420221C7B3EB8B891044B5FB0227009F0F6028D3F28545E63C975F11
6BCCB67C58A544AE706BA5309FE391816985AF4604732D2B7E4FC947AD9F29C6
2858ED5A9824C2915162453046790D522BFFB881ED8F0062D056722A2C8926BD
A33AE1A7D5EEFEDA8A86A78433FF239D5F2D86F992C0185EF15A0163A628A238
87F9840BDF26E48AAD35DD0C167FF38D5B79ECBBD7B979DEBF71637081E4E6FF
F0254425900735A94CD403F46B7C86DA97AB3DBEF2B96778670FC35AE8505ED8
90CB2001B067456419D278B2519062A9E49F703BCAF1D4FC03A460063745D434
F1FA3EEDC0A0F87EEEE6FAF906D40E292B67EBFE4FB76F60C73EF72A8FC3CD5C
FD18FAC6150B6147E1973FEB7BC1656BE667A5FABD016DD4978ECDC06B0D5246
0CD9FB08BE8EEBF4E17EDE9EC0DDAFADF98894E1F8F4F30770D47FE68D912591
6CD81D2B42B3972955DDF84CC6D60E83643C478952A9AA1BEDEF4B45860E1C8E
8F191A3C1378E75350B7E217F83348C43BF7ECC0F76AB946DB13586DF26CE6D4
688261
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
cleartomark
%%EndFont 
TeXDict begin 39158280 55380996 1000 600 600 (paper.dvi)
@start /Fa 134[37 37 1[37 42 25 29 29 35 37 33 42 58
21 33 21 21 37 37 21 29 37 30 35 33 12[46 42 2[46 58
58 71 42 2[25 58 54 42 46 58 50 46 54 6[19 37 2[37 37
1[37 37 37 37 1[19 25 19 2[25 25 21 39[{TeXBase1Encoding ReEncodeFont}
54 74.7198 /Palatino-Italic rf /Fb 165[40 40 2[43 47
37 31 40 2[47 50 57 37 43 1[20 50 46 33 37 46 42 37 47
65[{TeXBase1Encoding ReEncodeFont}21 59.7758 /Palatino-Roman
rf /Fc 137[33 18[30 99[{}2 58.1154 /CMMI7 rf /Fd 140[39
4[50 4[29 83[48 3[41 17[{}5 83.022 /CMMI10 rf /Fe 203[25
25 25 25 49[{TeXBase1Encoding ReEncodeFont}4 49.8132
/Palatino-Roman rf /Ff 203[29 29 29 29 49[{
TeXBase1Encoding ReEncodeFont}4 58.1154 /Palatino-Roman
rf /Fg 192[32 63[{}1 49.8132 /CMMI6 rf /Fh 103[50 30[50
50 50 50 50 50 50 50 1[50 50 50 50 50 50 1[50 50 50 50
50 1[50 50 50 1[50 1[50 1[50 1[50 5[50 4[50 7[50 1[50
5[50 50 50 2[50 50 50 50 50 50 50 50 50 50 50 50 50 50
50 50 50 50 50 3[50 50 50 33[{TeXBase1Encoding ReEncodeFont}56
83.022 /Courier rf /Fi 105[42 27[42 46 42 69 46 51 28
37 32 1[51 46 51 74 28 2[28 1[46 32 42 51 37 51 42 9[83
1[65 1[51 60 1[51 69 1[83 51 2[32 69 69 1[51 69 60 55
65 1[37 5[42 42 42 42 42 42 42 42 42 2[21 28 45[{
TeXBase1Encoding ReEncodeFont}51 83.022 /Palatino-Bold
rf /Fj 107[42 42 24[37 42 42 60 42 46 28 32 32 1[42 37
46 65 23 37 23 23 42 42 23 32 42 34 38 37 9[78 2[51 46
55 1[51 65 1[78 3[28 65 2[51 1[55 51 60 1[42 4[21 12[28
21 2[28 28 37[44 2[{TeXBase1Encoding ReEncodeFont}47
83.022 /Palatino-Italic rf /Fk 139[25 33 29 14[33 46
37 31[58 18[19 46[{TeXBase1Encoding ReEncodeFont}8 74.7198
/Palatino-Bold rf /Fl 103[45 27[45 1[45 45 45 45 45 45
45 45 45 1[45 45 45 45 45 45 1[45 45 45 45 45 45 45 45
45 1[45 1[45 1[45 1[45 2[45 1[45 45 2[45 1[45 45 1[45
1[45 4[45 2[45 45 1[45 45 45 45 45 45 45 45 45 45 45
45 45 45 45 45 45 45 45 45 45 45 45 45 3[45 45 45 33[{
TeXBase1Encoding ReEncodeFont}68 74.7198 /Courier rf
/Fm 87[25 17[37 1[37 37 24[37 42 39 62 42 45 24 32 30
42 45 41 43 66 22 42 17 22 43 42 25 36 46 33 41 37 3[25
1[25 50 50 50 75 54 58 46 39 50 1[45 59 62 71 46 54 25
25 62 57 42 46 58 53 46 58 6[19 37 37 37 37 37 37 37
37 37 37 1[19 25 19 2[25 25 36[45 45 2[{TeXBase1Encoding ReEncodeFont}
75 74.7198 /Palatino-Roman rf /Fn 104[83 2[42 42 24[42
46 43 69 47 50 27 35 33 46 50 45 48 73 24 46 19 24 48
46 28 40 51 37 46 42 23 2[28 1[28 1[55 1[83 1[65 51 44
55 1[50 65 69 79 51 60 28 28 69 63 46 51 64 59 51 65
1[37 1[50 2[21 42 42 42 42 42 42 42 42 42 42 50 21 28
21 50 1[28 28 23 1[70 33[50 50 2[{TeXBase1Encoding ReEncodeFont}78
83.022 /Palatino-Roman rf /Fo 134[55 3[61 33 44 39 2[55
61 89 33 2[33 61 55 39 50 61 44 1[50 13[61 72 1[61 2[100
3[39 4[83 72 16[50 50 6[44 42[{TeXBase1Encoding ReEncodeFont}27
99.6264 /Palatino-Bold rf /Fp 192[48 63[{}1 83.022 /CMMIB10
rf /Fq 138[73 40 53 47 2[66 73 106 40 2[40 1[66 1[60
73 53 1[60 16[73 2[120 3[47 1[100 5[93 19[40 45[{
TeXBase1Encoding ReEncodeFont}20 119.552 /Palatino-Bold
rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
%%PaperSize: A4
 end
%%EndSetup
%%Page: 1 1
TeXDict begin 1 0 bop 542 451 a Fq(A)30 b(Gentle)e(Introduction)i(to)g
(Multi-stage)f(Programming)3334 408 y Fp(?)1489 603 y
Fo(*)d(Preliminary)e(Draft)g(*)1758 891 y Fn(W)-8 b(alid)21
b(T)-8 b(aha)817 1065 y Fm(Department)20 b(of)e(Computer)g(Science,)h
(Rice)f(University)-8 b(,)17 b(Houston,)i(TX,)f(USA)1673
1157 y Fl(taha@rice.edu)759 1489 y Fk(Abstract.)42 b
Fm(Multi-stage)18 b(pr)o(ogramming)f(\(MSP\))i(is)g(a)g(paradigm)g(for)
f(developing)759 1580 y(generic)29 b(softwar)o(e)g(that)j(does)d(not)h
(pay)g(a)g(r)o(untime)g(penalty)g(for)f(this)i(general-)759
1672 y(ity)-8 b(.)27 b(This)g(is)f(achieved)i(thr)o(ough)f(concisely)-8
b(,)26 b(car)o(efully)g(designed)f(language)i(ex-)759
1763 y(tensions)h(that)h(support)d(r)o(untime)i(code)f(generation)g
(and)h(pr)o(ogram)d(execution.)759 1854 y(Additionally)-8
b(,)23 b(type)g(systems)g(for)h(MSP)g(languages)f(ar)o(e)h(designed)e
(to)j(statically)759 1946 y(ensur)o(e)18 b(that)j(dynamically)e
(generated)f(pr)o(ograms)g(ar)o(e)g(type)h(safe)g(\(and)g(ther)o(efor)o
(e)759 2037 y(r)o(equir)o(e)d(no)j(type)g(checking)f(after)h(they)g(ar)
o(e)f(generated\).)759 2128 y(This)d(tutorial)g(is)g(aimed)f(at)i(the)g
(r)o(eader)d(inter)o(ested)h(in)h(learning)g(the)h(basics)f(of)g(MSP)
759 2219 y(practice)22 b(and)h(r)o(esear)o(ch.)d(The)i(tutorial)g(is)f
(br)o(oken)g(into)h(two)h(parts.)e(The)h(\002rst)g(is)f(a)759
2310 y(hands-on)j(intr)o(oduction)f(to)h(MSP)f(in)g(the)h(context)g(of)
f(an)h(MSP)f(language)g(called)759 2402 y(MetaOCaml.)d(The)f(second)h
(is)f(an)h(intr)o(oduction)g(to)g(r)o(esear)o(ch)e(in)i(this)g(ar)o
(ea,)f(and)h(a)759 2493 y(number)f(of)f(important)i(curr)o(ent)e(r)o
(esear)o(ch)f(challenges.)523 2771 y Fo(1)99 b(Introduction)523
2968 y Fn(Although)30 b(pr)o(ogram)f(generation)g(has)g(been)g(shown)i
(to)e(impr)o(ove)g(code)g(r)o(euse,)f(pr)o(od-)523 3067
y(uct)j(r)o(eliability)f(and)g(maintainability)-9 b(,)31
b(performance)e(and)h(r)o(esour)o(ce)g(utilization,)g(and)523
3167 y(developer)g(pr)o(oductivity)-9 b(,)29 b(ther)o(e)h(is)g(little)h
(support)g(for)f Fj(writing)g Fn(generators)g(in)h(main-)523
3267 y(str)o(eam)d(languages)h(such)g(as)g(C)g(or)g(Java.)e(Y)-8
b(et)30 b(a)e(host)i(of)f(basic)g(pr)o(oblems)f(inher)o(ent)h(in)523
3366 y(pr)o(ogram)24 b(generation)g(can)g(be)g(addr)o(essed)f(ef)o
(fectively)f(by)j(a)f(pr)o(ogramming)g(language)523 3466
y(designed)d(speci\002cally)f(to)h(support)g(writing)h(generators.)523
3712 y Fi(1.1)82 b(Basic)20 b(Problems)f(in)h(Building)g(Program)h
(Generators)523 3875 y Fn(In)e(a)f(general-purpose)g(language,)g(we)h
(typically)g(r)o(epr)o(esent)e(the)i(pr)o(ogram)f(\(fragments\))523
3975 y(we)30 b(want)h(to)f(generate)g(as)g(either)g(strings)h(or)g
(data)e(types)h(\(\223abstract)f(syntax)h(tr)o(ees\224\).)523
4075 y(Unfortunately)-9 b(,)16 b(both)i(r)o(epr)o(esentations)e(have)g
(disadvantages.)g(W)-5 b(ith)18 b(the)f(string)g(encod-)523
4174 y(ing,)30 b(we)g(r)o(epr)o(esent)f(the)h(code)g(fragment)f
Fh(f)50 b(\(x,y\))29 b Fn(simply)i(as)e Fh("f)50 b(\(x,y\)")p
Fn(.)29 b(While)523 4274 y(constr)o(ucting)21 b(and)d(combining)j
(fragments)e(r)o(epr)o(esented)e(by)i(strings)h(can)f(be)g(done)g(con-)
523 4374 y(cisely)-9 b(,)22 b(deconstr)o(ucting)i(them)f(is)g(verbose.)
f(Mor)o(e)f(seriously)-9 b(,)23 b(ther)o(e)f(is)h(no)g
Fj(automatically)523 4473 y(veri\002able)k Fn(guarantee)e(that)h(pr)o
(ograms)g(thusly)h(constr)o(ucted)f(ar)o(e)f(syntactically)h(corr)o
(ect.)523 4573 y(For)34 b(example,)f Fh("f)49 b(\(,y\)")33
b Fn(can)g(have)g(the)h(static)f(type)h Fh(string)p Fn(,)e(but)i(this)g
(string)h(is)523 4672 y(clearly)20 b Fj(not)h Fn(a)f(syntactically)h
(corr)o(ect)f(pr)o(ogram.)p 523 4748 473 4 v 551 4801
a Fg(?)606 4833 y Fm(This)c(work)f(was)i(supported)d(by)i(National)h
(Science)g(Foundation)f(r)o(esear)o(ch)f(grant)h(ITR)g(0113569)606
4924 y(entitled)j(\223Putting)g(Multi-stage)f(Annotations)j(to)d(W)-7
b(ork\224.)p eop end
%%Page: 2 2
TeXDict begin 2 1 bop 648 448 a Fn(W)-5 b(ith)24 b(the)f(data)f(type)h
(encoding)g(the)g(situation)h(is)g(impr)o(oved,)e(but)h(the)g(best)g
(we)g(can)523 548 y(do)33 b(is)h(ensur)o(e)e(that)h(any)g(generated)f
(pr)o(ogram)h(is)g(syntactically)g(corr)o(ect.)f(W)-8
b(e)34 b(cannot)523 648 y(use)28 b(data)e(types)i(to)g(ensur)o(e)f
(that)g(generated)g(pr)o(ograms)g(ar)o(e)f(well-typed.)h(The)h(r)o
(eason)523 747 y(is)i(that)f(data)f(types)h(can)g(r)o(epr)o(esent)f
(context-fr)o(ee)f(sets)j(accurately)-9 b(,)27 b(but)i(\(usually\))g
(not)523 847 y(context)e(sensitive)g(sets.)g(T)-7 b(ype)26
b(systems)i(generally)e(de\002ne)h(context)g(sensitive)g(sets)g(\(of)
523 946 y(pr)o(ograms\).)20 b(Additionally)-9 b(,)21
b(constr)o(ucting)i(data)d(type)h(values)f(that)h(r)o(epr)o(esent)f(tr)
o(ees)g(can)523 1046 y(be)g(verbose.)648 1146 y(MSP)g(languages)h(pr)o
(ovide)f(concise)i(syntax)f(similar)g(to)h(that)f(used)g(to)g(build)g
(strings.)523 1245 y(In)i(contrast)h(to)f(strings,)h(MSP)f(languages)g
(statically)g(ensur)o(e)f(that)h(any)g(generator)g(only)523
1345 y(pr)o(oduces)15 b(syntactically)h(well-formed)f(pr)o(ograms.)g
(Additionally)-9 b(,)16 b(statically)f(typed)h(MSP)523
1445 y(languages)23 b(statically)g(ensur)o(e)g(that)g(any)g(generated)f
(pr)o(ogram)h(is)g(also)h(type)f(corr)o(ect.)f(In)523
1544 y(such)e(languages,)f(any)h(statically)f(well-typed)g(pr)o(ogram)g
(generator)g(can)g(only)i(generate)523 1644 y(well-typed)f(pr)o
(ograms.)648 1743 y(Finally)-9 b(,)24 b(with)g(both)h(string)f(and)f
(data)g(type)h(r)o(epr)o(esentations,)e(ensuring)j(that)f(ther)o(e)523
1843 y(ar)o(e)k(no)i(name)f(clashes)g(or)g(inadvertent)g(variable)f
(captur)o(es)f Fj(in)j(the)e(generated)h(pr)o(ogram)523
1943 y Fn(is)g(the)h(r)o(esponsibility)g(of)f(the)g(pr)o(ogrammer)-6
b(.)28 b(This)h(is)h(essentially)f(the)g(same)g(pr)o(oblem)523
2042 y(that)21 b(one)g(encounters)g(with)h(the)e(C)h(macr)o(o)f
(system.)h(MSP)f(languages)h(ensur)o(e)f(that)g(such)523
2142 y(inadvertent)j(captur)o(e)g(is)h(not)g(possible.)g(W)-8
b(e)24 b(will)h(r)o(eturn)e(to)h(this)h(issue)f(when)h(we)e(have)523
2242 y(discussed)e(some)g(mor)o(e)g(examples)f(of)g(MSP)-11
b(.)523 2472 y Fi(1.2)82 b(Basic)20 b(MSP)g(Constructs)g(in)g
(MetaOCaml)523 2620 y Fn(T)-8 b(o)27 b(illustrate)g(how)h(MSP)e(addr)o
(esses)f(the)i(above)f(pr)o(oblems)h(we)f(consider)h(a)g(small)g(ex-)
523 2720 y(ample)20 b(in)g(MetaOCaml.)f(MetaOCaml)g([5)o(])h(is)h(an)e
(MSP)h(extension)h(of)f(the)g(function)h(pr)o(o-)523
2819 y(gramming)j(language)f(OCaml)g([13)o(].)g(In)g(addition)h(to)f
(containing)i(traditional)e(impera-)523 2919 y(tive,)i
(object-oriented,)g(and)g(functional)h(featur)o(es,)e(MetaOCaml)g(pr)o
(ovides)h(constr)o(ucts)523 3018 y(for)i(staging.)h Fj(Staging)f
Fn(a)g(pr)o(ogram)f(is)i(modifying)h(it)e(so)h(that)g(the)g(work)g(it)f
(performs)h(is)523 3118 y(carried)d(out)h(in)g(discr)o(ete)f(stages.)h
(This)g(is)h(done)f(with)h(the)f(goal)g(of)g(impr)o(oving)g(overall)523
3218 y(performance.)648 3309 y(MetaOCaml)g(has)h(thr)o(ee)g(staging)g
(constr)o(ucts.)h(Brackets)f(can)g(be)g(inserted)g(ar)o(ound)523
3400 y(any)19 b(expr)o(ession)g(to)h(delay)f(its)h(execution.)f
(MetaOCaml)f(implements)i(delayed)f(expr)o(es-)523 3492
y(sions)e(by)g(dynamically)f(generating)g(sour)o(ce)g(code)g(at)g(r)o
(untime.)g(While)h(using)g(the)f(sour)o(ce)523 3583 y(code)24
b(r)o(epr)o(esentation)g(is)h(not)g(the)g(only)h(way)f(of)f
(implementing)i(MSP)e(languages,)h(it)g(is)523 3674 y(the)e(simplest.)h
(The)f(following)h(short)g(interactive)e(session)i(illustrates)f(the)g
(behavior)g(of)523 3766 y(Brackets)d(in)h(MetaOCaml:)523
3905 y Fl(#)45 b(let)f(a)h(=)f(1+2;;)523 3996 y(val)g(a)h(:)g(int)f(=)h
(3)523 4088 y(#)g(let)f(a)h(=)f(.<1+2>.;;)523 4179 y(val)g(a)h(:)g(int)
f(code)g(=)h(.<1+2>.)523 4327 y Fn(Lines)21 b(that)f(start)g(with)h
Fh(#)f Fn(ar)o(e)f(what)i(is)g(enter)o(ed)e(by)h(the)h(user)-6
b(,)20 b(and)g(the)g(following)i(line\(s\))523 4426 y(ar)o(e)h(what)i
(is)f(printed)h(back)e(by)i(the)g(system.)f(W)-5 b(ithout)26
b(the)f(Brackets)e(ar)o(ound)h Fh(1+2)p Fn(,)g(the)523
4526 y(addition)18 b(is)g(performed)e(right)i(away)-9
b(.)17 b(W)-5 b(ith)18 b(the)g(Brackets,)f(the)g(r)o(esult)h(is)g(a)f
(piece)g(of)g(code)523 4625 y(r)o(epr)o(esenting)h(the)h(pr)o(ogram)f
Fh(1+2)p Fn(.)h(This)g(code)g(fragment)f(can)h(either)g(be)f(used)h(as)
g(part)f(of)523 4725 y(another)-6 b(,)21 b(bigger)f(pr)o(ogram,)g(or)h
(it)g(can)f(be)h(compiled)g(and)f(executed.)648 4825
y(In)27 b(addition)g(to)h(delaying)f(the)g(computation,)h(Brackets)e
(ar)o(e)g(also)h(r)o(e\003ected)f(in)i(the)523 4924 y(type.)c(The)h
(type)f(in)h(the)g(last)f(declaration)g(is)h Fh(.<int>.)p
Fn(,)e(r)o(ead)g Fj(\223Code)h(of)g(Int\224)p Fn(.)g(The)g(type)1943
5173 y(2)p eop end
%%Page: 3 3
TeXDict begin 3 2 bop 523 448 a Fn(of)21 b(a)g(code)g(fragment)g(r)o
(e\003ects)g(the)g(type)h(of)f(the)g(value)g(that)g(such)h(code)f
(would)h(pr)o(oduce)523 548 y(when)29 b(it)g(is)h(executed.)d(This)i
(allows)h(us)f(to)g(avoid)f(writing)i(generators)e(that)h(pr)o(oduce)
523 648 y(code)17 b(that)f(cannot)h(be)g(typed.)f(The)h(code)f(type)h
(constr)o(uctor)h(distinguishes)g(delayed)e(val-)523
747 y(ues)24 b(fr)o(om)g(other)h(values)f(and)g(pr)o(events)f(the)i
(user)f(fr)o(om)g(accidentally)f(attempting)i(un-)523
847 y(safe)e(operations)i(\(such)f(as)g Fh(1)50 b(+)f(.<5>.)p
Fn(\).)23 b(Note)h(also)h(that)f(when)h(typing)g(multi-stage)523
946 y(languages)g(one)g(must)h(ensur)o(e)e(that)h(no)h(attempt)e(is)i
(ever)e(made)g(to)h(use)g(a)g(variable)f(be-)523 1046
y(for)o(e)j(its)h(value)f(becomes)h(available.)e(Mechanisms)i(for)f
(addr)o(essing)g(this)h(concern)g(ar)o(e)523 1146 y(described)20
b(in)h(the)g(second)g(part)f(of)h(the)f(paper)-6 b(.)648
1244 y(Escape)17 b(allows)j(the)e(combination)i(of)f(smaller)g(delayed)
e(values)i(to)g(constr)o(uct)g(lar)o(ger)523 1335 y(ones.)g(This)h
(combination)g(is)f(achieved)f(by)h(\223splicing-in\224)g(the)g(ar)o
(gument)f(of)h(the)g(Escape)523 1426 y(in)i(the)g(context)g(of)g(the)g
(surr)o(ounding)g(Brackets:)523 1610 y Fl(#)45 b(let)f(b)h(=)f
(.<.\230a)g(*)h(.\230a)f(>.)h(;;)523 1702 y(val)f(b)h(:)g(int)f(code)g
(=)h(.<\(1)f(+)h(2\))f(*)h(\(1)f(+)h(2\)>.)523 1887 y
Fn(This)21 b(declaration)e(binds)i Fh(b)e Fn(to)i(a)f(new)g(delayed)f
(computation)i Fh(\(1+2\)*\(1+2\))p Fn(.)d(Escape)523
1987 y(combines)i(delayed)f(computations)h(ef)o(\002ciently)g(in)g(the)
f(sense)h(that)f(the)h(combination)h(of)523 2087 y(the)j(subcomponents)
h(of)e(the)h(new)g(computation)g(is)g(performed)f(while)h(the)g(new)g
(com-)523 2186 y(putation)h(is)g(being)g Fj(constructed)p
Fn(,)f(rather)g(than)h(while)g(it)g(is)g(being)h Fj(executed)p
Fn(.)d(This)j(subtle)523 2286 y(distinction)21 b(has)f(a)g
(signi\002cant)h(ef)o(fect)d(on)i(the)g(r)o(untime)h(performance)e(of)h
(the)g(generated)523 2385 y(code.)648 2483 y(The)g(Run)h(constr)o(uct)g
(\(written)g Fh(.!)p Fn(\))e(allows)i(us)g(to)g(execute)e(the)i
(dynamically)f(gener)o(-)523 2575 y(ated)g(code)g(without)i(going)g
(outside)f(the)g(language:)523 2759 y Fl(#)45 b(let)f(c)h(=)f(.!)h(b;;)
523 2850 y(val)f(b)h(:)g(int)f(=)h(9)523 3036 y Fn(Having)28
b(these)f(thr)o(ee)g(constr)o(ucts)h(as)g(part)e(of)i(the)f(pr)o
(ogramming)h(language)f(makes)h(it)523 3135 y(possible)22
b(to)g(use)g(r)o(untime)g(code)g(generation)f(and)g(compilation)i(as)e
(part)g(of)h(any)f(library)523 3235 y(subr)o(outine.)34
b(In)f(addition)h(to)g(not)g(having)g(to)g(worry)g(about)g(generating)f
(temporary)523 3335 y(\002les,)25 b(static)f(type)h(systems)h(for)e
(MSP)g(languages)g(assur)o(e)g(us)h(that)g(that)f(no)i(r)o(untime)f(er)
o(-)523 3434 y(r)o(ors)h(will)h(occur)f(in)h(these)g(subr)o(outines.)f
(Not)h(only)h(can)e(these)g(type)g(systems)i(exclude)523
3534 y(generation-time)c(err)o(ors,)f(but)h(they)g(also)g(ensur)o(e)g
(that)g(generated)e(pr)o(ograms)i(ar)o(e)e(both)523 3633
y(syntactically)30 b(well-formed)g(and)f(well-typed.)g(Ther)o(efor)o
(e,)f(the)i(dynamic)g(invocation)523 3733 y(of)21 b(the)g(compiler)g
(cannot)g(fail.)648 3831 y(Finally)-9 b(,)25 b(it)g(is)g(important)g
(to)h(note)f(that)g(pr)o(ogram)f(generation)h(r)o(equir)o(es)f(r)o
(enaming.)523 3922 y(Consider)d(the)g(following)h(contrived)f(but)g
(minimal)g(staged)f(pr)o(ogram:)523 4106 y Fl(#)45 b(let)f(rec)g(h)h(n)
g(z)f(=)h(if)g(n=0)f(then)g(z)1330 4198 y(else)g(.<\(fun)g(x)h(->)f
(.\230\(h)g(\(n-1\))g(.<x+)g(.\230z>.\)\))g(n>.;;)523
4289 y(val)g(h)h(:)g(int)f(->)h(int)f(code)g(->)g(int)h(code)f(=)h
(<fun>)523 4466 y Fn(If)21 b(we)g(erase)f(the)h(annotations)i(\(to)e
(get)g(the)g(\223unstaged\224)f(version)i(of)f(this)h(function\))f(and)
523 4558 y(apply)e(it)g(to)h Fh(3)50 b(1)p Fn(,)18 b(we)i(get)f(7)g(is)
g(the)h(answer)-6 b(.)18 b(If)h(we)g(apply)g(the)g(function)h(above)f
(\(with)h(the)523 4649 y(staging)h(annotations\))h(to)f
Fh(e)50 b(.<1>.)p Fn(,)19 b(we)i(get)g(the)g(following)h(term:)568
4833 y Fl(.<\(fun)44 b(x_1)g(->)702 4924 y(\(fun)h(x_2)f(->)g(\(fun)h
(x_3)f(->)g(\(x_3)g(+)h(\(x_2)f(+)h(\(x_1)f(+)h(1\)\)\)\))f(1\))g(2\))h
(3>.)1943 5173 y Fn(3)p eop end
%%Page: 4 4
TeXDict begin 4 3 bop 523 448 a Fn(Note)28 b(that)f(wher)o(eas)g(the)g
(sour)o(ce)g(code)g(only)i(had)e Fh(fun)49 b(x)h(->)f(...)27
b Fn(inside)h(brackets,)523 548 y(this)17 b(code)e(fragment)g(was)h
(generated)f(thr)o(ee)g(times,)h(and)f(each)g(time)h(it)g(pr)o(oduced)f
Fh(fun)49 b(x_i)g(->)h(...)523 648 y Fn(wher)o(e)25 b
Fh(i)g Fn(is)h(a)f(dif)o(fer)o(ent)f(number)h(each)g(time.)h(If)f(we)g
(r)o(un)h(the)g(generated)f(code)g(above,)523 747 y(we)h(get)h
Fh(7)f Fn(as)g(the)g(answer)-6 b(.)26 b(W)-8 b(e)26 b(view)h(it)f(as)g
(a)g(highly)i(desirable)d(pr)o(operty)h(that)g(the)g(r)o(e-)523
847 y(sults)f(generated)d(by)i(staged)f(pr)o(ograms)h(ar)o(e)e(r)o
(elated)g(to)j(the)f(r)o(esults)f(generated)g(by)h(the)523
946 y(unstaged)g(pr)o(ogram.)f(The)g(r)o(eader)f(can)i(verify)f(for)h
(herself)f(that)h(if)g(the)g Fh(x)p Fn(s)g(wer)o(e)f(not)h(r)o(e-)523
1046 y(named,)33 b(the)g(answer)g(of)g(r)o(unning)h(the)f(stage)g(pr)o
(ogram)g(would)g(be)g(dif)o(fer)o(ent.)e(Thus,)523 1146
y(automatic)19 b(r)o(enaming)g(of)g(bound)g(variables)f(is)h(not)h(so)f
(much)h(a)f(featur)o(e,)d(rather)-6 b(,)18 b(it)h(is)h(the)523
1245 y(absence)g(of)h(r)o(enaming)f(that)h(seems)g(like)g(a)f(bug.)523
1479 y Fi(1.3)82 b(How)21 b(Do)g(W)-6 b(e)20 b(W)-6 b(rite)20
b(MSP)g(Programs?)523 1630 y Fn(Good)34 b(abstraction)e(mechanisms)i
(can)f(help)g(the)g(pr)o(ogrammer)f(write)h(mor)o(e)f(concise)523
1730 y(and)22 b(maintainable)h(pr)o(ograms.)f(But)g(if)g(these)h
(abstraction)g(mechanisms)g(degrade)e(per)o(-)523 1830
y(formance,)30 b(they)h(will)h(not)g(be)e(used.)h(Pr)o(ogram)f
(generation)h(can)g(help)g(to)g(r)o(educe)f(the)523 1929
y(r)o(untime)e(over)o(head)e(of)i(sophisticated)f(abstraction)g
(mechanisms.)h(The)g(main)f(goal)h(of)523 2029 y(MSP)19
b(is)i(to)f(make)g(it)g(possible)g(for)g(pr)o(ogrammers)f(to)i(write)f
(generic)f(pr)o(ograms)h(without)523 2128 y(having)h(to)g(pay)g(a)f(r)o
(untime)h(penalty)g(for)g(this)g(generality)-9 b(.)648
2228 y(MSP)22 b(admits)h(an)g(intuitively)h(appealing)e(method)i(of)f
(designing)h(and)f(implement-)523 2328 y(ing)e(generative)f(systems:)
560 2475 y(1.)41 b(A)21 b(single-stage)f(pr)o(ogram)g(is)i(developed,)d
(implemented,)i(and)f(tested.)560 2571 y(2.)41 b(The)23
b(or)o(ganization)f(and)h(data-str)o(uctur)o(es)e(of)h(the)h(pr)o
(ogram)f(ar)o(e)g(studied)g(to)i(ensur)o(e)664 2670 y(that)19
b(they)g(can)g(be)g(used)g(in)g(a)g(staged)f(manner)-6
b(.)19 b(This)g(analysis)g(may)g(indicate)g(a)f(need)664
2770 y(for)j(\223factoring\224)e(some)j(parts)e(of)h(the)g(pr)o(ogram)f
(and)g(its)i(data)d(str)o(uctur)o(es.)i(This)g(step)664
2870 y(can)29 b(be)g(subtle,)f(and)h(can)g(be)f(a)h(critical)f(step)h
(towar)o(d)g(ef)o(fective)e(multi-stage)i(pr)o(o-)664
2969 y(gramming.)d(Fortunately)-9 b(,)25 b(it)g(has)g(been)g(thor)o
(oughly)i(investigated)e(in)g(the)h(context)664 3069
y(of)21 b(partial)f(evaluation)g(wher)o(e)g(it)h(is)h(known)g(as)e
Fj(binding-time)g(engineering)i Fn([12)n(].)560 3165
y(3.)41 b(Staging)26 b(annotations)i(ar)o(e)c(intr)o(oduced)i(to)g
(specify)g(explicitly)g(the)h(evaluation)f(or)o(-)664
3264 y(der)d(of)h(the)f(various)h(computations)h(of)e(the)h(pr)o
(ogram.)e(The)i(staged)f(pr)o(ogram)g(may)664 3364 y(then)e(be)g
(tested)f(to)h(ensur)o(e)f(that)h(it)g(achieves)f(the)h(desir)o(ed)f
(performance.)648 3515 y(The)e(method)i(described)d(above,)h(called)g
Fj(multi-stage)g(pr)o(ogramming)e(with)i(explicit)g(an-)523
3615 y(notations)p Fn(,)i(can)h(be)f(summarized)g(by)h(the)g(slogan:)p
667 3701 2594 4 v 667 3835 4 134 v 696 3786 a(A)f(Staged)g(Pr)o(ogram)g
(=)h(A)f(Conventional)i(Pr)o(ogram)e(+)h(Staging)g(Annotations)p
3257 3835 V 667 3838 2594 4 v 523 3958 a(The)i(conciseness)h(of)f
(annotations)h(means)f(that)g(pr)o(ogram)f(generators)h(derived)f(in)h
(this)523 4058 y(way)f(ar)o(e)f(often)h(simple)h(variations)f(on)g
(conventional)h(pr)o(ograms.)f(W)-8 b(e)22 b(expect)f(that,)h(for)523
4157 y(a)g(wide)g(range)f(of)h(applications,)g(this)h(appr)o(oach)d
(will)j(be)f(mor)o(e)g(ef)o(fective)e(than)i(writing)523
4257 y(generators)h(in)i(a)e(general-purpose)g(pr)o(ogramming)h
(language)f(and)g(fr)o(om)h(scratch.)f(W)-8 b(e)523 4357
y(also)26 b(expect)e(that)h(power)h(of)f(the)g(static)g(type)g(systems)
i(available)d(for)h(MSP)f(languages)523 4456 y(will)e(r)o(educe)d
(testing)i(costs.)523 4690 y Fi(1.4)82 b(A)20 b(classic)f(example)523
4833 y Fn(A)28 b(common)j(sour)o(ce)d(of)h(performance)f(over)o(head)f
(in)j(generic)e(pr)o(ograms)h(is)g(the)g(pr)o(es-)523
4924 y(ence)e(of)g(parameters)e(that)i(do)g(not)g(change)g(very)g
(often,)g(but)g(nevertheless)f(cause)h(our)1943 5173
y(4)p eop end
%%Page: 5 5
TeXDict begin 5 4 bop 523 448 a Fn(pr)o(ograms)26 b(r)o(epeatedly)e
(perform)h(the)i(work)f(associated)f(with)i(these)f(inputs.)h(T)-8
b(o)27 b(illus-)523 540 y(trate)j(this,)h(we)g(consider)g(the)g
(following)h(implementation)g(of)f(a)g(simple)g(function)g(in)523
631 y(MetaOCaml:)20 b([12)n(])523 802 y Fl(let)44 b(rec)h(power)f(\(n,)
g(x\))h(=)658 893 y(match)f(n)g(with)747 984 y(0)h(->)f(1)658
1076 y(|)g(n)h(->)f(x)h(*)g(\(power)f(\(n-1,)f(x\)\);;)523
1243 y Fn(This)29 b(function)g(is)g(generic)g(in)g(that)f(it)h(can)f
(be)h(used)f(to)h(compute)g Fh(x)f Fn(raised)g(to)h Fj(any)f
Fn(ex-)523 1335 y(ponent)c Fh(n)p Fn(.)g(While)g(it)g(is)g(convenient)g
(to)h(use)e(generic)h(functions)h(like)f Fh(power)p Fn(,)e(we)i(often)
523 1426 y(\002nd)e(that)g(we)f(have)g(to)i(pay)e(a)g(price)g(for)g
(their)h(generality)-9 b(.)21 b(Developing)i(a)e(good)h(under)o(-)523
1517 y(standing)28 b(of)g(the)g(sour)o(ce)f(of)g(this)i(performance)e
(penalty)g(is)h(important,)g(because)f(it)h(is)523 1609
y(exactly)c(what)h(MSP)f(will)i(help)f(us)g(eliminate.)g(For)g
(example,)f(if)g(we)h(need)f(to)i(compute)523 1700 y(the)18
b(squar)o(e)f(\(the)h(second)g(power\))g(often,)f(it)h(is)h(convenient)
f(to)h(de\002ne)e(a)h(special)f(function)523 1791 y(such)k(as:)523
1962 y Fl(let)44 b(power2)g(\(x\))h(=)f(power)g(\(2,x\);;)523
2130 y Fn(In)21 b(a)f(functional)i(language,)e(we)g(can)h(also)g(write)
g(it)g(as)f(follows:)523 2300 y Fl(let)44 b(power2)g(=)h(fun)f(x)h(->)f
(power)g(\(2,x\);;)523 2476 y Fn(Her)o(e,)26 b(we)h(have)g(taken)g
(away)g(the)h(formal)f(parameter)f Fh(x)h Fn(fr)o(om)g(the)g(left-hand)
g(side)g(of)523 2576 y(the)f(equality)h Fh(=)f Fn(and)g(r)o(eplaced)e
(it)i(by)g(the)h(equivalent)f Fh(fun)49 b(x)h(->)26 b
Fn(on)h(the)f(right-hand)523 2676 y(side.)648 2770 y(T)-8
b(o)21 b(use)g(the)g(function)g Fh(power2)p Fn(,)f(all)g(we)h(have)f
(to)h(do)g(is)g(to)g(apply)g(it)g(as)f(follows:)523 2941
y Fl(let)44 b(answer)g(=)h(power2)f(\(3\);;)523 3108
y Fn(The)31 b(r)o(esult)g(of)g(this)h(computation)g(is)f(simply)h(the)f
(integer)g Fh(9)p Fn(.)g(But)g(notice)g(that)h(every)523
3200 y(time)19 b(we)f(apply)h Fh(power2)e Fn(to)i(some)g(value)f
Fh(x)g Fn(it)h(calls)f(the)h Fh(power)f Fn(function)h(with)g(param-)523
3291 y(eters)j Fh(\(2,x\))p Fn(.)g(And)g(even)g(though)i(the)f(\002rst)
f(ar)o(gument)g(will)i(always)e(be)g Fh(2)p Fn(,)g(evaluating)523
3382 y Fh(power)49 b(\(2,x\))24 b Fn(will)h(always)f(involve)i(calling)
e(the)h(function)h(r)o(ecursively)d(two)j(times.)523
3474 y(This)g(is)g(an)f(undesirable)g(over)o(head,)f(because)g(we)i
Fj(know)f Fn(that)g(the)h(r)o(esult)f(can)g(be)g(mor)o(e)523
3565 y(ef)o(\002ciently)20 b(computed)h(by)f(just)i(multiplying)g
Fh(x)e Fn(by)h(itself)g(2)f(times.)g(Using)i(only)f(unfold-)523
3656 y(ing)30 b(and)e(the)h(de\002nition)i(of)e Fh(power)p
Fn(,)e(we)i(know)h(that)f(the)h(answer)e(can)h(be)g(computed)523
3748 y(mor)o(e)20 b(ef)o(\002ciently)h(by:)523 3919 y
Fl(let)44 b(power2)g(x)h(=)g(1*x*x;;)523 4094 y Fn(W)-8
b(e)23 b(also)g(do)g(not)h(want)f(to)g(write)g(this)g(by)g(hand,)g(as)f
(ther)o(e)g(may)h(be)g(many)g(speci\002c)g(con-)523 4194
y(stant)j(powers)f(that)h(we)f(want)h(to)g(use)f(\(other)g(than)h
(two\).)f(So)h(the)f(question)i(is,)f(can)f(we)523 4294
y Fj(automatically)19 b Fn(build)i(such)g(a)f(pr)o(ogram?)648
4388 y(In)i(an)g(MSP)f(language)g(such)i(as)e(MetaOCaml,)g(the)h
(answer)g(is)g(yes.)g(All)g(we)g(need)g(to)523 4480 y(do)f(is)g(to)g
Fj(stage)f Fn(the)h(power)g(function)h(by)f(annotating)g(it)g(as)f
(follows:)523 4650 y Fl(let)44 b(rec)h(power)f(\(n,)g(x\))h(=)658
4742 y(match)f(n)g(with)747 4833 y(0)h(->)f(.<1>.)658
4924 y(|)g(n)h(->)f(.<.\230x)g(*)h(.\230\(power)e(\(n-1,)h(x\)\)>.;;)
1943 5173 y Fn(5)p eop end
%%Page: 6 6
TeXDict begin 6 5 bop 523 448 a Fn(This)31 b(function)h(still)f(takes)g
(two)g(ar)o(guments,)f(but)h(now)g(the)g(second)g(ar)o(gument)f(is)h
(no)523 548 y(longer)26 b(an)f(integer)-6 b(,)24 b(but)h(rather)-6
b(,)24 b(a)h Fj(code)g(of)g(type)f(integer)p Fn(.)h(The)g(r)o(esult)f
(of)h(the)h(function)g(is)523 648 y(also)19 b(changed.)g(Instead)g(of)g
(r)o(eturning)g(an)g(integer)-6 b(,)18 b(this)i(function)g(will)g(r)o
(eturn)f(a)f(code)h(of)523 747 y(type)i(integer)-6 b(.)20
b(T)-8 b(o)22 b(match)e(this)i(r)o(eturn)e(type,)h(we)f(insert)h
(Brackets)f(ar)o(ound)g Fh(1)h Fn(on)g(the)g(sec-)523
847 y(ond)26 b(line.)h(By)f(inserting)h(Brackets)e(ar)o(ound)g(the)h
(multiplication)h(expr)o(ession,)f(we)g(now)523 946 y(r)o(eturn)17
b(a)h(code)g(of)g(integer)g(instead)f(just)i(an)f(integer)-6
b(.)18 b(The)g(Escape)f(ar)o(ound)g(the)h(r)o(ecursive)523
1046 y(call)i(to)i(power)e(means)h(that)g(it)g(is)g(performed)f
(immediately)-9 b(.)648 1146 y(Note)23 b(that)f(added)g(staging)h
(constr)o(ucts)h(can)f(be)f(viewed)g(as)h(simply)h(\223annotations\224)
523 1245 y(on)d(the)f(original)h(pr)o(ogram,)e(and)h(that)g(they)g(ar)o
(e)f(fairly)h(unobtr)o(usive.)h(Also,)f(we)g(ar)o(e)f(able)523
1345 y(to)27 b(type)g(check)g(the)g(code)g(both)h(outside)f(and)f
(inside)i(the)f(Brackets)f(in)h(essentially)h(the)523
1445 y(same)23 b(way)h(that)f(we)h(did)f(befor)o(e.)f(If)h(we)g(wer)o
(e)g(using)h(strings)h(instead)e(of)h(Brackets,)e(we)523
1544 y(would)f(have)g(to)g(sacri\002ce)f(static)g(\(early\))g(type)h
(checking)g(of)g(delayed)e(computations.)648 1636 y(After)g(annotating)
i Fh(power)p Fn(,)e(we)h(have)g(to)h(annotate)f(the)g(uses)h(of)f
Fh(power)p Fn(.)f(The)h(decla-)523 1727 y(ration)h(of)g
Fh(power2)e Fn(is)i(annotated)g(as)f(follows:)523 1877
y Fl(let)44 b(power2)g(=)h(.!)f(.<fun)g(x)h(->)f(.\230\(power)g
(\(2,.<x>.\)\)>.;;)523 2035 y Fn(The)21 b(outermost)h(annotation)f(is)h
(Run)f(\()p Fh(.!)p Fn(\).)f(This)h(will)h(compile)f(\(and)f(if)h
(necessary)-9 b(,)20 b(exe-)523 2134 y(cute\))g(its)g(ar)o(gument.)g
(The)g(ar)o(gument)g(itself)g(is)h(essentially)g(the)f(same)g(as)g
(what)h(we)f(used)523 2234 y(to)31 b(de\002ne)g Fh(power2)f
Fn(befor)o(e,)f(except)h(that)h(we)g(have)f(also)h(added)f(some)h
(annotations.)523 2333 y(The)19 b(annotations)i(say)e(that)g(we)g(wish)
i(to)e(constr)o(uct)i(the)e(code)g(for)g(a)g(function)h(that)f(takes)
523 2433 y(one)26 b(ar)o(gument)g(\()p Fh(fun)48 b(x)i(->)p
Fn(\).)25 b(W)-8 b(e)26 b(do)g(not)g(actually)f(spell)h(out)h(what)f
(the)g(function)g(it-)523 2533 y(self)e(should)i(do.)e(Instead,)g(we)g
(use)h(the)f(Escape)g(constr)o(uct)h(\()p Fh(.\230)p
Fn(\))f(to)g(make)h(a)f(call)g(to)h(the)523 2632 y(staged)c(power)h
(function)g Fh(power)p Fn(.)f(W)-8 b(e)21 b(pass)h(two)g(ar)o(guments.)
f(The)h(\002rst)g(one)g(is)g(a)f(r)o(egu-)523 2732 y(lar)d(integer)h
(ar)o(gument,)f Fh(2)p Fn(.)h(The)f(second)h(ar)o(gument)g(is)g(a)f
(delayed)g(integer)-6 b(.)18 b(The)h(delayed)523 2832
y(integer)26 b(is)h(the)f(term)h Fh(.<x>.)p Fn(.)e(Because)g(the)h
(call)g(to)h(the)f Fh(power)g Fn(function)h(is)f(Escaped,)523
2931 y(it)c Fj(escapes)g Fn(the)f(delaying)h(ef)o(fect)d(of)j(the)f
(surr)o(ounding)h(Brackets,)e(and)i(is)f(performed)g(im-)523
3031 y(mediately)-9 b(.)18 b(This)i(means)f(that)g(the)g(\002rst)g
(thing)h(that)f(gets)g(done)h(when)f(we)g(enter)g(\(or)g(r)o(un\))523
3131 y(the)g(expr)o(ession)g(above)f(is)h(this)h(call)f(to)g
Fh(power)p Fn(.)f(It)h(r)o(eturns)f(a)h(delayed)e(value)i(containing)
523 3230 y(exactly)29 b Fh(.<1*x*x>.)p Fn(.)g(The)h(Escape)f(then)h
(inserts)h(this)g(into)g(the)f(context)g(of)g(the)h(sur)o(-)523
3330 y(r)o(ounding)d(Brackets,)e(and)g(we)i(have)e Fh(.<)50
b(fun)f(x)h(->)f(1*x*x)g(>.)p Fn(.)27 b(Now)g(evaluating)523
3429 y(the)21 b(ar)o(gument)g(to)h Fh(.!)f Fn(is)g(complete.)g(It)h(is)
f(then)h(passed)e(to)i(the)f(compiler)-6 b(.)21 b(The)h(compiler)523
3529 y(r)o(eturns)d(a)g(value)g(and)f(binds)i(it)g(to)g
Fh(power2)p Fn(.)e(This)h(value)g(behaves)g(exactly)g(as)g(if)g(we)g
(had)523 3629 y(de\002ned)h(it)h(\223by)g(hand\224)f(to)h(be)g
Fh(fun)49 b(x)g(->)h(1*x*x)p Fn(.)20 b(The)g(staged)h
Fh(power2)e Fn(will)j(behave)523 3728 y(exactly)e(like)h(the)g
(unstaged)g Fh(power2)p Fn(,)e(but)i(it)g(will)g(r)o(un)h(faster)-6
b(.)523 3969 y Fi(1.5)82 b(Implementing)18 b(DSLs)i(Using)g(MSP)523
4127 y Fn(An)32 b(important)h(application)f(for)g(MSP)g(is)h(the)f
(implementation)i(of)e(domain-speci\002c)523 4227 y(languages)16
b(\(DSLs\).)e(Languages)h(can)h(be)f(implemented)h(in)h(a)e(variety)g
(of)h(dif)o(fer)o(ent)d(ways.)523 4327 y(For)k(example,)f(a)g(language)
g(can)h(be)f(implemented)h(by)f(an)h(interpr)o(eter)e(or)i(by)g(a)f
(compiler)-6 b(.)523 4426 y(Compilers)29 b(ar)o(e)e(often)i(or)o(ders)e
(of)i(magnitude)f(faster)g(than)g(interpr)o(eters,)g(but)g(r)o(equir)o
(e)523 4526 y(signi\002cant)35 b(expertise)e(and)g(take)h(or)o(ders)f
(of)g(magnitude)h(mor)o(e)g(time)g(to)g(implement)523
4625 y(than)24 b(interpr)o(eters.)e(Using)i(the)f(strategy)g(outlined)h
(above)f(for)g(using)i(MSP)d(languages,)523 4725 y(if)c(we)g(start)g
(by)h(\002rst)f(writing)i(an)e(interpr)o(eter)f(for)h(a)g(language)g
(and)g(then)g(stage)g(it,)h(we)f(get)523 4825 y Fj(a)29
b(staged)e(interpr)o(eter)p Fn(.)i(Such)g(staged)f(interpr)o(eters)f
(ar)o(e)h(often)h(almost)g(as)f(simple)h(as)g(the)523
4924 y(interpr)o(eter)22 b(we)h(started)g(with,)h(but)f(can)g(have)g
(performance)g(comparable)f(to)i(that)f(of)g(a)1943 5173
y(6)p eop end
%%Page: 7 7
TeXDict begin 7 6 bop 523 448 a Fn(compiler)-6 b(.)25
b(The)h(r)o(eason)f(for)g(this)h(is)g(that)g(a)f(staged)g(interpr)o
(eter)f(becomes)i(ef)o(fectively)d(a)523 548 y Fj(translator)k
Fn(fr)o(om)f(the)h(DSL)g(to)g(the)g(host)h(language)f(\(in)g(this)g
(case)g(MetaOCaml\).)e(Then,)523 648 y(by)20 b(using)g(MetaOCaml's)f
(Run)i(constr)o(uct,)f(the)g(composition)h(is)f(in)h(fact)d(a)i
(function)g(that)523 747 y(takes)g(DSL)h(pr)o(ograms)f(and)g(pr)o
(oduces)g(machine)h(code)2316 717 y Ff(1)2349 747 y Fn(.)648
839 y(T)-8 b(o)19 b(illustrate)f(this)i(appr)o(oach,)c(we)j(consider)g
(the)f(implementation)i(of)f(a)f(simple)h(pr)o(o-)523
930 y(gramming)g(language)f(\(let's)g(call)g(it)g Fh(lint)p
Fn(\))f(with)i(support)g(for)f(integer)g(arithmetic,)g(con-)523
1021 y(ditionals,)28 b(and)f(r)o(ecursive)f(functions.)i(The)g(syntax)f
(of)h(expr)o(essions)f(in)h(this)g(language)523 1112
y(can)20 b(be)h(r)o(epr)o(esented)e(in)i(OCaml)g(using)g(the)g
(following)h(data)e(type:)523 1259 y Fl(type)44 b(exp)h(=)f(Int)h(of)f
(int)g(|)h(Var)f(of)h(string)f(|)g(App)h(of)f(string)g(*)h(exp)927
1350 y(|)f(Add)h(of)f(exp)g(*)h(exp)f(|)h(Sub)f(of)h(exp)f(*)h(exp)927
1442 y(|)f(Mul)h(of)f(exp)g(*)h(exp)f(|)h(Div)f(of)h(exp)f(*)h(exp)927
1533 y(|)f(Ifz)h(of)f(exp)g(*)h(exp)f(*)h(exp)523 1716
y(type)f(def)h(=)f(Declaration)f(of)i(string)e(*)i(string)f(*)h(exp)523
1807 y(type)f(prog)g(=)h(Program)f(of)g(def)g(list)h(*)f(exp)523
1954 y Fn(Using)22 b(the)f(above)g(data)g(types,)g(a)g(small)h(pr)o
(ogram)e(that)i(de\002nes)f(the)h(factorial)e(function)523
2045 y(and)g(then)i(applies)e(it)h(to)g(10)f(can)g(be)h(concisely)g(r)o
(epr)o(esented)e(as)h(follows:)523 2192 y Fl(Program)44
b(\([Declaration)971 2283 y(\("fact","x",)f(Ifz\(Var)h("x",)1465
2374 y(Int)g(1,)1465 2466 y(Mul\(Var"x",)1644 2557 y(\(App)g(\("fact",)
f(Sub\(Var)h("x",Int)g(1\)\)\)\)\)\))927 2648 y(],)927
2740 y(App)g(\("fact",)f(Int)i(10\)\))523 2895 y Fn(OCaml)25
b(lex)g(and)f(yacc)h(can)g(be)f(used)h(to)g(build)g(parsers)f(that)h
(take)g(textual)f(r)o(epr)o(esenta-)523 2994 y(tions)e(of)g(such)g(pr)o
(ograms)e(and)h(pr)o(oduce)g(abstract)f(syntax)h(tr)o(ees)g(such)h(as)f
(the)g(above.)g(In)523 3094 y(the)g(r)o(est)f(of)h(this)h(section,)f
(we)g(focus)g(on)h(what)f(happens)g(after)f(such)h(an)g(abstract)f
(syntax)523 3193 y(tr)o(ee)g(has)g(been)h(generated.)648
3285 y(T)-8 b(o)28 b(associate)f(both)i(variable)d(and)h(function)i
(names)f(with)g(their)g(values,)f(an)h(inter)o(-)523
3376 y(pr)o(eter)f(for)g(this)i(language)f(will)h(need)e(a)h(notion)h
(of)f(envir)o(onment.)h(Such)e(an)h(envir)o(on-)523 3467
y(ment)c(can)g(be)g(conveniently)h(implemented)f(as)g(a)f(function)i
(fr)o(om)f(names)g(to)g(values.)f(If)523 3559 y(we)i(lookup)h(a)f
(variable)e(and)i(it)g(is)h(not)f(an)g(envir)o(onment,)h(we)f(will)h
(raise)e(an)h(exception)523 3650 y(\(let's)19 b(call)h(it)f
Fh(Yikes)p Fn(\).)f(If)h(we)h(want)g(to)g(extend)f(the)g(envir)o
(onment)h(\(which)g(is)g(just)g(a)f(func-)523 3741 y(tion\))i(with)g
(an)f(association)h(fr)o(om)f(the)g(name)g Fh(x)g Fn(to)h(a)f(value)f
Fh(v)p Fn(,)h(we)g(simply)h(r)o(eturn)f(a)g(new)523 3833
y(envir)o(onment)k(\(a)e(function\))i(if)f(\002rst)g(tests)g(to)h(see)f
(if)g(it's)g(ar)o(gument)g(is)h(the)f(same)g(as)g Fh(x)p
Fn(.)f(If)523 3924 y(so,)c(it)g(r)o(eturns)g Fh(v)p Fn(.)f(Otherwise,)i
(it)f(looks)h(up)f(its)g(ar)o(gument)g(in)g(the)g(original)h(envir)o
(onment.)523 4015 y(All)i(we)f(need)h(to)g(implement)g(such)h(envir)o
(onments)f(is)g(the)g(following:)523 4162 y Fl(exception)43
b(Yikes)523 4253 y(let)h(env0)h(=)f(fun)h(x)f(->)h(raise)f(Yikes)178
b(let)44 b(fenv0)g(=)h(env0)523 4345 y(let)f(ext)h(env)f(x)h(v)f(=)h
(fun)f(y)h(->)f(if)h(x=y)f(then)g(v)h(else)f(env)h(y)523
4491 y Fn(Given)36 b(an)g(envir)o(onment)g(binding)g(variable)f(names)h
(to)g(their)g(r)o(untime)g(values)f(and)523 4583 y(function)30
b(names)e(to)h(values)g(\(let's)f(call)h(them)g Fh(env)f
Fn(and)g Fh(fenv)p Fn(,)g(r)o(espectively\),)f(an)i(in-)523
4674 y(terpr)o(eter)19 b(for)i(an)f(expr)o(ession)h Fh(e)f
Fn(can)h(be)f(de\002ned)g(as)h(follows:)p 523 4745 473
4 v 558 4801 a Fe(1)606 4833 y Fm(If)k(we)h(ar)o(e)f(using)f(the)i
(MetaOCaml)g(native)g(code)f(compiler)-6 b(.)24 b(If)h(we)h(ar)o(e)f
(using)g(the)h(bytecode)606 4924 y(compiler)-6 b(,)18
b(of)g(course,)f(the)j(composition)e(pr)o(oduces)f(bytecode)1943
5173 y Fn(7)p eop end
%%Page: 8 8
TeXDict begin 8 7 bop 523 448 a Fl(let)44 b(rec)h(eval1)f(e)g(env)h
(fenv)f(=)523 540 y(match)g(e)h(with)613 631 y(Int)f(i)h(->)f(i)523
722 y(|)h(Var)f(s)h(->)f(env)h(s)523 814 y(|)g(App)f(\(s,e2\))g(->)g
(\(fenv)g(s\)\(eval1)g(e2)g(env)h(fenv\))523 905 y(|)g(Add)f(\(e1,e2\))
g(->)g(\(eval1)g(e1)g(env)h(fenv\)+\(eval1)e(e2)h(env)g(fenv\))523
996 y(|)h(Sub)f(\(e1,e2\))g(->)g(\(eval1)g(e1)g(env)h(fenv\)-\(eval1)e
(e2)h(env)g(fenv\))523 1088 y(|)h(Mul)f(\(e1,e2\))g(->)g(\(eval1)g(e1)g
(env)h(fenv\)*\(eval1)e(e2)h(env)g(fenv\))523 1179 y(|)h(Div)f
(\(e1,e2\))g(->)g(\(eval1)g(e1)g(env)h(fenv\)/\(eval1)e(e2)h(env)g
(fenv\))523 1270 y(|)h(Ifz)f(\(e1,e2,e3\))f(->)i(if)f(\(eval1)g(e1)g
(env)h(fenv\)=0)1465 1362 y(then)f(\(eval1)f(e2)i(env)f(fenv\))1465
1453 y(else)g(\(eval1)f(e3)i(env)f(fenv\))523 1617 y
Fn(This)24 b(interpr)o(eter)d(can)i(now)h(be)f(used)g(to)g(de\002ne)g
(the)g(interpr)o(eter)f(for)h(declarations)f(and)523
1708 y(pr)o(ograms)e(as)h(follows:)523 1874 y Fl(let)44
b(rec)h(peval1)f(p)g(env)h(fenv=)702 1965 y(match)f(p)h(with)747
2056 y(Program)f(\([],e\))g(->)g(eval1)g(e)h(env)f(fenv)702
2148 y(|Program)g(\(Declaration)f(\(s1,s2,e1\)::tl,e\))f(->)882
2239 y(let)i(rec)g(f)h(x)g(=)f(eval1)g(e1)h(\(ext)f(env)g(s2)h(x\))f
(\(ext)g(fenv)h(s1)f(f\))882 2330 y(in)g(peval1)g(\(Program\(tl,e\)\))e
(env)j(\(ext)f(fenv)g(s1)g(f\))523 2503 y Fn(In)34 b(this)g(function,)f
(when)h(the)g(list)g(of)f(declarations)f(is)i(empty)g(\()p
Fh([])p Fn(\),)d(we)j(simply)g(use)523 2602 y Fh(eval1)26
b Fn(to)i(evaluate)e(the)i(body)f(of)g(the)h(pr)o(ogram.)e(Otherwise,)i
(we)f(r)o(ecursively)g(inter)o(-)523 2702 y(pr)o(et)22
b(the)g(list)i(of)e(declarations.)g(Note)h(that)f(we)h(also)g(use)g
Fh(eval1)e Fn(to)i(interpr)o(et)f(the)h(body)523 2801
y(of)f(function)g(declarations.)f(It)h(is)g(also)g(instr)o(uctive)g(to)
g(note)g(the)g(thr)o(ee)f(places)g(wher)o(e)g(we)523
2901 y(use)h(the)g(envir)o(onment)g(extension)h(function)f
Fh(ext)g Fn(on)g(both)h(variable)d(and)i(function)g(en-)523
3001 y(vir)o(onments.)648 3102 y(The)k(above)g(interpr)o(eter)f(is)h(a)
g(complete)h(and)f(concise)g(speci\002cation)h(of)f(what)h(pr)o(o-)523
3202 y(grams)d(in)h(this)f(language)g(should)h(pr)o(oduce)e(when)i
(they)f(ar)o(e)f(executed.)f(Additionally)-9 b(,)523
3302 y(this)26 b(style)f(of)h(writing)g(interpr)o(eters)e(follows)i
(quite)g(closely)g(what)f(is)g(called)g(the)g(deno-)523
3401 y(tational)e(style)g(of)g(specifying)g(semantics,)g(for)g(which)g
(ther)o(e)f(is)i(vast)e(literatur)o(e)g(on)h(how)523
3501 y(to)k(specify)g(a)f(wide)h(range)f(of)h(pr)o(ogramming)g
(languages.)f(It)h(is)g(r)o(easonable)f(to)h(expect)523
3600 y(that)c(a)g(softwar)o(e)g(engineer)g(can)g(develop)g(such)h
(implementations)h(in)e(a)g(short)h(amount)523 3700 y(of)d(time.)648
3802 y(The)f(question)h(then)g(is)f(how)h(the)f(performance)f(of)h
(such)h(an)e(interpr)o(eter)g(fairs.)g(If)h(we)523 3901
y(evaluate)25 b(the)i(factorial)e(example)h(given)h(above,)f(we)g(will)
h(\002nd)g(that)g(it)f(r)o(uns)i(about)e(20)523 4001
y(times)d(slower)g(than)g(if)f(we)g(had)g(written)h(this)h(example)d
(dir)o(ectly)h(in)h(OCaml.)f(The)h(main)523 4101 y(r)o(eason)29
b(for)g(this)h(is)g(that)f(the)h(interpr)o(eter)e(r)o(epeatedly)g
(traverses)g(the)i(abstract)e(syntax)523 4200 y(tr)o(ee)19
b(during)h(evaluation.)g(Additionally)-9 b(,)20 b(envir)o(onment)h
(lookups)g(in)g(our)f(implementa-)523 4300 y(tion)i(ar)o(e)d(not)i
(constant-time.)648 4393 y(MSP)28 b(allows)i(us)g(to)g(keep)f(the)h
(conciseness)g(and)f(clarity)h(of)f(the)h(implementation)523
4485 y(given)h(above)e(and)h(also)g(r)o(egain)g(the)g(performance)g
(over)o(head)e(that)j(traditionally)f(we)523 4576 y(would)k(have)e(had)
h(to)g(pay)g(for)g(using)h(such)f(an)g(implementation.)h(The)f(over)o
(head)f(is)523 4667 y(avoided)20 b(by)h(staging)g(the)g(above)f
(function)i(as)e(follows:)523 4833 y Fl(let)44 b(rec)h(eval2)f(e)g(env)
h(fenv)f(=)523 4924 y(match)g(e)h(with)1943 5173 y Fn(8)p
eop end
%%Page: 9 9
TeXDict begin 9 8 bop 613 448 a Fl(Int)44 b(i)h(->)f(.<i>.)523
540 y(|)h(Var)f(s)h(->)f(env)h(s)523 631 y(|)g(App)f(\(s,e2\))g(->)g
(.<.\230\(fenv)g(s\).\230\(eval2)f(e2)h(env)h(fenv\)>.)523
722 y(...)523 814 y(|)g(Div)f(\(e1,e2\)->)f(.<.\230\(eval2)g(e1)i(env)f
(fenv\)/)g(.\230\(eval2)g(e2)g(env)g(fenv\)>.)523 905
y(|)h(Ifz)f(\(e1,e2,e3\))f(->)i(.<if)f(.\230\(eval2)f(e1)i(env)f
(fenv\)=0)1554 996 y(then)g(.\230\(eval2)g(e2)g(env)h(fenv\))1554
1088 y(else)f(.\230\(eval2)g(e3)g(env)h(fenv\)>.)523
1270 y(let)f(rec)h(peval2)f(p)g(env)h(fenv=)702 1362
y(match)f(p)h(with)747 1453 y(Program)f(\([],e\))g(->)g(eval2)g(e)h
(env)f(fenv)702 1544 y(|Program)g(\(Declaration)f(\(s1,s2,e1\)::tl,e\))
f(->)747 1636 y(.<let)i(rec)h(f)f(x)h(=)g(.\230\(eval2)e(e1)h(\(ext)h
(env)f(s2)g(.<x>.\))2002 1727 y(\(ext)h(fenv)f(s1)g(.<f>.\)\))837
1818 y(in)g(.\230\(peval2)g(\(Program\(tl,e\)\))e(env)i(\(ext)g(fenv)h
(s1)f(.<f>.\)\)>.)523 1970 y Fn(If)24 b(we)h(apply)f
Fh(peval2)f Fn(to)i(the)g(abstract)e(syntax)i(tr)o(ee)e(of)i(the)g
(factorial)e(example)h(\(given)523 2062 y(above\))c(and)h(the)g(empty)h
(envir)o(onments)g Fh(env0)e Fn(and)h Fh(fenv0)p Fn(,)f(we)h(get)g
(back)g(the)g(follow-)523 2153 y(ing)g(code)g(fragment:)523
2305 y Fl(.<let)44 b(rec)g(f)h(=)g(fun)f(x)h(->)f(if)h(\(x)f(=)h(0\))f
(then)g(1)h(else)f(\(x)h(*)f(\(f)h(\(x)f(-)h(1\)\)\))613
2396 y(in)f(\(f)h(10\)>.)523 2557 y Fn(This)33 b(is)h(exactly)e(the)h
(same)g(code)f(that)h(we)g(would)g(have)f(written)i(by)f(hand)f(for)h
(that)523 2657 y(speci\002c)19 b(pr)o(ogram.)f(Running)i(this)g(pr)o
(ogram)e(has)h(exactly)f(the)h(same)g(performance)f(as)g(if)523
2756 y(we)j(had)f(written)h(the)g(pr)o(ogram)f(dir)o(ectly)g(in)h
(OCaml.)648 2856 y(Note)f(that)g(the)g(staged)f(interpr)o(eter)g(is)h
(a)g(function)g(that)g(takes)g(abstract)f(syntax)h(tr)o(ees)523
2955 y(and)f(pr)o(oduces)f(MetaOCaml)g(pr)o(ograms.)h(This)h(gives)f
(rise)g(to)h(a)f(simple)g(but)h(often)f(over)o(-)523
3055 y(looked)i(fact:)p 1307 3130 1315 4 v 1307 3264
4 134 v 1335 3215 a(A)f(staged)g(interpr)o(eter)g(is)h(a)f(translator)p
2618 3264 V 1307 3267 1315 4 v 523 3397 a(W)-5 b(ith)20
b(a)e(car)o(eful)g(analysis)h(of)g(the)g(staged)f(interpr)o(eter)-6
b(,)17 b(the)i(r)o(eader)e(can)i(convince)g(herself)523
3496 y(that)k(the)g(translator)g(we)g(have)f(just)i(implemented)f(intr)
o(oduces)g(no)g(unnecessary)g(work)523 3596 y(in)e(its)g(r)o(esult.)648
3696 y(It)26 b(is)h(important)g(to)g(keep)f(in)h(mind)g(that)g(the)f
(above)g(example)g(is)h(quite)g(simplistic,)523 3795
y(and)i(that)g(ther)o(e)g(ar)o(e)f(a)h(lot)h(of)f(inter)o(esting)h
(technical)f(issues)h(that)g(arise)e(when)j(we)e(try)523
3895 y(to)g(apply)g(MSP)f(to)i(r)o(ealistic)e(pr)o(ogramming)h
(languages.)g(Characterizing)f(what)h(MSP)523 3995 y(cannot)21
b(do)f(is)h(dif)o(\002cult,)f(because)f(of)i(the)f(need)g(for)g
(technical)h(expr)o(essivity)e(ar)o(guments.)523 4094
y(W)-8 b(e)20 b(take)g(the)g(mor)o(e)g(practical)e(appr)o(oach)h(of)h
(explaining)g(what)g(MSP)g(can)f(do,)h(and)g(hope)523
4194 y(that)h(this)g(gives)g(the)g(r)o(eader)e(a)h(better)g(idea)g(of)h
(the)g(scope)f(of)h(this)h(technology)-9 b(.)648 4285
y(Returning)32 b(to)g(our)f(example)f(language,)h(a)g(generally)g
(desirable)f(featur)o(e)g(of)h(pr)o(o-)523 4376 y(gramming)23
b(languages)g(is)g(err)o(or)e(handling.)i(For)g(example,)e(the)i
(original)g(implementa-)523 4468 y(tion)i(of)f(the)f(interpr)o(eter)g
(uses)h(the)g(division)h(operation.)f(Because)e(the)i(division)h
(opera-)523 4559 y(tion)k(can)e(raise)g(a)g(divide-by-zer)o(o)e
(exception,)j(if)f(the)h(interpr)o(eter)e(is)i(part)f(of)h(a)f(bigger)
523 4650 y(system,)f(we)f(might)h(want)f(to)h(have)e(\002ner)h(contr)o
(ol)h(over)f(err)o(or)o(-handling.)f(In)h(this)h(case,)523
4742 y(we)20 b(would)h(modify)g(our)f(original)h(interpr)o(eter)e(to)i
(perform)f(a)g(check)g(befor)o(e)f(a)h(division,)523
4833 y(and)e(r)o(eturn)f(a)h(special)f(value)h Fh(None)f
Fn(if)h(the)g(division)h(could)g(not)f(be)g(performed.)f(Regular)523
4924 y(values)i(that)g(used)g(to)h(be)f(simply)i Fh(v)e
Fn(will)h(now)g(be)f(r)o(epr)o(esented)e(by)j Fh(Some)p
Fn(v\227.)e(Note)i(also)1943 5173 y(9)p eop end
%%Page: 10 10
TeXDict begin 10 9 bop 523 448 a Fn(that)25 b(such)h(a)f(value)f(would)
i(have)f(to)g(be)g(pr)o(opagated)e(and)i(dealt)g(with)g(everywher)o(e)f
(in)523 540 y(the)d(interpr)o(eter:)523 692 y Fl(let)44
b(rec)h(eval3)f(e)g(env)h(fenv)f(=)523 784 y(match)g(e)h(with)613
875 y(Int)f(i)h(->)f(Some)g(i)523 966 y(|)h(Var)f(s)h(->)f(Some)g
(\(env)h(s\))523 1058 y(|)g(App)f(\(s,e2\))g(->)g(\(match)g(\(eval3)g
(e2)g(env)h(fenv\))f(with)1375 1149 y(Some)g(x)h(->)f(\(fenv)g(s\))h(x)
1285 1240 y(|)g(None)134 b(->)44 b(None\))523 1332 y(|)h(Add)f
(\(e1,e2\))g(->)g(\(match)g(\(eval3)g(e1)g(env)h(fenv,)f(eval3)g(e2)g
(env)g(fenv\))1375 1423 y(with)g(\(Some)g(x,)g(Some)h(y\))f(->)h(Some)f
(\(x+y\))1554 1514 y(|)h(_)f(->)h(None\))523 1605 y(...)523
1697 y(|)g(Div)f(\(e1,e2\))g(->)g(\(match)g(\(eval3)g(e1)g(env)h(fenv,)
f(eval3)g(e2)g(env)g(fenv\))1375 1788 y(with)g(\(Some)g(x,)g(Some)h
(y\))f(->)1689 1879 y(if)g(y=0)g(then)h(None)1733 1971
y(else)g(Some)f(\(x/y\))1509 2062 y(|)h(_)g(->)f(None\))523
2153 y(|)h(Ifz)f(\(e1,e2,e3\))f(->)i(\(match)e(\(eval3)h(e1)h(env)f
(fenv\))g(with)1509 2245 y(Some)g(x)h(->)g(if)f(x=0)g(then)h(\(eval3)e
(e2)i(env)f(fenv\))2092 2336 y(else)g(\(eval3)g(e3)h(env)f(fenv\))1465
2427 y(|)g(None)134 b(->)44 b(None\))523 2580 y Fn(Compar)o(ed)22
b(to)i(the)f(original)h(\(unstaged)f(interpr)o(eter\),)e(the)j
(performance)e(over)o(head)g(of)523 2671 y(adding)30
b(such)g(checks)h(is)f(mar)o(ginal.)f(But)h(what)h(we)f(r)o(eally)f
(car)o(e)g(about)h(is)g(the)g(staged)523 2763 y(setting.)21
b(Staging)g Fh(eval3)f Fn(yields:)523 2915 y Fl(let)44
b(rec)h(eval4)f(e)g(env)h(fenv)f(=)523 3007 y(match)g(e)h(with)613
3098 y(Int)f(i)h(->)f(.<Some)g(i>.)523 3189 y(|)h(Var)f(s)h(->)f
(.<Some)g(.\230\(env)g(s\)>.)523 3281 y(|)h(App)f(\(s,e2\))g(->)g
(.<\(match)g(.\230\(eval4)f(e2)i(env)f(fenv\))g(with)1465
3372 y(Some)g(x)g(->)h(.\230\(fenv)e(s\))i(x)1375 3463
y(|)g(None)133 b(->)45 b(None\)>.)523 3554 y(|)g(Add)f(\(e1,e2\))g(->)g
(.<\(match)g(\(.\230\(eval4)f(e1)h(env)h(fenv\),)1733
3646 y(.\230\(eval4)f(e2)g(env)h(fenv\)\))f(with)1465
3737 y(\(Some)f(x,)i(Some)f(y\))h(->)f(Some)g(\(x+y\))1420
3828 y(|)g(_)h(->)f(None\)>.)523 3920 y(...)523 4011
y(|)h(Div)f(\(e1,e2\))g(->)g(.<\(match)g(\(.\230\(eval4)f(e1)h(env)h
(fenv\),)1733 4102 y(.\230\(eval4)f(e2)g(env)h(fenv\)\))f(with)1465
4194 y(\(Some)f(x,)i(Some)f(y\))h(->)1554 4285 y(if)g(y=0)f(then)g
(None)1868 4376 y(else)g(Some)g(\(x/y\))1420 4468 y(|)g(_)h(->)f
(None\)>.)523 4559 y(|)h(Ifz)f(\(e1,e2,e3\))f(->)i(.<\(match)e
(.\230\(eval4)h(e1)g(env)g(fenv\))g(with)1599 4650 y(Some)g(x)h(->)f
(if)h(x=0)f(then)2137 4742 y(.\230\(eval4)f(e2)i(env)f(fenv\))2047
4833 y(else)2182 4924 y(.\230\(eval4)f(e3)i(env)f(fenv\))1922
5173 y Fn(10)p eop end
%%Page: 11 11
TeXDict begin 11 10 bop 1509 448 a Fl(|)45 b(None)134
b(->)44 b(None\)>.)523 576 y Fn(Unfortunately)27 b(we)f(\002nd)i(that)e
(the)h(performance)f(of)h(code)f(generated)g(by)h(this)g(staged)523
667 y(interpr)o(eter)18 b(is)h(4)f(times)i(slower)f(than)g(the)g
(\002rst)g(staged)g(interpr)o(eter)e(\(with)j(no)f(err)o(or)f(han-)523
759 y(dling\).)25 b(The)h(sour)o(ce)f(of)g(the)h(r)o(untime)g(cost)g
(becomes)f(appar)o(ent)f(when)i(we)f(look)i(at)e(the)523
850 y(generated)20 b(code:)523 978 y Fl(.<let)44 b(rec)g(f)h(=)658
1069 y(fun)f(x)h(->)702 1160 y(\(match)f(\(Some)g(\(x\)\))g(with)837
1252 y(Some)g(\(x\))g(->)882 1343 y(if)g(\(x)h(=)f(0\))h(then)f(\(Some)
g(\(1\)\))882 1434 y(else)927 1526 y(\(match)1061 1617
y(\(\(Some)g(\(x\)\),)1106 1708 y(\(match)1240 1800 y(\(match)g
(\(\(Some)g(\(x\)\),)g(\(Some)g(\(1\)\)\))g(with)1375
1891 y(\(Some)g(\(x\),)g(Some)g(\(y\)\))g(->)1420 1982
y(\(Some)g(\(\(x)g(-)h(y\)\)\))1285 2074 y(|)g(_)g(->)f(\(None\)\))g
(with)1240 2165 y(Some)h(\(x\))f(->)g(\(f)h(x\))1151
2256 y(|)f(None)h(->)f(\(None\)\)\))f(with)1061 2348
y(\(Some)h(\(x\),)g(Some)g(\(y\)\))g(->)1106 2439 y(\(Some)g(\(\(x)g(*)
h(y\)\)\))971 2530 y(|)g(_)g(->)f(\(None\)\))747 2621
y(|)h(None)f(->)h(\(None\)\))e(in)613 2713 y(\(match)h(\(Some)g
(\(10\)\))g(with)747 2804 y(Some)g(\(x\))h(->)f(\(f)h(x\))658
2895 y(|)f(None)g(->)h(\(None\)\)>.)523 3031 y Fn(The)30
b(generated)f(code)h(is)g(doing)h(much)f(mor)o(e)g(work)g(than)g(befor)
o(e,)f(because)g(at)h(every)523 3131 y(operation)20 b(we)g(ar)o(e)f
(checking)i(to)f(see)g(if)g(the)g(values)g(we)g(ar)o(e)e(operating)i
(with)h(ar)o(e)e(pr)o(oper)523 3231 y(values)g(or)g(not.)h(On)f(closer)
h(inspection,)f(however)-6 b(,)19 b(we)g(see)g(that)g(which)h(branch)f
(we)g(take)523 3330 y(in)i(every)f Fh(match)g Fn(is)h(determined.)648
3430 y(One)27 b(solution)j(to)e(such)g(a)f(pr)o(oblem)g(is)h(certainly)
f(adding)g(a)g(pr)o(e-pr)o(ocessing)g(anal-)523 3530
y(ysis.)j(But)g(if)g(we)g(can)f(avoid)h(generating)g(such)g(inef)o
(\002cient)g(code)f(in)h(the)g(\002rst)h(place)e(it)523
3629 y(would)d(save)e(the)h(time)g(wasted)g(both)h(in)f(generating)g
(these)g(unnecessary)g(checks)g(and)523 3729 y(in)f(performing)g(the)f
(analysis.)h(Mor)o(e)e(importantly)-9 b(,)24 b(with)g(an)f(analysis,)h
(we)f(may)g(never)523 3828 y(be)28 b(certain)f(that)h(all)f
(unnecessary)h(computation)h(is)f(eliminated)g(fr)o(om)f(the)h
(generated)523 3928 y(code.)648 4028 y(On)e(closer)g(inspection)h(of)f
(the)g(staged)f(pr)o(ogram,)g(we)h(\002nd)g(that)g(the)g(sour)o(ce)g
(of)g(the)523 4127 y(pr)o(oblem)g(is)g(the)h Fh(if)f
Fn(statement)g(that)g(appears)f(in)h(the)h(interpr)o(etation)f(of)g
Fh(Div)p Fn(.)f(In)i(par)o(-)523 4227 y(ticular)-6 b(,)23
b(because)f Fh(y)h Fn(is)h(bound)f(at)g(the)h(second)f(level)g(\(that)g
(is,)g(inside)h(code\),)e(we)i(cannot)523 4327 y(perform)d(the)g(test)g
Fh(y=0)f Fn(early)-9 b(.)20 b(As)h(a)g(r)o(esult,)f(we)h(cannot)h
(determine)e(if)h(we)g(will)h(r)o(eturn)e(a)523 4426
y Fh(None)g Fn(or)h(a)f Fh(Some)g Fn(value.)648 4526
y(The)29 b(pr)o(oblem)g(can)g(be)h(avoided)e(by)i(what)f(is)h(called)f
(a)g Fj(binding-time)g(impr)o(ovement)523 4625 y Fn(in)23
b(the)g(partial)f(evaluation)g(literatur)o(e.)f(It)i(is)g(essentially)g
(a)f(transformation)h(of)g(the)g(pr)o(o-)523 4725 y(gram)33
b(that)g(we)g(ar)o(e)f(staging.)h(The)g(goal)h(of)f(this)h
(transformation)f(is)h(to)f(allow)h(better)523 4825 y(staging.)24
b(In)f(the)g(case)g(of)g(the)h(above)e(example,)h(we)g(simply)h(r)o
(ewrite)e(the)i(interpr)o(eter)d(in)523 4924 y(continuation-passing)h
(style)f(\(CPS\),)f(which)i(pr)o(oduces)d(the)i(following)i(code:)1922
5173 y(11)p eop end
%%Page: 12 12
TeXDict begin 12 11 bop 523 448 a Fl(let)44 b(rec)h(eval5)f(e)g(env)h
(fenv)f(k)g(=)523 540 y(match)g(e)h(with)613 631 y(Int)f(i)h(->)f(k)h
(\(Some)f(i\))523 722 y(|)h(Var)f(s)h(->)f(k)h(\(Some)f(\(env)g(s\)\))
523 814 y(|)h(App)f(\(s,e2\))g(->)g(eval5)g(e2)h(env)f(fenv)1330
905 y(\(fun)g(r)h(->)f(match)g(r)h(with)1420 996 y(Some)f(x)g(->)h(k)g
(\(Some)f(\(\(fenv)f(s\))i(x\)\))1330 1088 y(|)g(None)133
b(->)45 b(k)g(None\))523 1179 y(|)g(Add)f(\(e1,e2\))g(->)g(eval5)g(e1)h
(env)f(fenv)1375 1270 y(\(fun)g(r)h(->)1465 1362 y(eval5)e(e2)i(env)f
(fenv)1554 1453 y(\(fun)g(s)h(->)f(match)g(\(r,s\))g(with)1644
1544 y(\(Some)g(x,)g(Some)g(y\))h(->)f(k)h(\(Some)f(\(x+y\)\))1599
1636 y(|)h(_)f(->)h(k)f(None\)\))523 1727 y(...)523 1818
y(|)h(Div)f(\(e1,e2\))g(->)g(eval5)g(e1)h(env)f(fenv)1375
1910 y(\(fun)g(r)h(->)1465 2001 y(eval5)e(e2)i(env)f(fenv)1554
2092 y(\(fun)g(s)h(->)f(match)g(\(r,s\))g(with)1644 2183
y(\(Some)g(x,)g(Some)g(y\))h(->)1733 2275 y(if)g(y=0)f(then)g(k)h(None)
2137 2366 y(else)f(k)h(\(Some)f(\(x/y\)\))1599 2457 y(|)h(_)f(->)h(k)f
(None\)\))523 2549 y(...)523 2731 y(let)g(rec)h(pevalK5)e(p)i(env)f
(fenv)g(k)h(=)702 2823 y(match)f(p)h(with)747 2914 y(Program)f
(\([],e\))g(->)g(eval5)g(e)h(env)f(fenv)g(k)702 3005
y(|Program)g(\(Declaration)f(\(s1,s2,e1\)::tl,e\))f(->)882
3097 y(let)i(rec)g(f)h(x)g(=)f(eval5)g(e1)h(\(ext)f(env)g(s2)h(x\))f
(\(ext)g(fenv)h(s1)f(f\))h(k)971 3188 y(in)g(pevalK5)f
(\(Program\(tl,e\)\))e(env)i(\(ext)g(fenv)g(s1)h(f\))f(k)523
3371 y(exception)f(Div_by_zero;;)523 3553 y(let)h(peval5)g(p)h(env)f
(fenv)g(=)747 3645 y(pevalK5)g(p)h(env)f(fenv)g(\(function)f(Some)h(x)h
(->)g(x)1958 3736 y(|)f(None)g(->)h(raise)f(Div_by_zero\))523
3928 y Fn(In)23 b(the)h(unstaged)f(setting,)g(the)h(performance)e(of)h
(this)h(interpr)o(eter)e(is)h(even)g(worse)h(than)523
4019 y(the)29 b(last)f(one.)h(In)g(terms)f(of)h(staging,)g(however)-6
b(,)28 b(we)g(can)h(stage)f(the)g(expr)o(ession)h(inter)o(-)523
4110 y(pr)o(eter)19 b(as)i(follows:)523 4285 y Fl(let)44
b(rec)h(eval6)f(e)g(env)h(fenv)f(k)g(=)523 4376 y(match)g(e)h(with)613
4468 y(Int)f(i)h(->)f(k)h(\(Some)f(.<i>.\))523 4559 y(|)h(Var)f(s)h(->)
f(k)h(\(Some)f(\(env)g(s\)\))523 4650 y(|)h(App)f(\(s,e2\))g(->)g
(eval6)g(e2)h(env)f(fenv)1330 4742 y(\(fun)g(r)h(->)f(match)g(r)h(with)
1420 4833 y(Some)f(x)g(->)h(k)g(\(Some)f(.<.\230\(fenv)f(s\))h
(.\230x>.\))1330 4924 y(|)h(None)133 b(->)45 b(k)g(None\))1922
5173 y Fn(12)p eop end
%%Page: 13 13
TeXDict begin 13 12 bop 523 448 a Fl(|)45 b(Add)f(\(e1,e2\))g(->)g
(eval6)g(e1)h(env)f(fenv)1375 540 y(\(fun)g(r)h(->)1465
631 y(eval6)e(e2)i(env)f(fenv)1554 722 y(\(fun)g(s)h(->)f(match)g
(\(r,s\))g(with)1644 814 y(\(Some)g(x,)g(Some)g(y\))h(->)1733
905 y(k)g(\(Some)f(.<.\230x)g(+)h(.\230y>.\))1599 996
y(|)g(_)f(->)h(k)f(None\)\))523 1088 y(...)523 1179 y(|)h(Div)f
(\(e1,e2\))g(->)g(eval6)g(e1)h(env)f(fenv)1375 1270 y(\(fun)g(r)h(->)
1465 1362 y(eval6)e(e2)i(env)f(fenv)1554 1453 y(\(fun)g(s)h(->)f(match)
g(\(r,s\))g(with)1644 1544 y(\(Some)g(x,)g(Some)g(y\))h(->)1733
1636 y(.<if)g(.\230y=0)f(then)g(.\230\(k)g(None\))1823
1727 y(else)g(.\230\(k)g(\(Some)g(.<.\230x)g(/)h(.\230y>.\)\)>.)1599
1818 y(|)g(_)f(->)h(k)f(None\)\))523 1910 y(|)h(Ifz)f(\(e1,e2,e3\))f
(->)i(eval6)f(e1)g(env)g(fenv)1509 2001 y(\(fun)g(r)h(->)g(match)f(r)g
(with)1599 2092 y(Some)g(x)h(->)f(.<if)g(.\230x=0)g(then)2271
2183 y(.\230\(eval6)g(e2)g(env)h(fenv)f(k\))2137 2275
y(else)2271 2366 y(.\230\(eval6)g(e3)g(env)h(fenv)f(k\)>.)1554
2457 y(|)h(None)134 b(->)44 b(k)h(None\))523 2617 y Fn(What)27
b(we)g(could)h(not)f(do)h(her)o(e)e(that)h(we)g(could)h(do)f(befor)o(e)
f(is)h(to)h(Escape)e(the)h(applica-)523 2709 y(tion)32
b(of)g(the)g(continuation)h(to)f(the)f(branches)g(of)h(the)g
Fh(if)f Fn(statement)g(that)h(was)f(pr)o(evi-)523 2800
y(ously)24 b(pr)o(oblematic.)e(Maybe)g(surprisingly)-9
b(,)24 b(the)g(generated)e(code)h(is)g(exactly)g(the)g(same)523
2891 y(as)30 b(what)h(we)g(got)g(fr)o(om)f(the)h(\002rst)g(interpr)o
(eter)-6 b(.)28 b(This)k(will)f(always)f(be)h(the)f(case)g(when)523
2983 y(the)21 b(sour)o(ce)f(pr)o(ogram)g(does)h(not)h(use)f(the)g
(division)g(operation.)g(When)g(we)g(use)g(division)523
3074 y(operations)32 b(\(say)-9 b(,)31 b(if)g(we)g(r)o(eplace)f(the)i
(code)f(in)h(the)g(body)g(of)f(the)h(fact)e(example)h(with)523
3165 y Fh(fact)49 b(\(20/2\))20 b Fn(we)h(get)f(the)h(following)h
(code:)523 3326 y Fl(.<let)44 b(rec)g(f)h(=)658 3417
y(fun)f(x)h(->)f(if)h(\(x)f(=)h(0\))f(then)g(1)h(else)f(\(x)h(*)f(\(f)h
(\(x)f(-)h(1\)\)\))613 3508 y(in)f(if)h(\(2)f(=)h(0\))f(then)h(\(raise)
e(\(Div_by_zero\)\))g(else)h(\(f)g(\(10)h(/)f(2\)\)>.)648
3668 y Fn(So)28 b(far)g(we)h(have)g(focused)f(on)i(eliminating)g
(unnecessary)f(work)g(fr)o(om)g(generated)523 3759 y(pr)o(ograms.)c
(Can)g(we)g(do)g(better?)g(One)g(way)g(in)h(which)g(MSP)f(can)g(help)g
(us)h(do)f(better)g(is)523 3851 y(by)18 b(allowing)h(us)g(to)f(unfold)g
(function)h(declarations)f(for)g(a)f(\002xed)h(number)g(of)g(times.)g
(This)523 3942 y(is)j(easy)g(to)g(incorporate)f(into)i(the)f(\002rst)g
(staged)f(interpr)o(eter)f(as)i(follows:)523 4102 y Fl(let)44
b(rec)h(eval7)f(e)g(env)h(fenv)f(=)523 4194 y(match)g(e)h(with)523
4285 y(...)f(most)h(cases)f(the)g(same)g(as)g(eval2,)g(except)523
4376 y(|)h(App)f(\(s,e2\))g(->)g(fenv)h(s)f(\(eval7)g(e2)g(env)h
(fenv\))523 4559 y(let)f(rec)h(inline)f(n)g(body)g(=)613
4650 y(if)g(n=0)h(then)f(body)g(else)g(fun)g(x)h(->)f(body)h(\(inline)e
(\(n-1\))h(body)g(x\))523 4833 y(let)g(rec)h(peval7)f(p)g(env)h(fenv=)
702 4924 y(match)f(p)h(with)1922 5173 y Fn(13)p eop end
%%Page: 14 14
TeXDict begin 14 13 bop 747 448 a Fl(Program)44 b(\([],e\))g(->)g
(eval7)g(e)h(env)f(fenv)702 540 y(|Program)g(\(Declaration)f
(\(s1,s2,e1\)::tl,e\))f(->)882 631 y(.<let)i(rec)g(f)h(x)f(=)1061
722 y(.\230\(let)g(body)g(cf)g(x)h(=)1420 814 y(eval7)f(e1)g(\(ext)g
(env)h(s2)f(x\))h(\(ext)f(fenv)g(s1)g(cf\))h(in)1196
905 y(inline)e(1)i(body)f(\(fun)g(y)h(->)f(.<f)h(.\230y>.\))f(.<x>.\))
971 996 y(in)h(.\230\(peval7)e(\(Program\(tl,e\)\))f(env)1554
1088 y(\(ext)i(fenv)g(s1)h(\(fun)f(y)h(->)f(.<f)h(.\230y>.\)\)\)>.)523
1237 y Fn(The)21 b(code)f(generated)g(for)g(the)h(factorial)f(example)g
(is)h(as)g(follows:)523 1387 y Fl(.<let)44 b(rec)g(f)h(=)658
1478 y(fun)f(x)h(->)702 1569 y(if)g(\(x)f(=)h(0\))g(then)f(1)702
1661 y(else)747 1752 y(\(x*\(if)g(\(\(x-1\)=0\))f(then)h(1)h(else)f
(\(x-1\)*\(f)g(\(\(x-1\)-1\)\)\)\)\))613 1843 y(in)g(\(f)h(10\)>.)523
2001 y Fn(This)25 b(code)f(r)o(uns)h(faster)e(than)i(that)f(pr)o
(oduced)f(by)h(the)h(\002rst)f(staged)g(interpr)o(eter)-6
b(.)22 b(It)j(also)523 2101 y(points)31 b(out)f(an)f(important)h(issue)
g(that)f(the)h(multi-stage)g(pr)o(ogrammer)e(must)j(pay)e(at-)523
2201 y(tention)23 b(to:)e(code)g(duplication.)h(Notice)f(that)h(the)f
(term)h Fh(x-1)f Fn(occurs)g(thr)o(ee)g(times)h(in)g(the)523
2300 y(generated)e(code.)g(In)h(the)g(r)o(esult)f(of)h(the)g(\002rst)g
(staged)f(interpr)o(eter)-6 b(,)19 b(the)i(subtraction)g(only)523
2400 y(occurr)o(ed)26 b(once.)i(The)g(duplication)g(of)g(this)g(term)g
(is)g(a)f(r)o(esult)g(of)h(the)g(inlining)h(that)f(we)523
2500 y(perform)h(on)i(the)e(body)h(of)g(the)g(function.)g(If)f(the)h
(ar)o(gument)f(to)h(a)f(r)o(ecursive)g(call)g(was)523
2599 y(even)22 b(bigger)-6 b(,)22 b(then)g(code)g(duplication)h(would)g
(have)e(a)h(mor)o(e)g(dramatic)f(ef)o(fect)f(both)j(on)523
2699 y(the)e(time)g(needed)f(to)h(compile)g(the)g(pr)o(ogram)f(and)g
(the)h(time)g(needed)f(to)h(r)o(un)h(it.)648 2790 y(A)k(simple)h
(solution)h(to)f(this)h(pr)o(oblem)e(comes)h(fr)o(om)g(the)g(partial)e
(evaluation)i(com-)523 2881 y(munity:)h(we)g(can)f(generate)f
Fh(let)h Fn(statements)h(that)f(r)o(eplace)f(the)h(expr)o(ession)g
(about)h(to)523 2973 y(be)g(duplicated)f(by)h(a)g(simple)g(variable.)f
(This)h(is)h(only)g(a)e(small)i(change)f(to)g(the)g(staged)523
3064 y(interpr)o(eter)19 b(pr)o(esented)h(above:)523
3214 y Fl(let)44 b(rec)h(eval8)f(e)g(env)h(fenv)f(=)523
3305 y(match)g(e)h(with)523 3396 y(...)f(same)h(as)f(eval7)g(except)g
(for)523 3488 y(|)h(App)f(\(s,e2\))g(->)g(.<let)g(x=)h(.\230\(eval8)e
(e2)i(env)f(fenv\))1330 3579 y(in)h(.\230\(fenv)e(s)i(.<x>.\)>.)523
3670 y(...)523 3828 y Fn(Unfortunately)-9 b(,)24 b(in)g(the)h(curr)o
(ent)e(implementation)i(of)g(MetaOCaml)e(this)i(change)f(does)523
3928 y(not)19 b(lead)e(to)h(a)f(performance)g(impr)o(ovement.)h(The)g
(most)h(likely)f(r)o(eason)f(is)i(that)e(the)h(byte-)523
4028 y(code)23 b(compiler)g(does)f(not)i(seem)f(to)g(perform)f
Fh(let)p Fn(-\003oating.)h(In)g(the)g(native)f(code)h(com-)523
4127 y(piler)h(for)g(MetaOCaml)g(\(curr)o(ently)f(under)h
(development\))g(we)h(expect)e(this)i(change)g(to)523
4227 y(be)20 b(an)h(impr)o(ovement.)648 4318 y(Finally)-9
b(,)32 b(both)h(err)o(or)e(handling)i(and)f(inlining)j(can)d(be)g
(combined)g(into)i(the)e(same)523 4409 y(implementation:)523
4559 y Fl(let)44 b(rec)h(eval9)f(e)g(env)h(fenv)f(k)g(=)523
4650 y(match)g(e)h(with)523 4742 y(...)f(same)h(as)f(eval6,)g(except)
523 4833 y(|)h(App)f(\(s,e2\))g(->)g(eval9)g(e2)h(env)f(fenv)1330
4924 y(\(fun)g(r)h(->)f(match)g(r)h(with)1922 5173 y
Fn(14)p eop end
%%Page: 15 15
TeXDict begin 15 14 bop 1420 448 a Fl(Some)44 b(x)g(->)h(k)g(\(Some)f
(\(\(fenv)f(s\))i(x\)\))1330 540 y(|)g(None)133 b(->)45
b(k)g(None\))523 722 y(let)f(rec)h(pevalK9)e(p)i(env)f(fenv)g(k)h(=)702
814 y(match)f(p)h(with)747 905 y(Program)f(\([],e\))g(->)g(eval9)g(e)h
(env)f(fenv)g(k)702 996 y(|Program)g(\(Declaration)f
(\(s1,s2,e1\)::tl,e\))f(->)882 1088 y(.<let)i(rec)g(f)h(x)f(=)971
1179 y(.\230\(let)g(body)g(cf)h(x)f(=)1330 1270 y(eval9)g(e1)g(\(ext)h
(env)f(s2)g(x\))h(\(ext)f(fenv)g(s1)h(cf\))f(k)h(in)1106
1362 y(inline)f(1)g(body)g(\(fun)h(y)f(->)h(.<f)f(.\230y>.\))g(.<x>.\))
971 1453 y(in)h(.\230\(pevalK9)e(\(Program\(tl,e\)\))f(env)1599
1544 y(\(ext)i(fenv)g(s1)h(\(fun)f(y)h(->)f(.<f)g(.\230y>.\)\))g(k\)>.)
523 1914 y Fi(1.6)82 b(Measuring)19 b(Performance)523
2192 y Fn(MetaOCaml)24 b(pr)o(ovides)g(support)i(for)e(collecting)i
(performance)e(data,)g(so)h(that)g(we)g(can)523 2283
y(verify)h(that)h(staging)h(a)e(pr)o(ogram)h(actually)f(r)o(esults)h
(in)g(changing)h(the)f(time)h(it)f(takes)g(to)523 2374
y(compute)f(it.)g(This)g(is)g(done)g(using)g(thr)o(ee)f(simple)h
(functions.)g(The)g(\002rst)g(function)g(must)523 2466
y(be)20 b(called)g(befor)o(e)g(we)h(start)f(collecting)i(timings.)g(It)
e(is)h(called)f(as)h(follows:)523 2719 y Fl(Trx.init_times)43
b(\(\);;)523 2949 y Fn(The)23 b(second)g(function)g(is)g(invoked)g
(when)g(we)g(want)g(to)g(gather)f(timings.)i(Her)o(e)e(we)g(call)523
3041 y(it)g(twice)h(on)g(both)g Fh(power2)48 b(\(3\))22
b Fn(and)g Fh(power2'\(3\))e Fn(wher)o(e)i Fh(power2')f
Fn(is)h(the)g(staged)523 3132 y(version:)523 3386 y Fl(Trx.timenew)43
b("Normal")h(\(fun)g(\(\))g(->\(power2)88 b(\(3\)\)\);;)523
3477 y(Trx.timenew)43 b("Staged")h(\(fun)g(\(\))g(->\(power2')f
(\(3\)\)\);;)523 3707 y Fn(Each)16 b(call)g(causes)g(the)g(ar)o(gument)
g(passed)f(last)i(to)f(be)g(r)o(un)h(as)f(many)g(times)h(as)f(this)h
(system)523 3799 y(needs)22 b(to)h(gather)f(a)g(r)o(eliable)f(timing.)i
(The)g(quoted)g(strings)g(simply)g(pr)o(ovide)f(hints)h(that)523
3890 y(will)f(be)f(printed)f(when)i(we)f(decide)f(to)i(print)f(the)g
(summary)h(of)f(the)g(timings.)h(The)f(thir)o(d)523 3981
y(function)h(prints)f(a)f(summary)h(of)g(timings:)523
4235 y Fl(Trx.print_times)42 b(\(\);;)523 4473 y Fn(The)27
b(following)h(table)f(summarizes)g(timings)h(for)f(the)g(various)g
(functions)h(consider)o(ed)523 4573 y(in)21 b(the)g(pr)o(evious)g
(section:)1373 4543 y Ff(2)p 523 4746 473 4 v 558 4801
a Fe(2)606 4833 y Fm(System)f(speci\002cations:)h(MetaOCaml)g(bytecode)
f(interpr)o(eter)f(r)o(unning)j(under)e(Cygwin)g(on)i(a)606
4924 y(Pentium)d(III)h(machine,)f(Mobile)f(CPU,)g(1133MHz)j(clock,)c
(175)j(MHz)f(bus,)f(640)i(MB)e(RAM.)1922 5173 y Fn(15)p
eop end
%%Page: 16 16
TeXDict begin 16 15 bop 852 369 2224 4 v 850 468 4 100
v 884 438 a Fi(Program)p 1238 468 V 65 w(Description)19
b(of)i(Interpreter)p 2281 468 V 93 w Fh(Fact10)p 2702
468 V 121 w(Fib20)p 3074 468 V 852 472 2224 4 v 850 571
4 100 v 934 541 a Fj(\(none\))p 1238 571 V 100 w Fn(OCaml)g
(implementations)p 2281 571 V 302 w(100\045)p 2702 571
V 175 w(100\045)p 3074 571 V 850 671 V 914 641 a Fh(eval1)p
1238 671 V 87 w Fn(Simple)p 2281 671 V 888 w(1,570\045)p
2702 671 V 134 w(1,736\045)p 3074 671 V 850 770 V 914
741 a Fh(eval2)p 1238 770 V 87 w Fn(Simple)g(staged)p
2281 770 V 689 w(100\045)p 2702 770 V 175 w(100\045)p
3074 770 V 850 870 V 914 840 a Fh(eval3)p 1238 870 V
87 w Fn(Err)o(or)f(handling)i(\(EH\))p 2281 870 V 400
w(1,903\045)p 2702 870 V 134 w(2,138\045)p 3074 870 V
850 970 V 914 940 a Fh(eval4)p 1238 970 V 87 w Fn(EH)f(staged)p
2281 970 V 824 w(417\045)p 2702 970 V 175 w(482\045)p
3074 970 V 850 1069 V 914 1039 a Fh(eval5)p 1238 1069
V 87 w Fn(CPS)g(EH)p 2281 1069 V 849 w(2,470\045)p 2702
1069 V 134 w(2,814\045)p 3074 1069 V 850 1169 V 914 1139
a Fh(eval6)p 1238 1169 V 87 w Fn(CPS)g(EH)f(staged)p
2281 1169 V 651 w(100\045)p 2702 1169 V 175 w(100\045)p
3074 1169 V 850 1269 V 914 1239 a Fh(eval7)p 1238 1269
V 87 w Fn(Inlining)p 2281 1269 V 957 w(87\045)p 2702
1269 V 218 w(85\045)p 3074 1269 V 850 1368 V 914 1338
a Fh(eval8)p 1238 1368 V 87 w Fn(Inlining,)i(no)g(duplication)p
2281 1368 V 377 w(97\045)p 2702 1368 V 218 w(97\045)p
3074 1368 V 850 1468 V 914 1438 a Fh(eval9)p 1238 1468
V 87 w Fn(Inlining,)g(CPS)p 2281 1468 V 761 w(90\045)p
2702 1468 V 218 w(85\045)p 3074 1468 V 852 1471 2224
4 v 523 1621 a(T)-5 b(imings)25 b(ar)o(e)d(normalized)g(r)o(elative)g
(to)i(writing)g(the)f(two)h(example)e(pr)o(ograms)h(that)g(we)523
1721 y(ar)o(e)c(interpr)o(eting)i(\()p Fh(Fact10)e Fn(and)h
Fh(Fib20)p Fn(\).)523 1994 y Fi(1.7)82 b(Recognizing)19
b(Opportunities)f(for)j(Using)f(MSP)523 2185 y Fn(The)27
b(extent)f(to)i(which)f(MSP)f(is)i(ef)o(fective)c(is)k(often)e
(dictated)g(by)h(the)g(surr)o(ounding)g(en-)523 2284
y(vir)o(onment)e(in)f(which)h(an)f(algorithm,)g(pr)o(ogram,)f(or)i
(system)f(is)h(to)f(be)g(used.)f(Ther)o(e)g(ar)o(e)523
2384 y(thr)o(ee)d(important)h(examples)f(of)h(situations)h(wher)o(e)e
(staging)h(can)g(be)f(bene\002cial:)581 2570 y Fi(\226)41
b Fn(W)-8 b(e)23 b(want)g(to)g(minimize)h(total)f(cost)g(of)g(all)f
(stages)h Fj(for)g(most)f(inputs)p Fn(.)g(This)i(model)f(ap-)664
2669 y(plies,)17 b(for)g(example,)f(in)h(implementations)i(of)e(pr)o
(ogramming)g(languages.)f(The)h(cost)664 2769 y(of)i(a)f(simple)h
(compilation)g(followed)g(by)g(execution)g(is)g Fj(usually)f
Fn(lower)h(than)g(the)f(cost)664 2869 y(of)32 b(interpr)o(etation.)f
(For)i(example,)e(the)h(pr)o(ogram)f(being)i(executed)d(usually)j(con-)
664 2968 y(tains)27 b(loops,)g(which)h(typically)f(incur)f(lar)o(ge)g
(over)o(head)f(in)i(an)g(interpr)o(eted)e(imple-)664
3068 y(mentation.)581 3172 y Fi(\226)41 b Fn(W)-8 b(e)19
b(want)f(to)h(minimize)g Fj(a)g(weighted)e(average)h
Fn(of)g(the)h(cost)g(of)f(all)h(stages.)f(The)g(weights)664
3272 y(r)o(e\003ect)27 b(the)g(r)o(elative)g(fr)o(equency)f(at)h(which)
i(the)e(r)o(esult)g(of)h(a)f(stage)g(can)g(be)g(r)o(eused.)664
3372 y(This)32 b(situation)f(is)h(r)o(elevant)d(in)i(many)h
(applications)f(of)f(symbolic)i(computation.)664 3471
y(Often,)d(solving)h(a)e(pr)o(oblem)g(symbolically)-9
b(,)30 b(and)e(then)h(graphing)g(the)g(solution)h(at)664
3571 y(a)25 b(thousand)h(points)g(can)f(be)g(cheaper)f(than)i
(numerically)f(solving)i(the)e(pr)o(oblem)g(a)664 3670
y(thousand)17 b(times.)g(This)g(cost)g(model)g(can)f(make)g(a)g
(symbolic)h(appr)o(oach)f(worthwhile)664 3770 y(even)i(when)h(it)f(is)h
(100)e(times)i(mor)o(e)f(expensive)f(than)i(a)f(dir)o(ect)f(numerical)h
(one.)g(Sym-)664 3870 y(bolic)j(computation)g(is)f(a)g(form)g(of)g
(staged)g(computation)h(wher)o(e)f(fr)o(ee)e(variables)h(ar)o(e)664
3969 y(values)i(that)f(will)i(only)f(become)g(available)e(at)i(a)f
(later)g(stage.)581 4074 y Fi(\226)41 b Fn(W)-8 b(e)23
b(want)h(to)f(minimize)h(the)f(cost)g(of)g(the)h Fj(last)f(stage)p
Fn(.)f(Consider)h(an)g(embedded)f(sys-)664 4173 y(tem)k(wher)o(e)f(the)
g Fd(sin)g Fn(function)i(may)e(be)g(implemented)h(as)f(a)g(lar)o(ge)g
(look-up)h(table.)664 4273 y(The)34 b(cost)f(of)h(constr)o(ucting)h
(the)e(table)g(is)h(not)g(r)o(elevant.)e(Only)i(the)g(cost)f(of)h(com-)
664 4373 y(puting)e(the)g(function)h(at)e(r)o(un-time)h(is.)g(The)f
(same)h(applies)f(to)h(optimizing)h(com-)664 4472 y(pilers,)d(which)i
(may)e(spend)h(an)f(unusual)h(amount)g(of)g(time)g(to)g(generate)e(a)h
(high-)664 4572 y(performance)h(computational)h(library)-9
b(.)30 b(The)h(cost)h(of)g(optimization)g(is)g(often)f(not)664
4672 y(r)o(elevant)20 b(to)h(the)g(users)g(of)f(such)h(libraries)2012
4641 y Ff(3)2045 4672 y Fn(.)p 523 4746 473 4 v 558 4801
a Fe(3)606 4833 y Fm(Not)h(to)g(mention)h(the)g(century-long)e
(\223stages\224)h(that)i(wer)o(e)d(needed)g(to)h(evolve)g(the)g(theory)
g(be-)606 4924 y(hind)d(many)g(of)g(these)f(libraries.)1922
5173 y Fn(16)p eop end
%%Page: 17 17
TeXDict begin 17 16 bop 648 448 a Fn(The)23 b(last)h(model)g(seems)f
(to)h(be)g(the)f(most)i(commonly)g(r)o(efer)o(enced)c(one)j(in)g(the)g
(liter)o(-)523 548 y(atur)o(e,)c(and)h(is)g(often)h(described)e(as)h
(\223ther)o(e)f(is)i(ample)f(time)h(between)f(the)g(arrival)f(of)i
(dif-)523 648 y(fer)o(ent)c(inputs\224,)h(\223ther)o(e)f(is)h(a)g
(signi\002cant)h(dif)o(fer)o(ence)c(between)j(the)g(fr)o(equency)f(at)h
(which)523 747 y(the)g(various)g(inputs)g(to)g(a)g(pr)o(ogram)f
(change\224,)g(and)g(\223the)g(performance)g(of)h(the)g(pr)o(ogram)523
847 y(matters)i(only)g(after)f(the)h(arrival)e(of)i(its)g(last)g
(input\224.)523 1084 y Fi(1.8)82 b(Meta-programming)18
b(vs.)j(Multi-stage)d(vs.)i(Multi-level)e(vs.)i(two-level)523
1238 y Fj(Meta-pr)o(ograms)27 b Fn(ar)o(e)f(pr)o(ograms)i(that)g
(manipulate)g(other)g(pr)o(ograms.)g Fj(Object-pr)o(ograms)523
1338 y Fn(ar)o(e)34 b(pr)o(ograms)g(manipulated)h(by)g(other)g(pr)o
(ograms.)g Fj(Pr)o(ogram)e(generators)j Fn(ar)o(e)e(meta-)523
1437 y(pr)o(ograms)15 b(that)h(pr)o(oduce)f(object-pr)o(ograms)g(as)h
(their)f(\002nal)h(r)o(esult.)f(Meta-pr)o(ogramming)523
1537 y(can)34 b(be)h(used)f(to)h(over)o(come)g(limitations)h(of)f(an)f
(existing)i(pr)o(ogramming)f(language.)523 1637 y(Such)18
b(limitations)h(can)e(either)h(be)f(performance)g(or)h(expr)o(essivity)
f(pr)o(oblems.)h(W)-8 b(e)18 b(distin-)523 1736 y(guish)j(between)e
(two)i(ways)e(of)h(impr)o(oving)g(performance)f(using)i(meta-pr)o
(ogramming:)523 1836 y(T)-7 b(ranslation,)22 b(and)g(staging.)h(T)-7
b(ranslation)22 b(is)h(concerned)f(with)i(the)e(speci\002cs)h(of)g(the)
f(lan-)523 1936 y(guage)e(of)h(the)g(r)o(esulting)g(pr)o(ogram.)f
(Staging)h(is)g(independent)f(of)h(such)g(speci\002cs.)648
2035 y(Abstract)27 b(machines,)i(whether)g(r)o(ealized)d(by)j(softwar)o
(e)f(or)h(by)f(har)o(dwar)o(e,)e(vary)i(in)523 2135 y(speed)33
b(and)g(r)o(esour)o(ce)f(usage.)h(It)g(is)h(ther)o(efor)o(e)e(possible)
i(to)g(r)o(educe)e(the)i(cost)f(of)h(exe-)523 2234 y(cuting)28
b(a)f(pr)o(ogram)g(by)h(r)o(e-mapping)e(it)i(fr)o(om)f(one)h(abstract)f
(machine)h(to)g(another)-6 b(.)27 b(As)523 2334 y(har)o(dwar)o(e)d
(machines)j(can)f(be)g(both)h(faster)e(and)h(mor)o(e)g(space)g(ef)o
(\002cient)f(than)i(softwar)o(e)523 2434 y(ones,)i(such)h(r)o
(e-mappings)e(commonly)j(involve)e(pr)o(oducing)g(machine)g(or)h(byte)e
(code.)523 2533 y(W)-8 b(e)20 b(will)h(call)e(this)i(technique)f
Fj(translation)g Fn(to)g(distinguish)i(it)e(fr)o(om)f(staging.)h(T)-7
b(ranslation)523 2633 y(is)22 b(an)f(integral)g(part)g(of)g(the)h
(practical)e(compilation)i(of)g(pr)o(ogramming)f(languages,)g(and)523
2733 y(is)g(typically)g(performed)f(by)h(the)g Fj(back-end)f
Fn(of)h(a)f(compiler)-6 b(.)648 2832 y(Given)25 b(that)g(staging)h(is)g
(not)f(concerned)g(with)h(the)f(speci\002cs)h(of)f(the)g(language)g
(that)523 2932 y(we)k(generate)f(to,)h(what)g(can)f(it)h(achieve?)f(In)
h(some)g(sense,)g(the)g(key)g(observation)g(that)523
3031 y(makes)19 b(staging)g(inter)o(esting)g(is)h(that)e(non-trivial)i
(performance)e(gains)h(can)f(be)h(achieved)523 3131 y(using)36
b(only)g(staging,)g(and)f(without)h(need)f(for)g(translation)g(into)h
(a)f(\223dif)o(fer)o(ent\224)d(lan-)523 3231 y(guage.)22
b(MetaOCaml)f(pr)o(ovides)g(the)h(softwar)o(e)f(developer)h(with)g(a)g
(pr)o(ogramming)g(lan-)523 3330 y(guage)29 b(wher)o(e)g(the)h(staging)g
(aspect)f(of)g(a)g(computation)h(can)g(be)f(expr)o(essed)f(in)i(a)f
(con-)523 3430 y(cise)d(manner)-6 b(,)26 b(both)h(at)f(the)g(level)g
(of)g(syntax)g(and)g(types.)g(This)h(way)-9 b(,)25 b(the)i(pr)o
(ogrammer)523 3530 y(does)j(not)h(need)e(to)i(learn)e(a)h(low-level)g
(language,)f(yet)h(continues)h(to)g(enjoy)g(many)f(of)523
3629 y(the)19 b(performance)f(impr)o(ovements)h(pr)o(eviously)f
(associated)g(only)i(with)g(such)f(low-level)523 3729
y(languages.)k(Furthermor)o(e,)g(when)h(translation)g(is)f(employed)h
(in)g(an)f Fj(implementation)f Fn(of)523 3828 y(MetaOCaml,)d
(translation)h(too)h(can)f(be)f(exploited)h(by)g(the)g(MSP)f(pr)o
(ogrammer)g(thr)o(ough)523 3928 y(using)j(the)f(Run)g(constr)o(uct.)648
4028 y(The)26 b(main)g(technical)g(challenge)h(in)f(MSP)g(r)o(esear)o
(ch)e(has)i(to)h(do)f(with)h(the)f(r)o(un)h(con-)523
4127 y(str)o(uct)c(and)f(not)h(so)g(much)g(the)g(\223multi-\224)f
(aspect)g(of)g(these)h(languages.)f(T)-8 b(aking)23 b(the)g(Run)523
4227 y(constr)o(uct)d(out,)g(we)g(ar)o(e)e(left)h(with)h(what)g(is)f
(called)g(multi-level)h(languages)f(\(as)g(opposed)523
4327 y(to)26 b(multi-stage\).)f(The)g(level)h(of)f(a)g(term)h(is)g(the)
f(number)h(of)f(Brackets)g(that)g(surr)o(ound)h(it)523
4426 y(\(minus)19 b(the)g(number)g(of)g(Escapes\).)e(The)h(stage)h(of)f
(a)h(computation)g(is)g(the)g(time)g(at)f(which)523 4526
y(it)29 b(occurs,)g(usually)h(determined)e(by)h(the)h(number)f(of)g
(Runs)h(applied)e(to)i(the)f(term.)g(In)523 4625 y(multi-level)f
(languages,)f(ther)o(e)g(is)i(no)f(Run)h(in)f(the)g(language,)f(and)g
(so)i(Runs)g(ar)o(e)d(only)523 4725 y(applied)21 b(outside)g(pr)o
(ograms.)g(This)h(ends)f(up)g(meaning)h(that)g(levels)f(have)g(a)g(dir)
o(ect)f(one-)523 4825 y(to-one)32 b(corr)o(espondence)g(with)g(stages.)
g(In)g(the)g(multi-stage)g(setting,)g(however)-6 b(,)32
b(Run)523 4924 y(can)e(be)g(applied)g(as)g(part)g(of)h(the)f
(computation)i(of)e(any)h(MSP)e(pr)o(ogram.)h(The)g(simple)1922
5173 y(17)p eop end
%%Page: 18 18
TeXDict begin 18 17 bop 523 448 a Fn(connection)30 b(between)e(levels)g
(and)g(stages)h(br)o(eaks)e(in)i(this)g(setting.)g(The)f(name)h(multi-)
523 548 y(stage)21 b(rather)g(than)h(multi-level)f(is)h(chosen)h(to)e
(emphasize)g(this)i(dif)o(fer)o(ence.)18 b(Even)k(if)f(we)523
648 y(start)29 b(with)i(only)g(a)e(two-level)h(language)g(and)f(add)g
(Run,)h(the)g(number)g(of)g(stages)g(be-)523 747 y(comes)21
b(unbounded)g(\(at)f(least)g(in)i(the)e(untyped)h(setting,)g(it)g(is)g
(easy)g(to)g(write)f(a)h(pr)o(ogram)523 847 y(in)g(such)g(a)g(language)
f(that)h(involves)g(an)g(arbitrary)e(number)i(of)g(stages\).)648
946 y(Another)29 b(inter)o(esting)h(featur)o(e)d(of)j(multi-stage)f
(languages)h(is)g(cr)o(oss-stage)e(persis-)523 1046 y(tence)f(\(CSP\).)
e(This)i(featur)o(e)e(is)j(simply)f(the)g(ability)g(to)g(include)g(any)
g(value)f(de\002ned)g(in)523 1146 y(one)21 b(stage)f(into)h(code)e
(that)i(will)f(be)g(executed)f(in)i(a)f(futur)o(e)f(stage.)g(It)i
(simply)g(means)f(that)523 1245 y(we)k(do)g(not)g(always)g(have)f(to)h
(r)o(ewrite)f(all)h(the)g(code)g(that)f(we)h(generate,)f(if)h(it)g(is)g
(alr)o(eady)523 1345 y(de\002ned)h(at)g(the)h(curr)o(ent)e(level.)h(As)
g(such,)h(CSP)f(can)g(impr)o(ove)g(code)g(r)o(euse.)f(Unless)i(we)523
1445 y(have)f(a)f(r)o(eason)h(to)h(distinguish)g Fd(n)p
Fn(-level)f(pr)o(ograms)f(fr)o(om)h(just)h(\223pr)o(ograms\224,)e
(taking)h Fd(n)523 1544 y Fn(to)c(be)g(any)f(constant)i(will)f
(inevitably)g(show)h(up)f(as)f(a)g(limitation.)523 1781
y Fi(1.9)82 b(Relation)18 b(to)j(Partial)e(Evaluation)523
1936 y Fn(Partial)j(evaluation)g(\(PE\))g(is)h(a)f(form)g(of)h
(automatic)f(MSP)-11 b(.)22 b(In)h(fact,)e(a)h(particular)g(class)g(of)
523 2035 y(partial)h(evaluators)g(called)g(\223of)o(\003ine\224)g
(consist)i(of)f(two)g(steps:)g(the)g(\002rst,)f(called)g
Fj(binding-)523 2135 y(time)d(analysis)h(\(BT)-8 b(A\))20
b Fn(generates)f(a)h(two-level)h(pr)o(ogram.)f(The)g(second)h(step)f
(simply)i(exe-)523 2234 y(cutes)f(this)g(two-stage)g(pr)o(ogram)f(on)h
(a)g(static)f(input.)648 2334 y(A)25 b(natural)h(question)h(to)g(ask)e
(is)i(why)g(we)f(might)h(be)e(inter)o(ested)h(in)g(MSP)f(when)i(PE)523
2434 y(is)i(available.)f(The)h(main)g(r)o(eason)g(is)g(that)g(staging)h
(decisions)g(can)f(be)f(too)i(complex)g(to)523 2533 y(determine)20
b(automatically)-9 b(.)20 b(Ther)o(e)f(may)i(be)f(mor)o(e)g(than)h(one)
g(way)f(to)h(stage)f(a)g(pr)o(ogram,)523 2633 y(and)25
b(the)g(partial)f(evaluator)h(might)h(not)g(always)f(know)h(which)g
(one)f(is)h(best.)f(MSP)f(lan-)523 2733 y(guages)g(can)g(help)g(pr)o
(ogrammers)g(understand)g(wher)o(e)f(binding)i(time)g(impr)o(ovements)
523 2832 y(ar)o(e)k(needed,)g(and)h(what)h(kinds)g(of)g(binding)g(time)
g(impr)o(ovements)f(can)g(help)h(in)g(gen-)523 2932 y(erating)c(better)
f(pr)o(ograms.)g(In)h(general,)e(we)i(cannot)g(expect)f(the)h(partial)f
(evaluator)g(to)523 3031 y(\002gur)o(e)32 b(out)g(what)h(binding-time)g
(impr)o(ovements)f(can)g(help)g(yield)g(better)g(generated)523
3131 y(pr)o(ograms.)648 3231 y(Whenever)g(performance)f(is)i(an)g
(issue,)f(contr)o(ol)h(of)g(evaluation)f(or)o(der)f(is)i(impor)o(-)523
3330 y(tant.)d(BT)-6 b(A)29 b(optimizes)i(the)f(evaluation)g(or)o(der)f
(given)i(the)f(time)h(of)f(arrival)f(of)h(inputs,)523
3430 y(but)21 b(sometimes)g(it)g(is)g(just)h(easier)d(to)i(say)g(what)g
(is)g(wanted,)f(rather)f(than)i(to)g(for)o(ce)f(a)g(BT)-6
b(A)523 3530 y(to)23 b(discover)f(it)h([11)o(].)f(Automatic)g(analysis)
h(such)g(as)f(BT)-6 b(A)22 b(ar)o(e)f(necessarily)i(incomplete,)523
3629 y(and)d(can)f(only)i(appr)o(oximate)e(the)h(knowledge)h(of)f(the)g
(pr)o(ogrammer)-6 b(.)19 b(By)h(using)h(explicit)523
3729 y(annotations,)d(the)g(pr)o(ogrammer)f(can)g(exploit)h(his)g(full)
f(knowledge)h(of)g(the)f(pr)o(ogram)g(do-)523 3828 y(main.)k(In)g(a)f
(language)g(with)h(manual)g(staging,)g(having)g(explicit)f(annotations)
i(can)e(of)o(fer)523 3928 y(the)d(pr)o(ogrammer)g(a)f(well)i(designed)f
(back-door)f(for)h(dealing)g(with)h(instances)f(when)h(the)523
4028 y(automatic)j(analysis)g(r)o(eaches)e(its)i(limits.)648
4127 y(Annotations)29 b(can)f(alter)f(termination)i(behavior)f(in)h
(two)g(ways:)f(1\))f(specialization)523 4227 y(of)g(an)g(annotated)g
(pr)o(ogram)g(can)g(fail)f(to)i(terminate,)f(and)g(2\))f(the)i
(generated)e(pr)o(ogram)523 4327 y(itself)g(might)g(have)f(termination)
i(behavior)e(dif)o(fering)g(fr)o(om)g(that)g(of)h(the)g(original)g(pr)o
(o-)523 4426 y(gram)20 b([12)o(].)g(While)g(such)h(termination)g
(questions)h(ar)o(e)d(the)i(subject)f(of)g(active)g(investiga-)523
4526 y(tion)e(in)f(partial)e(evaluation,)i(pr)o(ogramming)g(with)g
(explicit)g(annotations)g(gives)g(the)g(user)523 4625
y(complete)k(contr)o(ol)g(over)g(\(and)f(r)o(esponsibility)i(for\))e
(termination)i(behavior)f(in)g(a)f(staged)523 4725 y(system.)g(For)g
(example,)f(any)h(r)o(ecursive)f(pr)o(ogram)g(can)g(be)h(annotated)f
(with)i(staging)f(an-)523 4825 y(notations)28 b(in)f(two)g
(fundamentally)f(dif)o(fer)o(ent)f(ways.)h(Consider)h(the)g(power)f
(function.)523 4924 y(The)21 b(\002rst)g(way)f(of)h(annotating)h(it)f
(is:)1922 5173 y(18)p eop end
%%Page: 19 19
TeXDict begin 19 18 bop 523 448 a Fl(let)44 b(rec)h(power)f(\(n,)g(x\))
h(=)658 540 y(match)f(n)g(with)747 631 y(0)h(->)f(.<1>.)658
722 y(|)g(m)h(->)f(.<.\230x)g(*)h(.\230\(power)e(\(n-1,)h(x\)\)>.;;)648
897 y Fn(The)20 b(second)h(way)g(of)g(annotating)g(it)g(is)g(as)g
(follows:)523 1063 y Fl(let)44 b(rec)h(power)f(\(n,)g(x\))h(=)568
1154 y(.<match)f(n)g(with)747 1245 y(0)h(->)f(1)658 1336
y(|)g(m)h(->)f(.\230x)h(*)f(.\230\(power)g(\(n-1,)g(x\)\)>.;;)648
1511 y Fn(Intuitively)-9 b(,)16 b(all)f(we)h(have)f(done)h(is)g
(\223factor)o(ed-out\224)d(the)j(Brackets)f(fr)o(om)h(the)g(branches)
523 1610 y(of)35 b(the)f Fh(match)p Fn(-statement)g(to)h(one)g(Bracket)
e(ar)o(ound)h(the)h(whole)g Fh(match)p Fn(-statement.)523
1710 y(This)30 b(function)h(is)f(perfectly)e(well-typed,)h(but)h(the)g
(annotations)g(have)f(just)i(cr)o(eated)c(a)523 1810
y(non-terminating)18 b(function)f(out)g(of)g(a)f(function)i(that)e(was)
h(always)f(terminating)h(\(at)f(least)523 1909 y(for)25
b(powers)g(of)g(0)g(or)g(mor)o(e\).)g(When)g(applied,)f(this)i
(function)g(simply)g(makes)f(r)o(epeated)523 2009 y(calls)c(to)g
(itself,)f(constr)o(ucting)i(bigger)f(and)f(bigger)g(code)h(fragments.)
f(In)h(partial)e(evalua-)523 2108 y(tion,)i(this)g(pr)o(oblem)g(is)f
(known)i(as)e Fj(in\002nite)h(unfolding)p Fn(,)f(and)g(partial)g
(evaluation)g(systems)523 2208 y(must)28 b(take)e(pr)o(ecautions)h(to)g
(avoid)g(it.)g(In)g(MetaOCaml,)f(the)h(fact)f(that)h(ther)o(e)f(ar)o(e)
f(such)523 2308 y(anomalous)c(annotations)g(is)g(not)f(a)g(pr)o(oblem,)
g(because)f(the)h(pr)o(ogrammer)f(speci\002es)i(ex-)523
2407 y(plicitly)e(wher)o(e)e(the)i(annotations)g(go.)g(In)f(particular)
-6 b(,)17 b(wher)o(eas)g(with)i(partial)e(evaluation)523
2507 y(an)j(automatic)g(analysis)g(\(BT)-6 b(A\))19 b(can)g(alter)h
(the)g(termination)h(behavior)f(of)g(the)g(pr)o(ogram,)523
2607 y(with)i(multi-stage)g(pr)o(ogramming)f(the)h Fj(pr)o(ogrammer)e
Fn(is)i(the)f(one)h(who)g(has)g(both)g(contr)o(ol)523
2706 y(over)-6 b(,)25 b(and)h(r)o(esponsibility)g(for)-6
b(,)26 b(the)g(corr)o(ectness)f(of)h(the)g(termination)g(behavior)g(of)
g(the)523 2806 y(annotated)20 b(pr)o(ogram.)648 2906
y(Finally)-9 b(,)22 b(it)g(is)h(important)g(to)f(keep)g(in)h(mind)g
(that)f(altering)g(the)h(or)o(der)e(of)h(evaluation)523
3005 y(of)f(statements)g(that)g(have)f(side)g(ef)o(fects)g(can)g
(change)h(the)g(\002nal)g(outcome)g(of)g(a)f(pr)o(ogram.)648
3105 y(Overall,)31 b(we)i(view)f(MSP)g(and)g(PE)g(to)h(be)f
(complementary)h(techniques,)g(and)f(we)523 3204 y(hope)21
b(to)g(see)g(mor)o(e)f(integration)i(between)e(the)h(two)g(techniques)h
(in)f(the)g(futur)o(e.)523 3463 y Fo(2)99 b(Results)26
b(and)e(Challenges)h(of)g(MSP)g(Research)523 3656 y Fn(Over)18
b(the)h(last)f(few)g(years,)f(signi\002cant)j(ef)o(forts)d(have)h(been)
g(invested)g(in)h(developing)g(the)523 3756 y(concept)27
b(of)g(multi-stage)g(pr)o(ogramming.)f(An)h(important)g(driving)g(for)o
(ce)f(has)h(been)g(to)523 3855 y(develop)16 b(type)g(systems)h(for)f
(MSP)g(languages.)g(This,)g(in)h(turn,)f(has)h(motivated)f(a)g(number)
523 3955 y(of)26 b(studies)g(in)g(the)g(semantics)g(of)g(such)g
(languages.)g(While)g(it)g(may)g(not)g(be)g(obvious)g(at)523
4054 y(\002rst)20 b(glance,)f(the)h(notion)h(of)f(type)g(safety)f(is)h
(highly)h(dependent)e(on)h(the)g(speci\002cs)g(of)g(the)523
4154 y(formulation)h(of)g(the)g(semantics)g(of)g(a)f(language.)648
4254 y(Resear)o(ch)i(on)i(MSP)f(languages)g(can)g(be)g(r)o(oughly)h
(divided)f(into)h(the)f(following)i(\(in-)523 4353 y(terr)o(elated\))18
b(dimensions:)560 4526 y(1.)41 b Fi(language)22 b(design)g
Fn(is)i(concerned)f(with)i(the)f(overall)f(form)h(of)f(the)h(language.)
f(It)h(in-)664 4625 y(cludes)i(issues)h(such)g(as)f(what)h(constr)o
(uctors)g(ar)o(e)e(intr)o(oduced)h(into)h(the)g(language,)664
4725 y(the)18 b(syntax)g(for)f(each)g(particular)g(constr)o(uctor)-6
b(,)18 b(the)g(extent)f(to)h(which)h(typing)f(will)g(be)664
4825 y(static)f(or)g(dynamic,)g(and)f(support)h(for)g(debugging)g(and)g
(pr)o(o\002ling)g(tools.)h(Naturally)-9 b(,)664 4924
y(language)21 b(design)h(is)f(closely)h(intertwined)g(with)g(other)f
(ar)o(eas)f(of)h(r)o(esear)o(ch)e(in)j(MSP)-11 b(.)1922
5173 y(19)p eop end
%%Page: 20 20
TeXDict begin 20 19 bop 664 448 a Fn(In)20 b(some)h(sense,)f(however)-6
b(,)19 b(it)h(speci\002es)g(a)g(set)g(of)f(desirable)g(featur)o(es)g
(in)h(a)f(language)664 548 y(\(for)25 b(a)h(given)g(class)f(of)h(MSP)f
(languages\))g(that)h(pr)o(ovides)f(us)h(with)g(a)f(classi\002cation)
664 648 y(for)18 b(the)g(r)o(esear)o(ch)e(on)i(other)g(aspects)g(such)g
(as)f(semantics)i(and)e(type)h(systems.)g(At)g(the)664
747 y(same)j(time,)h(the)g(design)f(space)g(of)h(languages)f(is)h
(bound)g(by)f(what)h(is)g(semantically)664 847 y(and)e(type)h(theor)o
(etically)g(possible.)664 967 y(In)j(a)e(rather)h(distinct)h(thr)o(ead)
d(of)j(r)o(esear)o(ch,)c(MSP)j(languages)g(have)g(been)g(used)g(as)f(a)
664 1067 y(semantic)16 b(basis)g(for)f(designing)i(and)f(specifying)g
(the)g(semantics)g(of)f(macr)o(o-languages.)664 1166
y(It)24 b(has)g(been)g(shown)i(that)e(building)g(macr)o(o)g(systems)h
(on)f(top)h(of)f(an)g(MSP)f(calculus)664 1266 y(can)32
b(aid)g(both)g(in)h(designing)g(both)g(sound)g(static)f(type)g(systems)
h([9)o(])f(and)f(sound)664 1365 y(educational)20 b(theories)i(for)e
(languages)h(that)f(support)h(macr)o(os)g([17)n(].)560
1486 y(2.)41 b Fi(semantics)23 b Fn(is)k(the)e(mathematical)h
(de\002nition)h(of)e(what)h(outcome)h(a)e(pr)o(ogram)g(in)h(a)664
1585 y(given)31 b(language)f(should)h(yield.)1758 1555
y Ff(4)1822 1585 y Fn(Ther)o(e)e(is)i(a)f(wide)g(range)g(of)h(ways)f
(in)h(which)g(a)664 1685 y(semantics)25 b(can)g(be)g(speci\002ed,)f
(and)g(often,)h(such)h(speci\002cations)f(can)g(be)f(shown)j(to)664
1785 y(be)f(equivalent.)g(Early)f(studies)h(on)g(two-stage)g(languages)
g(generally)g(used)f(deno-)664 1884 y(tational)g(semantics.)g
(Eventually)-9 b(,)25 b(ther)o(e)f(wer)o(e)g(two)i(dif)o(fer)o(ent)c
(kinds)k(of)f(two-level)664 1984 y(languages)d(that)f(wer)o(e)g
(simultaneously)i(under)f(investigation.)g(The)g(ones)g(studied)664
2083 y(by)17 b(Jones)g(et)f(al.)g(supported)h(computing)h(with)f
(unbound)g(variables)f(\(and)g(ar)o(e)f(ther)o(e-)664
2183 y(for)o(e)j(closer)h(in)h(spirit)f(to)g(MetaOCaml)f(and)h(much)g
(of)g(the)g(work)h(on)f(high-level)h(pr)o(o-)664 2283
y(gram)27 b(generation\),)g(wher)o(eas)f(the)h(ones)h(studied)f(by)g
(Nielson)h(and)f(Nielson)h(sup-)664 2382 y(ported)19
b(only)h(closed)f(code)g(fragments.)g(Glueck)g(et)g(al.)g(wer)o(e)f
(\002rst)h(to)h(generalize)e(the)664 2482 y(idea)29 b(of)g(two-level)g
(languages)g(to)h(the)f(multi-level)g(setting,)h(thus)g(allowing)g
(gen-)664 2582 y(erated)c(pr)o(ograms)i(themselves)g(to)g(contain)g
(Brackets.)e(The)i(\002rst)g(semantics)g(for)f(a)664
2681 y(multi-level)j(language)f(was)g(given)g(by)h(Davies)f([8)o(].)g
(Rather)g(than)g(using)h(a)f(deno-)664 2781 y(tational)k(semantics,)h
(however)-6 b(,)32 b(Davies)h(used)g(an)g(operational)g(semantics.)g
(This)664 2880 y(was)e(quite)g(an)g(important)g(step)g(for)f
(multi-stage)h(languages)g(\(which)g(ar)o(e)f(multi-)664
2980 y(level)21 b(languages)f(with)i(a)e(Run)i(constr)o(uct\),)f
(because)e(it)i(pr)o(oved)f(quite)h(har)o(d)f(to)h(give)664
3080 y(a)27 b(denotational)g(semantics)g(to)h(such)f(languages.)g(In)g
(fact,)f(even)h(today)-9 b(,)26 b(ther)o(e)g(is)h(a)664
3179 y(limited)h(number)f(of)h(denotational)f(formulations)i(for)e(the)
g(semantics)h(of)f(two-)h(or)664 3279 y(multi-level)21
b(languages)g(that)f(support)h(open)g(code.)664 3399
y(The)e(big-step)g(operational)h(semantics)f(for)g(multi-stage)h
(languages)f(has)g(a)g(number)664 3499 y(of)i(useful)g(featur)o(es,)f
(including)i(the)f(fact)f(that)h(it)g(pr)o(ovides)g(a)g(concise)g(and)g
(self)g(con-)664 3598 y(tained)g(de\002nition)h(wher)o(e)f(the)g(only)h
(non-trivial)g(operation)f(is)h(standar)o(d)e(substitu-)664
3698 y(tion.)j(This)g(may)f(surprise)g(the)g(r)o(eader)e(given)j(that)f
(earlier)f(we)h(stated)g(that)g(MetaO-)664 3798 y(Caml)27
b(must)g(r)o(ename)f(bound)h(variables)e(inside)i(code.)f(The)h(fact)f
(is)h(that)g(standar)o(d)664 3897 y(substitution)h(dictates)e(such)h(a)
g(r)o(enaming,)f(and)g(is)h(a)f(very)g(standar)o(d)f(and)h(concise)664
3997 y(mechanism)h(for)g(specifying)g(the)f(need)h(for)f(such)h(r)o
(enaming.)f(It)h(has)f(been)h(shown)664 4096 y(that,)f(starting)h(fr)o
(om)f(only)i(this)f(big-step)f(semantics)h(one)g(can)g(de\002ne)f(a)g
(notion)i(of)664 4196 y(observational)g(equivalence.)g(This)h(notion)h
(allows)f(us)g(to)f(formally)h(de\002ne)f(a)g(no-)664
4296 y(tion)k(of)f(equational)g(theory)h(for)e(the)i(language,)e(and)h
(show)h(that)f(it)g(r)o(espects)f(the)664 4395 y(big-step)23
b(semantics.)h(One)f(of)g(the)h(unique)g(featur)o(es)d(of)j(this)g
(semantics)f(compar)o(ed)664 4495 y(to)j(denotational)f(models)g(is)h
(that)e(it)i(allows)f(us)g(to)h(equate)e(terms)i(inside)f(Brackets)p
523 4654 473 4 v 558 4710 a Fe(4)606 4742 y Fm(The)17
b(r)o(eader)f(inter)o(ested)g(in)i(this)f(ar)o(ea)g(of)g(r)o(esear)o
(ch)f(might)i(\002nd)f(a)h(number)f(of)g(intr)o(oductory)f(r)o(ef-)606
4833 y(er)o(ences)i(to)h(be)g(useful,)e(especially)g(for)h(type)h
(systems)e([7)q(,6,2,10,20])i(and)g(the)h(lambda)f(calculus)606
4924 y([1].\))1922 5173 y Fn(20)p eop end
%%Page: 21 21
TeXDict begin 21 20 bop 664 448 a Fn(not)25 b(only)g(syntactically)g
(but)f(also)g(semantically)-9 b(.)24 b(For)g(example,)g(we)g(can)g
(corr)o(ectly)664 548 y(in)d(view)g Fh(.<1+1>.)f Fn(as)g(equivalent)h
(to)g Fh(.<2>.)p Fn(.)560 663 y(3.)41 b Fi(static)31
b(type)h(systems)f Fn(ar)o(e)h(a)g(test)h(performed)f(on)h(sour)o(ce)f
(pr)o(ograms.)h(If)f(the)h(test)664 763 y(succeeds,)27
b(it)g(usually)g(gives)h(us)f(information)h(about)f(the)h(r)o(untime)f
(behavior)g(of)g(a)664 862 y(pr)o(ogram.)18 b(Generally)-9
b(,)18 b(we)h(use)f(type)h(systems)g(when)g(we)g(ar)o(e)e(inter)o
(ested)h(in)h(exclud-)664 962 y(ing)25 b(certain)e(kinds)h(of)g(r)o
(untime)h(events)e(\(usually)h(called)f(err)o(ors\).)g(T)-8
b(o)24 b(specify)f(such)664 1061 y(events)28 b(accurately)e(enough)j
(that)e(we)h(can)f(pr)o(ove)g(the)h(soundness)h(of)e(a)g(type)h(sys-)
664 1161 y(tem)j(r)o(equir)o(es)e(that)h(we)h(de\002ne)f(the)g(notion)i
(of)e(undesirable)g(events)h(on)f(top)h(of)f(a)664 1261
y(given)h(formal)f(semantics.)h(Operational)f(semantics)g(for)h
(multi-stage)f(languages)664 1360 y(have)20 b(pr)o(oven)h(particularly)
f(useful)g(for)h(this)g(purpose.)664 1475 y(The)c(\002rst)g(type)g
(systems)h(for)f(Jones-style)g(two-level)g(languages)g(only)h
(attempted)f(to)664 1575 y(type)23 b(the)h(\002rst)g(stage.)e(The)i
(second)f(stage)g(was)h(assumed)f(to)h(be)f(untyped,)g(and)g(the)664
1675 y(primary)i(concerns)g(wer)o(e)f(to)h(1\))f(ensur)o(e)g(that)h
(the)f(\002rst)i(stage)e(computations)i(wer)o(e)664 1774
y(fr)o(ee)d(of)h(r)o(untime)g(err)o(ors,)f(and)h(2\))f(that)h(ther)o(e)
f(wer)o(e)g(no)i(binding-time)f(mistakes,)g(in)664 1874
y(the)d(sense)g(that)g(any)g(variable)f(that)h(will)g(only)h(be)f
(available)e(in)j(the)f(second)g(stage)g(is)664 1974
y(not)h(used)e(in)h(the)g(\002rst)g(stage.)664 2089 y(Davies)g(pr)o
(esented)f(a)g(type)h(system)h(for)f(multi-level)g(languages)g(that)g
(statically)g(as-)664 2188 y(sur)o(ed)26 b(that)h(all)g(computations)i
(in)e(all)g(stages)g(will)h(not)g(generate)e(r)o(untime)i(err)o(ors.)
664 2288 y(Furthermor)o(e,)c(all)g(variables)f(that)i(will)g(be)f
(available)f(at)h(level)g Fd(n)g Fn(ar)o(e)f(only)i(used)f(at)664
2387 y(level)d Fd(n)p Fn(.)664 2502 y(The)29 b(\002rst)f(key)h
(challenge)f(for)g(MSP)g(language)g(r)o(esear)o(ch)f(was)h(to)h(safely)
f(incorpo-)664 2602 y(rate)23 b(the)i(Run)f(constr)o(uct)h(into)g(the)g
(multi-level)f(setting.)g(A)g(\002rst)g(type)g(system)h(that)664
2702 y(achieves)c(this)h(goal)g(was)f(pr)o(esented)f(by)h(T)-8
b(aha,)21 b(Benaissa)g(and)g(Shear)o(d)e([16)o(].)i(A)g(lim-)664
2801 y(itation)j(of)e(this)i(type)e(system)i(was)e(that)h(it)g(did)f
(not)i(allow)f(nested)g(uses)g(of)f(the)h(Run)664 2901
y(constr)o(uct,)32 b(and)e(so)h(in)h(a)e(sense)h(that)g(the)g(Run)h
(constr)o(uct)f(could)g(only)h(appear)d(at)664 3001 y(top)22
b(level.)f(A)g(second)h(appr)o(oach)f(was)g(pr)o(oposed)g(by)h(Moggi,)g
(T)-8 b(aha,)21 b(Benaissa,)f(and)664 3100 y(Shear)o(d)k([14)o(],)h
(wher)o(eby)h(a)f(new)i(type)e(constr)o(uctor)i(\(like)f(\223code\224)f
(in)h(MetaOCaml\))664 3200 y(was)20 b(intr)o(oduced)g(to)g(assert)g
(explicitly)g(that)g(a)f(particular)g(code)h(fragment)f(is)i(closed)664
3300 y(with)28 b(r)o(espect)d(to)i(dynamic)g(variables.)e(The)i(most)g
(r)o(ecent)f(pr)o(oposal)g(by)h(T)-8 b(aha)26 b(and)664
3399 y(Nilsen)35 b([19)n(])f(allows)g(the)g(execution)h(of)e(open)i
(code,)e(and)g(may)h(be)g(notationally)664 3499 y(lighter)21
b(than)g(the)g(pr)o(evious)g(appr)o(oach.)664 3614 y(An)k(important)h
(curr)o(ent)f(challenge)g(in)h(typing)g(MSP)e(is)i(\002nding)g(expr)o
(essive)e(static)664 3713 y(type)h(systems)h(that)f(support)h(the)f
(storage)g(of)g(open)g(code.)g(Curr)o(ent)f(type)h(systems)664
3813 y(for)c(MSP)f(ef)o(fects)f([4)o(])h(r)o(estrict)g(storable)h
(values)f(to)h(closed)g(code)g(fragments.)664 3928 y(The)i(minimalist)i
(DSL)e(we)g(consider)h(in)g(the)f(\002rst)h(part)e(of)i(the)f(paper)f
(has)i(a)e(simple)664 4028 y(type)30 b(system)g(\(we)g(only)h(have)e
(integers)h(and)g(functions)g(over)g(integers\).)g(If)f(wish)664
4127 y(to)c(move)f(to)h(a)f(setting)h(wher)o(e)e(we)i(have)e(an)i
(unbounded)f(number)g(of)h(static)f(types)664 4227 y(\(which)18
b(is)g(the)f(case)g(either)g(when)h(we)f(want)h(to)f(allow)h(the)g
(user)f(to)g(de\002ne)h(their)f(own)664 4327 y(types,)j(or)g(when)g
(the)g(language)g(itself)g(has)g(an)f(unbounded)i(number)f(of)f
(types\),)h(the)664 4426 y(static)26 b(type)g(system)g(of)g(mainstr)o
(eam)f(functional)h(languages)g(for)o(ces)f(to)h(intr)o(oduce)664
4526 y(unnecessary)21 b(tags,)g(that)g(can)g(have)g(a)g(lar)o(ge)f(r)o
(untime)i(cost.)f(This)h(limitation)g(can)f(be)664 4625
y(over)o(come)j(if)g(the)g(language)g(supports)h(dependent)f(types.)g
(In)g(the)h(curr)o(ent)e(imple-)664 4725 y(mentation)c(of)g(MetaOCaml,)
e(this)i(pr)o(oblem)f(is)g(avoided)g(by)g(a)g(specialized)f(r)o(untime)
664 4825 y(transformation)h(that)f(operates)f(on)i(sour)o(ce)e(code)h
([18)o(].)f(W)-5 b(ith)19 b(dependent)d(types,)h(we)664
4924 y(may)k(be)f(able)g(to)i(statically)e(guarantee)g(that)h(no)g
(tags)g(r)o(emain)f(at)g(r)o(untime.)1922 5173 y(21)p
eop end
%%Page: 22 22
TeXDict begin 22 21 bop 560 448 a Fn(4.)41 b Fi(implementation)22
b Fn(is)27 b(concerned)f(with)h(both)g(the)f(design,)h(engineering,)f
(and)g(the-)664 548 y(ory)20 b(involved)f(in)h(r)o(ealizing)f(MSP)f
(languages.)h(The)h(earliest)e(ef)o(forts)h(in)h(implement-)664
648 y(ing)d(MSP)f(languages)h(pr)o(edate)d(the)j(term)g(MSP)-11
b(,)16 b(and)g(ar)o(e)f(in)i(the)g(context)g(of)f(LISP)g(and)664
747 y(Scheme)i(macr)o(o)g(systems,)i(and)e(quasi-quote)h(and)g(comma)g
(mechanisms.)g(This)g(set-)664 847 y(ting)27 b(was)g(the)f(starting)h
(point)g(for)f(many)h(ef)o(forts)e(fr)o(om)h(the)h(DIKU)f(T)o(OPPS)g
(gr)o(oup)664 946 y(and)20 b(the)h(T)-8 b(empo)22 b(gr)o(oup.)664
1038 y(MetaOCaml)15 b(gr)o(ew)g(dir)o(ectly)g(fr)o(om)g(the)h(ef)o
(forts)f(of)h(Shear)o(d)e(and)h(his)i(gr)o(oup)e(of)h(MetaML)664
1138 y(\(and)25 b(befor)o(e)f(that)h(CRML\).)f(MetaML)g(was)h(built)g
(fr)o(om)g(scratch)g(as)g(an)g(interpr)o(eter)664 1237
y(for)h(SML/NJ)f(extended)g(with)i(staging)g(constr)o(ucts.)g(The)f
(main)g(design)h(contribu-)664 1337 y(tion)33 b(of)e(the)h(MetaOCaml)e
(ef)o(fort)g(is)i(that)g(it)f(is)h(based)f(on)h(the)g(existing)g
(compiler)664 1436 y(for)19 b(the)h(pr)o(ogramming)f(language)g(OCaml.)
g(At)g(the)g(theor)o(etical)g(level,)g(a)f(formal)h(ar)o(-)664
1536 y(gument)28 b(was)g(given)g(for)f(the)h(corr)o(ectness)f(of)g(the)
h(compilation)h(strategy)e(used)g(in)664 1636 y(implementing)22
b(MetaOCaml.)664 1727 y(While)32 b(the)f(curr)o(ent)g(focus)g(on)h(the)
g(MetaOCaml)e(ef)o(fort)g(is)i(on)g(implementations)664
1827 y(based)17 b(on)h(r)o(epr)o(esenting)f(delayed)f(computations)j
(by)e(parse)g(tr)o(ees,)g(the)g(next)h(step)f(in)664
1926 y(this)k(pr)o(oject)f(is)g(to)h(consider)f(implementations)h(that)
f(employ)h(dir)o(ect)e(r)o(untime)i(gen-)664 2026 y(eration)h(of)f
(low-level)h(code.)f(Such)g(strategies)g(have)g(been)h(used)f(in)h(the)
f(`C,)h(T)-8 b(empo,)664 2126 y(and)29 b(Popcorn)g(systems.)h
(Ultimately)-9 b(,)28 b(we)h(hope)g(that)g(MetaOCaml)e(will)j(pr)o
(ovide)664 2225 y(the)22 b(user)f(with)i(several)d(implementation)j
(strategies)e(with)i(a)e(number)g(of)h(dif)o(fer)o(ent)664
2325 y(performance)e(tradeof)o(fs.)664 2416 y(An)k(often)f(overlooked)h
(aspect)f(of)g(MSP)g(implementation)h(is)g(pr)o(etty-printing.)f(If)g
(a)664 2516 y(pur)o(ely)c(high-level)h(r)o(epr)o(esentation)e(is)i
(used)f(for)h(code,)e(then)i(the)g(pr)o(oblem)f(r)o(educes)664
2616 y(to)33 b(\(the)f(substantial)h(but)f(nevertheless\))g(standar)o
(d)f(pr)o(oblem)h(of)g(pr)o(etty-printing)664 2715 y(sour)o(ce)26
b(pr)o(ograms.)g(Note,)h(however)-6 b(,)26 b(that)g(CSP)g(means)h(that)
g(we)f(might)i(generate)664 2815 y(code)j(that)f(r)o(efers)g(dir)o
(ectly)g(to)h(functions)h(de\002ned)e(in)i(the)f(\002rst)g(stage.)f
(Generally)664 2914 y(speaking,)e(at)f(r)o(untime)h(such)g(functions)h
(ar)o(e)d(alr)o(eady)f(compiled.)j(A)f(similar)h(situ-)664
3014 y(ation)f(arises)f(if)h(we)f(choose)i(to)f(r)o(epr)o(esent)e
(delayed)g(computations)j(with)f(dynam-)664 3114 y(ically)j(generated)e
(code.)i(In)g(both)g(cases,)f(we)h(need)f(techniques)i(for)e(printing)i
(the)664 3213 y(de\002nition)22 b(of)f(such)g(compiled)g(pr)o(ograms)f
(in)h(a)g(portable,)f(r)o(eadable)e(manner)-6 b(.)664
3305 y(The)18 b(issue)g(of)g(pr)o(o\002ling,)g(debugging,)h(and)e(pr)o
(ovide)g(useful)h(err)o(or)f(messages)h(seems)664 3404
y(to)j(be)g(still)g(vir)o(gin)g(territories)g(for)f(r)o(esear)o(ch.)560
3496 y(5.)41 b Fi(applications)20 b Fn(fr)o(om)i(a)h(pur)o(e)f
(operational)g(\(untyped)h(and)f(non-hygienic\))i(point)g(of)664
3595 y(view)-8 b(,)28 b(MSP)f(has)g(been)h(ar)o(ound)f(for)g(a)g(long)i
(time,)e(and)h(has)f(been)h(used)f(to)h(imple-)664 3695
y(ment)h(a)f(wide)h(range)f(of)h(applications.)f(In)h(the)g(typed)f
(setting)i(of)e(languages)h(like)664 3795 y(ML)22 b(and)h(Haskell,)f
(MSP)g(brings)i(back)e(a)g(useful)h(language)f(featur)o(e)f(that)i(had)
f(been)664 3894 y(\(for)j(a)h(long)g(time\))g(cast)f(out)i(by)e(the)h
(need)g(to)g(ensur)o(e)f(static)h(typing.)g(It)g(is)g(because)664
3994 y(of)g(the)g(clear)f(semantics)h(and)f(static)h(typing)g(for)g
(MSP)f(languages)h(that)f(they)h(have)664 4094 y(r)o(egained)k(the)i
(attention)g(of)g(the)f(typed)h(pr)o(ogramming)f(languages)h(community)
-9 b(.)664 4193 y(Curr)o(ently)g(,)29 b(we)g(ar)o(e)f(not)i(awar)o(e)e
(of)i(lar)o(ge-scale)d(examples)i(of)h(MSP)e(pr)o(ograms)h(in)664
4293 y(MetaML)24 b(or)i(MetaOCaml.)e(MetaOCaml,)h(however)-6
b(,)25 b(has)h(not)g(been)g(of)o(\002cially)f(r)o(e-)664
4392 y(leased)e(yet.)h(Once)g(it)g(is)g(r)o(eleased,)e(the)i
(experience)e(of)i(users)g(of)g(the)g(language)f(will)664
4492 y(be)e(an)f(important)h(indicator)g(of)g(the)g(success)g(of)f(its)
i(type)e(system.)664 4583 y(W)-8 b(e)26 b(expect)f(that)h(DSL)f
(implementation)i(will)f(be)f(a)g(particularly)g(successful)h(class)664
4683 y(of)21 b(applications)g(for)f(MSP)-11 b(.)648 4825
y(Backing)18 b(up)g(fr)o(om)g(the)h(\223curr)o(ent)e(issues\224)h
(described)f(above,)h(ther)o(e)f(ar)o(e)g(also)i(a)f(num-)523
4924 y(ber)i(of)h(higher)o(-level)f(questions)j(we)d(hope)h(that)g
(futur)o(e)f(r)o(esear)o(ch)e(will)k(answer:)1922 5173
y(22)p eop end
%%Page: 23 23
TeXDict begin 23 22 bop 560 448 a Fn(1.)41 b Fj(How)35
b(well)g(does)g(multi-stage)f(pr)o(ogramming)f(work)i(in)h(practice?)d
Fn(While)j(signi\002cant)664 548 y(questions)26 b(r)o(egar)o(ding)c
(the)i(theory)h(of)f(multi-stage)g(languages)g(still)g(r)o(emain)g
(open,)664 648 y(two)g(usable)f(implementations)h(ar)o(e)e(coming)j
(close)e(to)h(being)f(completed:)g(MetaO-)664 747 y(Caml)c(and)g(T)-8
b(emplate)19 b(Haskell.)h(A)f(big)g(question)i(that)e(r)o(emains)g(to)h
(be)f(settled)g(is)h(the)664 847 y(extent)29 b(to)f(which)i(this)f
(technology)h(can)e(scale)g(to)h(lar)o(ge,)e(industrial)i(str)o(ength)g
(ap-)664 946 y(plications.)20 b(Answering)f(this)h(question)g(will)g(r)
o(equir)o(e)e(conducting)h(a)g(lar)o(ge)f(number)664
1046 y(of)31 b(case)e(studies)i(on)g(both)g(applications)f(that)h(ar)o
(e)e(alr)o(eady)f(implemented)j(in)g(the)664 1146 y(base)23
b(language)g(for)g(each)g(of)g(these)g(systems)i(\(Ocaml)e(and)f
(Haskell\))h(and)g(new)h(ap-)664 1245 y(plications)e(that)f(ar)o(e)f
(implemented)h(fr)o(om)g(scratch)g(in)h(the)f(multi-stage)g
(extensions.)664 1345 y(Pr)o(omising)33 b(domains)e(include)h(DSLs,)e
(graphics,)h(numerical)g(computation,)h(and)664 1445
y(virtual)21 b(machine)g(implementations.)560 1543 y(2.)41
b Fj(What)26 b(new)g(abstraction)g(mechanisms)f(ar)o(e)h(possible?)g
Fn(The)g(main)h(potential)f(bene\002t)g(of)664 1643 y(MSP)c(is)g
(facilitating)g(the)h(use)f(of)g(sophisticated)h(abstraction)f
(mechanism)h(without)664 1742 y(for)o(cing)33 b(pr)o(ograms)f(to)h(pay)
g(a)f(r)o(untime)i(penalty)-9 b(.)32 b(Given)h(this)h(technology)-9
b(,)34 b(what)664 1842 y(new)21 b(abstraction)f(mechanisms)h(can)f(be)g
(intr)o(oduced)f(to)i(incr)o(ease)e(the)h(safety)-9 b(,)19
b(secu-)664 1942 y(rity)-9 b(,)21 b(r)o(eliability)-9
b(,)19 b(or)i(inter)o(operability)g(of)f(softwar)o(e?)560
2040 y(3.)41 b Fj(Ar)o(e)22 b(ther)o(e)e(mor)o(e)h(expr)o(essive)g
(type)g(systems)g(for)h(imperative)e(multi-stage)g(languages?)h
Fn(Ex-)664 2140 y(isting)35 b(pr)o(oposals)f(for)g(typed)g(multi-stage)
g(languages)g(r)o(estrict)g(the)g(pr)o(ogram)g(to)664
2239 y(storing)22 b(only)g(closed)e(values.)560 2338
y(4.)41 b Fj(T)-9 b(o)31 b(what)g(extent)g(can)h(staging)f(annotations)
g(both)g(at)g(the)g(level)h(of)g(types)f(and)g(terms)h(be)664
2437 y(r)o(educed?)560 2536 y Fn(5.)41 b Fj(Can)25 b(we)g(avoid)e(the)h
(need)h(for)g(r)o(ewriting)f(pr)o(ograms)f(in)i(CPS)g(befor)o(e)g
(staging?)e Fn(It)i(may)f(be)664 2635 y(possible,)19
b(thr)o(ough)f(the)h(use)f(of)g(an)g Fd(\021)1834 2647
y Fc(v)1874 2635 y Fn(-like)g(r)o(eduction,)f(to)i(pr)o(oduce)e
(optimal)h(r)o(esults)664 2735 y(without)26 b(having)f(the)g(user)g(r)o
(ewrite)f(the)g(pr)o(ogram)h(in)g(CPS.)f(Bondorf)g(has)h(studied)664
2835 y(impr)o(oving)h(binding)g(times)g(without)h(r)o(esorting)e(to)h
(explicit)f(CPS)g(conversion)h([3].)664 2934 y(The)19
b(work)g(of)f(Sabry)g(and)g(W)-8 b(adler)18 b(suggests)i(that)e(the)h
(use)f(of)h(Moggi's)g Fd(\025)3026 2946 y Fc(c)3079 2934
y Fn(may)g(also)664 3034 y(be)i(r)o(elevant)e(to)i(dealing)g(with)g
(this)h(pr)o(oblem)e([15)o(].)560 3132 y(6.)41 b Fj(Should)17
b(Run)h(be)g(parameterized?)e Fn(By)h(exposing)h(the)g(Run)g(constant)g
(to)g(pr)o(ogrammers,)664 3232 y(they)j(will)g(eventually)f(have)f(new)
i(demands)f(for)f(contr)o(olling)j(the)e(behavior)g(of)g(this)664
3332 y(new)28 b(operation,)f(and)g(will)h(ther)o(efor)o(e)d(pose)j(mor)
o(e)e(inter)o(esting)i(questions)h(for)e(the)664 3431
y(developers)17 b(of)g(compilers)h(supporting)g(this)g(constr)o(uct.)g
(Run)h(is)e(a)g(way)g(for)h(the)f(user)664 3531 y(to)g(\223appeal)f(to)
h(the)g(higher)g(power)g(of)g(the)g(compiler)g(developer)f(and)h(to)g
(avoid)f(med-)664 3630 y(dling)28 b(with)f(the)h(complex)f(and)f
(fragile)g(implementation)j(details,\224)c(and)i(the)g(user)664
3730 y(will)21 b(necessarily)e(be)h(picky)g(in)g(specifying)g(what)g
(he)g(is)g(asking)g(for:)f(A)h(light-weight)664 3830
y(compilation)k(phase)f(that)g(pr)o(oduces)f(machine)i(code)e(quickly)
-9 b(,)24 b(or)f(a)g(heavy-weight)664 3929 y(phase)30
b(that)g(takes)g(longer)h(but)f(pr)o(oduces)f(mor)o(e)h(ef)o(\002cient)
g(code?)g(Compiling)h(for)664 4029 y(memory)22 b(or)e(for)h(speed?)560
4127 y(7.)41 b Fj(Is)29 b(ther)o(e)g(a)g(modular)f(way)g(for)i
(supporting)e(a)h(heter)o(ogeneous)g(MSP)g(language)f(based)i(on)664
4227 y(MetaOCaml?)24 b Fn(By)g(focusing)i(on)f(the)f(staging)i(aspect)d
(of)i(MSP)-11 b(,)24 b(pr)o(evious)g(work)h(ad-)664 4327
y(dr)o(essed)15 b(a)h(number)g(of)g(concr)o(ete)g(solutions)i(to)e
(fundamental)g(pr)o(oblems)g(in)h(staging.)664 4426 y(However)-6
b(,)18 b(another)h(important)f(application)h(for)f(MSP)g(is)g
(translation.)h(It)f(would)h(be)664 4526 y(very)e(useful)f(to)i(extend)
e(the)h(MSP)f(paradigm)g(to)h(handle)g(multiple)g(dif)o(fer)o(ent)e
(object-)664 4625 y(languages)24 b(at)g(the)h(same)f(time.)g(For)h
(example,)e(it)i(seems)g(r)o(easonable)e(to)i(index)f(the)664
4725 y(code)f(type)f(by)h(the)g(name)g(of)g(a)f(language,)g(for)h
(which)h(ther)o(e)e(is)h(an)f(associated)h(syn-)664 4825
y(tax,)16 b(and)g(special)h(typing)g(r)o(ules.)g(Such)g(a)f(scheme)h
(is)g(implicit)h(in)f(the)g(meta-language)664 4924 y(used)27
b(by)g(Jones)h(\(see)e(for)h(example)f([12)o(]\))g(for)h(describing)g
(partial)f(evaluation.)h(An)1922 5173 y(23)p eop end
%%Page: 24 24
TeXDict begin 24 23 bop 664 448 a Fn(example)26 b(of)g(this)h(kind)g
(of)g(indexing)f(alr)o(eady)f(exists)i(in)g(the)f(envir)o(onment)h
(classi-)664 548 y(\002ers)21 b(appr)o(oach)e(to)i(typing)h
(multi-stage)f(languages)f([19)o(].)664 646 y(W)-8 b(e)34
b(believe)e(that)h(such)h(a)f(framework)g(may)g(even)g(be)g(appr)o
(opriate)e(for)i(dealing)664 746 y(with)17 b(r)o(un-time)f(code)g
(generation.)g(Run-time)h(code)f(generation)g(is)g(concerned)g(with)664
846 y(the)31 b(ef)o(\002cient)e(generation)h(of)h(specialized)d
(machine)j(code)f(at)f(r)o(un-time.)i(While)f(a)664 945
y(compiled)19 b(implementation)h(of)f(MetaOCaml)f(can)g(pr)o(ovide)g(a)
g(version)i(of)e(Run)i(that)664 1045 y(generates)31 b(machine)h(code,)f
(it)h(is)g(implicitly)h(assumed)f(to)g(be)f(making)i(calls)e(to)h(a)664
1144 y(compiler)-6 b(,)24 b(which)g(is)h(generally)e(not)i(consider)o
(ed)e(fast)g(enough)h(for)g(r)o(un-time)g(code)664 1244
y(generation.)g(If)g(machine)g(code)g(is)h(consider)o(ed)e(as)h(a)f
(typed)h(language,)f(we)h(believe)664 1344 y(that)e(it)g(can)g(be)f
(incorporated)h(into)g(a)g(Heter)o(ogeneous)g(MetaOCaml)f(setting.)h(W)
-5 b(ith)664 1443 y(the)25 b(ongoing)i(r)o(esear)o(ch)c(ef)o(forts)h
(on)i(typed)f(assembly)g(languages,)g(this)h(possibility)664
1543 y(is)21 b(not)h(far)o(-fetched.)560 1641 y(8.)41
b Fj(Ar)o(e)21 b(ther)o(e)e(practical,)g(theor)o(etically)g(sound)i
(appr)o(oaches)d(for)j(allowing)f(the)f(pr)o(ogrammer)g(to)664
1741 y(specify)25 b(optimizations)f(on)h(MetaOCaml)g(code?)f
Fn(Recent)h(work)h(by)f(Craig)g(Chamber)6 b('s)664 1841
y(gr)o(oup)21 b(seems)g(very)f(r)o(elevant)g(and)g(very)g(inter)o
(esting.)560 1939 y(9.)41 b Fj(Can)32 b(multi-stage)f(languages)g(be)i
(used)f(to)f(support)g(extensible)i(systems?)f Fn(It)f(has)h(been)664
2039 y(shown)g(that)e(MSP)g(calculi)g(can)g(be)g(used)g(to)h(de\002ne)f
(a)g(lar)o(ge)f(class)h(of)h(generative)664 2138 y(macr)o(os,)26
b(that)h(this)h(appr)o(oach)d(supports)i(macr)o(os)g(that)f(de\002ne)h
(new)g(binding)h(con-)664 2238 y(str)o(ucts,)34 b(and)e(that)i(it)f
(can)g(be)g(used)g(to)g(de\002ne)g(type-safe)f(macr)o(o)g(languages)h
([9].)664 2337 y(Recent)19 b(work)g(has)g(also)f(shown)i(that)f(this)g
(appr)o(oach)e(can)i(be)f(used)g(to)h(de\002ne)g(macr)o(o)664
2437 y(systems)27 b(that)e(ar)o(e)f(amenable)h(to)h(educational)f(r)o
(easoning)g([17)o(].)g(The)g(natural)g(next)664 2537
y(question)e(in)f(this)h(dir)o(ection)e(is)h(whether)g(this)g(appr)o
(oach)e(can)h(be)h(extended)e(to)i(sup-)664 2636 y(port)f(extensible)g
(syntax)g(as)f(well)h(as)g(extensible)f(type)h(systems.)519
2735 y(10.)40 b Fj(T)-9 b(o)32 b(what)f(extent)h(can)g(multi-stage)g
(pr)o(ogramming)e(be)j(applied)e(to)h(other)g(pr)o(ogramming)664
2834 y(paradigms?)f Fn(The)j(combination)g(of)g(MSP)e(and)h(functional)
h(pr)o(ogramming)f(is)h(ap-)664 2934 y(pealing,)26 b(mainly)h(because)f
(the)g(bene\002ts)h(of)f(each)g(of)h(the)f(two)h(paradigms)f(do)g(not)
664 3034 y(interfer)o(e.)21 b(An)i(important)g(question)i(to)e(answer)f
(is)i(the)f(extent)f(to)h(which)h(MSP)e(can)664 3133
y(be)29 b(useful)h(intr)o(oduced)e(into)j(other)e(settings,)h
(including)h(imperative,)d(object)i(ori-)664 3233 y(ented,)20
b(and)h(logic)g(pr)o(ogramming.)519 3331 y(11.)40 b Fj(T)-9
b(o)16 b(what)g(extent)h(can)g(MSP)g(and)f(PE)g(be)i(integrated?)e
Fn(The)h(r)o(elationship)g(between)g(multi-)664 3431
y(stage)g(pr)o(ogramming)g(and)f(partial)g(evaluation)h(concepts)g
(such)g(as)g(self-application)664 3530 y(and)i(the)g(Futamura)g(pr)o
(ojections)g([12)o(])g(has)g(been)g(addr)o(essed)e(to)j(some)f(extent)g
(in)h(the)664 3630 y(context)h(of)g(tag)f(elimination,)i(but)f(still)g
(r)o(emains)g(lar)o(gely)f(unexplor)o(ed.)523 3824 y
Fj(Acknowledgments:)33 b Fn(Members)15 b(of)h(Dagstuhl)h(meeting,)f
(especially)g(Charles,)g(Krzysztof,)523 3924 y(Shriram,)j(David)g(W)-5
b(ile,)20 b(T)-8 b(odd,)20 b(Paul)f(Kelly)-9 b(,)20 b(Kevin)g(Hammond,)
g(Chris)g(Lengauer)-6 b(,)19 b(Y)-8 b(an-)523 4024 y(nis.)21
b(Stephan)f(Ellner)h(for)g(car)o(eful)e(pr)o(oof-r)o(eading)g(of)h(a)h
(draft.)523 4284 y Fo(References)560 4469 y Fm(1.)44
b(B)t Fb(A)t(R)t(E)t(N)t(D)t(R)t(E)t(G)t(T)o Fm(,)30
b(H)t(.)35 b(P)-6 b(.)71 b Fa(The)32 b(Lambda)g(Calculus:)f(Its)h
(Syntax)g(and)g(Semantics)p Fm(,)f(r)o(evised)f(ed.,)658
4560 y(vol.)20 b(103)h(of)f Fa(Studies)f(in)g(Logic)i(and)f(the)h
(Foundations)d(of)j(Mathematics)p Fm(.)31 b(North-Holland,)20
b(Ams-)658 4652 y(ter)o(dam,)e(1984.)560 4742 y(2.)44
b(B)t Fb(A)t(R)t(E)t(N)t(D)t(R)t(E)t(G)t(T)o Fm(,)22
b(H)t(.)27 b(P)-6 b(.)45 b(Lambda)25 b(calculi)f(with)h(types.)42
b(In)25 b Fa(Handbook)f(of)g(Logic)h(in)e(Computer)658
4833 y(Science)p Fm(,)e(S.)h(Abramsky)-8 b(,)20 b(D.)i(M.)f(Gabbay)-8
b(,)22 b(and)g(T)-6 b(.)22 b(S.)g(E.)f(Maibaum,)h(Eds.)e(Oxfor)o(d)g
(University)658 4924 y(Pr)o(ess,)d(Oxfor)o(d,)f(1991.)1922
5173 y Fn(24)p eop end
%%Page: 25 25
TeXDict begin 25 24 bop 560 448 a Fm(3.)44 b(B)t Fb(O)t(N)t(D)t(O)t(R)t
(F)n Fm(,)25 b(A)t(.)44 b(Impr)o(oving)23 b(binding)h(times)f(without)i
(explicit)e(CPS-conversion.)43 b(In)24 b Fa(1992)658
540 y(ACM)c(Confer)o(ence)g(on)h(Lisp)g(and)g(Functional)e(Pr)o
(ogramming.)i(San)f(Francisco,)h(California)f Fm(\(1992\),)658
631 y(pp.)e(1\22610.)560 717 y(4.)44 b(C)t Fb(A)t(L)t(C)t(A)t(G)t(N)t
(O)t Fm(,)26 b(C)t(.)t(,)j(M)t Fb(O)t(G)t(G)t(I)t Fm(,)f(E)t(.)t(,)h
Fb(A)t(N)t(D)h Fm(T)o Fb(A)t(H)t(A)t Fm(,)d(W)m(.)54
b(Closed)26 b(types)g(as)h(a)g(simple)f(appr)o(oach)658
808 y(to)c(safe)f(imperative)g(multi-stage)g(pr)o(ogramming.)34
b(In)22 b Fa(the)g(International)e(Colloquium)g(on)i(Au-)658
900 y(tomata,)f(Languages,)g(and)g(Pr)o(ogramming)g(\(ICALP)f('00\))h
Fm(\(Geneva,)h(2000\),)g(vol.)e(1853)j(of)e Fa(Lectur)o(e)658
991 y(Notes)e(in)f(Computer)h(Science)p Fm(,)f(Springer)o(-V)-8
b(erlag,)15 b(pp.)j(25\22636.)560 1077 y(5.)44 b(C)t
Fb(A)t(L)t(C)t(A)t(G)t(N)t(O)t Fm(,)17 b(C)t(.)t(,)k(T)o
Fb(A)t(H)t(A)t Fm(,)d(W)m(.)t(,)j(H)t Fb(U)t(A)t(N)t(G)t
Fm(,)d(L)t(.)t(,)i Fb(A)t(N)t(D)h Fm(L)t Fb(E)t(R)t(O)t(Y)m
Fm(,)d(X)t(.)27 b(Implementing)17 b(multi-stage)658 1168
y(languages)g(using)g(asts,)h(gensym,)e(and)j(r)o(e\003ection.)24
b(In)18 b Fa(Generative)g(Pr)o(ogramming)g(and)f(Compo-)658
1260 y(nent)f(Engineering)f(\(GPCE\))g Fm(\(2003\),)j(K.)e(Czarnecki,)h
(F)-7 b(.)16 b(Pfenning,)g(and)i(Y)-8 b(.)15 b(Smaragdakis,)h(Eds.,)658
1351 y(Lectur)o(e)i(Notes)g(in)h(Computer)f(Science,)h(Springer)o(-V)-8
b(erlag.)560 1437 y(6.)44 b(C)t Fb(A)t(R)t(D)t(E)t(L)t(L)t(I)t
Fm(,)16 b(L)t(.)25 b(T)-7 b(ypeful)16 b(pr)o(ogramming.)21
b(In)d Fa(Formal)e(Description)i(of)f(Pr)o(ogramming)g(Concepts)p
Fm(,)658 1528 y(E.)e(J.)g(Neuhold)g(and)h(M.)f(Paul,)g(Eds.,)f(IFIP)i
(State-of-the-Art)g(Reports.)f(Springer)o(-V)-8 b(erlag,)12
b(New)658 1620 y(Y)-7 b(ork,)17 b(1991,)j(pp.)e(431\226507.)560
1706 y(7.)44 b(C)t Fb(A)t(R)t(D)t(E)t(L)t(L)t(I)t Fm(,)16
b(L)t(.)23 b(T)-7 b(ype)15 b(systems.)21 b(In)c Fa(The)f(Computer)h
(Science)f(and)h(Engineering)e(Handbook)p Fm(,)h(A.)h(B.)658
1797 y(T)-7 b(ucker)h(,)18 b(Jr)-6 b(.,)18 b(Ed.)g(CRC)g(Pr)o(ess,)f
(1997.)560 1883 y(8.)44 b(D)t Fb(A)m(V)t(I)t(E)t(S)t
Fm(,)16 b(R)t(.)k(A)15 b(temporal-logic)e(appr)o(oach)i(to)g
(binding-time)g(analysis.)j(In)d Fa(the)g(Symposium)g(on)658
1974 y(Logic)k(in)f(Computer)g(Science)h(\(LICS)e('96\))i
Fm(\(New)f(Br)o(unswick,)g(1996\),)i(IEEE)d(Computer)h(Society)658
2066 y(Pr)o(ess,)f(pp.)h(184\226195.)560 2152 y(9.)44
b(G)t Fb(A)t(N)t(Z)t Fm(,)25 b(S)t(.)t(,)h(S)t Fb(A)t(B)t(R)r(Y)m
Fm(,)e(A)t(.)t(,)i Fb(A)t(N)t(D)g Fm(T)o Fb(A)t(H)t(A)t
Fm(,)e(W)m(.)43 b(Macr)o(os)23 b(as)g(multi-stage)g(computations:)h(T)
-7 b(ype-)658 2243 y(safe,)15 b(generative,)h(binding)f(macr)o(os)h(in)
g(Macr)o(oML.)j(In)e Fa(the)f(International)e(Confer)o(ence)h(on)h
(Func-)658 2334 y(tional)i(Pr)o(ogramming)h(\(ICFP)e('01\))i
Fm(\(Flor)o(ence,)e(Italy)-8 b(,)18 b(September)h(2001\),)g(ACM.)523
2420 y(10.)44 b(H)t Fb(I)t(N)t(D)t(L)t(E)t(Y)m Fm(,)27
b(J)t(.)j(R)t(.)54 b Fa(Basic)27 b(Simple)g(T)-7 b(ype)27
b(Theory)p Fm(,)h(vol.)e(42)i(of)e Fa(Cambridge)i(T)-8
b(racts)27 b(in)f(Theor)o(etical)658 2512 y(Computer)19
b(Science)p Fm(.)26 b(Cambridge)18 b(University)g(Pr)o(ess,)e
(Cambridge,)i(1997.)523 2598 y(11.)44 b(J)t Fb(O)t(N)t(E)t(S)t
Fm(,)29 b(N)t(.)h(D)t(.)56 b(What)28 b(not)g(to)g(do)e(when)j(writing)e
(an)h(interpr)o(eter)e(for)g(specialisation.)54 b(In)658
2689 y Fa(Partial)27 b(Evaluation)g Fm(\(1996\),)h(O.)f(Danvy)-8
b(,)27 b(R.)g(Gl)10 b(\250)-35 b(uck,)27 b(and)h(P)-10
b(.)28 b(Thiemann,)g(Eds.,)e(vol.)h(1110)i(of)658 2780
y Fa(Lectur)o(e)18 b(Notes)h(in)f(Computer)h(Science)p
Fm(,)f(Springer)o(-V)-8 b(erlag,)15 b(pp.)j(216\226237.)523
2866 y(12.)44 b(J)t Fb(O)t(N)t(E)t(S)t Fm(,)26 b(N)t(.)h(D)t(.)t(,)g(G)
t Fb(O)t(M)t(A)t(R)t(D)t Fm(,)e(C)t(.)i(K)t(.)t(,)g Fb(A)t(N)t(D)g
Fm(S)t Fb(E)t(S)t(T)s(O)t(F)t(T)o Fm(,)e(P)-6 b(.)47
b Fa(Partial)23 b(Evaluation)h(and)g(Automatic)658 2958
y(Pr)o(ogram)19 b(Generation)p Fm(.)26 b(Pr)o(entice-Hall,)18
b(1993.)523 3044 y(13.)44 b(L)t Fb(E)t(R)t(O)t(Y)m Fm(,)130
b(X)t(.)383 b(Objective)130 b(Caml,)g(2000.)383 b(A)-7
b(vailable)130 b(fr)o(om)658 3135 y Fl(http://caml.inria.fr/ocaml/)p
Fm(.)523 3221 y(14.)44 b(M)t Fb(O)t(G)t(G)t(I)t Fm(,)39
b(E)t(.)t(,)i(T)o Fb(A)t(H)t(A)t Fm(,)e(W)m(.)t(,)i(B)t
Fb(E)t(N)t(A)t(I)t(S)t(S)t(A)t Fm(,)e(Z)t(.)i(E)t(.)t(-)t(A)t(.)t(,)f
Fb(A)t(N)t(D)h Fm(S)t Fb(H)t(E)t(A)t(R)t(D)t Fm(,)e(T)n(.)92
b(An)39 b(idealized)658 3312 y(MetaML:)29 b(Simpler)-6
b(,)28 b(and)i(mor)o(e)f(expr)o(essive.)58 b(In)30 b
Fa(Eur)o(opean)f(Symposium)h(on)f(Pr)o(ogramming)658
3404 y(\(ESOP\))39 b Fm(\(1999\),)j(vol.)d(1576)j(of)f
Fa(Lectur)o(e)e(Notes)i(in)f(Computer)g(Science)p Fm(,)g(Springer)o(-V)
-8 b(erlag,)658 3495 y(pp.)18 b(193\226207.)523 3581
y(15.)44 b(S)t Fb(A)t(B)t(R)r(Y)m Fm(,)29 b(A)t(.)t(,)i
Fb(A)t(N)t(D)g Fm(W)n Fb(A)t(D)t(L)t(E)t(R)t Fm(,)d(P)-6
b(.)59 b(A)29 b(r)o(e\003ection)f(on)h(call-by-value.)57
b(In)29 b Fa(Pr)o(oceedings)f(of)h(the)658 3672 y(International)17
b(Confer)o(ence)h(on)g(Functional)f(Pr)o(ogramming)i
Fm(\(Philadelphia,)g(1996\),)g(pp.)f(13\22624.)523 3758
y(16.)44 b(T)o Fb(A)t(H)t(A)t Fm(,)25 b(W)m(.)t(,)h(B)t
Fb(E)t(N)t(A)t(I)t(S)t(S)t(A)t Fm(,)e(Z)t(.)t(-)t(E)t(.)t(-)t(A)t(.)t
(,)f Fb(A)t(N)t(D)k Fm(S)t Fb(H)t(E)t(A)t(R)t(D)t Fm(,)e(T)n(.)45
b(Multi-stage)23 b(pr)o(ogramming:)e(Ax-)658 3850 y(iomatization)33
b(and)g(type-safety)-8 b(.)70 b(In)33 b Fa(25th)g(International)e
(Colloquium)g(on)h(Automata,)g(Lan-)658 3941 y(guages,)21
b(and)g(Pr)o(ogramming)g(\(ICALP\))e Fm(\(Aalbor)o(g,)h(1998\),)i(vol.)
e(1443)i(of)f Fa(Lectur)o(e)f(Notes)h(in)f(Com-)658 4032
y(puter)f(Science)p Fm(,)f(pp.)g(918\226929.)523 4118
y(17.)44 b(T)o Fb(A)t(H)t(A)t Fm(,)35 b(W)m(.)t(,)h Fb(A)t(N)t(D)g
Fm(J)t Fb(O)t(H)t(A)t(N)t(N)t Fm(,)e(P)-6 b(.)78 b(Staged)33
b(notational)j(de\002nitions.)75 b(In)35 b Fa(Generative)e(Pr)o(o-)658
4210 y(gramming)22 b(and)f(Component)g(Engineering)f(\(GPCE\))g
Fm(\(2003\),)i(K.)f(Czarnecki,)g(F)-7 b(.)20 b(Pfenning,)h(and)658
4301 y(Y)-8 b(.)18 b(Smaragdakis,)f(Eds.,)g(Lectur)o(e)h(Notes)g(in)h
(Computer)f(Science,)h(Springer)o(-V)-8 b(erlag.)523
4387 y(18.)44 b(T)o Fb(A)t(H)t(A)t Fm(,)20 b(W)m(.)t(,)h(M)t
Fb(A)t(K)t(H)t(O)t(L)t(M)t Fm(,)e(H)t(.)t(,)j Fb(A)t(N)t(D)g
Fm(H)t Fb(U)t(G)t(H)t(E)t(S)t Fm(,)d(J)t(.)30 b(T)-7
b(ag)19 b(elimination)g(and)g(Jones-optimality)-8 b(.)658
4478 y(In)17 b Fa(Pr)o(ograms)f(as)g(Data)g(Objects)g
Fm(\(2001\),)h(O.)e(Danvy)h(and)h(A.)e(Filinksi,)f(Eds.,)g(vol.)i(2053)
h(of)f Fa(Lectur)o(e)658 4570 y(Notes)j(in)f(Computer)h(Science)p
Fm(,)f(pp.)g(257\226275.)523 4656 y(19.)44 b(T)o Fb(A)t(H)t(A)t
Fm(,)31 b(W)m(.)t(,)h Fb(A)t(N)t(D)g Fm(N)t Fb(I)t(E)t(L)t(S)t(E)t(N)t
Fm(,)e(M)t(.)i(F)m(.)63 b(Envir)o(onment)30 b(classi\002ers.)60
b(In)31 b Fa(The)e(Symposium)h(on)658 4747 y(Principles)18
b(of)h(Pr)o(ogramming)f(Languages)h(\(POPL)f('03\))h
Fm(\(New)f(Orleans,)g(2003\).)523 4833 y(20.)44 b(W)t
Fb(R)t(I)t(G)t(H)t(T)o Fm(,)22 b(A)t(.)j(K)t(.)t(,)g
Fb(A)t(N)t(D)f Fm(F)t Fb(E)t(L)t(L)t(E)t(I)t(S)t(E)t(N)t
Fm(,)c(M)t(.)38 b(A)22 b(syntactic)g(appr)o(oach)g(to)g(type)g
(soundness.)36 b Fa(In-)658 4924 y(formation)18 b(and)h(Computation)f
(115)p Fm(,)i(1)f(\(1994\),)g(38\22694.)1922 5173 y Fn(25)p
eop end
%%Trailer

userdict /end-hook known{end-hook}if
%%EOF
