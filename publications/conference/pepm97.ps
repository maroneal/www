%!PS-Adobe-2.0
%%Creator: dvipsk 5.58c Copyright 1986, 1994 Radical Eye Software
%%Title: body.dvi
%%Pages: 16
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%EndComments
%DVIPSCommandLine: dvips body
%DVIPSParameters: dpi=300, compressed, comments removed
%DVIPSSource:  TeX output 1997.04.01:0903
%%BeginProcSet: texc.pro
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N
/X{S N}B /TR{translate}N /isls false N /vsize 11 72 mul N /hsize 8.5 72
mul N /landplus90{false}def /@rigin{isls{[0 landplus90{1 -1}{-1 1}
ifelse 0 0 0]concat}if 72 Resolution div 72 VResolution div neg scale
isls{landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div
hsize mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul
TR[matrix currentmatrix{dup dup round sub abs 0.00001 lt{round}if}
forall round exch round exch]setmatrix}N /@landscape{/isls true N}B
/@manualfeed{statusdict /manualfeed true put}B /@copies{/#copies X}B
/FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N /IE 0 N /ctr 0 N /df-tail{
/nn 8 dict N nn begin /FontType 3 N /FontMatrix fntrx N /FontBBox FBB N
string /base X array /BitMaps X /BuildChar{CharBuilder}N /Encoding IE N
end dup{/foo setfont}2 array copy cvx N load 0 nn put /ctr 0 N[}B /df{
/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0 0 sf neg 0 0]
N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data dup
length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{
128 ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub
get 127 sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data
dup type /stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N
/rc 0 N /gp 0 N /cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup
/base get 2 index get S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx
0 ch-xoff ch-yoff ch-height sub ch-xoff ch-width add ch-yoff
setcachedevice ch-width ch-height true[1 0 0 -1 -.1 ch-xoff sub ch-yoff
.1 sub]/id ch-image N /rw ch-width 7 add 8 idiv string N /rc 0 N /gp 0 N
/cp 0 N{rc 0 ne{rc 1 sub /rc X rw}{G}ifelse}imagemask restore}B /G{{id
gp get /gp gp 1 add N dup 18 mod S 18 idiv pl S get exec}loop}B /adv{cp
add /cp X}B /chg{rw cp id gp 4 index getinterval putinterval dup gp add
/gp X adv}B /nd{/cp 0 N rw exit}B /lsh{rw cp 2 copy get dup 0 eq{pop 1}{
dup 255 eq{pop 254}{dup dup add 255 and S 1 and or}ifelse}ifelse put 1
adv}B /rsh{rw cp 2 copy get dup 0 eq{pop 128}{dup 255 eq{pop 127}{dup 2
idiv S 128 and or}ifelse}ifelse put 1 adv}B /clr{rw cp 2 index string
putinterval adv}B /set{rw cp fillstr 0 4 index getinterval putinterval
adv}B /fillstr 18 string 0 1 17{2 copy 255 put pop}for N /pl[{adv 1 chg}
{adv 1 chg nd}{1 add chg}{1 add chg nd}{adv lsh}{adv lsh nd}{adv rsh}{
adv rsh nd}{1 add adv}{/rc X nd}{1 add set}{1 add clr}{adv 2 chg}{adv 2
chg nd}{pop nd}]dup{bind pop}forall N /D{/cc X dup type /stringtype ne{]
}if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1 ne{dup dup
length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}B /I{
cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul
add .99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI restore userdict
/eop-hook known{eop-hook}if showpage}N /@start{userdict /start-hook
known{start-hook}if pop /VResolution X /Resolution X 1000 div /DVImag X
/IE 256 array N 0 1 255{IE S 1 string dup 0 3 index put cvn put}for
65781.76 div /vsize X 65781.76 div /hsize X}N /p{show}N /RMat[1 0 0 -1 0
0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley X /rulex X V}B /V
{}B /RV statusdict begin /product where{pop product dup length 7 ge{0 7
getinterval dup(Display)eq exch 0 4 getinterval(NeXT)eq or}{pop false}
ifelse}{false}ifelse end{{gsave TR -.1 .1 TR 1 1 scale rulex ruley false
RMat{BDot}imagemask grestore}}{{gsave TR -.1 .1 TR rulex ruley scale 1 1
false RMat{BDot}imagemask grestore}}ifelse B /QV{gsave newpath transform
round exch round exch itransform moveto rulex 0 rlineto 0 ruley neg
rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta 0 N /tail
{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}
B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{
4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{
p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p
a}B /bos{/SS save N}B /eos{SS restore}B end
%%EndProcSet
TeXDict begin 40258431 52099146 1000 300 300 (body.dvi)
@start /Fa 1 51 df<387FFFFCB512FE38C00006B3B512FEA217177D991F>50
D E /Fb 2 99 df<EA0EC012311260EA418012C1A213A0EA47C012390B097E8810>97
D<12701230A35A126EEA7180126112C1A3EAC3001246123C090E7E8D0D>I
E /Fc 1 51 df<EA7FFFB51280EAC001ADB5FCA211117E9217>50
D E /Fd 6 53 df<13C0A9B51280A23800C000A911147E8F17>43
D<121FEA3180EA60C0EA4040EAC060A8EA4040EA60C0EA3180EA1F000B107F8F0F>48
D<1218127812981218AC12FF08107D8F0F>I<121FEA6180EA40C0EA806012C01200A213
C0EA0180EA030012065AEA10201220EA7FC012FF0B107F8F0F>I<121FEA2180EA60C0A2
12001380EA0100121FEA00801340136012C0A2EA8040EA6080EA1F000B107F8F0F>I<EA
0180A212031205120D121912111221124112C1EAFFE0EA0180A4EA0FE00B107F8F0F>I
E /Fe 6 119 df<EA0390EA0C701218EA303013601260A3EAC0C013C812401241EA62D0
EA1C700D0E7C8D12>97 D<EA0780EA1840EA302012601340EAFF80EAC000A413201340EA
6180EA3E000B0E7C8D10>101 D<123E120CA41218A41230A41260A412C012C8A312D012
6007177D9609>108 D<EA3078EA498CEA4E04124CEA9C0C1218A3EA301813191331A2EA
6012131C100E7D8D14>110 D<1206A25AA4EAFF80EA1800A35AA45A1261A21262126412
3809147D930C>116 D<EA3810EA2C18124CA2EA8C101218A3EA3020A21340A2EA1880EA
0F000D0E7D8D10>118 D E /Ff 2 49 df<12021207EA0D80EA18C0EA3060EA6030EAC0
18A2EA6030EA3060EA18C0EA0D80EA070012020D0E7E8C10>5 D<1208121CA21238A312
301270A21260A212C0A2060D7E8D09>48 D E /Fg 5 117 df<EA07C0EA1862EA303212
60133CEAC01C1318A2EA4038EA20DAEA1F0E0F0B7E8A14>11 D<EA3FF8127FEAC2001286
1204A2120CA35AA20D0B7E8A0E>28 D<1204120C1200A5123012581298A21230A2126012
64A21268123006127E910B>105 D<EA71F0EA9A18129C12981218EA3030A213321362EA
606413380F0B7E8A13>110 D<12081218A312FF1230A41260A212621264A21238080F7E
8E0C>116 D E /Fh 59 127 df<EA4040EAE0E0A7EA40400B097D9312>34
D<EA3018EA783812FC1370A313E0A21278EA31C01201A2EA0380A2EA0700A3EA0E18133C
137E121CA31238133CEA18180F1A7F9612>37 D<126012F012F812781218A31230A21260
12C01280050C799312>39 D<EA01801203EA06005A5A123812301270A25AA71270A21230
123812187E7EEA0380120109197B9612>I<128012C0126012301218121C120C120EA212
07A7120EA2120C121C12181230126012C0128008197C9612>I<1207A3EAE738EAFFF8EA
7FF0EA1FC0A2EA7FF0EAFFF8EAE738EA0700A30D0E7E9012>I<EA0380A6EAFFFEA3EA03
80A60F0F7F9112>I<126012F012F8127812181230A212E012C00509798312>I<EAFFF8A3
0D037E8B12>I<EA07C0EA0FE0EA1C70EA3838EA701CA2EAE00EA7131EEA701CA2EA3838
EA1C70EA0FE0EA07C00F147F9312>48 D<1206A2120E121E12FE12EE120EACEAFFE0A20B
147D9312>I<EA0F80EA3FC0EA70E0EAE0701338A2124012001330137013E013C0EA0180
EA030012065AEA18381230EA7FF8A20D147E9312>I<126012F0A212601200A6126012F0
A21260040E798D12>58 D<126012F0A212601200A6126012F0A212701230A2126012C012
800413798D12>I<13381378EA01F0EA03E0EA0F80EA1F00123C12F85A7E123C121FEA0F
80EA03E0EA01F0EA007813380D117E9212>I<EAFFFEA2127FC7FCA3EA7FFE12FFA20F09
7F8E12>I<124012E07E127C7EEA0F80EA07C0EA01E0EA00F8137813F8EA01E0EA07C0EA
0F80EA3E005A12F05A12400D137E9312>I<EA0380EA07C0A21206A2EA0EE0A4EA0C60EA
1C70A3EA1FF0A2EA3838A3EAFC7EA20F147F9312>65 D<EA03E6EA0FFEEA1C3EEA381EEA
700EA21260EAE000A6EA600E1270A2EA381CEA1C38EA0FF0EA03E00F147F9312>67
D<EAFFE0A2EA0E00B0EAFFE0A20B147D9312>73 D<EA07F8A2EA00E0AD124012E0EAE1C0
EA7F80EA3F000D147E9312>I<B4FCA21238AC1304130EA3EAFFFEA20F147F9312>76
D<EAFC7EA2EA7C7CEA745CEA76DCA61277EA739CA2EA701CA5EAF83EA20F147F9312>I<
EAFEFEA2EA3E38123A123BA6EA39B8A6123813F812FEA20F147F9312>I<EA3FE0EA7FF0
EA7070EAE038AEEA7070EA7FF0EA3FE00D147E9312>I<EAFF8013E0EA38F013781338A3
137813F0EA3FE013C0EA38E01370A41377A2EAFE3E131C10147F9312>82
D<EA1F30EA3FF01270EAE070A313001270127FEA3FC0EA0FE0EA00F013781338126012E0
1330EAF070EAFFE0EACF800D147E9312>I<EA7FFE12FFEAE38EA3EA0380ADEA0FE0A20F
147F9312>I<EAFC7EA2EA783CEA3838A4EA1C70A4EA0C60EA0EE0A3EA06C0A21207A2EA
03800F147F9312>86 D<EAFFC0A2EAE000B3A4EAFFC0A20A1A7A9612>91
D<EAFFC0A21201B3A412FFA20A1A7F9612>93 D<EAFFF8A30D037E7F12>95
D<EA1FC0EA3FF0EA3838EA101C1200EA07FC123FEA781C12E0A3EA703C383FFF80EA1FCF
110E7F8D12>97 D<12F8A21238A4EA3BE0EA3FF0EA3C38EA381C130C130EA4130C131CEA
3C38EA3FF0EA1BC00F147F9312>I<EA07F0EA1FF8EA3838EA7010EA600012E0A41260EA
70381238EA1FF0EA07E00D0E7E8D12>I<13F8A21338A4EA07B8EA1FF8EA3878EA703812
6012E0A41260EA70781238EA1FFEEA0FBE0F147F9312>I<EA0780EA1FE0EA38701270EA
603812E0EAFFF8A2EAE0001260EA70381238EA1FF0EA07C00D0E7E8D12>I<137E13FFEA
01C7EA03821380A2EA7FFE12FFEA0380AAEA3FF8A21014809312>I<EA0F9EEA1FFFEA38
E7EA7070A4EA38E0EA3FC01380EA7000EA3FE013F813FCEA701EEAE00EA3EA600CEA783C
EA1FF0EA0FE010167F8D12>I<12F8A21238A4EA39E0EA3FF0EA3E38123C1238A8EAFE3E
A20F147F9312>I<1206120FA21206C7FCA3127FA21207AAEAFFF0A20C157D9412>I<12F8
A21238A4EA3BFCA2EA38F0EA39E0EA3BC0EA3F80A213C0EA3DE0123813701338EAFC7EA2
0F147F9312>107 D<B4FCA21207B0EAFFF8A20D147E9312>I<EAF71CEAFFBEEA79E7A2EA
71C7A838F9E780EAF8E3110E808D12>I<EAF9E0EAFFF0EA3E38123C1238A8EAFE3EA20F
0E7F8D12>I<EA0F80EA3FE01238EA7070EAE038A5EAF078EA7070EA38E0123FEA0F800D
0E7E8D12>I<EAFBE0EAFFF0EA3C38EA381C130C130EA4130C131CEA3C38EA3FF0EA3BC0
EA3800A512FEA20F157F8D12>I<EA079CEA1FFCEA387CEA703CEA601C12E0A41260EA70
3CEA387CEA1FFCEA079CEA001CA5137FA210157F8D12>I<EAFC78EAFDFCEA1F9CEA1E08
1300121CA7EAFFC0A20E0E7E8D12>I<EA1FF0123FEA607012C0EAE000127FEA3FE0EA0F
F0EA0078EA601812E0EAF030EAFFE0EADFC00D0E7E8D12>I<1206120EA3EA7FF812FFEA
0E00A7131CA3EA07F8EA01E00E127F9112>I<EAF8F8A2EA3838A91378EA1FFEEA0FBE0F
0E7F8D12>I<EAFC7EA2EA3838A2EA1C70A3EA0EE0A4EA07C0A2EA03800F0E7F8D12>I<EA
FEFEA2EA701CA3EA3018EA3BB8EA3FF8A2EA3AB81238EA1CF0A30F0E7F8D12>I<EA7C7C
A2EA1CF0EA0EE0EA0FC01207EA0380120713C0EA0EE0EA1EF0EA1C70EAFC7EA20F0E7F8D
12>I<EAFC7EA2EA3838121C1370A2120E136013E01206A2EA07C01203A21380A3EA7700
127F127E12380F157F8D12>I<EA3FFC127FEA70381370EA00E0EA01C0EA0380EA070012
0EEA1C1C12381270EAFFFCA20E0E7F8D12>I<12E0B3A8031A799612>124
D<EA1840EA3CE0EAE780EA43000B047D9312>126 D E /Fi 17 122
df<EA03C0380C3040EA101800201380EA600C12C0EB0D00130E1280130CEAC01C132C38
60C480381F0300120E7E8D17>11 D<120E1203A2EA0180A213C01200A21360A31330A213
781398EA0118EA020C1204EA080EEA18061230EAE00312C010177E9615>21
D<EA0FFF123FEA2080124012801201A21300A25AA31206A2100E7F8D10>28
D<1238127812C0A612781238050A7E900A>44 D<126012F0A2126004047D830A>58
D<126012F0A212701210A21220A21240A2040A7D830A>I<130813181330A31360A313C0
A3EA0180A3EA0300A21206A35AA35AA35AA35AA35AA20D217E9812>61
D<7FA638F08780381FFC00EA07F0EA01C0EA0360EA0220EA0630487EEA0808487E111080
8F12>63 D<0007B512803800E003EC0100A3EA01C0A21440A248485A138113FF1381D807
01C7FCA390C8FC120EA45AEAFFC019177F9616>70 D<38FF807F381C0018141014301420
001E1340120E1480EB0100A213025B120F6C5A5BA25B136013405B120390C7FC12021817
7E9615>86 D<127C1218A45AA4EA6780EA68C0EA7040EA606012C0A4EA80C0A2EA8180EA
C1001246123C0B177E960F>98 D<EA07C0EA1C20EA301012601320EAFFC0EAC000A41310
EA4020EA60C0EA1F000C0E7E8D10>101 D<120313801300C7FCA6121C12241246A25A12
0C5AA31231A21232A2121C09177F960C>105 D<EA383CEA44C6EA47021246EA8E06120C
A3485A144013181480EA3009EB0E00120E7F8D15>110 D<EA1C04EA26061246A2EA8604
120CA3EA1808A213101320EA0C60EA07800F0E7F8D11>118 D<EA0F1F3811A180EA20C3
1400EA41801201A348C7FC130212C3EAE704EAC508EA78F0110E7F8D14>120
D<EA1C02EA26061246A2EA860C120CA3EA1818A31338EA0C70EA07B0EA00301360127013
C0EA2180EA1E000F147F8D11>I E /Fj 38 122 df<B512C0EA1C01EB0040A21420A314
00AFEAFFC013177F9616>0 D<1318A2133CA2134EA21387A238010380000313C0EA0201
000613E0EA04004813F01470481378143848133C141C48131E387FFFFEB6FCA218177E96
1D>I<B512E0EA700000781360003813206C1330001E1310120E6C13007F12036C7E7F6C
5A5B48C7FC000213105A481330A24813604813E0EA7FFFB5FC14177E9619>6
D<120112021204120C1218A21230A212701260A312E0AA1260A312701230A21218A2120C
12041202120108227D980E>40 D<12801240122012301218A2120CA2120E1206A31207AA
1206A3120E120CA21218A2123012201240128008227E980E>I<1330ABB512FCA2380030
00AB16187E931B>43 D<EA07C0EA1830EA3018EA701CEA600CA2EAE00EA9EA600CA2EA70
1CEA3018EA1C70EA07C00F157F9412>48 D<1206120E12FE120EB1EAFFE00B157D9412>
I<EA0F80EA30E0EA4070EA8030EAC03812E0124012001370A2136013C0EA0180EA030012
06EA0C081208EA1018EA3FF0127F12FF0D157E9412>I<126012F0A212601200A6126012
F0A21260040E7D8D0A>58 D<126012F0A212601200A6126012F0A212701210A21220A212
40A204147D8D0A>I<B512FCA2C8FCA6B512FCA2160A7E8C1B>61
D<EAFFFC381C0380EB00C014E01470A414E014C0EB0380381FFE00381C0780EB01C0EB00
E0A514E1A2147238FF803C18177F961A>82 D<EA0FC4EA302CEA601CEA400CEAC004A3EA
E0001270127FEA3FE0EA0FF8EA01FCEA001C130E13061280A3EAC004EAE008EAD810EA87
E00F177E9614>I<12FCA212C0B3AB12FCA206217D980A>91 D<12FCA2120CB3AB12FCA2
062180980A>93 D<EA3FC0EA70601330EA20381200EA03F8EA1E3812301270EAE039A213
79EA70FFEA1F1E100E7F8D12>97 D<12F81238A8EA39F0EA3E0CEA380613077F1480A414
005B1306EA361CEA21F011177F9614>I<EA07F0EA18381230EA7010EA600012E0A41260
EA70081230EA1830EA07C00D0E7F8D10>I<133E130EA8EA07CEEA1C3EEA300E12701260
12E0A412601270EA301EEA182E3807CF8011177F9614>I<EA0FC0EA1860EA3030EA7038
EAE018EAFFF8EAE000A31260EA7008EA3010EA1830EA07C00D0E7F8D10>I<EA03E0EA06
70120EEA1C201300A5EAFF80EA1C00ACEA7F800C1780960B>I<EA0F9EEA18E3EA3060EA
7070A3EA3060EA18C0EA2F80EA20001260EA3FE013F813FCEA600EEAC006A3EA600CEA38
38EA0FE010157F8D12>I<12F81238A813F8EA3B1CEA3C0E1238AA38FE3F8011177F9614>
I<12301278A212301200A512F81238AC12FE07177F960A>I<12F81238A8133E13381330
134013801239EA3FC0EA39E0123813F01378133CA2EAFE7F10177F9613>107
D<12F81238B3A312FE07177F960A>I<38F8F83E383B1CC7393C0F0380EA380EAA39FE3F
8FE01B0E7F8D1E>I<EAF8F8EA3B1CEA3C0E1238AA38FE3F80110E7F8D14>I<EA07C0EA18
30EA3018EA600CA2EAE00EA5EA701CEA3018EA1830EA07C00F0E7F8D12>I<EAF9F0EA3E
1CEA380613077F1480A414005B130EEA3E1CEA39F00038C7FCA512FE11147F8D14>I<EA
F9E0EA3A70123CEA38201300A9B4FC0C0E7F8D0E>114 D<EA1F40EA60C0EAC040A2EAE0
00B4FCEA7F80EA1FC0EA01E0EA8060A212C0EAE0C0EA9F000B0E7F8D0E>I<1208A31218
A21238EAFFC0EA3800A71340A4EA1C80EA0F000A147F930E>I<EAF83EEA380EAA131EEA
1C2E3807CF80110E7F8D14>I<EAFE1FEA380EEA3C0CEA1C08A2EA0E10A2EA0720A213E0
EA03C0A2EA0180A2100E7F8D13>I<EAFE3FEA3C1CEA1C10EA0E20EA074013C0EA0380EA
01C0EA02E0EA04F0EA0870EA1838EA383CEAFC7F100E7F8D13>120
D<EAFE1FEA380EEA3C0CEA1C08A2EA0E10A2EA0720A213E0EA03C0A2EA0180A21300A212
E2A212A4127810147F8D13>I E /Fk 35 120 df<1380EA0100120212065A121C121812
3812301270A312F0A91270A3123012381218121C120C7E12027EEA008009217C9810>40
D<7E12407E12307E121C120C120E12061207A31380A91300A31206120E120C121C12185A
12205A5A09217E9810>I<130EACB612E0A3D8000EC7FCAC1B1B7E9520>43
D<EA07F0EA1C1C487EEA780FEA7007A200F01380A900701300A2EA780FEA380E6C5AEA07
F011157F9414>48 D<EA0180120712FFA21207AFEAFFF8A20D157D9414>I<EA0FC0EA3F
F8EA70FCEAF83C133E131E1270EA003E133C1338137013E0EA01C0EA0380EA0606120CEA
180EEA3FFC127F12FFA20F157E9414>I<127012F8A312701200A5127012F8A31270050F
7D8E0B>58 D<127012F8A312701200A41270A812F8A5127005177D900C>60
D<B612E0A27EC9FCA5007FB512E0B6FCA21B0B7E8D20>I<1306130FA2497EA2497E1337
A2EB63E0A2EBC3F013C100017F1380A248B47EA23806003EA2000E133F000C7F39FF80FF
F0A21C177F961F>65 D<B512C014F0381F00FC143C143EA4143C1478EBFFF014F8EB003C
143E141FA5143E147CB512F814E018177E961D>I<EB7F813803FFF73807E03F380F000F
001E13075A007C1303127800F81300A700781303127C123C6C13066C130C3807E0383803
FFF038007FC018177E961D>I<B512F8A2381F00781438141CA2EB060CA21400130E13FE
A2130E13061406A2EB000CA2141C143C147CB512F8A217177E961B>69
D<EAFFE0A2EA1F00B3EAFFE0A20B177E960F>73 D<B4EC7F806D13FF001FECFC00391BC0
01BCA23919E0033CA33818F006A2EB780CA2EB3C18A2EB1E30A2EB0F60A3EB07C0A23AFF
0381FF80A221177E9626>77 D<EB7F803803C0F0380F003C001E7F487FA2007C14800078
130700F814C0A700781480007C130F003C1400003E5B001E131E6C5B3803C0F038007F80
1A177E961F>79 D<B5FC14E0381F01F06D7E147CA4147814F8EB01E0EBFF80EB03E06D7E
6D7EA51560A239FFE07C40EC1F801B177E961E>82 D<3807F080EA1FFDEA380FEA700312
F01301A26CC7FCB47EEA7FF8EA3FFE6C7E00071380EA007FEB0FC01307EAC003A338E007
8038F80F00EADFFEEA87F812177E9617>I<39FFE00FF0A2391F800180000FEB030013C0
00071306A26C6C5AA26C6C5AA2EBF83800001330EBFC70EB7C60EB7EE0EB3EC0133F6D5A
A26DC7FCA213061C177F961F>86 D<EA0FE0EA3838EA3C1C131E1218120013FEEA0F9EEA
3C1E127812F0A338786FC0EA1F87120F7F8E14>97 D<12FCA2123CA6EA3DFCEA3F0F383C
038014C0130114E0A514C013031480383B0F00EA31F813177E9617>I<EA07F8EA1C0EEA
381E1278EA700CEAF000A512701278EA3806EA1C0CEA07F80F0F7F8E12>I<EA07F0EA1C
18EA380CEA7806EA700712F0A2B5FCEAF000A212701278EA3803EA1E06EA03FC100F7F8E
13>101 D<12FCA2123CA6137CEA3D8EEA3E0FA2123CA938FF3FC0A212177E9617>104
D<1238127CA312381200A412FCA2123CAB12FFA208187F970B>I<12FCA2123CA6EB1F80
A2EB1C005B1360EA3DC0EA3FE0A2EA3E70EA3C787F7F130E38FF1FC0A212177F9615>
107 D<12FCA2123CB312FFA208177F960B>I<EAFC7CEAFD8EEA3E0FA2123CA938FF3FC0
A2120F7E8E17>110 D<EA07F0EA1C1C487E487EA200F01380A500701300A2EA380E6C5A
EA07F0110F7F8E14>I<EAFDFCEAFF0F383C038014C0130114E0A514C01303EB0780383F
0F00EA3DF8003CC7FCA4B4FCA213157E8E17>I<EAF870EAF99CEA3A3CA2EA3C181300A8
EAFF80A20E0F7F8E11>114 D<EA1FF0EA6070EA403012C0EAE000B4FCEA7FE0EA3FF0EA
0FF8EA0078EAC018A2EAE010EAF020EACFC00D0F7F8E10>I<120CA4121CA2EA3FE012FF
EA3C00A71330A4EA1E60EA07C00C157F9410>I<EAFC3FA2EA3C0FAA5B381C2FC0EA0FCF
120F7E8E17>I<39FE3F8FC0A2393C0E0300EB0F07381E1F06A2380F3F8C133314DC3807
E1D8A2000313F013C0A2380180601A0F7F8E1D>119 D E /Fl 4
78 df<12021207EA0D80EA18C0EA3060EA6030EAC018A2EA6030EA3060EA18C0EA0D80EA
070012020D0E7E8D12>5 D<EB3F80EBFFE03803C0783807001C000C1306487F48EB0180
A248EB00C0A2481460A6006014C0A26CEB0180A26CEB03006C13060007131C3803C07838
00FFE0EB3F801B1A7E9321>13 D<1204120EA2121CA31238A212301270A21260A212C0A2
070F7F8F0A>48 D<01181480013813011503013C1307137C015C130F151B015EEB3B0015
73018E5B90388F01C7EC03873901070F07149E000313BC380203F0000613E0388C01C026
FC008013C04801001380007091C7FC22157F9327>77 D E /Fm 1
22 df<1207EA01C07F12007F1370A213781338A2133C131CA2131E130EA2130F7F131FEB
3780136313C3380183C0EA0381EA0701000E13E0EA1C005A48137012F048137848133815
207D9F1B>21 D E /Fn 15 119 df<1206120E12181230A21260A312C0A71260A31230A2
1218120E120607177B930F>40 D<128012C012601230A21218A3120CA71218A31230A212
6012C0128006177D930F>I<120CA3EACCC012FFEA3F00121E123FEAFFC012CCEA0C00A3
0A0D7E8E0F>I<EAFFC0A30A037E890F>45 D<EA7FE0EAFFF0A2C7FCA3EAFFF0A2EA7FE0
0C097F8C0F>61 D<124012E07E12787E7E7EEA07C012031207EA0F00121E5A5A5A5A1240
0A117E900F>I<12FCA21230AB1330A3EAFFF0A20C127F910F>76
D<12F0A21230A3EA3380EA3FE0EA3C70EA3830EA3018A5EA3830EA3C70EA3FE0EA13800D
1280910F>98 D<1208121C1208C7FCA3127CA2120CA9EAFF80A209137D920F>105
D<12FCA2120CAEEAFFC0A20A127E910F>108 D<EAF3C0EAFFE0EA3C3012381230A7EAFC
FCA20E0D808C0F>110 D<121E123FEA73801261EAC0C0A5EA61801273EA3F00121E0A0D
7E8C0F>I<EA3F80127F12C1A2EAE000127E121FEA0180EA40C012C012E0EAFF80EADF00
0A0D7E8C0F>115 D<12081218A2EA7FC012FFEA1800A61360A3EA0FC0EA07800B107F8F
0F>I<EAF9F0A2EA30C0A31239EA1980A3EA0F00A312060C0D7F8C0F>118
D E /Fo 40 122 df<90383FC1FE3A01F03F81803A03C03E01C0000790387E03E0380F80
7CA2ED01C092C7FCA4B712E0A2390F807C03AE3A7FE1FF0FFCA2261D809C28>14
D<EAFFF8A40D04808A10>45 D<127812FCA4127806067D850D>I<90381FE0209038FFF8
E03803F80F3807C003380F800148C7FC123E1560127E127C00FC1400A8007C1460127E12
3E15C07E390F8001803907C003003803F80E3800FFFCEB1FE01B1C7D9B22>67
D<B512F814FF390FC01FC0EC07E0EC01F015F8140015FC157CA2157EA8157CA315F8A2EC
01F0EC07E0EC1FC0B6120014F81F1C7E9B25>I<B6FCA2380FC01F1407801580A214C1A3
9038C1C00013C313FFA213C313C113C01560A2EC00E015C0A21401A21403EC0F80B6FCA2
1B1C7E9B1F>I<B6FCA2380FC01F1407801580A2140114C1A2ECC00013C113C313FFA213
C313C113C0A391C7FCA6EAFFFEA2191C7E9B1E>I<90380FF00890387FFE383901FC07F8
3807E001390F80007848C7FC481438123E007E1418127C00FC1400A6EC7FFFA2007CEB01
F8127E123E123F7EEA0F80EA07E03801FC0739007FFE7890380FF818201C7D9B26>I<39
FFFC3FFFA2390FC003F0AA90B5FCA2EBC003AC39FFFC3FFFA2201C7E9B25>I<EAFFFCA2
EA0FC0B3A6EAFFFCA20E1C7E9B12>I<EAFFFEA2EA0FC0AF1403A31407A21406140E141E
147EB512FEA2181C7E9B1D>76 D<D8FFC0EB03FF6D5B000F15F0D80DF0130DA3D80CF813
19A2017C1331A26D1361A26D13C1A390380F8181A2903807C301A2EB03E6A2EB01FCA3EB
00F8A23AFFC0701FFFA2281C7E9B2D>I<EB3FE03801F07C3803C01E390F800F80391F00
07C0001E1303003E14E0007E14F0007C1301A200FC14F8A8007C14F0007E1303A2003E14
E0003F13076C14C0390F800F803903C01E003801F07C38003FE01D1C7D9B24>79
D<B512F814FE390FC03F80140FEC07C015E0A515C0A2EC0F80EC3F00EBFFFC01C0C7FCAB
EAFFFCA21B1C7E9B21>I<B512F014FE380FC03FEC0F806E7E81A55D4A5A023EC7FCEBFF
F0EBC07C80143F6E7EA6ED8180A2EC0FC13AFFFC07C300EC01FE211C7E9B24>82
D<3807F820381FFEE0EA3C07EA7801EA700012F01460A26C130012FEEAFFE0EA7FFE6C7E
1480000F13C06C13E0EA007FEB03F01301130012C0A214E07E38F001C0EAFC0338EFFF00
EA83FC141C7D9B1B>I<007FB512E0A238781F81007013800060146000E0147000C01430
A400001400B03807FFFEA21C1C7E9B21>I<EA0FF8EA1C1E383E0F80130714C0121C1200
137FEA07E7EA1F07123C127C12F8A3EA780B383E13F8EA0FE115127F9117>97
D<B4FCA2121FA9EB3F80EBE1E0EB8070EB0078143CA2143EA6143CA21478EB8070381EC1
E0381C3F00171D7F9C1B>I<EA03FCEA0E0EEA1C1F123C1278130E00F8C7FCA61278EB01
80123C381C0300EA0E0EEA03F811127E9115>I<EB0FF0A21301A9EA01F9EA0F07EA1C03
EA3C011278A212F8A61278A2123CEA1C03380F0FFEEA03F9171D7E9C1B>I<EA03FCEA0F
07381C0380383C01C0127814E012F8A2B5FC00F8C7FCA3127814607E6C13C0380F038038
01FC0013127F9116>I<137F3801E3803803C7C0EA0787120FEB8380EB8000A5EAFFF8A2
EA0F80AEEA7FF0A2121D809C0F>I<3803F0F0380E1F38EA3C0F3838073000781380A400
381300EA3C0FEA1E1CEA33F00030C7FCA3EA3FFF14C06C13E014F0387801F838F00078A3
00701370007813F0381E03C03807FF00151B7F9118>I<B4FCA2121FA9EB0FC0EB31E0EB
40F0EB80F8A21300AB38FFE7FFA2181D7F9C1B>I<121E123FA4121EC7FCA6127FA2121F
AEEAFFC0A20A1E7F9D0E>I<B4FCA2121FB3A7EAFFE0A20B1D7F9C0E>108
D<39FF0FC07E903831E18F3A1F40F20780D980FC13C0A2EB00F8AB3AFFE7FF3FF8A22512
7F9128>I<38FF0FC0EB31E0381F40F0EB80F8A21300AB38FFE7FFA218127F911B>I<EA01
FC380F0780381C01C0003C13E0387800F0A200F813F8A6007813F0A2383C01E0381E03C0
380F07803801FC0015127F9118>I<38FF3F80EBE1E0381F80F0EB0078147C143C143EA6
143C147C1478EB80F0EBC1E0EB3F0090C7FCA6EAFFE0A2171A7F911B>I<3803F060380F
0CE0EA1E07EA3C03127C127812F8A61278127C123CEA1C07EA0E0FEA03F3EA0003A6EB1F
FCA2161A7E9119>I<EAFE3E1347381E8F80A3381F070090C7FCAAEAFFE0A211127F9114>
I<EA1FD8EA3078EA601812E0A2EAF000EAFF80EA7FE013F0EA1FF8EA07FCEA007CEAC01C
A212E01318EAF830EACFC00E127E9113>I<1203A45AA25AA2EA3FFC12FFEA1F00A9130C
A4EA0F08EA0798EA03F00E1A7F9913>I<38FF07F8A2EA1F00AC1301120F380786FFEA01
F818127F911B>I<38FFC1FCA2381F00601380000F13C0A23807C180A23803E300A213F7
EA01F613FE6C5AA21378A2133016127F9119>I<39FF8FF8FEA2391F03E030A3390F87F0
6013869038C6F8E03907CC78C0A23903FC7D80EBF83D143F3901F01F00A20000131EEBE0
0EA21F127F9122>I<38FFC7FCA2381F81C0380F83803807C700EA03EEEA01FC5B120013
7C13FEEA01DF38039F80EA070F380607C0380C03E038FF07FCA216127F9119>I<38FFC1
FCA2381F00601380000F13C0A23807C180A23803E300A213F7EA01F613FE6C5AA21378A2
1330A25B1270EAF8E05BEAF9800073C7FC123E161A7F9119>I E
/Fp 8 119 df<EA07B0EA0C701210EA30601260A3EAC0C013C8A21241EA62D0EA3C700D
0D7E8C12>97 D<123C120C5AA45AEA3380EA3C60EA3020EA6030A4EAC060A2EA40C0EA60
80EA2300121E0C147F930F>I<EA0780EA1840EA3020EA604012C0EAFF80EAC0005AA2EA
C0201340EA6180EA3E000B0D7E8C10>101 D<123C120C1218A41230A41260A412C012C8
A312D0126006147F930A>108 D<3830F87C38590C86384E0D06EA9C0EEA980C1218A248
485A15801418A23960301900140E190D7F8C1D>I<EA30F8EA590C124E129C12981218A2
EA301813191331A2EA6032131C100D7F8C15>I<1204120CA35AEAFF80EA1800A25AA45A
1261A212621264123809127F910D>116 D<EA3810EA4C181310128C12981218A2EA3020
A21340A2EA1880EA0F000D0D7F8C11>118 D E /Fq 2 51 df<121812F81218AA12FF08
0D7D8C0E>49 D<123EEA4180EA80C012C01200A2EA0180EA03001204EA08401230EA7F80
12FF0A0D7E8C0E>I E /Fr 69 127 df<EAE038EAF078A7EAE038A2EA60300D0B7C9816>
34 D<38380180EA7C03A238EE0700A2130EA35B127C5B1238C65AA35BA2485AA3485AEB
8380380707C0A2380E0EE0A3121CA2383807C0A23818038013207F9C16>37
D<12301278127C123C121CA41238127812F012E01240060D789816>39
D<13E01201EA0380EA0700120E5AA25AA25AA35AA91270A37EA27EA27E7EEA0380EA01E0
12000B217A9C16>I<12C07E12707E7E7EA27EA2EA0380A3EA01C0A9EA0380A3EA0700A2
120EA25A5A5A5A5A0A217B9C16>I<EA0380A4EAE38EEAF39EEAFFFEEA3FF8EA0FE0A2EA
3FF8EAFFFEEAF39EEAE38EEA0380A40F127D9516>I<13E0A8B512E0A33800E000A81313
7F9516>I<1238127C127EA2123E120E121E121C127812F01260070B798416>I<B51280A3
11037E8D16>I<127012F8A312700505788416>I<EB01801303A2EB0700A2130EA25BA25B
A25BA25BA2485AA2485AA248C7FCA2120EA25AA25AA25AA25AA25A11207E9C16>I<EA03
E0EA0FF8487EEA1E3CEA380EEA780FEA7007A238E00380A8EAF00700701300A2EA780FEA
3C1E6C5AEA1FFC6C5AEA03E011197E9816>I<12035AA25A5AB4FCA212E71207AEEAFFF8
A30D197B9816>I<EA07E0EA1FF8487EEA783EEAE00700F01380130312601200A2EB0700
A2130E5B5B5B5B485A485A000FC7FC381E03801238EA7FFFB5FC7E11197E9816>I<EA07
E0EA1FF8487EEA781E130712301200A2130E133EEA07FC13F013FCEA001E13077F1480A2
126012F038E00700EA781EEA3FFC6C5AEA07E011197E9816>I<137C13FC13DC1201EA03
9CA2EA071C120F120E121E123C1238127812F0B512E0A338001C00A53801FFC0A313197F
9816>I<EA3FFE127FA20070C7FCA7EA77F0EA7FFC7FEA780FEA300738000380A2126012
F0A238E00700EA781EEA3FFC6C5AEA07E011197E9816>I<12E0B51280A338E00F00131E
EA001C5B137813705BA2485AA3485AA448C7FCA7111A7E9916>55
D<EA07F0EA1FFC487EEA7C1F38F00780EAE003A338700700EA7C1FEA1FFCEA07F0EA1FFC
EA3C1EEA700700F01380EAE003A3EAF00700701300EA7C1FEA3FFE6C5AEA07F011197E98
16>I<127012F8A312701200A8127012F8A312700512789116>58
D<1238127CA312381200A812381278127CA2123C121CA21238127012F012400618799116
>I<EB01801307131FEB3E0013F8485AEA07C0485A003EC7FC12FC12F012FC123EEA0F80
6C7EEA01F06C7E133EEB1F801307130111157E9616>I<387FFFC0B512E0A2C8FCA5B512
E0A26C13C0130B7F9116>I<12C012F012FC123EEA0F806C7EEA01F06C7E133EEB1F8013
07131FEB3E0013F8485AEA07C0485A003EC7FC12FC12F012C011157E9616>I<EA0FF0EA
3FFE487E38F00F801303A2EA600738001F00133E13785BEA01C0A55BC8FCA4487E487EA2
6C5A11197E9816>I<13E0487EA213B0A2EA03B8A31318EA071CA5EA0E0EA2EA0FFEA248
7EEA1C07A3387E0FC038FF1FE0387E0FC013197F9816>65 D<EA7FF8EAFFFE6C7EEA1C07
14801303A4EB0700EA1FFF5BA2EA1C1FEB038014C01301A41303EB0780EA7FFFB51200EA
7FFC12197F9816>I<3801F180EA07FBEA0FFFEA1F0FEA3C07EA38031270A200F0C7FC5A
A77E38700380A21238383C0700EA1F0FEA0FFE6C5AEA01F011197E9816>I<EA7FFCEAFF
FEEA7FFCEA0380B3EA7FFCEAFFFEEA7FFC0F197D9816>73 D<48B4FC4813806C1300EA00
1CB0126012F05BEA7FF85BEA1FC011197E9816>I<B47E7F5B001CC7FCAE144014E0A4B5
FCA313197F9816>76 D<38FC07E0EAFE0FA2383A0B80EA3B1BA513BBEA39B3A413F3EA38
E3A21303A538FE0FE0A313197F9816>I<387E07F038FF0FF8387F07F0381D81C0A313C1
121C13E1A213611371A313311339A21319131D130DA3EA7F07EAFF87EA7F031519809816
>I<EA1FFC487E487EEA780F38F00780EAE003AEEAF007A238780F00EA7FFF6C5A6C5A11
197E9816>I<EA7FF0EAFFFC6C7EEA1C0FEB07801303A41307EB0F00EA1FFE5B7FEA1C0E
7FA414101438A2387F03F0EAFF83387F01E01519809816>82 D<EA07E3EA1FFF5AEA781F
EAF00712E0A290C7FC7E1278EA3F80EA1FF0EA07FCC67E130F7FEB0380A2126012E0EB07
00EAF80FEAFFFE5BEAC7F011197E9816>I<387FFFE0B5FCA2EAE0E0A400001300AFEA07
FC487E6C5A13197F9816>I<38FE0FE0A338380380EA3C07001C1300A3EA1E0FEA0E0EA4
6C5AA4EA031813B8A3EA01B013F0A26C5A13197F9816>86 D<387FFF80B5FCA238E00700
5B131E131CEA003C5B137013F0485A5B1203485A90C7FC5A381E0380121C123C12781270
B5FCA311197E9816>90 D<EAFFF0A3EAE000B3A8EAFFF0A30C20789C16>I<EAFFF0A3EA
0070B3A8EAFFF0A30C207F9C16>93 D<B51280A311037E7E16>95
D<EA1FE0487E487EEA783CEA300E1200A2EA03FE121FEA3E0E127012E0A3EA783E387FFF
E0EA3FE7EA0F8313127E9116>97 D<12FCA3121CA4137CEA1DFEEA1FFFEB0780381E03C0
EA1C01EB00E0A6EB01C0EA1E03381F0780EBFF00EA1DFEEA0C7813197F9816>I<EA03F8
EA0FFCEA1FFEEA3C1EEA780CEA70005AA57EEA70071278EA3E0EEA1FFCEA0FF8EA03F010
127D9116>I<133FA31307A4EA03C7EA0FF748B4FCEA3C1F487EEA700712E0A6EA700F12
786C5A381FFFE0EA0FF7EA07C713197F9816>I<EA03F0EA0FFC487EEA3C0F487E387003
8012E0B5FCA300E0C7FCA2387003801278EA3E07381FFF00EA07FEEA01F811127E9116>
I<131E137F3801FF8013C7380383001380A2EA7FFFB5FCA2EA0380ACEA7FFC487E6C5A11
197F9816>I<3803E3C03807F7E0EA0FFF381C1CC038380E00A56C5AEA0FF8485AEA1BE0
0038C7FC1218EA1FFC13FF481380387003C038E000E0A4387001C0EA7C07383FFF80380F
FE00EA03F8131C7F9116>I<12FCA3121CA41378EA1DFCEA1FFE130FEA1E07121CAA38FF
8FE0139F138F13197F9816>I<1203EA0780A2EA0300C7FCA4EAFF80A31203ACEAFFFC13
FE13FC0F1A7C9916>I<127E12FE127E120EA4EB7FE0A3EB0F00131E5B5B5B120F7F13BC
131EEA0E0E7F1480387F87F0EAFFCFEA7F871419809816>107 D<EA7FC012FF127F1201
B3EA7FFFB512806C130011197E9816>I<38F9C38038FFEFC0EBFFE0EA3C78A2EA3870AA
38FE7CF8A31512809116>I<EAFC78EAFDFCB47EEA1F0FEA1E07121CAA38FF8FE0139F13
8F13127F9116>I<EA03E0EA0FF8487EEA3C1E487EEA700738E00380A5EAF00700701300
EA780FEA3C1EEA1FFC6C5AEA03E011127E9116>I<EAFC7CEAFDFEB5FC381F0780381E03
C0EA1C01EB00E0A6EB01C0EA1E03381F0780EBFF00EA1DFEEA1C7890C7FCA6B47EA3131B
7F9116>I<3803E380EA0FF3EA1FFBEA3E0FEA78071270EAE003A6EA70071278EA3C1FEA
1FFBEA0FF3EA03E3EA0003A6EB1FF0EB3FF8EB1FF0151B7F9116>I<387F0FC038FF3FE0
EA7F7F3807F040EBC0005BA290C7FCA8EA7FFC12FF127F13127F9116>I<EA0FECEA3FFC
127FEAF03CEAE01CA2EA7000EA7F80EA1FF0EA07F8EA003CEA600E12E012F0EAF81EEAFF
FC13F8EAC7E00F127D9116>I<12035AA4EA7FFFB5FCA20007C7FCA75BEB0380A3EB8700
EA03FE6C5A6C5A11177F9616>I<EAFC3FA3EA1C07AB131F381FFFE0EA0FF7EA07C71312
7F9116>I<387F1FC038FF9FE0387F1FC0381C0700A2EA0E0EA36C5AA4EA03B8A3EA01F0
A26C5A13127F9116>I<38FF1FE0A338380380A4EA39F3A20019130013B3A3EA1DB71317
EA1F1FEA0F1EEA0E0E13127F9116>I<387F1FC0133F131F380F1E006C5AEA03B813F012
016C5A12017FEA03B8EA073C131CEA0E0E387F1FC038FF3FE0387F1FC013127F9116>I<
387F1FC038FF9FE0387F1FC0381C0700120E130EA212075BA2EA039CA21398EA01B8A2EA
00F0A35BA3485A1279127BEA7F8090C7FC123C131B7F9116>I<383FFFC05AA238700780
EB0F00131EC65A5B485A485AEA078048C7FC381E01C0123C1278B5FCA312127F9116>I<
12E0B3AE0320779C16>124 D<EA1C30EA3F78EAFFF8EAF7E0EA61C00D057C9816>126
D E /Fs 13 107 df<EB03FE90380FFF8090383C01E09038F00078D801C0131C48C71206
00068048EC018048EC00C0A2481560A2481530A3481518A900601530A36C1560A26C15C0
A26CEC01806CEC03006C1406D801C0131CD800F0137890383C01E090380FFF80D903FEC7
FC25277E9D2A>13 D<EA03C0EA0FF0EA1FF8EA3FFCEA7FFEA2B5FCA4EA7FFEA2EA3FFCEA
1FF8EA0FF0EA03C010107E9115>15 D<B612E07EC9FCA7B612E0A2C9FCA7007FB512E0B6
FC1B147E9320>17 D<EC01801407EC1E001478EB01E0EB0780011EC7FC1378EA01E0EA07
80001EC8FC127812E01278121EEA0780EA01E0EA0078131EEB0780EB01E0EB0078141EEC
0780140191C7FCA7007FB5FCB6128019227D9920>20 D<153081A381A281811680ED00C0
B712F8A2C912C0ED0380160015065DA25DA35D25167E942A>33 D<134013C0A3487EA248
7EEA06D8EA0CCCEA38C738F0C3C0EAC0C000001300B3A712257F9C15>I<1403A26E7E81
14001560007FB512F0B67EC8120E81ED01E0ED0078ED01E0ED0380ED06005DB612F86C5C
C812605D4A5AA24AC7FCA225187E952A>41 D<124012C0ACB512E014F000C0C7FCAD1240
141D7E9C19>96 D<133C13E0EA01C013801203AD13005A121C12F0121C12077E1380AD12
0113C0EA00E0133C0E297D9E15>102 D<12F0121C12077E1380AD120113C0EA00E0133C
13E0EA01C013801203AD13005A121C12F00E297D9E15>I<134013C0EA0180A3EA0300A2
1206A35AA25AA35AA25AA35AA21260A37EA27EA37EA27EA37EA2EA0180A3EA00C013400A
2A7D9E10>I<12C0A21260A37EA27EA37EA27EA37EA2EA0180A3EA00C0A2EA0180A3EA03
00A21206A35AA25AA35AA25AA35AA20A2A7E9E10>I<12C0B3B3A502297B9E0C>I
E /Ft 32 123 df<13F8EA030C380E0604EA1C07383803080030138800701390A200E013
A0A214C01480A3EA6007EB0B8838307190380F80E016127E911B>11
D<EB01F0EB0618EB080C1310EB200E13401380141CEA01001418143838020FF0EB10C0EB
0FE0EB00305AA21438A2481370A314E01218EB01C000141380EB0300EA230EEA20F890C7
FCA25AA45AA217257F9C17>I<EA3C1F384E6180384681C0EA4701128F128E120EA2381C
0380A438380700A4EA700E12301200A25BA45BA21330121B7E9115>17
D<EA0780EA01C07F1200A27F1370A213781338A2133C131CA2131E130E131E133F136713
C738018780EA03031206000E13C0EA1C011238007013E0EAE0004813F0141D7E9C18>21
D<3801FFF85A120F381E1E00EA180EEA38061270A2EAE00EA3130C131C13185BEA60606C
5A001FC7FC15127E9118>27 D<380FFFE05A5A3860C0001240485A12001201A348C7FCA3
5AA3120E120613127E9112>I<121E123E126012C0A51260123E121E070B7E930C>44
D<126012F0A2126004047C830C>58 D<126012F0A212701210A41220A212401280040C7C
830C>I<EC0380EC0F00143C14F0EB03C0010FC7FC133C13F0EA03C0000FC8FC123C12F0
A2123C120FEA03C0EA00F0133C130FEB03C0EB00F0143C140FEC038019187D9520>I<13
0113031306A3130CA31318A31330A31360A213C0A3EA0180A3EA0300A31206A25AA35AA3
5AA35AA35AA210297E9E15>I<12E01278121EEA0780EA01E0EA0078131EEB0780EB01E0
EB0078141EEC0780A2EC1E001478EB01E0EB0780011EC7FC1378EA01E0EA0780001EC8FC
127812E019187D9520>I<48B5FC39003C01C090383800E015F01570A25B15F0A2EC01E0
9038E003C0EC0780EC1F00EBFFFC3801C00FEC0780EC03C0A2EA0380A439070007801500
140E5C000E1378B512C01C1C7E9B1F>66 D<EA01E3EA0717EA0C0F1218EA380E12301270
A2485AA4EB3880A3EA607838319900EA1E0E11127E9116>97 D<123F1207A2120EA45AA4
EA39E0EA3A30EA3C1812381270131CA3EAE038A313301370136013C01261EA2300121E0E
1D7E9C12>I<EA01F0EA030C120CEA1C1EEA383CEA3018EA7000A25AA51304EA60081310
EA3060EA1F800F127E9112>I<EB07E01300A2EB01C0A4EB0380A43801E700EA0717EA0C
0F1218EA380E12301270A2485AA4EB3880A3EA607838319900EA1E0E131D7E9C16>I<EA
01F0EA0708120CEA1804EA38081230EA7030EA7FC0EAE000A51304EA60081310EA3060EA
0F800E127E9113>I<EA0FC01201A2485AA448C7FCA4EA0E3E13C3380F0380120E121E12
1CA338380700A3130E00701320A2131C144038E00C8038600700131D7E9C18>104
D<EA01C01203A2EA0180C7FCA6121C12271247A21287A2120EA25AA35A1380A21270EA71
001232121C0A1C7E9B0E>I<EA1F801203A2EA0700A4120EA45AA45AA45AA412E2A312E4
12641238091D7F9C0C>108 D<39381F81F0394E20C618394640E81CEB80F0EA8F00008E
13E0120EA2391C01C038A315703938038071A215E115E23970070064D83003133820127E
9124>I<EA3C1F384E6180384681C0EA4701128F128E120EA2381C0380A3EB0700003813
10A2130E1420387006403830038014127E9119>I<13F8EA030CEA0E06487E1218123000
701380A238E00700A3130EA25BEA60185BEA30E0EA0F8011127E9114>I<380787803809
C8603808D03013E0EA11C014381201A238038070A31460380700E014C0EB0180EB8300EA
0E86137890C7FCA25AA4123CB4FC151A819115>I<EA3C3CEA4E42EA4687EA470FEA8E1E
130CEA0E00A25AA45AA45A123010127E9113>114 D<EA01F0EA060CEA0C04130EEA180C
EA1C00121FEA0FE013F0EA03F8EA0038EA201CEA701812F01310EA8030EA6060EA1F800F
127E9113>I<13C01201A3EA0380A4EAFFF0EA0700A3120EA45AA4EA3820A21340A2EA18
80EA0F000C1A80990F>I<EA1C03EA270712471303EA8701A2120EA2EA1C02A313041218
1308A2EA1C10EA0C20EA07C010127E9114>118 D<380787803808C8403810F0C03820F1
E0EBE3C03840E1803800E000A2485AA43863808012F3EB810012E5EA84C6EA787813127E
9118>120 D<001C13C0EA27011247A238870380A2120EA2381C0700A4EA180EA3EA1C1E
EA0C3CEA07DCEA001C1318EA6038EAF0305B485AEA4180003EC7FC121A7E9114>I<EA03
81EA07C1EA0FF6EA081CEA1008EA0010132013401380EA010012025AEA08041210EA3C18
EA67F8EA43F0EA81E010127E9113>I E /Fu 50 122 df<1241EAE38012611220A3EA41
00A2128209097F9311>34 D<EB3060A3EB60C0A4EBC180387FFFF8B512FC38018300A3EA
0306A3B512FC6C13F838060C00485AA4485AA3161A7E931B>I<1360AAB512F0A2380060
00AA14167E9119>43 D<124012E012601220A31240A2128003097D8209>I<12FFA20802
80860B>I<124012E0124003037D8209>I<120FEA30C0EA6060A2EA4020EAC030A9EA4020
EA6060A2EA30C0EA0F000C137E9211>48 D<120C121C12EC120CAFEAFFC00A137D9211>
I<121FEA60C01360EAF07013301260EA0070A2136013C012011380EA02005AEA08101210
EA2020EA7FE012FF0C137E9211>I<EA0FC0EA3070EA7038A31200133013E0EA0FC0EA00
7013381318131C126012F01318EAE038EA6070EA1FC00E137F9211>I<136013E0A2EA01
6012021206120C120812101220126012C0EAFFFCEA0060A5EA03FC0E137F9211>I<EA60
60EA7FC01380EA44001240A3124FEA70C0EA40E0EA00601370A212E0A21360EA40E0EA21
C0EA1F000C137E9211>I<EA07C0EA0C20EA10701220EA6000A25A12CFEAD0C0EAE060EA
C0201330A31240EA6020EA2060EA10C0EA0F000C137E9211>I<EA0FC0EA1070EA201812
60A21270EA3C30EA3F60EA0F8013E0EA31F0EA6078EAC01C130CA3EA6018EA3030EA0FC0
0E137F9211>56 D<120FEA3080EA6040EA4060EAC0201330A31240EA6070EA30B0EA0F30
120013201360EAE0401380EA4100123E0C137E9211>I<1330A21378A3139CA2EA019E13
0EA2EA0207A200061380EA07FFEA0403380801C0A2001813E0EA380038FE07FC16147F93
19>65 D<EBFC2038070360380C00E04813605A00701320126000E01300A6006013201270
12306C13406C138038070300EA00FC13147E9318>67 D<B51280EA1C031300A21440A213
0814001318EA1FF8EA1C181308A290C7FCA6EAFFC012147F9315>70
D<EBFC2038070360380C00E04813605A00701320126000E01300A4EB0FF8EB00E0126012
7012307E7E380703603800FC2015147E931A>I<EAFF80EA1C00B2EAFF8009147F930C>
73 D<00FEEB0FE0001E140000171317A338138027A23811C047A23810E087A3EB7107A2
133AA2131CA2123839FE083FE01B147F931E>77 D<38FC01FC381E007000171320138012
13EA11C0EA10E01370A21338131C130E130F1307EB03A0EB01E01300A20038136000FE13
2016147F9319>I<EAFFF8EA1C07EB0380EB01C0A4EB0380EB0700EA1FF8EA1C0E7FEB03
80A41484A2EB01CC38FF80F816147F9318>82 D<EA1F10EA30F0EA603012C01310A2EAE0
001270127FEA3FC0EA0FE0EA00F0133813181280A3EAC030EAF060EA8FC00D147E9312>
I<387FFFF03860703000401310A200801308A300001300ACEA07FF15147F9318>I<38FF
81FC381C00701420AD120C000E13400006138038038300EA00FC16147F9319>I<EA2080
EA4100A21282A312C3EAE380EA410009097A9311>92 D<127FEAE1C0EAE040EA40601200
EA07E0EA3860126012C01364A2EA61E4EA3E380E0D7E8C11>97 D<12F01230A6EA33E0EA
3430EA3808EA300C1306A5130CEA3808EA3430EA23E00F147F9312>I<EA0FE0EA187012
20EA6020EAC000A51260EA2010EA1820EA0FC00C0D7F8C0F>I<13781318A6EA0F98EA18
78EA2038EA601812C0A51260EA2038EA1858EA0F9E0F147F9312>I<EA0F80EA1040EA20
20EA6030EAC010EAFFF0EAC000A31260EA2010EA1820EA0FC00C0D7F8C0F>I<EA03C0EA
0CE0121813401300A3B4FC1218AB127F0B1480930A>I<EA0F3CEA30E6EA2040EA6060A3
EA2040EA30C0EA2F001260A2EA3FE013F0EA6018EAC00CA3EA6018EA3030EA0FC00F147F
8C11>I<12F01230A6EA33E0EA3430EA38181230A9EAFC7E0F147F9312>I<122012701220
1200A512F01230AB12FC06157F9409>I<12F01230A6137C133013601380EA31001233EA
3F801231EA30C0136013701330EAFC7C0E147F9311>107 D<12F01230B212FC06147F93
09>I<38F3E1F03834321838381C0CEA3018A938FC7E3F180D7F8C1B>I<EAF3E0EA3430EA
38181230A9EAFC7E0F0D7F8C12>I<EA0FC0EA1860EA2010EA6018EAC00CA5EA6018A2EA
3870EA0FC00E0D7F8C11>I<EAF3E0EA3430EA3808EA300C1306A5130CEA3808EA3430EA
33E0EA3000A512FC0F137F8C12>I<EAF3C0EA34E01238EA30401300A812FE0B0D7F8C0D>
114 D<EA3E80126112C0A2EAE000127EEA3F80EA03C01280A212C0EAE180EA9F000A0D7F
8C0D>I<1210A312301270EAFF80EA3000A71380A3EA1100120E09127F910D>I<EAF078EA
3018A91338EA1858EA0F9E0F0D7F8C12>I<EAF83CEA30181310EA3830EA1820A2EA0C40
A2EA0680A3EA0300A20E0D7F8C11>I<38F87CF83870703038305820A238188840138CA2
380D04801306A238060300A3150D7F8C18>I<EAF87CEA3030EA1860EA0C401380EA0700
7EEA0780EA0CC0EA08601210EA3030EAF07C0E0D7F8C11>I<EAF83CEA30181310EA3830
EA1820A2EA0C40A2EA0680A3EA0300A21202A212E4A212E812700E137F8C11>I
E /Fv 1 4 df<1218A212DB12FF121812FF12DB1218A208097D890F>3
D E /Fw 60 123 df<14FE90380301801306EB0C03EB1C0191C7FC13181338A43803FFFE
3800700EA35CA213E0A25CA3EA01C01472A438038034141891C7FC90C8FCA25A12C612E6
5A12781925819C17>12 D<903801FEE0EB0707130E010C13C0EB1C01A213189038380380
A40003B5120038007007A3140EA213E0A25CA3EA01C01439A43803801A140C91C7FC90C8
FCA25A12C612E65A12781B25819C18>I<903901FC0FEE9039030E307E0106136090390C
0CE07C90391C00C01C1401A201381438A2EC0380A20003B612F03A00380380701370EC07
0016E0A313E091380E01C0A4D801C0EB0388141CA216901501D80380EB00E04A1300A213
00143038C6306038E6384038CC3180D8781FC8FC2725819C25>15
D<EA1830EA3C78A2EA3870EA0810A2EA1020A2EA2040A2EA4080EA81000D0C799C15>34
D<1218123CA31204A21208A21210122012401280060C779C0D>39
D<13031306130813181330136013C0A2EA0180EA0300A21206A25AA2121C1218A2123812
30A21270A21260A412E0A51260A51220123012107EA2102A7B9E11>I<1310A21308130C
13041306A51307A51306A4130EA2130CA2131C1318A213381330A21360A213C0A2EA0180
EA0300A212065A5A121012605A102A809E11>I<12181238127812381208A21210A21220
1240A21280050C7D830D>44 D<EAFFC0A30A037D890F>I<1230127812F0126005047C83
0D>I<1304130C131813381378EA07B8EA0070A413E0A4EA01C0A4EA0380A4EA0700A45A
EAFFF00E1C7B9B15>49 D<133EEB4180EB80C0EA0100000213E0EA0440A21208A3381081
C0A238110380000E1300EA00065B5B136013800003C7FC12044813404813805AEB0100EA
7F07EA43FEEA81FCEA8078131D7D9B15>I<131FEB60C013803801006012021340000413
E0A3EB81C0EA030138000380EB070013FC131C1306A21307A41270EAE00E12805BEA4018
5BEA20E0EA1F80131D7D9B15>I<EB80603801FFC01480EBFE0090C7FC1202A45A13F8EA
050CEA0606120C1208120013071306130EA21270130CEAE01CEA80181338EA40305BEA21
C0001FC7FC131D7C9B15>53 D<EB0F80EB3860EB6020EBC0E0EA018048C7FC1206120E12
0C121C13F8EA3904EA3A06EA3C031278A2007013801400EA600712E0A21306130E130CEA
601C1318EA2030EA30C0EA0F80131D7C9B15>I<131FEB60C0EBC060EA018038030030A2
00061360120714C013803803C10013E6EA01FCEA0078EA01BCEA061E487E487E38300380
1220EA6001A238C00300A21306EA60045BEA3830EA0FC0141D7D9B15>56
D<133E13E138018180380300C01206120E120C121CA213011238A31303001813801307EA
080B380C3300EA03C7EA0007130E130C131C1318EAE0305BEA80C0EAC180003EC7FC121D
7C9B15>I<1206120FA212061200AA1230127812F0126008127C910D>I<1418A21438A214
78A214B8EB0138A2EB023C141C1304130C13081310A21320A2EB7FFCEBC01C1380EA0100
141E0002130EA25A120C001C131EB4EBFFC01A1D7E9C1F>65 D<48B5FC39003C03809038
3801C0EC00E0A35B1401A2EC03C001E01380EC0F00141EEBFFFC3801C00E801580A2EA03
80A43907000F00140E141E5C000E13F0B512C01B1C7E9B1D>I<903803F02090381E0C60
90383002E09038E003C03801C001EA038048C7FC000E1480121E121C123C15005AA35AA4
1404A35C12705C6C5B00185B6C485AD80706C7FCEA01F81B1E7A9C1E>I<48B512F03800
3C00013813301520A35BA214081500495AA21430EBFFF03801C020A439038040801400A2
EC0100EA07005C14021406000E133CB512FC1C1C7E9B1C>69 D<48B512F038003C000138
13301520A35BA214081500495AA21430EBFFF03801C020A448485A91C7FCA348C8FCA45A
EAFFF01C1C7E9B1B>I<903803F02090381E0C6090383002E09038E003C03801C001EA03
8048C7FC000E1480121E121C123C15005AA35AA2903801FF809038001E00141CA400705B
A27E001813786C139038070710D801F8C7FC1B1E7A9C20>I<3A01FFC3FF803A003C0078
0001381370A4495BA449485AA390B5FC3901C00380A4484848C7FCA43807000EA448131E
39FFE1FFC0211C7E9B1F>I<EA03FFEA00781370A413E0A4EA01C0A4EA0380A4EA0700A4
120EA4121EEAFFC0101C7D9B10>I<EB3FF8EB03C01480A4EB0700A4130EA45BA45BA4EA
607012E0EAC060EA80E0EA81C0EA4380003EC7FC151D7C9B16>I<3801FFC038003C0013
38A45BA45BA4485AA438038002A31404EA0700140C14181438000E13F0B5FC171C7E9B1A
>76 D<D801FEEB01FED8003E14E0012EEB03C01505A21509014EEB0B8015131523134701
87EB4700A21587EC0107D80107130E14021404A20002495AEB0388149014A000045C14C0
A2000C1380001CEB007839FF8307FF271C7E9B25>I<D801FCEBFF80D8001CEB1C00012E
13181510A2132701475B13431480A2903881C040A3EB80E0D801005B1470A300020139C7
FCA3141D48131E140EA2120C001C1304EAFF80211C7E9B1F>I<EB07F0EB1C1CEB700E49
7E3901C00380EA0380EA0700000E14C0121E121C123CA25AA348EB0780A3EC0F00A2140E
141E5C007013385C00785B383801C06C485AD80E0EC7FCEA03F81A1E7A9C20>I<3801FF
FE39003C038090383801C0EC00E0A3EB7001A315C0EBE0031580EC0700141C3801FFF001
C0C7FCA3485AA448C8FCA45AEAFFE01B1C7E9B1C>I<3801FFFE39003C078090383801C0
15E01400A2EB7001A3EC03C001E01380EC0700141CEBFFE03801C03080141CA2EA0380A4
3807003C1520A348144039FFE01E80C7EA0F001B1D7E9B1E>82 D<EB0F84EB304CEB403C
EB8018EA01005AA200061310A214001207A2EA03E013FC6CB4FC38007F80EB07C01301A2
1300A21220A238600180A2EB03001302EAF004EACC18EA83E0161E7D9C17>I<001FB512
C0381C070138300E0000201480126012405B1280A2000014005BA45BA45BA4485AA41203
EA7FFE1A1C799B1E>I<EA0408EA0810EA1020EA2040A2EA4080A2EA8100EAE1C0EAF1E0
A2EAE1C00D0C749C15>92 D<EA01E3EA0717EA0C0F1218EA380E12301270A2EAE01CA413
39A3EA6079EA319AEA1E0C10127C9115>97 D<123F1207A2120EA45AA4EA39E0EA3A18EA
3C0C12381270130EA3EAE01CA31318133813301360EA60C0EA3180EA1E000F1D7C9C13>
I<13F8EA0304120EEA1C0EEA181CEA30001270A25AA51304EA60081310EA3060EA0F800F
127C9113>I<EB07E01300A2EB01C0A4EB0380A43801E700EA0717EA0C0F1218EA380E12
301270A2485AA41339A3EA6079EA319AEA1E0C131D7C9C15>I<13F8EA0704120CEA1802
EA38041230EA7008EA7FF0EAE000A5EA60041308EA30101360EA0F800F127C9113>I<EB
03C0EB0670130CEB1C601400A25BA53803FF8038007000A55BA5485AA5485AA390C7FCA2
5A12C612E65A12781425819C0D>I<EB78C0EA01C5EA03031206000E1380120C121CA238
380700A4130EA3EA181EEA0C7CEA079CEA001CA25BA2EAC030EAE070EAC1C0007FC7FC12
1A7E9113>I<EA0FC01201A2485AA448C7FCA4EA0E3E13C3380F0380120E121E121CA338
380700A3130E00701340A2131C1480EAE00C38600700121D7E9C15>I<EA01801203EA01
00C7FCA7121C12261247A2128EA2120E5AA35AA21271A31272A2123C091C7C9B0D>I<EA
0FC01201A2485AA448C7FCA4380E07801308EB11C01321381C4180EB8000001DC7FC121E
EA3FC0EA38E01370A2EA7071A31372EAE032EA601C121D7E9C13>107
D<EA1F801203A2EA0700A4120EA45AA45AA45AA412E2A312E412641238091D7D9C0B>I<
391C1E078039266318C0394683A0E0384703C0008E1380A2120EA2391C0701C0A3EC0380
D8380E1388A2EC0708151039701C032039300C01C01D127C9122>I<EA383EEA4CC3384D
0380124E129E129C121CA238380700A3130E00701340A2131C1480EAE00C386007001212
7C9117>I<13F8EA030CEA0E06487E1218123000701380A238E00700A3130EA25BEA6018
5BEA30E0EA0F8011127C9115>I<380387803804C860EBD03013E0EA09C014381201A238
038070A31460380700E014C0EB0180EB8300EA0E86137890C7FCA25AA45AB4FC151A8091
15>I<EA1C3CEA2642EA4687EA4707EA8E061300120EA25AA45AA45A123010127C9112>
114 D<EA01F0EA0608120C131CEA1818EA1C00121F13C0EA0FF01207EA00781338EA6030
12E012C0EA8060EA60C0EA1F000E127D9111>I<12035AA3120EA4EAFFE0EA1C00A35AA4
5AA4EAE080A2EAE100A2126612380B1A7C990E>I<381C0180EA2E03124EA2388E0700A2
121CA2EA380EA438301C80A3EA383C38184D00EA0F8611127C9116>I<EA1C06EA2E0EEA
4E06A2EA8E02A2121CA2EA3804A313081230A21310EA3820EA1840EA0F800F127C9113>
I<381E0183382703871247148338870701A2120EA2381C0E02A31404EA180C131C1408EA
1C1E380C26303807C3C018127C911C>I<38038780380CC840380870E012103820E0C014
001200A2485AA4EA03811263EAE38212C5EA8584EA787813127E9113>I<381C0180EA2E
03124EA2388E0700A2121CA2EA380EA4EA301CA3EA383CEA1878EA0FB8EA003813301370
EAE0605BEA81800043C7FC123C111A7C9114>I<EA01C1EA07E1EA0FF6EA081CEA1008EA
0010132013401380EA010012025AEA08041210EA2C0CEA73F8EA41F0EA80E010127E9111
>I E /Fx 93 128 df<B512F0EA0F0014301410A214181408A31400B17FEAFFF8151C7E
9B1A>0 D<1303A2497EA2497E130BEB13E01311EB21F01320497E1478EB807C143C3801
003E141E0002131F8048148014074814C0140348EB01E0003014F000201300006014F800
7FB5FCB612FCA21E1D7E9C23>I<EB3F80EBE0E03803803848487E000E7F487F003C1480
00381303007814C0A20070130100F014E000F11311EBFFF1A3EB001100F01301A2007014
C000781303A200381480003C1307001C14006C130E6C5B6C6C5A3800E0E0EB3F801B1E7E
9C20>I<B6FC3878001F007C13076C7F001E7F001F1480380F800012077F6C6C13001201
7F6C7E1378A2133013205B49138048C7FC120214015A48EB0300485B48131F007FB5FCB6
FC191C7E9B1E>6 D<EB7E1F3901C1B180390303E3C0000713C3000EEBC180903801C000
A6B512FC380E01C0B0387F87FC1A1D809C18>11 D<137E3801C180EA0301380703C0120E
EB018090C7FCA5B512C0EA0E01B0387F87F8151D809C17>I<EB7FC0EA01C1EA03031207
EA0E01A7B5FCEA0E01B0387FCFF8151D809C17>I<90383F07E03901C09C18380380F0D8
0701133C000E13E00100131892C7FCA5B612FC390E00E01CB03A7FC7FCFF80211D809C23
>I<1480EB01005B1302EA03F4EA0E1CEA180EEA300B38701380EA603138E021C01341A2
1381A2EAE10100631380EA720300341300EA1C06EA0E1CEA0BF00010C7FC123012205A12
1A7F9515>28 D<013FB5FC903805F00F01041303010C7F1308168001101300A30120EB10
00A213601340153090B512F0903880F0301510EA01001640A20002EC0080A25AA2150100
0CEC0300001E140FD8FF87B5FC221C7F9B25>I<126012F0A71260AD1200A5126012F0A2
1260041E7C9D0C>33 D<EA6060EAF0F0EAF8F8EA6868EA0808A3EA1010A2EA2020EA4040
EA80800D0C7F9C15>I<9038030180A39038060300A5EB0C06A4495A007FB512F8B612FC
3900301800A4495AA4B612FC6C14F83900C0600048485AA438030180A4D80603C7FCA31E
257E9C23>I<000F14C0EA188039306003803970380700386027FB38E010065CA25CA25C
5CEA602000705B38304180EA1881390F0303C03900060620EC0C1090380C1C08EB1818EC
380413301360A213C0A2EA01803903001808141C0006EB0C1048EB06200004EB03C01E21
7E9E23>37 D<13E0EA0310EA0608A2120EA45BA25B6C5AEC3FE09038800F80EC06000003
130412073809C00800115BEA30E03820F020EA607038E03840EB3C80131C90380F00207F
0070EB8040383009C0391830E180390FC03F001B1F7E9D20>I<126012F012F812681208
A31210A2122012401280050C7C9C0C>I<1380EA0100120212065AA25AA25AA35AA412E0
AC1260A47EA37EA27EA27E12027EEA0080092A7C9E10>I<7E12407E12307EA27EA27EA3
7EA41380AC1300A41206A35AA25AA25A12205A5A092A7E9E10>I<1306ADB612E0A2D800
06C7FCAD1B1C7E9720>43 D<126012F0A212701210A41220A212401280040C7C830C>I<
EAFFE0A20B0280890E>I<126012F0A2126004047C830C>I<130113031306A3130CA31318
A31330A31360A213C0A3EA0180A3EA0300A31206A25AA35AA35AA35AA35AA210297E9E15
>I<EA03C0EA0C30EA1818EA300CA2EA700EEA6006A2EAE007ADEA6006A2EA700EEA300C
A2EA1818EA0C30EA07E0101D7E9B15>I<5A1207123F12C71207B3A5EAFFF80D1C7C9B15>
I<EA07C0EA1830EA201CEA400C130EEAF00F12F81307A21270EA000F130EA2131CA21338
1370136013C0EA0180EA0300EA0601120C1218EA1002EA3FFE127F12FF101C7E9B15>I<
EA07E0EA1830EA201CA2EA781E130E131E1238EA001CA2131813301360EA07C0EA003013
1CA2130E130FA2127012F8A3EAF00EEA401C1220EA1830EA07C0101D7E9B15>I<130CA2
131C133CA2135C13DC139CEA011C120312021204120C1208121012301220124012C0B512
C038001C00A73801FFC0121C7F9B15>I<EA300CEA3FF813F013C0EA2000A6EA23E0EA2C
30EA3018131CEA200E1200130FA3126012F0A3EA800EEA401E131CEA2038EA1870EA07C0
101D7E9B15>I<13F0EA030CEA0404EA0C0EEA181E1230130CEA7000A21260EAE3E0EAE4
30EAE818EAF00C130EEAE0061307A51260A2EA7006EA300E130CEA1818EA0C30EA03E010
1D7E9B15>I<1240387FFF801400A2EA4002485AA25B485AA25B1360134013C0A212015B
A21203A41207A66CC7FC111D7E9B15>I<EA03E0EA0C30EA1008EA200C13061260A21270
A2EA7C0CEA3E18EA3FB0EA1FE0EA07F013F8EA18FCEA307EEA601E130FEAC0071303A4EA
60021304EA300CEA1C10EA07E0101D7E9B15>I<EA03C0EA0C30EA1818EA300C1270EA60
0EEAE006A21307A51260EA700F1230EA1817EA0C27EA07C7EA0006A2130EEA300C127813
181270EA2030EA10C0EA0F80101D7E9B15>I<126012F0A212601200AA126012F0A21260
04127C910C>I<126012F0A212601200AA126012F0A212701210A41220A212401280041A
7C910C>I<007FB512C0B612E0C9FCA8B612E06C14C01B0C7E8F20>61
D<EA0FE0EA3038EA401CEAE00E12F0A3EA000C131C1330136013C0138012011300A6C7FC
A51203EA0780A2EA03000F1D7E9C14>63 D<1306A3130FA3EB1780A2EB37C01323A2EB43
E01341A2EB80F0A338010078A2EBFFF83802003CA3487FA2000C131F80001E5BB4EBFFF0
1C1D7F9C1F>65 D<B512C0380F00788080140E140FA4140E141E5C14F8EBFFF0EB003C80
80801580A5EC0F00A2141E1478B512E0191C7F9B1D>I<90381F8080EBE0613801801938
070007000E13035A14015A00781300A2127000F01400A8007014801278A212386CEB0100
A26C13026C5B380180083800E030EB1FC0191E7E9C1E>I<B512C0380F00F0143C140E80
A2EC038015C01401A215E0A815C0A21403158014071500140E5C1470B512C01B1C7E9B20
>I<B512FC380F003C140C1404A214061402A213011400A35B13FF13037FA31401130014
02A31406A2140C143CB512FC181C7E9B1C>I<B512F8380F007814181408A2140C1404A2
13011400A35B13FF13037FA490C7FCA8EAFFF8161C7E9B1B>I<90381F8080EBE0613801
801938070007000E13035A14015A00781300A2127000F01400A6ECFFF0EC0F8000701307
1278A212387EA27E6C130B380180113800E06090381F80001C1E7E9C21>I<39FFF0FFF0
390F000F00AC90B5FCEB000FAD39FFF0FFF01C1C7F9B1F>I<EAFFF0EA0F00B3A8EAFFF0
0C1C7F9B0F>I<3807FF8038007C00133CB3127012F8A21338EA7078EA4070EA30E0EA0F
80111D7F9B15>I<39FFF01FE0390F000780EC060014045C5C5C5C5C49C7FC1302130613
0FEB17801327EB43C0EB81E013016D7E1478A280143E141E80158015C039FFF03FF01C1C
7F9B20>I<EAFFF8EA0F8090C7FCB01408A31418A2141014301470EB01F0B5FC151C7E9B
1A>I<B46CEBFF80000FECF800A2390BC00178A33809E002A23808F004A3EB7808A3EB3C
10A3EB1E20A3EB0F40A2EB0780A3EB0300121C3AFF8307FF80211C7E9B26>I<B4EB1FF0
390F8003809038C00100120BEA09E0EA08F0A21378133C133E131E130F14811307EB03C1
EB01E114F113001479147D143D141FA2808080121CB46C7E1C1C7F9B1F>I<EB3F80EBE0
E03803803848487E000E7F487F003C148000381303007814C0A20070130100F014E0A800
7014C000781303A200381480003C1307001C14006C130E6C5B6C6C5A3800E0E0EB3F801B
1E7E9C20>I<B51280380F00E01478143C141C141EA5141C143C147814E0EBFF8090C7FC
ACEAFFF0171C7E9B1C>I<B5FC380F01E0EB007880141C141EA4141C143C5CEB01E001FF
C7FCEB01E0EB0070147880A61510A2141CA239FFF00E20C7EA03C01C1D7E9B1F>82
D<3807E080EA1C19EA30051303EA600112E01300A36C13007E127CEA7FC0EA3FF8EA1FFE
EA07FFC61380130FEB07C0130313011280A300C01380A238E00300EAD002EACC0CEA83F8
121E7E9C17>I<007FB512C038700F010060130000401440A200C014201280A300001400
B1497E3803FFFC1B1C7F9B1E>I<39FFF01FF0390F000380EC0100B3A26C130213800003
5BEA01C03800E018EB7060EB0F801C1D7F9B1F>I<39FFE00FF0391F0003C0EC01806C14
00A238078002A213C000035BA2EBE00C00011308A26C6C5AA213F8EB7820A26D5AA36D5A
A2131F6DC7FCA21306A31C1D7F9B1F>I<3AFFE1FFC0FF3A1F003E003C001E013C13186C
6D1310A32607801F1320A33A03C0278040A33A01E043C080A33A00F081E100A39038F900
F3017913F2A2017E137E013E137CA2013C133C011C1338A20118131801081310281D7F9B
2B>I<39FFF07FC0390FC01E003807800CEBC00800035B6C6C5A13F000005BEB7880137C
013DC7FC133E7F7F80A2EB13C0EB23E01321EB40F0497E14783801007C00027F141E0006
131F001F148039FF807FF01C1C7F9B1F>I<39FFF003FC390F8001E00007EB00C06D1380
0003EB01006D5A000113026C6C5A13F8EB7808EB7C18EB3C10EB3E20131F6D5A14C06D5A
ABEB7FF81E1C809B1F>I<387FFFF0EA7C01007013E0386003C0A238400780130F140013
1E12005B137C13785BA2485A1203EBC010EA0780A2EA0F00481330001E13205A14604813
E0EAF803B5FC141C7E9B19>I<12FEA212C0B3B312FEA207297C9E0C>I<EA0808EA1010EA
2020EA4040A2EA8080A3EAB0B0EAF8F8EA7878EA30300D0C7A9C15>I<12FEA21206B3B3
12FEA20729809E0C>I<EA1FC0EA3070EA78387F12301200A2EA01FCEA0F1C1238127012
6000E01340A3EA603C38304E80381F870012127E9115>97 D<12FC121CAA137CEA1D8738
1E0180381C00C014E014601470A6146014E014C0381E018038190700EA10FC141D7F9C17
>I<EA03F8EA0C0CEA181E1230EA700CEA600012E0A61260EA70021230EA1804EA0C18EA
03E00F127F9112>I<EB1F801303AAEA03F3EA0E0BEA1807EA30031270126012E0A61260
12701230EA1807EA0E1B3803E3F0141D7F9C17>I<EA07E0EA0C30EA1818EA300CEA700E
EA600612E0EAFFFEEAE000A41260EA70021230EA1804EA0C18EA03E00F127F9112>I<13
F8EA018CEA071E1206EA0E0C1300A6EAFFE0EA0E00B0EA7FE00F1D809C0D>I<EB038038
07C4C0EA1C783838388038301800EA701CA4EA3018EA38386C5AEA27C00020C7FCA21230
EA3FF86CB4FC1480EA2003386001C0EAC000A33860018038300300EA1C0EEA07F8121C7F
9215>I<12FC121CAA137C1387EA1D03001E1380121CAD38FF9FF0141D7F9C17>I<121812
3CA21218C7FCA712FC121CB0EAFF80091D7F9C0C>I<13C0EA01E0A2EA00C01300A7EA07
E01200B3A21260EAF0C012F1EA6180EA3E000B25839C0D>I<12FC121CAAEB0FE0EB0780
EB06005B13105B5B13E0121DEA1E70EA1C781338133C131C7F130F148038FF9FE0131D7F
9C16>I<12FC121CB3A9EAFF80091D7F9C0C>I<39FC7E07E0391C838838391D019018001E
EBE01C001C13C0AD3AFF8FF8FF8021127F9124>I<EAFC7CEA1C87EA1D03001E1380121C
AD38FF9FF014127F9117>I<EA03F0EA0E1CEA1806487E00701380EA600100E013C0A600
601380EA700300301300EA1806EA0E1CEA03F012127F9115>I<EAFC7CEA1D87381E0180
001C13C0EB00E0A21470A614E0A2EB01C0001E1380381D0700EA1CFC90C7FCA7B47E141A
7F9117>I<3803E080EA0E19EA1805EA3807EA7003A212E0A61270A2EA38071218EA0E1B
EA03E3EA0003A7EB1FF0141A7F9116>I<EAFCE0EA1D38EA1E78A2EA1C301300ACEAFFC0
0D127F9110>I<EA1F90EA2070EA4030EAC010A212E0EAF800EA7F80EA3FE0EA0FF0EA00
F8EA8038131812C0A2EAE010EAD060EA8FC00D127F9110>I<1204A4120CA2121C123CEA
FFE0EA1C00A91310A5120CEA0E20EA03C00C1A7F9910>I<38FC1F80EA1C03AD1307120C
EA0E1B3803E3F014127F9117>I<38FF07E0383C0380381C0100A2EA0E02A2EA0F06EA07
04A2EA0388A213C8EA01D0A2EA00E0A3134013127F9116>I<39FF3FC7E0393C0703C000
1CEB01801500130B000E1382A21311000713C4A213203803A0E8A2EBC06800011370A2EB
8030000013201B127F911E>I<38FF0FE0381E0700EA1C06EA0E046C5AEA039013B0EA01
E012007F12011338EA021C1204EA0C0E487E003C138038FE1FF014127F9116>I<38FF07
E0383C0380381C0100A2EA0E02A2EA0F06EA0704A2EA0388A213C8EA01D0A2EA00E0A313
40A25BA212F000F1C7FC12F312661238131A7F9116>I<EA7FFCEA70381260EA407013F0
13E0EA41C012031380EA0700EA0F04120E121CEA3C0CEA380812701338EAFFF80E127F91
12>I<B512F01401808B15>I<EA6060EAF0F0A2EA60600C047C9C15>127
D E /Fy 56 123 df<1238127C12FE12FFA2127F123B1203A21206A2120E120C12181230
122008107C9F0F>39 D<EAFFF0A40C047F8B11>45 D<1238127C12FEA3127C123807077C
860F>I<EA01FCEA07FF381F07C0EA1E03003E13E0387C01F0A300FC13F8AD007C13F0A3
383E03E0001E13C0EA1F8F3807FF00EA01FC151D7E9C1A>48 D<137013F0120712FF12F9
1201B3A4387FFFC0A2121D7D9C1A>I<EA03FC381FFF8038381FC0387C07E038FE03F0A2
14F81301127C1238EA000314F0A2EB07E0EB0FC01400131E5B13705B3801C018EA0380EA
0600481338381FFFF05A5AB5FCA2151D7E9C1A>I<EA03FC380FFF80381C0FC0383C07E0
387E03F0A31307003C13E01200EB0FC0EB3F803803FE005B38000F80EB07C0EB03E014F0
14F81238127C12FEA214F012FC387807E0383C0FC0381FFF803803FC00151D7E9C1A>I<
EB01C013031307A2130F131F133B1373136313C3EA01831203EA0703120E120C12181238
127012E0B512FEA2380007C0A6EBFFFEA2171D7F9C1A>I<001C13E0EA1FFF14C0148014
0013FC13C00018C7FCA4EA19FE381FFF80381E07C0381803E0381001F0120014F8A21278
12FCA314F0EA7803007013E0383C0FC0380FFF00EA03FC151D7E9C1A>I<133F3801FFC0
3807C0E0EA0F81381F03F0121E123E127CEB01E090C7FCEAFC1013FF00FD13C0EB03E038
FE01F0A200FC13F8A4127CA3003C13F0123E381E03E0380F07C03807FF803801FE00151D
7E9C1A>I<1260387FFFF8A214F014E014C038E0018038C00300A21306C65A5B13381330
137013F0A2485AA21203A41207A56C5A6C5A151E7D9D1A>I<EA01FE380FFF80381E07C0
383801E0EB00F01278A2127C127FEBC1E0383FE3C0381FFF80380FFE003807FF8014C000
1F13E0383C3FF0EA780FEB03F8EAF00113001478A214701278007C13E0383E03C0380FFF
803803FC00151D7E9C1A>I<EA01FCEA0FFF381F0780383E03C0007C13E0130100FC13F0
A314F8A4EA7C03A2EA3E05EA1FFDEA07F9EA0041EB01F0123C127EEB03E0A214C0383C07
8038381F00EA1FFCEA07F0151D7E9C1A>I<1238127C12FEA3127C12381200A61238127C
12FEA3127C123807147C930F>I<EA07F8EA1FFE38381F80EA780F00FC13C0A312783830
1F8000001300133E5B13705BA25BA690C7FCA4EA01C0487E487EA36C5A6C5A12207D9F19
>63 D<14E0A2497EA3497EA2EB06FCA2EB0EFEEB0C7EA2497EA201307F141F01707FEB60
0FA2496C7E90B5FC4880EB8003000380EB0001A200066D7EA2000E803AFFE00FFFE0A223
1F7E9E28>65 D<B512FEECFFC03907C007E0EC03F0EC01F815FCA515F8140315F0EC0FE0
90B5128015C09038C003F0EC01F815FC140015FEA515FC1401EC03F8EC07F0B612E01500
1F1F7E9E25>I<903807FC0290383FFF0E9038FE03DE3903F000FE4848133E4848131E48
5A48C7120EA2481406127EA200FE1400A7127E1506127F7E150C6C7E6C6C13186C6C1338
6C6C13703900FE01C090383FFF80903807FC001F1F7D9E26>I<B512FEECFFC03907E007
F0EC01F86E7E157E81A2ED1F80A316C0A91680A3ED3F00A2157E5D4A5AEC07F0B612C04A
C7FC221F7E9E28>I<B612E0A23807E00714011400156015701530A21430A21500147014
F013FFA213E014701430150CA214001518A31538157815F8EC03F0B6FCA21E1F7E9E22>
I<B612E0A23807E00714011400156015701530A21430A21500147014F013FFA213E01470
1430A391C7FCA8B57EA21C1F7E9E21>I<B5380FFFF0A23A07E0007E00AC90B512FEA290
38E0007EADB5380FFFF0A2241F7E9E29>72 D<B5FCA2EA07E0B3A9B5FCA2101F7E9E14>
I<B57EA2D807E0C7FCB115C0A31401A3EC0380A2140F141FB6FCA21A1F7E9E1F>76
D<D8FFE0EC3FF86D147F00071600D806F814DFA3017CEB019FA26DEB031FA26D1306A290
380F800CA2903807C018A3903803E030A2903801F060A2903800F8C0A2EC7D80A2EC3F00
A3141ED8FFF0903803FFF8140C2D1F7E9E32>I<D8FFE0EBFFF07F0007EC06007FEA06FC
137E7F1480131FEB0FC0EB07E0EB03F0EB01F814FC1300147E143FEC1F8615C6EC0FE614
07EC03F6EC01FE1400A2157E153E151E150ED8FFF01306A2241F7E9E29>I<EB1FF890B5
FC3901F81F803907E007E0390FC003F0391F8001F890C7FC4814FC4814FE007E147EA200
FE147FA9007E147E007F14FEA26C14FCEB8001001F14F8390FC003F03907E007E03901F8
1F806CB51200EB1FF8201F7D9E27>I<B512FEECFF803907E00FE0EC03F0EC01F8A215FC
A515F8A2EC03F0EC0FE090B51280ECFE0001E0C7FCACB5FCA21E1F7E9E24>I<B512FCEC
FF803907E00FE0EC03F081140181A45D14035DEC0FE090B5128002FCC7FCEBE03FEC0F80
81140781A381A31630EC03F802011360B53800FFC0ED3F80241F7E9E27>82
D<3803FC08380FFF38381E03F8EA3800481378143812F01418A26C13007EEA7FC013FE38
3FFF806C13C06C13E06C13F0C613F81307EB00FC147C143C12C0A36C1338147800F81370
38FE01E038EFFFC000811300161F7D9E1D>I<007FB512FCA2397C07E07C0070141C0060
140CA200E0140E00C01406A400001400B10003B512C0A21F1E7E9D24>I<3CFFFC0FFFC0
FFE0A23C0FC000FC000E007F00076E130CA26D151C0003D901BF1318A2D801F85D913803
1F80A22600FC076D5AEC060F01FE15E0903A7E0C07E0C0A2013FECE18091381803F1A2D9
1FB801FBC7FCECB00102F013FF6D486C5AA201075C4A137CA2010314784A133801011430
331F7F9E36>87 D<EA07FC381FFF80383F07C0EB03E0EB01F0A2120C1200133FEA07FDEA
1F81EA3E01127C12F8A3EAFC02EA7E0C383FF87E380FE03E17147F9319>97
D<B4FCA2121FAAEB1FC0EB7FF0EBE0F8EB807CEB007E143EA2143FA6143EA2147C138038
1EC1F8381C7FE038181F8018207E9F1D>I<EA01FE3807FF80381F0FC0123EA2127CEB03
0000FCC7FCA6127C127E003E1360003F13C0EA1F813807FF00EA01FC13147E9317>I<EB
07F8A21300AAEA01F8EA07FEEA1F83EA3E01EA7E00127CA212FCA6127CA2127EEA3E01EA
1F07380FFEFFEA03F818207E9F1D>I<EA01FE3807FF80380F83C0381E01E0383E00F05A
14F812FCB5FCA200FCC7FCA3127CA26C1318121E380F80703807FFE0C6138015147F9318
>I<EB3F80EBFFC03803E3E0EA07C71387120FEB83C0EB8000A5EAFFFCA2EA0F80B0EA7F
F8A213207F9F10>I<3803FC3C380FFFFE381E079E383C03DE007C13E0A5003C13C0381E
0780381FFF00EA13FC0030C7FCA21238383FFF806C13F06C13F84813FC3878007C007013
3E00F0131EA30078133CA2383F01F8380FFFE000011300171E7F931A>I<B4FCA2121FAA
EB0FC0EB3FE0EB61F0EBC0F813801300AD38FFE7FFA218207D9F1D>I<121C123E127FA3
123E121CC7FCA6B4FCA2121FB0EAFFE0A20B217EA00E>I<B4FCA2121FAAEB01FEA2EB00
F014C0EB0380EB0700130C5B137C13FC139E130F001E1380EB07C01303EB01E014F0EB00
F838FFC3FFA218207E9F1C>107 D<B4FCA2121FB3AAEAFFE0A20B207E9F0E>I<3AFE0FE0
3F8090391FF07FC03A1E70F9C3E09039407D01F0EB807E121FEB007CAC3AFFE3FF8FFEA2
27147D932C>I<38FE0FC0EB3FE0381E61F0EBC0F81380EA1F00AD38FFE7FFA218147D93
1D>I<48B4FC000713C0381F83F0383E00F8A248137CA200FC137EA6007C137CA26C13F8
A2381F83F03807FFC00001130017147F931A>I<38FF1FC0EB7FF0381FE1F8EB80FCEB00
7EA2143E143FA6143E147E147CEB80FCEBC1F8EB7FE0EB1F8090C7FCA7EAFFE0A2181D7E
931D>I<EAFE3EEB7F80381ECFC0138FA2121FEB030090C7FCABEAFFF0A212147E9316>
114 D<EA0FE6EA3FFEEA701EEA600EEAE006A2EAF800EAFFC0EA7FF8EA3FFCEA1FFE1203
EA001FEAC007A212E0EAF006EAF81EEAFFFCEAC7F010147E9315>I<1203A45AA25AA212
3FEAFFFCA2EA1F00AA1306A5EA0F8CEA07F8EA03F00F1D7F9C14>I<38FF07F8A2EA1F00
AD1301A2EA0F063807FCFF6C5A18147D931D>I<39FFE07F80A2391F001C00380F8018A2
6C6C5AA26C6C5AA2EBF0E000015B13F900005B13FF6DC7FCA2133EA2131CA219147F931C
>I<3AFFC7FE1FE0A23A1F00F0030014F8D80F801306A29038C1BC0E0007140CEBC3BE39
03E31E18A29038F60F380001143001FE13B03900FC07E0A2EBF80301785BA29038300180
23147F9326>I<38FFC0FFA2380F80703807C0606D5A3803E180EA01F36CB4C7FC137E13
3E133F497E136FEBC7C0380183E0380381F048C67E000E7F39FF81FF80A219147F931C>
I<39FFE07F80A2391F001C00380F8018A26C6C5AA26C6C5AA2EBF0E000015B13F900005B
13FF6DC7FCA2133EA2131CA21318A2EA783012FC5BEAC0E0EAE1C0EA7F80001EC8FC191D
7F931C>I<383FFFE0A2383C07C038380F80EA701F38603F00133E5BC65A1201485AEBE0
60EA07C0EA0F80001F13E0383F00C0EA3E01EA7C03B5FCA213147F9317>I
E /Fz 19 107 df<B512F0A214027D881B>0 D<1202A3EAC218EAF278EA3AE0EA0F80A2
EA3AE0EAF278EAC218EA0200A30D0E7E8E12>3 D<EA0F80EA1FC0EA3060EA6030A2EAC0
18A4EA6030A2EA3060EA1FC0EA0F800D0E7E8E12>14 D<EA0F80EA1FC0EA3FE0EA7FF0A2
EAFFF8A4EA7FF0A2EA3FE0EA1FC0EA0F800D0E7E8E12>I<B512FC7EC8FCA6B512FCA2C8
FCA6387FFFFCB5FC16127E901B>17 D<143014F0EB01C0EB0700131E1378EA01E0EA0380
000EC7FC123C12F0A21238120E6C7EEA01E0EA0078131C1307EB03C0EB00F014301400A6
387FFFE0B512F0141E7D951B>20 D<1406A380A2EC0180EC00C01560B612FCA2C8126015
C0EC0180EC0300A21406A31E127E9023>33 D<13801201A2EA03C0A2EA07E0EA0DB0EA79
9EEAF18FEA8181EA0180B3101D7F9612>I<3801FF801207000EC7FC12185A5AA35AA2B5
1280A200C0C7FCA21260A37E7E120E3807FF80120111167D9218>50
D<1303A21306A2130CA21318A21330A21360A213C0A2EA0180A2EA0300A21206A25AA25A
A25AA25AA25A1240101E7B9600>54 D<12C0AC020C7E8D00>I<01041408010E1418011E
1438167016F0011F130115030117147001271306EC800CED1C6001431338ED70E0ECC0E0
903883C1C0903881E3800001EBE700EB00EE4813FC00025B00C6137000FC012013F891C7
12F00038150025187F962A>77 D<134013E0A2EA01B0A2EA0318A2EA060CA2487EA2487E
A238300180A2386000C0A2481360142013137E9218>94 D<124012C0A9B5FC148000C0C7
FCAA124011177E9616>96 D<137813C0EA0180EA0300AB12065A12F0120C7E7EABEA0180
EA00C013780D217E9812>102 D<12F0120C7E7EABEA0180EA00C0137813C0EA0180EA03
00AB12065A12F00D217E9812>I<120112031206A3120CA31218A21230A31260A312C0A2
1260A31230A31218A2120CA31206A31203120108227D980E>I<12C0A21260A31230A312
18A2120CA31206A31203A21206A3120CA31218A21230A31260A312C0A208227E980E>I<
12C0B3AF02217C980A>I E /FA 18 120 df<121C123E127E127F123F121F1207120E12
1E127C12F81260080C788518>44 D<1230127812FCA2127812300606778518>46
D<137CEA01FEEA07FF380F8780381E03C0EA3C1DEA387F3870FFE0EA71E313C112E1EAE3
80A638E1C1C0127113E33870FF8038387F00EA3C1C381E00E0EA0F833807FFC000011380
38007E00131C7E9B18>64 D<EA0FF0EA1FFC487EEA3C0FEA180738000380A213FF120712
1FEA7F03127812E0A3EAF007EA780F383FFFF8EA1FFDEA07F015147E9318>97
D<EA01FEEA07FF001F1380EA3E073838030048C7FCA25AA61270EB01C01238EA3E03381F
FF8000071300EA01FC12147D9318>99 D<EB1F80133F131F1303A5EA03E3EA0FFBEA1FFF
EA3C1FEA380FEA7007130312E0A6EA7007A2EA380FEA3C1F381FFFF0380FFBF83803E3F0
151C7E9B18>I<EA01F0EA07FCEA1FFEEA3E0F38380780EA7003A238E001C0A2B5FCA300
E0C7FC1270EB01C01238EA3E07381FFF8000071300EA01F812147D9318>I<3801E1F038
07FFF85A381E1E30381C0E00487EA5EA1C0EEA1E1EEA1FFC5BEA39E00038C7FC7EEA1FFE
EBFFC04813E0387801F038700070481338A4007813F0EA7E03381FFFC06C13803801FC00
151F7F9318>103 D<127E12FE127E120EA5133EEBFF80000F13C013C1EB80E01300120E
AB387FC7FC38FFE7FE387FC7FC171C809B18>I<EA0380EA07C0A3EA0380C7FCA4EA7FC0
12FF127F1201AEB5FCA3101D7C9C18>I<EAFFC0A31201B3A4B51280A3111C7D9B18>108
D<38F9C1C038FFF7F013FF383E3E38EA3C3CA2EA3838AB38FE3E3EEB7E7EEB3E3E171480
9318>I<EA01F0EA0FFE487E383E0F80EA3803387001C0A238E000E0A5EAF001007013C0
EA7803383C0780EA3E0F381FFF006C5AEA01F013147E9318>111
D<38FF0FC0EB3FE0EB7FF0EA07F0EBE060EBC0005BA290C7FCA9EAFFFC7F5B14147E9318
>114 D<EA07F7EA3FFF5AEA780FEAE007A3007CC7FCEA7FE0EA1FFCEA03FEEA001F3860
0780EAE003A212F038F80F00B5FC13FCEAE7F011147D9318>I<487E1203A4387FFFC0B5
FCA238038000A9144014E0A33801C1C013FF6C1380EB3E0013197F9818>I<387E07E0EA
FE0FEA7E07EA0E00AC1301EA0F033807FFFC6C13FE3801FCFC1714809318>I<38FF07F8
138F1307383800E0A4381C01C0137113F9A213D9EA1DDD000D1380A3138DEA0F8FA23807
070015147F9318>119 D E /FB 2 104 df<130F1338136013E0EA01C0AFEA0380EA0700
121E12F8121E1207EA0380EA01C0AFEA00E013601338130F102D7DA117>102
D<12F8121E1207EA0380EA01C0AFEA00E013601338130F1338136013E0EA01C0AFEA0380
EA0700121E12F8102D7DA117>I E /FC 24 122 df<137813841201EA03021207A45BA2
5BA2EA03909038A00FFC9038C001E0EC00C000011480EC0100EA02E000041302EA087038
18780438303808EA703CEB1C10EAF00EEB0F20EB07C09038038004387001C0397802E008
3938047018391C183C303907E00FC01E227EA023>38 D<90380FE0109038381C309038E0
02703803C00139078000F048C71270121E15305A1510127C127800F81400A7EC3FFEEC01
F000781300127C123CA27EA27E6C7E3903C001703900E002309038380C1090380FF0001F
217E9F24>71 D<EAFFF0EA0F00B3ABEAFFF00C1F7E9E10>73 D<EB1FE0EB70383801C00E
48487E39070003804814C0001EEB01E048EB00F0A2007C14F8A20078147800F8147CA900
781478007C14F8A2003C14F0003E1301001E14E06CEB03C06C148039038007003801E01E
38007038EB1FE01E217E9F23>79 D<3803F040380C0CC0EA1803EA3001EA6000A212E014
40A36C13007E127CEA7F80EA3FF86CB4FC00071380C613C0EB1FE013031301EB00F01470
7EA46C136014E06C13C038F8018038C60300EA81FC14217E9F19>83
D<007FB512E038780F010060EB006000401420A200C0143000801410A400001400B3497E
3803FFFC1C1F7E9E21>I<3BFFF07FF81FF03B1F000FC007C06C903907800180170015C0
01805C00071502EC09E013C000035DEC19F01410D801E05CA2EC2078D800F05CA2EC403C
01785CA2EC801E017C1460013C144090383D000F133F6D5CA2011E1307010E91C7FCA201
0C7F010413022C207F9E2F>87 D<EA1FE0EA3030EA7818131CEA300E1200A313FEEA078E
EA1E0E1238127800F01310A3131E127838386720380F83C014147E9317>97
D<EA01FCEA0706EA1C0F123813060078C7FC127012F0A61270127800381380A2381C0100
EA0706EA01F811147F9314>99 D<EB01C0130F1301AAEA01F1EA070DEA0C03EA18011238
1278127012F0A61270A21238EA1803120CEA070D3801F1F815207F9F19>I<EA03F0EA0E
1C487E487EA21270EB038012F0A2B5FC00F0C7FCA31270A26C1380A2381C0100EA0706EA
01F811147F9314>I<137CEA01C6EA030F1207EA0E061300A7EAFFF0EA0E00B2EA7FE010
20809F0E>I<14E03803E330EA0E3CEA1C1C38380E00EA780FA5EA380E6C5AEA1E38EA33
E00020C7FCA21230A2EA3FFE381FFF8014C0383001E038600070481330A4006013606C13
C0381C03803803FC00141F7F9417>I<121C12FC121CAA137C1386EA1D03001E1380A212
1CAE38FF8FF014207E9F19>I<1238127CA31238C7FCA6121C12FC121CB1EAFF80091F7F
9E0C>I<121C12FC121CB3ABEAFF8009207F9F0C>108 D<391C3E03E039FCC30C30391D03
9038391E01E01CA2001C13C0AE3AFF8FF8FF8021147E9326>I<EA1C7CEAFC86EA1D0300
1E1380A2121CAE38FF8FF014147E9319>I<EA01F8EA070E381C0380383801C0A2387000
E0A200F013F0A6007013E0A2383801C0A2381C038038070E00EA01F814147F9317>I<EA
1CF0EAFD18EA1E3CA21318EA1C00AEEAFFC00E147E9312>114 D<EA0FC8EA3038EA6018
EAC008A3EAE000127CEA3FE0EA1FF0EA07F8EA003CEA800E130612C0A21304EAE00CEAD8
18EA87E00F147F9312>I<1202A31206A2120EA2123EEAFFF8EA0E00AB1304A5EA070812
03EA01F00E1C7F9B12>I<381C0380EAFC1FEA1C03AE1307120CEA061B3803E3F014147E
9319>I<38FF83F8383E00E0001C13C06C1380A338070100A21383EA0382A2EA01C4A213
E4EA00E8A21370A31320A25BA3EAF080A200F1C7FC1262123C151D7F9318>121
D E /FD 23 121 df<EAFFFEA30F037F8E14>45 D<14101438A3147CA314BEA3EB011FA3
9038020F80A201047F1407A201087F1403A2496C7EA3496C7EA390387FFFFCA29038C000
7E49133EA248C7123F81A20002EC0F80A21206ED07C0001FEC0FE0D8FFE0EBFFFEA2272A
7EA92C>65 D<B7FCA23907E0003F00031407ED03801501A21500A416405CA21600A25CA2
140F90B5FCA2EBE00F1403A2801620A391C7FC1640A416C0A215011503ED07800007143F
B7FCA223297EA828>69 D<D8FFE0913807FF80A20007EEF000D802F0EC0BE0A201781413
A36D1423A36D1443A26D1483A3903907800103A3903803C002A2903801E004A3903800F0
08A2EC7810A3EC3C20A3EC1E40A2EC0F80A30007EB0700D80F804A7ED8FFF891B5128014
0231297EA836>77 D<B6FC15E03907E001F80003EB007C81811680150F16C0A61680151F
1600153E5DEC01F090B512C001E0C8FCB1487EB57EA222297EA828>80
D<EBFE013803FF83380F81E3381E003748131F00387F00787F127000F07FA3807EA26C90
C7FC127E127FEA3FE0EA1FFE380FFFE06C13F86C7FC66C7EEB07FFEB007FEC1F80140FEC
07C0A26C1303A47E1580A26C13076C14006C130E00EE5B38C3C07838C1FFF038803FC01A
2B7DA921>83 D<EA03FCEA0C0738100380383C01C0003E7F6D7E121C1208C7FCA3137FEA
03E0EA0F80EA1E005A127C0078144012F8A31301127C393C027880381E0C7F3907F01E00
1A1A7E991D>97 D<137F3801C0E038070010000E1378001E13F85A1470007C1320007813
0012F8A81278127C003C1308A26C1310000E13206C13603801C18038007E00151A7E991A
>99 D<13FC38038780380701C0000E13E0EA1C00003C13F0A2481378A212F8A2B512F800
F8C7FCA51278A26C1308A26C1310000E13206C13403801C18038007E00151A7E991A>
101 D<140F3901FC308038070743380E03C3001EEBC100486C7EA2007C7FA5003C5BA26C
485A000E5BD81707C7FCEA11FC0030C8FCA47E381FFF806C13F06C7F3818007C48131E00
70130E00607F12E0A40070130EA26C5B6C5B380781E0C6B4C7FC19287E9A1D>103
D<120FB4FCA2121F7EACEB07F0EB1838EB201C497E140F1380A21300B139FFF0FFF0A21C
2A7EA921>I<121E123FA4121EC7FCA9120FB4FCA2121F7EB3A2EAFFF0A20C297EA811>I<
120FB4FCA2121F7EB3B2EAFFF0A20C2A7EA911>108 D<3A0F07F007F03AFF1838183890
39201C201C3A1F400E400E000F010F130F01801380A201001300B13BFFF0FFF0FFF0A22C
1A7E9931>I<380F07F038FF1838EB201C381F400E000F130F1380A21300B139FFF0FFF0
A21C1A7E9921>I<137E3803C3C0380700E0000E1370481338003C133CA248131EA200F8
131FA80078131EA26C133CA2001C13386C13706C13E03803C3C038007E00181A7E991D>
I<380F07E038FF1838EB601E380F800FEC0780010013C0140315E0A2EC01F0A715E01403
A215C0EC07801380EC0F00EB401CEB3078EB0FC090C8FCAAEAFFF0A21C267E9921>I<38
0F0F8038FF11C0EB23E0EA1F43EA0F83EB81C0EB800090C7FCB07FEAFFFCA2131A7E9917
>114 D<3807F080EA1C0DEA3003EA600112E01300A27E6C1300127EEA7FE0EA3FFC6C7E
EA07FF38003F801307388003C0A2130112C0A200E01380130300F01300EACC0EEA83F812
1A7E9917>I<7FA41201A31203A21207120F381FFF80B5FC38078000AD1440A73803C080
12013800E100133E12257FA417>I<000F130FB413FFA2001F131F6C7FB05CA26C132F39
03804F803901C08FF038007F0F1C1A7E9921>I<3AFFF3FF83FEA23A1F803C00F8D80F00
1460EB801C0007011E1340A2D9C02E13C00003012F1380A23A01E04701001581A23900F0
838215C2A290387901C415E4137B90383E00E815F8A2011C1370A2011813300108132027
1A7F992A>119 D<39FFF03FF0A2390FC01F003807801C3803C0183801E0106D5A00005B
EB78C06D5A013DC7FC7F7F80A2EB13C0EB21E0EB61F01340EB80783801007C48133C487F
001F133F39FF807FF8A21D1A7F991F>I E end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300dpi
TeXDict begin

%%EndSetup
%%Page: 1 1
1 0 bop 292 49 a FD(Multi-St)o(age)17 b(Programming)i(with)f(Explicit)e
(Annotations)704 167 y FC(W)l(alid)h(T)l(aha)e(&)g(Tim)h(Sheard)454
224 y(Oregon)f(Graduate)g(Institute)h(of)e(Science)j(&)f(T)l(ec)o
(hnology)642 280 y FB(f)p FA(walidt,sheard)p FB(g)p FA(@cse.og)o(i.edu)
1299 264 y Fz(\003)-76 638 y Fy(Abstract)-76 721 y Fx(W)m(e)j(in)o(tro)
q(duce)g(MetaML,)g(a)g(statically-t)o(yp)q(ed)f(m)o(ulti-stage)-76
762 y(programming)8 b(language)j(extending)h(Nielson)f(and)h(Nielson's)
-76 804 y(t)o(w)o(o)19 b(stage)g(notation)f(to)h(an)g(arbitrary)g(n)o
(um)o(b)q(er)g(of)f(stages.)-76 845 y(MetaML)11 b(extends)h(previous)e
(w)o(ork)g(b)o(y)h(in)o(tro)q(ducing)f Fw(four)g Fx(dis-)-76
887 y(tinct)19 b(staging)e(annotations)h(whic)o(h)g(generalize)g(those)
h(pub-)-76 928 y(lished)14 b(previously)g([25)o(,)f(12,)g(7,)g(6])-20
970 y(W)m(e)18 b(giv)o(e)f(a)h(static)g(seman)o(tics)g(in)g(whic)o(h)g
(t)o(yp)q(e)g(c)o(hec)o(king)-76 1011 y(is)h(done)g(once)h(and)f(for)g
(all)e(b)q(efore)j(the)g(\014rst)g(stage,)g(and)f(a)-76
1053 y(dynamic)c(seman)o(tics)g(whic)o(h)h(in)o(tro)q(duces)h(a)f(new)h
(concept)g(of)-76 1094 y Fw(cr)n(oss-stage)22 b(p)n(ersistenc)n(e)p
Fx(,)i(whic)o(h)e(requires)i(that)e(v)n(ariables)-76
1136 y(a)o(v)n(ailable)c(in)h(an)o(y)g(stage)i(are)f(also)f(a)o(v)n
(ailable)f(in)h(all)g(future)-76 1177 y(stages.)-20 1219
y(W)m(e)13 b(illustrate)h(that)f(staging)g(is)h(a)f(man)o(ual)e(form)h
(of)h(bind-)-76 1260 y(ing)e(time)f(analysis.)17 b(W)m(e)11
b(explain)g(wh)o(y)m(,)g(ev)o(en)h(in)g(the)g(presence)-76
1302 y(of)e(automatic)f(binding)h(time)g(analysis,)g(explicit)g
(annotations)-76 1343 y(are)15 b(useful,)f(esp)q(ecially)g(for)g
(programs)f(with)h(more)g(than)g(t)o(w)o(o)-76 1385 y(stages.)-20
1426 y(A)i(thesis)g(of)f(this)g(pap)q(er)h(is)f(that)h(m)o(ulti-stage)d
(languages)-76 1468 y(are)f(useful)f(as)h(programmi)o(ng)c(languages)j
(in)g(their)g(o)o(wn)g(righ)o(t,)-76 1509 y(and)17 b(should)h(supp)q
(ort)g(features)h(that)e(mak)o(e)f(it)h(p)q(ossible)h(for)-76
1551 y(programmers)9 b(to)i(write)g(staged)h(computations)d(without)i
(sig-)-76 1592 y(ni\014can)o(tly)f(c)o(hanging)g(their)h(normal)e
(programmi)o(ng)f(st)o(yle.)17 b(T)m(o)-76 1634 y(illustrate)c(this)g
(w)o(e)h(pro)o(vide)f(a)f(simple)g(three)j(stage)e(example,)-76
1676 y(and)f(an)g(extended)i(t)o(w)o(o-stage)e(example)f(elab)q
(orating)g(a)h(n)o(um-)-76 1717 y(b)q(er)j(of)e(practical)h(issues.)-76
1836 y Fy(1)53 b(In)o(tro)q(duction)-76 1919 y Fx(Multi-stage)17
b(languages)g(ha)o(v)o(e)h(recen)o(tly)g(b)q(een)h(prop)q(osed)f(as)-76
1960 y(in)o(termediate)c(represen)o(tations)j(for)e(partial)f(ev)n
(aluation)g([12)o(])-76 2002 y(and)g(run)o(time)f(co)q(de)i(generation)
f([7)o(].)k(These)e(languages)d(gen-)-76 2043 y(eralize)k(the)f(w)o
(ell-kno)o(wn)f(t)o(w)o(o-lev)o(el)g(notation)g(of)g(Nielson)h(&)-76
2085 y(Nielson)e([25)o(])f(to)h(an)g(arbitrary)f(n)o(um)o(b)q(er)h(of)f
(lev)o(els.)-20 2126 y(A)h(ma)r(jor)e(thesis)j(of)e(this)h(pap)q(er)g
(is)g(that)f Fw(multi-stage)h(lan-)-76 2168 y(guages)k(ar)n(e)g(useful)
f(not)h(only)f(as)h(interme)n(diate)f(r)n(epr)n(esenta-)-76
2209 y(tions,)g(but)f(also)h(as)g(pr)n(o)n(gr)n(amming)f(languages)h
(in)f(their)g(own)-76 2251 y(right.)29 b Fx(Multi-stage)17
b(programming)d(is)k(imp)q(ortan)o(t)e(b)q(ecause)p -76
2282 399 2 v -34 2303 a Fv(\003)-16 2316 y Fu(The)10
b(researc)o(h)h(rep)q(orted)f(in)i(this)g(pap)q(er)f(w)o(as)f(supp)q
(orted)i(b)o(y)g(the)f(USAF)-76 2349 y(Air)19 b(Materiel)g(Command,)i
(con)o(tract)d(#)i(F19628-93-C-00)o(69)o(,)f(and)g(NSF)-76
2382 y(Gran)o(t)11 b(IRI-9625462)1020 638 y Fx(p)q(erformance)k(is)g
(imp)q(ortan)o(t.)21 b(But)16 b(there)h(is)e(v)o(ery)h(little)e(lan-)
1020 680 y(guage)j(supp)q(ort)g(for)f(writing)g(m)o(ulti-stage)f
(programs.)25 b(This)1020 721 y(pap)q(er)11 b(extends)h(previous)f(w)o
(ork)g(on)f(m)o(ulti-stage)f(programing)1020 763 y(with)15
b(features)h(that)f(are)g(of)g Fw(pr)n(actic)n(al)g(use)h(to)g(r)n(e)n
(al)f(pr)n(o)n(gr)n(am-)1020 804 y(mers)p Fx(.)1076 846
y(W)m(e)9 b(in)o(tro)q(duce)h(MetaML,)f(a)g(statically-t)o(yp)q(ed)g(m)
o(ulti-stage)1020 887 y(programming)f(language)j(extending)h(Nielson)f
(and)h(Nielson's)1020 929 y(t)o(w)o(o-lev)o(el)c(notation)h(to)g(an)g
(arbitrary)g(n)o(um)o(b)q(er)g(of)f(stages)i(\(sim-)1020
970 y(ilar)h(to)i(their)f(B-lev)o(el)h(language\).)j(MetaML)d(is)f(an)h
(extension)1020 1012 y(of)f(a)g(Hindley-Milner)g(p)q(olymorphically-t)o
(y)o(p)q(ed)f([22)o(])h(call-b)o(y-)1020 1053 y(v)n(alue)k
Ft(\025)p Fx(-calculus)g([13)o(])g(with)g(supp)q(ort)i(for)e(sums,)f
(pro)q(ducts,)1020 1095 y(recursion,)c(p)q(olymorphism,)6
b(primitiv)o(e)h(datat)o(yp)q(es)j(and)f(static)1020
1136 y(t)o(yp)q(e-inference.)20 b(It)13 b(pro)o(vides)g(the)h(follo)o
(wing)d(extensions)j(not)1020 1178 y(found)g(in)f(previous)h(w)o(ork)g
(on)f(m)o(ulti-stage)f(systems:)1074 1246 y Fs(\017)18
b Fx(F)m(our)i(distinct)g(staging)f(annotations,)i(whic)o(h)f(w)o(e)g
(b)q(e-)1113 1288 y(liev)o(e)11 b(are)g(necessary)h(and)f(su\016cien)o
(t)g(for)f(all)f(m)o(ulti-stage)1113 1329 y(programming.)14
b(\(Section)g(5\))f(These)h(annotations)e(gen-)1113 1371
y(eralize)17 b(and)f(safely)g(com)o(bine)f(those)i(published)f(previ-)
1113 1412 y(ously)e([25)o(,)f(12,)g(7,)g(6].)1074 1479
y Fs(\017)18 b Fx(A)13 b(t)o(yp)q(e)g(system)f(ensuring)h(the)h(w)o
(ell-formedness)d(of)h(ac-)1113 1520 y(ceptable)18 b(m)o(ulti-stage)d
(programs.)27 b(T)o(yp)q(e)17 b(c)o(hec)o(king)g(is)1113
1562 y(done)11 b(once)h(and)e(for)h(all)e(b)q(efore)j(the)f(\014rst)h
(stage)f(\(Section)1113 1603 y(10.1\).)1074 1670 y Fs(\017)18
b Fx(V)m(ariables)g(of)g(an)o(y)f(stage)i(are)g(a)o(v)n(ailable)d(in)i
(all)f(future)1113 1712 y(stages.)i(This)11 b(feature,)h(in)g(a)f
(language)g(whic)o(h)g(also)g(con-)1113 1758 y(tains)19
b Fr(run)1286 1743 y Fu(1)1323 1758 y Fx(mak)o(es)f(MetaML's)h
(annotations)f(strictly)1113 1799 y(more)e(expressiv)o(e)j(than)e(the)h
(languages)e(of)h(Nielsen)g(&)1113 1841 y(Nielsen)12
b([25)o(,)e(24],)h(Da)o(vies)f(&)h(Pfenning)g([7)o(],)g(and)g(Da)o
(vies)1113 1882 y([6].)36 b(W)m(e)20 b(also)f(deal)h(with)g(the)g(in)o
(teresting)h(tec)o(hnical)1113 1924 y(problem)d(of)f(ensuring)i(the)g
(h)o(ygienic)f(binding)g(of)f(free)1113 1965 y(v)n(ariables)d
(\(Section)g(10.2\))f(in)g(co)q(de)i(expressions.)1074
2032 y Fs(\017)j Fx(A)i(non-Hindley-Milner,)g(second)h(order)f(t)o(yp)q
(e)g(judge-)1113 2074 y(men)o(t)9 b(for)h(the)g Fr(run)g
Fx(annotation)f(to)g(ensure)j(that)e(no)f(co)q(de)1113
2115 y(is)14 b(ev)o(er)h Fr(run)e Fx(in)h(a)f(con)o(text)i(in)e(whic)o
(h)h(it)f(is)h(unde\014ned.)1076 2183 y(As)i(a)f(consequence)i(of)e
(the)h(ab)q(o)o(v)o(e)e(prop)q(erties,)j(MetaML)1020
2225 y(pro)o(vides)e(a)g(programmi)o(ng)d(language)i(suitable)g(for)h
(express-)1020 2266 y(ing)21 b(staged)h(computations)e(explicitly)m(.)
40 b(W)m(e)21 b(b)q(eliev)o(e)h(that)1020 2308 y(MetaML)12
b(can)g(ha)o(v)o(e)f(p)q(ositiv)o(e)g(implications)e(for)i(understand-)
1020 2349 y(ing)21 b(and)g(comm)o(unicating)d(ideas)j(ab)q(out)g(m)o
(ulti-stage)e(pro-)1020 2391 y(grams,)f(partial)g(ev)n(aluation)g(and)g
(the)i(complex)d(pro)q(cess)k(of)1020 2433 y(binding-time)15
b(analysis)i(in)g(m)o(uc)o(h)f(the)j(same)d(w)o(a)o(y)h(that)h(the)1020
2474 y(b)q(o)o(xed)11 b(/)g(un)o(b)q(o)o(xed\(#\))g(distinction)g(pro)o
(vides)h(a)e(language)h(for)1020 2516 y(understanding)h(b)q(o)o(xing)d
(optimizations)g(as)i(source-to-source)1020 2557 y(transformations)h
([16)o(].)p 1020 2586 V 1063 2610 a Fq(1)1080 2622 y
Fu(An)f Fp(ev)q(al)p Fu(-lik)o(e)h(op)q(erator)p eop
%%Page: 2 2
2 1 bop -76 -34 a Fy(2)53 b(Wh)o(y)16 b(Multi-stage)k(Programs?)-76
48 y Fx(The)e(concept)g(of)e(a)h(stage)h(arises)f(in)g(a)g(wide)g(v)n
(ariet)o(y)f(of)h(sit-)-76 90 y(uations.)32 b(F)m(or)18
b(a)g(compiled)f(language,)h(there)i(are)f(t)o(w)o(o)f(dis-)-76
131 y(tinct)j(stages:)31 b(compile-tim)o(e,)19 b(and)h(run-time.)35
b(But)21 b(three)-76 173 y(distinct)14 b(stages)g(app)q(ear)f(in)g(the)
h(con)o(text)g(of)e(program)g(gener-)-76 214 y(ation:)20
b(generation,)15 b(compilation,)d(and)i(execution.)23
b(F)m(or)14 b(ex-)-76 256 y(ample,)d(the)i(Y)m(acc)g(parser)g
(generator)h(\014rst)f(reads)g(a)f(grammar)-76 297 y(and)e(generates)j
(C)d(co)q(de;)i(second,)g(this)e(program)f(is)h(compiled;)-76
339 y(third,)k(the)g(user)h(runs)g(the)f(ob)r(ject)h(co)q(de.)-20
380 y(Y)m(et)20 b(despite)h(the)f(n)o(umerous)f(examples)g(of)g(m)o
(ulti-stage)-76 422 y(soft)o(w)o(are)11 b(systems,)h(almost)d(all)h
(these)j(systems)e(ha)o(v)o(e)g(realized)-76 463 y(staging)16
b(in)h(ad-ho)q(c)g(w)o(a)o(ys.)26 b(Our)18 b(goal)d(is)i(to)g(pro)o
(vide)g(a)f(lan-)-76 505 y(guage)e(with)g(w)o(ell-designed)g(supp)q
(ort)h(for)e(m)o(ulti-staged)g(pro-)-76 546 y(gramming)7
b(b)o(y)i(using)h(explicit)g(staging)f(annotations.)16
b(In)11 b(par-)-76 588 y(ticular,)i(a)f(m)o(ulti-stage)g(programmi)o
(ng)e(language)i(supplies)i(a)-76 629 y(basis)d(for)g(generation)g(tec)
o(hnology)m(.)16 b(Generators)c(can)g(pro)o(vide)-76
671 y(dramatic)h(impro)o(v)o(em)o(en)o(ts)f(in)i(the)g(follo)o(wing)d
(areas:)-20 742 y Fo(E\016ciency)l(.)19 b Fx(Sp)q(ecializing)13
b(a)g(function)h(on)g(a)f(\014xed)i(argu-)-76 784 y(men)o(t)j(can)h
(lead)f(to)h(dramatic)e(e\016ciency)i(gains.)32 b(Program)-76
825 y(generators)20 b(can)f(pro)o(vide)g(the)g(same)f(e\016ciency)i
(gains)e(that)-76 867 y(partial)13 b(ev)n(aluation)g(do)q(es.)-20
939 y Fo(Pro)q(ductivit)n(y)18 b(and)i(reuse.)29 b Fx(When)18
b(a)g(programming)-76 980 y(task)c(or)g(activit)o(y)f(b)q(ecomes)h
(routine,)g(programmers)d(can)k(use)-76 1022 y(program)h(generators)i
(to)g(encapsulate)g(their)g(kno)o(wledge)f(of)-76 1063
y(the)22 b(routine)g(task.)41 b(This)21 b(capture)h(of)f(a)g(problem)f
(family)-76 1105 y(rather)12 b(than)f(a)g(single)f(problem)g(increases)
j(programmer)c(pro-)-76 1146 y(ductivit)o(y)m(.)17 b(Program)11
b(generators)j(let)f(exp)q(erts)h(capture)g(their)-76
1188 y(kno)o(wledge)d(in)g(a)h(clear)g(\(and)f(hence)i(reusable\))g
(notation)d(that)-76 1229 y(can)16 b(then)h(b)q(e)g(used)g(for)f(syn)o
(thesising)g(the)h(desired)g(soft)o(w)o(are)-76 1271
y(comp)q(onen)o(t)c([21)o(,)h(17)o(,)g(18)o(].)-20 1342
y Fo(Reliabili)o(t)n(y)c(and)h(qualit)o(y)l(.)16 b Fx(The)11
b(greatest)h(source)g(of)e(er-)-76 1384 y(rors)k(in)e(co)q(de)i(main)o
(tenance)e(is)h(h)o(uman)f(in)o(terv)o(en)o(tion.)17
b(When)-76 1425 y(less)d(h)o(uman)e(in)o(terv)o(en)o(tion)i(is)f
(needed)i(to)f(mo)q(dify)d(a)i(soft)o(w)o(are)-76 1467
y(pro)q(duct,)j(there)h(are)f(prop)q(ortionately)f(few)o(er)h(opp)q
(ortunities)-76 1508 y(for)22 b(error)h(insertion)f(and)g(less)g(rew)o
(ork)h(of)e(co)q(de)i(is)f(neces-)-76 1550 y(sary)m(.)h(Automatically)
13 b(generated)k(comp)q(onen)o(ts)e(require)h(lit-)-76
1591 y(tle)e(man)o(ual)e(rew)o(ork)i(after)g(a)g(re-generation.)-20
1663 y(Our)e(language,)e(MetaML,)h(w)o(as)g(designed)h(as)g(basis)f
(for)g(an)-76 1704 y(in)o(tegrated)18 b(generator)g(system.)29
b(It)18 b(pro)o(vides)f(an)g(approac)o(h)-76 1746 y(radically)k
(di\013eren)o(t)j(from,)e(and)h(sup)q(erior)g(to,)h(the)f(classic)-76
1787 y(\\programs-as-strings")14 b(view)h(that)g(seems)g(to)g
(predominate)-76 1829 y(in)d(man)o(y)f(ad-ho)q(c)i(m)o(ulti-stage)e
(soft)o(w)o(are)h(systems.)18 b(MetaML)-76 1870 y(is)c(tigh)o(tly)f(in)
o(tegrated)h(in)f(this)h(sense.)-76 1989 y Fy(3)53 b(Relationship)19
b(to)f(P)o(artial)h(Ev)m(aluation)-76 2072 y Fx(T)m(o)q(da)o(y)m(,)14
b(the)i(most)f(sophisticated)h(automatic)e(staging)h(tec)o(h-)-76
2113 y(niques)c(are)g(found)e(in)h(partial)g(ev)n(aluation)f(systems)h
([15)o(].)16 b(P)o(ar-)-76 2155 y(tial)11 b(ev)n(aluation)f(optimizes)h
(a)g(program)f(using)i(a)f(priori)g(infor-)-76 2196 y(mation)h(ab)q
(out)h(some)g(of)g(that)h(program's)e(inputs.)18 b(The)d(goal)-76
2238 y(is)10 b(to)g(iden)o(tify)f(and)h(p)q(erform)g(as)g(man)o(y)e
(computations)h(as)h(p)q(os-)-76 2279 y(sible)k(in)f(a)h(program)e(b)q
(efore)j(run-time.)-20 2321 y Fw(O\017ine)10 b Fx(partial)e(ev)n
(aluation)g(has)h(t)o(w)o(o)g(distinct)g(steps,)i Fw(binding-)-76
2362 y(time)21 b(analysis)g Fx(\(BT)m(A\))g(and)g Fw(sp)n(e)n
(cialization)p Fx(.)38 b(BT)m(A)21 b(deter-)-76 2404
y(mines)12 b(whic)o(h)h(computations)f(can)i(b)q(e)g(p)q(erformed)e(in)
h(an)g(ear-)-76 2445 y(lier)d(stage)g(giv)o(en)g(the)h(names)e(of)g
(inputs)i(a)o(v)n(ailable)c(b)q(efore)k(run-)-76 2487
y(time)i(\(static)h(inputs\).)-20 2528 y(In)i(essence,)j(BT)m(A)d(p)q
(erforms)f(automatic)f(staging)h(of)h(the)-76 2570 y(input)d(program.)k
(After)c(BT)m(A,)g(the)h(actual)f(v)n(alues)g(of)g(the)h(in-)-76
2612 y(puts)19 b(are)g(made)f(a)o(v)n(ailable)e(to)j(the)g(sp)q
(ecializer.)33 b(F)m(ollo)o(wing)1020 -34 y(the)15 b(annotations,)e
(the)i(sp)q(ecializer)g(either)g(p)q(erforms)f(a)g(com-)1020
7 y(putation,)j(or)g(pro)q(duces)h(text)g(for)f(inclusion)f(in)g(the)i
(output)1020 49 y(\()p Fw(r)n(esidual)p Fx(\))c(program.)1076
90 y(The)c(relationship)f(b)q(et)o(w)o(een)h(partial-ev)n(aluation)d
(and)i(m)o(ulti-)1020 132 y(stage)k(programming)c(is)j(that)h(the)g(in)
o(termediate)f(data)g(struc-)1020 173 y(ture)g(b)q(et)o(w)o(een)g(the)f
(t)o(w)o(o)f(steps)i(is)f(a)f Fw(two-stage)i(annotate)n(d)h(pr)n(o-)
1020 215 y(gr)n(am)h Fx([2],)f(and)i(that)g(the)g(sp)q(ecialization)f
(phase)i(is)e(\(the)h(\014rst)1020 256 y(stage)f(in\))f(the)g
(execution)h(of)f(the)h(t)o(w)o(o-stage)f(annotated)g(pro-)1020
298 y(gram)c(pro)q(duced)k(b)o(y)d(BT)m(A.)h(Recen)o(tly)m(,)g(Gl)q
(\177)-22 b(uc)o(k)10 b(and)h(J\034rgensen)1020 339 y(prop)q(osed)j
Fw(multi-level)f(BT)m(A)g Fx(and)h(sho)o(w)o(ed)f(that)h(it)f(is)g(an)g
(e\016-)1020 381 y(cien)o(t)e(alternativ)o(e)f(to)g(m)o(ultiple)e(sp)q
(ecialization)i([9)o(,)g(10].)16 b(Their)1020 422 y(underlying)9
b(annotated)g(language)g(is)g(closely)g(related)h(to)f(MetaML.)1020
541 y Fy(4)52 b(Wh)o(y)17 b(Explicit)j(Annotations?)1020
624 y Fx(If)10 b(BT)m(A)g(p)q(erforms)f(staging)h(automatically)l(,)e
(wh)o(y)i(should)f(pro-)1020 665 y(grammers)17 b(stage)i(programs)f
(man)o(ually?)30 b(They)20 b(shouldn't)1020 707 y Fw(have)f
Fx(to,)g(but)f(there)h(are)g(sev)o(eral)g(imp)q(ortan)o(t)d(reasons)k
(wh)o(y)1020 748 y(they)14 b(ma)o(y)e Fw(want)i Fx(to:)1076
790 y Fo(Pragmatic.)43 b Fx(While)22 b(there)h(are)g(adv)n(an)o(tages)f
(to)h(dis-)1020 831 y(cussing)c(the)f(seman)o(tics)g(of)f(annotated)h
(programs)f(and)h(the)1020 873 y(tec)o(hniques)g(of)e(BT)m(A)h(at)f
(the)i(same)e(time,)f(w)o(e)i(feel)g(that)g(the)1020
914 y(complexit)o(y)8 b(of)h(the)i(seman)o(tics)e(of)h(annotated)g
(programs)f(w)o(ar-)1020 956 y(ran)o(ts)k(studying)g(them)f(in)g
(\(relativ)o(e\))h(isolation)e(of)h(other)h(par-)1020
998 y(tial)g(ev)n(aluation)f(issues.)1076 1069 y Fo(P)o(edagogical)21
b(to)q(ol.)38 b Fx(It)20 b(has)h(b)q(een)g(observ)o(ed)h(that)f(it)1020
1111 y(is)f(sometimes)e(hard)i(for)f(users)j(to)d(understand)i(the)g(w)
o(ork-)1020 1152 y(ings)c(of)g(partial)g(ev)n(aluation)f(systems)i([14)
o(].)28 b(New)18 b(users)h(of-)1020 1194 y(ten)13 b(lac)o(k)g(a)f(go)q
(o)q(d)g(men)o(tal)f(mo)q(del)h(of)g(ho)o(w)g(partial)g(ev)n(aluation)
1020 1235 y(systems)18 b(w)o(ork.)30 b(Although)17 b(BT)m(A)h(is)g(an)f
(in)o(v)o(olv)o(ed)g(pro)q(cess,)1020 1277 y(requiring)c(sp)q(ecial)h
(exp)q(ertise,)h(the)f(annotations)f(it)g(pro)q(duces)1020
1318 y(are)h(relativ)o(ely)e(simple)g(and)h(easy)g(to)g(understand.)19
b(Ho)o(w)o(ev)o(er,)1020 1360 y(new)f(users)g(are)g(often)f(uncertain:)
25 b(What)17 b(is)g(the)h(output)f(of)1020 1401 y(a)j(binding-time)d
(analysis?)35 b(What)20 b(are)g(the)g(annotations?)1020
1443 y(Ho)o(w)d(are)g(they)g(expressed?)30 b(What)16
b(do)h(they)h(really)e(mean?)1020 1484 y(The)e(answ)o(ers)h(to)f(these)
h(questions)g(are)f(crucial)g(to)f(the)i(e\013ec-)1020
1526 y(tiv)o(e)h(use)h(of)f(partial)f(ev)n(aluation.)23
b(Our)17 b(observ)n(ation)f(is)g(that)1020 1567 y(programmers)e(can)j
(understand)g(the)g(annotated)f(output)h(of)1020 1609
y(BT)m(A,)c(without)h(actually)f(kno)o(wing)f(ho)o(w)i(BT)m(A)g(w)o
(orks.)k(Ha)o(v-)1020 1650 y(ing)e(a)h(programming)c(language)j(with)h
(explicit)f(staging)h(an-)1020 1692 y(notations)c(w)o(ould)h(help)g
(users)h(of)e(partial)g(ev)n(aluation)g(under-)1020 1733
y(stand)d(more)e(of)h(the)h(issues)h(in)o(v)o(olv)o(ed)d(in)h(staged)g
(computation,)1020 1775 y(and,)h(hop)q(efully)m(,)e(reduce)k(the)e
(steep)h(learning)e(curv)o(e)h(curren)o(tly)1020 1816
y(asso)q(ciated)18 b(with)f(learning)g(to)g(use)h(a)f(partial)g(ev)n
(aluator)f(ef-)1020 1858 y(fectiv)o(ely)d([15)o(].)k(Nielson)12
b(&)h(Nielson's)f(t)o(w)o(o-stage)h(notation)e(is)1020
1899 y(the)i(only)e(widely)h(accepted)h(notation)f(for)f(expressing)j
(staged)1020 1941 y(computation.)23 b(But)17 b(Nielson)f(&)g(Nielson's)
g(notation)f(is)h(not)1020 1982 y(widely)c(view)o(ed)h(as)f(a)h
(programmi)o(ng)d(language,)h(p)q(erhaps)j(b)q(e-)1020
2024 y(cause)19 b(o)o(v)o(er-bars)f(and)g(under-bars)i(do)d(not)h(app)q
(ear)h(on)f(the)1020 2065 y(standard)i(k)o(eyb)q(oard)f(and)g(no)g
(implemen)o(tation)d(of)j(it)g(is)g(in)1020 2107 y(widespread)c(use.)
1076 2178 y Fo(Con)o(trollin)o(g)22 b(Ev)m(aluation)i(Order.)42
b Fx(When)22 b(p)q(erfor-)1020 2220 y(mance)15 b(is)g(an)g(issue,)h
(con)o(trol)f(of)g(ev)n(aluation)f(order)i(is)f(essen-)1020
2261 y(tial.)33 b(BT)m(A)19 b(optimizes)f(the)i(ev)n(aluation)e(order,)
j(but)e(some-)1020 2303 y(times)10 b(it)g(is)h(just)g(easier)h(to)f(sa)
o(y)f(what)h(y)o(ou)g(w)o(an)o(t)f(than)h(to)g(force)1020
2344 y(a)i(BT)m(A)g(to)f(disco)o(v)o(er)i(it.)j(Automatic)12
b(analyses)h(lik)o(e)f(BT)m(A)h(are)1020 2386 y(necessarily)19
b(incomplete,)d(and)i(can)f(only)g(appro)o(ximate)f(the)1020
2427 y(kno)o(wledge)e(of)g(the)h(programmer.)h(By)f(using)f(explicit)g
(anno-)1020 2469 y(tations)i(the)g(programmer)d(can)j(exploit)f(his)h
(full)f(kno)o(wledge)1020 2510 y(of)e(the)i(program)d(domain.)1076
2552 y(In)j(addition,)e(BT)m(A)i(for)f(programs)f(with)i(more)e(than)i
(t)o(w)o(o)1020 2593 y(stages)i(is)g(still)e(imprecise.)26
b(Hand)16 b(annotation)g(ma)o(y)f(b)q(e)i(the)p eop
%%Page: 3 3
3 2 bop -76 -34 a Fx(only)21 b(feasible)h(mec)o(hanism)e(for)h(staging)
h(m)o(ulti-stage)e(pro-)-76 7 y(grams,)9 b(and)g(ma)o(y)e(b)q(e)j(the)g
(only)e(mec)o(hanism)f(expressiv)o(e)k(enough)-76 49
y(for)g(the)i(degree)g(of)e(con)o(trol)g(needed)i(in)e(man)o(y)f
(circumstances.)-20 162 y Fo(High-Lev)o(el)21 b(Program)h(Generation.)
35 b Fx(As)21 b(w)o(e)g(will)-76 203 y(also)e(illustrate)g(in)g(this)h
(pap)q(er,)h(staging)e(annotations)g(also)-76 245 y(pro)o(vide)d(a)f(p)
q(o)o(w)o(erful)h(to)q(ol)f(for)g(high-lev)o(el)g(program)f(genera-)-76
286 y(tion.)21 b(No)15 b(explicit)g(construction)h(of)e(parse)i(trees)g
(is)f(needed.)-76 328 y(As)g(a)f(consequence,)j(generators)e(can)g(b)q
(e)g(simpler)e(and)h(more)-76 369 y(reliable)f(than)g(their)h(hand)f
(constructed)j(coun)o(terparts.)j(It)14 b(is)-76 411
y(also)i(easier)g(to)g(v)o(erify)g(the)g(correctness)j(of)d(b)q(oth)g
(the)h(gener-)-76 452 y(ators)f(and)f(the)h(programs)e(they)i
(generate,)h(as)e(the)h(issues)h(of)-76 494 y(represen)o(tation)f(are)e
(hidden)g(a)o(w)o(a)o(y)f(from)f(the)i(programmer.)-76
613 y Fy(5)53 b(MetaML's)11 b(Multi-Stage)j(Programming)d(An-)3
669 y(notations)-76 752 y Fx(The)f(t)o(w)o(o-lev)o(el)f(notation)f(of)h
(Nielson)g(&)h(Nielson)f([25)o(])g(features)-76 793 y(t)o(w)o(o)h
(annotations:)15 b Fw(over-b)n(ars)10 b Fx(to)g(mark)e(computations)h
(of)h(the)-76 835 y(\014rst)15 b(stage,)f(and)g Fw(under-b)n(ars)g
Fx(to)g(mark)e(those)j(of)f(the)g(second)-76 876 y(stage.)31
b(Although)18 b(quite)g(p)q(o)o(w)o(erful,)h(this)f(is)g(only)f(a)h
(subset)-76 918 y(of)e(the)h(annotations)f(needed)i(for)e(generic)i(m)o
(ulti-stage)d(pro-)-76 959 y(gramming)o(.)g(MetaML)f(has)g(four)g
(programmi)o(ng)d(constructs:)-22 1039 y Fs(\017)19 b
Fx(Meta-Brac)o(k)o(ets)11 b(\()p Fr(<)p 331 1039 14 2
v 20 w(>)p Fx(\))f(are)g(the)h(primary)d(means)h(for)g(de-)18
1081 y(la)o(ying)15 b(a)h(computation.)25 b(F)m(or)17
b(example,)f(whereas)i(the)18 1122 y(expression)d Fr(40+2)e
Fx(sp)q(eci\014es)j(a)d(curren)o(t)j(\(or)e(\014rst\))h(stage)18
1164 y(computation,)10 b Fr(<40+2>)g Fx(sp)q(eci\014es)k(one)e(for)f
(the)i(next)f(\(or)18 1205 y(second\))j(stage.)k(A)14
b(binary)g(t)o(yp)q(e)g(constructor)i Fr(<)p 826 1205
V 59 w(,)p 907 1205 V 18 1247 a(>)f Fx(is)h(used)g(to)g(distinguish)f
(the)h(t)o(yp)q(e)h(of)e(the)h(latter)g(ex-)18 1288 y(pression)j(from)e
(the)j(\014rst)g(one.)33 b(F)m(or)18 b(example,)h Fr(7)f
Fx(has)18 1330 y(t)o(yp)q(e)c Fr(int)p Fx(,)e(but)i Fr(<7>)f
Fx(has)h(t)o(yp)q(e)g Fr(<int,'a>)p Fx(,)d(where)k(as)f(is)18
1371 y(in)h(ML)i Fr('a)e Fx(is)i(a)f(free)h(t)o(yp)q(e)f(v)n(ariable.)
24 b(The)17 b(expression)18 1413 y Fr(<<\(1,<2+1>\)>>)11
b Fx(has)j(t)o(yp)q(e:)18 1454 y Fr(<<\(int)20 b(*)i(<int,'c>\),'b>,'a)
o(>)c Fx(and)i(the)i(addition)18 1496 y(will)11 b(b)q(e)j(p)q(erformed)
f(in)g(the)h(fourth)f(stage.)19 b(The)13 b(second)18
1537 y(t)o(yp)q(e)18 b(in)f(the)i(co)q(de)f(t)o(yp)q(e)h(constructor)g
(represen)o(ts)i(the)18 1579 y(name)8 b(of)h(the)g(con)o(text)i(in)d
(whic)o(h)i(this)f(co)q(de)h(can)g(execute.)18 1620 y(In)17
b(the)i(examples)e(ab)q(o)o(v)o(e)g(the)h(con)o(text)h(is)f(completely)
18 1662 y(unconstrained)10 b(hence)h(the)e(t)o(yp)q(e)h(v)n(ariables.)
16 b(More)10 b(ab)q(out)18 1703 y(this)k(in)f(section)i(10.)-22
1775 y Fs(\017)k Fx(Escap)q(e)c(\()q Fr(~)p 195 1775
V 16 w Fx(\))e(can)h(o)q(ccur)h(only)e(inside)h(enclosing)g(meta-)18
1816 y(brac)o(k)o(ets.)j(It)9 b(is)h(the)f(mec)o(hanism)e(used)k(to)e
(insert)h(smaller)18 1858 y(dela)o(y)o(ed)j(computations)f(in)o(to)h
(larger)h(ones.)k(Escap)q(e)d(al-)18 1899 y(lo)o(ws)f(its)h(argumen)o
(t)f(to)h(escap)q(e)i(the)e(\\freeze")h(imp)q(osed)18
1941 y(b)o(y)d(a)h(surrounding)f(meta-brac)o(k)o(et)h(and)f(to)h
(\\splice")f(its)18 1982 y(result)20 b(in)o(to)e(the)i(dela)o(y)o(ed)f
(computation)e(b)q(eing)j(built.)18 2024 y(F)m(or)13
b(example:)144 2103 y Fr(let)21 b(val)g(a=<1+4>)f(in)i(<72+)q(~)-6
b(a>)22 b(end)18 2182 y Fx(returns)17 b(the)g(expression)g
Fr(<72+\(1+4\)>)n Fx(.)24 b(The)17 b(escap)q(ed)18 2223
y(computation)8 b(m)o(ust)h(yield)h(a)g(piece)h(of)f(co)q(de)h(with)f
(a)g(t)o(yp)q(e)18 2265 y(that)15 b(can)h(b)q(e)g(inserted)h(in)e(the)h
(con)o(text)h(where)g(the)f(es-)18 2306 y(cap)q(e)g(app)q(ears.)25
b(The)16 b(t)o(yp)q(e)h(system)f(ensures)h(that)f(this)18
2348 y(is)e(the)i(case.)21 b(F)m(or)15 b(example,)e(if)h
Fr(x)g Fx(has)h(t)o(yp)q(e)h Fr(<int,'a>)p Fx(,)18 2389
y(then)9 b Fr(<\(x,1\))o(>)g Fx(has)h(t)o(yp)q(e)f Fr(<<int,'a>,'b>)e
Fx(and)i Fr(<\()q(~)-5 b(x,1\))o(>)18 2431 y Fx(has)9
b(t)o(yp)q(e)h Fr(<\(<int,'a>)19 b(*)j(int\),'b>)p Fx(.)15
b(Ob)r(jects)c(of)e(t)o(yp)q(e)18 2472 y(co)q(de)20 b(are)f(\014rst)h
(class)g(citizens,)h(and)e(can)h(ev)o(en)g(b)q(e)f Ft(\025)p
Fx(-)18 2514 y(abstracted.)g(F)m(or)13 b(example:)106
2592 y Fr(val)21 b(add)p 262 2592 V 16 w(72)p 322 2592
V 15 w(later)g(=)g(fn)h(a)f(=>)g(<72+)q(~)-5 b(a>)1113
-34 y Fx(declares)16 b(a)e(\014rst)h(class)g(function)f(with)g(t)o(yp)q
(e)h Fr(<int,'a>)1113 7 y(->)22 b(<int,'a>)p Fx(,)8 b(and)h(the)h
(expression)g Fr(add)p 1782 7 V 15 w(72)p 1841 7 V 16
w(later)20 b(<8>)1113 49 y Fx(returns)11 b Fr(<72+8>)o
Fx(.)16 b(F)m(rom)8 b(the)i(language)e(designer's)i(p)q(oin)o(t)1113
90 y(of)16 b(view,)g(escap)q(e)i(p)q(oses)g(a)e(v)o(ery)g(in)o
(teresting)h(tec)o(hnical)1113 132 y(problem,)d(as)i(not)f(all)f(uses)i
(of)f(escap)q(e)i(are)e(reasonable.)1113 173 y(W)m(e)f(discuss)h(this)f
(issue)h(in)e(Section)h(10.1.)1074 245 y Fs(\017)k Fx(Run)k(\()p
Fr(run)p 1308 245 V 32 w Fx(\))g(tak)o(es)g(a)g(co)q(de-v)n(alued)g
(argumen)o(t)f(and)1113 286 y(runs)14 b(it.)j(It)c(is)g(the)g(only)f(w)
o(a)o(y)h(a)f(computation)f(\\frozen")1113 328 y(using)e(meta-brac)o(k)
o(ets)h(can)f(b)q(e)h(computed)f(\(or)g(\\forced"\))1113
369 y(in)h(the)h(curren)o(t)h(stage.)17 b(The)11 b(argumen)o(t)e(to)h
Fr(run)f Fx(m)o(ust)h(b)q(e)1113 411 y(of)15 b Ft(code)g
Fx(t)o(yp)q(e.)22 b(Ha)o(ving)14 b Fr(run)h Fx(in)f(the)i(language)e
(implies)1113 452 y(in)o(tro)q(ducing)20 b(a)g(kind)g(of)f
(re\015ection)j([30)o(],)f(and)f(allo)o(ws)1113 494 y(a)15
b(future-stage)h(computation)d(to)i(b)q(e)h(p)q(erformed)e(no)o(w.)1113
535 y(T)m(o)g(illustrate,)f(consider)h(the)h(expression:)1173
614 y Fr(let)21 b(val)g(a)h(=)f(<50-10>)f(in)i(2+\(run)e(a\))i(end)1113
693 y Fx(This)12 b(expression)h(has)f(t)o(yp)q(e)g Ft(int)g
Fx(and)g(returns)h(the)g(v)n(alue)1113 734 y(42)g(when)h(computed.)k
(Although)13 b(run)h(is)f(not)h(an)f(anno-)1113 776 y(tation)g(used)i
(in)e(the)i(result)f(of)f(BT)m(A,)g(it)h(is)f(an)h(essen)o(tial)1113
817 y(feature)g(for)f(a)f(programmer)f(who)h(w)o(an)o(ts)h(to)g(use)h
(m)o(ulti-)1113 859 y(stage)h(programmi)o(ng)c(to)j(con)o(trol)f(ev)n
(aluation)g(order)h(.)1074 930 y Fs(\017)k Fx(Lift)11
b(\()p Fr(lift)p 1308 930 V 31 w Fx(\))g(allo)o(ws)e(the)j(user)g(to)f
(con)o(v)o(ert)g(an)o(y)g Fw(gr)n(ound)1113 972 y Fx(v)n(alue)j(\(not)h
(con)o(taining)f(a)g(function\))h(in)o(to)f(co)q(de.)21
b(Con-)1113 1013 y(trast)c(this)g(with)f(meta-brac)o(k)o(ets)g(whic)o
(h)g(con)o(v)o(erts)i(an)o(y)1113 1055 y Fw(syntactic)h(expr)n(ession)f
Fx(in)o(to)f(a)h(piece)g(of)g(co)q(de.)30 b(Lift)17 b(is)1113
1096 y(most)h(often)h(used)g(in)g(conjunction)f(with)h(escap)q(e,)i(b)q
(e-)1113 1138 y(cause)16 b(only)d(pieces)i(of)f(co)q(de)h(can)f(b)q(e)h
(\\spliced-in".)j(F)m(or)1113 1179 y(example,)d(in)h(the)h(expression)g
Fr(<1+)q(~)-5 b(\(lift)10 b(2+3\)>)o Fx(,)17 b(the)1113
1221 y(escap)q(e)j(forces)f Fr(lift)11 b(\(2+3\))17 b
Fx(to)h(b)q(e)g(computed)g(in)g(the)1113 1262 y(\014rst)j(stage.)35
b(The)20 b(addition)f(ev)n(aluates)g(to)h(the)g(v)n(alue)1113
1304 y(5,)h(and)f(lift)f(con)o(v)o(erts)j(this)e(result)h(in)o(to)e
(the)i(piece)g(of)1113 1345 y(co)q(de)15 b Fr(<5>)o Fx(,)f(whic)o(h)f
(is)h(spliced)g(\(b)q(ecause)h(of)e(the)h(escap)q(e\))1113
1387 y(bac)o(k)h(in)o(to)e(the)i(original)d(expression)j(to)f(return)i
Fr(<1+5>)o Fx(.)1113 1429 y(Lift)f(can)h(b)q(e)g(used)h(on)e
(structured)j(v)n(alues)d(suc)o(h)i(as)e(tu-)1113 1470
y(ples)g(and)e(lists)h(as)g(long)f(as)g(they)i(do)e(not)h(con)o(tain)f
(func-)1113 1512 y(tions.)18 b(F)m(or)11 b(example)32
b Fr(lift)21 b([\(2,3\),\(2*1,4\)])8 b Fx(ev)n(al-)1113
1553 y(uates)20 b(to)41 b Fr([\(2,3\),\(2,4\)])p Fx(.)30
b(F)m(unction)19 b(v)n(alues)f(can-)1113 1595 y(not)d(b)q(e)f(lifted)g
(using)g(lift,)e(as)j(w)o(e)f(cannot)g(deriv)o(e)h(an)f(in-)1113
1636 y(tensional)g(represen)o(tation)h(for)e(them)f(in)i(general)f
(\(This)1113 1678 y(do)q(es)i(not)f(mean)f(that)h(function)g(v)n(alues)
f(cannot)h(b)q(e)h(de-)1113 1719 y(la)o(y)o(ed)f(using)f(meta-brac)o(k)
o(ets.)18 b(See)d(Section)f(7.\))1020 1823 y Fy(Precedence)k(Issues.)39
b Fx(The)15 b(escap)q(e)h(op)q(erator)f(\()q Fr(~)p 1908
1823 V 16 w Fx(\))f(has)1020 1865 y(the)d(highest)f(precedence;)k(ev)o
(en)d(higher)f(than)h(function)f(appli-)1020 1906 y(cation.)23
b(This)15 b(allo)o(ws)f(us)i(to)g(write:)21 b Fr(<f)h(~)l(x)g(y>)15
b Fx(rather)h(than)1020 1948 y Fr(<f)21 b(\()q(~)l(x)o(\))h(y>)p
Fx(.)32 b(The)18 b(lift)g(\()p Fr(lift)p 1556 1948 V
31 w Fx(\))h(and)f(run)h(\()p Fr(run)p 1870 1948 V 31
w Fx(\))g(op)q(er-)1020 1989 y(ators)f(ha)o(v)o(e)f(the)h(lo)o(w)o(est)
g(precedence.)32 b(The)18 b(scop)q(e)h(of)e(these)1020
2031 y(op)q(erators)g(extends)g(to)e(the)i(righ)o(t)e(as)h(far)f(as)h
(p)q(ossible.)23 b(This)1020 2072 y(mak)o(es)17 b(it)h(p)q(ossible)g
(to)g(write)g Fr(<f)k(~)l(\(lift)f(g)g(y\))h(z>)17 b
Fx(rather)1020 2114 y(than)d Fr(<f)22 b(~)l(\(lift)e(\(g)i(y\)\))f(z>)p
Fx(.)1020 2233 y Fy(6)52 b(Hand-Staging:)26 b(A)17 b(Short)g(Example)
1020 2315 y Fx(Using)f(MetaML,)g(the)h(programer)e(can)h(stage)h
(programs)d(b)o(y)1020 2357 y(inserting)i(the)g(prop)q(er)h
(annotations)e(at)h(the)g(righ)o(t)f(places)i(in)1020
2399 y(the)f(program.)22 b(The)16 b(programmer)e(uses)j(these)g
(annotations)1020 2440 y(to)i(mo)q(dify)e(the)i(default)g(\(strict\))h
(ev)n(aluation)e(order)h(of)g(the)1020 2482 y(program.)1076
2523 y(In)11 b(our)g(exp)q(erience,)j(starting)d(with)g(the)g(t)o(yp)q
(e)h(of)e(the)i(func-)1020 2565 y(tion)17 b(to)g(b)q(e)g(hand-staged)h
(mak)o(es)e(the)h(n)o(um)o(b)q(er)g(of)f(di\013eren)o(t)1020
2606 y(w)o(a)o(ys)11 b(in)g(whic)o(h)h(it)f(can)h(b)q(e)g(annotated)g
(quite)g(tractable.)17 b(This)p eop
%%Page: 4 4
4 3 bop -76 -34 a Fx(leads)14 b(us)h(to)e(b)q(eliev)o(e)i(that)f(the)g
(lo)q(cation)f(of)g(the)i(annotations)-76 7 y(in)k(a)f(staged)i(v)o
(ersion)f(of)f(a)h(program)f(is)g(signi\014can)o(tly)g(con-)-76
49 y(strained)12 b(b)o(y)f(its)g(t)o(yp)q(e.)18 b(F)m(or)11
b(example,)f(consider)i(the)g(function)-76 90 y Fr(member)h
Fx(de\014ned)i(as:)-76 168 y Fr(\(*)22 b(member)e(:)i(int)f(->)g(int)g
(list)g(->)h(bool)f(*\))-76 209 y(fun)g(member)g(v)g(l)h(=)-76
251 y(if)g(\(null)e(l\))-10 292 y(then)h(false)-10 334
y(else)g(if)g(v=\(hd)g(l\))99 375 y(then)f(true)99 417
y(else)g(member)h(v)h(\(tl)f(l\);)-20 495 y Fx(The)12
b(function)f Fr(member)g Fx(has)g(t)o(yp)q(e)h Fr(int)21
b(->)h(List)f(int)g(->)-76 541 y(bool)22 526 y Fu(2)41
541 y Fx(.)c(A)11 b(go)q(o)q(d)f(strategy)i(for)f(hand)f(annotating)g
(a)h(program)-76 582 y(is)16 b(to)g(\014rst)g(determine)g(the)g(target)
h(t)o(yp)q(e)f(of)f(the)i(desired)g(an-)-76 624 y(notated)f(program.)23
b(In)16 b(the)g Fr(member)f Fx(example,)g(the)h(list)g(pa-)-76
665 y(rameter)c Fr(l)f Fx(is)h(a)o(v)n(ailable)d(in)i(the)i(\014rst)f
(stage,)g(and)g(the)g(elemen)o(t)-76 707 y(searc)o(hed)k(for)d(will)f
(b)q(e)j(a)o(v)n(ailable)c(later.)18 b(So,)c(one)g(target)g(t)o(yp)q(e)
-76 748 y(for)i(the)g(hand-staged)g(function)g(is)f Fr(<int,'a>->)20
b(List)h(int)-76 790 y(->)h(<bool,'a>)d Fx(.)-20 831
y(No)o(w)9 b(w)o(e)h(can)f(b)q(egin)g(annotating,)g(starting)g(with)g
(the)h(whole)-76 873 y(expression,)18 b(and)e(w)o(ork)g(in)o(w)o(ards)g
(un)o(til)f(all)g(sub-expressions)-76 914 y(are)k(co)o(v)o(ered.)32
b(A)o(t)18 b(eac)o(h)h(step,)g(w)o(e)g(consider)g(what)f(annota-)-76
956 y(tions)f(will)f(\\\014x")h(the)h(t)o(yp)q(e)f(of)g(the)h
(expression)g(so)f(that)h(the)-76 997 y(whole)c(function)f(has)h(a)g(t)
o(yp)q(e)g(closer)h(to)f(the)g(target)h(t)o(yp)q(e.)-20
1039 y(The)g(follo)o(wing)c(function)i(realizes)i(this)f(t)o(yp)q(e:)
-76 1116 y Fr(\(*)22 b(member)e(:)i(<int,'a>)e(->)h(int)g(list)g(->)h
(<bool,'a>)e(*\))-76 1158 y(fun)h(member)g(v)g(l)h(=)-10
1199 y(if)f(\(null)g(l\))55 1241 y(then)g(<false>)55
1282 y(else)g(<if)g(~v=~\(lift)f(hd)h(l\))251 1324 y(then)g(true)251
1365 y(else)g(~\(member)f(v)i(\(tl)f(l\)\)>;)-76 1443
y Fx(In)c(this)f(example,)g(and)g(others,)i(when)f(giving)e(the)j(t)o
(yp)q(es)f(of)-76 1485 y(functions)i(in)f(commen)o(ts,)g(w)o(e)g(write)
h Fr(<int>)f Fx(for)g Fr(<int,'a>)-76 1526 y Fx(and)c
Fr(<<int>>)e Fx(for)i Fr(<<int,'a>,'b>)d Fx(\(and)j(so)g(on\))g(when)h
(the)-76 1568 y(con)o(text)h(of)e(the)i(co)q(de)g(t)o(yp)q(es)g(is)f
(completely)f(unconstrained.)-76 1609 y(The)e(annotation)f
Fr(~)l(\(lift)21 b(hd)g(l\))11 b Fx(is)h(used)g(rather)h(than)e
Fr(hd)22 b(l)-76 1651 y Fx(in)13 b(order)h(to)g(ensure)h(that)f
Fr(hd)f Fx(is)g(p)q(erformed)g(during)g(the)i(\014rst)-76
1692 y(stage.)24 b(Otherwise,)17 b(all)e(selections)h(of)g(the)g(head)g
(elemen)o(t)f(of)-76 1734 y(the)20 b(list)f(w)o(ould)g(ha)o(v)o(e)g(b)q
(een)i(dela)o(y)o(ed)e(un)o(til)g(the)h(co)q(de)g(con-)-76
1775 y(structed)c(w)o(as)e Fr(run)f Fx(in)g(a)h(later)g(stage.)-20
1817 y(The)i(meta-brac)o(k)o(ets)f(around)h(the)g(branc)o(hes)h(of)e
(the)h(out-)-76 1858 y(ermost)k Fr(if)o Fx(-expression)i(ensure)f(that)
f(the)h(return)h(v)n(alue)d(of)-76 1900 y Fr(member)10
b Fx(will)g(b)q(e)j(a)e Fr(<?,?>)p Fx(.)16 b(The)c(\014rst)g(branc)o(h)
g(\()p Fr(false)o Fx(\))g(needs)-76 1941 y(no)f(further)h(annotations,)
f(and)f(mak)o(es)g(the)i(return)g(v)n(alue)f(pre-)-76
1983 y(cisely)i(a)f Fr(<bool,'a>)p Fx(.)j(Mo)o(ving)d(in)o(w)o(ards)g
(in)f(the)i(else)g(branc)o(h,)-76 2024 y(the)k(condition)f(of)g(the)h
(inner)f Fr(if)p Fx(-expression)i(\(in)e(particular)-75
2066 y Fr(~)l(v)o Fx(\))21 b(forces)g(the)g(t)o(yp)q(e)g(of)f(the)h
Fr(v)f Fx(parameter)g(to)h(ha)o(v)o(e)f(t)o(yp)q(e)-76
2107 y Fr(<int,'a>)12 b Fx(as)i(planned.)-20 2149 y(Just)h(lik)o(e)f
(the)h(\014rst)g(branc)o(h)g(of)f(the)h(outer)g Fr(if)o
Fx(-statemen)o(t,)-76 2190 y(the)g(whole)f(of)g(the)h(inner)f
Fr(if)p Fx(-statemen)o(t)g(m)o(ust)f(return)j Fr(bool)p
Fx(.)-76 2232 y(So,)21 b(the)g(\014rst)g(branc)o(h)f(\()p
Fr(true)o Fx(\))g(is)g(\014ne.)37 b(But)21 b(b)q(ecause)h(the)-76
2273 y(recursiv)o(e)d(call)e(to)h Fr(member)f Fx(has)g(t)o(yp)q(e)i
Fr(<bool,'a>)p Fx(,)d(it)h(m)o(ust)-76 2315 y(b)q(e)f(escap)q(ed.)23
b(Inserting)16 b(this)f(escap)q(e)i(also)d(implies)g(that)h(the)-76
2356 y(recursion)22 b(will)d(b)q(e)j(p)q(erformed)e(in)g(the)i(\014rst)
f(stage,)h(whic)o(h)-76 2398 y(is)f(exactly)h(the)g(desired)g(b)q(eha)o
(vior.)40 b(Th)o(us,)23 b(the)f(result)g(of)-76 2439
y(the)14 b(staged)f Fr(member)f Fx(function)h(is)g(a)f(recursiv)o
(ely-constructed)-76 2481 y(piece)j(of)e(co)q(de)i(with)e(t)o(yp)q(e)i
Fr(bool)p Fx(.)-20 2522 y(Ev)n(aluating)8 b Fr(<fn)21
b(x)h(=>)g(~)-5 b(\(member)21 b(<x)o(>)h([1,2,3]\))n(>)9
b Fx(yields:)p -76 2552 399 2 v -32 2577 a Fq(2)-16 2589
y Fu(F)m(unction)k(\\)p Fn(=)p Fu(")e(has)h(t)o(yp)q(e)g
Fn(\(int)17 b(*)f(int\))h(->)g(bool)c Fu(whic)o(h)g(forces)e
Fn(v)h Fu(and)g Fn(l)-76 2622 y Fu(to)f(ha)o(v)o(e)g(t)o(yp)q(es)h
Fn(int)h Fu(and)e Fn(List)17 b(int)p Fu(,)c(resp)q(ectiv)o(ely)m(.)1020
-34 y Fr(<fn)21 b(d1)h(=>)1107 7 y(if)g(d1)f(\045=)g(1)1173
49 y(then)g(true)1173 90 y(else)g(if)g(d1)g(\045=)h(2)1347
132 y(then)f(true)1347 173 y(else)g(if)g(d1)h(\045=)f(3)1521
215 y(then)g(true)1521 256 y(else)g(false>)1076 328 y
Fx(The)13 b(p)q(ercen)o(tage)h(sign)e(\()p Fr(\045)p
Fx(\))h(at)f(the)h(b)q(eginning)e(of)h(an)g(iden-)1020
369 y(ti\014er)h(indicates)g(that)f(it)g(w)o(as)h(b)q(ound)f(to)h(a)f
(v)n(alue)g(in)g(the)h(en)o(vi-)1020 411 y(ronmen)o(t)f(in)h(whic)o(h)f
(the)i(co)q(de)g(w)o(as)e(constructed.)20 b(Its)14 b(precise)1020
452 y(meaning)e(will)h(b)q(e)h(explained)g(in)f(Sections)i(7)e(and)h
(10.2.)1020 571 y Fy(7)52 b(The)18 b(Design)g(of)g(MetaML)1020
654 y Fx(MetaML)h(w)o(as)g(designed)g(as)g(a)g(statically-t)o(yp)q(ed)f
(program-)1020 695 y(ming)e(language,)j(and)f(not)h(as)f(an)h(in)o
(ternal)f(represen)o(tation)1020 737 y(for)11 b(a)h(m)o(ulti-stage)e
(system.)17 b(Our)12 b(primary)e(goals)h(w)o(ere:)18
b(\014rst,)1020 778 y(it)9 b(should)g(b)q(e)h(easy)g(to)f(write)h(m)o
(ulti-staged)e(programs,)g(second)1020 820 y(it)15 b(should)f(b)q(e)i
(as)f(\015exible)g(as)g(p)q(ossible,)g(and)g(third)g(it)f(should)1020
861 y(ensure)g(that)f(only)f(\\reasonable)g(things")h(can)f(b)q(e)i
(done)f(using)1020 903 y(the)19 b(annotations.)30 b(Therefore,)20
b(our)f(design)f(c)o(hoices)h(where)1020 944 y(di\013eren)o(t)f(from)d
(those)i(of)f(other)i(m)o(ulti-stage)d(systems)i(suc)o(h)1020
986 y(as)f(Nielson)g(&)h(Nielson,)f(Hatcli\013)g(&)g(Gl)q(\177)-22
b(uc)o(k,)16 b(and)g(Da)o(vies)g(&)1020 1027 y(Pfenning.)h(In)c
(particular,)e(w)o(e)i(consider)g(the)g(follo)o(wing)c(qual-)1020
1069 y(it)o(y)k(crucial)h(to)g(MetaML:)1020 1169 y Fy(Cross-stage)22
b(P)o(ersistence:)41 b Fw(A)18 b(variable)g Ft(i)h Fw(b)n(ound)g(in)
1020 1210 y(stage)d Ft(n)p Fw(,)g(wil)r(l)e(b)n(e)i(available)g(in)g
(stages)g Ft(n)p Fw(,)g Ft(n)10 b Fx(+)g(1)15 b Fw(and)i(al)r(l)e(fu-)
1020 1252 y(tur)n(e)f(stages)p Fx(.)1076 1335 y(T)m(o)20
b(the)h(user,)i(this)d(means)g(the)h(abilit)o(y)e(to)i(stage)g(non-)
1020 1376 y(closed)10 b(expressions.)18 b(Non-closed)10
b(expressions,)h(lik)o(e)d Ft(\025)p Fx(-abstractions)1020
1418 y(with)15 b(free)h(v)n(ariables,)e(m)o(ust)g(resolv)o(e)i(their)f
(free)h(v)n(ariable)e(o)q(c-)1020 1459 y(currences)23
b(in)d(the)h(static)g(en)o(vironmen)o(t)f(where)h(the)h(meta-)1020
1501 y(brac)o(k)o(eted)c(expression)g(o)q(ccurs.)27 b(One)17
b(can)g(think)f(of)g(a)g(co)q(de)1020 1542 y(v)n(alue)c(as)g(con)o
(taining)f(an)h(en)o(vironmen)o(t)f(whic)o(h)h(binds)g(its)g(free)1020
1584 y(v)n(ariables.)17 b(F)m(or)d(example)e(the)j(expression,)1224
1662 y Fr(let)21 b(val)g(a=1+4)g(in)g(<72+a>)g(end)1020
1741 y Fx(returns)14 b(a)e(v)n(alue)g Fr(<72+\045a>)o
Fx(.)17 b(The)c(\045)f(sign)g(indicates)h(that)g(the)1020
1783 y(free)e(v)n(ariable)e Fr(a)h Fx(is)g(b)q(ound)g(in)g(the)g(v)n
(alue's)g(lo)q(cal)f(en)o(vironmen)o(t.)1020 1824 y(The)16
b(\045)f(sign)h(is)f(prin)o(ted)h(b)o(y)g(the)g(displa)o(y)f(mec)o
(hanism.)21 b(The)1020 1866 y(v)n(ariable)13 b Fr(a)h
Fx(has)g(b)q(een)h(b)q(ound)f(during)g(the)h(\014rst)f(stage)h(to)f
(the)1020 1907 y(constan)o(t)e(5.)17 b(In)11 b(fact,)h(in)f(MetaML)h
Fr(\045a)f Fx(is)g(not)g(a)h(v)n(ariable,)e(but)1020
1949 y(rather,)i(a)e(new)i Fw(c)n(onstant)p Fx(,)f(and)g(the)g(name)f
(\\)p Fr(a)p Fx(")g(is)h(only)f(hin)o(t)g(to)1020 1990
y(the)h(user)g(ab)q(out)f(where)h(this)g(constan)o(t)f(originated.)16
b(When)11 b Fr(\045a)1020 2032 y Fx(is)g(ev)n(aluated)f(in)g(a)g(later)
h(stage,)g(it)g(will)e(return)j(5)e(indep)q(enden)o(t)1020
2073 y(of)g(the)h(binding)e(for)h(the)h(v)n(ariable)e
Fr(a)h Fx(in)g(the)h(new)f(con)o(text)h(since)1020 2115
y(it)j(is)g(b)q(ound)g(in)g(the)h(v)n(alue's)f(lo)q(cal)f(en)o
(vironmen)o(t.)18 b(Arbitrary)1020 2156 y(v)n(alues)f(\(including)g
(functions\))g(can)h(b)q(e)g(dela)o(y)o(ed)f(using)g(this)1020
2198 y(h)o(ygienic)c(binding)g(mec)o(hanism.)1076 2239
y(Sp)q(ecifying)g(this)h(b)q(eha)o(vior)f(turns)i(out)f(to)f(b)q(e)h
(non-trivial.)1020 2281 y(In)20 b(an)g(in)o(terpreter)i(for)e(a)g(m)o
(ulti-stage)e(language,)j(this)f(re-)1020 2323 y(quiremen)o(t)15
b(manifests)g(itself)h(as)g(complex)e(v)n(ariable-binding)1020
2364 y(rules,)g(the)h(use)g(of)f(closures,)h(or)f(capture-free)i
(substitutions.)1020 2406 y(Our)k(seman)o(tics)f(addresses)j(this)e(in)
f(a)g(rather)h(unique)g(w)o(a)o(y)1020 2447 y(\(See)15
b(Section)f(10.2\).)1076 2489 y(Cross-Stage)g(P)o(ersistence)i(p)q
(oses)f(a)e(problem)f(when)h(stag-)1020 2530 y(ing)18
b(is)g(used)i(for)e(program)e(generation.)32 b(If)19
b(the)g(\014rst)g(stage)1020 2572 y(is)d(p)q(erformed)h(on)f(one)h
(computer,)f(and)h(the)g(second)g(on)g(an-)1020 2613
y(other,)d(w)o(e)g(m)o(ust)f(\\p)q(ort")g(the)i(lo)q(cal)e(en)o
(vironmen)o(ts)g(from)f(the)p eop
%%Page: 5 5
5 4 bop -76 -34 a Fx(\014rst)20 b(mac)o(hine)f(to)g(the)h(second.)36
b(Since)20 b(arbitrary)g(ob)r(jects,)-76 7 y(suc)o(h)14
b(as)g(functions,)f(closures,)h(can)f(b)q(e)h(b)q(ound)g(in)f(these)h
(lo)q(cal)-76 49 y(en)o(vironmen)o(ts)k(this)h(can)g(b)q(ecome)g(a)f
(problem.)32 b(Curren)o(tly)m(,)-76 90 y(MetaML)11 b(assumes)g(that)f
(the)h(computing)e(en)o(vironmen)o(t)h(do)q(es)-76 132
y(not)20 b(c)o(hange)f(b)q(et)o(w)o(een)i(stages.)36
b(This)19 b(is)g(part)h(of)f(what)g(w)o(e)-76 173 y(mean)13
b(b)o(y)h(ha)o(ving)e(an)i(in)o(tegrated)g(system.)-20
215 y(Cross-Stage)j(P)o(ersistence)j(can)c(b)q(e)h(relaxed)g(b)o(y)g
(allo)o(wing)-76 256 y(v)n(ariables)k(to)g(b)q(e)g(a)o(v)n(ailable)e
(at)i(exactly)h(one)f(stage.)40 b(This)-76 298 y(seems)12
b(to)f(ha)o(v)o(e)g(b)q(een)h(the)g(case)h(in)e(all)f(m)o(ulti-stage)f
(languages)-76 339 y(kno)o(wn)17 b(to)f(us)h(to)g(date)g([25)o(,)f(12,)
g(7,)g(6].)26 b(The)17 b(primary)e(di\016-)-76 381 y(cult)o(y)c(in)f
(implemen)o(ting)e(p)q(ersistence)14 b(is)c(the)i(prop)q(er)g(h)o
(ygienic)-76 422 y(treatmen)o(t)e(of)g(free)h(v)n(ariables.)17
b(W)m(e)10 b(will)f(sho)o(w)h(ho)o(w)g(this)g(prob-)-76
464 y(lem)f(can)i(b)q(e)h(solv)o(ed,)e(th)o(us)h(allo)o(wing)e(the)i
(user)h(to)f(stage)g(signif-)-76 505 y(ican)o(tly)i(more)g(expressions)
j(than)d(w)o(as)h(previously)g(p)q(ossible.)-20 547 y(But)f(ev)o(en)g
(in)e(MetaML,)h(it)g(will)f(not)h(b)q(e)h(p)q(ossible)f(to)g(stage)-76
588 y(ev)o(ery)f(expression)g(in)f(the)g(language.)16
b(In)10 b(particular,)g(w)o(e)g(m)o(ust)-76 630 y(ensure)j(that)e(the)h
(user)g(can)f(only)g(sp)q(ecify)h(computations)d(that)-76
671 y(resp)q(ect)16 b(the)f(follo)o(wing)c(condition:)-76
771 y Fy(Cross-Stage)h(Safet)o(y:)42 b Fw(A)o(n)10 b(input)h(\014rst)f
(available)h(at)g(stage)-76 812 y Ft(m)k Fw(c)n(annot)h(b)n(e)f(use)n
(d)g(at)g(a)g(stage)g Ft(n)g Fw(if)f Ft(m)e(>)g(n)p Fx(.)-20
895 y(The)i(problem)d(arises)j(with)e(the)i(use)g(of)e(the)h(escap)q(e)
i(anno-)-76 937 y(tation.)j(In)13 b(particular,)h(consider)g(the)h
(expression)162 1016 y Fr(fn)22 b(a)f(=>)h(<fn)f(b)h(=>)g(~)-5
b(\(a+b\))o(>)-76 1095 y Fx(whic)o(h)14 b(is)g(an)g(\(incorrectly\))h
(staged)f(v)o(ersion)h(of)e(the)i(function)-76 1136 y
Ft(\025a:\025b:a)q Fx(+)q Ft(b)p Fx(.)i(Op)q(erationally)m(,)9
b(the)i(annotations)e(require)i(com-)-76 1178 y(puting)g
Fr(a+b)g Fx(in)g(the)h(\014rst)g(stage,)g(while)f(the)h(v)n(alue)f(of)g
Fr(b)g Fx(will)f(b)q(e)-76 1219 y(a)o(v)n(ailable)d(only)i(in)g(the)h
(second)h(stage!)17 b(Therefore,)11 b(MetaML's)-76 1261
y(t)o(yp)q(e)20 b(system)f(w)o(as)h(designed)g(to)f(ensure)i(that)f
(\\w)o(ell-t)o(yp)q(ed)-76 1302 y(programs)12 b(w)o(on't)h(go)g
(wrong",)g(where)h(going)f(wrong)g(no)o(w)g(in-)-76 1344
y(cludes)i(the)g(violation)d(of)i(the)h(cross-stage)g(safet)o(y)g
(condition,)-76 1385 y(as)d(w)o(ell)g(as)g(the)h(standard)f(notions)g
(of)g(\\going)e(wrong")i([22)o(])g(in)-76 1427 y(statically-t)o(yp)q
(ed)i(languages.)-20 1468 y(In)i(our)f(exp)q(erience)j(with)d(the)h
(language,)e(ha)o(ving)h(a)g(t)o(yp)q(e)-76 1510 y(system)h(to)g
(screen-out)j(programs)c(con)o(taining)g(this)h(kind)g(of)-76
1551 y(error)f(is)f(a)f(signi\014can)o(t)h(aid)f(in)g(hand-staging)g
(programs.)-76 1670 y Fy(8)53 b(Isomorphism)16 b(for)h(Co)q(de)g(T)o
(yp)q(es)-76 1753 y Fx(Recall)9 b(the)h(t)o(yp)q(es)g(of)e(the)i
(staged)g Fr(member)e Fx(function:)15 b Fr(<int,'a>)-76
1795 y(->)22 b(List)f(int)g(->)g(<bool,'a>)p Fx(,)11
b(and)j(the)g(t)o(yp)q(e)g(of)f(the)h(term)-76 1836 y
Fr(<fn)21 b(x)h(=>)43 b(\(member)20 b(<x>)i([1,2,3]\)>)7
b Fx(whic)o(h)i(is:)16 b Fr(<int,'a>)-76 1878 y(->)22
b(bool)p Fx(.)28 b(This)18 b(suggests)h(that)f(a)f(function)h(from)e
(co)q(de)j(to)-76 1919 y(co)q(de)c(can)f(b)q(e)g(turned)h(in)o(to)e
(the)i(co)q(de)f(of)g(a)f(function.)18 b(This)c(is)-76
1961 y(imp)q(ortan)o(t)c(to)h(users)i(b)q(ecause)g Fr(<alpha,'a>)20
b(->)h(<beta,'a>)-76 2002 y Fx(is)15 b(a)g(function)g(and)g(cannot)g(b)
q(e)h(prin)o(ted)g(or)f(observ)o(ed,)h(while)-76 2044
y Fr(<alpha)21 b(->)g(beta,'a>)12 b Fx(is)i(a)g(represen)o(tation)h(of)
f(a)f(function,)-76 2085 y(and)k(can)h(b)q(e)g(prin)o(ted)g(and)f
(observ)o(ed.)30 b(W)m(e)17 b(can)g(de\014ne)i(t)o(w)o(o)-76
2127 y(functions)14 b(to)g(con)o(v)o(ert)g(b)q(et)o(w)o(een)i(these)f
(t)o(w)o(o)e(t)o(yp)q(es:)-76 2206 y Fr(\(*)43 b(back:)21
b(<'A,'c>)f(->)i('<B,'c>)42 b(->)21 b(<\('A)g(->)h('B\),'c>)e(*\))-76
2248 y(fun)h(back)g(f)h(=)f(<fn)h(x)f(=>)h(~\(f)f(<x>\)>;)-76
2331 y(\(*)43 b(forth:)21 b(<\('A)g(->)g('B\),'c>)g(->)g(\(<'A,'c>)f
(->)h(<'B,'c>\))g(*\))-76 2372 y(fun)g(forth)g(f)h(x)f(=)h(<~f)f(~x>;)
-76 2452 y Fx(Here)h(w)o(e)e(use)h(capitalized)f(t)o(yp)q(e)h(v)n
(ariables)f(to)g(distinguish)-76 2494 y(the)f(t)o(yp)q(e)g(in)e(the)i
(co)q(de)g(from)d(the)j(con)o(text)g(the)f(co)q(de)h(m)o(ust)-76
2535 y(ev)n(aluate)14 b(in.)-20 2577 y(The)i(con)o(v)o(ersion)g(is)g
(not)f(b)q(et)o(w)o(een)j(syn)o(tactic)e(forms,)e(but)-76
2618 y(seman)o(tic)d(v)n(alues.)17 b(F)m(or)12 b(example,)e(the)j(co)q
(de)g(pro)q(duced)g(b)o(y)f(an)1020 -34 y(application)c(of)i
Fr(back)e Fx(is)i(in)f(a)h(language)f(extended)i(with)e(a)h(new)1020
7 y(construct)i(that)e(allo)o(ws)e(us)j(to)e(em)o(b)q(ed)h(an)o(y)f(v)n
(alue)h(in)o(to)f(syn)o(tax,)1020 49 y(without)i(needing)h(to)f(kno)o
(w)g(ab)q(out)g(its)g(in)o(ten)o(tional)f(represen-)1020
90 y(tation.)16 b(Th)o(us,)11 b(w)o(e)f(are)g(really)f(not)h(con)o(v)o
(erting)g(functions)g(in)o(to)1020 132 y(source)16 b(co)q(de,)g(but)f
(rather,)h(returning)f(syn)o(tax)g(that)g(denotes)1020
173 y(this)h(function)g(under)h(our)f(seman)o(tics.)25
b(Under)17 b(this)f(pro)o(viso)1020 215 y(\(and)h(disregarding)g
(termination)e(issues\))j(the)g(comp)q(osition)1020 256
y(of)e(these)j(t)o(w)o(o)d(functions)h(is)g(iden)o(tit)o(y)g(under)g
(MetaML's)h(se-)1020 298 y(man)o(tics)c(\(see)j(Section)e(10\).)22
b(They)16 b(de\014ne)g(an)f(isomorphism)1020 339 y(b)q(et)o(w)o(een)k
(v)n(alues)d(of)h(t)o(yp)q(e)h Fr(<A,'c>)i(->)i(<B,'c>)15
b Fx(and)i Fr(<A)22 b(->)1020 381 y(B,'c>)p Fx(.)17 b([3)o(].)1076
422 y(W)m(e)c(note)i(that)e Fr(back)g Fx(and)h Fr(forth)e
Fx(co)q(oresp)q(ond)j(to)f(2-lev)o(el)1020 464 y(eta-expansion)19
b(whic)o(h)g(Dan)o(vy)g(\014nds)g(to)g(b)q(e)h(an)f(imp)q(ortan)o(t)
1020 505 y(elemen)o(t)13 b(in)h(partial)f(ev)n(aluation[5)n(].)1076
547 y(This)f(isomorphism)d(can)j(also)f(b)q(e)i(view)o(ed)f(as)g(a)f
(formaliza-)1020 588 y(tion)17 b(of)f(the)i(in)o(tuitiv)o(e)e(equiv)n
(alence)i(of)e(a)h(sym)o(b)q(olic)e(ev)n(alua-)1020 630
y(tor)e([23)o(])g Fr(<A,'c>)21 b(->)g(<B,'c>)12 b Fx(and)h(the)h(syn)o
(tactic)g(represen-)1020 671 y(tation)j(of)h(a)f(function)h
Fr(<A)j(->)g(B,'c>)p Fx(.)29 b(It)18 b(seems)g(that)g(this)1020
713 y(isomorphism,)e(whic)o(h)i(MetaML)h(has)f(allo)o(w)o(ed)f(us)i(to)
f(mak)o(e)1020 754 y(concrete,)h(is)e(at)f(the)i(heart)f(of)f(concise)i
(reduction)g(systems,)1020 796 y(suc)o(h)d(as)f(Dan)o(vy's)e(t)o(yp)q
(e-directed)k(partial)d(ev)n(aluator)g([4)o(])g(and)1020
837 y(its)g(extensions)h([27)o(].)k(Under)c(MetaML's)f(seman)o(tics,)g
(w)o(e)g(can)1020 879 y(switc)o(h)g(b)q(et)o(w)o(een)g(the)g(t)o(w)o(o)
f(t)o(yp)q(es)h(without)f(needing)g(to)g(w)o(orry)1020
920 y(ab)q(out)i(substitution)g(or)g(v)n(ariable)f(capture.)1076
962 y(This)21 b(has)g(profound)g(implications)d(for)j(the)h(writing)e
(of)1020 1003 y(staged)15 b(functions.)21 b(In)15 b(our)f(exp)q
(erience)j(annotating)d(a)g(func-)1020 1045 y(tion)i(to)g(ha)o(v)o(e)h
(t)o(yp)q(e)g Fr(<A,'c>)j(->)i(<B,'c>)15 b Fx(requires)i(less)h(an-)
1020 1086 y(notations)11 b(than)h(annotating)f(it)h(to)f(ha)o(v)o(e)h
(t)o(yp)q(e)h Fr(<A)21 b(->)g(B,'c>)1020 1128 y Fx(and)11
b(is)h(often)g(easier)g(to)f(think)h(ab)q(out.)17 b(Because)c(w)o(e)f
(are)g(more)1020 1169 y(used)g(to)e(reasoning)h(ab)q(out)f(functions,)h
(this)g(leads)g(us)g(to)g(a)o(v)o(oid)1020 1211 y(creating)20
b(functions)g(of)f(the)h(latter)g(kind)g(except)h(when)f(w)o(e)1020
1253 y(need)15 b(to)f(insp)q(ect)h(the)f(co)q(de.)1076
1294 y(The)c(t)o(yp)q(e)h(of)e Fr(back)g Fx(is)h(one)g(of)g(the)g
(axioms)e(of)h(the)i(logic)e(sys-)1020 1336 y(tem)f(motiv)n(ating)f
(the)i(t)o(yp)q(e)h(system)f(of)g(Da)o(vies)g([6)o(].)16
b(MetaML's)1020 1377 y(t)o(yp)q(e)h(system)f(w)o(as)g(motiv)n(ated)f
(purely)h(b)o(y)g(op)q(erational)g(rea-)1020 1419 y(sons.)33
b(A)o(t)19 b(the)g(same)f(time,)h(it)f(is)h(imp)q(ortan)o(t)e(for)h
(the)h(pro-)1020 1460 y(grammer)11 b(to)j(ha)o(v)o(e)g(b)q(oth)g(co)q
(ercions,)g(thereb)o(y)h(b)q(eing)f(able)f(to)1020 1502
y(switc)o(h)e(bac)o(k)f(and)g(forth)g(b)q(et)o(w)o(een)i(the)f(t)o(w)o
(o)f(isomorphic)e(t)o(yp)q(es)1020 1543 y(as)14 b(the)h(need)f(arises.)
1076 1585 y(This)22 b(b)q(ecomes)g(ev)o(en)h(more)d(imp)q(ortan)o(t)h
(when)h(writing)1020 1626 y(programs)e(with)i(more)f(than)g(t)o(w)o(o)g
(stages.)43 b(Consider)22 b(the)1020 1668 y(function:)1020
1733 y Fr(fun)f(back2)g(f)h(=)f(<fn)g(x)h(=>)f(<fn)g(y)h(=>)f(~~\(f)g
(<x>)h(<<y>>\)>>;)1020 1775 y(back2)f(:)g(\(<a>)g(->)h(<<b>>)e(->)i
(<<c>>\))e(->)i(<a)f(->)h(<b)f(->)g(c>>)1020 1841 y Fx(This)d(allo)o
(ws)f(us)h(to)g(write)h(a)e(program)g(whic)o(h)h(tak)o(es)g(a)g
Fr(<a>)1020 1882 y Fx(and)12 b(a)h Fr(<<b>>)e Fx(as)i(argumen)o(ts)e
(and)i(whic)o(h)f(pro)q(duces)i(a)e Fr(<<c>>)1020 1924
y Fx(and)f(stage)h(it)g(in)o(to)f(a)g(three-stage)i(function.)k(Our)12
b(exp)q(erience)1020 1965 y(is)j(that)h(suc)o(h)g(functions)f(ha)o(v)o
(e)g(considerably)h(few)o(er)g(annota-)1020 2007 y(tions,)e(and)h(are)g
(easier)g(to)f(think)h(ab)q(out.)20 b(W)m(e)14 b(illustrate)g(this)1020
2048 y(in)f(the)i(next)f(section.)1020 2166 y Fy(9)52
b(A)17 b(Multi-Stage)j(Example)1020 2249 y Fx(When)c(information)d
(arriv)o(es)j(in)f(m)o(ultiple)e(phases)k(it)f(is)f(p)q(os-)1020
2290 y(sible)j(to)f(tak)o(e)h(adv)n(an)o(tage)f(of)g(this)h(fact)g(to)f
(get)h(b)q(etter)i(p)q(er-)1020 2332 y(formance.)30 b(Consider)19
b(a)f(generic)h(function)f(for)g(computing)1020 2373
y(the)d(inner)g(pro)q(duct)g(of)f(t)o(w)o(o)g(v)o(ectors.)21
b(In)14 b(the)i(\014rst)f(stage)g(the)1020 2415 y(arriv)n(al)g(of)h
(the)i(size)f(of)f(the)i(v)o(ectors)f(o\013ers)h(an)f(opp)q(ortunit)o
(y)1020 2456 y(to)i(sp)q(ecialize)h(the)g(inner)f(pro)q(duct)h
(function)f(on)g(that)g(size,)1020 2498 y(remo)o(ving)13
b(the)i(o)o(v)o(erhead)g(of)f(lo)q(oping)f(o)o(v)o(er)i(the)g(b)q(o)q
(dy)g(of)f(the)1020 2539 y(computation)k Ft(n)h Fx(times.)35
b(The)20 b(arriv)n(al)e(of)h(the)h(\014rst)h(v)o(ector)1020
2581 y(a\013ords)c(a)g(second)h(opp)q(ortunit)o(y)e(for)h(sp)q
(ecialization.)26 b(If)17 b(the)1020 2622 y(inner)d(pro)q(duct)h(of)e
(that)h(v)o(ector)h(is)f(to)g(b)q(e)g(tak)o(en)g(man)o(y)e(times)p
eop
%%Page: 6 6
6 5 bop -76 -34 a Fx(with)11 b(other)h(v)o(ectors)g(it)f(can)h(b)q(e)f
(sp)q(ecialized)h(b)o(y)f(remo)o(ving)f(the)-76 7 y(o)o(v)o(erhead)16
b(of)f(lo)q(oking)e(up)j(the)g(elemen)o(ts)f(of)g(the)g(\014rst)i(v)o
(ector)-76 49 y(eac)o(h)12 b(time.)k(This)c(is)g(exactly)f(the)i(case)f
(when)h(computing)d(the)-76 90 y(m)o(ultiplication)j(of)i(2)h
(matrixes.)23 b(F)m(or)15 b(eac)o(h)i(ro)o(w)f(in)f(the)i(\014rst)-76
132 y(matrix,)f(the)i(dot)f(pro)q(duct)h(of)f(that)g(ro)o(w)g(will)f(b)
q(e)h(tak)o(en)h(for)-76 173 y(eac)o(h)c(column)d(of)h(the)h(second.)19
b(This)13 b(example)e(has)i(app)q(eared)-76 215 y(in)k(sev)o(eral)g
(other)h(w)o(orks)f([9,)f(20])g(and)h(w)o(e)h(giv)o(e)e(our)h(v)o
(ersion)-76 256 y(b)q(elo)o(w:)-20 298 y(Belo)o(w)i(w)o(e)g(giv)o(e)g
(three)h(v)o(ersions)f(of)g(the)g(inner)g(pro)q(duct)-76
339 y(function.)39 b(One)21 b(\()p Fr(iprod)p Fx(\))f(with)h(no)f
(staging)g(annotations,)-76 381 y(the)12 b(second)g(\()p
Fr(iprod2)p Fx(\))e(with)h(t)o(w)o(o)f(lev)o(els)i(of)e(annotations,)h
(and)-76 422 y(the)18 b(third)f(\()p Fr(iprod3)p Fx(\))f(with)g(t)o(w)o
(o)h(lev)o(els)g(of)f(annotations)g(but)-76 464 y(constructed)k(with)d
(the)i Fr(back2)d Fx(function.)29 b(In)18 b(MetaML)g(w)o(e)-76
505 y(quote)c(relational)e(op)q(erators)j(in)o(v)o(olving)c
Fr(<)i Fx(and)g Fr(>)h Fx(b)q(ecause)h(of)-76 547 y(the)g(p)q(ossible)f
(confusion)f(with)h(meta-brac)o(k)o(ets.)-76 618 y Fr(\(*)22
b(iprod)e(:)i(int)f(->)g(Vector)g(->)g(Vector)g(->)g(int)g(*\))-76
660 y(fun)g(iprod)g(n)h(v)f(w)h(=)-32 701 y(if)f(n)44
b('>')e(0)33 743 y(then)21 b(\(\(nth)g(v)g(n\))h(*)f(\(nth)g(w)h(n\)\))
f(+)h(\(iprod)e(\(n-1\))h(v)h(w\))33 784 y(else)f(0;)-76
867 y(\(*)h(iprod2)e(:)i(int)f(->)g(<Vector)g(->)g(<Vector)f(->)i
(int>>)e(*\))-76 909 y(fun)h(iprod2)g(n)g(=)h(<fn)f(v)h(=>)f(<fn)g(w)h
(=>)-32 950 y(~~\(if)f(n)43 b('>')g(0)77 992 y(then)21
b(<<)g(\(~\(lift)f(nth)i(v)f(n\))h(*)f(\(nth)g(w)h(n\)\))f(+)251
1033 y(\(~\(~\(iprod2)f(\(n-1\)\))g(v\))i(w\))186 1075
y(>>)77 1116 y(else)f(<<0>>\))f(>>;)-76 1199 y(\(*)i(p3)f(:)h(int)f(->)
g(<Vector>)f(->)i(<<Vector>>)d(->)j(<<int>>)e(*\))-76
1241 y(fun)h(p3)h(n)f(v)h(w)f(=)-76 1282 y(if)h(n)43
b('>')g(0)-10 1324 y(then)21 b(<<)g(\(~\(lift)f(nth)h(~v)h(n\))f(*)h
(\(nth)f(~~w)g(n\)\))g(+)164 1365 y(~~\(p3)g(\(n-1\))f(v)i(w\))f(>>)-10
1407 y(else)g(<<0>>;)-76 1490 y(fun)g(iprod3)g(n)g(=)h(back2)f(\(p3)g
(n\);)-76 1561 y Fx(Notice)16 b(that)f(the)h(staged)f(v)o(ersions)h
(are)g(remark)n(ably)d(similar)-76 1603 y(to)18 b(the)g(unstaged)g(v)o
(ersion,)h(and)e(that)h(the)g(v)o(ersion)g(written)-76
1644 y(with)d Fr(back2)g Fx(has)h(few)o(er)g(annotations.)22
b(The)16 b(t)o(yp)q(e)g(inference)-76 1686 y(mec)o(hanism)11
b(w)o(as)j(a)f(great)h(help)f(in)g(placing)g(the)h(annotations)-76
1727 y(correctly)m(.)-20 1769 y(An)d(imp)q(ortan)o(t)e(feature)i(of)f
(MetaML)h(is)g(the)g(visualization)-76 1810 y(help)17
b(that)f(the)h(system)f(a\013ords.)26 b(By)16 b(\\testing")h
Fr(iprod2)e Fx(on)-76 1852 y(some)e(inputs)g(w)o(e)h(can)f(\\see")h
(what)g(the)g(results)g(are)g(immedi-)-76 1893 y(ately)m(.)-76
1965 y Fr(val)21 b(f1)h(=)f(iprod3)g(3;)-76 2006 y(f1)h(:)f(<Vector)f
(->)i(<Vector)e(->)i(int>>)e(=)-76 2048 y(<fn)h(d1)h(=>)11
2089 y(<fn)g(d5)f(=>)77 2131 y(\(~\(lift)f(\045nth)h(d1)g(3\))h(*)f
(\(\045nth)g(d5)h(3\)\))f(+)77 2172 y(\(~\(lift)f(\045nth)h(d1)g(2\))h
(*)f(\(\045nth)g(d5)h(2\)\))f(+)77 2214 y(\(~\(lift)f(\045nth)h(d1)g
(1\))h(*)f(\(\045nth)g(d5)h(1\)\))f(+)77 2255 y(0)g(>>)-76
2327 y Fx(When)13 b(this)f(piece)i(of)e(co)q(de)h(is)f
Fr(run)g Fx(it)g(will)f(return)j(a)e(function,)-76 2368
y(whic)o(h)i(when)h(applied)e(to)h(a)g(v)o(ector)h(builds)e(another)i
(piece)g(of)-76 2410 y(co)q(de.)32 b(This)18 b(building)f(pro)q(cess)j
(includes)f(lo)q(oking)e(up)h(eac)o(h)-76 2451 y(elemen)o(t)h(in)g(the)
i(\014rst)f(v)o(ector)g(and)g(splicing)e(in)i(the)g(actual)-76
2493 y(v)n(alue)c(using)g(the)i Fr(lift)d Fx(op)q(erator.)27
b(Using)16 b(lift)g(is)g(esp)q(ecially)-76 2534 y(v)n(aluable)j(if)g(w)
o(e)h(wish)g(to)g(insp)q(ect)h(the)g(result)g(of)e(the)i(next)-76
2576 y(phase.)h(T)m(o)14 b(do)h(that)g(w)o(e)h(ev)n(aluate)e(the)i(co)q
(de)g(b)o(y)e(running)h(it,)-76 2617 y(and)f(apply)f(the)i(result)f(to)
g(a)g(v)o(ector.)1020 -34 y Fr(val)21 b(f2)h(=)f(\(run)g(f1\))g
([1,0,4];)1020 7 y(f2:)g(<Vector)g(->)g(int>)g(=)1020
49 y(<fn)g(d1)h(=>)f(\(4)g(*)h(\(\045nth)f(d1)g(3\)\))g(+)1238
90 y(\(0)g(*)h(\(\045nth)f(d1)g(2\)\))g(+)1238 132 y(\(1)g(*)h
(\(\045nth)f(d1)g(1\)\))g(+)h(0)f(>)1020 203 y Fx(Note)15
b(ho)o(w)f(the)h(actual)f(v)n(alues)g(of)g(the)h(\014rst)g(arra)o(y)f
(app)q(ear)h(in)1020 245 y(the)e(co)q(de,)h(and)e(ho)o(w)h(the)g
(access)i(function)d Fr(nth)g Fx(app)q(ears)i(as)f(a)1020
286 y(constan)o(t)h(expression)i(applied)d(to)h(the)g(second)h(v)o
(ector)g Fr(d1)p Fx(.)1076 328 y(While)e(this)g(co)q(de)h(is)g(go)q(o)q
(d,)e(it)h(do)q(es)h(not)g(tak)o(e)f(full)f(adv)n(an-)1020
369 y(tage)k(of)f(all)f(the)i(information)d(kno)o(wn)i(in)g(the)i
(second)f(stage.)1020 411 y(In)f(particular,)g(note)g(that)g(w)o(e)h
(generate)g(co)q(de)g(for)f(the)g(third)1020 452 y(stage)10
b(whic)o(h)g(ma)o(y)e(con)o(tain)h(m)o(ultiplication)e(b)o(y)i
Fr(0)h Fx(or)g Fr(1)p Fx(.)16 b(These)1020 494 y(m)o(ultiplications)d
(can)j(b)q(e)g(optimized.)23 b(T)m(o)15 b(do)h(this)g(w)o(e)g(write)
1020 535 y(a)f(second)h(stage)g(function)f Fr(add)g Fx(whic)o(h)g(giv)o
(en)g(an)g(index)g(in)o(to)1020 577 y(a)f(v)o(ector)h
Fr(i)p Fx(,)f(an)g(actual)h(v)n(alue)e(from)g(the)i(\014rst)g(v)o
(ector)h Fr(x)p Fx(,)d(and)1020 618 y(a)j(piece)h(of)f(co)q(de)h(with)f
(the)h(name)f(of)f(the)i(second)h(v)o(ector)f Fr(y)p
Fx(,)1020 660 y(constructs)c(a)f(piece)g(of)f(co)q(de)h(whic)o(h)f
(adds)h(the)g(result)g(of)f(the)h Fr(x)1020 701 y Fx(and)e
Fr(y)f Fx(m)o(ultiplication)e(to)i(the)i(co)q(de)f(v)n(alued)g(fourth)f
(argumen)o(t)1020 743 y Fr(e)p Fx(.)18 b(When)c(x)g(is)f
Fr(0)h Fx(or)g Fr(1)f Fx(sp)q(ecial)i(cases)g(are)f(p)q(ossible.)1020
814 y Fr(\(*)21 b(add)h(:)f(int)g(->)h(int)f(->)g(<Vector>)f(->)i
(<int>)f(*\))1020 856 y(fun)g(add)g(i)h(x)g(y)f(e)h(=)1064
897 y(if)f(x=0)1129 939 y(then)g(e)1064 980 y(else)g(if)g(x=1)1129
1022 y(then)g(<\(nth)g(~y)g(~\(lift)g(i\)\))g(+)g(~e>)1064
1063 y(else)g(<\(~\(lift)f(x\))h(*)h(\(nth)f(~y)g(~\(lift)g(i\)\)\))g
(+)g(~e>;)1020 1135 y Fx(This)9 b(sp)q(ecialized)i(function)e(is)g(no)o
(w)g(used)i(to)e(build)g(the)h(second)1020 1176 y(stage)k(computation:)
1020 1248 y Fr(\(*)21 b(p3)h(:)f(int)h(->)f(<Vector>)f(->)h(<<Vector>>)
f(->)i(<<int>>)e(*\))1020 1289 y(fun)h(p3)h(n)f(v)h(w)f(=)1020
1331 y(if)g(n)h(=)g(1)1085 1372 y(then)f(<<)h(~\(add)f(n)g(\(nth)g(~v)g
(n\))h(~w)f(<0>\))g(>>)1085 1414 y(else)g(<<)h(~\(add)f(n)g(\(nth)g(~v)
g(n\))h(~w)1303 1455 y(<)g(~~\(p3)f(\(n-1\))f(v)i(w\))f(>\))h(>>;)1020
1538 y(fun)f(iprod3)g(n)g(=)h(back2)f(\(p3)g(n\);)1020
1610 y Fx(No)o(w)14 b(let)h(us)g(observ)o(e)h(the)g(result)f(of)f(the)i
(\014rst)f(stage)h(compu-)1020 1651 y(tation.)1020 1722
y Fr(val)21 b(f3)h(=)f(iprod3)g(3;)1020 1764 y(f3:)g(<Vector)g(->)g
(<Vector)f(->)i(int>>)e(=)1020 1805 y(<fn)h(d1)h(=>)1107
1847 y(<fn)f(d5)h(=>)1194 1888 y(~\(\045add)f(3)h(\(\045nth)e(d1)i(3\))
f(<d5>)1347 1930 y(<)h(~\(\045add)e(2)i(\(\045nth)e(d1)i(2\))f(<d5>)
1543 1971 y(<)h(~\(\045add)e(1)i(\(\045nth)f(d1)g(1\))g(<d5>)1717
2013 y(<0>\)>\)>\))42 b(>>)1020 2084 y Fx(This)16 b(co)q(de)h(is)f
(linear)g(in)g(the)h(size)g(of)e(the)i(v)o(ector;)h(if)d(w)o(e)h(had)
1020 2126 y(actually)10 b(inlined)f(the)i(calls)f(to)h
Fr(add)e Fx(it)h(w)o(ould)g(b)q(e)h(exp)q(onen)o(tial.)1020
2167 y(This)17 b(is)f(wh)o(y)g(b)q(eing)h(able)f(to)h(ha)o(v)o(e)f
(free)i(v)n(ariables)e(\(suc)o(h)h(as)1020 2209 y Fr(add)p
Fx(\))f(in)g(co)q(de)i(is)e(indisp)q(ensable.)27 b(No)o(w)16
b(let)h(us)g(observ)o(e)h(the)1020 2250 y(result)d(of)e(the)h(second)h
(stage)g(computation:)1020 2322 y Fr(val)21 b(f4)h(=)f(\(eval)g(f3\))g
([1,0,4];)1020 2363 y(f4:)g(<Vector)g(->)g(int>)g(=)1020
2405 y(<fn)g(d1)h(=>)f(\(4)g(*)h(\(\045nth)f(d1)g(3\)\))g(+)h
(\(\045nth)f(d1)g(1\))g(+)h(0>)1020 2476 y Fx(Note)14
b(that)g(no)o(w)f(only)g(the)h(m)o(ultiplications)d(that)j(con)o
(tribute)1020 2518 y(to)e(the)g(answ)o(er)h(are)f(eviden)o(t)h(in)e
(the)i(third)f(stage)g(program.)k(If)1020 2559 y(the)h(v)o(ector)g(is)g
(sparse)g(then)g(this)g(sort)g(of)e(optimization)f(can)1020
2601 y(ha)o(v)o(e)g(dramatic)e(e\013ects.)p eop
%%Page: 7 7
7 6 bop -76 -34 a Fy(10)53 b(Seman)o(tics)17 b(of)h Fm(\025)361
-51 y Fz(M)-76 48 y Fx(Figure)e(1)g(presen)o(ts)h(the)g(static)f(and)g
(dynamic)e(seman)o(tics)h(of)-76 95 y(the)e(meta-lam)n(b)q(da)c
(calculus,)j Ft(\025)434 80 y Fl(M)476 95 y Fx(.)17 b(This)12
b(calculus)g(is)g(a)g(mini-)-76 137 y(MetaML,)k(whic)o(h)g(illustrates)
f(the)i(relev)n(an)o(t)f(features)h(of)e(the)-76 178
y(staging)e(annotations)h(on)f(the)i(seman)o(tics)e(of)g(MetaML.)-20
226 y Ft(\025)4 211 y Fl(M)55 226 y Fx(is)d(a)g(call)f(b)o(y)g(v)n
(alue)h(lam)o(b)q(da)d(calculus)j(whic)o(h)g(supp)q(orts)-76
267 y(in)o(tegers,)15 b(functions,)f(and)g(co)q(de)h(\()p
Fr(int)23 b Fs(j)h Ft(t)12 b Fs(!)g Ft(t)24 b Fs(j)g(h)p
Ft(t)p Fs(i)p Fx(\).)19 b(The)-76 309 y(syn)o(tax)h(of)g(terms)f
(includes)i(in)o(teger)g(constan)o(ts,)h(v)n(ariables,)-76
350 y(applications,)14 b(abstractions)i(\()p Ft(i)28
b Fs(j)f Ft(x)g Fs(j)g Ft(e)14 b(e)27 b Fs(j)g Ft(\025)7
b(x)763 335 y Fp(t)785 350 y Ft(:)g(e)p Fx(\))15 b(and)-76
392 y(the)c(four)g(staging)f(annotations:)16 b(meta)9
b(brac)o(k)o(ets,)j(escap)q(e,)h(lift)-76 433 y(and)j(run)g(\()p
Fr(<)p Ft(e)p Fr(>)28 b Fs(j)h Fr(~)6 b Ft(e)30 b Fs(j)e
Fr(lift)437 418 y Fp(t)466 433 y Ft(e)h Fs(j)g Fr(run)14
b Ft(e)p Fx(\).)23 b(In)16 b(addition,)-76 475 y(the)e(constan)o(t)g
(op)q(erator)g(\()p Fs(")19 b Ft(v)q Fx(\))14 b(allo)o(ws)e(us)i(to)g
(injects)g(a)f(v)n(alue)-76 516 y(in)o(to)20 b(a)g(term,)h(and)f(is)g
(crucial)g(to)g(the)h(conciseness)i(of)c(our)-76 558
y(implemen)o(tation)13 b(of)i(Cross-Stage)h(P)o(ersistence.)27
b(It)16 b(is)g(these)-76 599 y(constan)o(ts)e(that)f(w)o(e)g(prin)o(t)g
(out)g(as)g(a)g(\045)f(follo)o(w)o(ed)g(b)o(y)g(a)h(name.)-76
641 y(Note)19 b(that)f(users)i(do)e(not)g(write)h(programs)e(with)g
(the)i(con-)-76 682 y(stan)o(t)d(op)q(erator;)i(it)d(is)h(only)g(in)o
(tro)q(duced)g(during)g(reduction.)-76 724 y(Ev)o(ery)c(shift)g(in)f
(stage)h(from)e(a)i(lo)o(w)o(er)f(stage)h(to)g(a)f(higher)h(stage)-76
765 y(enric)o(hes)19 b(the)f(syn)o(tax)f(passed)h(to)g(the)g(higher)f
(stage)h(with)f(a)-76 807 y(new)h(set)g(of)f(constan)o(ts;)i(the)f(v)n
(alues)f(of)f(the)i(previous)g(stage)-76 848 y(that)c(could)g(still)f
(b)q(e)h(referenced)j(in)c(the)i(future.)-76 961 y Fy(10.1)52
b(Static)20 b(Seman)o(tics)-76 1029 y Fx(The)d(static)g(seman)o(tics)f
(is)g(expressed)j(as)e(a)f(set)h(of)f(inference)-76 1070
y(rules)c(that)f(determine)h(if)e(a)h(term)g(is)g(w)o(ell-formed,)e
(and)i(deter-)-76 1136 y(mine)i(its)h(t)o(yp)q(e.)19
b(The)14 b(judgemen)o(t)f(\006)f(\001)580 1099 y Fp(n)577
1136 y Fs(`)19 b Ft(x)g Fx(:)f Ft(\034)712 1142 y Fu(1)731
1136 y Ft(;)7 b(\034)768 1142 y Fu(2)800 1136 y Fx(is)14
b(read)-76 1178 y Fw(under)h(the)f(c)n(ontext)g(stack)g
Fx(\006)p Fw(,)g(the)g(typ)n(e)g(envir)n(onment)h Fx(\001)p
Fw(,)e(the)-76 1219 y(term)18 b Ft(x)g Fw(has)h(typ)n(e)f
Ft(\034)255 1225 y Fu(1)292 1219 y Fw(at)h(level)f Ft(n)g
Fw(and)h(may)g(exe)n(cute)g(in)f(the)-76 1261 y(c)n(ontext)d(with)g
(name)g Ft(\034)287 1267 y Fu(2)306 1261 y Fx(.)-20 1303
y(The)i(in)o(tutition)e(b)q(ehind)i(con)o(texts,)h(is)e(that)g(an)o(y)g
(expres-)-76 1344 y(sion)c(can)h(only)f(execute)i(in)e(a)h(con)o(text)g
(whic)o(h)f(con)o(tains)h(bind-)-76 1386 y(ings)g(for)f(its)h(free)h(v)
n(ariables.)j(The)c(t)o(yp)q(e)h(inference)g(algorithm)-76
1427 y(assigns)d(the)h(same)e(con)o(text)i(name)e(to)h(expressions)h
(that)f(m)o(ust)-76 1469 y(execute)16 b(in)d(the)i(same)e(con)o(text.)
-20 1510 y(The)i(t)o(yp)q(e)h(assignmen)o(t)e(\001)g(maps)f(v)n
(ariable)h(to)h(t)o(yp)q(es)h(and)-76 1552 y(lev)o(els)h(and)g(con)o
(text)h(names.)27 b(Ev)o(ery)17 b(v)n(ariable)f(is)h(b)q(ound)h(at)-76
1593 y(some)d(particular)g(lev)o(el,)f(namely)m(,)f(the)j(lev)o(el)f
(of)g(the)h(abstrac-)-76 1635 y(tion)10 b(in)g(whic)o(h)h(it)f(is)h(b)q
(ound)f(\()p Fk(Abs)g Fx(rule\).)18 b(The)11 b(role)f(of)g
Ft(n)h Fx(in)f(the)-76 1703 y(judgemen)o(t)g(\001)180
1666 y Fp(n)178 1703 y Fs(`)18 b Ft(x)h Fx(:)e Ft(\033)c
Fx(is)e(to)g(k)o(eep)h(trac)o(k)g(of)e(the)i(lev)o(el)f(of)g(the)-76
1744 y(expression)k(b)q(eing)f(t)o(yp)q(ed.)19 b(The)14
b Fw(level)g Fx(of)f(a)h(sub)q(expression)i(is)-76 1786
y(the)h(n)o(um)o(b)q(er)e(of)h(uncancelled)h(surrounding)g(brac)o(k)o
(ets.)26 b(One)-76 1827 y(surrounding)d(escap)q(e)h(cancels)f(one)g
(surrounding)f(brac)o(k)o(et.)-76 1869 y(Hence,)16 b
Ft(n)e Fx(is)g(incremen)o(ted)h(for)f(an)g(expression)h(inside)g(meta-)
-76 1910 y(brac)o(k)o(ets)i(\()p Fk(Brac)o(k)o(et)p Fx(\),)f(and)g
(decremen)o(ted)h(for)e(one)i(inside)f(an)-76 1952 y(escap)q(e)e(\()p
Fk(Escap)q(e)p Fx(\).)j(Note)12 b(that)g(the)h(rule)f
Fk(Escap)q(e)f Fx(do)q(es)i(not)f(al-)-76 1994 y(lo)o(w)h(escap)q(e)i
(to)f(app)q(ear)g(at)g(lev)o(el)f(0.)18 b(In)c(other)g(w)o(ords,)g
(escap)q(e)-76 2035 y(m)o(ust)f(app)q(ear)h(inside)g(uncancelled)h
(meta-brac)o(k)o(ets.)-20 2077 y(There)f(are)f(three)h(main)c(kinds)j
(of)f(errors)i(related)f(to)g(stag-)-76 2118 y(ing)g(annotations)h
(that)g(can)g(o)q(ccur)h(at)e(run)o(time:)-22 2179 y
Fs(\017)19 b Fx(A)14 b(v)n(ariable)e(is)i(used)h(in)e(a)h(stage)g(b)q
(efore)h(it)e(is)h(a)o(v)n(ailable,)18 2221 y(or)-22
2287 y Fs(\017)19 b Fx(Run)10 b(or)h(escap)q(e)i(are)f(passed)g(v)n
(alues)f(ha)o(ving)f(a)h(non-)p Ft(code)18 2329 y Fx(t)o(yp)q(e,)i(or)
-22 2395 y Fs(\017)19 b Fx(Run)9 b(is)g(passed)h(a)f(co)q(de-t)o(yp)q
(e)i(v)n(alue)d(with)h(free)i(v)n(ariables.)18 2437 y(This)k(manifests)
f(itself)h(in)f(the)i(t)o(yp)q(e,)f(where)i(the)f(name)18
2478 y(of)d(the)h(con)o(text)h(is)f(constrained.)-20
2539 y(The)j(\014rst)g(kind)f(of)g(error)h(is)f(c)o(hec)o(k)o(ed)i(b)o
(y)e(the)g Fk(V)m(ar<n)g Fx(and)-76 2581 y Fk(V)m(ar=n)g
Fx(rules.)29 b(Because)20 b(there)e(is)g(no)f(rule)h(for)f
Ft(m)h(>)g(n)f Fx(en-)-76 2622 y(forces)k(Cross-Stage)g(P)o
(ersistence:)33 b(V)m(ariables)19 b(a)o(v)n(ailable)f(in)1020
-34 y(the)f(curren)o(t)h(stage)f(\()p Ft(m)p Fx(\))g(can)g(b)q(e)g
(used)g(in)f(all)f(future)i(stages)1020 7 y(\()p Ft(n)p
Fx(\).)30 b(The)19 b(second)g(kind)e(of)h(error)g(is)g(c)o(hec)o(k)o
(ed)h(b)o(y)f(the)h Fk(Run)1020 49 y(n)14 b Fx(and)h
Fk(Esc)f(n+1)g Fx(rules.)20 b(Detecting)c(the)f(third)f(kind)g(of)g
(error)1020 90 y(is)j(an)g(imp)q(ortan)o(t)f(con)o(tribution)h(of)g
(this)g(pap)q(er,)i(and)e(is)g(ac-)1020 132 y(complished)11
b(b)o(y)g(the)i(free)f(v)n(ariable)f(c)o(hec)o(k)h(in)g(the)g(rule)g
Fk(Run)f(n)p Fx(.)1020 173 y(Only)18 b(co)q(de)g(whose)h(con)o(text)f
(is)g(completely)e(unconstrained)1020 215 y(m)o(y)c(b)q(e)j(run.)1076
256 y(F)m(or)k(the)h(standard)g(part)g(of)f(the)h(language,)f
Ft(code)h Fx(\(no)o(w)1020 298 y(denoted)f(b)o(y)e Fs(h)p
1260 298 13 2 v 20 w(i)h Fx(for)f(conciseness\))j(is)e(a)f(normal)f(t)o
(yp)q(e)i(con-)1020 339 y(structor)g(that)e(needs)h(no)f(sp)q(ecial)g
(treatmen)o(t)g(and)g(the)h(lev)o(el)1020 381 y Ft(n)j
Fx(is)f(nev)o(er)i(c)o(hanged.)36 b(Similar)17 b(t)o(yp)q(e)j(systems)g
(ha)o(v)o(e)f(b)q(een)1020 422 y(iden)o(ti\014ed)d(and)g(used)g(b)o(y)g
(Gomard)e(and)i(Jones)g([11)o(],)g(Da)o(vies)1020 464
y(&)e(Pfenning)g([6)o(])g(and)f(Da)o(vies)h([7)o(].)1076
505 y(An)e(imp)q(ortan)o(t)f(di\013erence)j(b)q(et)o(w)o(een)g(these)f
(t)o(yp)q(e)g(systems)1020 547 y(and)e(the)h(one)g(in)f(Figure)g(1)g
(is)g(that)h(in)f(all)f(previous)h(statically-)1020 588
y(t)o(yp)q(ed)f(m)o(ulti-stage)e(languages)i([25)o(,)f(7,)g(6],)g(only)
g(the)i(follo)o(wing)1020 630 y Fw(monolithic)j Fx(t)o(yp)q(e)g(rule)g
(is)g(used)h(for)e(v)n(ariables:)1077 748 y Fk(V)m(ar)g(\(Monolithic\))
p Fj(:)1446 707 y Fx(\(\001)e Ft(x)p Fx(\))g(=)h Ft(\034)1626
692 y Fp(m)p 1427 721 250 2 v 1463 786 a Fx(\001)1518
749 y Fp(n)1516 786 y Fs(`)19 b Ft(x)11 b Fx(:)g Ft(\034)1734
748 y Fx(when)j Ft(m)e Fx(=)g Ft(n)1020 865 y Fx(Whereas)18
b(w)o(e)f(allo)o(w)e(the)i(more)f(general)h(condition)f
Ft(m)g Fs(\024)h Ft(n)p Fx(.)1020 907 y(This)g(means)f(an)o(y)g
(generated)i(expressions)g(ma)o(y)d(as)i(w)o(ell)f(b)q(e)1020
948 y(ev)n(aluated)11 b(in)f(the)i(empt)o(y)d(en)o(vironmen)o(t)h
(since)i(all)e(w)o(ell-t)o(yp)q(ed)1020 990 y(terms)18
b(are)h(closed)h(terms)e(and)g(cannot)h(reference)i(an)o(y)d(free)1020
1031 y(v)n(ariables.)f(F)m(or)d(example)e(the)j(expression:)1227
1107 y Fr(val)21 b(lift)p 1405 1107 14 2 v 15 w(like)g(=)h(fn)f(x)h(=>)
f(<x>)1020 1182 y Fx(is)d(accepted,)i(b)q(ecause)f(inside)f(the)h
(meta-brac)o(k)o(ets,)f Ft(n)g Fx(=)g(1,)1020 1228 y(and)g(\(\001)g
Fr(x)p Fx(\))h(=)g Ft(\013)1309 1213 y Fu(0)1327 1228
y Fx(.)31 b(This)18 b(expression)h(is)f(not)h(accepted)g(b)o(y)1020
1270 y(the)13 b(monolithic)d(v)n(ariable)i(rule.)18 b(Note)13
b(that)f(while)g(the)i(whole)1020 1311 y(function)h(has)g(t)o(yp)q(e)g
Ft(\013)e Fs(!)f(h)p Ft(\013)p Fs(i)j Fx(it)f(do)q(es)i(not)f(pro)o
(vide)f(us)i(with)1020 1353 y(the)g(functionalit)o(y)e(of)h(lift,)f(b)q
(ecause)j(the)g(result)f(of)f(applying)1020 1394 y Fr(lift)p
1111 1394 V 15 w(like)d Fx(to)h(an)o(y)f(v)n(alue)h(alw)o(a)o(ys)f
(returns)i Fr(<\045x)o(>)p Fx(,)f(and)g(not)g(a)1020
1436 y(literal)g(expression)i(denoting)e(the)h(v)n(alue.)k(But)c(this)g
(example)1020 1477 y(demonstrates)i(that)g(meta-brac)o(k)o(ets)g(can)g
(b)q(e)g(used)h(to)f(\\lift")1020 1519 y(an)o(y)d(v)n(alue,)f
(including)g(functions.)18 b(This)c(is)f(explained)g(in)g(the)1020
1560 y(dynamic)f(seman)o(tics.)1076 1602 y(The)i(t)o(yp)q(e)h(system)e
(rejects)j(the)f(expression)1258 1677 y Fr(fn)22 b(a)f(=>)h(<fn)f(b)g
(=>)h(~)l(\(a+b\))o(>)1020 1753 y Fx(b)q(ecause,)16 b(inside)f(the)g
(escap)q(e,)h Ft(n)d Fx(=)g(0,)h(and)h(\(\000)d Fr(b)p
Fx(\))h(=)g Ft(\013)1909 1737 y Fu(1)1928 1753 y Fx(,)h(but)1020
1794 y(1)d Ft(>)h Fx(0.)1020 1908 y Fy(10.2)52 b(Dynamic)18
b(Seman)o(tics)1020 1976 y Fx(The)12 b(dynamic)e(seman)o(tics)i(pro)o
(vides)g(meaning)e(to)i(w)o(ell-t)o(yp)q(ed)1020 2018
y(terms.)k(V)m(alues)10 b(are)f(a)h(subset)g(of)f(terms,)h(and)f(w)o(e)
h(denote)g(them)1020 2059 y(with)15 b(a)f(small)f(diamond)g(sup)q
(erscript)k(\()p Ft(i)1678 2044 y Fl(\005)1724 2059 y
Fs(j)41 b(f)p Ft(\025)7 b(x)1853 2044 y Fp(t)1874 2059
y Ft(:)g(e)p Fs(g)1933 2044 y Fl(\005)1978 2059 y Fs(j)1020
2101 y(h)p Ft(e)p Fs(i)1071 2086 y Fl(\005)1091 2101
y Fx(\).)17 b(The)12 b(seman)o(tics)f(giv)o(en)g(in)g(Figure)h(1,)f
(when)h(applied)f(to)1020 2142 y(w)o(ell)16 b(t)o(yp)q(ed)g(terms,)g
(main)o(tains)e(the)j(in)o(v)n(arian)o(t)d(that)j(no)e(free)1020
2184 y(v)n(ariables)g(ev)o(er)i(o)q(ccur)h(in)d(co)q(de)i(v)n(alues)f
(whic)o(h)g(will)e(later)j(b)q(e)1020 2225 y Fr(run)p
Fx(.)1076 2267 y(The)h(most)e(imp)q(ortan)o(t)f(thing)i(to)g(notice)h
(ab)q(out)f(the)h(dy-)1020 2308 y(namic)g(seman)o(tics)h(is)h(that)f
(it)h(is)f(brok)o(en)h(in)o(to)f(t)o(w)o(o)g(sets)i(of)1020
2350 y(rules,)16 b(reduction)g(and)g(rebuilding.)22 b(Reduction)16
b(\(\000)21 b Fs(`)h Ft(e)f(,)-7 b Fs(!)1020 2415 y Ft(v)q
Fx(\))15 b(maps)f(terms)g(to)h(v)n(alues)f(and)h(rebuilding)f(\(\000)19
b Fs(`)h Ft(e)1899 2387 y Fp(n)p Fu(+1)1907 2415 y Ft(,)-7
b Fs(!)27 b Ft(e)p Fx(\))1020 2456 y(maps)16 b(terms)h(to)f(terms)h
(and)g(is)g(indexed)g(b)o(y)g(a)g(lev)o(el)f Ft(n)11
b Fx(+)h(1.)1020 2498 y(Rebuilding)d(\\reconstructs")j(terms)e(under)h
(the)f(en)o(vironmen)o(t)1020 2539 y(\000.)1076 2581
y(The)g(en)o(vironmen)o(t)f(\000)h(binds)f(a)h(v)n(ariable)e(to)i(a)f
(v)n(alue.)16 b(Bind-)1020 2622 y(ings)11 b(in)f(en)o(vironmen)o(ts)h
(come)f(in)h(t)o(w)o(o)f(\015a)o(v)o(ors:)17 b(real)11
b(\(Real)o(\()p Ft(v)q Fx(\)\))p eop
%%Page: 8 8
8 7 bop -76 -74 2183 2 v -77 2539 2 2614 v 773 -41 a
Fo(Domains)14 b(and)h(Relations)64 34 y Fj(lev)o(els)238
b Fi(n)46 b Fz(!)37 b Fj(0)20 b Fz(j)f Fj(1)g Fz(j)h
Fi(n)8 b Fj(+)g(1)19 b Fz(j)h Fi(n)8 b Fj(+)g(2)20 b
Fz(j)25 b Fi(:)5 b(:)h(:)64 71 y Fj(in)o(tegers)201 b
Fi(i)55 b Fz(!)37 b Fi(:)6 b(:)g(:)25 b Fz(j)i(\000)8
b Fj(2)20 b Fz(j)27 b(\000)8 b Fj(1)19 b Fz(j)h Fj(0)f
Fz(j)h Fj(1)f Fz(j)g Fj(2)g Fz(j)26 b Fi(:)5 b(:)h(:)64
109 y Fj(t)o(yp)q(es)239 b Fi(\034)51 b Fz(!)37 b Fh(int)19
b Fz(j)g Fi(\034)13 b Fz(!)e Fi(\034)23 b Fz(j)c(h)p
Fi(\034)t Fz(i)64 146 y Fj(terms)234 b Fi(e)51 b Fz(!)37
b Fi(i)20 b Fz(j)f Fi(x)h Fz(j)f Fi(e)10 b(e)20 b Fz(j)g
Fi(\025)5 b(x)793 134 y Fg(\034)818 146 y Fi(:)h(e)20
b Fz(j)f Fh(<)p Fi(e)p Fh(>)h Fz(j)f Fh(~)r Fi(e)h Fz(j)g
Fh(run)8 b Fi(e)20 b Fz(j)30 b(")15 b Fi(v)64 184 y Fj(v)n(alues)227
b Fi(v)50 b Fz(!)37 b Fi(i)537 173 y Ff(\005)575 184
y Fz(j)19 b(f)p Fi(\025)5 b(x)668 173 y Fg(t)688 184
y Fi(:)h(e)p Fz(g)738 173 y Ff(\005)775 184 y Fz(j)20
b(h)p Fi(e)p Fz(i)849 173 y Ff(\005)64 223 y Fj(bindings)190
b Fi(b)52 b Fz(!)37 b Fj(Real)o(\()p Fi(v)q Fj(\))20
b Fz(j)f Fj(Sym)o(\()p Fi(x)p Fj(\))805 211 y Fg(t)64
260 y Fj(en)o(vironmen)n(ts)114 b(\000)45 b Fz(!)37 b(\017)20
b(j)f Fj(\000)p Fi(;)6 b(x)j Fz(7!)h Fi(b)145 b Fk(where)19
b Fj(\(\000)p Fi(;)6 b(x)j Fz(7!)h Fi(b)p Fj(\))p Fi(y)117
b Fz(\021)20 b Fj(if)10 b Fi(x)f Fj(=)i Fi(y)g Fj(then)e
Fi(b)g Fj(else)g(\000)h Fi(y)64 297 y Fj(t)o(yp)q(e)g(en)o(vironmen)o
(ts)34 b(\001)k Fz(!)f(\016)20 b(j)f Fj(\001)p Fi(;)6
b(x)k Fz(7!)g Fj(\()p Fi(\034)r(;)5 b(\013)p Fj(\))795
283 y Fg(n)865 297 y Fk(where)19 b Fj(\(\001)p Fi(;)6
b(x)j Fz(7!)i Fj(\()p Fi(\034)r(;)t(\013)p Fj(\))1208
283 y Fg(n)1229 297 y Fj(\))p Fi(y)21 b Fz(\021)f Fj(if)9
b Fi(x)h Fj(=)g Fi(y)i Fj(then)c(\()p Fi(\034)r(;)d(\013)p
Fj(\))1616 286 y Fg(n)1647 297 y Fj(else)k(\001)h Fi(y)64
335 y Fj(con)o(text)f(stac)o(ks)103 b(\006)42 b Fz(!)37
b Fj([)6 b(])19 b Fz(j)h Fi(\013)p Fj(;)5 b(\006)65 392
y(reduction)34 b(\000)16 b Fz(`)f Fi(e)h(,)-6 b Fz(!)16
b Fi(v)166 b Fj(rebuilding)34 b Fe(at)13 b(level)h(n)57
b Fj(\000)16 b Fz(`)f Fi(e)1101 368 y Fg(n)1091 392 y
Fi(,)-6 b Fz(!)16 b Fi(e)158 b Fj(term)10 b(t)o(yping)36
b Fe(at)13 b(level)h(n)37 b Fj(\006)10 b(\001)1802 361
y Fg(n)1800 392 y Fz(`)16 b Fi(e)g Fj(:)f Fi(\034)r(;)5
b(\034)842 545 y Fo(Static)15 b(Seman)o(tics)-34 658
y Fk(In)o(t)f(n)p Fj(:)34 b(\006)11 b(\001)182 626 y
Fg(n)181 658 y Fz(`)k Fi(i)h Fj(:)f Fh(int)o Fi(;)6 b(\013)243
b Fk(V)m(ar)13 b Fj(=)p Fk(0)p Fj(:)814 622 y(\001)d
Fi(x)g Fj(=)g(\()p Fi(\034)r(;)5 b(\013)990 627 y Fd(1)1007
622 y Fj(\))1021 610 y Fd(0)p 777 635 329 2 v 815 694
a Fj(\006)10 b(\001)896 663 y Fg(n)895 694 y Fz(`)15
b Fi(x)h Fj(:)f Fi(\034)r(;)6 b(\013)1050 699 y Fd(2)1359
658 y Fk(V)m(ar)13 b Fz(\024)p Fk(n)p Fj(:)1569 622 y(\001)d
Fi(x)g Fj(=)g(\()p Fi(\034)r(;)5 b(\013)p Fj(\))1759
610 y Fg(i)1801 622 y Fi(i)10 b Fz(6)p Fj(=)g(0)e Fz(^)f
Fi(i)j Fz(\024)g Fi(n)p 1532 635 504 2 v 1666 694 a Fj(\006)g(\001)1748
663 y Fg(n)1746 694 y Fz(`)16 b Fi(x)f Fj(:)h Fi(\034)r(;)5
b(\013)-34 818 y Fk(Br)14 b(n)p Fj(:)131 794 y(\()p Fi(\013)168
799 y Fd(2)184 794 y Fj(;)6 b(\006\))k(\001)298 763 y
Fg(n)p Fd(+1)316 794 y Fz(`)34 b Fi(e)16 b Fj(:)f Fi(\034)r(;)5
b(\013)485 799 y Fd(1)p 93 807 447 2 v 135 866 a Fj(\006)10
b(\001)217 835 y Fg(n)215 866 y Fz(`)16 b Fh(<)o Fi(e)p
Fh(>)g Fj(:)f Fz(h)6 b Fi(\034)j Fz(i)404 855 y Fg(\013)424
860 y Fq(1)442 866 y Fi(;)d(\013)481 871 y Fd(2)606 818
y Fk(Abs)13 b(n)p Fj(:)794 792 y(\006)e(\001)p Fi(;)6
b(x)j Fz(7!)h Fj(\()p Fi(\034)979 797 y Fd(1)996 792
y Fi(;)c(\013)p Fj(\))1049 780 y Fg(n)1090 760 y(n)1089
792 y Fz(`)15 b Fi(e)h Fj(:)g Fi(\034)1200 797 y Fd(2)1217
792 y Fi(;)5 b(\013)p 757 804 536 2 v 807 864 a Fj(\006)10
b(\001)889 832 y Fg(n)888 864 y Fz(`)15 b Fi(\025)5 b(x)971
852 y Fg(\034)985 857 y Fq(1)1010 864 y Fi(:)g(e)16 b
Fj(:)g Fi(\034)1099 869 y Fd(1)1126 864 y Fz(!)10 b Fi(\034)1187
869 y Fd(2)1204 864 y Fi(;)5 b(\013)1385 818 y Fk(Esc)14
b(n+1)p Fj(:)1630 789 y(\006)c(\001)1712 758 y Fg(n)1710
789 y Fz(`)16 b Fi(e)g Fj(:)f Fz(h)6 b Fi(\034)j Fz(i)1864
777 y Fg(\013)1884 782 y Fq(1)1902 789 y Fi(;)d(\013)1941
794 y Fd(2)p 1579 802 430 2 v 1598 866 a Fj(\()p Fi(\013)1635
871 y Fd(2)1652 866 y Fj(;)f(\006\))10 b(\001)1765 835
y Fg(n)p Fd(+1)1784 866 y Fz(`)33 b Fh(~)r Fi(e)16 b
Fj(:)g Fi(\034)r(;)5 b(\013)1973 871 y Fd(1)-34 1017
y Fk(Run)14 b(n)p Fj(:)161 951 y Fi(\013)184 956 y Fd(2)210
951 y Fz(62)c Fi(F)5 b(V)i Fj(\(\001)p Fi(;)f(\034)t
Fj(\))161 1009 y(\006)k(\001)242 977 y Fg(n)241 1009
y Fz(`)15 b Fi(e)h Fj(:)g Fz(h)5 b Fi(\034)10 b Fz(i)395
997 y Fg(\013)415 1002 y Fq(2)433 1009 y Fi(;)c(\013)472
1014 y Fd(1)p 123 1021 403 2 v 169 1081 a Fj(\006)k(\001)251
1049 y Fg(n)249 1081 y Fz(`)16 b Fh(run)8 b Fi(e)16 b
Fj(:)g Fi(\034)r(;)5 b(\013)463 1086 y Fd(1)606 1017
y Fk(App)13 b(n)p Fj(:)801 961 y(\006)d(\001)882 930
y Fg(n)881 961 y Fz(`)15 b Fi(e)934 966 y Fd(1)968 961
y Fj(:)g Fi(\034)1009 966 y Fd(1)1036 961 y Fz(!)10 b
Fi(\034)r(;)5 b(\013)801 1019 y Fj(\006)10 b(\001)882
987 y Fg(n)881 1019 y Fz(`)15 b Fi(e)934 1024 y Fd(2)968
1019 y Fj(:)g Fi(\034)1009 1024 y Fd(1)1026 1019 y Fi(;)6
b(\013)p 763 1032 411 2 v 823 1091 a Fj(\006)k(\001)905
1059 y Fg(n)903 1091 y Fz(`)16 b Fi(e)957 1096 y Fd(1)984
1091 y Fi(e)1000 1096 y Fd(2)1033 1091 y Fj(:)g Fi(\034)r(;)5
b(\013)1367 1017 y Fk(Con)14 b(n:)p Fj(:)1551 980 y Fi(?)p
Fu(Nev)o(er)c(app)q(ears)h(in)h(source)f(terms)p 1532
993 495 2 v 1665 1052 a Fj(\006)g(\001)1747 1021 y Fg(n)1746
1052 y Fz(`)k(")g Fi(v)i Fj(:)f Fi(?)761 1202 y Fo(The)g(Dynamic)f
(Seman)o(tics)89 1258 y Fk(In)o(t)e(0)p Fj(:)35 b(\000)16
b Fz(`)f Fi(i)h(,)-6 b Fz(!)16 b Fi(i)390 1246 y Ff(\005)841
1258 y Fk(In)o(t)d(n+1)p Fj(:)35 b(\000)16 b Fz(`)f Fi(i)1129
1234 y Fg(n)p Fd(+1)1139 1258 y Fi(,)-6 b Fz(!)25 b Fi(i)89
1378 y Fk(Abs)13 b(0)p Fj(:)256 1360 y(\000)p Fi(;)6
b(x)j Fz(7!)h Fj(Sym)o(\()p Fi(x)470 1349 y Ff(0)481
1360 y Fj(\))495 1349 y Fg(\034)533 1360 y Fz(`)16 b
Fi(e)615 1336 y Fd(1)603 1360 y Fi(,)-6 b Fz(!)16 b Fi(e)674
1365 y Fd(1)p 237 1373 473 2 v 256 1412 a Fj(\000)g Fz(`)f
Fi(\025)6 b(x)378 1401 y Fg(\034)403 1412 y Fi(:)g(e)16
b(,)-6 b Fz(!)15 b(f)p Fi(\025)6 b(x)570 1401 y Ff(0)581
1397 y Fg(\034)606 1412 y Fi(:)g(e)638 1417 y Fd(1)655
1412 y Fz(g)673 1401 y Ff(\005)841 1378 y Fk(Abs)13 b(n+1)p
Fj(:)1062 1351 y(\000)p Fi(;)6 b(x)k Fz(7!)g Fj(Sym)n(\()p
Fi(x)1276 1339 y Ff(0)1287 1351 y Fj(\))1301 1339 y Fg(\034)1340
1351 y Fz(`)15 b Fi(e)1393 1356 y Fd(1)1426 1327 y Fg(n)p
Fd(+1)1436 1351 y Fi(,)-6 b Fz(!)25 b Fi(e)1516 1356
y Fd(2)p 1044 1364 509 2 v 1089 1422 a Fj(\000)16 b Fz(`)f
Fi(\025)6 b(x)1211 1410 y Fg(\034)1236 1422 y Fi(:)g(e)1268
1427 y Fd(1)1301 1397 y Fg(n)p Fd(+1)1310 1422 y Fi(,)-6
b Fz(!)25 b Fi(\025)6 b(x)1421 1410 y Ff(0)1432 1406
y Fg(\034)1457 1422 y Fi(:)g(e)1489 1427 y Fd(2)89 1561
y Fk(App)12 b(0)p Fj(:)281 1496 y(\000)k Fz(`)f Fi(e)372
1501 y Fd(1)405 1496 y Fi(,)-6 b Fz(!)16 b(f)p Fi(\025)5
b(x)524 1485 y Fg(\034)550 1496 y Fi(:)g(e)q Fz(g)600
1485 y Ff(\005)281 1534 y Fj(\000)16 b Fz(`)f Fi(e)372
1539 y Fd(2)405 1534 y Fi(,)-6 b Fz(!)16 b Fi(v)477 1539
y Fd(2)281 1571 y Fz(\017)p Fi(;)5 b(x)10 b Fz(7!)g Fj(Real)o(\()p
Fi(v)489 1576 y Fd(2)506 1571 y Fj(\))20 b Fz(`)15 b
Fi(e)h(,)-6 b Fz(!)16 b Fi(v)p 244 1584 476 2 v 361 1623
a Fj(\000)g Fz(`)f Fi(e)452 1628 y Fd(1)480 1623 y Fi(e)496
1628 y Fd(2)529 1623 y Fi(,)-6 b Fz(!)16 b Fi(v)841 1561
y Fk(App)c(n+1)p Fj(:)1069 1534 y(\000)j Fz(`)h Fi(e)1160
1539 y Fd(1)1193 1509 y Fg(n)p Fd(+1)1202 1534 y Fi(,)-6
b Fz(!)25 b Fi(e)1282 1539 y Fd(3)1349 1534 y Fj(\000)16
b Fz(`)f Fi(e)1440 1539 y Fd(2)1473 1509 y Fg(n)p Fd(+1)1483
1534 y Fi(,)-6 b Fz(!)25 b Fi(e)1563 1539 y Fd(4)p 1050
1547 550 2 v 1165 1604 a Fj(\000)16 b Fz(`)f Fi(e)1256
1609 y Fd(1)1284 1604 y Fi(e)1300 1609 y Fd(2)1333 1580
y Fg(n)p Fd(+1)1342 1604 y Fi(,)-6 b Fz(!)26 b Fi(e)1423
1609 y Fd(3)1450 1604 y Fi(e)1466 1609 y Fd(4)89 1734
y Fk(V)m(ar)12 b(0)p Fj(:)250 1707 y(\000)e Fi(x)g Fj(=)g(Real)o(\()p
Fi(v)q Fj(\))p 232 1720 252 2 v 265 1759 a(\000)16 b
Fz(`)f Fi(x)h(,)-6 b Fz(!)16 b Fi(v)830 1734 y Fk(SV)m(ar)c(n+1)p
Fj(:)1068 1698 y(\000)e Fi(x)g Fj(=)g(Sym)n(\()p Fi(x)1268
1686 y Ff(0)1279 1698 y Fj(\))1293 1686 y Fg(\034)p 1049
1711 282 2 v 1083 1768 a Fj(\000)15 b Fz(`)h Fi(x)1193
1744 y Fg(n)p Fd(+1)1202 1768 y Fi(,)-6 b Fz(!)26 b Fi(x)1287
1757 y Ff(0)1398 1734 y Fk(R)-5 b(V)m(ar)13 b(n+1)p Fj(:)1650
1698 y(\000)d Fi(x)g Fj(=)g(Real)o(\()p Fi(v)q Fj(\))p
1621 1711 273 2 v 1639 1768 a(\000)16 b Fz(`)f Fi(x)1750
1744 y Fg(n)p Fd(+1)1759 1768 y Fi(,)-6 b Fz(!)25 b(")16
b Fi(v)841 1879 y Fk(EV)m(ar)c(n+1)p Fj(:)1121 1843 y
Fi(x)i(=)-22 b Fz(2)9 b Fj(\000)16 b Fz(`)p 1065 1856
242 2 v 1083 1914 a Fj(\000)g Fz(`)f Fi(x)1194 1889 y
Fg(n)p Fd(+1)1203 1914 y Fi(,)-6 b Fz(!)25 b Fi(x)89
2031 y Fk(Brac)o(k)o(et)13 b(0)p Fj(:)364 2013 y(\000)j
Fz(`)f Fi(e)455 2018 y Fd(1)500 1989 y(1)488 2013 y Fi(,)-6
b Fz(!)16 b Fi(e)559 2018 y Fd(2)p 305 2026 331 2 v 324
2065 a Fj(\000)g Fz(`)f Fh(<)o Fi(e)432 2070 y Fd(1)450
2065 y Fh(>)g Fi(,)-6 b Fz(!)16 b(h)p Fi(e)568 2070 y
Fd(2)586 2065 y Fz(i)600 2054 y Ff(\005)841 2031 y Fk(Brac)o(k)o(et)d
(n+1)p Fj(:)1156 2007 y(\000)j Fz(`)f Fi(e)1247 2012
y Fd(1)1280 1982 y Fg(n)p Fd(+1)1290 2007 y Fi(,)-6 b
Fz(!)25 b Fi(e)1370 2012 y Fd(2)p 1111 2020 321 2 v 1130
2072 a Fj(\000)16 b Fz(`)f Fh(<)p Fi(e)1239 2077 y Fd(1)1256
2072 y Fh(>)1300 2047 y Fg(n)1290 2072 y Fi(,)-6 b Fz(!)16
b Fh(<)o Fi(e)1378 2077 y Fd(2)1396 2072 y Fh(>)89 2192
y Fk(Escap)q(e)c(1)p Fj(:)310 2156 y(\000)j Fz(`)g Fi(e)400
2161 y Fd(1)434 2156 y Fi(,)-6 b Fz(!)16 b(h)p Fi(e)519
2161 y Fd(2)536 2156 y Fz(i)550 2144 y Ff(\005)p 291
2169 296 2 v 322 2226 a Fj(\000)g Fz(`)f Fh(~)r Fi(e)433
2231 y Fd(1)479 2202 y(1)467 2226 y Fi(,)-6 b Fz(!)16
b Fi(e)538 2231 y Fd(2)841 2192 y Fk(Escap)q(e)d(n+2)p
Fj(:)1146 2165 y(\000)j Fz(`)f Fi(e)1237 2170 y Fd(1)1270
2141 y Fg(n)p Fd(+1)1279 2165 y Fi(,)-6 b Fz(!)26 b Fi(e)1360
2170 y Fd(2)p 1097 2178 329 2 v 1116 2235 a Fj(\000)16
b Fz(`)f Fh(~)r Fi(e)1227 2240 y Fd(1)1260 2211 y Fg(n)p
Fd(+2)1270 2235 y Fi(,)-6 b Fz(!)44 b Fh(~)s Fi(e)1390
2240 y Fd(2)89 2355 y Fk(Run)13 b(0)p Fj(:)262 2329 y(\000)j
Fz(`)f Fi(e)h(,)-6 b Fz(!)16 b(h)p Fi(e)454 2334 y Fd(1)471
2329 y Fz(i)485 2317 y Ff(\005)542 2329 y Fz(\017)k(`)15
b Fi(e)633 2334 y Fd(1)666 2329 y Fi(,)-6 b Fz(!)16 b
Fi(v)738 2334 y Fd(1)p 243 2341 531 2 v 379 2381 a Fj(\000)g
Fz(`)f Fh(run)9 b Fi(e)16 b(,)-6 b Fz(!)16 b Fi(v)621
2386 y Fd(1)841 2355 y Fk(Run)d(n+1)p Fj(:)1131 2329
y(\000)j Fz(`)f Fi(e)1222 2334 y Fd(1)1256 2304 y Fg(n)p
Fd(+1)1265 2329 y Fi(,)-6 b Fz(!)25 b Fi(e)1345 2334
y Fd(2)p 1050 2341 395 2 v 1069 2399 a Fj(\000)15 b Fz(`)g
Fh(run)9 b Fi(e)1222 2404 y Fd(1)1256 2375 y Fg(n)p Fd(+1)1265
2399 y Fi(,)-6 b Fz(!)25 b Fh(run)9 b Fi(e)1408 2404
y Fd(2)89 2492 y Fk(Constan)o(t)k(0)p Fj(:)35 b(\000)16
b Fz(`)f(")g Fi(v)i(,)-6 b Fz(!)16 b Fi(v)298 b Fk(Constan)o(t)13
b(n+1)p Fj(:)35 b(\000)15 b Fz(`)g(")h Fi(v)1278 2468
y Fg(n)p Fd(+1)1287 2492 y Fi(,)-6 b Fz(!)25 b(")16 b
Fi(v)p 2106 2539 2 2614 v -76 2541 2183 2 v 659 2621
a Fx(Figure)e(1:)j Fo(The)f(Seman)o(tics)d(of)j Ft(\025)1241
2606 y Fl(M)p eop
%%Page: 9 9
9 8 bop -76 -34 a Fx(and)13 b(sym)o(b)q(olic)f(\(Sym)n(\()p
Ft(x)p Fx(\))327 -49 y Fp(t)342 -34 y Fx(\).)18 b(The)13
b(extension)h(of)f(the)h(en)o(viron-)-76 7 y(men)o(t)k(with)g(real)h(v)
n(alues)g(o)q(ccurs)h(only)e(in)g(the)h(rule)g Fk(App)f(0)p
Fx(.)-76 49 y(Suc)o(h)h(v)n(alues)g(are)g(returned)h(under)g(reduction)
f(\()p Fk(V)m(ar)f(0)p Fx(\),)h(or)-76 90 y(injected)14
b(in)o(to)d(constan)o(t)i(terms)g(\()p Fk(R)-5 b(V)m(ar)12
b(n+1)p Fx(\))g(under)i(rebuild-)-76 132 y(ing.)-20 173
y(Sev)o(eral)g(things)g(ab)q(out)g(rebuilding)f(should)h(b)q(e)g
(noted.)-33 245 y(1.)k(Rebuilding)d(replaces)j(all)e(free)h(v)n
(ariables)f(with)h(a)f(con-)18 286 y(stan)o(t)k(expression)i(\()p
Fs(")29 b Ft(v)q Fx(\))21 b(where)h(the)f Ft(v)h Fx(comes)e(from)18
328 y(Real\()p Ft(v)q Fx(\))14 b(bindings)f(in)g(\000)h(\()p
Fk(R)-5 b(V)m(ar)13 b(n+1)p Fx(\).)-33 399 y(2.)18 b(Rebuilding)10
b(renames)i(all)f(b)q(ound)h(v)n(ariables.)17 b(Sym)o(b)q(olic)18
441 y(Sym)n(\()p Ft(x)137 425 y Fl(0)149 441 y Fx(\))165
425 y Fp(t)197 441 y Fx(bindings)h(o)q(ccur)h(in)f(rules)h
Fk(Abs)e(0)h Fx(and)g Fk(Abs)18 482 y(n+1)12 b Fx(where)i(a)f(term)f
(is)h(rebuilt,)f(and)h(new)g(names)f(m)o(ust)18 524 y(b)q(e)i(in)o(tro)
q(duced)h(to)e(a)o(v)o(oid)g(p)q(oten)o(tial)g(v)n(ariable)g(capture.)
18 565 y(These)i(new)f(names)f(are)i(pro)r(jected)g(from)d(the)j(en)o
(viron-)18 607 y(men)o(t)d(in)i(rule)g Fk(SV)m(ar)e(n+1)p
Fx(.)-33 678 y(3.)18 b(Rebuilding)10 b(executes)15 b(escap)q(ed)e
(expressions)h(to)e(obtain)18 720 y(co)q(de)e(to)g(\\splice")f(in)o(to)
g(the)i(con)o(text)f(where)h(the)g(escap)q(ed)18 761
y(term)i(o)q(ccurs)i(\()p Fk(Escap)q(e)e(1)p Fx(\).)-20
832 y(Without)h(the)i(staging)e(annotations,)g(rebuilding)g(is)h(sim-)
-76 874 y(ply)h(capture-free)j(substitution)d(of)g(the)h(sym)o(b)q
(olic)e(v)n(ariables)-76 915 y(b)q(ound)k(in)f(\000.)31
b(Rebuilding)17 b(is)h(initiated)f(in)h(t)o(w)o(o)g(places,)i(in)-76
957 y(rule)12 b Fk(Abs)e(0)h Fx(where)i(it)e(is)g(used)h(for)f
(capture-free)i(substitution,)-76 998 y(and)k(in)g(rule)g
Fk(Brac)o(k)o(et)f(0)i Fx(where)g(it)f(is)g(applied)f(to)h(terms)g(in-)
-76 1040 y(side)c(dynamic)e(brac)o(k)o(ets)j(and)f(it)f(describ)q(es)j
(ho)o(w)d(the)i(dela)o(y)o(ed)-76 1081 y(computations)f(inside)h(a)f
(dynamic)f(v)n(alue)i(are)g(constructed.)-20 1123 y(The)k(t)o(yp)q(e)h
(system)e(ensures)j(that)e(in)f(rule)h Fk(Abs)f(0)p Fx(,)h(there)-76
1165 y(are)13 b(no)e(em)o(b)q(edded)h(escap)q(es)i(at)e(lev)o(el)g(1)g
(that)g(will)e(b)q(e)j(encoun-)-76 1206 y(tered)18 b(b)o(y)e(the)h
(rebuilding)e(pro)q(cess,)j(so)f(rebuilding)e(actually)-76
1248 y(implemen)o(ts)d(capture-free)j(substitution)f(as)g(adv)o
(ertised.)-20 1289 y(The)g(rules)g Fk(Escap)q(e)e(1)p
Fx(,)h Fk(Run)g(0)p Fx(,)g(and)h Fk(Brac)o(k)o(et)e(0)i
Fx(are)g(at)f(the)-76 1331 y(heart)i(of)e(the)h(dynamic)f(seman)o
(tics.)-20 1372 y(In)j(the)g(rebuilding)f(rule)i Fk(Escap)q(e)d(1)p
Fx(,)i(an)g(escap)q(ed)h(expres-)-76 1414 y(sion)d(at)f(lev)o(el)h(1)f
(indicates)h(a)g(computation)e(m)o(ust)h(pro)q(duce)i(a)-76
1455 y(co)q(de)k(v)n(alued)e(result)i(\()p Fs(h)p Ft(e)329
1461 y Fu(2)348 1455 y Fs(i)364 1440 y Fl(\005)384 1455
y Fx(\),)f(and)g(rebuilding)f(returns)j(the)-76 1497
y(term)13 b Ft(e)42 1503 y Fu(2)61 1497 y Fx(.)-20 1538
y(The)k(reduction)h(rule)f Fk(Brac)o(k)o(et)e(0)i Fx(describ)q(es)i(ho)
o(w)d(a)h(co)q(de)-76 1580 y(v)n(alue)d(is)h(constructed)i(from)c(a)h
(meta-brac)o(k)o(eted)h(term)f Fr(<)p Ft(e)868 1586 y
Fu(1)887 1580 y Fr(>)p Fx(.)-76 1621 y(The)i(em)o(b)q(edded)f
(expression)h(is)e(rebuilt)h(at)g(lev)o(el)g(1,)f(and)h(the)-76
1663 y(returned)h(term)d(is)h(injected)g(in)o(to)g(the)g(domain)e(of)h
(v)n(alues.)-20 1704 y(The)i(reduction)g(rule)g Fk(Run)e(0)i
Fx(describ)q(es)h(ho)o(w)e(a)h(co)q(de)g(v)n(al-)-76
1746 y(ued)j(term)f(is)g(executed.)30 b(The)18 b(term)e(is)h(reduced)i
(to)f(a)f(co)q(de)-76 1787 y(v)n(alued)g(term,)h(and)f(the)h(em)o(b)q
(edded)g(term)f(is)g(then)i(reduced)-76 1829 y(in)14
b(the)h(empt)o(y)e(en)o(vironmen)o(t)h(to)g(pro)q(duce)i(the)f(answ)o
(er.)20 b(The)-76 1870 y(empt)o(y)f(en)o(vironmen)o(t)g(is)g
(su\016cien)o(t)i(b)q(ecause)g(all)e(free)h(v)n(ari-)-76
1912 y(ables)g(in)g(the)g(original)e(co)q(de)j(v)n(alued)f(term)f(ha)o
(v)o(e)h(b)q(een)h(re-)-76 1953 y(placed)14 b(b)o(y)g(constan)o(t)g
(expressions)i(\()p Fs(")i Ft(v)q Fx(\).)-76 2072 y Fy(11)53
b(Optimizations)-76 2170 y(11.1)f(Safe)18 b(Beta)g(Reduction)-76
2238 y Fx(T)m(o)c(write)g(m)o(ulti-stage)e(programs)h(e\013ectiv)o(ely)
m(,)i(one)f(needs)i(to)-76 2280 y(observ)o(e)22 b(the)g(programs)e(pro)
q(duced,)k(and)d(these)i(programs)-76 2321 y(should)18
b(b)q(e)h(as)f(simple)f(as)h(p)q(ossible.)31 b(F)m(or)18
b(this)g(reason,)h(our)-76 2363 y(implemen)o(tation)9
b(p)q(erforms)j(automatic)e Fw(safe-b)n(eta)j(r)n(e)n(duction)-76
2404 y Fx(on)i(constan)o(ts)h(and)f(v)n(ariables.)22
b(A)15 b(b)q(eta)h(reduction)g(is)f(safe)g(if)-76 2446
y(it)h(do)q(es)g(not)g(c)o(hange)g(ev)n(aluation)e(order,)j(or)e
(e\013ect)j(termina-)-76 2487 y(tion)h(prop)q(erties.)35
b(There)20 b(is)f(one)g(safe)h(case)g(whic)o(h)f(is)g(par-)-76
2529 y(ticularly)g(easy)h(to)g(recognize,)i(namely)m(,)c(Plotkin's)h
Ft(\014)811 2535 y Fp(v)851 2529 y Fx(rule)-76 2570 y([26)o(].)e
(Whenev)o(er)d(an)e(application)f(is)h(constructed)j(where)f(the)-76
2612 y(function)e(part)f(is)h(an)g(explicit)f(lam)o(b)q(da)e
(abstraction,)j(and)g(the)1020 -34 y(argumen)o(t)i(part)h(is)f(a)g(v)n
(alue,)g(then)i(that)e(application)g(can)h(b)q(e)1020
7 y(sym)o(b)q(olically)d(b)q(eta)k(reduced.)24 b(In)15
b(order)h(to)f(a)o(v)o(oid)f(duplicat-)1020 49 y(ing)i(co)q(de)i(w)o(e)
f(restrict)h(our)f(optimizations)d(to)j(constan)o(ts)g(or)1020
90 y(v)n(ariables)c(\(while)g(Plotkin's)f Ft(\014)1513
96 y Fp(v)1547 90 y Fx(rule)i(also)e(allo)o(ws)h(the)h(v)n(alues)1020
132 y(to)g(b)q(e)g(lam)o(b)q(da)e(expressions\).)20 b(F)m(or)13
b(example)g(in:)1020 203 y Fr(val)21 b(g)h(=)f(<fn)h(x)f(=>)h(x)f(*)h
(5>;)1020 245 y(val)f(h)h(=)f(<fn)h(x)f(=>)h(\(~g)f(x\))g(-)h(2>;)1020
316 y Fx(The)e(v)n(ariable)f(h)h(ev)n(aluates)g(to:)30
b Fr(<fn)22 b(d1)f(=>)g(\(d1)h(*)f(5\))h(-)1020 358 y(2>)e
Fx(rather)h(than)g Fr(<fn)g(d1)g(=>)h(\(\(fn)f(d2)g(=>)h(d2)f(*)h(5\))f
(d1\))1020 399 y(-)h(2>)p Fx(.)1076 441 y(W)m(e)c(realize)h(of)f
(course)i(that)f(this)f(migh)o(t)f(mak)o(e)g(it)h(hard)1020
482 y(to)12 b(understand)h Fw(why)f Fx(a)g(particular)f(program)g(w)o
(as)g(generated.)1020 524 y(In)19 b(our)g(exp)q(erience,)j(the)e
(resulting)f(smaller,)g(simpler)e(pro-)1020 565 y(grams,)12
b(are)i(easier)h(to)f(understand)h(and)e(mak)o(e)g(this)h(tradeo\013)
1020 607 y(w)o(orth)o(while.)1020 721 y Fy(11.2)52 b(Nested)17
b(Escap)q(es)1020 789 y Fx(When)10 b(w)o(e)f(\014rst)h(wrote)g
(programs)e(with)i(more)e(than)h(t)o(w)o(o)g(lev)o(els)1020
831 y(w)o(e)j(observ)o(ed)h(that)f(our)g(programs)e(to)q(ok)i(a)f(long)
g(time)g(to)g(run.)1020 872 y(W)m(e)19 b(traced)i(this)e(to)h(rule)g
Fk(Escap)q(e)e(n+2)h Fx(of)g(our)g(seman)o(tics.)1020
914 y(Consider)e(the)g(case)g(where)g(a)f(deeply)h(brac)o(k)o(eted)g
(term)f Ft(e)g Fx(at)1020 956 y(lev)o(el)i Ft(n)g Fx(is)g(escap)q(ed)i
(all)d(the)i(w)o(a)o(y)e(to)i(lev)o(el)e(0.)31 b(In)18
b(order)h(to)1020 997 y(execute)d(this)e(term)g(\(whic)o(h)g(escap)q
(es)i(to)e(lev)o(el)g(0\))g(it)g(m)o(ust)f(b)q(e)1020
1039 y(rebuilt)g Ft(n)f Fx(times.)17 b(Consider)12 b(the)i(reduction)f
(sequence)i(b)q(elo)o(w)1020 1080 y(for)h(the)h(term)f
Fr(run)21 b(\(run)g(<<)h(~)l(~)l(e)g(>>\))p Fx(,)15 b(where)j
Fr(e)e Fx(is)g(b)q(ound)1020 1122 y(in)d(\000)h(to)g
Fr(<5>)p Fx(,)f(of)g(whic)o(h)h(w)o(e)g(sho)o(w)g(only)f(the)h
(innermost)f Fr(run)p Fx(.)1215 1202 y Ft(e)18 b(,)-7
b Fs(!)18 b(h)p Fr(<)p Fx(5)p Fr(>)o Fs(i)1413 1187 y
Fl(\005)p 1088 1216 472 2 v 1226 1278 a Fr(~)7 b Ft(e)1307
1250 y Fu(1)1292 1278 y Ft(,)-7 b Fs(!)18 b Fr(<)p Fx(5)p
Fr(>)p 1088 1292 V 1197 1354 a(~)7 b(~)g Ft(e)1307 1326
y Fu(2)1292 1354 y Ft(,)-7 b Fs(!)18 b Fr(~)7 b(<)o Fx(5)p
Fr(>)p 1088 1368 V 1154 1429 a(<~)f(~)h Ft(e)p Fr(>)1307
1402 y Fu(1)1292 1429 y Ft(,)-7 b Fs(!)18 b Fr(<~)6 b(<)p
Fx(5)p Fr(>>)p 1088 1443 V 1106 1486 a(<<~)h(~)f Ft(e)p
Fr(>>)19 b Ft(,)-7 b Fs(!)17 b(h)p Fr(<~)7 b(<)o Fx(5)p
Fr(>>)p Fs(i)1522 1471 y Fl(\005)1722 1297 y Fx(5)1776
1270 y Fu(1)1761 1297 y Ft(,)-7 b Fs(!)18 b Fx(5)p 1620
1311 330 2 v 1674 1354 a Fr(<)p Fx(5)p Fr(>)g Ft(,)-7
b Fs(!)18 b(h)p Fx(5)p Fs(i)1875 1339 y Fl(\005)p 1620
1368 V 1686 1429 a Fr(~)6 b(<)p Fx(5)p Fr(>)1812 1402
y Fu(1)1797 1429 y Ft(,)-7 b Fs(!)18 b Fx(5)p 1620 1443
V 1638 1486 a Fr(<~)7 b(<)o Fx(5)p Fr(>>)18 b Ft(,)-7
b Fs(!)18 b(h)p Fx(5)p Fs(i)1911 1471 y Fl(\005)p 1069
1500 899 2 v 1320 1542 a Fr(run)11 b(<<~)6 b(~)h Ft(e)p
Fr(>>)18 b Ft(,)-7 b Fs(!)18 b(h)p Fx(5)p Fs(i)1697 1527
y Fl(\005)1020 1625 y Fx(F)m(or)g(t)o(w)o(o)h(lev)o(els)f(the)i(term)e
(is)g(rebuilt)h(2)f(times.)32 b(F)m(or)18 b(three)1020
1666 y(lev)o(els)d(the)h(term)e(is)h(rebuilt)g(3)g(times.)20
b(A)15 b(simple)f(re\014nemen)o(t)1020 1708 y(can)19
b(prev)o(en)o(t)g(this)g(from)d(happ)q(ening.)32 b(W)m(e)18
b(c)o(hange)h(the)g(re-)1020 1749 y(building)12 b(of)h(escap)q(ed)i
(expressions)g(at)f(lev)o(els)f(greater)i(than)f(1)1020
1791 y(b)o(y)i(adding)f(the)h(rule)g Fk(Escap)q(e)f(Opt)f(n+2)i
Fx(in)f(addition)g(to)h(the)1020 1832 y(rule)e Fk(Escap)q(e)f(n+2)p
Fx(.)1154 1960 y Fk(Escap)q(e)f(Opt)h(n+2)p Fj(:)1518
1931 y Fx(\000)19 b Fs(`)g Ft(e)1626 1937 y Fu(1)1663
1903 y Fp(n)p Fu(+1)1671 1931 y Ft(,)-7 b Fs(!)26 b Fr(<)p
Ft(e)1785 1937 y Fu(2)1804 1931 y Fr(>)p 1496 1945 353
2 v 1514 2006 a Fx(\000)19 b Fs(`)g Fr(~)6 b Ft(e)1650
2012 y Fu(1)1688 1979 y Fp(n)p Fu(+2)1696 2006 y Ft(,)-7
b Fs(!)49 b Ft(e)1811 2012 y Fu(2)1181 2177 y Fk(Escap)q(e)12
b(n+2)p Fj(:)1499 2148 y Fx(\000)18 b Fs(`)h Ft(e)1606
2154 y Fu(1)1644 2121 y Fp(n)p Fu(+1)1652 2148 y Ft(,)-7
b Fs(!)26 b Ft(e)1744 2154 y Fu(2)p 1440 2162 382 2 v
1459 2224 a Fx(\000)18 b Fs(`)h Fr(~)7 b Ft(e)1595 2230
y Fu(1)1632 2196 y Fp(n)p Fu(+2)1640 2224 y Ft(,)-7 b
Fs(!)49 b Fr(~)7 b Ft(e)1784 2230 y Fu(2)1020 2307 y
Fx(Th)o(us)k(a)g(long)e(sequence)k(of)e(escap)q(es)h(surrounded)h(b)o
(y)d(an)h(equal)1020 2348 y(n)o(um)o(b)q(er)i(of)h(brac)o(k)o(ets)g
(gets)h(rebuilt)f(exactly)g(one.)k(This)c(opti-)1020
2390 y(mization)d(is)i(safe)g(since)h(there)g(are)g(no)f(v)n(ariables)f
(in)h(a)f(rebuilt)1020 2431 y(term.)17 b(So)12 b(rebuilding)g(it)g
(more)f(than)h(once)i(p)q(erforms)d(no)i(use-)1020 2473
y(ful)i(w)o(ork.)23 b(This)16 b(correctness)j(of)c(this)h(optimization)
d(follo)o(ws)1020 2514 y(from)g(the)j(fact)e(that)h(under)h(our)f
(seman)o(tics)f Fr(~)7 b(<)p Ft(e)p Fr(>)15 b Fx(is)f(alw)o(a)o(ys)1020
2556 y(equal)g(to)f Ft(e)p Fx(.)p eop
%%Page: 10 10
10 9 bop -62 -33 2112 2 v -63 15 2 48 v -40 3 a Fo(F)l(acilit)o(y)p
397 15 V 306 w(Example)p 725 15 V 145 w Fx(NN)14 b([25)o(])p
910 15 V 44 w(GA)g([11)o(])p 1097 15 V 44 w(GB)g([9)o(])p
1261 15 V 45 w(Th)g([31)o(])p 1438 15 V 44 w(HG)g([12)o(])p
1625 15 V 44 w Ft(\025)1672 -12 y Fc(2)1711 3 y Fx([7])p
1777 15 V 44 w Ft(\025)1824 -12 y Fl(\015)1873 3 y Fx([6])p
1939 15 V 44 w Ft(\025)1986 -12 y Fl(M)p 2049 15 V -62
17 2112 2 v -63 58 2 42 v -40 46 a Fx(Staging)p 397 58
V 324 w Fr(<)o Ft(\025)p Fr(x.x>)p 725 58 V 254 w Fx(2)p
910 58 V 165 w(2)p 1097 58 V 149 w(+)p 1261 58 V 144
w(2)p 1438 58 V 155 w(+)p 1625 58 V 137 w(+)p 1777 58
V 125 w(+)p 1939 58 V 104 w(+)p 2049 58 V -62 60 2112
2 v -63 101 2 42 v -40 89 a(Strong)g(T)o(yping)p 397
101 V 725 101 V 579 w(Y)p 910 101 V 160 w(1)p 1097 101
V 150 w(N)p 1261 101 V 139 w(N)p 1438 101 V 151 w(N)p
1625 101 V 138 w(Y)p 1777 101 V 126 w(Y)p 1939 101 V
105 w(Y)p 2049 101 V -62 103 2112 2 v -63 145 2 42 v
-40 132 a(Monolithic)f(V)m(ariables)p 397 145 V 85 w
Fr(<)o Ft(\025)p Fr(x.)q(~)l(\(f)21 b(<x>)o(\)>)p 725
145 V 100 w Fx(Y)p 910 145 V 155 w(Y)p 1097 145 V 145
w(Y)p 1261 145 V 139 w(Y)p 1438 145 V 151 w(Y)p 1625
145 V 138 w(N)p 1777 145 V 126 w(Y)p 1939 145 V 105 w(Y)p
2049 145 V -62 146 2112 2 v -63 188 2 42 v -40 175 a(Re\015ection)p
397 188 V 281 w Fr(run)g(or)g Ft(ev)q(al)p 725 188 V
156 w Fx(N)p 910 188 V 155 w(N)p 1097 188 V 145 w(N)p
1261 188 V 139 w(Y)p 1438 188 V 151 w(N)p 1625 188 V
138 w(Y)p 1777 188 V 126 w(N)p 1939 188 V 105 w(Y)p 2049
188 V -62 189 2112 2 v -63 237 2 48 v -40 225 a(Lifting)p
397 237 V 338 w Fr(lift)p 725 237 V 294 w Fx(Y)p 910
237 V 155 w(Y)p 1097 237 V 145 w(Y)p 1261 237 V 139 w(Y)p
1438 237 V 151 w(Y)p 1625 237 V 128 w(Y)1707 210 y Fp(a)p
1777 237 V 1835 225 a Fx(Y)1866 210 y Fp(b)p 1939 237
V 1979 225 a Fx(Y)p 2049 237 V -62 239 2112 2 v -63 280
2 42 v -40 268 a(X-Stage)14 b(P)o(ersistance)p 397 280
V 102 w Ft(\025)p Fr(f.<)o Ft(\025)p Fr(x.f)22 b(x)o(>)p
725 280 V 138 w Fx(N)p 910 280 V 155 w(N)p 1097 280 V
145 w(N)p 1261 280 V 139 w(N)p 1438 280 V 151 w(N)p 1625
280 V 138 w(N)p 1777 280 V 126 w(N)p 1939 280 V 105 w(Y)p
2049 280 V -62 282 2112 2 v -63 323 2 42 v -40 311 a(X-Platform)12
b(P)o(ortabilit)o(y)p 397 323 V 725 323 V 426 w(Y)p 910
323 V 155 w(Y)p 1097 323 V 145 w(Y)p 1261 323 V 139 w(Y)p
1438 323 V 151 w(Y)p 1625 323 V 138 w(Y)p 1777 323 V
126 w(Y)p 1939 323 V 105 w(N)p 2049 323 V -62 325 2112
2 v -76 348 480 2 v -34 369 a Fb(a)-16 382 y Fu(Can)e(b)q(e)i
(expressed)g(at)e(eac)o(h)h(ground)g(datat)o(yp)q(e)g(man)o(ually)m(.)
-31 406 y Fb(b)-16 419 y Fu(Can)f(b)q(e)i(expressed)g(at)e(eac)o(h)h
(ground)g(datat)o(yp)q(e)g(man)o(ually)m(.)661 503 y
Fx(Figure)j(2:)j(Comparativ)o(e)12 b(feature)j(set)-76
628 y Fy(12)53 b(Discussion)18 b(and)f(Related)i(W)l(orks)-76
710 y Fx(A)10 b(summary)d(of)j(the)g(distinguishing)f(c)o
(haracteristics)i(of)f(other)-76 752 y(w)o(ork)15 b(on)f(m)o
(ulti-stage)f(languages)i(is)g(sho)o(wn)g(in)f(\014gure)h(2.)21
b(In)-76 793 y(the)13 b(\014gure)g(w)o(e)f(list)g(whether)h(or)f(not)h
(that)f(w)o(ork)g(con)o(tains)g(the)-76 835 y(prop)q(erties)g(w)o(e)f
(b)q(eliev)o(e)g(to)f(b)q(e)i(imp)q(ortan)o(t.)j(Those)c(prop)q(erties)
-76 876 y(are:)-22 956 y Fs(\017)19 b Fx(Staging:)d(Staging)11
b(can)h(b)q(e)h(expressed)h(in)e(all)f(these)i(lan-)18
997 y(guages,)e(in)g(the)h(sense)h(that)e(co)q(de)h(represen)o(ting)h
(expres-)18 1039 y(sions)h(can)h(b)q(e)h(expressed,)h(and)d(that)h
(applications)f(can)18 1080 y(b)q(e)d(dela)o(y)o(ed)f(to)g(future)h
(stages.)18 b(In)10 b(this)g(ro)o(w,)h(\\2")e(means)18
1122 y(t)o(w)o(o)19 b(stages)i(are)g(supp)q(orted,)h(and)e(\\+")g
(means)f(arbi-)18 1164 y(trary)14 b(n)o(um)o(b)q(er)f(of)g(stages)i(is)
f(supp)q(orted.)-22 1235 y Fs(\017)19 b Fx(Strong)14
b(T)o(yping:)k(In)c(a)g(single)g(stage)h(language,)e(strong)18
1276 y(t)o(yping)f(ensures)i(that)f(a)g(w)o(ell-t)o(yp)q(ed)f(program)f
(\\cannot)18 1318 y(go)j(wrong")h(b)o(y)g(applying)f(functions)h(to)g
(argumen)o(ts)g(of)18 1359 y(the)c(wrong)g(t)o(yp)q(e.)18
b(In)11 b(addition,)f(m)o(ulti-stage)f(programs)18 1401
y(can)15 b(go)g(wrong)g(if)g(a)g(computation)e(attempts)i(to)g(use)i(a)
18 1442 y(v)n(ariable)g(b)q(efore)j(it)e(is)h(a)o(v)n(ailable.)30
b(A)19 b(strongly)g(t)o(yp)q(ed)18 1484 y(m)o(ulti-stage)c(language)h
(protects)j(against)e(b)q(oth)g(kinds)18 1525 y(of)c(errors.)-22
1597 y Fs(\017)19 b Fx(Monolithic)8 b(V)m(ariables:)15
b(Whether)10 b(a)f(v)n(ariable)g(from)e(one)18 1638 y(stage)17
b(can)h(b)q(e)g(used)h(in)e(all)f(reasonable)i(w)o(a)o(ys)f(at)g(that)
18 1680 y(same)e(stage.)26 b(In)17 b(the)g(example,)e
Fr(f)h Fx(is)g(applied)g(to)h Fr(<)o(x>)p Fx(,)18 1721
y(and)c(hence)j Fr(f)d Fx(is)h(acting)f(as)h(a)g(\\co)q(de)h
(transformer".)-22 1793 y Fs(\017)k Fr(run)h Fx(or)g
Ft(ev)q(al)j Fx(function:)31 b(The)21 b(languages)f(also)g(come)18
1834 y(with)10 b(di\013eren)o(t)j(set)f(of)f(m)o(ulti-stage)e
(programmi)o(ng)f(con-)18 1876 y(structs.)28 b(In)16
b(particular,)h(not)g(all)e(the)i(language)f(allo)o(w)18
1917 y(re\015ection)j(in)f(the)i(form)d(of)h(a)g Fr(run)g
Fx(or)g Ft(ev)q(al)j Fx(function.)18 1959 y(Most)g(notably)m(,)h(ev)o
(en)h(in)e(the)h(most)e(recen)o(t)k(w)o(ork)d(of)18 2000
y(Da)o(vies,)d(it)g(w)o(as)g(not)g(kno)o(wn)f(ho)o(w)h
Ft(ev)q(al)i Fx(could)e(b)q(e)h(in-)18 2042 y(cluded)14
b(in)f(the)i(language)e([6)o(].)-22 2113 y Fs(\017)19
b Fx(Lifting:)i(The)c(abilit)o(y)e(to)h(con)o(v)o(ert)i(a)e(v)n(alue)g
(of)f(ground)18 2155 y(t)o(yp)q(e)f(in)o(to)f(its)h(represen)o(tation)h
(as)f(a)g(literal.)-22 2226 y Fs(\017)19 b Fx(Cross-Stage)e(P)o
(ersistence:)27 b(This)16 b(is)h(the)g(most)f(distin-)18
2268 y(guishing)k(feature)i(of)f(MetaML,)g(and)g(has)g(b)q(een)i(dis-)
18 2309 y(cussed)17 b(in)d(detail)h(in)g(this)g(pap)q(er.)23
b(T)m(o)15 b(our)g(kno)o(wledge,)18 2351 y(this)22 b(feature)h(has)g
(not)f(b)q(een)i(prop)q(osed)f(or)g(incorp)q(o-)18 2392
y(rated)12 b(in)o(to)f(an)o(y)g(m)o(ulti-stage)f(programmi)o(ng)f
(language.)18 2434 y(In)14 b(essence,)i(cross-stage)g(p)q(ersistence)g
(means)e(that)g(the)18 2475 y(programmer)9 b(can)j(use)g(a)f(v)n
(ariable)g(b)q(ound)h(in)f(an)o(y)g(stage)18 2517 y(in)h(an)h
(expression)i(executed)g(in)e(an)o(y)g(future)h(stage.)k(Al-)18
2558 y(ternativ)o(ely)m(,)e(it)g(allo)o(ws)f(us)h(to)h(stage)f
(expressions)i(con-)18 2600 y(taining)c(free)j(v)n(ariables,)f(as)g
(long)f(as)h(the)h(t)o(yp)q(e)g(system)1113 628 y(is)12
b(satis\014ed)g(that)f(these)i(v)n(ariables)e(are)g(a)o(v)n(ailable)f
(b)q(efore)1113 669 y(this)k(expression)h(is)f(ev)n(aluated.)1074
741 y Fs(\017)k Fx(Cross-Platform)h(P)o(ortabilit)o(y:)28
b(The)20 b(abilit)o(y)e(to)h(prin)o(t)1113 782 y(generated)h(co)q(de)f
(as)f(text.)32 b(This)18 b(allo)o(ws)f(co)q(de)j(gener-)1113
824 y(ated)e(on)f(one)h(mac)o(hine)e(to)h(b)q(e)h(compiled)e(and)h(run)
g(on)1113 865 y(other)d(mac)o(hines.)j(If)c(co)q(de)h(em)o(b)q(eds)g
(its)f(o)o(wn)g(\\lo)q(cal)f(en-)1113 907 y(vironmen)o(t")j(this)h(b)q
(ecomes)h(considerably)f(more)f(di\016-)1113 948 y(cult.)25
b(The)16 b(loss)g(of)g(this)g(abilit)o(y)e(is)i(the)h(price)f(paid)g
(for)1113 990 y(cross)f(stage)g(p)q(ersistence.)1076
1069 y(In)20 b(what)f(follo)o(ws)g(is)g(an)h(historical)f(p)q(ersp)q
(ectiv)o(e)j(of)d(the)1020 1111 y(w)o(ork)14 b(highligh)o(ted)e(in)i
(the)g(table:)1074 1190 y Fs(\017)k Fx(NN:)e(Nielson)f(and)h(Nielson)f
(pioneered)i(the)f(in)o(v)o(estiga-)1113 1232 y(tion)d(of)f(staged)i
(languages)e(with)h(their)g(t)o(w)o(o-lev)o(el)f(func-)1113
1274 y(tional)i(language)g([25)o(,)g(24].)20 b(They)15
b(presen)o(ted)i(rules)f(for)1113 1315 y(the)11 b(w)o(ell-formedness)f
(of)f(the)i(binding-times)d(of)i(expres-)1113 1357 y(sions)15
b(in)e(the)i(language,)d(from)h(whic)o(h)g(MetaML's)i(t)o(yp)q(e)1113
1398 y(rules)c(are)f(deriv)o(ed.)17 b(They)10 b(also)f(sk)o(etc)o(hed)i
(guidelines)f(for)1113 1440 y(a)k(m)o(ulti-stage)f(\(\\)p
Ft(B)r Fx(-lev)o(el"\))h(language.)k(The)d(t)o(w)o(o-lev)o(el)1113
1481 y(language)i(is)g(widely)g(used)h(to)g(describ)q(e)h(binding-time)
1113 1523 y(annotations)14 b(in)f(the)i(partial)d(ev)n(aluation)h
(literature.)1074 1594 y Fs(\017)18 b Fx(GA:)10 b(Gomard)f(and)h(Jones)
i(use)f(a)g(statically-t)o(yp)q(ed)f(t)o(w)o(o-)1113
1635 y(stage)22 b(language)d(for)i(partial)f(ev)n(aluation)f(of)h(the)h
(un-)1113 1677 y(t)o(yp)q(ed)h Ft(\025)p Fx(-calculus)f([11)o(].)39
b(The)22 b(language)e(allo)o(ws)g(the)1113 1719 y(treatmen)o(t)10
b(of)e(expressions)j(con)o(taining)d(monolithic)f(free)1113
1760 y(v)n(ariables.)27 b(They)17 b(use)h(a)f(\\const")g(construct)h
(only)f(for)1113 1802 y(constan)o(ts)g(of)e(ground)g(t)o(yp)q(e.)23
b(Our)16 b(treatmen)o(t)f(of)g(v)n(ari-)1113 1843 y(ables)i(in)e(the)i
(formal)d(seman)o(tics)i(is)g(inspired)g(b)o(y)g(their)1113
1885 y(w)o(ork.)1074 1956 y Fs(\017)i Fx(GB:)10 b(Gl)q(\177)-22
b(uc)o(k)9 b(and)h(J\034rgensen)h([9)o(])e(presen)o(t)j(the)e(no)o(v)o
(el)g(idea)1113 1997 y(of)h(m)o(ulti-lev)o(el)e(BT)m(A,)i(as)h(a)f(v)o
(ery)h(e\016cien)o(t)g(and)g(e\013ectiv)o(e)1113 2039
y(alternate)i(to)e(m)o(ultiple)f(self-application.)16
b(An)d(un)o(t)o(yp)q(ed)1113 2080 y(m)o(ulti-lev)o(el)h(language)i
(based)h(on)f(Sc)o(heme)g(is)g(used)i(for)1113 2122 y(the)i(presen)o
(tation.)33 b(Our)19 b(study)g(of)f(MetaML)h(is)f(at)h(a)1113
2164 y(more)13 b(basic)g(lev)o(el:)18 b(MetaML)c(is)f(an)g(abstract)i
(calculus.)1113 2205 y(It)10 b(is)g(also)f(notable)g(that)h(all)e(in)o
(termediate)h(results)i(in)e(GJ)1113 2247 y(are)15 b(prin)o(table,)f
(i.e.,)g(ha)o(v)o(e)g(an)h(in)o(tensional)e(represen)o(ta-)1113
2288 y(tion.)k(In)11 b(MetaML,)f(cross-stage)j(p)q(ersistence)g(allo)o
(ws)d(us)1113 2330 y(to)j(ha)o(v)o(e)f(in)o(termediate)g(results)i(\(b)
q(et)o(w)o(een)g(stages\))f(that)1113 2371 y(con)o(tain)k(constan)o(ts)
h(for)f(whic)o(h)g(no)f(in)o(ten)o(tional)g(repre-)1113
2413 y(sen)o(tation)k(is)e(a)o(v)n(ailable.)32 b(While)18
b(this)h(is)g(v)o(ery)g(con)o(v)o(e-)1113 2454 y(nien)o(t)f(for)g
(run-time)f(co)q(de)i(generation,)f(it)g(mak)o(es)f(the)1113
2496 y(prop)q(er)12 b(sp)q(eci\014cation)f(of)f(MetaML)h(more)e
(di\016cult.)17 b(F)m(or)1113 2537 y(example,)11 b(w)o(e)g(can't)g(use)
h([9]'s)e(\\Generic)i(Co)q(de)g(Genera-)1113 2579 y(tion)e(functions")g
(to)f(de\014ne)i(the)g(language.)16 b(A)10 b(latter)g(pa-)1113
2620 y(p)q(er)17 b([10)o(])f(demonstrates)g(the)h(impressiv)o(e)e
(e\016ciency)i(of)p eop
%%Page: 11 11
11 10 bop 18 -34 a Fx(MBT)m(A,)9 b(and)h(the)g(use)h(of)e(constrain)o
(ts-solving)h(metho)q(ds)18 7 y(to)g(p)q(erform)g(the)h(analysis.)16
b(The)11 b(MBT)m(A)f(is)h(t)o(yp)q(e-based,)18 49 y(but)j(underlying)f
(language)g(is)h(dynamically)d(t)o(yp)q(ed.)-22 117 y
Fs(\017)19 b Fx(Th:)28 b(Thiemann)18 b([31)o(])h(studies)h(a)f(t)o(w)o
(o-lev)o(el)f(language)18 158 y(with)d Fr(eval)o Fx(,)g(apply)m(,)f
(and)i Fr(call/cc)n Fx(,)g(in)f(the)h(con)o(text)g(of)18
200 y(studying)c(the)i(partial)d(ev)n(aluation)h(of)g(a)g(greater)i
(subset)18 241 y(of)c(sc)o(heme)h(than)g(w)o(as)g(done)g(previously)m
(.)17 b(A)11 b(BT)m(A)g(based)18 283 y(on)17 b(constrain)o(t-solving)f
(is)i(presen)o(ted.)31 b(Although)17 b(the)18 324 y(problems)12
b(with)i Fr(eval)f Fx(and)h Fr(call/cc)e Fx(are)i(highligh)o(ted,)18
366 y(and)h(unlik)o(e)g(with)g(MetaML,)g(there)i(is)e(no)h(explicit)f
(no-)18 407 y(tion)g(of)g(partially)e(static)j(t)o(yp)q(es,)h(an)e(so,)
h(the)g(complex-)18 449 y(it)o(y)c(of)g(in)o(tro)q(ducing)h(ev)n(al)f
(in)o(to)h(a)f(m)o(ulti-stage)f(language)18 490 y(do)q(es)h(not)f
(manifest)f(itself.)17 b(Thiemann)10 b(also)h(deals)h(with)18
532 y(the)22 b(issue)h(of)e(v)n(ariable-arit)o(y)f(functions,)j(whic)o
(h)f(is)g(a)18 573 y(practical)9 b(problem)f(when)h(dealing)g(with)g
Fr(eval)f Fx(in)h(Sc)o(heme.)-22 642 y Fs(\017)19 b Fx(HG:)c
(Hatcli\013)h(&)h(Gl)q(\177)-22 b(uc)o(k)16 b(studied)h(a)f(m)o
(ulti-stage)e(\015o)o(w-)18 683 y(c)o(hart)i(language)f(called)h
(S-Graph-n,)g(and)g(thoroughly)18 725 y(in)o(v)o(estigated)g(the)g
(issues)i(in)o(v)o(olv)o(ed)d(in)g(the)i(implemen-)18
766 y(tation)k(of)h(suc)o(h)h(a)g(language)e([12)o(].)44
b(The)23 b(syn)o(tax)f(of)18 808 y(S-Graph-n)15 b(explicitly)h
(captures)i(all)d(the)i(information)18 849 y(necessary)j(for)e(sp)q
(ecifying)h(the)g(staging)f(of)f(a)i(compu-)18 891 y(tation:)24
b(eac)o(h)18 b(construct)h(is)e(annotated)h(with)f(a)g(n)o(um-)18
932 y(b)q(er)h(indicating)e(the)i(stage)g(during)f(whic)o(h)g(it)g(is)h
(to)f(b)q(e)18 974 y(executed,)j(and)d(all)g(v)n(ariables)g(are)h
(annotated)g(with)g(a)18 1015 y(n)o(um)o(b)q(er)f(indicating)h(the)h
(stage)f(of)g(their)h(a)o(v)n(ailabili)o(t)o(y)m(.)18
1057 y(S-Graph-n)14 b(is)g(not)h(statically)f(t)o(yp)q(ed,)h(and)f(the)
h(syn)o(tax)18 1098 y(and)21 b(formal)d(seman)o(tics)j(of)g(the)g
(language)g(are)g(quite)18 1140 y(sizable.)29 b(Programmi)o(ng)15
b(in)i(S-Graph-n)g(requires)i(the)18 1181 y(user)12 b(to)f(annotate)g
(ev)o(ery)h(construct)h(and)f(v)n(ariable)e(with)18 1223
y(stage)21 b(annotations,)g(and)f(ensuring)i(the)f(consistency)18
1264 y(of)15 b(the)i(annotations)f(is)g(the)h(user's)h(resp)q
(onsibilit)o(y)m(.)24 b(In)18 1306 y(their)18 b(w)o(ork,)g(Hatcli\013)f
(&)h(Gl)q(\177)-22 b(uc)o(k)18 b(iden)o(ti\014ed)g Fw(language-)18
1347 y(indep)n(endenc)n(e)10 b Fx(of)f(the)h(in)o(ternal)f(represen)o
(tation)i(of)d(\\co)q(de")18 1389 y(as)16 b(an)g(imp)q(ortan)o(t)f(c)o
(haracteristic)j(of)d(an)o(y)h(m)o(ulti-stage)18 1430
y(language.)-22 1498 y Fs(\017)j Ft(\025)42 1483 y Fc(2)67
1498 y Fx(:)d(Da)o(vies)9 b(&)g(Pfenning)g(presen)o(ted)j(the)e
(\014rst)g(statically-)18 1540 y(t)o(yp)q(ed)21 b(m)o(ulti-stage)e
(language)i(Mini-ML)707 1522 y Fc(2)753 1540 y Fx([6].)39
b(The)18 1581 y(t)o(yp)q(e)19 b(system)g(is)h(motiv)n(ated)d(b)o(y)i
(constructiv)o(e)i(mo)q(dal)18 1623 y(logic,)9 b(and)h(a)g(formal)d
(pro)q(of)j(is)g(presen)o(ted)i(for)e(the)h(equiv-)18
1665 y(alence)j(of)f(binding-time)e(correctness)16 b(and)e(mo)q(dal)d
(cor-)18 1706 y(rectness.)39 b(In)20 b(con)o(trast,)i(the)f(MetaML)f(t)
o(yp)q(e-system)18 1748 y(w)o(as)11 b(motiv)n(ated)f(primarily)f(b)o(y)
i(op)q(erational)g(considera-)18 1789 y(tions.)20 b(Despite)c(the)f
(di\013eren)o(t)h(origins,)e(the)h(languages)18 1831
y(ha)o(v)o(e)d(a)g(lot)g(in)h(common:)h(meta-brac)o(k)o(ets,)e(escap)q
(e,)j(and)18 1872 y(run)10 b(roughly)g(corresp)q(ond)i(to)e(b)q(o)o(x,)
g(un)o(b)q(o)o(x,)g(and)g(ev)n(al)g(re-)18 1914 y(sp)q(ectiv)o(ely)m(.)
18 b(Mini-ML)384 1895 y Fc(2)409 1914 y Fx('s)c Fa(2)g
Fx(t)o(yp)q(e)h(constructor)g(is)f(also)18 1955 y(similar)g(to)j
Ft(code)p Fx(.)27 b(In)o(terestingly)m(,)17 b(in)g(Mini-ML)796
1937 y Fc(2)821 1955 y Fx(,)g(ev)n(al)18 1997 y(is)c(de\014ned)h(in)f
(terms)g(of)g(un)o(b)q(o)o(x,)g(whereas)i(in)d(MetaML,)18
2038 y(neither)18 b(run)g(or)f(escap)q(e)i(can)e(b)q(e)h(de\014ned)h
(in)e(terms)g(of)18 2080 y(eac)o(h)i(other.)34 b(Also,)20
b(while)e(Mini-ML)643 2062 y Fc(2)688 2080 y Fx(can)h(sim)o(ulate)18
2121 y(p)q(ersistance)d(for)f(co)q(de)g(v)n(alues,)g(a)f(stage-zero)i
(function,)18 2163 y(for)f(example,)g(cannot)h(b)q(e)h(made)e(p)q
(ersistan)o(t.)26 b(Finally)m(,)18 2204 y(Mini-ML)180
2186 y Fc(2)220 2204 y Fx(allo)o(ws)14 b(dela)o(ying)f(only)i(closed)g
(terms,)g(and)18 2246 y(hence,)20 b(functions)f(lik)o(e)e
Fr(back)h Fx(are)h(not)f(expressible)i(in)18 2287 y(the)14
b(language.)-22 2364 y Fs(\017)19 b Ft(\025)42 2349 y
Fl(\015)77 2364 y Fx(:)30 b(The)21 b(m)o(ulti-stage)d(language)h
(Mini-ML)774 2346 y Fl(\015)829 2364 y Fx([6)o(])h(is)18
2406 y(motiv)n(ated)7 b(b)o(y)i(a)g(linear-time)e(constructiv)o(e)k(mo)
q(dal)c(logic.)18 2447 y(While)i(the)i(logic)f(is)g(more)g(restricted)i
(than)f(that)f(b)q(ehind)18 2489 y(Mini-ML)180 2471 y
Fc(2)205 2489 y Fx(,)h(the)h(language)f(is)g(more)f(expressiv)o(e,)j
(allo)o(w-)18 2530 y(ing)j(staged)i(expressions)g(to)f(con)o(tain)g
(monolithic)e(free)18 2581 y(v)n(ariables.)j(The)c(t)o(w)o(o)g
(constructs)i(of)e(Mini-ML)780 2563 y Fl(\015)815 2581
y Fx(;)g(next)18 2622 y(and)k(prev,)j(corresp)q(ond)f(quite)f(closely)g
(to)g(MetaML's)1113 -34 y(meta-brac)o(k)o(ets)f(and)f(escap)q(e.)30
b(The)18 b(t)o(yp)q(e)g(constructor)1113 7 y Fs(\015)g
Fx(also)g(corresp)q(onds)j(\(roughly\))c(to)i Ft(code)p
Fx(.)31 b(Unfortu-)1113 49 y(nately)m(,)23 b(ev)n(al)d(is)i(no)f
(longer)g(expressible)i(in)e(the)h(lan-)1113 90 y(guage.)35
b(While)18 b(Da)o(vies)h(sho)o(ws)h(ho)o(w)f(lift)f(can)i(b)q(e)g(de-)
1113 132 y(\014ned)e(in)f(terms)g(of)f(next)i(and)f(prev)h(for)e(a)h
Fr(Succ)o Fx(/)p Fr(Zero)1113 173 y Fx(represen)o(tation)j(for)e
(naturals,)h(it)f(m)o(ust)f(b)q(e)i(explicitly)1113 215
y(programmed.)1076 294 y(Sheard)c(has)f(also)f(in)o(v)o(estigated)h
(ric)o(her)h(t)o(yp)q(e)f(systems)h(for)1020 336 y(m)o(ulti-staged)d
(programming)o(.)j(Sheard)g(and)f(Nelson)g(in)o(v)o(esti-)1020
377 y(gated)g(a)g(t)o(w)o(o-stage)f(language)g(for)h(the)h(purp)q(ose)g
(of)e(program)1020 419 y(generation)d([28)o(].)16 b(The)11
b(base)f(language)f(w)o(as)h(statically)f(t)o(yp)q(ed,)1020
460 y(and)h(dep)q(enden)o(t)i(t)o(yp)q(es)f(w)o(ere)g(used)g(to)f
(generate)i(a)d(wider)i(class)1020 502 y(of)16 b(programs)f(than)i(is)f
(p)q(ossible)h(b)o(y)f(MetaML)h(restricted)h(to)1020
544 y(t)o(w)o(o)g(stages.)30 b(Sheard)19 b(and)f(Shields)g([29)o(])f
(in)o(v)o(estigate)h(a)g(dy-)1020 585 y(namic)g(t)o(yp)q(e)i(systems)g
(for)g(m)o(ulti-staged)e(programs)g(where)1020 627 y(some)g(t)o(yp)q(e)
h(obligations)e(of)i(staged)g(computations)f(can)h(b)q(e)1020
668 y(put)14 b(o\013)g(till)f(run-time.)1076 710 y(The)h(t)o(yp)q(e)f
(rule)h(for)f Fr(run)f Fx(presen)o(ted)j(in)e(this)g(pap)q(er)h(is)f
(mo-)1020 751 y(tiv)n(ated)h(b)o(y)f(the)i(t)o(yp)q(e)f(system)g(for)f
Fr(runST)g Fx([19)o(].)1076 793 y(The)i Fr(back)f Fx(and)g
Fr(forth)g Fx(functions)g(are)h(similar)d(to)j(m)o(ulti-)1020
834 y(lev)o(el)h Ft(\021)q Fx(-expansion)h([5)o(].)26
b(In)17 b(MetaML,)f(ho)o(w)o(ev)o(er,)i Fr(back)d Fx(and)1020
876 y Fr(forth)20 b Fx(are)i(not)f(only)f(meta-lev)o(el)g(concepts)j
(or)e(optimiza-)1020 917 y(tions,)16 b(but)g(rather,)h(\014rst)g(class)
f(functions)g(in)g(the)h(language,)1020 959 y(and)g(the)g(user)h(can)f
(apply)f(them)g(directly)h(to)g(v)n(alues)f(of)h(the)1020
1000 y(appropriate)d(t)o(yp)q(e.)1020 1119 y Fy(13)53
b(Conclusion)1020 1202 y Fx(W)m(e)11 b(ha)o(v)o(e)g(describ)q(ed)i(an)e
Ft(n)p Fx(-stage)h(m)o(ulti-stage)d(programmi)o(ng)1020
1243 y(language)h(whic)o(h)h(w)o(e)g(call)f(MetaML.)h(MetaML)g(w)o(as)g
(designed)1020 1285 y(as)j(a)g(programmi)o(ng)d(language.)17
b(Our)d(primary)e(purp)q(ose)j(w)o(as)1020 1326 y(to)20
b(supp)q(ort)g(the)h(writing)e(of)g(m)o(ulti-stage)f(programs.)35
b(Be-)1020 1368 y(cause)21 b(of)e(this)h(our)g(design)g(c)o(hoices)h
(where)g(di\013eren)o(t)g(from)1020 1409 y(those)g(of)e(other)i(m)o
(ulti-stage)d(systems.)36 b(W)m(e)20 b(\014nd)g(the)h(fol-)1020
1451 y(lo)o(wing)13 b(features)i(essen)o(tial)g(when)g(writing)f(m)o
(ulti-stage)e(pro-)1020 1492 y(grams.)1074 1572 y Fs(\017)18
b Fo(Cross)25 b(stage)f(p)q(ersistence.)39 b Fx(The)22
b(abilit)o(y)e(to)h(use)1113 1614 y(v)n(ariables)e(from)f(an)o(y)g
(past)i(stage)g(is)f(crucial)g(to)h(writ-)1113 1655 y(ing)15
b(staged)g(programs)f(in)g(the)i(manner)e(to)h(whic)o(h)f(pro-)1113
1697 y(grammers)9 b(are)h(accustomed.)17 b(Cross)11 b(stage)g(p)q
(ersistence)1113 1738 y(pro)o(vides)16 b(a)e(solution)g(to)h(h)o
(ygienic)g(macros)f(in)g(a)h(t)o(yp)q(ed)1113 1780 y(language,)d(i.e.)
18 b(macros)12 b(whic)o(h)h(bind)g(iden)o(ti\014ers)h(in)f(the)1113
1821 y(en)o(viromen)o(t)h(of)h(de\014nition,)f(whic)o(h)h(are)g
(\\captured")h(in)1113 1863 y(the)f(en)o(vironmen)o(t)e(of)g(use.)1074
1934 y Fs(\017)18 b Fo(Multi-stage)23 b(a)o(w)o(are)j(t)o(yp)q(e)f
(system.)44 b Fx(The)23 b(t)o(yp)q(e)1113 1976 y(c)o(hec)o(k)o(er)16
b(rep)q(orts)f(phase)f(errors)h(as)e(w)o(ell)g(as)h(t)o(yp)q(e)g
(errors)1113 2017 y(is)19 b(crucial)g(when)g(debugging)f(m)o
(ulti-stage)f(programs,)1113 2059 y(th)o(us)e(ensuring)f(Cross-Stage)h
(Safet)o(y)m(.)1074 2130 y Fs(\017)j Fo(Displa)o(y)e(of)h(co)q(de.)23
b Fx(When)16 b(debugging,)f(it)g(is)g(imp)q(or-)1113
2171 y(tan)o(t)21 b(for)g(users)h(to)f(observ)o(e)g(the)h(co)q(de)f
(pro)q(duced)h(b)o(y)1113 2213 y(their)14 b(programs.)i(This)d(implies)
d(a)j(displa)o(y)f(mec)o(hanism)1113 2254 y(\(prett)o(y-prin)o(ter\))k
(for)d(v)n(alues)h(of)f(t)o(yp)q(e)i(co)q(de.)1074 2326
y Fs(\017)j Fo(Displa)o(y)k(of)i(Constan)o(ts.)39 b Fx(Constan)o(ts)21
b(originating)1113 2367 y(from)11 b(p)q(ersisten)o(t)j(v)n(ariables)e
(are)h(hard)f(to)h(iden)o(tify)m(.)j(The)1113 2409 y(\045)h(tags)h(pro)
o(vide)f(an)g(appro)o(ximation)e(of)h(where)j(these)1113
2450 y(constan)o(ts)f(came)e(from.)24 b(While)16 b(p)q(oten)o(tially)f
(mislead-)1113 2492 y(ing)f(they)g(are)g(often)g(quite)g(useful.)1074
2563 y Fs(\017)k Fo(The)11 b(Isomorphism)d(b)q(et)o(w)o(een)i
Fr(<A,'c>)20 b(->)i(<B,'c>)1113 2605 y Fo(and)c Fr(<A)k(->)f(B,'c>)p
Fx(.)i(The)17 b(isomorphism)c(\(whic)o(h)j(can)p eop
%%Page: 12 12
12 11 bop 18 -34 a Fx(only)20 b(b)q(e)h(expressed)j(b)q(ecause)e(of)f
(cross-stage)h(p)q(ersis-)18 7 y(tence\),)f(reduces,)i(sometimes)17
b(drastically)m(,)i(the)h(n)o(um-)18 49 y(b)q(er)10 b(of)f(annotations)
h(needed)h(to)f(stage)g(m)o(ulti-stage)e(pro-)18 90 y(grams.)-22
162 y Fs(\017)19 b Fo(Lift.)c Fx(The)c(lift)f(annotation)f(mak)o(es)h
(it)g(p)q(ossible)g(to)h(force)18 203 y(computation)18
b(in)h(a)h(early)f(stage)i(and)e(lift)g(this)h(v)n(alue)18
245 y(in)o(to)11 b(a)g(program)f(to)i(b)q(e)g(incorp)q(orated)h(at)e(a)
h(later)f(stage.)18 286 y(While)g(nev)o(er)i(necessary)h(\(b)q(ecause)g
(of)d(cross-stage)j(p)q(er-)18 328 y(sistence\))k(it)e(helps)g(pro)q
(duce)i(co)q(de)f(whic)o(h)f(is)g(easier)i(to)18 369
y(understand,)c(b)q(ecause)i(constan)o(ts)f(b)q(ecome)e(explicit.)-22
441 y Fs(\017)19 b Fo(Safe)13 b(b)q(eta)h(reduction.)i
Fx(Safe)c(b)q(eta)h(reduction)h(of)e(the)18 482 y(application)d(of)h
(explicit)h(abstractions)g(to)g(explicit)f(v)n(ari-)18
524 y(ables)k(reduces)i(the)e(clutter)h(in)e(generated)j(co)q(de.)-20
603 y(T)m(o)c(further)g(illustrate)g(this)g(w)o(e)h(pro)o(vide)f(an)g
(extended)h(ex-)-76 645 y(ample)19 b(in)h(App)q(endix)g(A)h(whic)o(h)f
(stages)h(a)f(term)f(rewriting)-76 686 y(system)14 b(in)g(whic)o(h)h
(the)g(the)g(rewriting)f(rules)h(b)q(ecome)g(kno)o(wn)-76
728 y(in)e(the)h(\014rst)g(stage)g(and)f(the)h(terms)f(to)g(b)q(e)h
(rewritten)h(b)q(ecome)-76 769 y(kno)o(wn)f(only)f(in)g(later)h
(stages.)-76 888 y Fy(14)53 b(F)l(uture)17 b(W)l(ork)-76
971 y Fx(W)m(e)i(ha)o(v)o(e)h(built)f(an)g(implemen)o(tatio)o(n)e(whic)
o(h)j(w)o(as)f(used)i(to)-76 1012 y(program)e(the)i(examples)f(in)g
(this)h(pap)q(er.)39 b(Curren)o(tly)m(,)22 b(the)-76
1054 y(implemen)o(tation)7 b(supp)q(orts)k(p)q(olymorphic)d(t)o(yp)q
(e-inference)k(so)-76 1095 y(that)j(t)o(yp)q(e)g(information)d(on)i(b)q
(ound)h(v)n(ariables)f(is)g(not)h(neces-)-76 1137 y(sary)m(.)26
b(W)m(e)17 b(are)g(curren)o(tly)g(extending)g(this)g(implemen)o(tatio)o
(n)-76 1179 y(to)d(include)g(all)f(the)h(features)h(in)e(core-ML.)-20
1220 y(W)m(e)20 b(are)g(also)f(activ)o(ely)h(pursuing)g(a)f(sub)r(ject)
j(reduction)-76 1267 y(theorem)g(for)f Ft(\025)189 1252
y Fl(M)230 1267 y Fx(.)42 b(The)22 b(m)o(ulti-lev)o(el)d(syn)o(tax)j
(mak)o(es)f(the)-76 1309 y(syn)o(tactic)15 b(approac)o(hes)g(to)f(t)o
(yp)q(e)g(soundness)i([32)o(])d(di\016cult)h(to)-76 1350
y(apply)m(,)21 b(b)q(ecause)h(reduction)f(con)o(texts)g(ma)o(y)e(app)q
(ear)h(inside)-76 1392 y(lam)o(b)q(da)8 b(expressions)13
b(at)d(lev)o(els)h(greater)g(than)g(zero.)17 b(W)m(e)11
b(ha)o(v)o(e)-76 1433 y(also)g(found)g(that)g(the)h(non-Hindley-Milner)
e(t)o(yp)q(e)i(judgemen)o(t)-76 1475 y(for)19 b(the)h
Fr(run)f Fx(annotation)g(complicates)f(matters)i(consider-)-76
1516 y(ably)m(.)-76 1635 y Fy(References)-55 1718 y Fx([1])d(C.)27
b(Consel)g(and)g(O.)g(Dan)o(vy)m(.)56 b(F)m(or)27 b(a)f(b)q(etter)j
(sup-)7 1759 y(p)q(ort)23 b(of)f(static)h(data)g(\015o)o(w.)43
b(In)23 b(J.)g(Hughes,)i(editor,)7 1801 y Fw(F)m(unctional)13
b(Pr)n(o)n(gr)n(amming)f(L)n(anguages)i(and)f(Computer)7
1842 y(A)o(r)n(chite)n(ctur)n(e,)26 b(Cambridge,)g(Massachusetts,)i(A)o
(ugust)7 1884 y(1991)e(\(L)n(e)n(ctur)n(e)f(Notes)g(in)h(Computer)f
(Scienc)n(e,)j(vol.)7 1925 y(523\))p Fx(,)h(pages)d(496{519.)d(New)j(Y)
m(ork:)f(A)o(CM,)g(Berlin:)7 1967 y(Springer-V)m(erlag,)13
b(1991.)-55 2038 y([2])k(Charles)f(Consel)f(and)g(Olivier)g(Dan)o(vy)m
(.)21 b(T)m(utorial)14 b(notes)7 2080 y(on)c(partial)e(ev)n(aluation.)i
(In)f Fw(A)o(CM)i(Symp)n(osium)g(on)h(Prin-)7 2121 y(ciples)17
b(of)g(Pr)n(o)n(gr)n(amming)f(L)n(anguages)p Fx(,)i(pages)f(493{501,)7
2163 y(Jan)o(uary)d(1993.)-55 2234 y([3])j(Rob)q(erto)f(Di)e(Cosmo.)21
b Fw(Isomorphisms)16 b(of)g(T)m(yp)n(es:)21 b(fr)n(om)7
2276 y Ft(\025)p Fw(-c)n(alculus)i(to)g(information)g(r)n(etrieval)f
(and)h(language)7 2317 y(design)p Fx(.)18 b(Progress)d(in)d
(Theoretical)i(Computer)e(Science.)7 2359 y(Birkh\177)-21
b(auser,)15 b(1995.)-55 2430 y([4])i(Olivier)i(Dan)o(vy)m(.)34
b(T)o(yp)q(e-directed)21 b(partial)d(ev)n(aluation.)7
2472 y(In)12 b Fw(A)o(CM)g(Symp)n(osium)h(on)g(Principles)f(of)g(Pr)n
(o)n(gr)n(amming)7 2513 y(L)n(anguages)p Fx(,)k(pages)g(242{257,)d
(Florida,)h(Jan)o(uary)h(1996.)7 2555 y(New)g(Y)m(ork:)e(A)o(CM.)1041
-34 y([5])k(Olivier)11 b(Dan)o(vy)m(,)e(Karoline)i(Malmkjaer,)e(and)i
(Jens)h(P)o(als-)1103 7 y(b)q(erg.)19 b(The)14 b(essence)i(of)d
(eta-expansion)h(in)f(partial)g(ev)n(al-)1103 49 y(uation.)35
b Fw(LISP)20 b(and)h(Symb)n(olic)f(Computation)p Fx(,)h(1\(19\),)1103
90 y(1995.)1041 162 y([6])c(Ro)o(w)o(an)26 b(Da)o(vies.)57
b(A)28 b(temp)q(oral-logic)c(approac)o(h)j(to)1103 211
y(binding-time)10 b(analysis.)j(In)f Fw(Pr)n(o)n(c)n(e)n(e)n(dings,)h
(11)1839 196 y Fu(th)1886 211 y Fw(A)o(nnual)1103 253
y(IEEE)19 b(Symp)n(osium)g(on)g(L)n(o)n(gic)g(in)f(Computer)g(Scienc)n
(e)p Fx(,)1103 294 y(pages)13 b(184{195,)d(New)i(Brunswic)o(k,)h(New)f
(Jersey)m(,)i(27{30)1103 336 y(July)g(1996.)e(IEEE)j(Computer)e(So)q
(ciet)o(y)h(Press.)1041 407 y([7])j(Ro)o(w)o(an)12 b(Da)o(vies)g(and)h
(F)m(rank)f(Pfenning.)k(A)d(mo)q(dal)d(anal-)1103 449
y(ysis)15 b(of)g(staged)g(computation.)20 b(In)15 b Fw(23r)n(d)h(A)o
(nnual)h(A)o(CM)1103 490 y(Symp)n(osium)26 b(on)f(Principles)g(of)g(Pr)
n(o)n(gr)n(amming)f(L)n(an-)1103 532 y(guages)19 b(\(POPL'96\))p
Fx(,)f(St.P)o(etersburg)g(Beac)o(h,)h(Florida,)1103 573
y(Jan)o(uary)14 b(1996.)1041 645 y([8])j(Nac)o(h)o(um)c(Dersho)o(witz.)
18 b(Computing)11 b(with)i(rewrite)i(sys-)1103 686 y(tems.)j
Fw(Information)d(and)g(Contr)n(ol)p Fx(,)e(65:122{157,)e(1985.)1041
758 y([9])17 b(Rob)q(ert)27 b(Gl)q(\177)-22 b(uc)o(k)25
b(and)h(Jesp)q(er)i(J\034rgensen.)56 b(E\016cien)o(t)1103
799 y(m)o(ulti-lev)o(el)12 b(generating)j(extensions)g(for)g(program)d
(sp)q(e-)1103 841 y(cialization.)47 b(In)24 b Fw(Pr)n(o)n(gr)n(amming)f
(L)n(anguages,)28 b(Imple-)1103 882 y(mentations,)14
b(L)n(o)n(gics)e(and)i(Pr)n(o)n(gr)n(ams)d(\(PLILP'95\))p
Fx(,)h(v)o(ol-)1103 924 y(ume)20 b(982)h(of)f Fw(L)n(e)n(ctur)n(e)h
(Notes)g(in)h(Computer)f(Scienc)n(e)p Fx(.)1103 965 y(Springer-V)m
(erlag,)13 b(1995.)1020 1037 y([10])k(Rob)q(ert)29 b(Gl)q(\177)-22
b(uc)o(k)28 b(and)g(Jesp)q(er)j(J\034rgensen.)63 b(F)m(asting)1103
1078 y(binding-time)9 b(analysis)i(for)g(m)o(ulti-lev)o(el)d(sp)q
(ecialization.)1103 1120 y(In)24 b Fw(PSI-96:)37 b(A)o(ndr)n(ei)23
b(Ershov)h(Se)n(c)n(ond)h(International)1103 1161 y(Memorial)18
b(Confer)n(enc)n(e,)h(Persp)n(e)n(ctives)f(of)g(System)h(In-)1103
1203 y(formatics)p Fx(,)d(v)o(olume)f(1181)g(of)h Fw(L)n(e)n(ctur)n(e)h
(Notes)g(in)h(Com-)1103 1244 y(puter)d(Scienc)n(e)p Fx(.)f(Springer-V)m
(erlag,)f(1996.)1020 1316 y([11])k(Carsten)g(K.)f(Gomard)e(and)h(Neil)h
(D.)f(Jones.)24 b(A)16 b(partial)1103 1357 y(ev)n(aluator)d(for)h(un)o
(t)o(yp)q(ed)g(lam)o(b)q(da)e(calculus.)18 b Fw(Journal)c(of)1103
1399 y(F)m(unctional)i(Pr)n(o)n(gr)n(amming)p Fx(,)c(1\(1\):21{69,)g
(1991.)1020 1470 y([12])17 b(John)e(Hatcli\013)e(and)h(Rob)q(ert)h(Gl)q
(\177)-22 b(uc)o(k.)18 b(Reasoning)13 b(ab)q(out)1103
1511 y(hierarc)o(hies)25 b(of)f(online)f(sp)q(ecialization)h(systems.)
48 b(In)1103 1553 y(Olivier)9 b(Dan)o(vy)m(,)g(Rob)q(ert)h(Gl)q(\177)
-22 b(uc)o(k,)10 b(and)f(P)o(eter)i(Thiemann,)1103 1595
y(editors,)23 b Fw(Partial)d(Evaluation)p Fx(,)j(v)o(olume)c(1110)g(of)
h Fw(L)n(e)n(c-)1103 1636 y(tur)n(e)g(Notes)h(in)g(Computer)f(Scienc)n
(e)p Fx(,)i(pages)e(161{182.)1103 1678 y(Springer-V)m(erlag,)13
b(1996.)1020 1749 y([13])k(J.)h(Roger)f(Hindley)g(and)g(Jonathan)h(P)m
(.)e(Seldin.)29 b Fw(Intr)n(o-)1103 1790 y(duction)14
b(to)e(Cobminators)h(and)g Ft(\025)p Fw(-Calculus)p Fx(.)h(Num)o(b)q
(er)e(1)1103 1832 y(in)22 b(London)f(Mathematical)f(So)q(ciet)o(y)i
(Studen)o(t)g(T)m(exts.)1103 1873 y(Cam)o(bridge)12 b(Univ)o(ersit)o(y)
i(Press,)h(1986.)1020 1945 y([14])i(Neil)9 b(D.)g(Jones.)j(Mix)d(ten)h
(y)o(ears)g(later.)h(In)e Fw(Partial)h(Evalu-)1103 1986
y(ation)i(and)g(Semantics-Base)n(d)g(Pr)n(o)n(gr)n(am)f(Manipulation,)
1103 2028 y(New)i(Haven,)i(Conne)n(cticut)f(\(Sigplan)g(Notic)n(es,)f
(vol.)g(26,)1103 2069 y(no.)20 b(9,)f(Septemb)n(er)g(1991\))p
Fx(,)h(pages)f(24{38.)d(New)j(Y)m(ork:)1103 2111 y(A)o(CM,)14
b(New)g(Y)m(ork:)f(A)o(CM,)g(June)i(1995.)1020 2182 y([15])i(Neil)e(D.)
f(Jones,)h(Carsten)h(K)f(Gomard,)d(and)j(P)o(eter)h(Ses-)1103
2224 y(toft.)33 b Fw(Partial)18 b(Evaluation)j(and)f(A)o(utomatic)f(Pr)
n(o)n(gr)n(am)1103 2265 y(Gener)n(ation)p Fx(.)g(Pren)o(tice-Hall,)13
b(1993.)1020 2337 y([16])k(Simon)10 b(L.)i(P)o(eyton)g(Jones)h(and)f
(John)g(Launc)o(h)o(bury)m(.)j(Un-)1103 2378 y(b)q(o)o(xed)j(v)n(alues)
f(as)g(\014rst)i(class)e(citizens)i(in)e(a)g(non-strict)1103
2420 y(functional)h(language.)32 b(In)19 b Fw(F)m(unctional)h(Pr)n(o)n
(gr)n(amming)1103 2461 y(and)c(Computer)f(A)o(r)n(chite)n(ctur)n(e)p
Fx(,)d(Septem)o(b)q(er)i(91.)1020 2533 y([17])j(Ric)o(hard)26
b(B.)g(Kieburtz,)k(F)m(rancoise)c(Bellegarde,)k(Jef)1103
2574 y(Bell,)15 b(James)g(Ho)q(ok,)f(Je\013rey)j(Lewis,)e(Dino)g(Oliv)n
(a,)e(Tim)1103 2616 y(Sheard,)i(Lisa)e(W)m(alton,)g(and)h(T)m(ong)f
(Zhou.)19 b(Calculating)p eop
%%Page: 13 13
13 12 bop 7 -34 a Fx(soft)o(w)o(are)12 b(generators)h(from)c(solution)i
(sp)q(eci\014cations.)k(In)7 7 y Fw(T)m(APSOFT'95)p Fx(,)21
b(v)o(olume)d(915)h(of)g Fw(LNCS)p Fx(,)g(pages)h(546{)7
49 y(560.)13 b(Springer-V)m(erlag,)g(1995.)-76 120 y([18])k(Ric)o(hard)
26 b(B.)g(Kieburtz,)k(Laura)c(McKinney)m(,)j(Je\013rey)7
162 y(Bell,)12 b(James)g(Ho)q(ok,)f(Alex)h(Koto)o(v,)g(Je\013rey)h
(Lewis,)f(Dino)7 203 y(Oliv)n(a,)g(Tim)e(Sheard,)j(Ira)g(Smith,)e(and)i
(Lisa)f(W)m(alton.)i(A)7 245 y(soft)o(w)o(are)k(engineering)f(exp)q
(erimen)o(t)g(in)g(soft)o(w)o(are)g(com-)7 286 y(p)q(onen)o(t)h
(generation.)27 b(In)17 b Fw(18th)h(International)g(Confer-)7
328 y(enc)n(e)e(in)f(Softwar)n(e)f(Engine)n(ering)p Fx(,)g(Marc)o(h)g
(1996.)-76 399 y([19])j(John)e(Launc)o(h)o(bury)g(and)f(Amr)f(Sabry)m
(.)19 b(Monadic)14 b(state:)7 441 y(Axiomatization)27
b(and)j(t)o(yp)q(e)h(safet)o(y)m(.)66 b(In)30 b Fw(Pr)n(o)n(c)n(e)n(e)n
(d-)7 482 y(ings)18 b(of)f(the)g(Symp)n(osium)h(on)g(Partial)e
(Evaluation)i(and)7 524 y(Semantics-Base)n(d)i(Pr)n(o)n(gr)n(am)f
(Manipulation)p Fx(,)h(Amster-)7 565 y(dam,)12 b(June)j(1997.)-76
636 y([20])i(Mark)24 b(Leone)f(and)g(P)o(eter)i(Lee.)46
b(Deferred)25 b(compila-)7 678 y(tion:)17 b(The)c(automation)c(of)j
(run-time)f(co)q(de)i(generation.)7 720 y(T)m(ec)o(hnical)j(Rep)q(ort)h
(CMU-CS-93-225,)e(Carnegie)i(Mel-)7 761 y(lon)d(Univ)o(ersit)o(y)m(,)e
(Dec.)i(1993.)-76 832 y([21])j(Mic)o(hael)k(Lo)o(wry)m(,)g(Andrew)g
(Philp)q(ot,)h(Thomas)d(Press-)7 874 y(burger,)13 b(and)e(Ian)h(Underw)
o(o)q(o)q(d.)j(Amphion:)g(Automatic)7 915 y(programming)26
b(for)i(scien)o(ti\014c)i(subroutine)g(libraries.)7 957
y Fw(NASA)c(Scienc)n(e)g(Information)g(Systems)g(Newsletter)p
Fx(,)7 998 y(31:22{25,)12 b(1994.)-76 1070 y([22])17
b(Robin)e(Milner.)24 b(A)16 b(theory)h(of)e(t)o(yp)q(e)h(p)q
(olymorphism)d(in)7 1111 y(programming.)32 b Fw(Journal)20
b(of)g(Computer)f(and)i(System)7 1153 y(Scienc)n(es)p
Fx(,)14 b(17:348{375,)d(1978.)-76 1224 y([23])17 b(T)m(orb)q(en)f
(\035.)g(Mogensen.)25 b(E\016cien)o(t)16 b(self-in)o(terpretation)7
1266 y(in)28 b(lam)o(b)q(da)e(calculus.)61 b Fw(F)m(unctional)29
b(Pr)n(o)n(gr)n(amming)p Fx(,)7 1307 y(2\(3\):345{364,)11
b(July)j(1992.)-76 1379 y([24])j(F.)e(Nielson.)20 b(Correctness)e(of)c
(co)q(de)i(generation)f(from)e(a)7 1420 y(t)o(w)o(o-lev)o(el)c
(meta-language.)g(In)g(B.)h(Robinet)f(and)g(R.)g(Wil-)7
1462 y(helm,)20 b(editors,)i Fw(Pr)n(o)n(c)n(e)n(e)n(dings)e(of)g(the)h
(Eur)n(op)n(e)n(an)g(Sym-)7 1503 y(p)n(osium)e(on)g(Pr)n(o)n(gr)n
(amming)f(\(ESOP)h(86\))p Fx(,)f(v)o(olume)e(213)7 1545
y(of)f Fw(LNCS)p Fx(,)g(pages)h(30{40,)e(Saarbr)q(\177)-22
b(uc)o(k)o(en,)16 b(FR)o(G,)e(Marc)o(h)7 1586 y(1986.)f(Springer.)-76
1658 y([25])k(F.)j(Nielson)g(and)g(H.)f(R.)g(Nielson.)36
b Fw(Two-L)n(evel)20 b(F)m(unc-)7 1699 y(tional)14 b(L)n(anguages)p
Fx(.)i(Num)o(b)q(er)c(34)g(in)f(Cam)o(bridge)g(T)m(racts)7
1741 y(in)j(Theoretical)h(Computer)e(Science.)i(Cam)o(bridge)e(Uni-)7
1782 y(v)o(ersit)o(y)i(Press,)g(1992.)-76 1854 y([26])i(G.)j(D.)f
(Plotkin.)36 b(Call-b)o(y-name,)18 b(call-b)o(y-v)n(alue-)h(and)7
1895 y(the)j(lam)o(b)q(da-calculus.)38 b Fw(The)n(or)n(etic)n(al)21
b(Computer)g(Sci-)7 1937 y(enc)n(e)p Fx(,)14 b(1:125{159,)d(1975.)-76
2008 y([27])17 b(Tim)c(Sheard.)20 b(A)15 b(t)o(yp)q(e-directed,)h
(on-line)e(partial)f(ev)n(al-)7 2050 y(uator)23 b(for)g(a)g(p)q
(olymorphic)e(language.)45 b(In)23 b Fw(Pr)n(o)n(c)n(e)n(e)n(d-)7
2091 y(ings)18 b(of)f(the)g(Symp)n(osium)h(on)g(Partial)e(Evaluation)i
(and)7 2133 y(Semantics-Base)n(d)i(Pr)n(o)n(gr)n(am)f(Manipulation)p
Fx(,)h(Amster-)7 2174 y(dam,)12 b(June)j(1997.)-76 2245
y([28])i(Tim)e(Sheard)i(and)f(Neal)g(Nelson.)26 b(T)o(yp)q(e)16
b(safe)h(abstrac-)7 2287 y(tions)e(using)g(program)f(generators.)22
b(T)m(ec)o(hnical)15 b(Rep)q(ort)7 2328 y(OGI-TR-95-013,)9
b(Oregon)j(Graduate)g(Institute)g(of)f(Sci-)7 2370 y(ence)16
b(and)d(T)m(ec)o(hnology)m(,)f(1995.)-76 2441 y([29])17
b(Tim)h(Sheard)i(and)f(Mark)h(Shields.)35 b(Dynamic)17
b(t)o(yping)7 2483 y(through)10 b(staged)g(t)o(yp)q(e)g(inference.)i
(In)d Fw(Pr)n(o)n(c)n(e)n(e)n(dings)i(of)f(the)7 2524
y(Se)n(c)n(ond)23 b(A)o(CM)e(International)h(Confer)n(enc)n(e)g(on)g(F)
m(unc-)7 2566 y(tional)15 b(Pr)n(o)n(gr)n(amming)p Fx(,)e(jun)h(1997.)j
(\(submitted\).)1020 -34 y([30])g(Brian)k(C.)f(Smith.)37
b Fw(R)n(e\015e)n(ction)22 b(and)g(Semantics)g(in)f(a)1103
7 y(Pr)n(o)n(c)n(e)n(dur)n(al)e(L)n(anguage)p Fx(.)33
b(PhD)19 b(thesis,)h(Massac)o(h)o(usetts)1103 49 y(Institute)15
b(of)e(T)m(ec)o(hnology)m(,)f(Jan)o(uary)i(1982.)1020
120 y([31])j(P)o(eter)c(Thiemann.)f(T)m(o)o(w)o(ards)f(partial)g(ev)n
(aluation)f(of)h(full)1103 162 y(Sc)o(heme.)20 b(In)14
b(Gregor)h(Kiczales,)g(editor,)f Fw(R)n(e\015e)n(ction)i(96)p
Fx(,)1103 203 y(pages)11 b(95{106,)e(San)h(F)m(rancisco,)g(CA,)g(USA,)g
(April)g(1996.)1020 275 y([32])17 b(W)m(righ)o(t)10 b(and)h(F)m
(elleisen.)j(A)d(syn)o(tactic)h(approac)o(h)g(to)f(t)o(yp)q(e)1103
316 y(soundness.)50 b Fw(Information)24 b(and)h(Computation)f(\(for-)
1103 358 y(merly)14 b(Information)h(and)h(Contr)n(ol\))p
Fx(,)d(115,)f(1994.)1020 477 y Fy(A)52 b(T)l(erm)11 b(Rewriting:)21
b(An)12 b(Extended)h(Example)1020 559 y Fx(In)j(this)f(section)i(w)o(e)
f(pro)o(vide)f(an)h(extended)h(example)d(whic)o(h)1020
601 y(illustrates)g(m)o(ulti-stage)e(programmi)o(ng.)1076
642 y(Dersho)o(witz)17 b([8)o(])e(de\014nes)j(a)d Fw(term-r)n(ewriting)
g(system)g Fx(as)i(a)1020 684 y(set)g(of)e(directed)j(rules.)25
b(Eac)o(h)16 b(rule)h(is)f(made)f(of)g(a)h(left-hand)1020
725 y(side)f(and)e(a)h(righ)o(t-hand)g(side.)19 b(A)14
b(rule)g(ma)o(y)e(b)q(e)j(applied)f(to)g(a)1020 767 y(term)g
Ft(t)h Fx(if)f(a)h(subterm)g Ft(s)g Fx(of)g Ft(t)g Fx(matc)o(hes)f(the)
i(left-hand)e(under)1020 808 y(some)i(substitution)i
Ft(\033)q Fx(.)28 b(A)17 b(rule)g(is)g(applied)g(b)o(y)g(replacing)g
Ft(s)1020 850 y Fx(with)e Ft(t)1131 835 y Fl(0)1142 850
y Fx(,)g(where)i Ft(t)1306 835 y Fl(0)1332 850 y Fx(is)e(the)h(result)g
(of)e(applying)g(the)i(substitu-)1020 891 y(tion)10 b
Ft(\033)h Fx(to)f(the)h(righ)o(t-hand)f(side.)17 b(W)m(e)10
b(sa)o(y)g Fw(\\)p Ft(t)h Fw(r)n(ewrites)f(\(in)i(one)1020
937 y(step\))j(to)g Ft(t)1188 922 y Fl(0)1200 937 y Fw(")p
Fx(,)f(and)g(write)g Ft(t)e Fs(\))f Ft(t)1529 922 y Fl(0)1541
937 y Fx(.)18 b(The)d(c)o(hoice)g(of)e(whic)o(h)h(rule)1020
978 y(to)e(apply)g(is)g(made)g(non-deterministically)m(.)j(As)e(an)f
(example,)1020 1020 y(here)j(are)f(the)h(rules)f(for)g(a)g(Monoid)f([8)
o(]:)1225 1101 y Ft(r)1244 1107 y Fu(1)1273 1101 y Fx(:)143
b Ft(x)9 b Fx(+)g(0)23 b Fs(!)g Ft(x)1225 1142 y(r)1244
1148 y Fu(2)1273 1142 y Fx(:)143 b(0)9 b(+)g Ft(x)23
b Fs(!)g Ft(x)1225 1186 y(r)1244 1192 y Fu(3)1273 1186
y Fx(:)37 b Ft(x)9 b Fx(+)h(\()p Ft(y)h Fx(+)f Ft(z)r
Fx(\))23 b Fs(!)g Fx(\()p Ft(x)9 b Fx(+)h Ft(y)q Fx(\))g(+)g
Ft(z)1076 1269 y Fx(V)m(ariables)g Ft(x)p Fx(,)h Ft(y)q
Fx(,)h(and)f Ft(z)i Fx(in)d(the)i(rules)f(can)h(eac)o(h)f(matc)o(h)f
(an)o(y)1020 1310 y(term.)23 b(If)16 b(a)f(v)n(ariable)g(o)q(ccurs)i
(more)e(than)h(once)h(on)e(the)i(left-)1020 1352 y(hand)10
b(side)h(of)f(a)g(rule,)h(all)f(o)q(ccurrences)j(m)o(ust)d(matc)o(h)f
(iden)o(tical)1020 1393 y(terms.)23 b(W)m(e)15 b(call)g(this)h(the)g
Fw(c)n(omp)n(atibility)f(c)n(ondition)p Fx(.)24 b(These)1020
1435 y(rules)15 b(allo)o(w)d(us)i(to)g(ha)o(v)o(e)g(deriv)n(ations)f
(suc)o(h)i(as:)1264 1508 y(\()p Ft(a)9 b Fx(+)g Ft(b)p
Fx(\))h(+)f(\(0)g(+)h(\()p Ft(d)f Fx(+)g Ft(e)p Fx(\)\))p
1437 1525 228 2 v 1212 1557 a Fs(\))23 b Fx(b)o(y)14
b Ft(r)1354 1563 y Fu(2)1372 1557 y Ft(;)7 b(\033)13
b Fx(=)e([\()p Ft(d)e Fx(+)g Ft(e)p Fx(\))p Ft(=x)p Fx(])1264
1601 y(\()p Ft(a)g Fx(+)g Ft(b)p Fx(\))h(+)f(\()p Ft(d)g
Fx(+)h Ft(e)p Fx(\))p 1264 1618 298 2 v 1212 1651 a Fs(\))23
b Fx(b)o(y)14 b Ft(r)1354 1657 y Fu(3)1372 1651 y Ft(;)7
b(\033)13 b Fx(=)e([\()p Ft(a)e Fx(+)h Ft(b)p Fx(\))p
Ft(=x;)d(d=y)q(;)g(e=z)r Fx(])1264 1694 y(\(\()p Ft(a)i
Fx(+)h Ft(b)p Fx(\))f(+)g Ft(d)p Fx(\))g(+)h Ft(e)1020
1779 y Fx(where)15 b(the)e(subterm)h(b)q(eing)f(rewritten)i(\()p
Ft(s)p Fx(\))f(has)f(b)q(een)i(under-)1020 1821 y(lined.)1076
1862 y(Generally)m(,)j(the)h(rules)g(do)g(not)f(c)o(hange)h(o)o(v)o(er)
f(the)h(life)f(of)1020 1904 y(the)h(system.)30 b(A)o(t)18
b(the)h(same)e(time,)g(the)i(basic)f(form)e(of)i(the)1020
1945 y(matc)o(hing)12 b(function)i(is)f(a)h(sim)o(ultaneous)e(tra)o(v)o
(ersal)i(of)f(a)h(sub-)1020 1987 y(ject)j(term)e(and)h(the)g(left-hand)
g(side)g(of)f(the)i(rule)f(it)g(is)f(b)q(eing)1020 2028
y(matc)o(hed)h(against.)26 b(This)17 b(o\013ers)h(an)e(opp)q(ortunit)o
(y)h(for)f(stag-)1020 2070 y(ing:)23 b(W)m(e)16 b(can)h(\\sp)q
(ecialize")g(matc)o(hing)e(o)o(v)o(er)i(the)g(rules)g(in)g(a)1020
2112 y(\014rst)c(stage,)g(and)f(eliminate)f(the)i(o)o(v)o(erhead)f(of)g
(tra)o(v)o(ersing)h(the)1020 2153 y(left-hand)18 b(side)g(of)g(the)h
(rules.)32 b(Not)18 b(only)f(that,)i(but)g(as)f(w)o(e)1020
2195 y(will)11 b(see,)j(w)o(e)f(can)g(also)f(remo)o(v)o(e)g(a)g
(signi\014can)o(t)h(amoun)o(t)e(of)h(ad-)1020 2236 y(ministrativ)o(e)e
(computations)h(in)o(v)o(olv)o(ed)g(in)g(constructing)i(and)1020
2278 y(applying)c(the)h(substitution)h Ft(\033)q Fx(.)16
b(One)11 b(w)o(ould)f(exp)q(ect)h(that)f(this)1020 2319
y(w)o(ould)j(signi\014can)o(tly)g(sp)q(eed)i(up)f(the)h(rewriting)f
(system.)1076 2361 y(T)m(erms)9 b(can)g(b)q(e)h(implemen)o(ted)d(using)
i(the)h(follo)o(wing)c(MetaML)1020 2402 y(t)o(yp)q(e:)1020
2473 y Fr(datatype)20 b('a)i(T)f(=)h(Const)e(of)i(int)1325
2515 y(|)g(Var)f(of)g(string)1325 2557 y(|)h(Op)f(of)g(\('a)h(*)f
(string)g(*)g('a\);)p eop
%%Page: 14 14
14 13 bop -20 -34 a Fx(The)14 b(declaration)g(in)o(tro)q(duces)g(a)g(t)
o(yp)q(e)g(constructor)h Fr(T)f Fx(pa-)-76 7 y(rameterized)j(b)o(y)g
(another)g(t)o(yp)q(e,)h Fr('a)o Fx(.)27 b(The)17 b(constructors)i(of)
-76 49 y(this)10 b(t)o(yp)q(e)h(are)f Fr(Const)o Fx(,)h
Fr(Var)e Fx(and)h Fr(Op)f Fx(represen)o(ting)j(one)e(lev)o(el)g(of)-76
90 y(an)16 b(in)o(teger,)g(v)n(ariable,)f(or)h(in\014x)g(binary)f
(term,)h(resp)q(ectiv)o(ely)m(.)-76 132 y(The)e(follo)o(wing)e
(de\014nitions)i(will)e(also)h(b)q(e)i(used:)-76 200
y Fr(datatype)20 b(Term)h(=)h(In)f(of)h(\(term)e(T\);)-76
242 y(datatype)g('a)i(Maybe)e(=)i(Nothing)e(of)i(unit)f(|)g(Just)g(of)h
('a;)-76 283 y(type)f(Sub)g(=)h(\(\(string)e(*)i(term\))e(List\))h
(Maybe;)-76 325 y(type)g(Rule)g(=)h(\(Term)e(*)i(Term\);)-76
408 y(fun)f(const)g(x)h(=)f(In)h(\(Const)e(x\);)-76 449
y(fun)h(var)h(x)f(=)h(In)f(\(Var)g(x\);)-76 491 y(fun)g(op)h(x)43
b(=)22 b(In)f(\(Op)g(x\);)-76 532 y(fun)g(out)h(\(In)f(x\))g(=)h(x;)-20
601 y Fx(where)g Fr(Term)e Fx(ties)h(the)g(recursiv)o(e)h(knot)f(in)f
Fr(T)h Fx(to)f(repre-)-76 642 y(sen)o(t)13 b(terms,)f(and)f
Fr(Sub)h Fx(is)g(the)g(t)o(yp)q(e)h(of)e(substitutions,)h(resp)q(ec-)
-76 684 y(tiv)o(ely)m(.)21 b(The)15 b Fr(Maybe)f Fx(t)o(yp)q(e)i(pro)o
(vides)f(a)g(mec)o(hanism)e(to)i(write)-76 726 y(functions)g(that)f
(can)h(fail)d(to)j(return)g(a)f(meaningful)e(v)n(alue)i(b)o(y)-76
767 y(returning)g Fr(Nothing)21 b(\(\))13 b Fx(instead.)18
b(Since)d(pattern)f(matc)o(hing)-76 809 y(ma)o(y)d(fail)g(the)i
(substitution)g(t)o(yp)q(e)g(is)g(a)f Fr(Maybe)f Fx(t)o(yp)q(e.)19
b(W)m(e)12 b(rep-)-76 850 y(resen)o(t)h(rules)f(as)f(an)h(ordered)g
(pair)f(of)g(terms.)17 b(Th)o(us,)12 b Ft(r)784 856 y
Fu(1)813 850 y Fx(w)o(ould)-76 892 y(b)q(e)17 b Fr(\(op\(var)k
("x","+",int)e("0"\),var)h("x"\))p Fx(.)26 b(The)17 b(func-)-76
933 y(tion)12 b Fr(out)21 b(:)44 b(Term)21 b(->)g(Term)g(T)12
b Fx(remo)o(v)o(es)g(a)g(term)g(from)f(the)-76 975 y(recursiv)o(e)16
b(t)o(yp)q(e)e(to)g(the)g(1)g(lev)o(el)f(t)o(yp)q(e.)-20
1016 y(T)m(o)c(simplify)l(,)e(w)o(e)j(fo)q(cus)f(on)g
Fr(match)o Fx(,)h(a)f(function)g(that)g(matc)o(hes)-76
1058 y(a)14 b(rule)h(with)e(the)i(whole)f(sub)r(ject)i(term,)d(that)i
(is,)e(the)i(sp)q(ecial)-76 1099 y(case)20 b(when)f Ft(s)h
Fx(=)g Ft(t)p Fx(.)33 b(W)m(e)18 b(assume)g(that)h(a)g(separate)g(help)
q(er)-76 1141 y(function)f(applies)g Fr(match)g Fx(to)g(all)f(subterms)
i(of)f(the)h(sub)r(ject)-76 1182 y(term.)-20 1224 y(No)o(w,)c(let)h(us)
g(consider)h(what)e(the)h(result)h(of)e(sp)q(ecializing)-76
1265 y Fr(match)f Fx(o)o(v)o(er)g(a)g(rule)h(should)g(lo)q(ok)e(lik)o
(e.)19 b(If)c(w)o(e)f(tak)o(e)h Ft(r)787 1271 y Fu(1)818
1265 y Fx(:)25 b Ft(x)9 b Fx(+)-76 1307 y(0)j Fs(!)h
Ft(x)h Fx(as)g(an)h(example,)d(then)k(an)e(go)q(o)q(d)g(result)h
(should)g(ha)o(v)o(e)-76 1348 y(a)f(form)e(close)i(to:)-76
1417 y Fr(fun)21 b(rewriteR1)f(term)h(=)-76 1458 y(case)g(\(out)g
(term\))g(of)-32 1500 y(Op)g(\(t1,s,t2\))f(=>)55 1541
y(if)h(streq\(s,"+"\))55 1583 y(then)g(\(case)g(\(out)g(t2\))g(of)229
1624 y(Const)g(n)h(=>)f(if)g(n=0)h(then)f(t1)g(else)g(term)186
1666 y(|)g(_)h(=>)f(term\))55 1707 y(else)g(term)-76
1749 y(|)h(_)f(=>)h(term;)-76 1817 y Fx(Here)15 b(there)g(is)e(no)h(in)
o(terpretiv)o(e)g(o)o(v)o(erhead)g(of)f(tra)o(v)o(ersing)h(the)-76
1859 y(rule,)f(and)f(the)h(substitution)g(op)q(eration)f(has)h(also)f
(b)q(een)i(com-)-76 1900 y(puted)22 b(in)e(the)h(\014rst)h(stage.)38
b(In)21 b(the)g(rest)h(of)e(this)h(section,)-76 1942
y(w)o(e)c(will)e(see)j(ho)o(w)e(far)g(to)o(w)o(ards)g(this)h(goal)e(w)o
(e)i(can)g(go)f(using)-76 1983 y(MetaML.)-76 2097 y Fy(A.1)52
b(An)17 b(Implemen)o(tation)h(of)f FA(match)-76 2166
y Fx(Figure)12 b(3)e(presen)o(ts)k(the)e(complete)e(co)q(de)i(for)f
Fr(match)o Fx(,)g(together)-76 2207 y(with)g(a)g(staged)h(v)o(ersion.)
18 b(Note)12 b(that)f(if)g(w)o(e)g(erase)i(the)f(annota-)-76
2249 y(tions)g(from)f(the)i(staged)g(v)o(ersion,)f(w)o(e)h(get)g(the)g
(source)g(v)o(ersion)-76 2290 y(bac)o(k.)22 b(The)15
b(source)h Fr(match)e Fx(function)h(tak)o(es)g(a)g(pattern)h(term)-76
2332 y Fr(pat)p Fx(,)c(a)h(substitution)g Fr(msigma)o
Fx(,)f(a)h(term)g Fr(term)o Fx(,)f(and)h(returns)i(a)-76
2373 y(substitution.)i(Recall)11 b(that)g(a)g(substitution)g(is)g(a)g
(ma)o(yb)q(e)f(t)o(yp)q(e)-76 2415 y(and)k(ma)o(y)e(b)q(e)i
Fr(Nothing\(\))p Fx(.)-20 2456 y(Hence,)i(the)g(t)o(yp)q(e)g(of)e(the)i
Fr(match)d Fx(function)i(is)g(\002)f Fs(!)f Fx(\006)g
Fs(!)-76 2498 y Fx(\002)f Fs(!)f Fx(\006,)i(where)i(\002)d
Fs(\021)g Fr(Term)o Fx(,)i(and)f(\006)f Fs(\021)g Fr(Sub)o
Fx(.)-20 2539 y(If)d Fr(match)f Fx(is)h(passed)i(an)e(in)o(v)n(alid)e
(substitution)i Fr(Nothing)21 b(\(\))-76 2581 y Fx(the)10
b(outer)g Fr(case)p Fx(-statemen)o(t)f(propagates)h(the)g(failure.)15
b(Other-)-76 2622 y(wise,)c(if)e(the)i(pattern)g(term)e(is)h(a)g(v)n
(ariable,)f(the)i(substitution)g(is)1020 -34 y(extended)i
(appropriately)d(after)h(c)o(hec)o(king)h(the)f(compatibilit)o(y)1020
7 y(condition.)17 b(Similarly)l(,)10 b(if)i(the)h(pattern)h(term)e(is)h
(an)f(op)q(erator,)1020 49 y(it)h(m)o(ust)g(b)q(e)h(c)o(hec)o(k)o(ed)h
(that)f(the)g(sub)r(ject)i(term)d(is)g(also)g(an)h(op-)1020
90 y(erator)e(with)f(the)h(same)f(op)q(eration,)g(and)g(then)i(the)f
(righ)o(t-)e(and)1020 132 y(left-hand-sides)k(of)g(the)h(pattern)g(and)
f(the)h(sub)r(ject)g(term)f(are)1020 173 y(recursiv)o(ely)h(matc)o
(hed,)e(extending)i(the)g(substitution.)k(If)14 b(the)1020
215 y(pattern)h(term)f(is)g(an)f(in)o(teger,)i(then)f(the)h(sub)r(ject)
h(term)d(m)o(ust)1020 256 y(also)18 b(b)q(e)i(an)f(in)o(teger)g(with)g
(the)g(same)g(v)n(alue.)32 b(In)19 b(this)g(case)1020
298 y(the)14 b(original)e(substitution)i(is)f(returned.)19
b(In)14 b(all)e(other)i(cases,)1020 339 y Fr(match)i
Fx(returns)j Fr(Nothing)h(\(\))p Fx(,)d(indicating)f(that)h
Fr(match)f Fx(has)1020 381 y(failed.)1076 418 y(The)10
b(staged)g Fr(match)e Fx(function)h(has)g(t)o(yp)q(e)h(\002)i
Fs(!)p Ft(<)f Fx(\006)p Ft(;)c Fr('a)k Ft(>)p Fs(!)p
Ft(<)1020 456 y Fx(\002)p Ft(;)c Fr('a)13 b Ft(>)p Fs(!)p
Ft(<)i Fx(\006)p Ft(;)7 b Fr('a)13 b Ft(>)p Fx(.)23 b(The)15
b(t)o(yp)q(e)h(indicates)g(that)f(the)i(pat-)1020 493
y(tern)h(term)e(is)h(insp)q(ected)h(only)f(in)f(the)i(\014rst)f(stage,)
h(and)f(the)1020 530 y(result)e(is)f(a)g(sp)q(ecialized)h(function)f
(that)g(can)h(b)q(e)f(run)h(in)f(a)g(fu-)1020 568 y(ture)k(stage.)27
b(W)m(e)16 b(can)h(also)f(de\014ne)i(and)f(annotate)g
Fr(rewrite)1020 605 y Fx(using)d(the)g(help)q(er)h(function)f
Fr(wrapper)e Fx(as)i(follo)o(ws:)1020 672 y Fh(\(*)35
b(wrapper)15 b(:)i(Rule)f(->)h(<Term>)f(->)h(<Term>)33
b(*\))1020 710 y(fun)17 b(wrapper)e(\(lhs,rhs\))f(term)i(=)1020
747 y(let)h(val)f(ms)35 b(=)17 b(match)f(lhs)g(<Just)g([]>)h(term)1020
784 y(in)1055 822 y(<)h(case)e(\(~ms\))g(of)1126 859
y(Nothing)f(\(\))i(=>)g(~term)1091 896 y(|)g(Just)f(\(sigma\))f(=>)1179
934 y(subst)h(sigma)g(rhs)g(>)h(end)g(;)1020 1008 y(\(*)35
b(rewrite)15 b(:)i(Rule)f(->)h(<Term)f(->)h(Term>)33
b(*\))1020 1046 y(fun)17 b(rewrite)e(rule)h(=)h(<fn)g(x)g(=>)g
(~\(wrapper)d(rule)j(<x>\)>;)1076 1117 y Fx(In)f(Figure)g(4)g(the)h(co)
q(de)g(generated)g(for)f Ft(r)1748 1123 y Fu(1)1781 1117
y Fx(:)30 b Ft(x)10 b Fx(+)h(0)k Fs(!)g Ft(x)1020 1159
y Fx(app)q(ears.)33 b(The)19 b(tra)o(v)o(ersal)g(of)f(the)h(pattern)g
(term)f(has)h(b)q(een)1020 1200 y(p)q(erformed.)34 b(Y)m(et,)20
b(compared)f(with)g(the)h(co)q(de)g(w)o(e)g(deriv)o(ed)1020
1242 y(b)o(y)d(hand,)h(there)g(are)g(to)q(o)f(man)o(y)f(nested)i
Fr(case)p Fx(-statemen)o(ts,)1020 1283 y(and)d(the)h(calls)f(to)g
Fr(subst)f Fx(and)h Fr(compatible)e Fx(ha)o(v)o(e)i(not)g(b)q(een)1020
1325 y(p)q(erformed.)1076 1366 y(Careful)h(insp)q(ection)g(sho)o(ws)h
(that)f(it)f(should,)h(in)g(fact,)g(b)q(e)1020 1408 y(p)q(ossible)10
b(to)f(reduce)i(the)f(nested)g Fr(case)o Fx(-statemen)o(ts)g(b)o(y)f
(meaning-)1020 1449 y(preserving)h(transformations.)15
b(If)9 b(the)h(outer)g Fr(case)o Fx(-statemen)o(ts)1020
1491 y(could)22 b(b)q(e)g(\\pushed")h(through)f(the)g(inner)g(ones,)i
(then)f(w)o(e)1020 1532 y(w)o(ould)17 b(b)q(e)i(able)f(to)g(simplify)e
(all)h(the)h(v)n(alues)g(at)g(the)h(lea)o(v)o(es)1020
1574 y(of)13 b(the)i(inner)f Fr(if)p Fx(-statemen)o(ts.)19
b(In)14 b(particular,)f(in)g(ev)o(ery)i(case)1020 1615
y(where)j(w)o(e)g(return)g Fr(Nothing)j(\(\))o Fx(,)d(the)f(unc)o
(hanged)h(term)f Fr(t1)1020 1657 y Fx(w)o(ould)j(b)q(e)h(returned,)j
(and)d(where)h Fr(Just)e(\()p Ft(\033)q Fr(\))h Fx(is)g(returned)1020
1698 y(then)c(the)h(substitution)f Fr(subst)j Ft(\033)e
Fx(could)f(b)q(e)g(p)q(erformed)f(on)1020 1740 y Fr(rhs)o
Fx(.)1076 1781 y(Giv)o(en)9 b(that)g(w)o(e)h(w)o(ere)g(able)f(to)g
(write)g(the)h(function)f Fr(rewriteR1)1020 1823 y Fx(b)o(y)17
b(hand,)h(it)e(should)i(b)q(e)f(clear)h(that)f(v)n(alues)g(of)g
Fr(Maybe)o Fx(-t)o(yp)q(e)1020 1864 y(need)e(not)g(app)q(ear)f(in)g
(the)h(generated)h(co)q(de.)k(Unfortunately)m(,)1020
1906 y(this)d(cannot)g(b)q(e)g(ac)o(hiev)o(ed)g(b)o(y)g(using)f(only)g
(the)i(staging)e(an-)1020 1947 y(notations)d(on)h(the)h(curren)o(t)g
(program.)1076 1989 y(In)e(particular,)f(the)h(test)h(of)e(the)h
(compatibilit)o(y)d(condition)1020 2030 y(in)j Fr(match)g
Fx(cannot)g(b)q(e)i(p)q(erformed)e(at)g(generation)h(time)e(since)1020
2072 y(the)e(sub)r(ject)h(term)e(is)h(unkno)o(wn.)16
b(A)o(t)10 b(the)g(same)f(time,)f(this)i(call)1020 2113
y(determines)k(whether)i Fr(Nothing)c Fx(or)i Fr(Just)f
Fx(is)h(returned.)20 b(This)1020 2155 y(implies)12 b
Fr(match)h Fx(m)o(ust)g(return)i(a)e(v)n(alue)h(of)f(t)o(yp)q(e)h
Ft(<)e Fr(Maybe)1020 2196 y Ft(al)q(pha;)7 b Fr('a)15
b Ft(>)p Fx(.)25 b(This)16 b(means)g(the)h(generated)g(co)q(de)g(will)e
(con-)1020 2238 y(tain)e(v)n(alues)h(of)f Fr(Maybe)g
Fx(t)o(yp)q(e.)1076 2279 y(Similarly)l(,)19 b(threading)i
Fr(msigma)f Fx(through)g(the)i(recursiv)o(e)1020 2321
y(calls)17 b(to)g Fr(match)f Fx(stops)i(us)f(from)f(b)q(eing)h(able)g
(to)g(reduce)i(the)1020 2363 y(calls)11 b(to)g Fr(compatible)f
Fx(and)h Fr(subst)f Fx(at)i(generation)f(time:)16 b(The)1020
2404 y(result)j(of)e(b)q(oth)h(of)g(these)h(functions)f(dep)q(ends)i
(on)d(the)i(sub-)1020 2446 y(stitution)h(list,)h(but)g(b)q(ecause)h(w)o
(e)e(are)h(forced)g(to)f(annotate)1020 2487 y Fr(msigma)8
b Fx(to)h(ha)o(v)o(e)g(t)o(yp)q(e:)16 b Ft(<)p Fr(\(\(string)21
b(*)g(Term\)List\)Maybe)p Ft(;)7 b Fr('a)h Ft(>)1020
2529 y Fx(and)869 b(not)1020 2570 y Fr(\(\(string)20
b(*)i Ft(<)p Fr(Term)p Ft(;)7 b Fr('a)j Ft(>)p Fr(\)List\)Maybe)n
Fx(,)g(these)i(t)o(w)o(o)e(func-)1020 2612 y(tions)k(cannot)g
(\\access")h(the)g(list)e(at)h(generation)g(time.)p eop
%%Page: 15 15
15 14 bop -76 -74 2010 2 v -77 926 2 1001 v -53 -45 a
Fh(\(*)17 b(Source)e(match:)g(Term)i(->)g(Sub)f(->)h(Term)f(->)h(Sub)g
(*\))-53 30 y(fun)f(match)g(pat)h(msigma)e(term)h(=)-53
67 y(case)g(\(msigma\))f(of)0 104 y(Nothing)g(\(\))i(=>)f(Nothing)g
(\(\))-36 142 y(|)i(Just)e(\(sigma\))f(=>)-53 179 y(\(case)g(\(out)i
(pat\))f(of)17 216 y(Var)h(u)g(=>)52 254 y(if)g(compatible)d(u)k(sigma)
e(term)105 291 y(then)h(Just)f(\(cons\(\(u,t)o(er)o(m\),)o(sig)o(ma\))o
(\))88 328 y(else)g(Nothing)f(\(\))-18 366 y(|)i(Op)g(\(t11,s1,t1)o
(2\))d(=>)52 403 y(\(case)i(\(out)g(term\))g(of)123 441
y(Op)h(\(t21,s2,t2)o(2\))d(=>)88 478 y(\(if)i(streq\(s2,\()e(s1\)\))158
515 y(then)i(\(match)g(t11)299 553 y(\(match)g(t12)g(msigma)g(t22\))352
590 y(t21\))158 627 y(else)g(Nothing)g(\(\)\))88 665
y(|)h(_)g(=>)g(Nothing)e(\(\)\))-18 702 y(|)i(Const)f(n)h(=>)52
739 y(\(case)f(\(out)g(term\))g(of)105 777 y(Const)g(u)h(=>)g(if)g(u=n)
317 814 y(then)f(msigma)317 852 y(else)g(Nothing)f(\(\))70
889 y(|)i(_)h(=>)f(Nothing)e(\(\)\)\);)p 868 926 V 891
-45 a(\(*)i(Annotated)e(match:)g(Term)h(->)h(<Sub>)f(->)h(<Term>)f(->)h
(<Sub>)e(*\))891 30 y(fun)i(match)f(pat)g(msigma)g(term)g(=)891
67 y(<case)g(~msigma)f(of)962 104 y(Nothing)g(\(\))i(=>)g(Nothing)e
(\(\))927 142 y(|)i(Just)f(\(sigma\))f(=>)909 179 y(~\(case)h(\(out)g
(pat\))g(of)997 216 y(Var)h(u)g(=>)1033 254 y(<if)f(compatible)e(u)j
(sigma)f(~term)1103 291 y(then)g(Just)h(\(cons\(\(u,)o(~te)o(rm\))o(,s)
o(igm)o(a\)\))1103 328 y(else)f(Nothing)f(\(\)>)962 366
y(|)i(Op)g(\(t11,s1,t12)o(\))e(=>)1033 403 y(<case)g(\(out)i(~term\))e
(of)1103 441 y(Op)i(\(t21,s2,t2)o(2\))d(=>)1068 478 y(\(if)i
(streq\(s2,)f(~\(lift)g(s1\)\))1138 515 y(then)i(~\(match)e(t11)1297
553 y(\(match)h(t12)g(msigma)g(<t22>\))1350 590 y(<t21>\))1138
627 y(else)h(Nothing)e(\(\)\))1068 665 y(|)i(_)g(=>)g(Nothing)e(\(\)>)
962 702 y(|)i(Const)f(n)h(=>)1033 739 y(<case)e(\(out)i(~term\))e(of)
1085 777 y(Const)h(u)i(=>)f(if)f(u=)h(~\(lift)f(n\))1297
814 y(then)g(~msigma)1297 852 y(else)g(Nothing)g(\(\))1050
889 y(|)h(_)h(=>)f(Nothing)e(\(\)>\)>;)p 1933 926 V -76
928 2010 2 v 382 1002 a Fx(Figure)f(3:)j(Normal)12 b(and)i(Annotated)g
(v)o(ersions)h(of)e(the)i(function)e Fr(match)p Fx(.)p
-76 1058 2183 2 v -77 1685 2 627 v -53 1087 a Fh(<\(fn)j(t1)h(=>)35
1124 y(\(case)f(\(case)f(\045out)i(t1)g(of)194 1162 y(Op\(tl,op1)o(,tr)
o(\))e(=>)246 1199 y(if)i(\045streq)f(\(op1,"+"\))299
1236 y(then)h(\(case)e(\(case)h(\045out)h(tr)f(of)546
1274 y(Const)g(n)i(=>)599 1311 y(if)f(\045=)g(\(n,0\))f(then)g
(Just\(nil\))f(else)h(Nothing)f(\(\))529 1348 y(|)i(Var)g(s)g(=>)g
(Nothing)e(\(\))529 1386 y(|)i(Op)g(s)g(=>)g(Nothing)e(\(\)\))i(of)441
1423 y(Nothing)e(\(\))i(=>)g(Nothing)e(\(\))423 1460
y(|)i(Just)f(s)i(=>)f(if)g(\045compatib)o(le)d("x")j(s)g(tl)g(then)f
(Just)g(\(\045cons)g(\(\("x",tl\),)o(s\)\))e(else)i(Nothing)f(\(\)\))
299 1498 y(else)i(Nothing)e(\(\))176 1535 y(|)i(Const)f(n)h(=>)g
(Nothing)e(\(\))176 1573 y(|)i(Var)g(s)g(=>)g(Nothing)e(\(\)\))i(of)88
1610 y(Nothing)e(\(\))i(=>)g(t1)70 1647 y(|)g(Just)g(s)g(=>)g
(\045subst)e(s)j(In)e(Var)h("x"\)\)>)p 2106 1685 V -76
1686 2183 2 v 319 1761 a Fx(Figure)d(4:)k(Co)q(de)c(generated)i(from)c
(rule)i Ft(r)998 1767 y Fu(1)1028 1761 y Fx(=)23 b Ft(x)9
b Fx(+)g(0)j Fs(!)f Ft(x)i Fx(b)o(y)h(function)g Fr(match)p
Fx(.)-20 1885 y(That)j(our)f(\014rst)i(attempt)d(at)i(staging)f(our)g
(example)f(w)o(as)-76 1927 y(only)21 b(partly)g(successful,)26
b(should)21 b(not)h(b)q(e)g(to)q(o)g(surprising.)-76
1968 y(Users)i(of)e(partial)f(ev)n(aluation)g(systems)i(restructure)i
(their)-76 2010 y(programs)16 b(to)h(help)g(BT)m(A)g(succeed)i(all)d
(the)i(time.)26 b(Just)18 b(b)q(e-)-76 2051 y(cause)10
b(binding-time)d(annotations)i(are)h(placed)f(man)o(ually)d(shouldn't)
-76 2093 y(exempt)j(us)h(from)d(this)i(requiremen)o(t.)17
b(Because)11 b(w)o(e)f(can)f(touc)o(h,)-76 2134 y(see,)15
b(and)e(exp)q(erimen)o(t)h(with)f(b)q(oth)h(the)g(explicit)f
(annotations)-76 2176 y(and)h(the)g(co)q(de)h(returned,)g(it)f(helps)g
(us)g(understand)h(and)f(rea-)-76 2217 y(son)20 b(ab)q(out)g(what)g(is)
g(going)f(on.)36 b(Using)20 b(the)h(t)o(yp)q(e)g(system)-76
2259 y(to)13 b(\014lter)h(out)f(ob)o(viously)f(incorrectly)i(phased)g
(programs)d(w)o(as)-76 2300 y(also)k(extremely)h(useful.)24
b(The)16 b(strength)h(of)e(MetaML)h(is)g(the)-76 2342
y(men)o(tal)11 b(mo)q(del)g(it)i(pro)o(vides)f(to)h(reason)g(ab)q(out)g
(what)f(is)h(going)-76 2383 y(on.)-76 2498 y Fy(A.2)52
b(Con)o(tin)o(uation-P)o(assing)18 b(St)o(yle)-76 2566
y Fx(Our)d(solution)f(needs)h(to)g(propagate)f(the)h(con)o(text)g(\(p)q
(erform-)-76 2608 y(ing)f(a)h(substitution)g(o)o(v)o(er)g(the)h(righ)o
(t-hand)e(side)h(of)f(the)i(rule\))1020 1885 y(in)o(to)k(the)i(lea)o(v)
o(es)f(of)g(the)h(nested)g(case)g(expressions.)41 b(This)1020
1927 y(suggests)16 b(rewriting)e(the)h(source)h(program)d(in)g(con)o
(tin)o(uation-)1020 1968 y(passing)k(st)o(yle)h(\(CPS\).)g(This)f(has)h
(b)q(een)h(found)e(to)g(b)q(e)h(quite)1020 2010 y(useful)c(in)f
(partial)g(ev)n(aluation)g(systems)h([1)o(].)1076 2053
y(Figure)f(5)f(sho)o(ws)h(b)q(oth)g(a)g(source)h(v)o(ersion)f(of)f
Fr(match)g Fx(using)1020 2090 y(an)d(explicit)g(con)o(tin)o(uation)f
(and)i(an)f(annotated)g(t)o(w)o(o)g(stage)h(v)o(er-)1020
2128 y(sion)i(of)g(the)h(same)e(function.)17 b(The)c(function)f(tak)o
(es)g(a)g(pattern)1020 2165 y Fr(pat)o Fx(,)e(a)f(con)o(tin)o(uation)f
Fr(k)p Fx(,)i(a)f(substitution)g Fr(msigma)o Fx(,)h(and)f(a)g(term)1020
2207 y Fr(term)o Fx(.)20 b(This)14 b(function)g(actually)f(has)i(a)f
(rather)h(p)q(olymorphic)1020 2245 y(t)o(yp)q(e)e(since)h(nothing)e
(constrains)h(the)g(v)n(alue)f(returned)i(b)o(y)f(the)1020
2282 y(con)o(tin)o(uation)j Fr(k)p Fx(.)27 b(In)16 b(the)i(\014gure)f
(w)o(e)g(ha)o(v)o(e)g(constrained)h(the)1020 2319 y(con)o(tin)o(uation)
g(to)h(ha)o(v)o(e)g(t)o(yp)q(e)h(substitution)f(to)g(term.)34
b(The)1020 2357 y(con)o(tin)o(uation)11 b(should)g(apply)g(the)i
(substitution)f(to)f(the)i(righ)o(t-)1020 2394 y(hand)i(side)h(of)f
(the)h(rule,)g(or)f(return)i(the)f(term)f(unc)o(hanged)h(if)1020
2431 y(the)c(substitution)g(is)g(a)g(failure.)k(Th)o(us)c(the)h(wrapp)q
(er)g(function)1020 2469 y(could)h(b)q(e)g(written:)1020
2536 y Fh(fun)j(wrapper)e(\(lhs,rhs\))f(term)i(=)1055
2573 y(match)g(lhs)1126 2611 y(\(fn)g(Nothing)g(\(\))h(=>)f(term)h(|)g
(Just)f(s)h(=>)g(subst)f(rhs)h(s\))p eop
%%Page: 16 16
16 15 bop -76 -74 2010 2 v -77 1076 2 1150 v -53 -45
a Fh(\(*)17 b(Source)e(*\))-53 -8 y(type)h(Cont)g(=)h(Sub)g(->)g(Term)
-53 104 y(\(*)34 b(match)16 b(:)h(Term)f(->)h(Cont)g(->)g(Sub)f(->)h
(Term)f(->)h(Term)f(*\))-53 142 y(fun)g(match)g(pat)h(k)g(msigma)e
(term)i(=)-53 179 y(case)f(\(msigma\))f(of)0 216 y(Nothing)g(\(\))i(=>)
f(k)i(\(Nothing\(\))o(\))-36 254 y(|)g(Just)e(\(sigma\))f(=>)-53
291 y(\(case)g(\(out)i(pat\))f(of)17 328 y(Var)h(u)g(=>)52
366 y(if)g(compatible)d(u)k(sigma)e(term)105 403 y(then)h(k)g(\(Just)f
(\(cons\(\(u,)o(ter)o(m\),)o(sig)o(ma\))o(\)\))88 441
y(else)g(k)h(\(Nothing)e(\(\)\))-18 478 y(|)i(Op)g(\(t11,s1,t1)o(2\))d
(=>)52 515 y(\(case)i(\(out)g(term\))g(of)123 553 y(Op)h(\(t21,s2,t2)o
(2\))d(=>)88 590 y(\(if)i(streq\(s2,s1)o(\))158 627 y(then)g(\(match)g
(t11)299 665 y(\(fn)h(s)g(=>)g(match)f(t12)h(k)g(s)g(t22\))352
702 y(msigma)388 739 y(t21\))158 777 y(else)f(k)i(\(Nothing)d(\(\)\)\))
88 814 y(|)i(_)g(=>)g(k\(Nothing)e(\(\)\)\))-18 852 y(|)i(Const)f(n)h
(=>)52 889 y(\(case)f(\(out)g(term\))g(of)105 926 y(Const)g(u)h(=>)g
(if)g(u=n)317 964 y(then)f(k)i(msigma)317 1001 y(else)e(k)i(\(Nothing)c
(\(\)\))70 1038 y(|)j(_)h(=>)f(k\(Nothing)d(\(\)\)\)\);)p
868 1076 V 891 -45 a(\(*)j(Annotated)e(*\))891 -8 y(type)i(Sub')f(=)h
(\(\(string)e(*)i(<Term>\))e(List\))h(Maybe;)891 30 y(type)h(Cont')e(=)
j(Sub')e(->)h(<Term>)891 104 y(\(*)g(match)f(:)h(Term)g(->)g(Cont')e
(->)i(Sub')g(->)g(<Term>)e(->)i(<Term>)e(*\))891 142
y(fun)i(match)f(pat)g(k)i(msigma)d(term)h(=)891 179 y(case)h
(\(msigma\))d(of)944 216 y(Nothing)h(\(\))i(=>)g(k)h(\(Nothing\()o
(\)\))909 254 y(|)f(Just)g(\(sigma\))e(=>)891 291 y(\(case)h(\(out)g
(pat\))h(of)962 328 y(Var)g(u)g(=>)980 366 y(<if)f(~\(compatibl)o(e')e
(u)j(sigma)f(term\))1050 403 y(then)g(~\(k)h(\(Just)f(\(cons\(\(u,t)o
(erm)o(\),)o(sig)o(ma\))o(\)\)\))1050 441 y(else)g(~\(k)h(\(Nothing)e
(\(\)\)\)>)927 478 y(|)i(Op)g(\(t11,s1,t1)o(2\))d(=>)997
515 y(<case)i(\(out)g(~term\))g(of)1068 553 y(Op)h(\(t21,s2,t2)o(2\))d
(=>)1033 590 y(\(if)i(streq\(~\(lif)o(t)e(s1\),s2\))1103
627 y(then)i(~\(match)f(t11)1244 665 y(\(fn)i(s)g(=>)g(match)f(t12)g(k)
i(s)f(<t22>\))1297 702 y(msigma)1332 739 y(<t21>\))1103
777 y(else)f(~\(k)h(\(Nothing)e(\(\)\)\)\))1033 814 y(|)i(_)g(=>)g
(~\(k\(Nothin)o(g)e(\(\)\)\)>)927 852 y(|)i(Const)f(n)h(=>)997
889 y(<case)f(\(out)g(~term\))g(of)1050 926 y(Const)g(u)h(=>)g(if)g(u=)
g(~\(lift)f(n\))1262 964 y(then)g(~\(k)h(msigma\))1262
1001 y(else)f(~\(k)h(\(Nothing)d(\(\)\)\))1015 1038 y(|)j(_)g(=>)g
(~\(k\(Nothing)d(\(\)\)\)>\);)p 1933 1076 V -76 1077
2010 2 v 367 1152 a Fx(Figure)g(5:)k(Normal)12 b(and)h(Annotated)i(v)o
(ersions)f(of)f(the)i(CPS)f(st)o(yle)g Fr(match)p Fx(.)101
1276 y Fh(\(Just)h([]\))171 1313 y(term;)-20 1376 y Fx(The)k(annotated)
f(v)o(ersion)g(is)h(again)e(remark)n(ably)f(similar)-76
1413 y(to)j(the)h(original)e(except)i(for)f(the)h(annotations.)33
b(The)20 b(only)-76 1451 y(di\013erence)14 b(is)e(that)h(w)o(e)f
(needed)i(to)e(write)h(a)f(staged)h(v)o(ersion)f(of)-76
1488 y(the)j Fr(compatible)e Fx(function,)h(since)h(in)g(the)g(staged)g
(v)o(ersion)g(a)-76 1532 y(substitution)10 b(\()p Fr(Sub')p
Fx(\))f(maps)g(a)g(string)h(to)f(a)h(piece)g(of)f(co)q(de)i(with)-76
1576 y(t)o(yp)q(e)18 b(term,)g(rather)h(than)e(a)h(term.)29
b(W)m(e)17 b(call)g(this)h(function)-76 1613 y Fr(compatible')p
Fx(.)d(It)10 b(returns)i(a)e(piece)h(of)f(co)q(de)h(with)f(t)o(yp)q(e)h
Fr(bool)p Fx(.)-76 1676 y Fh(fun)17 b(compatible)o(')d(u)k(sigma)e
(term)g(=)-76 1713 y(case)g(find)h(u)g(sigma)f(of)-41
1750 y(Nothing\(\))f(=>)i(<true>)-76 1788 y(|)g(Just)g(w)g(=>)g
(<termeq)e(~w)i(~term>;)-20 1850 y Fx(Finally)m(,)h(the)i(co)q(de)g
(generator)g(can)f(b)q(e)h(constructed)i(b)o(y)-76 1887
y(supplying)f(a)f(suitable)h(substitution)h(con)o(tin)o(uation.)38
b(This)-76 1925 y(function)12 b(needs)i(a)e(annotated)h(substitution)f
(function)g(whic)o(h)-76 1962 y(returns)20 b(a)e(piece)h(of)e(co)q(de)i
(with)f(t)o(yp)q(e)g(term)g(rather)h(than)f(a)-76 2000
y(term,)13 b(and)h(is)f(giv)o(en)h(b)q(elo)o(w:)-76 2062
y Fh(fun)j(subst')e(\(In)i(t\))g(sig)f(=)-76 2099 y(case)g(\(t\))h(of)
-41 2137 y(Var)g(v)g(=>)30 2174 y(\(case)f(find)g(v)h(sig)g(of)83
2211 y(Nothing)e(_)i(=>)g(<In)g(\(Var)f(~\(lift)g(v\)\)>)48
2249 y(|)h(Just)f(w)h(=>)g(w\))-76 2286 y(|)g(Op)g(\(t1,s,t2\))e(=>)30
2323 y(<In)i(\(Op)f(\(~\(subst')f(t1)i(sig\),)189 2361
y(~\(lift)e(s\),)189 2398 y(~\(subst')g(t2)i(sig\)\)\))e(>)-76
2436 y(|)i(Const)f(i)i(=>)f(<In)f(\(Const)g(~\(lift)f(i\)\)>;)-76
2510 y(fun)i(wrapper)e(\(lhs,rhs\))f(term)j(=)-41 2548
y(match)f(lhs)30 2585 y(\(fn)h(Nothing)e(\(\))i(=>)g(term)f(|)h(Just)f
(s)i(=>)e(subst')g(rhs)h(s\))101 2622 y(\(Just)e([]\))1267
1276 y(term;)1076 1343 y Fx(When)g(this)f(function)g(is)h(used)g(to)f
(generate)i(co)q(de)g(for)e(the)1020 1381 y(rule)g Ft(r)1122
1387 y Fu(1)1152 1381 y Fx(=)23 b Ft(x)9 b Fx(+)h(0)h
Fs(!)g Ft(x)j Fx(the)g(follo)o(wing)e(is)h(generated:)1020
1448 y Fh(<fn)k(t)g(=>)1091 1485 y(\(case)e(\045out)i(t)g(of)1144
1523 y(Op\(tl,s,t)o(r\))d(=>)1179 1560 y(if)j(\045streq)e(\("+",s\))
1232 1597 y(then)h(\(case)g(\045out)g(tr)h(of)1373 1635
y(Const)f(n)h(=>)g(if)g(\045=)g(\(n,0\))f(then)g(tl)h(else)f(t)1338
1672 y(|)h(Var)f(s)i(=>)f(t)1338 1710 y(|)g(Op)g(z)g(=>)g(t\))1232
1747 y(else)f(t)1108 1784 y(|)i(Const)d(n)j(=>)f(t)1108
1822 y(|)h(Var)e(z)h(=>)g(t\)>)1076 1893 y Fx(In)g(addition)f(to)h(b)q
(eing)g(compact)f(and)g(free)i(of)e(reducible)1020 1934
y(nested)11 b Fr(case)o Fx(-statemen)o(ts)e(or)h(calls)e(to)i
Fr(subst)e Fx(or)h Fr(compatible)n Fx(,)1020 1976 y(this)17
b(output)h(is)f(virtually)f(iden)o(tical)g(to)i(the)f(idealized)g(co)q
(de)1020 2018 y(w)o(e)i(presen)o(ted)i(for)e Fr(rewriteR1)n
Fx(.)33 b(W)m(e)18 b(ha)o(v)o(e)h(observ)o(ed)h(that)1020
2059 y(the)12 b(co)q(de)h(generated)g(for)e(a)h(v)n(ariet)o(y)f(of)g
(other)h(rules)h(is)e(equally)1020 2101 y(as)j(compact.)p
eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
