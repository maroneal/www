%!PS-Adobe-2.0
%%Creator: dvipsk 5.58c Copyright 1986, 1994 Radical Eye Software
%%Title: just-semantics.dvi
%%Pages: 182
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%EndComments
%DVIPSCommandLine: dvips just-semantics
%DVIPSParameters: dpi=300, compressed, comments removed
%DVIPSSource:  TeX output 1999.11.11:0644
%%BeginProcSet: texc.pro
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N
/X{S N}B /TR{translate}N /isls false N /vsize 11 72 mul N /hsize 8.5 72
mul N /landplus90{false}def /@rigin{isls{[0 landplus90{1 -1}{-1 1}
ifelse 0 0 0]concat}if 72 Resolution div 72 VResolution div neg scale
isls{landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div
hsize mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul
TR[matrix currentmatrix{dup dup round sub abs 0.00001 lt{round}if}
forall round exch round exch]setmatrix}N /@landscape{/isls true N}B
/@manualfeed{statusdict /manualfeed true put}B /@copies{/#copies X}B
/FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N /IE 0 N /ctr 0 N /df-tail{
/nn 8 dict N nn begin /FontType 3 N /FontMatrix fntrx N /FontBBox FBB N
string /base X array /BitMaps X /BuildChar{CharBuilder}N /Encoding IE N
end dup{/foo setfont}2 array copy cvx N load 0 nn put /ctr 0 N[}B /df{
/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0 0 sf neg 0 0]
N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data dup
length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{
128 ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub
get 127 sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data
dup type /stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N
/rc 0 N /gp 0 N /cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup
/base get 2 index get S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx
0 ch-xoff ch-yoff ch-height sub ch-xoff ch-width add ch-yoff
setcachedevice ch-width ch-height true[1 0 0 -1 -.1 ch-xoff sub ch-yoff
.1 sub]/id ch-image N /rw ch-width 7 add 8 idiv string N /rc 0 N /gp 0 N
/cp 0 N{rc 0 ne{rc 1 sub /rc X rw}{G}ifelse}imagemask restore}B /G{{id
gp get /gp gp 1 add N dup 18 mod S 18 idiv pl S get exec}loop}B /adv{cp
add /cp X}B /chg{rw cp id gp 4 index getinterval putinterval dup gp add
/gp X adv}B /nd{/cp 0 N rw exit}B /lsh{rw cp 2 copy get dup 0 eq{pop 1}{
dup 255 eq{pop 254}{dup dup add 255 and S 1 and or}ifelse}ifelse put 1
adv}B /rsh{rw cp 2 copy get dup 0 eq{pop 128}{dup 255 eq{pop 127}{dup 2
idiv S 128 and or}ifelse}ifelse put 1 adv}B /clr{rw cp 2 index string
putinterval adv}B /set{rw cp fillstr 0 4 index getinterval putinterval
adv}B /fillstr 18 string 0 1 17{2 copy 255 put pop}for N /pl[{adv 1 chg}
{adv 1 chg nd}{1 add chg}{1 add chg nd}{adv lsh}{adv lsh nd}{adv rsh}{
adv rsh nd}{1 add adv}{/rc X nd}{1 add set}{1 add clr}{adv 2 chg}{adv 2
chg nd}{pop nd}]dup{bind pop}forall N /D{/cc X dup type /stringtype ne{]
}if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1 ne{dup dup
length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}B /I{
cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul
add .99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI restore userdict
/eop-hook known{eop-hook}if showpage}N /@start{userdict /start-hook
known{start-hook}if pop /VResolution X /Resolution X 1000 div /DVImag X
/IE 256 array N 0 1 255{IE S 1 string dup 0 3 index put cvn put}for
65781.76 div /vsize X 65781.76 div /hsize X}N /p{show}N /RMat[1 0 0 -1 0
0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley X /rulex X V}B /V
{}B /RV statusdict begin /product where{pop product dup length 7 ge{0 7
getinterval dup(Display)eq exch 0 4 getinterval(NeXT)eq or}{pop false}
ifelse}{false}ifelse end{{gsave TR -.1 .1 TR 1 1 scale rulex ruley false
RMat{BDot}imagemask grestore}}{{gsave TR -.1 .1 TR rulex ruley scale 1 1
false RMat{BDot}imagemask grestore}}ifelse B /QV{gsave newpath transform
round exch round exch itransform moveto rulex 0 rlineto 0 ruley neg
rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta 0 N /tail
{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}
B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{
4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{
p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p
a}B /bos{/SS save N}B /eos{SS restore}B end
%%EndProcSet
TeXDict begin 40258431 52099146 1000 300 300 (just-semantics.dvi)
@start /Fa 57 128 df<48B5128038002E03EB4E00A201CE1340138E1404D8010E1300
A2140C3803FFFC38020E0C0006130400041420A20008130015601540001814C000381301
38FC3FFF1B157F941F>26 D<14401480EA01F938060700487E00181380383004C038700C
E03860086038E01070A21320136013401380A238610060007313E0003213C0381C018013
03380E0600EA19F80010C7FC5A14197E961A>28 D<011FB512C0903802F803EC78000104
1440A2010C146001081420A21310ED080013301320A20140131890387FFFF89038C07818
01801308A2D801001410A248EC00201202A2481560A2000C15C0001E1403D8FF83B5FC24
1C7E9B28>I<126012F0A212701210A41220A212401280040C7B830D>44
D<EAFFF0A20C027F8910>I<126012F0A2126004047B830D>I<1303A3497EA2497E130BA2
EB11E0A2EB31F01320A2EB4078A3497EA23801003EEBFFFEEB001E00027FA348EB0780A2
000C14C0121E39FF803FFC1E1D7E9C22>65 D<B512E0380F0038141E80801580A415005C
141E1478EBFFF0EB003C140FEC0780A2EC03C0A5EC078015005C143CB512F01A1C7D9B20
>I<90380FE02090387018603801C00439030003E000061301000E13004814605A152012
78127000F01400A80070142012781238A26C14407E000614806CEB01003801C006380070
18EB0FE01B1E7D9C21>I<B512C0380F0078141C1407A2EC0380EC01C0A215E0140015F0
A815E0A2140115C0EC0380A2EC0700141E1478B512E01C1C7D9B22>I<B6FC380F000F14
0380A215801400A214801500A3130113FF13011300A3154014001580A31401A2EC030014
0FB6FC1A1C7D9B1F>I<B512FE380F001E14061402A214031401A214811480A3130113FF
13011300A41400A77FEAFFF8181C7D9B1E>I<90381FC04090387030C03801C00C380300
03000E1301120C001C13005A15401278127000F01400A6EC7FF8EC07C000701303127812
38A27E120C120E000313053801C008390070304090381FC0001D1E7D9C23>I<39FFF0FF
F0390F000F00AC90B5FCEB000FAD39FFF0FFF01C1C7D9B22>I<EAFFF0EA0F00B3A8EAFF
F00C1C7D9B11>I<3803FFC038003E00131EB3127012F8A2131CEA703CEA4038EA3070EA
0FC0121D7E9B18>I<39FFF00FF0390F0003C0150014025C5C5C1460148049C7FC130213
07497E1317EB23C0EB43E01381EB00F08014788080141F80EC078015C015E039FFF01FF8
1D1C7D9B23>I<EAFFF8000FC7FCB11404A3140CA214081418143814F8B5FC161C7D9B1C>
I<B46CEB3FE0000FEC3E00A2D80BC0135EA2D809E0139EA33908F0011EA2EB7802A3EB3C
04A2EB1E08A3EB0F10A2EB07A0A3EB03C0A2EB0180121C3AFF8181FFE0231C7D9B29>I<
B4EB1FF0390F8003809038C00100120BEA09E0EA08F0A21378133C133E131E130F148113
07EB03C1EB01E114F113001479147D143D141FA2808080121CB46C7E1C1C7D9B22>I<EB
1FC0EBF0783801800C38070007000EEB038048EB01C0A248EB00E0007814F0A200701470
00F01478A8007814F0A36CEB01E0001C14C0001E1303000E14806CEB07003803C01E3800
F078EB1FC01D1E7D9C23>I<B512C0380F0078141C80801580A51500140E5C1478EBFFC0
90C8FCACEAFFF0191C7D9B1F>I<EB1FC0EBF0783801C01C38070007000EEB0380001E14
C0001C130148EB00E0007814F0A20070147000F01478A800701470007814F0A2003814E0
391C0701C0EB08C1390E1043800007EB27003803D03E3900F87808EB1FD0EB00181518EC
1C38EC0FF0A2EC07E0EC03C01D257D9C23>I<B57E380F00F01438141E140E140FA4140E
141E143814F0EBFF80EB01E0EB0070147880A61508A2141CEC1E1038FFF00EC7EA03E01D
1D7D9B21>I<3803F040380C0CC0EA1002EA3001EA600012E01440A36C13007E127EEA7F
E0EA3FFC6CB4FC00071380EA007FEB07C0EB03E0130113007EA36C13C0A238E0018038D0
0300EACE06EA81F8131E7D9C19>I<007FB512C038700F010060130000401440A200C014
201280A300001400B1497E3803FFFC1B1C7D9B21>I<39FFF01FF0390F000380EC0100B3
A26C1302138000035BEA01C03800E018EB7060EB0F801C1D7D9B22>I<39FFE003FC001F
C712F06C146015406D13C000071480A23903C00100A23801E002A213F000005BA2EB7808
A2137CEB3C10A26D5AA2131F6D5AA26D5AA36DC7FCA21E1D7E9B22>I<3BFFE0FFE03FC0
3B1F001F000F00001E011E13066C6D1304A3D807806D5AA201C013C0000301135BA29038
E033E0000101215BA29039F061F060000001401340A29039F88078C001785CA290263D00
3DC7FCA36D7FA3010C130CA32A1D7E9B2E>I<39FFE003FC391F8000F06CC712406D13C0
6C6C13800003EB01006D5A3801F00200005BEBF80CEB7C08EB3C10EB3E30EB1E206D5A14
C06D5AABEB7FF81E1C7E9B22>89 D<387FFFFC387C00781270006013F0EB01E01240EB03
C0EB0780A238000F00131EA25B5BA25B485A1404EA03C0EA0780A2380F000C001E1308A2
48131848133814F8B5FC161C7D9B1C>I<13201370A313B8A3EA011CA2EA031EEA020EA2
487EEA07FFEA040738080380A2001813C01301123838FC07F815157F9419>97
D<EAFFFCEA1C07EB038014C0A414801307381FFF00A2381C038014C0EB01E0A414C01303
EB078038FFFE0013157F9418>I<EBFC2038078260380E01E0EA1C004813600078132012
7012F01400A5142012701278003813407E6C138038078300EA00FC13157E9419>I<EAFF
FCEA1C07EB01C0EB00E0A21470A21478A71470A214E0A2EB01C0EB0700EAFFFC15157F94
1A>I<B51280EA1C031300A21440A213081400A21318EA1FF8EA1C1813081420A2130014
60144014C01301B5FC13157F9417>I<B51280EA1C031300A21440A213081400A21318EA
1FF8EA1C181308A390C7FCA5EAFFC012157F9416>I<EBFC2038078260380E01E0EA1C00
48136000781320127012F01400A3EB0FF8EB00E0A21270127812387E7E380783603800FC
2015157E941B>I<38FF8FF8381C01C0A9EA1FFFEA1C01A938FF8FF815157F9419>I<EAFF
80EA1C00B3EAFF8009157F940D>I<EA0FF8EA00E0AF12F0A213C0EA4180EA3F000D157F
9412>I<38FF81F8381C01E01480140013025B5B5B1330137013B8EA1D1C121EEA1C0E7F
14801303EB01C014E014F038FF83FC16157F941A>I<EAFFC0001CC7FCAC1480A3130114
005B5BB5FC11157F9415>I<00FEEB0FE0001E140000171317A338138027A23811C047A3
3810E087A2EB7107A3133AA2131CA2123839FE083FE01B157F941F>I<38FC03F8381E00
E014401217EA138013C01211EA10E01370A21338131CA2130E130714C013031301130012
3800FE134015157F9419>I<EA01F8EA070EEA0C03001C1380383801C0007813E0EA7000
00F013F0A7007013E0EA7801003813C0381C0380EA1E0738070E00EA01F814157E941A>
I<EAFFFCEA1C0FEB038014C0A51480EB0F00EA1FFC001CC7FCA9B47E12157F9417>I<EA
FFF8EA1C0EEB0780130314C0A314801307EB0E00EA1FF8EA1C1C7F7FA31480148414C4EB
03CC38FF80F816157F9419>114 D<EA1F10EA30F0EA603012C01310A2EAE000A2127EEA
3FC0EA1FE0EA03F0EA0078133813181280A21310EAC030EAF060EA8F800D157E9413>I<
387FFFF03860703000401310A200801308A300001300ADEA07FF15157F9419>I<38FF83
F8381C00E01440AE000C13C0000E138038060100EA0386EA00FC15157F9419>I<38FF01
F8383C0070001C13601440A26C1380A238070100A3EA0382A2EA01C4A3EA00E8A21370A3
132015157F9419>I<39FF07F87E393C01E03C0038EBC018391C02E010A3390E047020A3
3907083840A33903901C80A33901E00F00A33800C006A31F157F9423>I<38FF07F0381E
03C0000E1300EA0F02EA0706EA038413C8EA01D0EA00F0A21370137813BCEA011C487EEA
020F487E380C0380000813C0003C13E038FE07F815157F9419>I<38FF80FE381E003800
0E1320000F13606C13403803808013C03801C10013E212001374137C1338A848B4FC1715
809419>I<EAFFFEEAF01C12C013381280137013E01200EA01C0A2EA0380EA0700A2EA0E
02A2121C123813061270131EEAFFFE0F157E9415>I<EAE0E0A40B047A9C17>127
D E /Fb 24 121 df<13E01201EA0380EA0700120E5AA25AA25AA35AA91270A37EA27EA2
7E7EEA0380EA01E012000B217A9C16>40 D<12C07E12707E7E7EA27EA2EA0380A3EA01C0
A9EA0380A3EA0700A2120EA25A5A5A5A5A0A217B9C16>I<13E0A8B512E0A33800E000A8
13137F9516>43 D<1238127C127EA2123E120E121E121C127812F01260070B798416>I<
12035AA25A5AB4FCA212E71207AEEAFFF8A30D197B9816>49 D<EA07E0EA1FF8487EEA78
3EEAE00700F01380130312601200A2EB0700A2130E5B5B5B5B485A485A000FC7FC381E03
801238EA7FFFB5FC7E11197E9816>I<EA07E0EA1FF8487EEA781E130712301200A2130E
133EEA07FC13F013FCEA001E13077F1480A2126012F038E00700EA781EEA3FFC6C5AEA07
E011197E9816>I<EA3FFE127FA20070C7FCA7EA77F0EA7FFC7FEA780FEA300738000380
A2126012F0A238E00700EA781EEA3FFC6C5AEA07E011197E9816>53
D<12C012F012FC123EEA0F806C7EEA01F06C7E133EEB1F801307131FEB3E0013F8485AEA
07C0485A003EC7FC12FC12F012C011157E9616>62 D<1208121C123C1278127012E0A412
F012F812781230060D789B16>96 D<EA1FE0487E487EEA783CEA300E1200A2EA03FE121F
EA3E0E127012E0A3EA783E387FFFE0EA3FE7EA0F8313127E9116>I<12FCA3121CA4137C
EA1DFEEA1FFFEB0780381E03C0EA1C01EB00E0A6EB01C0EA1E03381F0780EBFF00EA1DFE
EA0C7813197F9816>I<133FA31307A4EA03C7EA0FF748B4FCEA3C1F487EEA700712E0A6
EA700F12786C5A381FFFE0EA0FF7EA07C713197F9816>100 D<EA03F0EA0FFC487EEA3C
0F487E3870038012E0B5FCA300E0C7FCA2387003801278EA3E07381FFF00EA07FEEA01F8
11127E9116>I<131E137F3801FF8013C7380383001380A2EA7FFFB5FCA2EA0380ACEA7F
FC487E6C5A11197F9816>I<1203EA0780A2EA0300C7FCA4EAFF80A31203ACEAFFFC13FE
13FC0F1A7C9916>105 D<EA7FC012FF127F1201B3EA7FFFB512806C130011197E9816>
108 D<38F9C38038FFEFC0EBFFE0EA3C78A2EA3870AA38FE7CF8A31512809116>I<EAFC
78EAFDFCB47EEA1F0FEA1E07121CAA38FF8FE0139F138F13127F9116>I<EAFC7CEAFDFE
B5FC381F0780381E03C0EA1C01EB00E0A6EB01C0EA1E03381F0780EBFF00EA1DFEEA1C78
90C7FCA6B47EA3131B7F9116>112 D<EA0FECEA3FFC127FEAF03CEAE01CA2EA7000EA7F
80EA1FF0EA07F8EA003CEA600E12E012F0EAF81EEAFFFC13F8EAC7E00F127D9116>115
D<EAFC3FA3EA1C07AB131F381FFFE0EA0FF7EA07C713127F9116>117
D<387F1FC038FF9FE0387F1FC0381C0700A2EA0E0EA36C5AA4EA03B8A3EA01F0A26C5A13
127F9116>I<387F1FC0133F131F380F1E006C5AEA03B813F012016C5A12017FEA03B8EA
073C131CEA0E0E387F1FC038FF3FE0387F1FC013127F9116>120
D E /Fc 3 78 df<1406140E141EA2143FA25C5CA2EB01BF1303143F01061380141F130C
1318A213301370EB7FFF90B512C0EBC00FEA0180EA0300A21206397FC0FFFC12FF1E1C7E
9B24>65 D<3801FFF85A38003F00A4137EA45BA4485AA4485AA4485AA4EAFFFE5B151C7E
9B14>73 D<48B46CEB3FF048157FD8003FECFE00EB37C0ED01BEED033E01675C1506A215
0C9039C7E018F813C315301560D80183EB61F015C1ECE181A23A0301F303E014F6A214FC
00064A5A14F814F013003AFFE0E0FFFC49485B2C1C7D9B2D>77 D
E /Fd 1 14 df<EB0FF8EB7FFF48B512C03907F007F0390F8000F8001EC7123C48800038
140E4880A248EC0380A60070EC0700A26C140E003C141E6C5C6C6C13F83907F007F00001
B512C06C6C90C7FCEB0FF8211A7E9326>13 D E /Fe 12 122 df<B512FEA2380F803E14
0E1406140780EB8183A21480138313FFA213831381A2EC8180EB8001EC0300A35C5C143E
B512FEA2191A7E991D>69 D<B512FCA2380F803C141C140C140E1406A2EB81861480A213
8313FFA213831381A3EB8000A6EAFFFCA2171A7E991C>I<EA1FF0EA383CEA7C1E7FA212
38120013FFEA0FCFEA3E0F127C12F8A31317387C27E0EA1FC313117F9015>97
D<EA03FCEA0F0EEA1C1F123C1278130E00F8C7FCA51278A2383C0180381C0300EA0F06EA
03FC11117F9014>99 D<EA03F0EA0E1C487EEA3C071278148012F8A2B5FC00F8C7FCA212
78A2383C0180381C0300EA0E06EA03FC11117F9014>101 D<123C127EA4123C1200A412
FCA2123CAD12FFA2081B7E9A0D>105 D<12FCA2123CB3A412FFA2081A7E990D>108
D<39FC3E03E09038C78C78393D039038003EEBE03CA2003C13C0AA39FF0FF0FFA220117E
9025>I<EAFCFE38FF8780383E03C0383C01E014F0130014F8A514F0130114E0383E03C0
383F0780383CFE0090C7FCA5B4FCA215187E9019>112 D<1206A4120EA2121EEA3FF012
FFEA1E00A81318A5EA0F30EA03E00D187F9711>116 D<38FF07F0A2001E1300EA0F06EA
078CEA03DC13F86C5A1200487E13BCEA031E1207EA0E0F381C078038FE0FF0A214117F90
17>120 D<38FF03F0A2383E01C0001E1380EA1F03000F1300A2EA0786A2EA03CCA213FC
6C5AA26C5AA21360A2EA70C012F812F95B0077C7FC123C14187F9017>I
E /Ff 1 4 df<B512C0A2EAC000AEB5FC7E12127D9118>3 D E /Fg
2 49 df<137E3801FF80380781E0380E00700018131848130C481306A2481303A6006013
06A26C130C6C1318000E1370380781E03801FF8038007E0018167D901E>13
D<1208121CA21238A312301270A21260A212C0A2060D7E8D09>48
D E /Fh 3 114 df<B612E0A200C0C71260B3A6B612E07E1B1C7E9B20>3
D<EA7FFE12FFEAC000AD0F0F7E9C15>112 D<EAFFFC13FEEA0006AD0F0F7D9C15>I
E /Fi 1 4 df<B512F0A238C00030B0B512F07E14147E931A>3 D
E /Fj 2 79 df<EAFFFEEBFF8014E038F007F0EB01F8EB0078143CA6147814F0EB03E0B5
12C0140014C038F00FF0EB01F8EB0078143C141C141EA5143C147C14F8EB03F0B512E014
C0140017237BA220>66 D<00FC131E7EA312F7A2EAF380A213C012F1A213E012F013F0A2
1378A21338133CA2131EA2130E130F1307A2149E1303A2EB01DEA2EB00FEA3147E17237B
A222>78 D E /Fk 3 97 df<148014C0A214601430B512FEA2C71230146014C0A2148017
0C7E8A1C>33 D<1218A31230A31260A312C0A2050B7E8B09>48 D<124012C0A5EAFFF8A2
EAC000A512400D0E7E8D12>96 D E /Fl 2 111 df<1204120C1200A5123012581298A2
1230A212601264A21268123006127E910B>105 D<EA71F0EA9A18129C12981218EA3030
A213321362EA606413380F0B7E8A13>110 D E /Fm 2 22 df<EC1FC0EC7FF0903801E0
F8EB038090380600FC5B5B5B5BEC01F813C0A215F0390180FFE0018313C0EC07E0ECFFF0
380301FD90C712F8A214011206A448EB03F0A215E0000E1307001E14C0001FEB0F80001B
14003819C03E3830FDFCEB3FF090C8FCA25AA45AA41E2D7FA221>12
D<EA03F813FE1200137FA26D7EA36D7EA26D7EA26D7EA36D7EA26D7EA3497E1307EB1E7F
133E90387C3F80EA01F8EA03F03907E01FC0EA0FC0393F800FE0EA7F0000FEEB07F05A5A
0070EB03F81D237EA221>21 D E /Fn 4 106 df<4A7EA26E7EA21560A2818181B71280
A2C8EA0C005D5D5DA25DA24A5AA221147E9226>33 D<EB7FE0EA03FF38078000000CC7FC
5A5AA25AA25AA2B512E0A200C0C7FCA21260A27EA27E7EEA07803803FFE0EA007F13187D
941A>50 D<13801201EA0300A31206A25AA35AA35AA25AA35AA21260A37EA27EA37EA37E
A27EA3EA0180120009267D9B0F>104 D<12C0A21260A37EA27EA37EA37EA27EA3EA0180
A2EA0300A31206A25AA35AA35AA25AA35AA209267E9B0F>I E /Fo
3 79 df<90387F80403801A0F03906401FC03908800C4000101302381100010021EB00C0
12411540004214001282AA12421241A212216C6C13C0EC03803908400F003806203C3801
9FF038007F801A1E7E9C15>67 D<EAFFFEEA1010EA0820B3A6EA1010EAFFFE0F1C7F9B1B
>73 D<39FFE00FF839101003203908080140390C0400C0EA0E02A2EA0D01380C8080EB40
40EB2020A2EB1010EB0808EB0404EB020213011401EB0080EC404014201410A214081404
140200121301123339FFC000C0C812401D1D809B20>78 D E /Fp
2 22 df<147CEB038790380607801318013013C0136013409038C00F80EA0180A2150038
0307FEEB0C1E143F903807E78038060007A215C0158048130FA31500001C5B141E001E5B
001B5B3831C1E038307F8090C8FCA25AA45AA21A25809C1B>12 D<EA07E06C7E6C7EA26C
7EA2137C137EA27FA2EB1F80A2130F14C0A214E0131FEB7BF013F3EA01E13807C1F8EA0F
81381F00FC123E00FC137E5A48133F5A181D7E9C1C>21 D E /Fq
9 62 df<121812F81218AA12FF080D7D8C0E>49 D<123EEA4180EA80C012C01200A2EA01
80EA03001204EA08401230EA7F8012FF0A0D7E8C0E>I<123E1241EA61801201EA030012
1EEA0180EA00C0A212C0A2EA4180EA3E000A0D7E8C0E>I<12035AA2120B121312231263
12C3EAFFC0EA0300A3EA0FC00A0D7E8C0E>I<EA6080EA7F00125C1240A2125FEA6180EA
00C0A212C01280EA4180EA3E000A0D7E8C0E>I<120FEA31801261EA60005A12DEEAE180
EAC0C0A31260EA2180EA1E000A0D7E8C0E>I<1240EA7FE013C0EA8080EA81001202A25A
120C12081218A40B0E7E8D0E>I<124012E012401200A3124012E0124003097D8808>58
D<EA7FFFB51280C8FCA4B512806C130011087E8815>61 D E /Fr
13 119 df<EA01E0EA0210EA04181208EA1030EA17E0A2EA10301220A31360EA50C0EA4F
001240A25AA20D127E8D10>12 D<1238127812C0A31278123805077E8A0A>44
D<124012E012601220A21240128003077D820A>59 D<EA1FFE38060180EB00C0A2380C01
80EB0300EA0FFEEA0C0738180180A3EB0300EA300EEAFFF8120E7E8D16>66
D<381FFF80EA0600A3EA0C101400EA0FF0EA0C30EA182113011302A2EA300EEAFFFC110E
7E8D15>69 D<381FC3F8380600C0A3380C0180A2EA0FFFEA0C0138180300A4EA300638FC
1F80150E7E8D17>72 D<EA1FC0EA0600A35AA45AA45A12FC0A0E7E8D0D>I<EA1FFCEA06
03EB0180A2380C03001306EA0FF8EA0C0C1218A40030138038FC0700110E7E8D15>82
D<387FFF80EA60C01240A238818100EA0180A348C7FCA41206EA3FC0110E7F8D11>84
D<38FE0FC038300200A3485AA4485AA3EA4010EA6060EA1F80120E7E8D14>I<38FC07C0
383002001306EA3804EA18085B1330EA1C20EA0C405BA2000DC7FC7E1204120E7D8D11>
I<EAE780EAB8C0EAB080EA6000A45AA20A097D880E>114 D<EA6080EAB0C0A2EA308012
60A2EA61001262123C0A097D880F>118 D E /Fs 4 49 df<B512C0A212027D871A>0
D<1204A3EAC460EAF5E0EA3F80EA0E00EA3F80EAF5E0EAC460EA0400A30B0D7E8D11>3
D<EB3F80EBFFE03803C0783807001C000C1306487F48EB0180A248EB00C0A2481460A600
6014C0A26CEB0180A26CEB03006C13060007131C3803C0783800FFE0EB3F801B1A7E9321
>13 D<1204120EA2121CA31238A212301270A21260A212C0A2070F7F8F0A>48
D E /Ft 18 121 df<EB01801303130714C013091311EB21E0136113401380380100F000
0213705A14784813385A48133C387FFFFCA2B512FE17147E931C>1
D<124012E012601220A31240A2128003097D820A>59 D<3807FFE03800E0703801C01814
0CA2140EEA0380A43807001CA31438000E1330147014E0EB01C0381C0700EAFFFC17147F
931B>68 D<D807F013FE000014F039017001E01402A214040002EB09C013381411142100
04EB238014431483131C39081D0700131EA2131C3818180E00FEEB7FC01F147F9320>77
D<3907E01FC00000EB060038017004A21338A238021C08A2130EA2486C5AA2EB0390A238
0801E0A21300A20018134012FE1A147F931A>I<EBF880EA030538060300EA0401120CA2
90C7FC120EEA0FE0EA07F8EA01FCEA001C7FA2EA400CA21308EA6018EAD020EA8FC01114
7E9314>83 D<381FFFF838381C18EA2038140812401410EA807000001300A35BA4485AA4
485AEA3FF81514809314>I<3907FC3F803900E01C00EBF010EB70205C6D5A0139C7FC13
3E131C131EA2133F136713C738018380EA030300067FEA0401001C7F38FE07F819147F93
1B>88 D<38FF80FC381C0030001E1340000E13C0380F01801400EA07021384EA03881390
13E06C5AA3485AA448C7FCEA3FE016147F9314>I<3807FFF0EB00E0380C01C0EB038038
0807005BEA100EC65A5B5B5B485A3803808038070100120F120EEA1C02EA3806EA701EEA
FFFC14147E9317>I<EA03C0EA0C20EA1870EA30E0EA6000A35AA2EA4010EA6020EA30C0
EA1F000C0D7F8C0F>99 D<EA0780EA1840EA3020EA604012C0EAFF80EAC0005AA2EAC020
1340EA6180EA3E000B0D7E8C10>101 D<1206120712061200A41238124CA2128C129812
18A212301232A21264A2123808147F930C>105 D<121E12065AA45A1338135C139CEA31
18EA36001238EA3F80EA61C0EA60C8A3EAC0D013600E147F9312>107
D<3830F87C38590C86384E0D06EA9C0EEA980C1218A248485A15801418A2396030190014
0E190D7F8C1D>109 D<EA30F8EA590C124E129C12981218A2EA301813191331A2EA6032
131C100D7F8C15>I<EA3810EA4C181310128C12981218A2EA3020A21340A2EA1880EA0F
000D0D7F8C11>118 D<EA0E3CEA13CEEA238EEA430C13001203A21206130812C6EAE610
EACA20EA71C00F0D7F8C13>120 D E /Fu 3 106 df<00181340007E13C0386E018012E7
EB03001306A25BA2EA6E18EA7E301218380060C0EB63F0EBC37038018738A2EA0307A212
06120CEB0370001813F0380800C015187E951A>37 D<1202120E12FEA2120EADEAFFC0A2
0A137E920F>49 D<12E0A31200A512E0AD03157E9408>105 D E
/Fv 25 122 df<B612FEA91F097F9B27>45 D<EE07C04C7EA24C7EA34C7EA24C7EA34C7E
A24B7FA34B80A24B8016DF16CF030F801687031F80160782033F80ED3E01037E80157C82
03FC804B137F0201815D830203824B7F0207825D83020F824B7F021F8292C7FC834A8202
3E80027FB77EA391B87E02F8C8127F0101834A81A20103844A810107844A81A249488384
011F8491C97EA2013E84D9FFC081B66C0107B612FEA44F487CC758>65
D<B66C051FB512F86F5FA26F5FD8001FF3C000A2011E6D17F7A26E6CEE01E7A26E6CEE03
C7A36E6CEE0787A26E6CEE0F07A26E6D151EA26E6D153CA36E6D1578A26E6D15F0A26F6C
EC01E0A36F6CEC03C0A26F6CEC0780A26F6CEC0F00A26F6D131EA36F6D5BA26F6D5BA26F
6D5BA3706C485AA2706C485AA2706C485AA3706C48C7FCA270139EA27013FCA2705BA370
5BA2715AA2715AEB7F80B600C0043FB612F8715AA271C7FC65477CC66E>77
D<B9FC18F818FEF0FFC0D8001F902680001F7F050113F8717FF03FFE727E1A80841AC084
1AE0A21AF0A81AE0A31AC0601A80601A004E5AF0FFFC050313F0051F5B92B7128006FCC7
FC18E00380CAFCB3ABB712F0A444477CC64F>80 D<B812F8EFFFE018FC18FFD8001F9026
80003F13C0050313F005007FF07FFE727E84727F86A2727FA286A862A24E5BA2624E90C8
FC4E5A4E5AF0FFF005075B053F138092B600FCC9FC18E084DB800013FCEF1FFF717F0503
13E08583717F85187FA285A785A5F30180F303C01A8084A272EC07801AC072EC0F00B700
F06D6D5A0601EBF83E9539007FFFFC071F5BCD13C052487CC657>82
D<DA7FF013030107B55B011FECE00F017F6E5A903AFFC00FFC3F4848C76C5AD803F8EC3F
FF4848140F48488048488082003F814981127F83A200FF82A27FA2837F7F7F01FE92C7FC
6C6C7E14F8ECFF806C14FCEDFFC06C15F86C15FF6C8217E06C826C826C6C816D81010F81
1303D9007F1580020315C0EC003F030114E0ED001F16077013F01600A20070167F00F016
3FA3171FA27E18E0A27E18C06C163F7E188001C0ED7F007F01F815FE01FEEC03FC26FE7F
C0495A26FC3FFCEB3FF0D8F80FB612C0D8F00392C7FC48C66C13FC48010313E034497AC7
41>I<003FBA12FCA49026FE00079038E0007F01F0170FD87FC0EF03FE49170190C71600
007E197EA2007C193EA30078191EA400F8191F48190FA5C81700B3B3A60103B812C0A448
467CC551>I<90380FFFF090B6FC000315C03A07F8007FF0486CEB1FFCED07FE486C6D7E
838183816C48816C5A6C5AC9FCA5157F023FB5FC0103B6FC011F13F090387FFE003801FF
E0481380D80FFEC7FC485A5B123F485AA2485AA45DA26C6C5BED077F6C6C130F6C6C013E
13F83C0FFF80F83FFFE000039038FFF01FC6ECC00F90390FFE0003332E7CAD38>97
D<91381FFFC049B512FC010714FF903A1FF8007F80D97FE0EBFFC0EBFF8048494813E048
5A1207485AA248486D13C0003FED7F80EE3F00007F92C7FC5BA312FFAA127FA27FA2123F
A26C6C15F0120F6DEC01E012076C6CEC03C06C6DEB07806C6DEB0F00D97FF0133E90391F
FC01FC0107B512F0010114C09026001FFCC7FC2C2E7CAD34>99 D<EFFF804BB5FCA4ED00
0782B3A2EC1FFC49B51283010714E390391FFC03F390397FE0007FD9FF807F4890C7120F
484880000781485AA2485A123FA25B127FA312FFAA127FA46C7EA2121FA26C7E00075D6C
6C5C6C6C5C6C6D137F6D6C01FB13C090273FF807E313FF010FB512C3010114039038003F
F038487CC741>I<EC1FFC49B512C0010714F090391FF80FFC90397FC001FE49486C7E48
90C7EA7F804848EC3FC04848EC1FE0120F484815F0160F003F16F8A25B007F150717FCA2
12FFA290B7FCA301F0C9FCA5127FA36C7EA2001F163CA26C7E17786C6C15F86C6CEC01F0
6C6DEB03E06C6DEB07C0D93FE0EB1F80903A1FFC01FF000107B512FC010014E0020F90C7
FC2E2E7DAD35>I<EDFFC0021F13F0027F13FC903901FFC0FE49EB01FF903807FC034948
481380131FEB3FF0137F14E001FF6D13006F5A6F5A163093C7FCABB612FEA4C601E0C8FC
B3B3A2007FEBFFF0A429487DC724>I<171FDA7FF0EBFFC00107B5000313E0011FECC7E7
903B7FE03FFF0FF09039FF800FFC48EB00074848EB03FE00079238FF07E0496DEB03C000
0FEE8000A2001F82A8000F5EA2000793C7FC6D5B00035D6C6C495A6C6D485A9138E03FF0
D801DFB512C0D803C791C8FC9038C07FF04848CAFCA37FA27FA213F890B612F06C15FF17
E06C8217FC6C826D8148B812801207D80FF0C7001F13C0D81FC014014848EC007F007FEE
3FE048C9FC171FA56C6CED3FC0A26C6CED7F806C6CEDFF00D80FF8EC03FED803FEEC0FF8
2601FFE0EBFFF06C6CB612C0010F4AC7FCD9007F13C034447DAE3A>I<EB7FC0B5FCA412
037EB3A2ED07FE92383FFFC04B13F09139C1F81FF89139C3C00FFC9139C70007FE14CE02
DC8002F87F18805CA25CA35CB3A9B60081B6FCA438487BC741>I<137CEA01FE3803FF80
5A4813C0A214E0A314C0A26C13807E3801FE00EA007C90C7FCACEB7FC0B5FCA412037EB3
B2B6FCA418497CC820>I<EB7FC0B5FCA412037EB3B3B3A8B61280A419487CC720>108
D<9027FF8003FFEC03FFB5011F01E0011F13E0037F01F8017F13F8913D81F80FFC01F80F
FC913D83C007FE03C007FE0003903D878003FF078003FF6CD98E00EC0E00029C039C8102
B86D01B87F06F88102F05DA24A5DA34A5DB3A9B66CB66CB61280A4592E7BAD62>I<9039
FF8007FEB590383FFFC04B13F0913981F81FF8913983C00FFC00039039870007FE6C138E
029C8002B87F188014F0A25CA35CB3A9B60081B6FCA4382E7BAD41>I<EC0FFE49B512F0
010714FC90391FF803FF90267FE00013C0D9FF80EB3FE04890C76C7E48486E7E48486E7E
000F82491403001F82003F17804980A2007F17C0A300FF17E0AA007F17C0A46C6C4A1380
A2001F17006D5C000F5E6C6C4A5A00035E6C6C4A5A6C6D495AD97FE0EBFFC090261FFC07
90C7FC0107B512FC010114F0D9001F90C8FC332E7DAD3A>I<90397FC01FFCB590B57E02
C314F09139CFE03FFC9139DF0007FE000301FC6D7E6C496D13804A6D13C04AEC7FE04A15
F0EF3FF8A2EF1FFCA218FEA2170FA218FFAA18FE171FA218FCA2173F18F818F0177F6EEC
FFE06E15C06E4913806E49130002DFEB0FFE9139CFC03FF802C3B512E002C01480DB1FF8
C7FC92C9FCB0B67EA438427CAD41>I<90397F803F80B5EBFFE0028113F8913883C3FC91
388707FE0003138E6C90389C0FFF14B8A214F0A2ED07FE9138E003FCED01F892C7FCA25C
B3A8B612E0A4282E7DAD2F>114 D<90390FFE01C090B512C7000314FF3807F801390FC0
007F48C7121F48140F007E1407A2150312FEA27E7F01E090C7FC13F8387FFFC014FF6C14
E015F86C806C14FF6C1580000115C06C6C14E0131F010014F014039138007FF80070141F
00F0140F15077E1503A26C15F0A27E6CEC07E07F6DEB0FC001F0EB1F80D8FEFCEBFF0039
F87FFFFCD8F01F13F0D8E0031380252E7CAD2E>I<EB01E0A61303A31307A3130FA2131F
133FA2137FEA01FF5A000F90B512C0B7FCA3C601E0C7FCB3A616F0A9017F14E0ECF00113
3FED03C0D91FF8138090390FFE0F00903807FFFE01015B9038001FF024427EC12D>I<D9
7FC0ECFF80B549B5FCA40003EC00076C81B3AA5EA36C5D5EA26D6C133B013F02F313C090
271FF803E313FF6DB51283010314039038003FF8382E7BAD41>I<B649B5FCA4000101C0
9038001FC06EEC0F806C17006E5C017F151E6E143E013F153C80011F5D8017F8010F5D6E
13016D5DED80036D5DEDC0076D5D15E06D4AC7FC15F05E027F131EEDF83E023F133CEDFC
7C021F1378EDFEF8020F5B15FF6E5BA36E5BA26E5BA26E90C8FCA2157EA2153CA2157C15
7815F85D1401001F5C383F8003D87FC05B38FFE0075D140F4AC9FC141E387FC07C495A38
3F03F06CB45A00071380D801FCCAFC38427EAD3D>121 D E /Fw
30 127 df<EAE1C0A31260EA4080A312C10A087F9913>34 D<12E0A312601240A312C003
087C990B>39 D<EA0180EA03001206120E120C121C1218123812301270A3126012E0AC12
601270A3123012381218121C120C120E12067EEA018009267D9B0F>I<12C012607E1238
1218121C120C120E12061207A37E1380AC13005AA31206120E120C121C1218123812305A
5A09267E9B0F>I<120313801300A2EAE31CEAFB7CEA7FF8EA1FE0EA0780EA1FE0EA7FF8
EAFB7CEAE31CEA0300A2138013000E117E9B13>I<12E0A312601240A312C003087C820B>
44 D<12E0A303037C820B>46 D<B61280A2C9FCA6B61280A2190A7E8D1E>61
D<EAFFF813FE38F00F80EB03C0130114E0A4EB03C0EB0780B512005B38F03F80EB07C0EB
01E0130014F0A4EB01E01303EB0FC0B5120013FC141A7D991A>66
D<00FC1370A27EA212EFA2EAE780A2EAE3C0A2EAE1E0A2EAE0F0A21378A2133CA2131EA2
130FA2EB07F0A21303A2141A7D991B>78 D<00F8EB0780007C14006C130E001E131E001F
131C6C6C5A00071378EBC0706C6C5A1201EBF1C0EA00FBEB7B80013FC7FCA2131EAB191A
80991A>89 D<EA0FC0EA3FF0EA7878EA6038EA401C1200A213FC120FEA3F1C127812E0A3
EA707CEA7FFCEA1F9C0E117F9012>97 D<12E0A9EAE7C0EAFFF0EAF878EAF038EAE01C13
0C130EA5131CA2EAF0381370EAFFE0EAE7C00F1A7D9914>I<EA07C0EA1FF0EA3C70EA70
18A2EAE00CA2EAFFFCA2EAE000A2126012707EEA3C0CEA1FFCEA07F00E117F9011>101
D<EA03F01207EA0E10EA1C00A6EAFFC0A2EA1C00AF0C1A80990C>I<12E0A9EAE3C0EAEF
F0EAF870EAF038A212E0AC0D1A7D9914>104 D<12F0A41200A61270B1041B7E9A0A>I<12
E0B3A8031A7D990A>108 D<EAE3C0EAEFF0EAF870EAF038A212E0AC0D117D9014>110
D<EA07E0EA1FF8EA3C3CEA381CEA700EEA6006EAE007A5EAF00FEA700EEA781EEA3C3CEA
1FF8EA07E010117F9013>I<EA03CEEA0FFEEA1C3EEA381EEA700EA212E0A51270A2EA38
1EEA3C3EEA1FFEEA07CEEA000EA70F187F9014>113 D<EAE1C012E712EFEAFE0012F85A
A25AAA0A117E900D>I<EA1F80EA3FE0EA7060EAE000A312F8EA7F80EA3FC0EA07E0EA00
F01370128012C0EAF0E0EA7FC0EA1F800C117F900F>I<1238A4EAFFC0A2EA3800AC1360
EA1FE0EA0F800B157F940E>I<EAE038AD137813F8127FEA3F380D117D9014>I<EAE00EA2
12F0EA701CA2EA38181338A2EA1C301370A2EA0E6013E0A2EA07C0A2EA03800F117F9012
>I<38E0780E137CA2136C3870CC1C13CEA23838C618383986381387138338190330A200
1D1370380F01E0120EA217117F901A>I<EA7007EA780EEA381CEA1C3CEA0E386C5A6C5A
5B1201487EEA0770EA0E30EA0C38EA1C1C487E487E00F013801111809012>I<EAE00EA2
1270131C1278EA3838A2121C1370120CEA0E60A2EA06E013C012031380A31300A2120612
8E12FC5A0F187F9012>I<EA3830127EEAC7E0EAC1C00C047D9813>126
D E /Fx 12 122 df<EB03C0EB0C301310EB203813401380EA0100A2000213701460EB1F
C0131138041F60EB0070A35AA31460001813E014C0EB018038140300EA230EEA20F890C7
FCA25AA45A1521809916>12 D<120FEA03807F1201A27F1200A27F1370A213781338A213
3C137C13DEEA018EEA030EEA060F487E121C00381380EA700312E038C001C0121A7E9916
>21 D<121C123C126012C0A41260123C121C060A7E910B>44 D<126012F0A2126004047D
830B>58 D<126012F0A212701210A31220A21240A2040B7D830B>I<3803FFFC38007007
EC0380EC01C09038E000E0A315F0485AA439038001E0A315C038070003A21580EC070000
0E130E141E14385C48485AB5C7FC1C1A7E9920>68 D<0003B512C038007001140015405B
A43901C02000A3146048B45A13801440A248485A1401A21402120E14061404140C481338
B512F81A1A7E991C>I<EA01F0EA070C120CEA181CEA3008EA7000126012E0A413041308
EA6010EA3060EA0F800E107F8F11>99 D<EA01F0EA0608EA1C04123812701308EAFFF0EA
E000A41304EA60081310EA3060EA0F800E107F8F12>101 D<EA380CEA4C0E124EEA8E06
129CA2EA1C041238A213081270A2EA3010EA3820EA1840EA0F800F107E8F13>118
D<380787803808C8C0EA10F1EA20E01400A2EA01C0A4EA0381A212C3EAE582EAC584EA78
7812107F8F16>120 D<EA3803004C1380384E0700128E129CA2EA1C0E1238A3485AA3EA
303C6C5AEA0FB8EA00385B1260EAE0E0485AEA4380003EC7FC11177E8F13>I
E /Fy 39 118 df<B61280A219027D8A20>0 D<0040132000C01360006013C038300180
38180300EA0C066C5A6C5AEA01B0EA00E0A2EA01B0EA0318EA060C487E487E3830018038
6000C04813600040132013147A9320>2 D<1203A4EAC30CEAE31CEA7338EA1FE0EA0780
A2EA1FE0EA7338EAE31CEAC30CEA0300A40E127D9215>I<13041306ACB612E0A2D80006
C7FCABB612E0A21B1C7E9A20>6 D<EB3F80EBC460380304180004130400087F00107F00
20EB0080A200401440A200801420A3B612E03980040020A400401440A200201480A20010
EB01000008130200045B000313183800C460EB3F801B1C7E9720>8
D<EB3F80EBC0603803001800041304487F001413050022EB0880002113103940802040EB
40403980208020EB1100130A1304A2130A1311EB20803940404040EB8020392100108000
2213080014EB050000087F6C5B000313183800C060EB3F801B1C7E9720>10
D<EB03FE90380FFF8090383C01E09038F00078D801C0131C48C7120600068048EC018048
EC00C0A2481560A2481530A3481518A900601530A36C1560A26C15C0A26CEC01806CEC03
006C1406D801C0131CD800F0137890383C01E090380FFF80D903FEC7FC25277E9D2A>13
D<B612E07EC9FCA7B612E0A2C9FCA7007FB512E0B6FC1B147E9320>17
D<90387FFF8048B5FCD80780C7FC000EC8FC12185AA25AA25AA71260A27EA27E120E6C7E
0001B512806C7E90C8FCA7007FB51280A219227D9920>I<EC01801407EC1E001478EB01
E0EB0780011EC7FC1378EA01E0EA0780001EC8FC127812E01278121EEA0780EA01E0EA00
78131EEB0780EB01E0EB0078141EEC0780140191C7FCA7007FB5FCB6128019227D9920>
20 D<D80F801320EA1FE0EA3FF8D8707C1360D8E01F13E039C007C1C0398003FF800100
1300143EC9FCD80F801320EA1FE0EA3FF8D8707C1360D8E01F13E039C007C1C0398003FF
8001001300143E1B137E9320>25 D<02031318020F1378021C13E09138700380903901E0
0F00903803801C90380E007090383C01E090387003802601C00EC7FC3807803C380E0070
383801C038F00780A2383801C0380E00703807803C3801C00E390070038090383C01E090
380E0070903803801C903801E00F90390070038091381C00E0020F137802031318251C7E
972A>28 D<EAC00638F00780383801C0380E00703807803C3801C00E390070038090383C
01E090380E0070903803801C903801E00F90390070038091381C00E0020F1378A2021C13
E09138700380903901E00F00903803801C90380E007090383C01E090387003802601C00E
C7FC3807803C380E0070383801C038F00780D8C006C8FC251C7E972A>I<13C0485AA348
C9FCA212065A121C1230B712F0A20030C9FC121C120C7E7EA26C7EA36C7E24167D942A>
32 D<153081A381A281811680ED00C0B712F8A2C912C0ED0380160015065DA25DA35D25
167E942A>I<13C0B3A700C013C0EAF0C33838C700EA0CCCEA06D8EA03F06C5AA26C5AA3
134012257F9C15>35 D<1306A25B131C13185B017FB512F090B612F8D80380C8FC48C9FC
123C12F0123C120E12036C7E6CB612F86D14F00130C8FC7F7FA27FA225187E952A>40
D<1403A26E7E8114001560007FB512F0B67EC8120E81ED01E0ED0078ED01E0ED0380ED06
005DB612F86C5CC812605D4A5AA24AC7FCA225187E952A>I<1310A21338A21328136C13
C6A2EA018338030180000713C0000F13E0003B13B800F3139E00C3138600031380B3A417
257F9C19>I<38030180B3A400C3138600F3139E003B13B8000F13E0000713C000031380
38018300EA00C6A2136C13281338A21310A217257F9C19>I<EB7FF8EA01FF3807800000
0EC7FC12185AA25AA25AA3B512F8A200C0C7FCA31260A27EA27E120E6C7E3801FFF8EA00
7F151A7D961C>50 D<1460A214C0A2EB0180A3EB0300A21306A25BA25BA35BA25BA25BA2
485AA248C7FCA31206A25AA25AA25AA35AA25A124013287A9D00>54
D<12C0A612E0A212C0A6030E7E9000>I<0040130400C0130C00601318A36C1330A36C13
60A2381FFFE06C13C0EA0C00A238060180A238030300A3EA0186A3EA00CCA31378A31330
A2161E809C17>I<B512C0A2C7FCABEA3FFF5AC7FCACB5FCA2121D7E9C17>I<B512FEA2C7
1206A9170B7E8E1C>I<1304130CEA03CCEA0C38EA1818EA301C133CEA703EEA60361366
A2EAE067A213C7A3EAE187A3EAE307A312E6A3EA6606126CEA7C0EEA3C0C1238EA1818EA
1C30EA33C0EA3000A210237E9F15>I<0040130200C01306B20060130CA26C1318001C13
70380F01E03803FF803800FE00171A7E981C>91 D<13101338A2136CA313C6A2EA0183A2
38030180A2380600C0A3481360A2481330A2481318A348130CA24813061402171A7E981C
>94 D<00C0130214060060130CA26C1318A36C1330A26C1360A26C13C0A338030180A238
018300A2EA00C6A2136CA31338A21310171A7E981C>I<124012C0ACB512E014F000C0C7
FCAD1240141D7E9C19>I<133C13E0EA01C013801203AD13005A121C12F0121C12077E13
80AD120113C0EA00E0133C0E297D9E15>102 D<12F0121C12077E1380AD120113C0EA00
E0133C13E0EA01C013801203AD13005A121C12F00E297D9E15>I<134013C0EA0180A3EA
0300A21206A35AA25AA35AA25AA35AA21260A37EA27EA37EA27EA37EA2EA0180A3EA00C0
13400A2A7D9E10>I<12C0A21260A37EA27EA37EA27EA37EA2EA0180A3EA00C0A2EA0180
A3EA0300A21206A35AA25AA35AA25AA35AA20A2A7E9E10>I<12C0B3B3A502297B9E0C>I<
12C0A21260A37EA37EA37EA37EA27EA3EA0180A3EA00C0A31360A21330A31318A3130CA3
1306A31303130110297E9E15>110 D<00C01306B3A5B512FE7E17197E981C>116
D<B512FEA238C00006B3A40040130217197E981C>I E /Fz 11 58
df<13C0A9B51280A23800C000A911147E8F17>43 D<121FEA3180EA60C0EA4040EAC060
A8EA4040EA60C0EA3180EA1F000B107F8F0F>48 D<1218127812981218AC12FF08107D8F
0F>I<121FEA6180EA40C0EA806012C01200A213C0EA0180EA030012065AEA10201220EA
7FC012FF0B107F8F0F>I<121FEA2180EA60C0A212001380EA0100121FEA008013401360
12C0A2EA8040EA6080EA1F000B107F8F0F>I<EA0180A212031205120D12191211122112
4112C1EAFFE0EA0180A4EA0FE00B107F8F0F>I<EA20C0EA3F80EA2E001220A3122FEA30
80EA2040EA0060A312C0EA80C0EA6180EA1F000B107F8F0F>I<EA0780EA1840EA30C012
6013005A12CFEAF080EAE040EAC060A31240EA60C0EA3080EA1F000B107F8F0F>I<1240
EA7FF013E0EA8040A2EA0080EA01001202A212061204A2120CA50C117F900F>I<121FEA
3180EA60C0A3EA3180EA3F00120EEA3380EA61C0EAC060A31340EA60C0EA1F000B107F8F
0F>I<121FEA3180EA60C0EAC0401360A3EA40E01221EA1E6012001340EA60C01380EA63
00121E0B107F8F0F>I E /FA 18 117 df<EB3060A3EB60C0A4EBC180387FFFF8B512FC
38018300A3EA0306A3B512FC6C13F838060C00485AA4485AA3161A7E931B>35
D<120212041208121812101230122012601240A212C0AA1240A212601220123012101218
120812041202071E7D950D>40 D<1280124012201230121012181208120C1204A21206AA
1204A2120C1208121812101230122012401280071E7E950D>I<1360AAB512F0A2380060
00AA14167E9119>43 D<120FEA30C0EA6060A2EA4020EAC030A9EA4020EA6060A2EA30C0
EA0F000C137E9211>48 D<120C121C12EC120CAFEAFFC00A137D9211>I<121FEA60C013
60EAF07013301260EA0070A2136013C012011380EA02005AEA08101210EA2020EA7FE012
FF0C137E9211>I<EA0FC0EA3070EA7038A31200133013E0EA0FC0EA007013381318131C
126012F01318EAE038EA6070EA1FC00E137F9211>I<136013E0A2EA016012021206120C
120812101220126012C0EAFFFCEA0060A5EA03FC0E137F9211>I<EA6060EA7FC01380EA
44001240A3124FEA70C0EA40E0EA00601370A212E0A21360EA40E0EA21C0EA1F000C137E
9211>I<EA07C0EA0C20EA10701220EA6000A25A12CFEAD0C0EAE060EAC0201330A31240
EA6020EA2060EA10C0EA0F000C137E9211>I<1240EA7FFC13F8EA4010EA80301320EA00
401380EA0100A25A12021206A2120EA512040E147E9311>I<EA0FC0EA1070EA20181260
A21270EA3C30EA3F60EA0F8013E0EA31F0EA6078EAC01C130CA3EA6018EA3030EA0FC00E
137F9211>I<120FEA3080EA6040EA4060EAC0201330A31240EA6070EA30B0EA0F301200
13201360EAE0401380EA4100123E0C137E9211>I<13781318A6EA0F98EA1878EA2038EA
601812C0A51260EA2038EA1858EA0F9E0F147F9312>100 D<12F01230A6EA33E0EA3430
EA38181230A9EAFC7E0F147F9312>104 D<EAF3C0EA34E01238EA30401300A812FE0B0D
7F8C0D>114 D<1210A312301270EAFF80EA3000A71380A3EA1100120E09127F910D>116
D E /FB 79 128 df<EBFE7C380381C6380603CE000E1384001C1380A6B512F0381C0380
AE38FF8FF0171A809916>11 D<13FEEA038138060180EA0E03381C010090C7FCA5B51280
EA1C03AE38FF8FF0141A809915>I<EBFF80EA0383EA0603120E121CA6B5FCEA1C03AE38
FF9FF0141A809915>I<90387E1F803901C17040390703C0600006EB80E0000E14401500
A5B612E0380E0380AE397F8FE3FC1E1A809920>I<13021304A21308EA07F8EA1C38EA30
3CEA702EEA6046EAE0471387A2EAE107A212E2EA6206EA740EEA3C0CEA1C38EA1FE0EA10
005AA25A10187F9313>28 D<EA60C0EAF1E0EAF9F0EA68D0EA0810A3EA1020A2EA2040EA
40800C0B7F9913>34 D<EA01C0EA0320EA0610120EA45B5BA23907807F809038001E0014
086D5A120B3811C020EA31E000605BEB7080EAE078013DC7FC6D1380130E39701F010038
3861C3380F807C191A7E991E>38 D<126012F012F812681208A31210A212201240050B7D
990B>I<1380EA010012025A120C120812185AA35AA412E0AA1260A47EA37E1208120C12
047E7EEA008009267D9B0F>I<7E12407E7E12181208120C7EA37EA41380AA1300A41206
A35A1208121812105A5A5A09267E9B0F>I<130CACB61280A2D8000CC7FCAC191A7E951E>
43 D<126012F0A212701210A31220A21240A2040B7D830B>I<EAFFC0A20A0280880D>I<
126012F0A2126004047D830B>I<EA07E0EA1C38EA381CEA300CEA700EEA6006A2EAE007
AAEA6006A2EA700EEA300CEA381CEA1C38EA07E010187F9713>48
D<12035AB4FC1207B3A2EA7FF80D187D9713>I<EA0F80EA1060EA2030EA4038EA803CEA
C01C12E01240EA003C1338A21370136013C0EA018013001202EA040412081210EA3008EA
3FF8127F12FF0E187E9713>I<EA07E0EA1838EA201CEA601EEA700EEA201E1200131CA2
13381370EA07E0EA0038131C130E130FA212E0A212C0EA400EEA601CEA1838EA07E01018
7F9713>I<1318A21338137813F813B8EA01381202A212041208121812101220124012C0
B5FCEA0038A6EA03FF10187F9713>I<EA3018EA3FF013E01380EA2000A5EA2FC0EA3060
EA2030EA00381318131CA2124012E0A2EA8018EA40381330EA30E0EA0F800E187E9713>
I<EA01F8EA0704EA0C06EA180E123013001270126012E0EAE3E0EAE418EAE80CEAF00EEA
E0061307A31260A2EA7006EA300EEA180CEA0C38EA07E010187F9713>I<1240EA7FFF13
FEA2EA4004EA80081310A2EA00201340A21380120113005AA25A1206A2120EA512041019
7E9813>I<EA07E0EA1818EA300CEA20061260A21270EA780CEA3E18EA1F30EA07C0EA03
E0EA0CF8EA307CEA601E130FEAC0071303A3EA6002EA2004EA1818EA07E010187F9713>
I<EA07E0EA1C30EA3018EA700CEA600EEAE006A21307A31260EA700FEA3017EA1827EA07
C7EA00071306130E130C12701318EA6030EA3060EA0F8010187F9713>I<126012F0A212
601200A8126012F0A2126004107D8F0B>I<B61280A2C9FCA6B61280A2190A7E8D1E>61
D<130CA3131EA2132F1327A2EB4380A3EB81C0A200017F1300A248B47E38020070A2487F
A3487FA2003C131EB4EBFFC01A1A7F991D>65 D<B51280380E00E014701438143CA51478
1470EB01E0380FFFC0380E00F01478143C141C141EA4141C143C147814F0B512C0171A7F
991B>I<EB3F023801C0C63803002E000E131E48130E14065A007813021270A200F01300
A600701302A21278003813047E14087E000313303801C0C038003F00171A7E991C>I<B5
7E380E00E01470808080A280A21580A81500A25C140E5CA2147814E0B51280191A7F991D
>I<B512F8380E003814181408140C1404A3EB0100A35BEA0FFFEA0E037FA390C7FCA8EA
FFE0161A7F9919>70 D<EB3F023801C0C63803002E000E131E48130E14065A0078130212
70A200F090C7FCA5903801FFC03970000E00A2127812387EA27E000313163801C0663800
3F821A1A7E991E>I<39FFE1FFC0390E001C00AB380FFFFC380E001CAC39FFE1FFC01A1A
7F991D>I<EAFF80EA1C00B3A6EAFF80091A7E990E>I<EA0FFEEA0070B3124012E0A2EA40
E0EA61C0EA1F000F1A7E9914>I<EAFFE0000EC7FCB01408A3141814101430147014F0B5
FC151A7F9918>76 D<B414FF000F14F0A2390B800170A23809C002A33808E004A2EB7008
A3EB3810A3EB1C20A2EB0E40A3EB0780A2EB0300121C39FF8307FF201A7F9923>I<00FE
EB7FC0000FEB0E001404EA0B80EA09C0A2EA08E01370A21338131CA2130E1307EB0384A2
EB01C4EB00E4A21474143CA2141C140C121C38FF80041A1A7F991D>I<137F3801C1C038
070070000E7F487F003C131E0038130E0078130F00707F00F01480A80078EB0F00A20038
130E003C131E001C131C6C5B6C5B3801C1C0D8007FC7FC191A7E991E>I<B51280380E01
E0EB007014781438143CA4143814781470EB01E0380FFF80000EC7FCABEAFFE0161A7F99
1A>I<137F3801C1C038070070000E7F487F003C131E0038130E0078130F00707F00F014
80A80070140000785B0038130E383C1C1E381C221C380E4138000713F03801E1C039007F
8080EB00C0A214E1EC7F00A2143E141C19217E991E>I<B5FC380E01C0EB0070147880A5
5C1470EB01C0D80FFFC7FC380E0380EB00C0801470A31478A31540143CEC1C8039FFE00F
001A1A7F991C>I<EA0FC2EA1836EA200EEA600612C01302A3EAE0001270127EEA3FE0EA
1FF8EA03FCEA007E130E130713031280A3EAC0021306EAE004EAD818EA87E0101A7E9915
>I<007FB5FC38701C0700401301A200C0148000801300A300001400B13803FFE0191A7F
991C>I<39FFE07FC0390E000E001404B200065B12076C5B6C6C5A3800E0C0013FC7FC1A
1A7F991D>I<39FF801FC0391C00070014066C1304A36C5BA26C6C5AA36C6C5AA26C6C5A
A3EB7080A213790139C7FCA2131EA3130CA21A1A7F991D>I<3AFF81FF07F03A3C007801
C0001CEC0080A36C90389C0100A33907010E02A33903830F04EB8207A2150C3901C40388
A33900E801D0A390387000E0A301305B01201340241A7F9927>I<39FF801FE0391E0007
0014066C13046C130CEB800800035BEA01C06D5A00001360EB7040EB78801338011DC7FC
131F130EAAEBFFC01B1A7F991D>89 D<B512C038F8038012E038C00700A2EA800E5BA248
5AA25B5BA2485AA2485A38070040A2120EA24813C04813801301EA70031307B5FC121A7E
9917>I<12FEA212C0B3AF12FEA207257D9B0B>I<EA2040A2EA4080A2EA8100A3EAE1C0EA
F1E0A2EA60C00B0B7A9913>I<12FEA21206B3AF12FEA20725809B0B>I<EA1FC0EA38707F
EA101C1200A2EA03FCEA1E1C1238127012E01480A2133CEA705F381F8F0011107F8F13>
97 D<12FC121CA913FCEA1D07381E0380381C01C0130014E0A6EB01C01480381E0300EA
1906EA10F8131A809915>I<EA07F8EA1C1C1238EA700813005AA612701304EA3808EA1C
18EA07E00E107F8F11>I<133F1307A9EA03E7EA0C17EA180F487E127012E0A612601270
6C5AEA1C373807C7E0131A7F9915>I<EA07C0EA1C30EA30181270EA600C12E0EAFFFCEA
E000A41260EA7004EA3808EA1C18EA07E00E107F8F11>I<EA01F0EA0718EA0E38EA1C10
1300A6EAFFC0EA1C00AEEAFF800D1A80990C>I<EA0FCF3818718038303000EA7038A4EA
30306C5AEA2FC00060C7FCA21270EA3FF013FC6C7EEA600FEAC003A4EA6006EA381CEA07
E011187F8F13>I<12FC121CA9137CEA1D87381E0380A2121CAB38FF9FF0141A809915>I<
1218123CA212181200A612FC121CAE12FF081A80990A>I<EA0180EA03C0A2EA0180C7FC
A6EA0FC01201B21241EAE180EAE300127E0A2182990C>I<12FC121CA9EB1FC0EB0F0013
0C5B13205B13E0121DEA1E70EA1C7813387F131E7F148038FF9FE0131A809914>I<12FC
121CB3A6EAFF80091A80990A>I<38FC7C1F391D8E6380391E0781C0A2001C1301AB39FF
9FE7F81D107F8F20>I<EAFC7CEA1D87381E0380A2121CAB38FF9FF01410808F15>I<EA07
E0EA1C38EA300CEA700EEA6006EAE007A6EA6006EA700EEA381CEA1C38EA07E010107F8F
13>I<EAFCFCEA1D07381E0380381C01C0A2EB00E0A6EB01C01480381E0300EA1D06EA1C
F890C7FCA6B47E1317808F15>I<EA03E1EA0C13EA180BEA300FEA700712E0A61270A26C
5AEA1C37EA07C7EA0007A6EB3FE013177F8F14>I<EAFC78EA1D9CEA1E1C1308EA1C00AB
EAFF800E10808F0F>I<EA1F20EA60E0EA402012C0A2EAF000127FEA3FC0EA1FE0EA00F0
EA8070133012C01320EAF040EA8F800C107F8F0F>I<1208A41218A21238EAFFC0EA3800
A81320A41218EA1C40EA07800B177F960F>I<38FC1F80EA1C03AB1307120CEA0E0B3803
F3F01410808F15>I<38FF0F80383C0700EA1C061304A26C5AA26C5AA3EA03A0A2EA01C0
A36C5A11107F8F14>I<39FE7F1F8039381C0700003C1306381C0C04130E380E16081317
A238072310149013A33803C1A014E0380180C0A319107F8F1C>I<38FE3F80383C1E00EA
1C086C5AEA0F306C5A6C5A12017F1203EA0270487E1208EA181CEA381E38FC3FC012107F
8F14>I<38FF0F80383C0700EA1C061304A26C5AA26C5AA3EA03A0A2EA01C0A36C5AA248
C7FCA212E112E212E4127811177F8F14>I<EAFFF8EAE07012C0EA80E0EA81C0A2EA0380
EA0700A2EA0E04121CA2EA380812701338EAFFF80E107F8F11>I<EAE1C0A40A047C9913>
127 D E /FC 62 125 df<903803F0F090380E19989038183B38EC33309038380700A3EB
700EA30007B512E03900700E0013E05CA4EA01C05CA4EA03805CA3130048136014E03866
30C038E67180D8CC63C7FCEA783E1D21819918>11 D<EB03FEEB0E03EB1C07EB1806EB38
00A35BA33807FFFC3800701CEBE038A41470EA01C0A314E4A2EA0380A21468143090C7FC
5AA2126612E65A12781821819916>I<EA0180EA03C0A21380A212071300A31206A35AA3
1208A3C7FCA4123012785A12600A1A7C990C>33 D<EA1830EA3C78A2EA1C38EA0810A3EA
1020EA2040EA4080EA81000D0B7A9914>I<1218123CA2121C1208A31210122012401280
060B78990C>39 D<121812381278123812081210A21220A212401280050B7D830C>44
D<EAFF80A2130009037D880E>I<1230127812F0126005047C830C>I<133E13C338010180
1202380481C0134138088380120438070300EA00065BEA01F0EA00187FA2130EA21260EA
E01CA2EA8038EA4030EA20E0EA1F8012187D9714>51 D<13031480EB0700A3130EA35BA2
13185BA25B5B13C6EA018EEA030EEA021C120412081210EA7FB838807F8038003800A25B
A41360111F7F9714>I<1206120F121E120C1200A81230127812F0126008107C8F0C>58
D<1203EA0780EA0F001206C7FCA8121812381278123812085AA25AA25A5A09177D8F0C>
I<EA01E0EA0610EA081812101220A21240EA6030EAE0F0EA61E0EA03C0EA0F80EA0E005A
EA1880EA1900121B120CC7FCA41218123C5A12300D1A799914>63
D<1420146014E0A2130114F0EB0270A213041308A21310A213201340A2EB8038EBFFF838
0100381202A25AA25A121838FE01FF181A7E991D>65 D<3803FFF83800700E1406140713
E0A43801C00E141C143814703803FFE0EB80781438141CEA0700A4000E1338A2147014E0
381C03C0B51200181A7D991B>I<EB0F82EB7062EBC0163803801E3807000C120E5A1218
00381308123000701300A25AA41420A314401260148038300100EA1006EA0C18EA03E017
1A7A991B>I<3803FFF83800700E80809038E00180A315C0EA01C0A43903800380A31500
48485AA2140E140C000E131C5C5C5C381C0380D8FFFEC7FC1A1A7D991D>I<0003B5FC38
0070071403140113E0A43801C080A313C13803FF001381A3EA0702EB0004A21408120E14
18141014304813E0B5FC181A7D991A>I<3903FF1FF83900700380A39038E00700A43801
C00EA43803FFFCEB801CA348485AA4000E5BA4485B38FF87FC1D1A7D991D>72
D<EA03FFEA0070A313E0A4EA01C0A4EA0380A4EA0700A4120EA45AEAFF80101A7D990F>
I<3903FF03F039007001C015001402495A5C5C144048485A01C1C7FC13C313C738038B80
139313C3EB81C0EA0701A26D7EA2120E1470A348137838FF81FE1C1A7D991D>75
D<EA03FFEA0070A35BA4485AA4485AA448C7FC1410A21420120E1460144014C0381C0380
B5FC141A7D9918>I<D803F8EB1FC0D80078EB3C00A2155C01B85BA290389C0138A23901
1C0270A21404140800025C1410A214200004EB41C0A21481A239080F0380A2130EEA180C
4AC7FC39FE083FE0221A7D9922>I<3903F007F839007800C01580A290389C0100A3138E
38010E0213061307A238020384A3EB01C4000413C8A2EB00E8A24813F01470A212181420
12FE1D1A7D991D>I<EB1F80EB70603801C030380300180006131C000E130C5A0018130E
123812301270A248131CA31438A21430147014E014C03860018038700300EA3806EA1C1C
EA07E0171A7A991D>I<3803FFF83800701C1406140713E0A43801C00EA2141C14383803
8060EBFF80EB8000A248C7FCA4120EA45AB47E181A7D991A>I<EB1F80EB70603801C030
380380183807001C000E130C5A0018130E123812301270A248131CA31418143814301470
1460EBE0C03861118038721300EA3A16EA1E1C3807F020EA001014601440EB38C0EB3F80
EB1F00130E17217A991D>I<3803FFF03800701C140E140713E0A43801C00E141C143814
E03803FF80EB80C014601470EA0700A4000E13E0A214E114E248136238FF803C181A7D99
1C>I<EB3F10EB60903801807013004813201206A31400120713C0EA03F8EA01FEEA007F
EB0F8013031301A21220A238600300A21306EA700CEAC818EA87E0141A7D9916>I<383F
FFFC38381C0C00201304124013381280A338007000A45BA4485AA4485AA41207EAFFF816
1A79991B>I<39FF803F80391C000C0014085CA25C14601440001E5B120E49C7FC1302A2
5BA25B5B120F6C5A136013405BA290C8FC1206A2191A78991D>86
D<39FF803F80391C000C001408001E5B000E5B1460000F13406C5B49C7FC1382EA038613
C4EA01C813D013E01200485AA4485AA448C8FCEA3FE0191A78991D>89
D<3803FFFEEBC00EEB001C0002133800061370000413E0A2EB01C038000380EB0700130E
131E131C5B5B5B3801C020A2EA038038070040120E4813C0003C1380EA380338700F00B5
FC171A7D9918>I<137EA213C0A4EA0180A4EA0300A41206A45AA45AA45AA45AA45A12FC
A20F257E9B0C>I<EA0408EA0810EA1020EA2040A2EA4080A2EA70E012F1A2EA60C00D0B
769914>I<137EA2130CA41318A41330A41360A413C0A4EA0180A4EA0300A41206A45A12
FCA20F25819B0C>I<EA03CCEA0E2EEA181C123812301270EAE038A4EAC072A3EA60F2EA
6134EA1E180F107C8F14>97 D<127E120EA35AA45AA2EA3BC0EA3C301278EA7018A3EAE0
38A4EAC070136013E0EA60C0EA6380EA1E000D1A7C9912>I<EA01E0EA0618120CEA1838
EA3010EA7000126012E0A413081310EA6020EA30C0EA1F000D107C8F12>I<EB1F801303
A3EB0700A4130EA2EA03CEEA0E2EEA181C123812301270485AA4EAC072A3EA60F2EA6134
EA1E18111A7C9914>I<EA01E0EA0E18EA1C08123812701310EAFFE0EAE000A41308EA60
101320EA30C0EA1F000D107C8F12>I<1307EB0980131BEB3B00133813301370A4EA07FF
EA00E0A5485AA5485AA490C7FC5AA21206126612E412CC1270112181990C>I<13F33803
8B8038060700120E120C121CEA380EA4EA301CA3EA183C5BEA07B8EA0038A25B1260EAE0
E0EAC1C0007FC7FC11177E8F12>I<EA1F801203A348C7FCA4120EA2137CEA0F86EA1E07
A2121CA2EA380EA35B00701380A21338EB3900EAE019EA600E111A7E9914>I<12031207
12061200A61238124C124E128E129CA2121C1238A212701272A212E212E4126412380819
7C980C>I<130C130E130C1300A613E0EA013812021204A3EA0070A413E0A4EA01C0A4EA
03801263EAE70012CE12780F2081980C>I<EA1F801203A3EA0700A4120EA2130E1313EA
1C2713431380EA1F00123CEA3F80EA39C0EA38E0EA70E2A313E4EAE064EA6038101A7E99
12>I<121F1207A3120EA4121CA41238A41270A412E4A412E81230081A7D990A>I<38307C
1E38598663399E0783801403129CA239380E0700A3140ED8701C1340A2141C158038E038
0C39601807001A107C8F1F>I<EA307CEA5986EA9E07A2129CA2EA380EA35B00701380A2
1338EB3900EAE019EA600E11107C8F16>I<EA01F0EA0618EA0C0CEA180E123012701260
12E0A2130C131C13181330EA6060EA30C0EA1F000F107C8F14>I<EA030F380590C0EA09
E0EBC060A3380380E0A4380701C0148013031400EA0E8E137890C7FCA25AA4B4FC131780
8F14>I<EA03C2EA0E2EEA181C123812301270EAE038A4EAC070A3EA60F0EA61E0121E12
00A2EA01C0A4EA1FF00F177C8F12>I<EA30F0EA5D18EA9E38EA9C181300A25AA45AA45A
12600D107C8F10>I<EA03E0EA04301208EA18701360EA1C00EA1F8013C0EA0FE0120013
6012E0A2EA80C0EA4180EA3E000C107D8F10>I<1206120EA45AA2EAFFC0EA1C005AA45A
A412E1A312E212E412380A177C960D>I<EA3806EA4C07EA4E0E128E129CA2EA1C1C1238
A3EA7039A3EA3079EA389AEA0F0C10107C8F15>I<EA3818EA4C1C124EEA8E0C129CA2EA
1C081238A213101270A21320EA3040EA18C0EA0F000E107C8F12>I<38380C10384C0E38
EA4E1C008E1318129CA2381C38101238A338707020A2144012303818B880380F0F001510
7C8F19>I<EA078F3808D180EA10F3EA20E1EBE000A2EA01C0A4EA0382A212C3EAE784EA
C588EA78F011107E8F12>I<EA3806EA4C07EA4E0E128E129CA2EA1C1C1238A3EA7038A3
EA3078EA38F0EA0F7012001360EA60E0EAE1C0EAC180EA4700123C10177C8F13>I<B712
C022017C8927>124 D E /FD 61 123 df<EB0FF0EB7FFC3801F80E3803E01F48485AEA
0F80A2141E140C91C7FCA4B6FCA2380F801FB2397FF0FFE0A21B237FA21F>12
D<EB0FFF137F3801F83FEA03E0EA07C0EA0F8080A7B6FCA2380F801FB2397FF0FFE0A21B
237FA21F>I<EAFFFCA40E047F8C13>45 D<1238127C12FEA3127C123807077C8610>I<13
FE3807FFC0380F83E0381F01F0383E00F8A248137CA312FC147EAD007C137CA36C13F8A2
381F01F0380F83E03807FFC03800FE0017207E9F1C>48 D<13181378EA01F812FFA21201
B3A7387FFFE0A213207C9F1C>I<EA03FCEA0FFF383C1FC0387007E0007C13F0EAFE0314
F8A21301127CEA3803120014F0A2EB07E014C0EB0F80EB1F00133E13385BEBE018EA01C0
EA0380EA0700000E1338380FFFF05A5A5AB5FCA215207D9F1C>I<13FE3807FFC0380F07
E0381E03F0123FEB81F8A3EA1F0314F0120014E0EB07C0EB1F803801FE007F380007C0EB
01F014F8EB00FCA2003C13FE127EB4FCA314FCEA7E01007813F8381E07F0380FFFC03801
FE0017207E9F1C>I<14E013011303A21307130F131FA21337137713E7EA01C71387EA03
071207120E120C12181238127012E0B6FCA2380007E0A790B5FCA218207E9F1C>I<0030
1320383E01E0383FFFC0148014005B13F8EA33C00030C7FCA4EA31FCEA37FF383E0FC038
3807E0EA3003000013F0A214F8A21238127C12FEA200FC13F0A2387007E0003013C0383C
1F80380FFF00EA03F815207D9F1C>I<EB1F80EBFFE03803E0703807C0F0380F01F8121F
123EA2387E00F0007C1300A2EAFC08EB7FC0EBFFE038FD80F038FF00F848137CA248137E
A4127CA3003C137C123E001E13F86C13F0380783E03803FFC0C6130017207E9F1C>I<12
601278387FFFFEA214FC14F8A214F038E0006014C038C00180EB0300A2EA00065B131C13
1813381378A25BA31201A31203A76C5A17227DA11C>I<13FE3803FFC0380703E0380E00
F05A1478123C123E123F1380EBE0F0381FF9E0EBFFC06C13806C13C06C13E04813F0381E
7FF8383C1FFCEA7807EB01FEEAF000143E141EA36C131C007813387E001F13F0380FFFC0
0001130017207E9F1C>I<EA01FE3807FF80380F83E0381E01F0EA3E004813F8147800FC
137CA3147EA4007C13FEA2EA3E01381E037EEA0FFEEA07FCEA0020EB007CA2121E003F13
F8A214F0EB01E0381E03C0381C0F80380FFE00EA03F817207E9F1C>I<1238127C12FEA3
127C12381200A81238127C12FEA3127C123807167C9510>I<1470A214F8A3497EA2497E
A3EB067FA2010C7F143FA2496C7EA201307F140F01707FEB6007A201C07F90B5FC4880EB
8001A2D803007F14004880000680A23AFFE007FFF8A225227EA12A>65
D<B67E15F03907F001F86E7E157EA2157FA5157E15FE5DEC03F890B55AA29038F001FCEC
007E811680151F16C0A6ED3F80A2ED7F00EC01FEB612F815C022227EA128>I<D903FE13
8090381FFF819038FF01E33901F8003FD803E0131F4848130F48481307121F48C71203A2
481401127EA200FE91C7FCA8127EED0180127F7E15036C6C1400120F6C6C1306D803F05B
6C6C13386CB413F090381FFFC0D903FEC7FC21227DA128>I<B67E15F03907F003FCEC00
7E81ED1F80ED0FC0ED07E0A216F01503A316F8A916F0A3ED07E0A2ED0FC0ED1F80ED3F00
157EEC03FCB612F0158025227EA12B>I<B612FCA23807F000153C151C150C150EA21506
140CA31500141C143CEBFFFCA2EBF03C141C140CA21503A214001506A3150EA2151E153E
EC01FCB6FCA220227EA125>I<B612F8A23807F001EC007815381518151CA2150CA21418
A21500A214381478EBFFF8A2EBF07814381418A491C7FCA8B512C0A21E227EA123>I<D9
03FE134090391FFFC0C090387F00F1D801F8133F4848130FD807C01307000F1403485A48
C71201A2481400127EA200FE1500A791380FFFFC127E007F9038001FC0A27EA26C7E6C7E
6C7E6C7ED801FC133F39007F80E790381FFFC30103130026227DA12C>I<B53883FFFEA2
3A07F0001FC0AD90B6FCA29038F0001FAFB53883FFFEA227227EA12C>I<B51280A23807
F000B3ACB51280A211227EA115>I<B538803FFCA23A07F0000380ED0700150E15185D15
E04A5A4A5A4AC7FC140E1418143C14FCEBF1FEEBF3FFEBF77F9038FE3F8001F87F496C7E
140F6E7E816E7E1401816E7E81ED3F8016C0ED1FE0B53881FFFEA227227EA12C>75
D<B512C0A2D807F0C7FCB31518A41538A21570A215F014011407B6FCA21D227EA122>I<
D8FFF0EC0FFF6D5C000716E0D806FC1437A3017E1467A26D14C7A290391F800187A29039
0FC00307A3903807E006A2903803F00CA2903801F818A3903800FC30A2EC7E60A2EC3FC0
A2EC1F80A3EC0F00D8FFF091B5FC140630227EA135>I<D8FFF8EB1FFE7F0007EC00C07F
EA06FF6D7E6D7E6D7E130F806D7E6D7E6D7E130080EC7F80EC3FC0EC1FE0EC0FF0140715
F8EC03FCEC01FEEC00FF157FA2153F151F150F15071503A2D8FFF01301150027227EA12C
>I<EB07FC90383FFF809038FC07E03903F001F848486C7E4848137E48487FA248C7EA1F
80A24815C0007E140FA200FE15E0A9007E15C0007F141FA26C15806D133F001F15006C6C
137E6C6C5B6C6C485A3900FC07E090383FFF80D907FCC7FC23227DA12A>I<B6FC15E039
07F007F0EC01FC1400157EA2157FA5157EA215FC1401EC07F090B512E0150001F0C7FCAD
B57EA220227EA126>I<EB07FC90383FFF809038FC07E03903F001F848486C7E4848137E
48487FA248C7EA1F80A24815C0007E140FA200FE15E0A9007E15C0007F141FA26C158090
3881F03F261F83F81300390FC70C7E3907E606FC3903F607F8D800FF13E090383FFF8001
071420EB0003EC01C0EDE0E015FF16C080A2ED7F801600151E232C7DA12A>I<B512FEEC
FFC03907F007F0EC01F86E7E157E157FA6157E5D4A5AEC07F090B512C05D9038F00FE06E
7E6E7E6E7EA81606EC00FEEDFF0CB538803FF8ED0FF027227EA12A>I<3801FE023807FF
86381F01FE383C007E007C131E0078130EA200F81306A27E1400B4FC13E06CB4FC14C06C
13F06C13F86C13FC000313FEEA003F1303EB007F143FA200C0131FA36C131EA26C133C12
FCB413F838C7FFE00080138018227DA11F>I<007FB61280A2397E03F80F007814070070
14030060140100E015C0A200C01400A400001500B3A248B512F0A222227EA127>I<B538
803FFCA23A07F0000180B3A60003EC03007F000114066C6C130E017E5B90383F80F89038
0FFFE0010190C7FC26227EA12B>I<B5EB0FFEA2D807F0EB00C0A26C6CEB0180A26D1303
000115007F000014067F6D5BA2EC801C013F1318ECC038011F133014E0010F5BA26D6C5A
A214F901035B14FD6DB4C7FCA26D5AA3147CA21438A227227FA12A>I<B53A0FFFF00FFE
A2260FF00090C712E000076E14C0A26C6C90393F800180A26D14C00001EE0300A26D496C
5A0000026F1306A2017F9038C7F00CA2028113F8013F01835BA29139C301FC38011F1530
16FE90260FE6005BA202FEEBFFE06D486D5AA26D486D5AA36D486DC7FCA36D48130EA237
227FA13A>I<EA0FFC383FFF80387E07C0EB03E0130114F0123C1200A2133FEA03FDEA1F
C1EA3F01127E12FCA4EA7E02EB0CF8381FF87F3807E03F18167E951B>97
D<B4FCA2121FABEB0FE0EB3FF8EBE07CEB803E497EEC0F80A215C0A81580141F01801300
EBC03E381EE07C381C3FF838180FC01A237EA21F>I<EBFF80000713E0380F83F0EA1F03
123E127E387C01E090C7FC12FCA6127C127EA2003E13186C1330380FC0603807FFC0C613
0015167E9519>I<EB01FEA2EB003EABEA01FC3807FFBE380F81FE381F007E003E133E12
7E127C12FCA8127CA26C137E6C13FE380F83BE3907FF3FC0EA01FC1A237EA21F>I<13FE
3807FF80380F87C0381E01E0003E13F0EA7C0014F812FCA2B5FCA200FCC7FCA3127CA212
7E003E13186C1330380FC0703803FFC0C6130015167E951A>I<EB1FC0EB7FE0EBF1F0EA
01E31203EA07C3EBC1E0EBC000A6EAFFFEA2EA07C0B2EA3FFCA2142380A211>I<3801FE
0F3907FFBF80380F87C7381F03E7391E01E000003E7FA5001E5BEA1F03380F87C0EBFF80
D809FEC7FC0018C8FCA2121C381FFFE06C13F86C13FE001F7F383C003F48EB0F80481307
A40078EB0F006C131E001F137C6CB45A000113C019217F951C>I<B4FCA2121FABEB07E0
EB1FF8EB307CEB403CEB803EA21300AE39FFE1FFC0A21A237EA21F>I<121C123E127FA3
123E121CC7FCA7B4FCA2121FB2EAFFE0A20B247EA310>I<B4FCA2121FABECFF80A2EC38
001460495A495A49C7FC130E5B137E13FF13CFEB0F806D7E6D7E1301806D7E147C143C39
FFE0FFC0A21A237EA21E>107 D<B4FCA2121FB3ADEAFFE0A20B237EA210>I<3AFF07F007
F090391FFC1FFC3A1F303E303E01401340496C487EA201001300AE3BFFE0FFE0FFE0A22B
167E9530>I<38FF07E0EB1FF8381F307CEB403CEB803EA21300AE39FFE1FFC0A21A167E
951F>I<13FE3807FFC0380F83E0381E00F0003E13F848137CA300FC137EA7007C137CA2
6C13F8381F01F0380F83E03807FFC03800FE0017167E951C>I<38FF0FE0EB3FF8381FE0
7CEB803E497E1580A2EC0FC0A8EC1F80A29038803F00EBC03EEBE0FCEB3FF8EB0FC090C8
FCA8EAFFE0A21A207E951F>I<EAFE1FEB3FC0381E67E013C71387A2381F83C090C7FCAD
EAFFF0A213167E9517>114 D<EA0FF3EA3FFFEA781FEA6007EAE003A212F000FCC7FCEA
7FE013F8EA3FFEEA0FFF120138000F80EAC007130312E0A238F00700EAFC0EEAEFFCEAC7
F011167E9516>I<487EA41203A21207A2120F123FB5FCA2EA0F80ABEB8180A5EB8300EA
07C3EA03FEEA00F811207F9F16>I<38FF01FEA2381F003EAF147E14FE380F81BE3907FF
3FC0EA01FC1A167E951F>I<39FFE01FE0A2391F800700000F1306EBC00E0007130C13E0
00035BA26C6C5AA26C6C5AA2EB7CC0A2137F6D5AA26DC7FCA2130EA21B167F951E>I<3A
FFE3FF07F8A23A1F007800C09038807C01000F1580A23A07C07E030014DE5D3903E1DF06
148FD801F1138CEBF307A2D800FF13D8EBFE0315F890387C01F0A2013C5BEB3800A22516
7F9528>I<39FFE07FC0A2390F801C006C6C5A6C6C5AEBF0606C6C5A3800F980137F6DC7
FC7F80497E1337EB63E0EBC1F03801C0F848487E3807007E000E133E39FF80FFE0A21B16
7F951E>I<39FFE01FE0A2391F800700000F1306EBC00E0007130C13E000035BA26C6C5A
A26C6C5AA2EB7CC0A2137F6D5AA26DC7FCA2130EA2130CA25B1278EAFC3813305BEA69C0
EA7F80001FC8FC1B207F951E>I<387FFFF0A2387C03E0387007C0EA600F38E01F8000C0
1300133E137EC65A5B485A00031330EA07E013C0380F8070121F383F0060003E13E0EA7C
03B5FCA214167E9519>I E /FE 81 127 df<9038FC1F800001133F0003137F390700E0
00380E01C0A738FFE1FCA2380E01C0B0191D809C18>11 D<EB01C0EA01F112033807F000
90C7FC120EA738FFF1C0A2EA0E01B0121E809D16>I<12E0B3A212401200A512E0A3031D
7B9C0D>33 D<EAE0E0A3EA6060EA4040A3EAC0C00B087F9C15>I<12E0A312601240A312
C003087C9C0C>39 D<EA01C0EA0380EA0700120EA25AA25AA35AA45AAE1270A47EA37EA2
7EA27EEA0380EA01C00A2A7D9E10>I<12E012707E7EA27EA27EA3EA0380A4EA01C0AEEA
0380A4EA0700A3120EA25AA25A5A5A0A2A7E9E10>I<120313801300A2EAE31CEAF33CEA
FB7CEA3FF0EA0FC0A2EA3FF0EAFB7CEAF33CEAE31CEA0300A2138013000E127D9E15>I<
1306ADB612E0A2D80006C7FCAD1B1C7E9720>I<12E0A312601240A312C003087C820C>I<
EAFFE0A20B0280890E>I<12E0A303037C820C>I<130113031306A3130CA31318A31330A3
1360A213C0A3EA0180A3EA0300A31206A25AA35AA35AA35AA35AA210297E9E15>I<EA03
C0EA0FF0EA1FF8EA3C3CEA381CEA700EA3EAE007ADEA700EA3EA381CEA3C3CEA1FF8EA0F
F0EA07E0101D7E9B15>I<5A1207123FB4FC12C71207B3A3EAFFF8A20D1C7C9B15>I<EA07
C0EA1FF0EA3878EA701CEA601EEAE00EEAC00F124013071200A2130F130E131E131C133C
137813F0EA01E013C0EA0380EA0700120E5A5A5AB5FCA2101C7E9B15>I<EA07E0EA1FF0
EA3838EA701CEAE01E1240A21200A2131C133C1378EA07F013E013F0EA003C131C131E13
0FA41280A2EAC01EEA601CEA383CEA1FF0EA07C0101D7E9B15>I<133C137C135C13DCA2
EA019C1203A2EA071CA2120EA2121CA212381278127012F0B512C0A238001C00A7121B7F
9A15>I<EA3FFFA20038C7FCA7EA39F0EA3FF87F131EEA3C0FA2383807801200A638400F
0012E0EA701E6C5AEA1FF8EA07E0111C7F9A15>I<13F8EA03FCEA0704EA0E005A5AA25A
A2EA71F0EAE7F8EAEFFCEAFC3CEAF81EEAF00E130712E0A51270A2130E1230EA381CEA1C
38EA0FF0EA03E0101D7E9B15>I<B5FCA2EA0007130E131CA213381378137013F013E012
01A2EA03C0A3EA0780A413005AA6101B7E9A15>I<EA03C0EA0FF0EA1C38EA381CEA700C
130E12E013061307A5130F1270EA781FEA3C3FEA3FF7EA1FE7EA0F86EA000EA2130C131C
1318EA2038EA70F0EA3FC0EA0F80101D7E9B15>57 D<12E0A31200AC12E0A303127C910C
>I<12E0A31200AC12E0A312601240A312C003177C910C>I<007FB512C0B612E0C9FCA8B6
12E06C14C01B0C7E8F20>61 D<EB3F80EBFFE0000313F03807E0F8380F0038381E07FCEA
3C0FEA381F38783C7E3870783EEB701E38E0E00EA73870701CEB783C38783C7838381FF0
383C0FE0381E07C06CC7FC3807E01E3803FFFCC613F0EB3FC0171D7E9C1C>64
D<131C133EA2132E1367A2EBE78013C713C300017F1383138100037F1301486C7EA21206
000E1378380FFFF8A2381C003CA2121800387FA248131F80126000E0EB0780191D7F9C1C
>I<EAFFF813FF38F00F80EB03C0EB01E0EB00F0A5EB01E0EB07C0B51280EBFE00EBFF80
38F01FC0EB03E0EB01F013001478A514F0EB01E0EB07C0B51280EBFC00151D7C9C1C>I<
EB3FC03801FFF8EA03C03807801848C7FC121E5AA25AA35AA91278A37EA27E6C13083807
80183803C0783801FFF038003F80151F7D9D1B>I<EAFFFC13FF38F00F80EB03E01301EB
00F014781438143CA2141C141EA8143CA3147814F0A2EB03E0EB0FC0B5120013FC171D7C
9C1E>I<B512C0A200F0C7FCABB51280A200F0C7FCACB512C0A2121D7C9C19>I<B51280A2
00F0C7FCABB5FCA200F0C7FCAE111D7C9C18>I<EB3FC0EBFFF83803E07C3807801C380F
000C001E1300121C123C12381278A25AA6EB03FCA2EB001C1278A21238123C121C121E7E
EA07803803E07C3800FFF8EB3FC0161F7E9D1C>I<00F013F0ADB5FCA2EAF000AE141D7C
9C1D>I<12F0B3AB041D7C9C0C>I<133CB3A7EAC07CEAE078EAFFF0EA7FE0EA0FC00E1E7E
9C14>I<00F0133C147814F0EB01E0EB03C0EB0780EB0F00131E5B5B5B5BEAF1F012F3EA
F778EAFE7CEAFC3C7FEAF81F487E14801307EB03C014E01301EB00F0A21478147C161D7C
9C1D>I<12F0B3A9B5FCA2101D7D9C16>I<00FCEB07E0A300EE130DA300E71319A3EB8039
00E31331EBC071A200E11361A2EBE0E1A200E013C113F1EB7181A3EB3B01A3131EA31300
1B1D7C9C24>I<00FC1370A27E12EE12EF12E7A2138012E313C0A2EAE1E0A212E013F013
701378A2133CA2131C131E130EA2130F130714F01303A2141D7C9C1D>I<133F3801FFE0
487F3807C0F8380F807C381E001E003E131F003C7F48EB0780A348EB03C0A86C13070078
1480A2007C130F003C1400003E5B6C133E6C6C5A6C6C5A6CB45A6C5BD8003FC7FC1A1F7E
9D1F>I<EAFFFC13FF38F00F80EB03C0EB01E0EB00F0A6EB01E01303EB0FC0B51280EBFE
0000F0C7FCAD141D7C9C1B>I<133F3801FFE0487F3807C0F8380F807C48487E003E7F00
3C7F48EB0780A348EB03C0A90078EB0780A2130E393C0F0F00383E079F381E03DE380F83
FC6C6C5A6CB45A6C7F38003F78EB003C143E80EC0F801A237E9D1F>I<EAFFF813FF38F0
0F80EB03C0EB01E0EB00F0A5EB01E01303EB0FC0B51280140013F8EAF03C131C131E7FA2
EB0780A2EB03C0A2EB01E0EB00F0A21478151D7C9C1B>I<EA03F8EA0FFEEA1C0F487E48
7E0060C7FC12E0A47E1278127FEA3FE0EA1FFCEA07FEEA01FF38001F801307EB03C0A213
01A400C01380EAE00338F00700EA7C0EEA1FFCEA07F0121F7E9D17>I<B61280A2D8001E
C7FCB3A9191D7F9C1C>I<00F01370B3A5007813E0A2383C01C0381E0380EA0F073807FE
00EA01F8141E7C9C1D>I<00F0EB0380A2007814005CA26C130EA2123E001E5BA26C5BA3
6C6C5AA23803C06014E0A26C6C5A13E1A23800F18013F30173C7FCA2137B133EA2131C19
1D7F9C1C>I<00F8EB01E0007C14C06CEB0380001E1307001F1400380F800E0007131EEB
C01C3803E03C000113386D5A000013F0EB78E0EB7DC0133F6D5A91C7FC7FAC1B1D809C1C
>89 D<387FFFF0A2380001E0130314C013071480EB0F005B131E133E133C5B13F85B1201
5B485A12075B120F90C7FC121E123E123C127C1278B512F0A2141D7E9C19>I<12FFA312
E0B3B112FFA308297D9E0C>I<EA6060EA4040A3EAC0C0EAE0E0A30B08789C15>I<12FFA3
1207B3B112FFA30829809E0C>I<1203EA0780EA0FC0EA1CE0EA3870EA7038EAE01C0E07
7D9C15>I<EA0FC0EA3FF0EA7FF8EA7038EA401C1200A213FC120F123FEA781C12E0A3EA
F07CEA7FFC13DCEA3F1C0E127E9114>97 D<12E0ABEAE3E0EAEFF8EAFFFCEAF83EEAE01E
130E1307A6130EEAF01EEAF83CEAFFF8EAEFF0EAE3E0101D7D9C15>I<EA03F0EA0FFCEA
1FFEEA3C0EEA7802EA70005AA61270EA7802EA3C0EEA1FFEEA0FFCEA03F00F127F9112>
I<1307ABEA07C7EA1FF7EA3FFFEA3C1FEA7807127012E0A61270EA780FEA3C1FEA3FFFEA
1FF7EA07C7101D7F9C15>I<EA07E0EA0FF0EA3FF8EA3C3CEA700C130EEAFFFEA3EAE000
A31270EA7802EA3C0EEA1FFEEA0FFCEA03F00F127F9112>I<13FC12011203EA0700120E
A7EAFFE0A2EA0E00B00E1D809C0D>I<3807C3C0EA0FFF5A38383800487EA56C5AEA3FF0
5BEA77C00070C7FCA2EA3FFC13FF481380EA700738E001C0A3EAF003387C0F80383FFF00
6C5AEA07F8121B7F9115>I<12E0ABEAE3E0EAEFF0EAFFF8EAF83CEAF01C12E0AD0E1D7D
9C15>I<12F0A41200A71270B2041D7E9C0A>I<EA03C0A4C7FCA7EA01C0B3A412C3EAFF80
1300123E0A25839C0B>I<12E0AB133C137813F0EAE1E0EAE3C0EAE780EAEF00B4FC1380
12FBEAF9C0EAF1E012E013F013781338133C131E0F1D7D9C14>I<12E0B3AB031D7D9C0A>
I<38E3F03F39EFF8FF80D8FFFD13C039F81F81E038F00F00EAE00EAD1B127D9122>I<EA
E3E0EAEFF0EAFFF8EAF83CEAF01C12E0AD0E127D9115>I<EA03F0EA0FFC487EEA3C0F38
780780EA700338E001C0A5EAF00300701380EA7807383C0F00EA1FFE6C5AEA03F012127F
9115>I<EAE3E0EAEFF8EAFFFCEAF83EEAE01E130E1307A5130F130EEAF01EEAF87CEAFF
F8EAEFF0EAE3E0EAE000A8101A7D9115>I<EA07C7EA0FF7EA1FFFEA3E1FEA780FEA7007
12F012E0A51270EA780FEA3C1FEA3FFFEA1FF7EA07C7EA0007A8101A7F9115>I<EAE380
12E712EFEAFC005A5AA25AAB09127D910E>I<EA1FC0EA3FF0127FEAF030EAE000A27E12
7FEA3FC0EA1FE0EA01F0EA0038A21280EAF078EAFFF0EA7FE0EA1FC00D127F9110>I<12
1CA6EAFFE0A2EA1C00AC1320EA1FF0120FEA07C00C187F970F>I<EAE01CAE137CEAFFFC
EA7FDCEA3F1C0E127D9115>I<EAE007A212F0EA700EA2EA381CA3EA1C38A3EA0E70A2EA
0660120713E0EA03C0A210127F9113>I<39E03E0380A3D870371300EB7707A213733838
E38EA33818E18C381CC1CC001D13DCA2380D80D8000F13F8A20007137019127F911C>I<
3870038038780700EA3C0EEA1C1C120E6C5AEA03F06C5A5B7F487EEA0738EA0618EA0E1C
487E487E3870038000F013C01212809113>I<EAE007A2EA700EA21278EA381CA2121C13
38120CEA0E3013701206EA0760120313C01201A21380A2EA0300A25A12FE5A5A101A7F91
13>I<EA7FFCA3EA007813F013E01201EA03C01380EA07005A121E121C123C5AEAFFFCA3
0E127F9112>I<EA3C1C127EEA7FF812E1EAE0F00E057D9B15>126
D E /FF 60 123 df<48B512E038003C00013813601540A35BA315005BA4485AA4485AA4
48C8FCA45AEAFFF01B1C7E9B1A>0 D<1406A2140E141F1427A21447EC8780EB01031303
010213C01304EB08011318011013E01320EB400013C04913F048C7FC0002147012060004
14784814385A5A003FB512FC5AB6FC1E1D7E9C23>I<13F8EA030C380E0604EA1C073838
03080030138800701390A200E013A0A214C01480A3EA6007EB0B8838307190380F80E016
127E911B>11 D<EB01F0EB0618EB080C1310EB200E13401380141CEA0100141814383802
0FF0EB10C0EB0FE0EB00305AA21438A2481370A314E01218EB01C000141380EB0300EA23
0EEA20F890C7FCA25AA45AA217257F9C17>I<38078010EA1FC0383FE020EA7FF0386030
40EAC0183880088012001304EB0500A21306A31304A3130CA35BA45BA21320141B7F9115
>I<EA3C1F384E6180384681C0EA4701128F128E120EA2381C0380A438380700A4EA700E
12301200A25BA45BA21330121B7E9115>17 D<EA0780EA01C07F1200A27F1370A2137813
38A2133C131CA2131E130E131E133F136713C738018780EA03031206000E13C0EA1C0112
38007013E0EAE0004813F0141D7E9C18>21 D<007E1360000E13E0A3381C01C0A2EB0380
1400485A130E130C5B485A5BEA71C00073C7FC12FC12F013127E9115>23
D<3801FFF85A120F381E1E00EA180EEA38061270A2EAE00EA3130C131C13185BEA60606C
5A001FC7FC15127E9118>27 D<380FFFE05A5A3860C0001240485A12001201A348C7FCA3
5AA3120E120613127E9112>I<5B1302A45BA45BA2137E3801C980380710E0000C136000
18137000381330EA7020A200E01370A2134014E0A2386041C0EB838038308600EA1C9CEA
07E00001C7FCA41202A414257E9C19>30 D<001E130238278004002313083803C0100001
1320EBE04000001380EBE10013F11372137413781338A21378137C139CEA011C1202EA04
1EEA080EEA100F7F0020130838400390388001E0171A7F911A>I<14401480A4EB0100A4
1302A2001C13060027130EEA4704140600871302A2EA0E08A2001C1304A2EB1008A21410
1420EB2040000C138038072300EA01FCEA0040A45BA417257E9C1B>I<0008130648130E
A248130614025A1308131800801304A2EB300C140800C01318EBF030B512F0387F9FE0EB
1FC0383E0F00171280911A>I<121E123E126012C0A51260123E121E070B7E930C>44
D<126012F0A2126004047C830C>58 D<126012F0A212701210A41220A212401280040C7C
830C>I<EC0380EC0F00143C14F0EB03C0010FC7FC133C13F0EA03C0000FC8FC123C12F0
A2123C120FEA03C0EA00F0133C130FEB03C0EB00F0143C140FEC038019187D9520>I<13
0113031306A3130CA31318A31330A31360A213C0A3EA0180A3EA0300A31206A25AA35AA3
5AA35AA35AA210297E9E15>I<12E01278121EEA0780EA01E0EA0078131EEB0780EB01E0
EB0078141EEC0780A2EC1E001478EB01E0EB0780011EC7FC1378EA01E0EA0780001EC8FC
127812E019187D9520>I<140CA2141CA2143C145CA2149E148EEB010E1302A21304A213
081310A2497EEB3FFFEB40071380A2EA0100A212025AA2001C148039FF803FF01C1D7F9C
1F>65 D<48B5FC39003C01C090383800E015F01570A25B15F0A2EC01E09038E003C0EC07
80EC1F00EBFFFC3801C00FEC0780EC03C0A2EA0380A439070007801500140E5C000E1378
B512C01C1C7E9B1F>I<903801F80890380E0618903838013890386000F048481370485A
48C71230481420120E5A123C15005AA35AA45CA300701302A200305B00385B6C5B6C1360
38070180D800FEC7FC1D1E7E9C1E>I<48B5128039003C01E090383800701538153C151C
5B151EA35BA44848133CA3153848481378157015F015E039070001C0EC0380EC0700141C
000E1378B512C01F1C7E9B22>I<48B512F839003C0078013813181510A35BA214081500
495AA21430EBFFF03801C020A4390380404014001580A23907000100A25C1406000E133E
B512FC1D1C7E9B1F>I<48B512F038003C00013813301520A35BA214081500495AA21430
EBFFF03801C020A448485A91C7FCA348C8FCA45AEAFFF01C1C7E9B1B>I<903801F80890
380E0618903838013890386000F048481370485A48C71230481420120E5A123C15005AA3
5AA2EC7FF0EC07801500A31270140E123012386C131E6C136438070184D800FEC7FC1D1E
7E9C21>I<3A01FFC3FF803A003C00780001381370A4495BA449485AA390B5FC3901C003
80A4484848C7FCA43807000EA448131E39FFE1FFC0211C7E9B23>I<3801FFC038003C00
1338A45BA45BA4485AA4485AA448C7FCA45AEAFFE0121C7E9B12>I<D801FCEBFF80D800
1CEB1C00012E13181510A2132701475B13431480A2903881C040A3EB80E0D801005B1470
A300020139C7FCA3141D48131E140EA2120C001C1304EAFF80211C7E9B21>78
D<3801FFFE39003C03C090383800E015F01570A24913F0A3EC01E001E013C0EC0780EC1E
00EBFFF03801C038140C140EA2EA0380A43807001E1508A2151048130FD8FFE01320C7EA
03C01D1D7E9B20>82 D<EB0FC1EB3033EB400FEB80061201EA0300A200061304A2000713
00A27FEA03F06CB4FC6C13C0EB3FE01303EB00F014701430A21220A200601360A214C014
8038F00300EACC06EA83F8181E7E9C19>I<001FB512F0391C0380703930070030002014
2012601240130E1280A2000014005BA45BA45BA45BA41201EA7FFF1C1C7F9B18>I<397F
F03FE0390F000700000E13061404A3485BA4485BA4485BA4485BA35CA249C7FCEA60025B
6C5AEA1830EA07C01B1D7D9B1C>I<39FFC00FF0391C00038015001402A25C5C121E000E
5B143014205CA25C49C7FC120FEA07025BA25BA25B5BEA03A013C05BA290C8FCA21C1D7D
9B18>I<3AFFC0FFC0FF3A3C001C003C001C1510143C1620025C1340A2029C1380A29039
011C0100A20102130213045D01085BA2496C5A121ED80E205BA201405B018013C05D260F
000FC7FCA2000E130EA2000C130CA2281D7D9B27>I<3A01FFC0FF803A001E003C00011C
13306D13205D010F5B6D48C7FC1482EB038414CCEB01D814F05C130080EB0170EB0278EB
04381308EB103CEB201CEB401EEB800E3801000F00027F1206001E497E39FF803FF0211C
7F9B22>I<39FFE007F8390F0001E0158015006C13026D5A00035BEBC018141000015B6D
5A00005B01F1C7FC13F21376137C1338A25BA45BA4485AEA1FFC1D1C7F9B18>I<90B512
E09038F001C03901C003809038800700EB000E141E0002131C5C5CC75A495A495A49C7FC
5B131E131C5BEB7002495AEA01C0EA038048485A5A000E1318485B48137048485AB5FC1B
1C7E9B1C>I<EA01E3EA0717EA0C0F1218EA380E12301270A2485AA4EB3880A3EA607838
319900EA1E0E11127E9116>97 D<123F1207A2120EA45AA4EA39E0EA3A30EA3C18123812
70131CA3EAE038A313301370136013C01261EA2300121E0E1D7E9C12>I<EA01F0EA030C
120CEA1C1EEA383CEA3018EA7000A25AA51304EA60081310EA3060EA1F800F127E9112>
I<EB07E01300A2EB01C0A4EB0380A43801E700EA0717EA0C0F1218EA380E12301270A248
5AA4EB3880A3EA607838319900EA1E0E131D7E9C16>I<EA01F0EA0708120CEA1804EA38
081230EA7030EA7FC0EAE000A51304EA60081310EA3060EA0F800E127E9113>I<EB01E0
EB0630EB0E7814F0EB1C601400A45BA23803FFC038003800A25BA55BA5485AA55B1203A2
0063C7FC12F312F612E4127815257E9C14>I<EB38C013C5EA0183EA0303000713801206
120EA2381C0700A4130EA3EA0C1EEA047CEA039CEA001CA25B1260EAF0301370EAE0C000
7FC7FC121A809114>I<EA01C01203A2EA0180C7FCA6121C12271247A21287A2120EA25A
A35A1380A21270EA71001232121C0A1C7E9B0E>105 D<EA0FC01201A2485AA448C7FCA4
EA0E07EB0880EB11C01323381C4780EB8300001DC7FC121EEA3FC0EA38E01370A2EA7071
A31372EAE032EA601C121D7E9C16>107 D<39381F81F0394E20C618394640E81CEB80F0
EA8F00008E13E0120EA2391C01C038A315703938038071A215E115E23970070064D83003
133820127E9124>109 D<EA3C1F384E6180384681C0EA4701128F128E120EA2381C0380
A3EB070000381310A2130E1420387006403830038014127E9119>I<13F8EA030CEA0E06
487E1218123000701380A238E00700A3130EA25BEA60185BEA30E0EA0F8011127E9114>
I<380787803809C8603808D03013E0EA11C014381201A238038070A31460380700E014C0
EB0180EB8300EA0E86137890C7FCA25AA4123CB4FC151A819115>I<EA3C3CEA4E42EA46
87EA470FEA8E1E130CEA0E00A25AA45AA45A123010127E9113>114
D<EA01F0EA060CEA0C04130EEA180CEA1C00121FEA0FE013F0EA03F8EA0038EA201CEA70
1812F01310EA8030EA6060EA1F800F127E9113>I<13C01201A3EA0380A4EAFFF0EA0700
A3120EA45AA4EA3820A21340A2EA1880EA0F000C1A80990F>I<EA1C03EA270712471303
EA8701A2120EA2EA1C02A3130412181308A2EA1C10EA0C20EA07C010127E9114>118
D<001CEBC080392701C1C0124714C03987038040A2120EA2391C070080A3EC0100EA1806
A2381C0E02EB0F04380E13083803E1F01A127E911E>I<380787803808C8403810F0C038
20F1E0EBE3C03840E1803800E000A2485AA43863808012F3EB810012E5EA84C6EA787813
127E9118>I<001C13C0EA27011247A238870380A2120EA2381C0700A4EA180EA3EA1C1E
EA0C3CEA07DCEA001C1318EA6038EAF0305B485AEA4180003EC7FC121A7E9114>I<EA03
81EA07C1EA0FF6EA081CEA1008EA0010132013401380EA010012025AEA08041210EA3C18
EA67F8EA43F0EA81E010127E9113>I E /FG 74 124 df<90383FE3F83901F03F1C3903
C03E3E0007137CEA0F80151C1500A5B612C0A2390F807C00AE397FE1FF80A21F1D809C1C
>11 D<EB3FC03801F0303803C0380007137CEA0F80A2143891C7FCA4B512FCA2380F807C
AE397FE1FF80A2191D809C1B>I<EB3FFC3801F07CEA03C01207EA0F80A7B512FCA2380F
807CAE397FF3FF80A2191D809C1B>I<90383FC1FE3A01F03F81803A03C03E01C0000790
387E03E0380F807CA2ED01C092C7FCA4B712E0A2390F807C03AE3A7FE1FF0FFCA2261D80
9C28>I<EA781EEAFC3FA200FE1380A2EA7A1EEA0200A238040100A2EA0802A2EA300CEA
4010110E7E9C19>34 D<133C13E3EA01C100037F1381120701C1C7FC13C313C213C413C8
3903F001FF13E0EC00306C6C13606D13C012023904FC0180390C7E0300121838383F0638
781F8C38F80FD8EB07F0D8FC031306387C01F8397E0F7E1C393FFE3FF83907F007F0201D
7E9C25>38 D<127812FCA212FEA2127A1202A21204A21208A212101260070E7D9C0D>I<
13201340EA0180120313001206120E5AA2123C1238A21278A312F85AA97E1278A31238A2
123C121CA27E12067E13801201EA004013200B297C9E13>I<7E12401230123812187E12
0E7EA213801203A213C0A313E01201A9120313C0A31380A212071300A2120E120C5A1238
123012405A0B297D9E13>I<127012F812FCA3127C1204A21208A3121012201240060E7D
850D>44 D<EAFFF8A40D04808A10>I<127812FCA4127806067D850D>I<EA03F8EA0F1EEA
1C07003C1380EA3803007813C0A300F813E0AC007813C0A200381380EA3C07001C1300EA
0F1EEA03F8131B7E9A18>48 D<1360EA01E0120F12FF12F31203B3A2387FFF80A2111B7D
9A18>I<EA07F8EA1FFE38383F8038780FC0EAFC0714E01303A21278EA000714C0A2EB0F
80EB1F00131E13385B5B38018060EA03001206000813E0381FFFC05A5AB5FCA2131B7E9A
18>I<EA07F8EA1FFEEA3C1FEB0F80387C07C0127E127C123838000F80A2EB1E005BEA03
F8EA001EEB0F80EB07C0A214E01230127812FCA214C038780F80EB1F00EA1FFEEA07F813
1B7E9A18>I<EB018013031307130F131F133F136F13CF138F1201EA030F1206120C1218
1230126012C0B512F8A238000F80A6EBFFF8A2151B7F9A18>I<38380180383FFF005B5B
5B13C00030C7FCA4EA31F8EA361E38380F80EA3007000013C014E0A3127812F8A214C012
F038600F8038381F00EA1FFEEA07F0131B7E9A18>I<137EEA03FF38078180380F03C0EA
1E07123C387C03800078C7FCA212F813F8EAFB0E38FA0780EAFC0314C000F813E0A41278
A214C0123CEB0780381E0F00EA07FEEA03F8131B7E9A18>I<1260387FFFE0A214C01480
A238E00300EAC0065B5BC65AA25B13E0A212015B1203A41207A66C5A131C7D9B18>I<EA
03F8EA0FFE381E0F80EA3807EB03C01278127C127E387F8380383FC70013FE6C5A6C7E6C
7E001D138038387FC038781FE0EA700FEAF0031301A3007813C0EB0380EA3E07381FFE00
EA03F8131B7E9A18>I<EA03F8EA0FFEEA1E0F383C07801278EB03C012F8A214E0A4EA78
071238EA3C0BEA0E1BEA03E3EA000314C0A2EA3807007C13801400EA780FEA383CEA1FF8
EA0FE0131B7E9A18>I<127812FCA412781200A6127812FCA4127806127D910D>I<EA0FF0
EA303CEA601EEAF01F12F8A21270EA003E133C137013E0EA01C01380A2EA0300A5C7FCA4
EA0780EA0FC0A4EA0780101D7D9C17>63 D<EB0380A2497EA3497EA2497E131BEB3BF813
31A2EB60FCA2EBE0FEEBC07EA248487E90B5FC481480EB001F4814C00006130FA248EB07
E0A239FF803FFEA21F1C7E9B24>65 D<B512F814FF390FC01F80EC0FC0140715E0A515C0
EC0F80EC3F00EBFFFE9038C00F80EC07C0EC03E0A215F0A5EC07E0A2EC1FC0B6120014FC
1C1C7E9B22>I<90381FE0209038FFF8E03803F80F3807C003380F800148C7FC123E1560
127E127C00FC1400A8007C1460127E123E15C07E390F8001803907C003003803F80E3800
FFFCEB1FE01B1C7D9B22>I<B512F814FF390FC01FC0EC07E0EC01F015F8140015FC157C
A2157EA8157CA315F8A2EC01F0EC07E0EC1FC0B6120014F81F1C7E9B25>I<B6FCA2380F
C01F1407801580A214C1A39038C1C00013C313FFA213C313C113C01560A2EC00E015C0A2
1401A21403EC0F80B6FCA21B1C7E9B1F>I<B6FCA2380FC01F1407801580A2140114C1A2
ECC00013C113C313FFA213C313C113C0A391C7FCA6EAFFFEA2191C7E9B1E>I<90380FF0
0890387FFE383901FC07F83807E001390F80007848C7FC481438123E007E1418127C00FC
1400A6EC7FFFA2007CEB01F8127E123E123F7EEA0F80EA07E03801FC0739007FFE789038
0FF818201C7D9B26>I<39FFFC3FFFA2390FC003F0AA90B5FCA2EBC003AC39FFFC3FFFA2
201C7E9B25>I<EAFFFCA2EA0FC0B3A6EAFFFCA20E1C7E9B12>I<3807FFF0A238001F80B2
1230127812FCA21400EA783EEA387CEA0FF0141C7F9B19>I<EAFFFEA2EA0FC0AF1403A3
1407A21406140E141E147EB512FEA2181C7E9B1D>76 D<D8FFC0EB03FF6D5B000F15F0D8
0DF0130DA3D80CF81319A2017C1331A26D1361A26D13C1A390380F8181A2903807C301A2
EB03E6A2EB01FCA3EB00F8A23AFFC0701FFFA2281C7E9B2D>I<39FFE003FFA2390FF000
307FEA0DFCEA0CFE137E7FEB1F8014C0EB0FE0EB07F01303EB01F814FCEB00FE147F143F
EC1FB015F0140F1407140314011400A2D8FFC013701530201C7E9B25>I<EB3FE03801F0
7C3803C01E390F800F80391F0007C0001E1303003E14E0007E14F0007C1301A200FC14F8
A8007C14F0007E1303A2003E14E0003F13076C14C0390F800F803903C01E003801F07C38
003FE01D1C7D9B24>I<B512F814FE390FC03F80140FEC07C015E0A515C0A2EC0F80EC3F
00EBFFFC01C0C7FCABEAFFFCA21B1C7E9B21>I<EB3FE03801F07C3803C01E390F800F80
391F0007C0A2003EEB03E0007E14F0007C1301A200FC14F8A8007C14F0A2007E1303003E
14E01307391F08C7C0390F906F803903D03E003801F87C39003FF808EB0018EC1C18EC1F
F8A2EC0FF0A2EC07E0EC03C01D247D9B24>I<B512F014FE380FC03FEC0F806E7E81A55D
4A5A023EC7FCEBFFF0EBC07C80143F6E7EA6ED8180A2EC0FC13AFFFC07C300EC01FE211C
7E9B24>I<3807F820381FFEE0EA3C07EA7801EA700012F01460A26C130012FEEAFFE0EA
7FFE6C7E1480000F13C06C13E0EA007FEB03F01301130012C0A214E07E38F001C0EAFC03
38EFFF00EA83FC141C7D9B1B>I<007FB512E0A238781F81007013800060146000E01470
00C01430A400001400B03807FFFEA21C1C7E9B21>I<39FFFC03FFA2390FC00030B31207
15606C6C13E03901F001C03900FC078090387FFE00EB0FF8201C7E9B25>I<3AFFFC01FF
80A23A0FC00018006D1338000714306D1370000314607F00015CA26C6C485AA2EBFE0301
7E90C7FCEB7F07EB3F061486EB1F8CA2EB0FD8A214F86D5AA26D5AA26D5AA2211C7F9B24
>I<3BFFF87FFE0FFCA23B0FC007E000C081D9E003130100071680EC07F801F014030003
D90FFC1300140CD801F81406EC1CFE9039FC187E0E0000150CEC303F01FE141CD97E7013
98EC601F013F14B002E013F0ECC00F011F5CEC8007A2010F5CEC00036D5CA22E1C7F9B31
>I<EA0401EA1806EA2008A2485AA2485AA2EABC2F38FE3F80A2EA7E1FA2383C0F00110E
7B9C19>92 D<EA0FF8EA1C1E383E0F80130714C0121C1200137FEA07E7EA1F07123C127C
12F8A3EA780B383E13F8EA0FE115127F9117>97 D<B4FCA2121FA9EB3F80EBE1E0EB8070
EB0078143CA2143EA6143CA21478EB8070381EC1E0381C3F00171D7F9C1B>I<EA03FCEA
0E0EEA1C1F123C1278130E00F8C7FCA61278EB0180123C381C0300EA0E0EEA03F811127E
9115>I<EB0FF0A21301A9EA01F9EA0F07EA1C03EA3C011278A212F8A61278A2123CEA1C
03380F0FFEEA03F9171D7E9C1B>I<EA03FCEA0F07381C0380383C01C0127814E012F8A2
B5FC00F8C7FCA3127814607E6C13C0380F03803801FC0013127F9116>I<137F3801E380
3803C7C0EA0787120FEB8380EB8000A5EAFFF8A2EA0F80AEEA7FF0A2121D809C0F>I<38
03F0F0380E1F38EA3C0F3838073000781380A400381300EA3C0FEA1E1CEA33F00030C7FC
A3EA3FFF14C06C13E014F0387801F838F00078A300701370007813F0381E03C03807FF00
151B7F9118>I<B4FCA2121FA9EB0FC0EB31E0EB40F0EB80F8A21300AB38FFE7FFA2181D
7F9C1B>I<121E123FA4121EC7FCA6127FA2121FAEEAFFC0A20A1E7F9D0E>I<137813FCA4
13781300A6EA03FCA2EA007CB2127012F8137813F0EA70E0EA1F800E26839D0F>I<B4FC
A2121FA9EB03FCA2EB01C0EB0300130E5B5B137813FC13BE131F7F1480EB07C0EB03E013
0138FFE7FEA2171D7F9C19>I<B4FCA2121FB3A7EAFFE0A20B1D7F9C0E>I<39FF0FC07E90
3831E18F3A1F40F20780D980FC13C0A2EB00F8AB3AFFE7FF3FF8A225127F9128>I<38FF
0FC0EB31E0381F40F0EB80F8A21300AB38FFE7FFA218127F911B>I<EA01FC380F078038
1C01C0003C13E0387800F0A200F813F8A6007813F0A2383C01E0381E03C0380F07803801
FC0015127F9118>I<38FF3F80EBE1E0381F80F0EB0078147C143C143EA6143C147C1478
EB80F0EBC1E0EB3F0090C7FCA6EAFFE0A2171A7F911B>I<3803F060380F0CE0EA1E07EA
3C03127C127812F8A61278127C123CEA1C07EA0E0FEA03F3EA0003A6EB1FFCA2161A7E91
19>I<EAFE3E1347381E8F80A3381F070090C7FCAAEAFFE0A211127F9114>I<EA1FD8EA30
78EA601812E0A2EAF000EAFF80EA7FE013F0EA1FF8EA07FCEA007CEAC01CA212E01318EA
F830EACFC00E127E9113>I<1203A45AA25AA2EA3FFC12FFEA1F00A9130CA4EA0F08EA07
98EA03F00E1A7F9913>I<38FF07F8A2EA1F00AC1301120F380786FFEA01F818127F911B>
I<38FFC1FCA2381F00601380000F13C0A23807C180A23803E300A213F7EA01F613FE6C5A
A21378A2133016127F9119>I<39FF8FF8FEA2391F03E030A3390F87F06013869038C6F8
E03907CC78C0A23903FC7D80EBF83D143F3901F01F00A20000131EEBE00EA21F127F9122
>I<38FFC7FCA2381F81C0380F83803807C700EA03EEEA01FC5B1200137C13FEEA01DF38
039F80EA070F380607C0380C03E038FF07FCA216127F9119>I<38FFC1FCA2381F006013
80000F13C0A23807C180A23803E300A213F7EA01F613FE6C5AA21378A21330A25B1270EA
F8E05BEAF9800073C7FC123E161A7F9119>I<387FFF8038781F00EA703FEA603E5B13FC
5BEA01F01203485AEBC180EA0F81121F1303003E1300EA7E07EA7C0FB5FC11127F9115>
I<B512FE1701808B18>I E /FH 79 125 df<903801F03C9038071C47010C13C7EC19C6
90381C0180140313181338A2EC0700A20003B512F03900700700A3140EA213E0A35CA2EA
01C0A35CA2EA0380A21430EB0070A248136038C630E038E638C038CC3180D8781EC7FC20
25819C19>11 D<14FE90380301801306EB0C03EB1C0191C7FC13181338A43803FFFE3800
700EA35CA213E0A25CA3EA01C01472A438038034141891C7FC90C8FCA25A12C612E65A12
781925819C17>I<903801FEE0EB0707130E010C13C0EB1C01A213189038380380A40003
B5120038007007A3140EA213E0A25CA3EA01C01439A43803801A140C91C7FC90C8FCA25A
12C612E65A12781B25819C18>I<13C0EA01E0A313C01203A21380A313005AA21206A312
04120CA21208A2C7FCA5123012785A12600B1E7C9D0D>33 D<EA1830EA3C78A2EA3870EA
0810A2EA1020A2EA2040A2EA4080EA81000D0C799C15>I<133C0163133001C113703801
8080000314201301D807031340EC0080390E00010014025CEBE01A380F1021000E1341EC
8080EA1A203839C10038300160387000E0A248EB0100A31402A200605B00705B00305B6C
1360380E0380D801FCC7FC1C1F7B9D20>38 D<1218123CA31204A21208A2121012201240
1280060C779C0D>I<13031306130813181330136013C0A2EA0180EA0300A21206A25AA2
121C1218A212381230A21270A21260A412E0A51260A51220123012107EA2102A7B9E11>
I<1310A21308130C13041306A51307A51306A4130EA2130CA2131C1318A213381330A213
60A213C0A2EA0180EA0300A212065A5A121012605A102A809E11>I<1218123812781238
1208A21210A212201240A21280050C7D830D>44 D<EAFFC0A30A037D890F>I<12301278
12F0126005047C830D>I<133EEBE180380181C0EA03005A1206000E13E0120C001C13C0
A2EA18011238A338700380A43860070012E01306130EA2130C5BEA60385BEA30C0001FC7
FC131D7C9B15>48 D<1304130C131813381378EA07B8EA0070A413E0A4EA01C0A4EA0380
A4EA0700A45AEAFFF00E1C7B9B15>I<133EEB4180EB80C0EA0100000213E0EA0440A212
08A3381081C0A238110380000E1300EA00065B5B136013800003C7FC1204481340481380
5AEB0100EA7F07EA43FEEA81FCEA8078131D7D9B15>I<131FEB60C01380380100601202
1340000413E0A3EB81C0EA030138000380EB070013FC131C1306A21307A41270EAE00E12
805BEA40185BEA20E0EA1F80131D7D9B15>I<EB018014C0EB0380A314005BA21306130E
130C131C1318A25BA25B134013C6EA018E130E1202EA061C120C1218123FEA40F838803F
8038003800A25BA45B136012247E9B15>I<EB80603801FFC01480EBFE0090C7FC1202A4
5A13F8EA050CEA0606120C1208120013071306130EA21270130CEAE01CEA80181338EA40
305BEA21C0001FC7FC131D7C9B15>I<EB0F80EB3860EB6020EBC0E0EA018048C7FC1206
120E120C121C13F8EA3904EA3A06EA3C031278A2007013801400EA600712E0A21306130E
130CEA601C1318EA2030EA30C0EA0F80131D7C9B15>I<3809C040380FE080EA1FE1381C
6100EA3026EA201AEA6004EA400CEA80081318485AA25BA25BA212015B120390C7FC5AA3
120EA35AA21218121D799B15>I<131FEB60C0EBC060EA018038030030A2000613601207
14C013803803C10013E6EA01FCEA0078EA01BCEA061E487E487E383003801220EA6001A2
38C00300A21306EA60045BEA3830EA0FC0141D7D9B15>I<133E13E138018180380300C0
1206120E120C121CA213011238A31303001813801307EA080B380C3300EA03C7EA000713
0E130C131C1318EAE0305BEA80C0EAC180003EC7FC121D7C9B15>I<1206120FA2120612
00AA1230127812F0126008127C910D>I<1203EA0780A2EA0300C7FCAA12181238127812
381208A25AA25A5AA25A091A7D910D>I<EA01E0EA0618EA0808EA100CA212201240131C
EA8018EAE03813F0EAC1E0EA03C0EA0780EA0F00121C5AEA3080A2EA3100121EC7FCA512
3012785A12600E1E789D15>63 D<1418A21438A21478A214B8EB0138A2EB023C141C1304
130C13081310A21320A2EB7FFCEBC01C1380EA0100141E0002130EA25A120C001C131EB4
EBFFC01A1D7E9C1F>65 D<48B5FC39003C038090383801C0EC00E0A35B1401A2EC03C001
E01380EC0F00141EEBFFFC3801C00E801580A2EA0380A43907000F00140E141E5C000E13
F0B512C01B1C7E9B1D>I<903803F02090381E0C6090383002E09038E003C03801C001EA
038048C7FC000E1480121E121C123C15005AA35AA41404A35C12705C6C5B00185B6C485A
D80706C7FCEA01F81B1E7A9C1E>I<48B5FC39003C03C090383800E0A21570A249137815
38A215785BA4484813F0A315E03803800115C0140315803907000700140E5C5C000E13E0
B512801D1C7E9B1F>I<48B512F038003C00013813301520A35BA214081500495AA21430
EBFFF03801C020A439038040801400A2EC0100EA07005C14021406000E133CB512FC1C1C
7E9B1C>I<48B512F038003C00013813301520A35BA214081500495AA21430EBFFF03801
C020A448485A91C7FCA348C8FCA45AEAFFF01C1C7E9B1B>I<903803F02090381E0C6090
383002E09038E003C03801C001EA038048C7FC000E1480121E121C123C15005AA35AA290
3801FF809038001E00141CA400705BA27E001813786C139038070710D801F8C7FC1B1E7A
9C20>I<3A01FFC3FF803A003C00780001381370A4495BA449485AA390B5FC3901C00380
A4484848C7FCA43807000EA448131E39FFE1FFC0211C7E9B1F>I<EA03FFEA00781370A4
13E0A4EA01C0A4EA0380A4EA0700A4120EA4121EEAFFC0101C7D9B10>I<EB3FF8EB03C0
1480A4EB0700A4130EA45BA45BA4EA607012E0EAC060EA80E0EA81C0EA4380003EC7FC15
1D7C9B16>I<3801FFC038003C001338A45BA45BA4485AA438038002A31404EA0700140C
14181438000E13F0B5FC171C7E9B1A>76 D<D801FEEB01FED8003E14E0012EEB03C01505
A21509014EEB0B801513152313470187EB4700A21587EC0107D80107130E14021404A200
02495AEB0388149014A000045C14C0A2000C1380001CEB007839FF8307FF271C7E9B25>
I<D801FCEBFF80D8001CEB1C00012E13181510A2132701475B13431480A2903881C040A3
EB80E0D801005B1470A300020139C7FCA3141D48131E140EA2120C001C1304EAFF80211C
7E9B1F>I<EB07F0EB1C1CEB700E497E3901C00380EA0380EA0700000E14C0121E121C12
3CA25AA348EB0780A3EC0F00A2140E141E5C007013385C00785B383801C06C485AD80E0E
C7FCEA03F81A1E7A9C20>I<3801FFFE39003C038090383801C0EC00E0A3EB7001A315C0
EBE0031580EC0700141C3801FFF001C0C7FCA3485AA448C8FCA45AEAFFE01B1C7E9B1C>
I<EB07F0EB1C1CEB700E497ED801C0138038038003EA0700000E14C0121E121C123CA25A
A348EB0780A3EC0F00A2140E141E141C38707838EB8070387104E0383905C0381D078038
0F0E04EA03FC3800040CEB0608EB0E18EB0FF013075CEB03801A257A9C20>I<3801FFFE
39003C078090383801C015E01400A2EB7001A3EC03C001E01380EC0700141CEBFFE03801
C03080141CA2EA0380A43807003C1520A348144039FFE01E80C7EA0F001B1D7E9B1E>I<
EB0F84EB304CEB403CEB8018EA01005AA200061310A214001207A2EA03E013FC6CB4FC38
007F80EB07C01301A21300A21220A238600180A2EB03001302EAF004EACC18EA83E0161E
7D9C17>I<001FB512C0381C070138300E0000201480126012405B1280A2000014005BA4
5BA45BA4485AA41203EA7FFE1A1C799B1E>I<397FF03FE0390F000700000E13061404A3
485BA4485BA4485BA4485BA35CA249C7FCEA60025B6C5AEA1830EA07C01B1D789B1F>I<
39FF801FC0393C000700001C1304A25C5CA25CA25C5CA26C48C7FCA213025BA25BA25B5B
120F6C5AA25B90C8FCA21206A21A1D779B1F>I<3AFF83FF07F03A3C007001C000381580
02F01300A290380170025D13025D13045D13085D131001305B1320D81C405BA2D98071C7
FCA2381D0072A2001E1374A2001C1338A20018133014201210241D779B29>I<3901FF81
FE39003E0078011C136015C0011E138090380E0100EB0F026D5A5C1490EB03A014E06D5A
A28013021304497EEB10701320EB603813C0EB803C3801001C12020006131E121EB4EB7F
C01F1C7E9B1F>I<EB3F80EB7F001360A35BA4485AA448C7FCA41206A45AA45AA45AA45A
A45AA212FEA211297E9E0D>91 D<EA0408EA0810EA1020EA2040A2EA4080A2EA8100EAE1
C0EAF1E0A2EAE1C00D0C749C15>I<EB3F80EB7F001303A31306A45BA45BA45BA45BA45B
A4485AA448C7FCA41206A212FEA21129819E0D>I<1204120812101220A21240A2128012
E012F0A212E0060C779C0D>96 D<EA01E3EA0717EA0C0F1218EA380E12301270A2EAE01C
A41339A3EA6079EA319AEA1E0C10127C9115>I<123F1207A2120EA45AA4EA39E0EA3A18
EA3C0C12381270130EA3EAE01CA31318133813301360EA60C0EA3180EA1E000F1D7C9C13
>I<13F8EA0304120EEA1C0EEA181CEA30001270A25AA51304EA60081310EA3060EA0F80
0F127C9113>I<EB07E01300A2EB01C0A4EB0380A43801E700EA0717EA0C0F1218EA380E
12301270A2485AA41339A3EA6079EA319AEA1E0C131D7C9C15>I<13F8EA0704120CEA18
02EA38041230EA7008EA7FF0EAE000A5EA60041308EA30101360EA0F800F127C9113>I<
EB03C0EB0670130CEB1C601400A25BA53803FF8038007000A55BA5485AA5485AA390C7FC
A25A12C612E65A12781425819C0D>I<EB78C0EA01C5EA03031206000E1380120C121CA2
38380700A4130EA3EA181EEA0C7CEA079CEA001CA25BA2EAC030EAE070EAC1C0007FC7FC
121A7E9113>I<EA0FC01201A2485AA448C7FCA4EA0E3E13C3380F0380120E121E121CA3
38380700A3130E00701340A2131C1480EAE00C38600700121D7E9C15>I<EA01801203EA
0100C7FCA7121C12261247A2128EA2120E5AA35AA21271A31272A2123C091C7C9B0D>I<
1303130713031300A71378138CEA010C1202131C12041200A21338A41370A413E0A4EA01
C0A2EAC180EAE30012C612781024819B0D>I<EA0FC01201A2485AA448C7FCA4380E0780
1308EB11C01321381C4180EB8000001DC7FC121EEA3FC0EA38E01370A2EA7071A31372EA
E032EA601C121D7E9C13>I<EA1F801203A2EA0700A4120EA45AA45AA45AA412E2A312E4
12641238091D7D9C0B>I<391C1E078039266318C0394683A0E0384703C0008E1380A212
0EA2391C0701C0A3EC0380D8380E1388A2EC0708151039701C032039300C01C01D127C91
22>I<EA383EEA4CC3384D0380124E129E129C121CA238380700A3130E00701340A2131C
1480EAE00C3860070012127C9117>I<13F8EA030CEA0E06487E1218123000701380A238
E00700A3130EA25BEA60185BEA30E0EA0F8011127C9115>I<380387803804C860EBD030
13E0EA09C014381201A238038070A31460380700E014C0EB0180EB8300EA0E86137890C7
FCA25AA45AB4FC151A809115>I<EA01E1EA0713EA0C0F1218EA380E12301270A2EAE01C
A41338A3EA6078EA31F0EA1E701200A213E0A4EA01C0EA0FF8101A7C9113>I<EA1C3CEA
2642EA4687EA4707EA8E061300120EA25AA45AA45A123010127C9112>I<EA01F0EA0608
120C131CEA1818EA1C00121F13C0EA0FF01207EA00781338EA603012E012C0EA8060EA60
C0EA1F000E127D9111>I<12035AA3120EA4EAFFE0EA1C00A35AA45AA4EAE080A2EAE100
A2126612380B1A7C990E>I<381C0180EA2E03124EA2388E0700A2121CA2EA380EA43830
1C80A3EA383C38184D00EA0F8611127C9116>I<EA1C06EA2E0EEA4E06A2EA8E02A2121C
A2EA3804A313081230A21310EA3820EA1840EA0F800F127C9113>I<381E018338270387
1247148338870701A2120EA2381C0E02A31404EA180C131C1408EA1C1E380C26303807C3
C018127C911C>I<38038780380CC840380870E012103820E0C014001200A2485AA4EA03
811263EAE38212C5EA8584EA787813127E9113>I<381C0180EA2E03124EA2388E0700A2
121CA2EA380EA4EA301CA3EA383CEA1878EA0FB8EA003813301370EAE0605BEA81800043
C7FC123C111A7C9114>I<EA01C1EA07E1EA0FF6EA081CEA1008EA0010132013401380EA
010012025AEA08041210EA2C0CEA73F8EA41F0EA80E010127E9111>I<B712F825017B8B
2A>124 D E /FI 93 128 df<EB7E1F3901C1B180390303E3C0000713C3000EEBC18090
3801C000A6B512FC380E01C0B0387F87FC1A1D809C18>11 D<137E3801C180EA03013807
03C0120EEB018090C7FCA5B512C0EA0E01B0387F87F8151D809C17>I<EB7FC0EA01C1EA
03031207EA0E01A7B5FCEA0E01B0387FCFF8151D809C17>I<90383F07E03901C09C1838
0380F0D80701133C000E13E00100131892C7FCA5B612FC390E00E01CB03A7FC7FCFF8021
1D809C23>I<90383F07FC3901C0DC1C390381F03CEA0701000EEBE01C1300A6B612FC39
0E00E01CB03A7FC7FCFF80211D809C23>I<123C12421281A31242123C0807759D1F>23
D<381FC07C3830718339783B0180131E0030EB00C0EA001CA248B5FCD80F1CC7FC123812
70126012E0011E1340A2D860331380393061C300381F807C1A127E911E>26
D<1480EB01005B1302EA03F4EA0E1CEA180EEA300B38701380EA603138E021C01341A213
81A2EAE10100631380EA720300341300EA1C06EA0E1CEA0BF00010C7FC123012205A121A
7F9515>28 D<126012F0A71260AD1200A5126012F0A21260041E7C9D0C>33
D<EA6060EAF0F0EAF8F8EA6868EA0808A3EA1010A2EA2020EA4040EA80800D0C7F9C15>
I<9038030180A39038060300A5EB0C06A4495A007FB512F8B612FC3900301800A4495AA4
B612FC6C14F83900C0600048485AA438030180A4D80603C7FCA31E257E9C23>I<13E0EA
0310EA0608A2120EA45BA25B6C5AEC3FE09038800F80EC06000003130412073809C00800
115BEA30E03820F020EA607038E03840EB3C80131C90380F00207F0070EB8040383009C0
391830E180390FC03F001B1F7E9D20>38 D<126012F012F812681208A31210A212201240
1280050C7C9C0C>I<1380EA0100120212065AA25AA25AA35AA412E0AC1260A47EA37EA2
7EA27E12027EEA0080092A7C9E10>I<7E12407E12307EA27EA27EA37EA41380AC1300A4
1206A35AA25AA25A12205A5A092A7E9E10>I<1306ADB612E0A2D80006C7FCAD1B1C7E97
20>43 D<126012F0A212701210A41220A212401280040C7C830C>I<EAFFE0A20B028089
0E>I<126012F0A2126004047C830C>I<130113031306A3130CA31318A31330A31360A213
C0A3EA0180A3EA0300A31206A25AA35AA35AA35AA35AA210297E9E15>I<EA03C0EA0C30
EA1818EA300CA2EA700EEA6006A2EAE007ADEA6006A2EA700EEA300CA2EA1818EA0C30EA
07E0101D7E9B15>I<5A1207123F12C71207B3A5EAFFF80D1C7C9B15>I<EA07C0EA1830EA
201CEA400C130EEAF00F12F81307A21270EA000F130EA2131CA213381370136013C0EA01
80EA0300EA0601120C1218EA1002EA3FFE127F12FF101C7E9B15>I<EA07E0EA1830EA20
1CA2EA781E130E131E1238EA001CA2131813301360EA07C0EA0030131CA2130E130FA212
7012F8A3EAF00EEA401C1220EA1830EA07C0101D7E9B15>I<130CA2131C133CA2135C13
DC139CEA011C120312021204120C1208121012301220124012C0B512C038001C00A73801
FFC0121C7F9B15>I<EA300CEA3FF813F013C0EA2000A6EA23E0EA2C30EA3018131CEA20
0E1200130FA3126012F0A3EA800EEA401E131CEA2038EA1870EA07C0101D7E9B15>I<13
F0EA030CEA0404EA0C0EEA181E1230130CEA7000A21260EAE3E0EAE430EAE818EAF00C13
0EEAE0061307A51260A2EA7006EA300E130CEA1818EA0C30EA03E0101D7E9B15>I<1240
387FFF801400A2EA4002485AA25B485AA25B1360134013C0A212015BA21203A41207A66C
C7FC111D7E9B15>I<EA03E0EA0C30EA1008EA200C13061260A21270A2EA7C0CEA3E18EA
3FB0EA1FE0EA07F013F8EA18FCEA307EEA601E130FEAC0071303A4EA60021304EA300CEA
1C10EA07E0101D7E9B15>I<EA03C0EA0C30EA1818EA300C1270EA600EEAE006A21307A5
1260EA700F1230EA1817EA0C27EA07C7EA0006A2130EEA300C127813181270EA2030EA10
C0EA0F80101D7E9B15>I<126012F0A212601200AA126012F0A2126004127C910C>I<1260
12F0A212601200AA126012F0A212701210A41220A212401280041A7C910C>I<007FB512
C0B612E0C9FCA8B612E06C14C01B0C7E8F20>61 D<EA0FE0EA3038EA401CEAE00E12F0A3
EA000C131C1330136013C0138012011300A6C7FCA51203EA0780A2EA03000F1D7E9C14>
63 D<1306A3130FA3EB1780A2EB37C01323A2EB43E01341A2EB80F0A338010078A2EBFF
F83802003CA3487FA2000C131F80001E5BB4EBFFF01C1D7F9C1F>65
D<B512C0380F00788080140E140FA4140E141E5C14F8EBFFF0EB003C8080801580A5EC0F
00A2141E1478B512E0191C7F9B1D>I<90381F8080EBE0613801801938070007000E1303
5A14015A00781300A2127000F01400A8007014801278A212386CEB0100A26C13026C5B38
0180083800E030EB1FC0191E7E9C1E>I<B512C0380F00F0143C140E80A2EC038015C014
01A215E0A815C0A21403158014071500140E5C1470B512C01B1C7E9B20>I<B512FC380F
003C140C1404A214061402A213011400A35B13FF13037FA3140113001402A31406A2140C
143CB512FC181C7E9B1C>I<B512F8380F007814181408A2140C1404A213011400A35B13
FF13037FA490C7FCA8EAFFF8161C7E9B1B>I<90381F8080EBE061380180193807000700
0E13035A14015A00781300A2127000F01400A6ECFFF0EC0F80007013071278A212387EA2
7E6C130B380180113800E06090381F80001C1E7E9C21>I<39FFF0FFF0390F000F00AC90
B5FCEB000FAD39FFF0FFF01C1C7F9B1F>I<EAFFF0EA0F00B3A8EAFFF00C1C7F9B0F>I<38
07FF8038007C00133CB3127012F8A21338EA7078EA4070EA30E0EA0F80111D7F9B15>I<
39FFF01FE0390F000780EC060014045C5C5C5C5C49C7FC13021306130FEB17801327EB43
C0EB81E013016D7E1478A280143E141E80158015C039FFF03FF01C1C7F9B20>I<EAFFF8
EA0F8090C7FCB01408A31418A2141014301470EB01F0B5FC151C7E9B1A>I<B46CEBFF80
000FECF800A2390BC00178A33809E002A23808F004A3EB7808A3EB3C10A3EB1E20A3EB0F
40A2EB0780A3EB0300121C3AFF8307FF80211C7E9B26>I<B4EB1FF0390F8003809038C0
0100120BEA09E0EA08F0A21378133C133E131E130F14811307EB03C1EB01E114F1130014
79147D143D141FA2808080121CB46C7E1C1C7F9B1F>I<EB3F80EBE0E03803803848487E
000E7F487F003C148000381303007814C0A20070130100F014E0A8007014C000781303A2
00381480003C1307001C14006C130E6C5B6C6C5A3800E0E0EB3F801B1E7E9C20>I<B512
80380F00E01478143C141C141EA5141C143C147814E0EBFF8090C7FCACEAFFF0171C7E9B
1C>I<EB3F80EBE0E03803803848487E000E7F487F003C148000381303007814C0A20070
130100F014E0A8007014C000781303A200381480383C0E07D81C111300380E208E000713
5C3803A0783900F0E020133FEB0060EC3060EC38E0EC3FC0A2EC1F80EC0F001B257E9C20
>I<B5FC380F01E0EB007880141C141EA4141C143C5CEB01E001FFC7FCEB01E0EB007014
7880A61510A2141CA239FFF00E20C7EA03C01C1D7E9B1F>I<3807E080EA1C19EA300513
03EA600112E01300A36C13007E127CEA7FC0EA3FF8EA1FFEEA07FFC61380130FEB07C013
0313011280A300C01380A238E00300EAD002EACC0CEA83F8121E7E9C17>I<007FB512C0
38700F010060130000401440A200C014201280A300001400B1497E3803FFFC1B1C7F9B1E
>I<39FFF01FF0390F000380EC0100B3A26C1302138000035BEA01C03800E018EB7060EB
0F801C1D7F9B1F>I<39FFE00FF0391F0003C0EC01806C1400A238078002A213C000035B
A2EBE00C00011308A26C6C5AA213F8EB7820A26D5AA36D5AA2131F6DC7FCA21306A31C1D
7F9B1F>I<3AFFE1FFC0FF3A1F003E003C001E013C13186C6D1310A32607801F1320A33A
03C0278040A33A01E043C080A33A00F081E100A39038F900F3017913F2A2017E137E013E
137CA2013C133C011C1338A20118131801081310281D7F9B2B>I<39FFF07FC0390FC01E
003807800CEBC00800035B6C6C5A13F000005BEB7880137C013DC7FC133E7F7F80A2EB13
C0EB23E01321EB40F0497E14783801007C00027F141E0006131F001F148039FF807FF01C
1C7F9B1F>I<39FFF003FC390F8001E00007EB00C06D13800003EB01006D5A000113026C
6C5A13F8EB7808EB7C18EB3C10EB3E20131F6D5A14C06D5AABEB7FF81E1C809B1F>I<38
7FFFF0EA7C01007013E0386003C0A238400780130F1400131E12005B137C13785BA2485A
1203EBC010EA0780A2EA0F00481330001E13205A14604813E0EAF803B5FC141C7E9B19>
I<12FEA212C0B3B312FEA207297C9E0C>I<EA0808EA1010EA2020EA4040A2EA8080A3EA
B0B0EAF8F8EA7878EA30300D0C7A9C15>I<12FEA21206B3B312FEA20729809E0C>I<1208
121012201240A21280A312B012F812781230050C7D9C0C>96 D<EA1FC0EA3070EA78387F
12301200A2EA01FCEA0F1C12381270126000E01340A3EA603C38304E80381F870012127E
9115>I<12FC121CAA137CEA1D87381E0180381C00C014E014601470A6146014E014C038
1E018038190700EA10FC141D7F9C17>I<EA03F8EA0C0CEA181E1230EA700CEA600012E0
A61260EA70021230EA1804EA0C18EA03E00F127F9112>I<EB1F801303AAEA03F3EA0E0B
EA1807EA30031270126012E0A6126012701230EA1807EA0E1B3803E3F0141D7F9C17>I<
EA07E0EA0C30EA1818EA300CEA700EEA600612E0EAFFFEEAE000A41260EA70021230EA18
04EA0C18EA03E00F127F9112>I<13F8EA018CEA071E1206EA0E0C1300A6EAFFE0EA0E00
B0EA7FE00F1D809C0D>I<EB03803807C4C0EA1C783838388038301800EA701CA4EA3018
EA38386C5AEA27C00020C7FCA21230EA3FF86CB4FC1480EA2003386001C0EAC000A33860
018038300300EA1C0EEA07F8121C7F9215>I<12FC121CAA137C1387EA1D03001E138012
1CAD38FF9FF0141D7F9C17>I<1218123CA21218C7FCA712FC121CB0EAFF80091D7F9C0C>
I<13C0EA01E0A2EA00C01300A7EA07E01200B3A21260EAF0C012F1EA6180EA3E000B2583
9C0D>I<12FC121CAAEB0FE0EB0780EB06005B13105B5B13E0121DEA1E70EA1C78133813
3C131C7F130F148038FF9FE0131D7F9C16>I<12FC121CB3A9EAFF80091D7F9C0C>I<39FC
7E07E0391C838838391D019018001EEBE01C001C13C0AD3AFF8FF8FF8021127F9124>I<
EAFC7CEA1C87EA1D03001E1380121CAD38FF9FF014127F9117>I<EA03F0EA0E1CEA1806
487E00701380EA600100E013C0A600601380EA700300301300EA1806EA0E1CEA03F01212
7F9115>I<EAFC7CEA1D87381E0180001C13C0EB00E0A21470A614E0A2EB01C0001E1380
381D0700EA1CFC90C7FCA7B47E141A7F9117>I<3803E080EA0E19EA1805EA3807EA7003
A212E0A61270A2EA38071218EA0E1BEA03E3EA0003A7EB1FF0141A7F9116>I<EAFCE0EA
1D38EA1E78A2EA1C301300ACEAFFC00D127F9110>I<EA1F90EA2070EA4030EAC010A212
E0EAF800EA7F80EA3FE0EA0FF0EA00F8EA8038131812C0A2EAE010EAD060EA8FC00D127F
9110>I<1204A4120CA2121C123CEAFFE0EA1C00A91310A5120CEA0E20EA03C00C1A7F99
10>I<38FC1F80EA1C03AD1307120CEA0E1B3803E3F014127F9117>I<38FF07E0383C0380
381C0100A2EA0E02A2EA0F06EA0704A2EA0388A213C8EA01D0A2EA00E0A3134013127F91
16>I<39FF3FC7E0393C0703C0001CEB01801500130B000E1382A21311000713C4A21320
3803A0E8A2EBC06800011370A2EB8030000013201B127F911E>I<38FF0FE0381E0700EA
1C06EA0E046C5AEA039013B0EA01E012007F12011338EA021C1204EA0C0E487E003C1380
38FE1FF014127F9116>I<38FF07E0383C0380381C0100A2EA0E02A2EA0F06EA0704A2EA
0388A213C8EA01D0A2EA00E0A31340A25BA212F000F1C7FC12F312661238131A7F9116>
I<EA7FFCEA70381260EA407013F013E0EA41C012031380EA0700EA0F04120E121CEA3C0C
EA380812701338EAFFF80E127F9112>I<B512F01401808B15>I<B812802901808B2A>I<
EA6060EAF0F0A2EA60600C047C9C15>127 D E /FJ 1 14 df<EC7FC0903803FFF89038
0F803E90393C0007800170EB01C001C0EB006048488048C87E0006814881A24881A248ED
0180A248ED00C0A3481660AB006016C0A36CED0180A26CED0300A26C1506A26C5D6C5D6C
6C5C6C6C5C0170495A013CEB078090260F803EC7FC903803FFF89038007FC02B2F7DA332
>13 D E /FK 44 122 df<EB1FC0EB7020EBC0103801803800031378EA0700143091C7FC
A7B512F8380700781438B2397FE1FF80192380A21B>12 D<127012F812FCA212741204A4
1208A21210A212201240060F7C840E>44 D<127012F8A3127005057C840E>46
D<13801203120F12F31203B3A9EA07C0EAFFFE0F217CA018>49 D<EA03F8EA0C1EEA100F
38200780004013C0127813031307123800001380A214005B130C1338EA03F0EA001C130F
EB0780A2EB03C0A214E01220127012F8A200F013C01240EB0780122038100F00EA0C1CEA
03F013227EA018>51 D<EA01F0EA060C487EEA1807383803801270A238F001C0A314E0A5
127013031238EA1805120CEA0619EA03E1380001C0A3EB0380A21230387807001306EA70
0CEA20186C5AEA0FC013227EA018>57 D<497EA3497EA3EB05E0A2EB09F01308A2EB1078
A3497EA3497EA2EBC01F497EA248B51280EB0007A20002EB03C0A348EB01E0A348EB00F0
121C003EEB01F839FF800FFF20237EA225>65 D<B512F8380F800E0007EB0780EC03C015
E0140115F0A515E01403EC07C0EC0F80EC3E00EBFFFE9038800780EC03C0EC01E015F014
0015F8A6EC01F0A2EC03E0EC07C0000FEB0F00B512FC1D227EA123>I<903807E0109038
381830EBE0063901C0017039038000F048C7FC000E1470121E001C1430123CA2007C1410
1278A200F81400A812781510127C123CA2001C1420121E000E14407E6C6C13803901C001
003800E002EB381CEB07E01C247DA223>I<B512F0380F801E00071307EC0380EC01C0EC
00E015F01578A2157C153CA3153EA9153CA2157C1578A215F015E01401EC03C0EC070000
0F131EB512F01F227EA125>I<B612C0380F80070007130114001540A215601520A31420
1500A3146014E013FF138014601420A315081400A21510A31530A2157015E0000F1303B6
FC1D227EA121>I<903807F00890383C0C18EBE0023901C001B839038000F848C7127848
1438121E15185AA2007C14081278A200F81400A7EC1FFF0078EB00F81578127C123CA27E
A27E7E6C6C13B86C7E3900E0031890383C0C08903807F00020247DA226>71
D<EAFFFCEA0FC0EA0780B3ACEA0FC0EAFFFC0E227EA112>73 D<D8FFFCEBFF80D80FC0EB
7C006C48133015205D5D4AC7FC14025C5C5C5C5C5CEB81C0EB83E01385EB88F01390EBA0
78EBC03C13808080A26E7E8114036E7EA26E7E81486C7F3AFFFC07FF8021227EA126>75
D<39FF8007FF3907C000F81570D805E01320EA04F0A21378137C133C7F131F7FEB0780A2
EB03C0EB01E0A2EB00F014F81478143C143E141E140FA2EC07A0EC03E0A21401A2140000
0E1460121FD8FFE0132020227EA125>78 D<EB0FE0EB783CEBE00E3903C0078039078003
C0390F0001E0000E1300001E14F0481478A2007C147CA20078143CA200F8143EA9007814
3C007C147CA2003C1478003E14F8001E14F06CEB01E0A239078003C03903C007803900E0
0E00EB783CEB0FE01F247DA226>I<B512F0380F803C0007130FEC078015C0140315E0A6
15C014071580EC0F00143CEBFFF00180C7FCAE487EEAFFFC1B227EA121>I<B512E0380F
803C0007130E6E7E81140381A55D14075D020EC7FC143CEBFFE0EB80708080141E140E14
0FA481A3168015C014073A0FC003C10039FFFC01E2C8127C21237EA124>82
D<3803F020380C0C60EA1802383001E0EA70000060136012E0A21420A36C1300A2127812
7FEA3FF0EA1FFE6C7E0003138038003FC0EB07E01301EB00F0A214707EA46C1360A26C13
C07E38C8018038C60700EA81FC14247DA21B>I<007FB512F83978078078006014180040
1408A300C0140C00801404A400001400B3A3497E3801FFFE1E227EA123>I<39FFFC07FF
390FC000F86C4813701520B3A5000314407FA2000114806C7E9038600100EB3006EB1C08
EB03F020237EA125>I<3BFFF03FFC03FE3B1F8007E000F86C486C48137017206E7ED807
801540A24A7E2603C0021480A39039E004780100011600A2EC083CD800F01402A2EC101E
01785CA2EC200F013C5CA20260138890391E400790A216D090391F8003F0010F5CA2EC00
016D5CA20106130001025C2F237FA132>87 D<EA1FE0EA3038EA780C130EEA30071200A3
13FFEA07C7EA1E07123C1278127000F01308A3130FEA7817383C2390380FC1E015157E94
18>97 D<120E12FE121E120EAB131FEB61C0EB8060380F0030000E1338143C141C141EA7
141C143C1438000F1370380C8060EB41C038083F0017237FA21B>I<EA01FEEA0703380C
0780121C383803000078C7FC127012F0A712700078134012386C1380380C0100EA0706EA
01F812157E9416>I<14E0130F13011300ABEA01F8EA0704EA0C02EA1C01EA3800127812
7012F0A7127012781238EA1801EA0C0238070CF03801F0FE17237EA21B>I<EA01FCEA07
07380C0380381C01C01238007813E0EA700012F0B5FC00F0C7FCA512700078132012386C
13406C138038070300EA00FC13157F9416>I<133E13E33801C780EA0387130748C7FCA9
EAFFF80007C7FCB27FEA7FF0112380A20F>I<14703803F198380E1E18EA1C0E38380700
A200781380A400381300A2EA1C0EEA1E1CEA33F00020C7FCA212301238EA3FFE381FFFC0
6C13E0383000F0481330481318A400601330A2003813E0380E03803803FE0015217F9518
>I<120E12FE121E120EABEB1F80EB60C0EB80E0380F0070A2120EAF38FFE7FF18237FA2
1B>I<121C123EA3121CC7FCA8120E127E121E120EB1EAFFC00A227FA10E>I<120E12FE12
1E120EB3ADEAFFE00B237FA20E>108 D<390E1FC07F3AFE60E183803A1E807201C03A0F
003C00E0A2000E1338AF3AFFE3FF8FFE27157F942A>I<380E1F8038FE60C0381E80E038
0F0070A2120EAF38FFE7FF18157F941B>I<EA01FCEA0707380C0180381800C0003813E0
481370A200F01378A700701370007813F0003813E0381C01C0380E038038070700EA01FC
15157F9418>I<EA0E1F38FE61C0380E8060380F0070000E1338143CA2141EA7143CA214
38000F1370380E80E0EB41C0EB3F0090C7FCA9EAFFE0171F7F941B>I<3801F820380704
60EA0E02EA1C01003813E0EA7800A25AA71278A2EA3801121CEA0C02EA070CEA01F0C7FC
A9EB0FFE171F7E941A>I<EA0E3CEAFE46EA1E8FEA0F0F13061300120EAD120FEAFFF010
157F9413>I<EA0F88EA3078EA601812C01308A212E0EAF000127FEA3FE0EA0FF0EA01F8
EA003CEA801C130CA212C01308EAE018EAD030EA8FC00E157E9413>I<1202A41206A312
0E121E123EEAFFFCEA0E00AB1304A6EA07081203EA01F00E1F7F9E13>I<000E137038FE
07F0EA1E00000E1370AD14F0A238060170380382783800FC7F18157F941B>I<38FF80FE
381E00781430000E1320A26C1340A2EB80C000031380A23801C100A2EA00E2A31374A213
38A3131017157F941A>I<39FF8FF87F393E01E03C001CEBC01814E0000E1410EB026014
7000071420EB04301438D803841340EB8818141CD801C81380EBD00C140E3900F00F0049
7EA2EB6006EB400220157F9423>I<38FF80FE381E00781430000E1320A26C1340A2EB80
C000031380A23801C100A2EA00E2A31374A21338A31310A25BA35B12F05B12F10043C7FC
123C171F7F941A>121 D E /FL 50 122 df<120FEA3F80EA7FC013E0EAFFF0A213F8A2
127FA2123FEA0F381200A31370A313E0A2120113C0EA0380A2EA0700120E5A5A12100D1D
798B1B>44 D<B61280A819087F9620>I<143C147CEB01FC1307133FB5FCA313CFEA000F
B3B3A7007FB61280A4213879B730>49 D<EB07FC90387FFFC048B512F04814FC3907E01F
FE390F8007FF261E00031380486D13C0007E6D13E0D87F80137F6D14F012FF6DEB3FF8A4
6C5A6C5A6CC7FCC8FC16F0157F16E0A2EDFFC016805C16004A5A4A5A5DEC0FE04A5A4A5A
4AC7FC14FC495A5C49481378EB078049C7FC131E4914F05B5B4848130148B6FC5A5A5A5A
4815E0B7FCA425387BB730>I<EB03FF011F13F0017F13FC9038FC07FE3901F001FF2603
C00013804848EB7FC0D80FE014E07F486C14F07FA46C5A6C4814E06C5AD8008013FF90C7
13C016804A13005D4A5A4A5AEC1FF090380FFFC05D15F090380007FEEC00FFED7FC016E0
ED3FF016F8A2ED1FFCA216FEA2EA1F80487E487E487EA216FCA349EB3FF86C5A49EB7FF0
003EC713E0D81FC0EBFFC0260FF80313806CB61200000114FC6C6C13F0010790C7FC2739
7CB730>I<ED0F80A2151F153F157F15FFA25C5C5CA25C141E143E5C14785C495A13035C
495A495A5B133E133C5B5B12015B485A485A120F48C7FC121E5A5A12F8B81280A4C70001
EB8000AA0103B61280A429377DB630>I<000C15C0D80F80130701F8137F90B612801600
5D5D5D5D15C092C7FC14FCEB1F8090C9FCA8EB03FE90381FFFE0017F13F89038FC07FC90
38E001FE496C7E49EB7F8090C713C0000E15E0C8123F16F0A316F8A3121F487E487E12FF
7FA216F05B5B6CC7EA7FE0127C003C15C0003EECFF806C491300390FC003FE3907F00FFC
6CB55A6C14E06C6C1380D90FF8C7FC25397BB730>I<EC0FF8ECFFFE0103EBFF8090390F
F80FC090391FE003E090397F8001F09038FF0003484813074848EB0FF8151F485A120F5B
001FEC0FF0ED07E0003FEC03C092C7FC5B127FA3EC7FF039FFE1FFFC01E37F9039E7007F
8001EEEB3FC001ECEB1FE001F814F0A249EB0FF8A216FCA24914FEA4127FA5123FA216FC
6C7E16F8120FED1FF06C7E6C6CEB3FE06C6CEB7FC03A00FF81FF8090397FFFFE006D5B01
0F13F00101138027397CB730>I<123C123EEA3FE090B71280A41700485D5E5E5EA2007C
C7EA03E000784A5A4B5A93C7FC48141E153E5D5DC7485A5D14034A5A5D140F4AC8FCA25C
143E147E14FE5CA21301A21303A2495AA4130FA5131FA86D5AA2EB03C0293B7BB930>I<
49B47E010F13F0013F13FC90387E01FE3901F0003F4848EB1F8049EB0FC04848EB07E012
0FED03F0A2121FA27F7F7F6DEB07E013FE3A0FFF800FC014C09138F01F806C9038FC3F00
6CEBFFFC5D6C14E06C14F86D7F011F13FF49148090B612C0D801F814E02607F03F13F048
486C13F8381FC007D9800113FC003FEB007F48C7123FED0FFE00FE1407150315011500A3
16FCA2127FED01F86C7EED03F0D81FE0EB07E06C6CEB0FC0D807FEEBFF806CB61200C614
FC013F13F00103138027397CB730>I<120FEA3FC0EA7FE0A2EAFFF0A4EA7FE0A2EA3FC0
EA0F00C7FCAE120FEA3FC0EA7FE0A2EAFFF0A4EA7FE0A2EA3FC0EA0F000C2679A51B>58
D<EB1FFE90B512E0000314F8390FF007FE391F8001FF003EC71380007EEC7FC0127F486C
14E07FA46C5A6CC713C0001E14FFC813804A13004A5A4A5AEC0FF04A5AEC3F8092C7FC14
7E147C5CA2495A5CA213035CA86D5A90C9FCA7EB03C0EB0FF0497EA2497EA46D5AA26D5A
EB03C0233C7BBB2E>63 D<ED01E04B7EA24B7EA34B7EA24B7EA34B7EA24B7F157BA203F3
7F15F102018015E00203805D167F020780ED803F020F80ED001FA24A80021E130F023E80
023C7FA24A818202F8814A7FA249B77EA24982A2D907C0C76C7E5C173F010F8291C8121F
4982011E150FA2013E82013C81017C8301788113FCB500F00103B612C0A4423B7DBA49>
65 D<B87E17F817FF8428007FE0000313E004007FEF3FF8717EA2717EA28483A64D5AA3
4D5A4D5A60EFFFE04C5B040F90C7FC91B612FCA2EFFF8002E0C713E0EF3FF8EF0FFC8471
7E711380A27113C0A219E0A819C05F19805F4D13004D5A4D5A4CB45AB95A18C095C7FC17
F03B3B7CBA45>I<DB1FFE14600203B500E013E0021FECF801027FECFE03903B01FFFC00
FF07010701C0EB1FCF4990C7EA07FFD91FFC1401D93FF0804948157F4948153F4849151F
4890C9120F5A48481607A248481603A2485A1801A2127FA24993C7FCA212FFAB127FA27F
F001E0123FA36C7EF003C06C7EA26C6CEE07807E6C6DED0F006C6D5D6D6C153E6D6C5DD9
1FFC5D6DB4EC03F06D01C0EB0FE0010101FCEB7F806D6CB6C7FC021F14FC020314E09126
001FFEC8FC3B3D7BBB46>I<B87E17F817FF18C028007FF000077F9338007FF8EF1FFC71
7EEF03FF7113807113C0F07FE0A2F03FF019F8181FA219FCA2F00FFEA519FFAC19FEA419
FC181FA219F8183F19F0187F19E0F0FFC05F4D13804D1300EF1FFEEF7FF8933807FFF0B9
12C095C7FC17F81780403B7CBA4A>I<B6D8F803B612E0A426007FF0C70001EBC000B3A4
91B8FCA402F0C71201B3A7B6D8F803B612E0A4433B7CBA4C>72 D<B612F8A439007FF000
B3B3AFB612F8A41D3B7DBA24>I<B612FEA426007FF0C9FCB3ADEF03C0A517071880A317
0FA3171FA2173F177F17FF5E04071300163FB9FCA4323B7DBA3A>76
D<B500F00403B512E06E5EA26E5ED8007FF1C000A2D97BFE161EA2D979FF5EA201786D5D
A36E6C5DA26E6C4A5AA26E6C4A5AA36E6C4A5AA26E6C4A5AA26E6C141EA36E6C5CA26E6D
5BA26F6C5BA36F6C485AA26F6C485AA26F6C485AA26F6C48C7FCA3923803FE1EA26F6C5A
A26F13F8A3705AA2705AA201FC6E5AB500FC4BB612E0A2EE0F80EE0700533B7CBA5C>I<
B500F00207B512E0808080D8007F92390007E0006E6F5A81017B7F81137901787F6E7E6E
7E81141F6E7E6E7F6E7F82806E7F6F7E6F7E826F7E816F13806F13C017E06F13F081EE7F
F8EE3FFC17FEEE1FFF827013837013C318E37013F382EF7FFBEF3FFFA283838383A28383
187F183FA201FC161FB500FC150F18071803A2433B7CBA4C>I<ED7FF8020FB512C0027F
14F8903A01FFE01FFE010790390003FF80D90FFC01007FD91FF0EC3FE0D97FE0EC1FF849
486E7E48496E7E91C81203488348486F1380000F18C04981001F18E0A24848EE7FF0A300
7F18F849163FA400FF18FCAC007F18F86D167FA3003F18F0A26D16FF001F18E0A26C6C4B
13C0A26C6C4B13806C18006E5C6C5F6C6D4A5A6D6C4A5AD93FF8EC7FF0D90FFCECFFC06D
B401035B01019026E01FFEC7FC6D6CB512F8020F14C09126007FF8C8FC3E3D7BBB49>I<
B8FC17F017FC17FF28007FF0000F13C0040113E09338007FF0EF3FF8EF1FFCA218FE170F
A218FFA718FEA2171F18FC18F8173FEF7FF0933801FFE0040F138091B7120017F817C002
F0C9FCB3A5B612F8A4383B7CBA42>I<B712F8EEFFC017F817FE3B007FF0001FFF040313
C004007F717E717EA284171FA284A660A2173F604D5A604C485A4C5BDC1FFEC8FC91B612
F817C0A29139F0007FF0EE1FF8707E707E707E8482A284A584A5F101E0A27013F0A2F103
C0EF7FF8B600F890393FFC078094381FFE0F0507B51200050113FCCBEA1FF0433C7CBA48
>82 D<D903FF1303011FEBE00790B5EAFC0F486E5A4848C66C5AD807F0EB1FFF48481307
4848130148487FA248C87E82A24881A36D80A27FA201F091C7FCEA7FFCEBFF806C13F8EC
FFC06C14FC15FF6C15C06C15F06C81C6816D80131F010380D9001F14801401DA000F13C0
15031500EE7FE0A20070153F12F0161FA37E17C0A27EEE3F807E6C160001C05C6D14FE01
FC495A3AFDFFC00FF8D8F87FB55AD8F01F14C0D8E00391C7FC39C0003FF82B3D7BBB36>
I<003FB912C0A4903AF8007FF001D87FC09238003FE049161F90C7150F007E1707007C17
03A300781701A448EF00F0A5C81600B3AF010FB77EA43C3A7DB943>I<B6D8C01FB500FC
90381FFFFEA4000101E0C7D81FFCC8EA3F006C1B1E717E6E193E017F70153C836D6C6185
6E19F8011F624D7F6E1801010F4B6D5C171E6D6C4E5A053E7F6FD93C7F14076D624D6C7E
6F170F6D03F86D91C7FCEFF01F6F5F6D02016E131E03F0D9E00F143E027F183C04038003
F8496C147C023F0107ED80784D7E03FC17F8021F010F6F5A03FE497E020FEFC1E04C15E1
DBFF1E6D13E36EEFF3C04C147F04BC15F76E01FCEDFF804C806E95C8FCA24C806E5F4C14
0FA2037F5E4C1407033F5EA24C1403031F5E93C812016F5E5F3B7EBA64>87
D<EB3FFE48B512E0000714F8390FE007FC9038F001FE486C6C7E6F7E82153F6C48806C5A
6C5AC8FCA491B5FC131F90387FF83F3803FF803807FC00EA0FF0485A123F485AA2485AA4
157F6C7E15DF3A3FE0039FF03B1FF80F0FFFE03807FFFE0001497E39003FE0002B267DA5
2F>97 D<13FE12FFA412071203B04AB4FC021F13F0027F13FC9138FC03FE9039FFF000FF
02C0EB3F8091C7EA1FC04915E0EE0FF017F8A2EE07FCA317FEA917FCA3160F17F817F016
1F6D15E06EEB3FC06EEB7F80D9F9E0EBFF009039F0FC07FE91387FFFF8D9E01F13E09026
C003FEC7FC2F3C7DBB36>I<903801FFF0010F13FE013FEBFF809039FF801FC03901FE00
3F4848EB7FE0485A485A121F4848EB3FC0ED1F80007FEC0F004990C7FCA212FFAA127F7F
A2123F6D14F0121F6C6CEB01E012076C6CEB03C06CB4EB0F806C9038C03F0090383FFFFE
010F13F8010113C024267DA52B>I<EE3F80ED3FFFA4150181B0ECFF80010F13F0013F13
FC9038FFC03F3901FE000F4848130348487F48487F121F485AA2127F5BA312FFA9127FA3
6C7EA2121F6C6C5B6C6C5B00035CD801FE011F13C02700FF807E13FE90387FFFF8010F13
E0010113002F3C7DBB36>I<49B47E010F13F0017F13FC9038FF81FE3A03FE007F80D807
F8133F4848EB1FC0ED0FE0485A003F15F01507485A16F8A212FFA290B6FCA301C0C8FCA4
127FA36C7E1678121F7F000F15F06C6C13016C6CEB03E06C6CEB0FC03A00FFC07F809039
3FFFFE00010F13F8010013C025267DA52C>I<EC1FF0ECFFFC010313FF90390FF83F8090
381FE07F90393FC0FFC0495A13FFA2489038007F80ED3F00151E92C7FCAAB67EA4000190
C8FCB3AC007F13FEA4223C7DBB1E>I<161FD907FEEBFF8090263FFFC113C090B538F3C7
E03A01FE07FF0F3903F801FC3907F000FE000F9138FF07C0484890387F8380EE8000003F
81A7001F5DA26C6C49C7FC00075C6C6C485A3901FE07F848B55AD8073F13C0260607FEC8
FC000ECAFCA2120F5A7F6C7E90B512F8EDFF8016E06C816C816C814881000F81391FC000
0F48C8FC48ED7F8000FE153FA5007FED7F00A26C6C14FE6C6C495AD80FF0EB07F8D807FE
EB3FF00001B612C06C6C91C7FC010713F02B397DA630>I<13FE12FFA412071203B0EDFF
80020313F0020F7F91381E03FC91383801FE02607F4A7E01FF15805C91C7FCA35BB3A4B5
D8F83F13FEA42F3C7CBB36>I<EA01E0EA07F8487EA2487EA46C5AA26C5AEA01E0C8FCAB
13FE127FA412071203B3AAB512F0A4143D7DBC1A>I<13FE12FFA412071203B092381FFF
F0A4923803FC0016F04B5AED1F804BC7FC157E5DEC03F8EC07E04A5A4A5A4A7EECFFE090
B57EA281ECCFFCEC07FE496C7E13FC6E7F6E7F6F7E153F826F7E6F7E1507826F7EB5D8F0
1F13FCA42E3C7DBB33>107 D<13FE12FFA412071203B3B3AEB512F8A4153C7DBB1A>I<D8
01FCD97FC0EB0FF800FF902603FFF8EB7FFF020F6D48B57E913C1F03FE03E07FC0913C38
00FF07001FE0000749028E80000301C0D97F98130F01FD03F8804A5C01FFC75BA3495DB3
A4B5D8F81FB50003B512E0A44B267CA552>I<D801FCEBFF8000FF010313F0020F7F9138
1E03FC91383801FE000701607F0003497E01FD15805C01FFC7FCA35BB3A4B5D8F83F13FE
A42F267CA536>I<903801FFC0010F13F8017F13FFD9FF807F3A03FE003FE0D807F8EB0F
F048486D7EA248486D7E003F81A248486D7EA400FF1680A9007F1600A36C6C495AA2001F
5D6D1307000F5D6C6C495AD803FEEB3FE03A00FF80FF806DB5C7FC010F13F8010113C029
267DA530>I<9038FE01FF00FF011F13F0027F13FC9138FC07FE9039FFF001FF00079039
C0007F806C90C7EA3FC04915E0EE1FF017F8160F17FCA2160717FEA917FC160FA317F8EE
1FF0A26DEC3FE06EEB7FC06EEBFF806E4813009039FEFC07FE91387FFFF8021F13E0DA03
FEC7FC91C9FCADB512F8A42F377DA536>I<3901FC03F000FFEB0FFC4AB4FC91383C3F80
EC707F00079038E0FFC000035BEBFD80A201FFEB7F809138003F00151E92C7FC5BB3A3B5
12FCA422267DA528>114 D<90383FF0383903FFFE7848EBFFF8381FC00F383F0003003E
13005A157812FCA27E6C140013C013FC387FFFF06C13FEECFF806C14C06C14E0000314F0
C614F8011F13FCEB007FEC07FE0070130100F01300157E7EA27E157C6C14FC6C14F89038
8001F09038F00FE000F9B512C0D8F07F130038C01FF81F267DA526>I<130FA55BA45BA2
5BA25B5A5A5A001FEBFFF0B6FCA3000190C7FCB3153CA86C14781480017F13F090383FC1
E090381FFFC06D1380903801FE001E377EB626>I<01FEEC3F8000FFEC3FFFA400071401
000380B3A45DA25D120115066C6C4913C090267F807813FE6DB45A6D5B010313802F267C
A536>I<B500F0EBFFFCA4D803FEC7EA1F806D15006C151E806C5DA26E137C017F14786E
13F8013F5CECF001011F5CECF803010F5CA2ECFC0701075CECFE0F010391C7FC6E5A6D13
1E15BE6D13BC15FC6E5AA36E5AA26E5AA26E5AA26E5A2E267EA533>I<B500E0B539C03F
FF80A43E07FC0007F80001F0006C6C5F6F7E6D16036C6F5C18076CD980075D8202C0150F
017F90260F7F8090C7FCA290263FE01F141E92381E3FC002F0153E011F90393C1FE03CA2
90260FF87C5C9238780FF002FC15F80107D9F0075B17F8D903FFECF9E09238E003FD17FF
6D5E4B7EA26D496C5BA2027F92C8FC92C77EA2023E143E021E143C41267EA546>I<B539
E00FFFF8A4000190390001FC00028013F06CEBC0036D6C485A013F5C6D6C485A6D6C48C7
FCECFC3E6D6C5A903803FFFC6D5B6D5B5D147F6E7E141F4A7E4A7E81ECFBFFD901F17FEB
03E049486C7E010F8049486C7E4A6C7E013E130F496D7E496D7E000181B5011F13FCA42E
267EA533>I<B500F0EBFFFCA4D803FEC7EA1F806D15006C151E806C5DA26E137C017F14
786E13F8013F5CECF001011F5CECF803010F5CA2ECFC0701075CECFE0F010391C7FC6E5A
6D131E15BE6D13BC15FC6E5AA36E5AA26E5AA26E5AA26E5AA2140F92C8FC5C141E000813
3E007F133C147C38FF807814F8EB81F0EB83E06C485A387C1F80D83FFFC9FCEA1FFCEA07
F02E377EA533>I E end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300dpi
TeXDict begin

%%EndSetup
%%Page: 1 1
1 0 bop 465 368 a FL(Multi-Stage)34 b(Programming:)436
503 y(Its)e(Theory)h(and)f(Applications)911 1113 y FK(W)l(alid)16
b(T)l(aha)330 1189 y(B.S.)f(Computer)h(Science)e(and)j(Engineering,)f
(1993,)h(Ku)o(w)o(ait)f(Univ)o(ersit)o(y)l(.)548 1800
y(A)f(dissertation)i(submitted)d(to)j(the)f(facult)o(y)f(of)i(the)461
1875 y(Oregon)g(Graduate)g(Institute)e(of)i(Science)d(and)j(T)l(ec)o
(hnology)750 1951 y(in)f(partial)g(ful\014llmen)o(t)d(of)j(the)743
2026 y(requiremen)o(ts)d(for)k(the)f(degree)809 2102
y(Do)q(ctor)h(of)f(Philosoph)o(y)1015 2177 y(in)661 2253
y(Computer)f(Science)g(and)i(Engineering)863 2478 y(No)o(v)o(em)o(b)q
(er)30 b(1999)p eop
%%Page: 2 2
2 1 bop 687 1424 a FK(c)673 1426 y FJ(\015)16 b FK(Cop)o(yrigh)o(t)g
(1999)i(b)o(y)d(W)l(alid)h(T)l(aha)823 1501 y(All)f(Righ)o(ts)h(Reserv)
o(ed)1023 2795 y FI(ii)p eop
%%Page: 3 3
3 2 bop 212 192 a FI(The)13 b(dissertation)g(\\Multi-Stage)f
(Programming:)d(Its)k(Theory)g(and)f(Applications")g(b)o(y)g(W)m(alid)f
(T)m(aha)h(has)150 266 y(b)q(een)j(examined)e(and)g(appro)o(v)o(ed)h(b)
o(y)g(the)g(follo)o(wing)e(Examination)f(Commi)o(ttee:)p
1020 528 900 2 v 1020 569 a(Tim)h(Sheard)1020 611 y(Asso)q(ciate)j
(Professor)1020 652 y(Thesis)g(Researc)o(h)g(Adviser)p
1020 947 V 1020 988 a(James)e(Ho)q(ok)1020 1029 y(Asso)q(ciate)i
(Professor)p 1020 1325 V 1020 1366 a(John)f(Launc)o(h)o(bury)1020
1415 y(Asso)q(ciate)h(Professor)p 1020 1710 V 1020 1752
a(Da)o(vid)e(Maier)1020 1793 y(Professor)p 1020 2088
V 1020 2129 a(Neil)g(D.)h(Jones)1020 2171 y(Professor,)h(Univ)o(ersit)o
(y)e(of)h(Cop)q(enhagen)p 1020 2474 V 1020 2515 a(Eugenio)g(Moggi)1020
2564 y(Professor,)h(Univ)o(ersit)o(y)e(of)h(Geno)o(v)n(a)1018
2795 y(iii)p eop
%%Page: 4 4
4 3 bop 807 428 a FL(Dedication)584 669 y FI(T)m(o)13
b(Sohair,)g(Mohamed,)f(No)q(dar,)i(Hanan,)f(and)g(Hamid.)1018
2795 y(iv)p eop
%%Page: 5 5
5 4 bop 510 779 a FH(Why)16 b(is)e(my)h(verse)g(so)g(b)n(arr)n(en)f(of)
h(new)g(pride,)510 854 y(So)g(far)g(fr)n(om)f(variation)h(or)f(quick)h
(change?)510 928 y(Why)h(with)e(the)h(time)f(do)i(I)e(not)i(glanc)n(e)f
(aside)510 1003 y(T)m(o)g(new-found)g(metho)n(ds)g(and)h(to)f(c)n(omp)n
(ounds)h(str)n(ange?)510 1078 y(Why)g(write)d(I)i(stil)r(l)f(al)r(l)g
(one,)h(ever)g(the)g(same,)510 1152 y(A)o(nd)g(ke)n(ep)g(invention)h
(in)f(a)g(note)n(d)g(we)n(e)n(d,)510 1227 y(That)g(every)g(wor)n(d)f
(doth)h(almost)g(tel)r(l)f(my)h(name,)510 1302 y(Showing)g(their)g
(birth)f(and)h(wher)n(e)g(they)g(did)g(pr)n(o)n(c)n(e)n(e)n(d?)510
1377 y(O,)f(know,)h(swe)n(et)f(love,)h(I)g(always)g(write)e(of)i(you,)
510 1451 y(A)o(nd)g(you)h(and)f(love)g(ar)n(e)g(stil)r(l)e(my)i(ar)n
(gument;)510 1526 y(So)g(al)r(l)g(my)g(b)n(est)f(is)h(dr)n(essing)g
(old)g(wor)n(ds)f(new,)510 1601 y(Sp)n(ending)i(again)g(what)e(is)h
(alr)n(e)n(ady)f(sp)n(ent:)510 1675 y(F)m(or)g(as)i(the)e(sun)i(is)e
(daily)h(new)g(and)h(old,)510 1750 y(So)f(is)g(my)g(love)g(stil)r(l)e
(tel)r(ling)i(what)f(is)h(told.)1041 1858 y FI(Sonnet)g(LXXVI,)e(Shak)o
(esp)q(eare)1024 2795 y(v)p eop
%%Page: 6 6
6 5 bop 633 428 a FL(Ac)m(kno)m(wledgemen)m(ts)150 877
y FI(The)11 b(creativit)o(y)m(,)f(energy)m(,)g(en)o(th)o(usiasm)g(of)g
(Prof.)g(Tim)e(Sheard,)j(m)o(y)e(advisor,)h(ha)o(v)o(e)g(b)q(een)i(a)e
(tremendous)h(source)150 951 y(of)k(supp)q(ort)h(throughout)f(m)o(y)f
(four)h(and)g(half)f(y)o(ears)i(of)e(graduate)i(studies.)g(His)f
(guidance)g(and)g(supp)q(ort)i(are)150 1026 y(the)d(reason)h(wh)o(y)f
(I)f(am)g(completing)f(m)o(y)g(dissertation)i(to)q(da)o(y)m(.)212
1101 y(An)f(Arabic)h(pro)o(v)o(erb)f(sa)o(ys)g(that)g(companions)f
(should)h(b)q(e)g(c)o(hosen)h(b)q(efore)g(route.)f(This)g(is)g(not)g
(easy)g(when)150 1176 y(the)j(sc)o(ho)q(ol)g(y)o(ou)g(w)o(an)o(t)f(to)h
(go)f(to)h(is)f(half-w)o(a)o(y)f(around)i(the)h(w)o(orld.)d(Despite)j
(that,)e(I)h(m)o(ust)f(sa)o(y)m(,)g(I)g(ha)o(v)o(e)h(had)150
1250 y(excellen)o(t)f(compan)o(y)e(during)i(m)o(y)e(sta)o(y)h(at)h
(OGI.)f(F)m(or)g(man)o(y)f(memorable)f(times,)h(I)i(am)e(indebted)i(to)
g(Da)o(vide)150 1325 y(Anacona,)h(V)m(eronica)g(Baicean)o(u,)g(Byron)h
(Co)q(ok,)f(Scott)h(Daniels,)e(Jo)q(ey)i(Flac)o(k,)e(Anita)h(Go)o
(vindara)r(jan,)f(Phil)150 1400 y(Galbiati,)g(Ashish)i(and)g(Shailesh)g
(Go)q(db)q(ole,)g(Brian)g(Hansen,)g(P)o(aul)g(Hosom,)e(Mary)i(Hultine,)
g(Jon)g(Inouy)o(e,)150 1474 y(Je\013)h(Lewis,)e(Roz)g(Lindquist,)g
(John)h(and)f(Julie)h(Mathews,)g(Emir)e(P)o(asalic,)g(Matt)i
(Sa\013ell,)f(Amol)e(and)j(Alok)150 1549 y(Vy)o(as)g(\(and)f(the)h
(Indian)f(Ma\014a)h(at)f(large\),)g(Bennett)i(V)m(ance,)f(Karen)g(W)m
(ard,)e(Lisa)i(W)m(alton,)d(W)m(ei)i(W)m(ei,)f(and)150
1624 y(man)o(y)c(other)i(w)o(onderful)f(friends.)h(The)g(man)o(y)d
(emails)h(and)h(in)o(termitten)o(t)g(visits)g(with)h(T)m(amer)e(Ab)q
(del-Rahim,)150 1699 y(W)m(ael)16 b(F)m(atin,)f(Ashraf)j(Hamala)o(wy)l
(,)c(Sarah)j(Miller,)f(W)m(ael)g(Masri,)g(and)h(Kelly)f(Sc)o(hrec)o(k)o
(engost)j(pro)o(vided)e(me)150 1773 y(with)d(lots)f(of)g(sunshine)i
(when)g(the)f(P)o(ortland)g(clouds)g(tried)g(to)g(protect)h(me)e(from)f
(it.)212 1848 y(Our)h(library)f(did)f(a)h(miraculous)f(job)h(at)g(resp)
q(onding)g(to)g(m)o(y)f(con)o(tin)o(ual)g(requests)j(for)e(in)o
(ter-library)g(loans,)150 1923 y(esp)q(ecially)g(as)f(I)h(came)e
(closer)i(to)g(graduation)e(and)i(w)o(an)o(ted)f(to)h(\\tie)f(ev)o
(erything)h(together".)f(A)h(sp)q(ecial)g(thanks)150
1998 y(go)q(es)j(to)f(Mary)g(Hultine)g(for)g(her)h(supp)q(ort)g(and)g
(con)o(tin)o(ual)e(in)o(terest)i(in)f(m)o(y)f(nativ)o(e)h(culture)h
(and)f(language.)f(I)150 2072 y(am)e(also)h(v)o(ery)h(grateful)g(to)f
(Julianne)h(William)o(s)d(for)i(her)i(promptness)e(and)h(patience)h(in)
e(helping)g(me)g(prepare)150 2147 y(the)i(bibliograph)o(y)e(for)i(this)
g(dissertation.)212 2222 y(The)d(systems)g(supp)q(ort)g(sta\013)f(of)g
(CSE)h(ha)o(v)o(e)f(b)q(een)h(most)e(accommo)q(dating)f(for)i(m)o(y)e
(man)o(y)h(demands)g(during)150 2296 y(m)o(y)i(y)o(ears)i(at)f(OGI.)f
(I)i(w)o(ould)e(esp)q(ecially)i(lik)o(e)e(to)h(thank)h(Marion)e(H)-5
b(\027)-26 b(ak)n(anson)12 b(for)g(helping)g(me)f(quic)o(kly)h(reco)o
(v)o(er)150 2371 y(from)g(endless)j(go)q(ofs,)e(esp)q(ecially)h(the)h
(time)d(when)j(I)e(deleted)i(a)f(c)o(hapter)h(of)e(m)o(y)f
(dissertation.)212 2446 y(I)j(w)o(ould)f(lik)o(e)g(to)g(thank)h(the)g
(administrativ)o(e)d(sta\013)j(of)f(OGI)h(in)f(general,)g(and)h(of)f(P)
o(acSoft)g(in)h(particular.)150 2521 y(Kelly)i(A)o(tkinson)g(and)g
(Therese)i(Fisher)f(ha)o(v)o(e)g(con)o(tin)o(ually)d(done)j(miracles)e
(to)h(k)o(eep)h(me)e(a)h(happ)o(y)g(camp)q(er)150 2595
y(b)q(oth)c(when)f(I)h(w)o(as)f(at)g(OGI)h(and)f(when)h(I)f(w)o(as)h(a)
o(w)o(a)o(y)e(from)g(OGI)h(during)g(the)h(man)o(y)e(business)i(trips)g
(that)f(they)150 2670 y(had)i(alw)o(a)o(ys)f(arranged)h(with)f
(meticulous)g(care.)1018 2795 y(vi)p eop
%%Page: 7 7
7 6 bop 150 192 a FH(Cr)n(e)n(dits)15 b(and)j(Personal)f(Contribution:)
22 b FI(I)16 b(had)g(the)g(go)q(o)q(d)g(fortune)g(of)f(\014nding)g(man)
o(y)f(of)h(the)i(p)q(eople)f(that)g(I)150 266 y(w)o(an)o(ted)f(to)f
(thank)g(ending)g(up)h(b)q(eing)f(on)h(m)o(y)d(thesis)k(committee.)c
(My)i(thesis)h(committee)e(pla)o(y)o(ed)h(an)g(activ)o(e)150
341 y(role)h(in)g(the)h(dev)o(elopmen)o(t)e(of)h(this)g(w)o(ork)g(from)
e(b)q(eginning)i(to)g(end.)g(I)g(w)o(ould)g(lik)o(e)f(to)h(thank)g
(Neil)g(Jones)h(for)150 416 y(his)d(careful)f(reading)h(of)f(m)o(y)f
(thesis)i(prop)q(osal,)f(and)h(bringing)e(m)o(uc)o(h)h(needed)i(fresh)f
(insigh)o(ts)f(in)o(to)g(the)i(v)n(arious)150 490 y(form)o(ulations)c
(of)j(MetaML's)g(seman)o(tics.)f(Neil)g(p)q(oin)o(ted)h(out)g(to)g(me)f
(the)h(amazing)e(w)o(orks)i(of)f(Quine.)h(I)g(w)o(ould)150
565 y(lik)o(e)d(to)h(thank)f(Eugenio)h(Moggi)e(for)i(his)f(careful)h
(reading)g(of)f(m)o(y)f(dissertation,)i(and)f(for)h(his)f(man)o(y)f
(suggestions)150 640 y(for)k(impro)o(ving)d(the)j(tec)o(hnical)g
(presen)o(tation.)h(I)f(am)e(esp)q(ecially)i(grateful)g(to)f(Eugenio)h
(for)g(b)q(eing)g(critical)f(and)150 715 y(also)18 b(doubtful)g(of)g
(the)h(p)q(ossibilit)o(y)e(of)h(relating)g(the)i(reduction)f(and)f
(big-step)h(seman)o(tics.)f(Long)g(b)q(efore)h(I)150
789 y(started)h(w)o(orking)d(on)h(m)o(y)f(thesis,)i(Da)o(vid)e(Maier's)
h(class)h(on)f(Automata)f(help)q(ed)i(me)e(regain)i(the)g(courage)150
864 y(to)f(explore)h(theoretical)h(asp)q(ects)g(of)e(programmi)o(ng)e
(languages.)h(While)h(I)h(w)o(as)f(writing)g(m)o(y)f(dissertation,)150
939 y(Da)o(vid)e(preempted)h(man)o(y)e(of)h(m)o(y)f(attempts)i(to)g
(massacre)g(the)g(English)f(language.)g(James)g(Ho)q(ok's)h(classes)150
1013 y(on)g(Seman)o(tics)g(o\013ered)i(a)e(c)o(hallenge)h(that,)f(as)g
(evidenced)i(b)o(y)f(this)f(dissertation,)h(I)f(ev)o(en)o(tually)g
(decided)i(to)150 1088 y(tak)o(e)11 b(up.)f(The)h(n)o(umerous)f
(illumina)o(ting)d(discussions)12 b(with)e(James)g(Ho)q(ok)g(ab)q(out)h
(b)q(oth)g(Soft)o(w)o(are)f(Engineering)150 1163 y(and)h(Theoretical)g
(Computer)f(Science)i(ha)o(v)o(e)f(had)g(a)f(signi\014can)o(t)h
(in\015uence)h(on)e(m)o(y)g(w)o(ork.)g(John)h(Launc)o(h)o(bury's)150
1238 y(classes)18 b(on)e(Category)g(Theory)h(and)f(F)m(ormal)e(Soft)o
(w)o(are)i(Dev)o(elopmen)o(t,)e(and)i(his)h(emphasis)e(on)h(ha)o(ving)f
(the)150 1312 y(studen)o(ts)g(w)o(ork)e(through)h(pro)q(ofs)g(w)o(ere)g
(the)h(reason)f(I)g(dev)o(elop)q(ed)g(an)f(app)q(etite)i(for)e(these)i
(t)o(w)o(o)e(topics.)h(There)150 1387 y(is)h(a)f(substan)o(tial)h
(\\energy)g(barrier")g(in)o(v)o(olv)o(ed)f(in)g(understanding)h(what)g
(these)h(t)o(w)o(o)f(topics)g(are)g(ab)q(out,)f(and)150
1462 y(John)e(is)g(a)g(magician)d(when)k(it)f(comes)f(to)h(helping)g(p)
q(eople)g(understand.)h(I)f(am)e(esp)q(ecially)j(indebted)g(to)e(James)
150 1536 y(Ho)q(ok)h(and)f(John)i(Launc)o(h)o(bury)f(for)f(the)i(man)o
(y)d(c)o(hallenging)h(questions)h(that)g(they)h(ha)o(v)o(e)f(p)q(osed)g
(to)g(me)f(during)150 1611 y(the)18 b(y)o(ears)g(of)f(m)o(y)f
(dissertation)i(w)o(ork,)e(and)i(to)f(whic)o(h)g(I)h(hop)q(e)g(they)g
(found)f(satisfactory)g(answ)o(ers)i(in)e(this)150 1686
y(dissertation.)212 1761 y(I)c(w)o(ould)f(also)h(lik)o(e)f(to)g(thank)h
(Lois)g(Delcam)o(bre)f(and)g(Dic)o(k)h(Kieburtz,)g(in)g(addition)f(to)g
(m)o(y)g(examiners,)f(for)150 1835 y(serving)j(on)g(m)o(y)e(thesis)j
(prop)q(osal)e(committee.)212 1910 y(While)e(conducting)i(the)f
(researc)o(h)i(presen)o(ted)g(in)e(this)g(dissertation,)f(and)h(during)
g(its)g(preparation,)f(I)h(ha)o(v)o(e)150 1985 y(receiv)o(ed)19
b(substan)o(tial)f(tec)o(hnical)g(help)h(from)d(a)i(n)o(um)o(b)q(er)f
(of)h(p)q(eople.)g(The)g(idea)g(of)f(man)o(ually)f(staged)i(pro-)150
2060 y(grams)13 b(and)h(MetaML's)g(original)e(implemen)o(tatio)o(n)f
(is)j(primarily)e(due)i(to)g(Sheard.)g(Cross-stage)h(p)q(ersistence)150
2134 y(and)d(gensym-renaming)d(of)j(free)h(v)n(ariable)e(w)o(ere)i
(already)f(b)q(eing)g(used)h(in)f(Sheard's)g(original)f(MetaML)h
(imple-)150 2209 y(men)o(tation.)g(Multi-stage)h(programming)d(with)k
(explicit)f(annotations)g(is)h(Sheard's)h(conception.)f(I)f(just)h(ga)o
(v)o(e)150 2284 y(these)k(things)e(names,)f(and)h(w)o(en)o(t)g(on)g(to)
g(study)h(them)e(formally)m(.)d(Ro)o(w)o(an)j(Da)o(vies)h(ga)o(v)o(e)g
(me)f(a)h(concrete)i(ex-)150 2358 y(ample)11 b(of)h(the)h(limitations)d
(of)i(the)h(original)e(t)o(yp)q(e)i(system)g(for)f(MetaML.)h(Zine)g
(El-Abidine)f(Benaissa)h(guided)150 2433 y(me)g(in)h(doing)f
(\\strip-lemma")e(con\015uence)16 b(pro)q(ofs)e(for)g(an)g(early)g(v)o
(ersion)g(of)g(the)g(reduction)h(seman)o(tics.)f(The)150
2508 y(w)o(ork)h(on)g(an)g(earlier)h(v)o(ersion)f(of)g(the)h(\014rst)g
(t)o(yp)q(e)g(system)f(for)g(MetaML)h(is)f(join)o(t)f(with)h(Zine.)g(I)
g(also)g(had)g(the)150 2583 y(great)i(pleasure)h(of)f(w)o(orking)f
(with)h(Eugenio)g(Moggi.)e(Eugenio)i(prop)q(osed)h(simpli\014cations)d
(to)i(the)h(original)150 2657 y(t)o(yp)q(e)d(system,)f(and)g(pla)o(y)o
(ed)g(the)h(k)o(ey)g(role)f(in)g(dev)o(eloping)g(the)i(category)e(for)h
(in)o(terpreting)g(MetaML)g(and)f(its)1013 2795 y(vii)p
eop
%%Page: 8 8
8 7 bop 150 192 a FI(extensions.)17 b(I)f(dev)o(elop)q(ed)h(the)f(in)o
(terpretation)h(of)e(MetaML)i(in)o(to)e(this)h(mo)q(del)f(join)o(tly)g
(with)g(him.)f(Eugenio)150 266 y(also)g(prop)q(osed)i(and)e(sp)q
(earheaded)j(the)e(study)g(of)f(a)h(language)e(that)i(com)o(bined)f
(the)h(t)o(w)o(o)f(logical)f(mo)q(dalities)150 341 y(previously)h
(explored)g(b)o(y)g(Da)o(vies)f(and)h(Pfenning,)f(whic)o(h)h(lead)g(us)
g(to)g(a)g(framew)o(ork)e(where)j(the)g(imp)q(ortance)150
416 y(of)k(closedness)j(could)e(b)q(e)g(explained)g(clearly)m(.)f(I)g
(had)h(v)o(ery)g(fruitful)f(discussions)i(with)e(F)m(ranklyn)g(T)m
(urbak)150 490 y(ab)q(out)12 b(observ)n(ational)f(equiv)n(alence)h(pro)
q(ofs)f(and)h(Plotkin's)f(pap)q(er)i(on)e(call-b)o(y-name,)e(call-b)o
(y-v)n(alue,)h(and)h(the)150 565 y(lam)o(b)q(da)k(calculus.)i(Hongw)o
(ei)g(Xi)g(p)q(oin)o(ted)g(out)g(to)g(me)f(T)m(ak)n(ahashi's)g(pap)q
(er)i(on)f(parallel)f(reduction.)h(I)h(also)150 640 y(had)11
b(v)o(ery)h(useful)f(discussions)h(with)f(Hongw)o(ei)g(on)g(the)g
(details)g(of)g(standardization)g(pro)q(ofs.)g(Discussions)g(with)150
715 y(Eugenio)g(Moggi)g(and)g(Sa)o(v)n(a)g(Kristic)h(greatly)f(sharp)q
(ened)i(m)o(y)d(presen)o(tation)i(of)f(the)h(results)h(on)e(the)h
(soundness)150 789 y(of)h(MetaML's)h(reduction)h(seman)o(tics.)212
864 y(The)21 b(researc)o(h)g(on)f(MetaML)g(has)g(also)g(b)q(ene\014ted)
i(from)c(v)n(aluable)g(inputs)j(from)d(Don)h(Batory)m(,)g(Ko)q(en)150
939 y(Claessen,)13 b(Olivier)f(Dan)o(vy)m(,)f(Ro)o(w)o(an)g(Da)o(vies,)
h(Rob)q(ert)g(Gl)q(\177)-22 b(uc)o(k,)12 b(Sam)f(Kamin,)f(P)o(eter)k
(Lee,)f(Erik)f(Meijer,)g(Flem-)150 1013 y(ming)c(Nielson,)i(Dino)g
(Oliv)n(a,)e(F)m(rank)i(Pfenning,)g(Amr)f(Sabry)m(,)h(Mark)g(Shields,)g
(Y)m(annis)g(Smaragdakis,)e(Carolyn)150 1088 y(T)m(alcott,)13
b(Phil)g(W)m(adler)g(and)h(the)g(mem)o(b)q(ers)f(of)g(P)o(acSoft.)212
1163 y(Man)o(y)d(p)q(eople)h(ha)o(v)o(e)f(b)q(een)h(kind)f(enough)g(to)
h(read)f(parts)h(of)f(this)g(dissertation)h(and)f(ga)o(v)o(e)g(me)f
(feedbac)o(k)i(that)150 1238 y(impro)o(v)o(ed)h(the)i(presen)o(tation)g
(and)f(sharp)q(ened)i(m)o(y)d(though)o(t.)h(I)g(w)o(ould)g(lik)o(e)g
(to)g(thank)g(Lennart)h(Augustsson,)150 1312 y(Tito)i(Autry)m(,)g
(Byron)h(Co)q(ok,)f(Leo)h(F)m(egaras,)f(Mark)h(Jones,)g(Alex)g(Koto)o
(v,)f(Ab)q(del)h(Hamid)e(T)m(aha,)g(and)i(Eelco)150 1387
y(Visser.)d(All)g(mistak)o(es)e(and)i(all)f(other)h(results)h(in)f
(this)g(dissertation)g(are)g(m)o(y)e(resp)q(onsibilit)o(y)m(.)212
1462 y(P)o(arts)19 b(of)e(the)h(presen)o(t)i(dissertation)e(build)f(on)
h(w)o(orks)f(b)o(y)h(the)g(author)g(and)g(collab)q(orators)f
(previously)150 1536 y(published)d(elsewhere)i([94,)5
b(91,)h(55,)g(5].)150 1661 y FH(F)m(unding)12 b(and)g(Financial)g(Supp)
n(ort:)17 b FI(I)10 b(am)e(v)o(ery)i(grateful)g(to)g(the)g(Oregon)h
(Graduate)f(Institute)h(of)e(T)m(ec)o(hnology)m(,)150
1736 y(and)19 b(the)g(P)o(aci\014c)h(Soft)o(w)o(are)e(Researc)o(h)i
(Institute)g(\(P)o(acSoft\))f(for)g(generously)g(supp)q(orting)g(me)f
(\014nancially)150 1810 y(throughout)i(m)o(y)f(do)q(ctoral)i(studies,)f
(and)h(co)o(v)o(ering)f(all)f(m)o(y)g(exp)q(enses)k(related)e(to)f
(attending)h(n)o(umerous)150 1885 y(w)o(orkshops,)d(conferences)i(and)e
(summer)e(sc)o(ho)q(ols.)h(My)h(stip)q(end)h(w)o(as)e(pro)o(vided)h(b)o
(y)g(the)g(National)f(Science)150 1960 y(F)m(oundation)d(\(NSF\))i
FH(T)m(yp)n(e)f(Safe)i(Pr)n(o)n(gr)n(am)e(Gener)n(ators)j
FI(a)o(w)o(ard)d(#IRI9625462.)d(My)j(tuition)f(w)o(as)h(pro)o(vided)150
2035 y(b)o(y)h(the)h(Air)f(F)m(orce)h(Material)f(Comm)o(and)e
FH(Phase)j(I)g(&)g(II)23 b FI(and)16 b FH(Phase)i(III)e
FI(con)o(tracts)i(#F19628-93-C-00)o(69)150 2109 y(and)c
(#F19628-96-C-016)o(1,)d(resp)q(ectiv)o(ely)m(.)212 2184
y(I)17 b(w)o(ould)f(also)g(lik)o(e)g(to)g(thank)h(the)g(Univ)o(ersit)o
(y)g(of)f(Cop)q(enhagen,)g(Lucen)o(t)i(T)m(ec)o(hnologies,)e(and)g(the)
h(Uni-)150 2259 y(v)o(ersit)o(y)h(of)e(Geno)o(v)n(a)h(for)g(supp)q
(orting)h(on)f(di\013eren)o(t)h(o)q(ccasions.)g(The)g(Univ)o(ersit)o(y)
f(of)g(Cop)q(enhagen)h(\(DIKU\))150 2333 y(pro)o(vided)12
b(funding)g(for)g(the)i(Region)d(Analysis)h(sc)o(ho)q(ol,)g(and)h(for)f
(a)g(one)h(w)o(eek)g(researc)o(h)i(visit)d(in)g(Cop)q(enhagen.)150
2408 y(Lucen)o(t)j(T)m(ec)o(hnologies)e(Bell-Lab)q(oratories)h(supp)q
(orted)i(me)c(during)i(a)g(most)f(enjo)o(y)o(able)g(summer)f(in)o
(ternship,)150 2483 y(and)18 b(also)g(pro)o(vided)g(funding)f(for)h(m)o
(y)e(attendance)k(of)d(the)i(Region)e(Analysis)h(sc)o(ho)q(ol.)g(The)g
(Univ)o(ersit)o(y)h(of)150 2558 y(Geno)o(v)n(a)13 b(\(DISI\))h(pro)o
(vided)g(funding)f(for)g(a)h(one)g(mon)o(th)e(researc)o(h)k(visit)d(in)
h(Geno)o(v)n(a.)1007 2795 y(viii)p eop
%%Page: 9 9
9 8 bop 659 418 a FL(T)-8 b(able)33 b(of)g(Con)m(ten)m(ts)150
685 y FG(1)38 b(In)o(tro)q(duction)11 b FF(:)6 b(:)j(:)f(:)h(:)g(:)g(:)
f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h
(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)
g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g
(:)f(:)h(:)g(:)g(:)f(:)h(:)48 b FG(1)150 745 y FI(1.1)i(Program)12
b(Generation)i(as)g(Meta-Programming)19 b(.)9 b(.)g(.)f(.)h(.)g(.)g(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)51
b(2)150 804 y(1.2)f(Meta-Programming)10 b(for)k(Optimization)i(.)8
b(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)51 b(7)150 864 y(1.3)f(P)o(artial)13
b(Ev)n(aluation)f(and)i(Multi-Lev)o(el)f(Languages)i(.)8
b(.)h(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
51 b(9)150 924 y(1.4)f(Multi-Stage)13 b(Programming)d(with)k(Explicit)f
(Annotations)18 b(.)9 b(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)30
b(11)150 984 y(1.5)50 b(Thesis)14 b(and)g(Con)o(tributions)21
b(.)9 b(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g
(.)g(.)f(.)h(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)30 b(12)150 1044 y(1.6)50 b(Organization)13 b(and)h(Reading)f
(Plans)i(.)8 b(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g
(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)30
b(13)p 150 1136 1770 2 v 150 1186 a FG(I)48 b(The)15
b(Practice)g(of)g(Multi-Stage)e(Programming)p 150 1216
V 150 1291 a(2)38 b(MetaML)16 b(and)f(Staging)e FF(:)c(:)f(:)h(:)g(:)g
(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)
h(:)g(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h
(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)24
b FG(18)150 1351 y FI(2.1)50 b(MetaML)14 b(the)h(Conceptual)f(F)m
(ramew)o(ork)6 b(.)h(.)h(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)
g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)30
b(18)150 1410 y(2.2)50 b(MetaML)14 b(the)h(Programmi)o(ng)c(Language)h
(.)c(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)30 b(20)150 1470 y(2.3)50
b(The)14 b(Pragmatics)f(of)g(V)m(ariables)g(and)h(Lev)o(els)9
b(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)g(.)g(.)f(.)h(.)30 b(24)150 1530 y(2.4)50
b(Staging)13 b(the)h(List-Mem)o(b)q(ership)g(F)m(unction)9
b(.)f(.)h(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)30 b(25)150 1590 y(2.5)50
b(Staging)13 b(the)h(P)o(o)o(w)o(er)g(F)m(unction)19
b(.)8 b(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)30
b(27)150 1650 y(2.6)50 b(Bac)o(k)14 b(and)g(F)m(orth:)f(Tw)o(o)g
(Useful)h(F)m(unctions)g(on)g(Co)q(de)g(T)o(yp)q(es)7
b(.)j(.)f(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)30 b(29)150
1709 y(2.7)50 b(Staging)13 b(the)h(Inner)h(Pro)q(duct:)f(A)g
(Three-Stage)h(Example)k(.)8 b(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)30 b(30)150 1811 y FG(3)38 b(Staging)14 b(a)i(Simple)d(T)l
(erm-Rewriting)g(Implemen)o(tati)o(on)f FF(:)d(:)f(:)h(:)g(:)g(:)f(:)h
(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)
g(:)f(:)h(:)24 b FG(34)150 1870 y FI(3.1)50 b(T)m(erm-Rewriting)8
b(.)e(.)j(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)30 b(34)150
1930 y(3.2)50 b(A)14 b(Single-Stage)f(Implemen)o(tation)k(.)9
b(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)30
b(35)150 1990 y(3.3)50 b(A)14 b(First)g(A)o(ttempt)f(at)h(Staging)22
b(.)8 b(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)30
b(39)150 2050 y(3.4)50 b(A)14 b(Second)g(A)o(ttempt)k(.)8
b(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)30 b(42)p 150 2142 V 150 2192
a FG(I)q(I)48 b(The)16 b(Theory)f(of)g(Multi-Stage)e(Programming)p
150 2222 V 150 2297 a(4)38 b(Ho)o(w)17 b(Do)e(W)l(e)h(Implemen)o(t)d
(MetaML?)i(Or,)h(the)f(Basic)g(Seman)o(tic)f(Concerns)d
FF(:)e(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)24 b FG(49)150
2357 y FI(4.1)50 b(Kno)o(wn)14 b(Concerns)8 b(.)i(.)f(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)30 b(49)150 2417 y(4.2)50 b(A)14 b(Simple)e(Approac)o(h)i
(to)g(Implemen)o(ting)d(a)i(F)m(unctional)g(Language)7
b(.)i(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)30 b(55)150 2476 y(4.3)50
b(Extending)14 b(the)g(Simple)e(Implemen)o(tation)f(with)j(Staging)f
(Annotations)g(.)c(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)g(.)g(.)f(.)h(.)30 b(61)150 2536 y(4.4)50 b(New)14
b(Concerns)j(.)8 b(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)
g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)30
b(65)150 2596 y(4.5)50 b(Co)o(v)o(ers:)14 b(A)g(Plausible)f(Solution)g
(to)g(the)i(Hidden)f(F)m(ree-V)m(ariables)g(Problem)6
b(.)h(.)i(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)30 b(67)150 2656 y(4.6)50 b(More)14 b(Concerns)23
b(.)9 b(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)30 b(69)1018
2795 y(ix)p eop
%%Page: 10 10
10 9 bop 150 192 a FG(5)38 b(Big-Step)14 b(Seman)o(tics,)f(T)o(yp)q(e)j
(Systems,)f(and)g(Closedness)d FF(:)6 b(:)j(:)g(:)g(:)f(:)h(:)g(:)g(:)f
(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)
24 b FG(74)150 251 y FI(5.1)50 b(A)14 b(Big-Step)g(Seman)o(tics)f(for)g
(CBV)i(and)f(CBN)g FF(\025)6 b FI(.)j(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)f
(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)30 b(74)150
311 y(5.2)50 b(A)14 b(Big-Step)g(Seman)o(tics)f(for)g(CBV)i
FF(\025)p FI(-M)g(.)9 b(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)30
b(76)150 371 y(5.3)50 b(A)14 b(Basic)g(T)o(yp)q(e)g(System)g(for)f
(MetaML)21 b(.)9 b(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)30
b(79)150 431 y(5.4)50 b(T)o(yp)q(e-Safet)o(y)14 b(.)9
b(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)
f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)30
b(82)150 490 y(5.5)50 b(A)14 b(Big-Step)g(Seman)o(tics)f(for)g(CBN)i
FF(\025)p FI(-M)g(.)9 b(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)30
b(85)150 550 y(5.6)50 b(A)14 b(Limitation)d(of)i(the)h(Basic)h(T)o(yp)q
(e)f(System:)f(Re-in)o(tegration)18 b(.)9 b(.)f(.)h(.)g(.)g(.)f(.)h(.)g
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)30 b(85)150 610 y(5.7)50 b(The)14 b FF(\025)363
595 y FE(BN)436 610 y FI(Language.)f(Or)i(Adding)e(Closedness)i(to)f
FF(\025)p FI(-M)g(.)9 b(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)30 b(88)150 670 y(5.8)50 b(Re\014ning)13 b(the)i(T)o(yp)q(es)e(.)8
b(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)30 b(95)150 729 y(5.9)50 b(Staging)13
b(the)h(P)o(o)o(w)o(er)g(F)m(unction)g(Revisited)23 b(.)9
b(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)g(.)g(.)f(.)h(.)30 b(96)150 789 y(5.10)f(The)14
b(Re\014ned)h(Metho)q(d)f(is)g(In)o(tuitiv)o(ely)f(App)q(ealing)j(.)9
b(.)f(.)h(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)30 b(98)150 891 y FG(6)38 b(Reduction)13 b(Seman)o(tics)21
b FF(:)9 b(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g
(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)
g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f
(:)h(:)g(:)g(:)f(:)h(:)24 b FG(99)150 950 y FI(6.1)50
b(A)14 b(Reduction)g(Seman)o(tics)f(for)g(CBN)i(and)e(CBV)i
FF(\025)k FI(.)9 b(.)f(.)h(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)g(.)g(.)f(.)h(.)30 b(99)150 1010 y(6.2)50 b(Extending)14
b(the)g(Reduction)g(Seman)o(tics)f(for)h FF(\025)20 b
FI(.)8 b(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)g(.)g(.)f(.)h(.)h(101)150 1070 y(6.3)50 b(In)o(tensional)13
b(Analysis)h(Con\015icts)g(with)f FF(\014)k FI(on)d(Ra)o(w)f(MetaML)h
(T)m(erms)24 b(.)9 b(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)h(101)150 1130 y(6.4)50
b(Lev)o(el-Annotated)14 b(MetaML)g(T)m(erms)f(and)h(Expression)h(F)m
(amilies)d(.)6 b(.)j(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)h(102)150
1189 y(6.5)50 b(Escap)q(es)15 b(Con\015ict)f(with)g FF(\014)i
FI(on)e(Annotated)g(MetaML)h(terms)h(.)9 b(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)h(103)150 1249 y(6.6)50 b(Substitution)14
b(Con\015icts)g(with)f FF(\014)k FI(on)c(Lev)o(el)h(0)g(Annotated)g(T)m
(erms)19 b(.)9 b(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)h(104)150 1309
y(6.7)50 b(A)14 b(Reduction)g(Seman)o(tics)f(for)g(CBN)i
FF(\025)p FI(-U)f(.)8 b(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)h(105)150
1369 y(6.8)50 b(Con\015uence)15 b(.)9 b(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)g(.)g(.)f(.)h(.)h(106)150 1429 y(6.9)50 b(The)14
b(Soundness)h(of)e(CBN)i FF(\025)p FI(-U)f(Reductions)g(under)h(CBN)f
FF(\025)p FI(-M)g(Big-Steps)9 b(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)h(109)p 150 1521 1770
2 v 150 1571 a FG(I)q(I)q(I)49 b(Appraisal)13 b(and)i(Recommendations)p
150 1601 V 150 1676 a(7)38 b(Discussion)13 b(and)i(Related)f(W)l(orks)f
FF(:)8 b(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)
g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f
(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)p
FG(122)150 1736 y FI(7.1)50 b(In)o(tro)q(duction)6 b(.)j(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)h(122)150 1795 y(7.2)50
b(P)o(art)14 b(I:)f(The)i(Practice)g(of)e(Multi-Stage)g(Programming)e
(.)e(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)h(127)150
1855 y(7.3)50 b(P)o(art)14 b(I)q(I:)f(The)i(Theory)f(of)f(Multi-Stage)g
(Programming)g(.)c(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)h(132)150 1915 y(7.4)50 b(On)14 b(the)g(History)g(of)g(Quotation)23
b(.)9 b(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)h(140)
150 2016 y FG(8)38 b(Conclusion)23 b FF(:)9 b(:)g(:)g(:)f(:)h(:)g(:)g
(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)
h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h
(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)
g(:)f(:)h(:)g(:)g(:)f(:)h(:)p FG(146)150 2076 y FI(8.1)50
b(Review)19 b(.)9 b(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)h(146)150 2136 y(8.2)50 b(Summary)11 b(of)i(Results)e(.)e
(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)
g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)
h(.)g(.)g(.)f(.)h(.)h(148)150 2196 y(8.3)50 b(Appraisal)13
b(of)g(Results)e(.)e(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)f(.)h(.)g
(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)
f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)h(148)150 2255
y(8.4)50 b(Op)q(en)15 b(Problems)e(and)g(Promising)f(Researc)o(h)j
(Directions)7 b(.)j(.)e(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f
(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
h(150)150 2357 y FG(A)26 b(A)16 b(Calculus)e(with)h(Lev)o(el)g
(Annotations)e FF(:)c(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)g(:)f
(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)
g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)p FG(153)150
2416 y FI(A.1)40 b(The)14 b FF(\025)p FI(-T)g(Language)j(.)8
b(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h
(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)
g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g(.)f(.)h(.)g(.)g
(.)f(.)h(.)g(.)g(.)f(.)h(.)h(153)150 2518 y FG(Bibliograp)o(h)o(y)c
FF(:)h(:)h(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g
(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)
h(:)g(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h
(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)p
FG(162)150 2619 y(Biographical)k(Note)19 b FF(:)9 b(:)g(:)g(:)f(:)h(:)g
(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)
f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f
(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)g(:)g(:)f(:)h(:)
g(:)g(:)f(:)h(:)p FG(170)1024 2795 y FI(x)p eop
%%Page: 11 11
11 10 bop 850 443 a FL(Abstract)705 685 y FD(Multi-Stage)18
b(Programming:)689 760 y(Its)g(Theory)g(and)h(Applications)894
911 y(W)-5 b(alid)19 b(T)-5 b(aha)608 1061 y(Sup)r(ervising)17
b(Professor:)h(Tim)f(Sheard)212 1327 y FI(MetaML)f(is)g(a)f(statically)
f(t)o(yp)q(ed)j(functional)d(programming)e(language)j(with)g(sp)q
(ecial)h(supp)q(ort)g(for)f(pro-)150 1402 y(gram)h(generation.)i(In)g
(addition)e(to)i(pro)o(viding)e(the)j(standard)f(features)h(of)e(con)o
(temp)q(orary)h(programmi)o(ng)150 1477 y(languages)d(suc)o(h)i(as)f
(Standard)g(ML,)f(MetaML)h(pro)o(vides)g(three)h(staging)e
(annotations.)g(These)i(staging)e(an-)150 1552 y(notations)e(allo)o(w)g
(the)h(construction,)h(com)o(bination,)10 b(and)k(execution)h(of)e(ob)r
(ject-programs.)212 1626 y(Our)18 b(thesis)g(is)g(that)f(MetaML's)h
(three)h(staging)d(annotations)h(pro)o(vide)g(a)g(useful,)g
(theoretically)h(sound)150 1701 y(basis)12 b(for)h(building)e(program)f
(generators.)k(This)e(dissertation)h(rep)q(orts)h(on)e(our)g(study)h
(of)f(MetaML's)h(staging)150 1776 y(constructs,)20 b(their)f(use,)g
(their)g(implem)o(en)o(tation,)c(and)j(their)h(formal)d(seman)o(tics.)i
(Our)h(results)h(include)e(an)150 1850 y(extended)h(example)d(of)g
(where)j(MetaML)e(allo)o(ws)f(us)i(to)f(pro)q(duce)h(e\016cien)o(t)g
(programs,)d(an)i(explanation)g(of)150 1925 y(wh)o(y)h(implemen)o(ting)
d(these)k(constructs)h(in)e(traditional)f(w)o(a)o(ys)h(can)g(b)q(e)h(c)
o(hallenging,)d(t)o(w)o(o)i(form)o(ulations)e(of)150
2000 y(MetaML's)h(seman)o(tics,)e(a)h(t)o(yp)q(e)h(system)g(for)f
(MetaML,)g(and)g(a)g(prop)q(osal)g(for)h(extending)f(MetaML)h(with)f(a)
150 2075 y(t)o(yp)q(e)e(construct)i(for)d(closedness.)212
2149 y(The)23 b(dissertation)g(consolidates)g(a)f(n)o(um)o(b)q(er)g(of)
g(previous)h(publications)e(b)o(y)i(the)g(author,)f(including)150
2224 y(MetaML's)16 b(t)o(yp)q(e)g(systems)g(and)f(big-step)h(seman)o
(tics.)e(The)i(presen)o(tation)h(is)e(new.)g(The)h(prop)q(osed)h
(solution)150 2299 y(to)12 b(an)g(implemen)o(tation)d(problem)i(and)h
(the)h(reduction)g(seman)o(tics)f(for)g(MetaML's)h(three)g(staging)f
(constructs)150 2373 y(are)i(also)g(new.)1018 2795 y(xi)p
eop
%%Page: 1 12
1 11 bop 822 436 a FL(Chapter)31 b(1)768 662 y(In)m(tro)s(duction)1099
859 y FC(If)14 b(thought)d(c)n(orrupts)h(language,)1099
918 y(language)f(c)n(an)i(also)f(c)n(orrupt)g(thought.)1270
1011 y(Politics)f(and)i(the)g(English)e(L)n(anguage)p
FB(,)1609 1070 y(George)i(Orw)o(ell)150 1250 y FI(Program)f(generation)
j(is)e(a)h(p)q(o)o(w)o(erful)f(and)h(p)q(erv)n(asiv)o(e)g(tec)o(hnique)
h(for)f(the)g(dev)o(elopmen)o(t)f(of)g(soft)o(w)o(are.)h(It)g(has)150
1325 y(b)q(een)e(used)g(to)f(impro)o(v)o(e)f(co)q(de)i(reuse,)g(pro)q
(duct)g(reliabilit)o(y)d(and)i(main)o(tainabil)o(it)o(y)l(,)d(p)q
(erformance)j(and)g(resource)150 1399 y(utilization,)i(and)h(dev)o
(elop)q(er)i(pro)q(ductivit)o(y)f([43,)5 b(84,)h(87,)g(92].)14
b(Despite)h(the)g(success)j(of)c(program)f(generation,)150
1474 y(there)18 b(has)e(b)q(een)i(little)e(sp)q(ecial)h(supp)q(ort)g
(for)f FH(writing)f FI(generators)j(in)e(high-lev)o(el)g(programmi)o
(ng)d(languages)150 1549 y(suc)o(h)i(as)f(C++,)g(Ja)o(v)n(a,)f
(Standard)h(ML)g(\(SML\))h(or)f(Hask)o(ell.)f(A)h(host)h(of)e(fundamen)
o(tal)f(problems)h(inheren)o(t)i(in)150 1624 y(program)d(generation)i
(can)g(b)q(e)g(addressed)i(e\013ectiv)o(ely)e(b)o(y)g(a)f(programming)d
(language)j(designed)i(sp)q(eci\014cally)150 1698 y(to)f(supp)q(ort)h
(writing)f(program)e(generators.)j(MetaML)g(is)f(a)g(no)o(v)o(el)f
(example)g(of)h(suc)o(h)h(a)f(meta-programm)o(i)o(ng)150
1773 y(language.)j(This)h(dissertation)g(sho)o(ws)h(that)f(MetaML)g(is)
g(a)g(concise)h(and)f(expressiv)o(e)i(meta-programm)o(i)o(ng)150
1848 y(language)13 b(based)i(on)e(a)h(solid)f(formal)e(foundation.)150
1931 y(This)17 b(c)o(hapter)i(b)q(egins)e(b)o(y)g(explaining)f(the)i
(need)h(for)e(sp)q(ecial)g(language)g(constructs)i(to)e(supp)q(ort)i
(program)150 2005 y(generation)14 b(and)h(meta-programm)n(ing,)10
b(and)15 b(the)f(role)h(of)e(MetaML)i(in)f(this)g(con)o(text.)h(T)m(o)e
(outline)h(the)h(scop)q(e)150 2080 y(of)c(this)g(dissertation,)g(w)o(e)
553 2065 y FA(1)583 2080 y FI(presen)o(t)i(a)e(basic)g
(classi\014cation)g(of)g(meta-programm)o(i)o(ng)d(that)k(distinguishes)
f(what)150 2155 y(w)o(e)17 b(call)g(m)o(ulti-stage)e(programming)f
(from)h(other)j(kinds)f(of)g(meta-programm)n(ing.)c(W)m(e)k(relate)h(m)
o(ulti-stage)150 2230 y(programming)c(to)k(partial)f(ev)n(aluation)g
(and)h(m)o(ulti-lev)o(el)d(languages,)i(state)i(our)f(thesis,)g(and)g
(preview)g(the)150 2304 y(organization)13 b(of)g(this)h(dissertation.)p
150 2385 237 2 v 158 2412 a Fz(1)188 2427 y FB(In)c(this)h
(dissertation,)i(I)c(use)i(\\w)o(e")f(to)g(refer)g(primarily)j(to)d(m)o
(yself.)g(Readers)h(are)f(encouraged)i(to)e(include)i(themselv)o(es)188
2473 y(in)i(this)g(reference)f(at)g(their)h(discretion.)1025
2795 y FI(1)p eop
%%Page: 2 13
2 12 bop 1901 0 a FB(2)150 192 y FD(1.1)56 b(Program)17
b(Generation)h(as)h(Meta-Programming)150 309 y FH(Meta-pr)n(o)n(gr)n
(ams)13 b FI(are)i(programs)d(that)i(manipulate)e(other)j(programs.)d
FH(Obje)n(ct-pr)n(o)n(gr)n(ams)h FI(are)h(programs)f(ma-)150
384 y(nipulated)c(b)o(y)h(other)g(programs.)e FH(Pr)n(o)n(gr)n(am)j
(gener)n(ators)e FI(are)h(meta-programs)e(that)i(pro)q(duce)h(ob)r
(ject-programs)150 459 y(as)i(their)h(\014nal)f(result.)g
FH(MetaML)h FI(is)f(a)g(general-purp)q(ose)i(programmi)o(ng)10
b(language)j(designed)h(so)f(that)g(ob)r(ject-)150 534
y(programs)h(can)h(b)q(e)g(manipulated)e(in)i(b)q(oth)g(a)g(concise)h
(and)e(t)o(yp)q(e-safe)i(manner.)d(The)j(notion)e(of)g(t)o(yp)q
(e-safet)o(y)150 608 y(of)f(MetaML)g(is)h(strong:)f(Not)g(only)g(is)g
(a)g(meta-program)d(guaran)o(teed)k(to)f(b)q(e)h(free)g(of)f(run-time)f
(errors,)i(but)g(so)150 683 y(are)i(all)e(of)g(its)h
FH(obje)n(ct-pr)n(o)n(gr)n(ams)p FI(.)f(F)m(urthermore,)h(b)q(ecause)i
(MetaML's)e(meta-programm)o(i)o(ng)d(constructs)18 b(are)150
758 y(b)q(oth)13 b(concise)g(and)g(expressiv)o(e,)h(it)e(facilitates)g
(a)g(p)q(o)o(w)o(erful)g(metho)q(d)g(of)g(dev)o(eloping)g
(meta-programs)e(that)j(w)o(e)150 832 y(call)g(m)o(ulti-stage)f
(programming)o(.)150 915 y(MetaML)g(pro)o(vides)f(the)i(user)f(with)f
(constructs)j(for)d(building,)e(com)o(bining)g(and)j(executing)g(ob)r
(ject-programs,)150 990 y(all)18 b(within)g(the)i(same)e(statically-t)o
(yp)q(ed)g(language)g(and)h(within)f(the)i(same)e(run-time)g(en)o
(vironmen)o(t.)g(The)150 1065 y(b)q(ene\014ts)f(of)d(MetaML)i(can)f(b)q
(e)h(illustrated)f(b)o(y)g(con)o(trasting)g(meta-programm)o(i)o(ng)d
(in)j(MetaML)g(with)g(meta-)150 1140 y(programming)7
b(in)j(a)g(mainstream)f(general-purp)q(ose)i(language.)f(In)g
(particular,)g(MetaML)h(constitutes)h(a)f(clear)150 1214
y(impro)o(v)o(emen)o(t)h(o)o(v)o(er)j(a)f(p)q(opular)h(general-purp)q
(ose)h(language)e(along)f(the)j(follo)o(wing)c(qualitativ)o(e)h
(dimensions)150 1289 y(of)g(meta-programm)o(ing)d(language)j(design:)
168 1387 y(1.)20 b(Supp)q(ort)14 b(for)f(syn)o(tactic)i(correctness)i
(and)d(conciseness)i(in)d(sp)q(ecifying)h(ob)r(ject-programs,)168
1458 y(2.)20 b(Supp)q(ort)14 b(for)f(t)o(yp)q(e)i(correctness)i(of)c
(ob)r(ject-programs,)168 1529 y(3.)20 b(E\016cien)o(t)14
b(com)o(bination)d(of)i(ob)r(ject-programs,)168 1599
y(4.)20 b(Seman)o(tic)12 b(correctness)17 b(of)c(ob)r(ject-programs,)g
(and)168 1670 y(5.)20 b(Supp)q(ort)14 b(for)f(staging-correctness.)150
1772 y(In)20 b(addition,)e(MetaML)i(enjo)o(ys)g(t)o(w)o(o)f(desirable)h
(re\015ectiv)o(e)h(prop)q(erties.)g(In)f(the)g(rest)h(of)e(this)h
(section,)g(w)o(e)150 1846 y(elab)q(orate)14 b(on)g(eac)o(h)g(of)f
(these)j(design)e(dimensions)e(and)i(on)g(where)h(MetaML)f(lies)g(in)f
(this)h(design)g(space.)150 1989 y FG(Syn)o(tactic)22
b(Correctness)g(and)h(Conciseness:)28 b FI(In)21 b(a)g(general-purp)q
(ose)h(language,)d(fragmen)o(ts)h(of)g(an)150 2064 y(ob)r(ject-program)
13 b(are)h(t)o(ypically)e(enco)q(ded)j(using)e(either)i(strings)f(or)g
(datat)o(yp)q(es.)f(With)g(the)h(string)g(enco)q(ding,)150
2139 y(w)o(e)20 b(represen)o(t)i(the)e(co)q(de)g(fragmen)o(t)e
FE(f)i(\(x,y\))f FI(simply)f(as)i FE(\\f)f(\(x,y\)")p
FI(.)g(While)f(constructing)j(and)e(com)o(bining)150
2213 y(fragmen)o(ts)g(represen)o(ted)k(b)o(y)c(strings)i(can)f(b)q(e)g
(done)g(concisely)m(,)g(deconstructing)h(them)e(is)h(quite)g(v)o(erb)q
(ose.)150 2288 y(More)12 b(seriously)m(,)g(there)h(is)e(no)h
FH(automatic)n(al)r(ly)h(veri\014able)i FI(guaran)o(tee)d(that)g
(programs)f(th)o(usly)g(constructed)k(are)150 2363 y(syn)o(tactically)c
(correct.)j(F)m(or)d(example,)g FE(\\f)g(\(,y\)")h FI(can)g(ha)o(v)o(e)
g(the)h(static)f(t)o(yp)q(e)h FE(string)p FI(,)f(but)g(this)g(clearly)g
(do)q(es)h FH(not)150 2438 y FI(imply)e(that)j(this)g(string)g
(represen)o(ts)j(a)c(syn)o(tactically)h(correct)h(program.)150
2521 y(With)e(the)i(datat)o(yp)q(e)f(enco)q(ding,)g(w)o(e)h(can)f
(address)h(the)g(syn)o(tactic)g(correctness)i(problem.)12
b(Without)h(an)o(y)h(loss)150 2595 y(of)e(generalit)o(y)m(,)g(let)h(us)
h(consider)f(SML)g([49,)6 b(72,)g(67])12 b(as)h(a)g(t)o(ypical)f
(general-purp)q(ose)i(language.)e(A)h(datat)o(yp)q(e)g(to)150
2670 y(represen)o(t)j(ob)r(ject-programs)e(can)g(b)q(e)g(de\014ned)h
(in)f(SML)f(as)h(follo)o(ws:)p eop
%%Page: 3 14
3 13 bop 1901 0 a FB(3)221 195 y FE(datat)o(yp)q(e)15
b(exp)g(=)f(V)o(a)o(riable)g(of)f(string)458 260 y Fy(j)34
b FE(Apply)14 b(of)g(\(exp)h(*)e(exp\))458 325 y Fy(j)34
b FE(T)m(uple)15 b(of)e(exp)i(list)458 390 y Fy(j)34
b FE(F)o(unction)15 b(of)e(string)h(*)f(exp.)150 478
y FI(This)f(datat)o(yp)q(e)h(declaration)f(implem)o(en)o(ts)f(the)h
(set)i(of)d(represen)o(tations)k(of)c(ob)r(ject-programs)h(de\014ned)h
(b)o(y)f(the)150 553 y(follo)o(wing)f(BNF)k(rule:)659
656 y FF(exp)c FI(:=)g FF(x)h Fy(j)f FF(exp)g(exp)h Fy(j)f
FI(\()p FF(exp;)c(:::;)g(exp)p FI(\))i Fy(j)i FF(\025x:exp)150
760 y FI(where)18 b FF(x)f FI(is)g(dra)o(wn)g(from)e(a)h(set)i(of)f
(iden)o(ti\014ers.)g(In)g(the)h(datat)o(yp)q(e)f(the)g(set)h(of)f(iden)
o(ti\014ers)g(is)g(implemen)o(ted)150 835 y(b)o(y)e(the)i(set)f(of)f
(SML)h(strings.)f(Th)o(us,)h(the)g(datat)o(yp)q(e)g(enco)q(ding)g(is)f
(essen)o(tially)h(the)g(same)f(as)g(what)h(is)f(called)150
909 y(\\abstract)g(syn)o(tax")e(or)h(\\parse)g(trees".)h(The)g(enco)q
(ding)f(of)f(the)h(fragmen)o(t)f FE(f)g(\(x,y\))h FI(in)g(this)g(SML)g
(datat)o(yp)q(e)g(is:)221 1000 y FE(Apply)g(\(V)o(a)o(riable)g(\\f)s
(",T)m(uple)g([V)o(a)o(riable)g(\\x")f(,V)o(a)o(riable)h(\\y"]\).)150
1088 y FI(Using)f(a)f(datat)o(yp)q(e)h(enco)q(ding)g(has)g(an)g
(immedia)o(te)e(b)q(ene\014t:)i FH(c)n(orr)n(e)n(ct)g(typing)k
FI(for)c(the)g(meta-program)d(ensures)150 1163 y FH(c)n(orr)n(e)n(ct)16
b(syntax)22 b FI(for)15 b(all)g(ob)r(ject-programs.)g(Because)j(SML)e
(supp)q(orts)i(pattern)e(matc)o(hing)f(o)o(v)o(er)h(datat)o(yp)q(es,)
150 1238 y(deconstructing)11 b(programs)e(b)q(ecomes)h(easier)h(than)f
(with)g(the)g(string)g(represen)o(tation.)h(Ho)o(w)o(ev)o(er,)f
(constructing)150 1312 y(programs)j(is)g(no)o(w)h(more)f(v)o(erb)q
(ose.)150 1395 y(In)20 b(con)o(trast,)h(MetaML)f(pro)o(vides)h(a)f
(construct)i(called)d(Brac)o(k)o(ets)j(that)e(allo)o(ws)f(us)i(to)f(sp)
q(ecify)h(this)f(co)q(de)150 1470 y(fragmen)o(t)c(as)i
Fy(h)q FE(f)f(\(x,y\))p Fy(i)h FI(\(read)h FH(\\Br)n(acket)f
FF(f)24 b FH(of)18 b FF(x)h FH(c)n(omma)f FF(y)q FH(")p
FI(\).)h(This)f(enco)q(ding)g(com)o(bines)f(the)h(simplicit)o(y)150
1545 y(and)d(conciseness)i(of)d(the)i(string)f(enco)q(ding)g(and)f(the)
i(strength)g(of)e(the)i(datat)o(yp)q(e)f(enco)q(ding,)f(in)h(that)g
(suc)o(h)g(a)150 1619 y(Brac)o(k)o(eted)f(expression)f(is)f(accepted)h
(b)o(y)f(the)h(parser)g(of)e(MetaML)i(only)e(as)h(long)f(as)h(what)g
(is)g(con)o(tained)g(in)f(the)150 1694 y(Brac)o(k)o(ets)16
b(has)g(correct)g(syn)o(tax.)f(In)g(other)h(w)o(ords,)e(with)h(MetaML,)
g FH(c)n(orr)n(e)n(ct)g(syntax)20 b FI(for)15 b(the)h(meta-program)150
1769 y(ensures)g FH(c)n(orr)n(e)n(ct)e(syntax)19 b FI(for)14
b(all)e(ob)r(ject-programs.)150 1914 y FG(T)o(yp)q(e)19
b(Correctness:)24 b FI(Ev)o(en)18 b(when)f(syn)o(tax)g(errors)h(are)g
(a)o(v)o(oided)e(b)o(y)h(using)g(a)g(datat)o(yp)q(e)g(represen)o
(tation,)150 1989 y(there)e(is)f(no)f(protection)h(against)f
(constructing)i(ill-formed)c(programs)h(that)i(con)o(tain)g(t)o(yp)q(e)
g(errors,)g(as)g(in)f(the)150 2063 y(case)i(with)e(the)i(fragmen)o(t)d
FE(\(a,b\))i(\(c,d\))p FI(.)g(In)g(particular,)f(with)h(the)g(datat)o
(yp)q(e)g(enco)q(ding,)g(all)e(ob)r(ject-programs)150
2138 y(are)g(represen)o(ted)i(b)o(y)e(one)f(t)o(yp)q(e,)h
FE(exp)p FI(,)g(whic)o(h)g(do)q(es)g(not)f(pro)o(vide)h(us)g(with)f(an)
o(y)g(information)e(ab)q(out)i(the)h FH(typ)n(e)h(of)150
2213 y(the)i(obje)n(ct-pr)n(o)n(gr)n(am)e(r)n(epr)n(esente)n(d)i(by)f
(an)i FE(exp)p FI(.)e(The)g(string)g(enco)q(ding)f(su\013ers)j(the)e
(same)f(problem.)f(MetaML)150 2288 y(tak)o(es)20 b(adv)n(an)o(tage)f
(of)g(a)g(simple)f(t)o(yp)q(e)j(theoretic)f(device,)g(namely)m(,)d(the)
k FH(p)n(ar)n(ametric)e(typ)n(e)h(c)n(onstructor)p FI(.)f(A)150
2362 y(common)9 b(example)h(of)h(a)g(parametric)g(t)o(yp)q(e)h
(constructor)h(in)e(SML)h(is)f FE(list)p FI(,)g(whic)o(h)h(allo)o(ws)e
(us)i(to)f(ha)o(v)o(e)h(lists)f(with)150 2437 y(elemen)o(ts)k(of)g
(di\013eren)o(t)h(t)o(yp)q(es,)g(suc)o(h)g(as)g FE([1,2,3,4])c
FI(and)k FE(['a','b','c'])p FI(,)11 b(whic)o(h)16 b(ha)o(v)o(e)f(t)o
(yp)q(e)h FE(int)f(list)g FI(and)h FE(cha)o(r)g(list)p
FI(,)150 2512 y(resp)q(ectiv)o(ely)m(.)g(In)f(MetaML,)h(w)o(e)f(use)i
(a)e(parametric)f(t)o(yp)q(e)i(constructor)h Fy(h)p 1342
2512 13 2 v 15 w(i)f FI(for)f(co)q(de)1532 2497 y FA(2)1551
2512 y FI(.)g(Th)o(us,)g Fy(h)q FE(1)p Fy(i)g FI(has)g(t)o(yp)q(e)p
150 2582 237 2 v 158 2608 a Fz(2)188 2624 y FB(Note)g(that)f(unlik)o(e)
j(the)d(t)o(yp)q(e)h(constructor)g(for)g(lists,)g(the)g(MetaML)f(co)q
(de)h(t)o(yp)q(e)g(constructor)h FC(c)n(annot)c FB(b)q(e)i(declared)188
2670 y(as)g(a)f(datat)o(yp)q(e)h(in)f(SML.)g(W)m(e)h(expand)g(on)f
(this)h(p)q(oin)o(t)g(in)g(Section)h(7.1.3.)p eop
%%Page: 4 15
4 14 bop 1901 0 a FB(4)150 192 y Fy(h)p FE(int)p Fy(i)13
b FI(\(read)h FH(\\c)n(o)n(de)g(of)g(int")p FI(\),)f
Fy(h)p FE('b')p Fy(i)g FI(has)g(t)o(yp)q(e)g Fy(h)p FE(cha)o(r)p
Fy(i)q FI(,)f(and)h Fy(h)p FE(fn)g(x)g Fy(\))f FE(x)p
Fy(i)h FI(has)g(t)o(yp)q(e)h Fy(h)p FE('a)e Fy(!)g FE('a)p
Fy(i)p FI(.)g(As)i(w)o(e)f(will)e(sho)o(w)150 266 y(in)i(this)h
(dissertation,)g(with)g(MetaML,)f FH(c)n(orr)n(e)n(ct)h(typing)k
FI(for)13 b(the)i(meta-program)c(ensures)16 b FH(c)n(orr)n(e)n(ct)d
(typing)18 b FI(for)150 341 y(all)13 b(ob)r(ject-programs.)150
491 y FG(E\016cien)o(t)j(Com)o(bination)e(and)j(Op)q(erational)e(Con)o
(trol:)21 b FI(When)15 b(constructing)i(the)f(represen)o(tation)h(of)
150 565 y(an)12 b(ob)r(ject-program,)e(it)i(is)g(p)q(ossible)g(to)f
(iden)o(tify)h(instances)h(where)g(part)f(of)f(the)i(program)d(b)q
(eing)i(constructed)150 640 y(can)i(b)q(e)h(p)q(erformed)e(immediately)
l(.)e(F)m(or)i(example,)f(consider)j(the)f(meta-program:)221
736 y Fy(h)p FE(fn)g(x)g Fy(\))f FE(\(fn)h(y)g Fy(\))f
FE(\(y)m(,y\)\))h(x)p Fy(i)p FE(.)150 829 y FI(This)e(meta-program)c
(ev)n(aluates)k(to)g(itself,)f(as)h(do)q(es)g(a)f(quoted)h(string.)g
(But)g(note)g(that)g(it)f(con)o(tains)h(an)f(ob)r(ject-)150
904 y(lev)o(el)16 b(application)f(that)i(do)q(es)g(not)g(dep)q(end)h
(on)e(an)o(y)g(unkno)o(wn)g(information.)d(W)m(e)k(can)f(mo)q(dify)f
(this)h(meta-)150 979 y(program)g(sligh)o(tly)h(so)g(that)h(the)h
(application)d(is)h(done)i(while)e(the)h(ob)r(ject-program)f(is)h(b)q
(eing)f FH(c)n(onstructe)n(d)p FI(,)150 1054 y(rather)h(than)g(while)f
(the)h(ob)r(ject-program)e(is)i(b)q(eing)f FH(exe)n(cute)n(d)p
FI(.)h(This)f(mo)q(di\014cation)e(can)j(b)q(e)g(accomplished)150
1128 y(using)13 b(the)i(another)f(MetaML)g(construct)h(called)e(Escap)q
(e)i(that)f(allo)o(ws)e(us)i(to)g(incorp)q(orate)g(a)f(co)q(de)h
(fragmen)o(t)150 1203 y(in)f(the)i(con)o(text)g(of)e(a)g(bigger)h(co)q
(de)h(fragmen)o(t.)d(The)i(impro)o(v)o(ed)e(meta-program)f(is:)221
1299 y Fy(h)p FE(fn)j(x)g Fy(\))g FE(~)q(\(\(fn)g(y)g
Fy(\))g(h)p FE(\()q(~)q(y)m(,)q(~y\))p Fy(i)q FE(\))g
Fy(h)p FE(x)p Fy(i)p FE(\))p Fy(i)p FE(.)150 1392 y FI(When)f(this)h
(impro)o(v)o(ed)d(meta-program)f(is)j(ev)n(aluated,)g(some)f(useful)h
(w)o(ork)g(will)f(b)q(e)h(done.)g(The)h(ev)n(aluation)e(of)150
1467 y(this)i(term)f(pro)q(ceeds)j(as)e(follo)o(ws:)168
1580 y(1.)20 b Fy(h)p FE(fn)14 b(x)g Fy(\))g FE(~)q Fy(h)p
FE(\()q(~)q Fy(h)q FE(x)p Fy(i)p FE(,)q(~)p Fy(h)q FE(x)p
Fy(i)p FE(\))p Fy(ii)g FI(...)f(The)h(application)e(is)i(p)q(erformed.)
168 1652 y(2.)20 b Fy(h)p FE(fn)14 b(x)g Fy(\))g FE(~)q
Fy(h)p FE(\(x,x\))p Fy(ii)g FI(...)f(The)h(Escap)q(ed)i
Fy(h)p FE(x)p Fy(i)p FI(s)e(are)h(spliced)f(in)o(to)f(con)o(text.)168
1725 y(3.)20 b Fy(h)p FE(fn)14 b(x)g Fy(\))f FE(\(x,x\))p
Fy(i)h FI(...)f(The)h(Escap)q(ed)h Fy(h)p FE(\(x,x\))p
Fy(i)f FI(is)g(spliced)g(in)o(to)g(con)o(text.)150 1840
y(In)h(the)h(presence)i(of)d(recursion)h(in)f(the)h(meta-language,)d
(Escap)q(es)k(allo)o(w)d(us)h(to)h(p)q(erform)e(more)g(substan)o(tial)
150 1914 y(computations)f(while)g(constructing)i(the)f(\014nal)g
(result,)g(th)o(us)g(yielding)f(more)g(e\016cien)o(t)h(ob)r
(ject-programs.)150 1997 y(Escaping)d(can)g(b)q(e)g(done)g(with)f(b)q
(oth)h(string)f(and)h(datat)o(yp)q(e)f(enco)q(dings)i(easily)e(as)g
(long)g(as)h(the)g(ob)r(ject-program)150 2072 y(is)j(not)g(itself)f(a)h
(meta-program,)c(in)k(whic)o(h)f(case)i(Escaping)f(gets)h(more)e(in)o
(v)o(olv)o(ed.)150 2222 y FG(Seman)o(tic)j(Correctness:)23
b FI(With)15 b(b)q(oth)i(string)f(and)g(datat)o(yp)q(e)h(enco)q(dings,)
f(ensuring)h(that)f(there)i(are)e(no)150 2296 y(name)f(clashes)i(or)f
(inadv)o(erten)o(t)h(v)n(ariable)e(captures)j(is)e(the)h(resp)q
(onsibilit)o(y)f(of)f(the)i(meta-programm)o(er.)c(F)m(or)150
2371 y(example,)d(consider)j(writing)e(a)g(simple)f(program)h
(transformation)e FE(T)j FI(that)g(tak)o(es)g(an)g(ob)r(ject-lev)o(el)g
(arithmetic)150 2446 y(expression)20 b(and)e(returns)i(another)f(ob)r
(ject-lev)o(el)g(function)g(that)f(adds)h(the)g(arithmetic)f
(expression)i(to)e(its)150 2521 y(argumen)o(ts.)12 b(F)m(or)h(example,)
f(for)h(an)h(ob)r(ject-program)e FE(1+5)h FI(w)o(e)h(get)g(an)f(ob)r
(ject-program)g FE(fn)g(x)h Fy(\))f FE(x)h(+)f(\(1+5\))p
FI(.)150 2595 y(Similarly)l(,)h(for)j FE(y+z)h FI(w)o(e)f(get)h
FE(fn)f(x)g Fy(\))g FE(x)h(+)f(\(y+z\))p FI(.)h(It)f(ma)o(y)e(seem)i
(that)h(w)o(e)f(can)h(implem)o(en)o(t)d(this)j(program)150
2670 y(transformation)12 b(as:)p eop
%%Page: 5 16
5 15 bop 1901 0 a FB(5)221 195 y FE(fun)14 b(T)g(e)g(=)g(F)o(unction)h
(\(\\x",)e(Apply)i(\(V)o(a)o(riable)f(\\+",)f(T)m(uple)i([V)o(a)o
(riable)f(\\x",)f(e]\)\).)150 297 y FI(But)h(this)g(implemen)o(tation)c
(is)k(probably)f(\015a)o(w)o(ed.)g(In)h(particular,)f(for)h
FE(y+x)g FI(w)o(e)g(get)g FE(fn)g(x)g Fy(\))f FE(x)h(+)g(\(y+x\))p
FI(.)g(This)150 371 y(result)i(is)f(not)g(what)g(w)o(e)g(w)o(ould)g(ha)
o(v)o(e)g(exp)q(ected)i(if)d(w)o(e)i(had)f(assumed)g(that)g
FE(x)g FI(is)g(just)g(a)g(\\dumm)o(y)d(v)n(ariable")150
446 y(that)g(will)e(nev)o(er)j(app)q(ear)g(in)e(the)i(argumen)o(t)e(to)
g FE(T)p FI(.)h(In)g(this)g(case,)h(w)o(e)f(sa)o(y)f(that)h
FE(x)h FI(w)o(as)e FH(inadvertently)i(c)n(aptur)n(e)n(d)p
FI(.)150 521 y(As)k(w)o(e)g(will)e(see)j(in)e(this)h(dissertation,)f
(inadv)o(erten)o(t)h(capture)h(b)q(ecomes)f(an)f(esp)q(ecially)h
(subtle)g(problem)e(in)150 595 y(the)f(presence)j(of)c(recursion.)150
678 y(The)h FH(intende)n(d)h FI(function)e FE(T)i FI(can)f(b)q(e)g
(de\014ned)h(in)f(MetaML)g(as:)221 785 y FE(fun)g(T)g(e)g(=)g
Fy(h)q FE(fn)g(x)g Fy(\))f FE(x+)q(~)q(e)p Fy(i)q FE(.)150
886 y FI(Not)j(only)f(is)h(this)g(de\014nition)g(more)f(concise)i(than)
f(the)h(one)f(ab)q(o)o(v)o(e,)g(it)g(has)g(simpler)f(seman)o(tics:)g
FE(x)h FI(is)g FH(never)150 961 y FI(captured)e(b)o(y)f(the)g(result)h
(of)e(\\splicing-in")f FE(e)p FI(,)h(b)q(ecause)j(the)e(run-time)f
(system)h(ensures)h(that)f(all)f(o)q(ccurrences)150 1035
y(of)e FE(x)h FI(ha)o(v)o(e)g(the)h(exp)q(ected)h(static-scoping)e
(seman)o(tics.)f(Inadv)o(erten)o(t)i(capture)g(is)f(a)o(v)o(oided)f(in)
h(MetaML)g(b)q(ecause)150 1110 y(the)j(language)e(is)h(completely)f
(statically)g(scop)q(ed,)i(ev)o(en)g(with)f(resp)q(ect)i(to)e(ob)r
(ject-lev)o(el)h(v)n(ariables.)e(This)h(w)o(a)o(y)m(,)150
1185 y(naming)f(issues)k(that)e(arise)h(with)f(co)q(de)h(generation)f
(are)h(automatically)d(managed)g(b)o(y)i(MetaML's)h(run-time)150
1260 y(system.)150 1417 y FG(Staging-Correctne)o(ss:)k
FI(With)c(b)q(oth)g(string)g(and)f(datat)o(yp)q(e)h(enco)q(dings,)h
(care)f(m)o(ust)f(b)q(e)i(tak)o(en)f(to)f(ensure)150
1492 y(that)e(no)g(meta-program)d(tries)k(to)f(use)h(a)e(v)n(ariable)g
(b)q(elonging)g(to)h(one)h(of)e(its)h(ob)r(ject-programs.)f(F)m(or)h
(example,)150 1567 y(if)i(w)o(e)i(generate)g(a)f(program)e(that)i(uses)
i(a)e(lo)q(cal)f(v)n(ariable)g FE(x)p FI(,)h(w)o(e)g(w)o(ould)f(lik)o
(e)h(to)g(ensure)h(that)f(the)h(generator)150 1641 y(itself)c(do)q(es)i
(not)e(attempt)g(to)h(\\use")g(the)g(v)n(ariable)f FE(x)p
FI(,)g(whic)o(h)h(will)e(not)i(b)q(ecome)f(b)q(ound)h(to)g(an)o(ything)
f(un)o(til)f(the)150 1716 y(run-time)j(of)h(the)h(generated)g(program.)
e(T)m(o)g(b)q(egin)i(addressing)g(suc)o(h)g(problems,)d(w)o(e)j(m)o
(ust)e(de\014ne)j(a)e(notion)150 1791 y(of)d(lev)o(el.)g(The)h(lev)o
(el)f(of)h(a)f(term)g(is)h(the)g(n)o(um)o(b)q(er)f(of)g(surrounding)h
(Brac)o(k)o(ets)h(less)f(the)h(n)o(um)o(b)q(er)e(of)g(surrounding)150
1866 y(Escap)q(es.)j(F)m(or)d(example,)g(the)i(term)e
Fy(h)p FE(fn)i(x)f Fy(\))h FE(~)q(x)p Fy(i)f FI(is)g(not)h(correct)g
(from)e(the)i(staging)e(p)q(oin)o(t)h(of)g(view,)f(b)q(ecause)150
1940 y(the)j(v)n(ariable)e FE(x)i FI(is)f(b)q(ound)g(at)h(lev)o(el)f
(1,)f(y)o(et)i(w)o(e)g(attempt)e(to)h(use)i(it)e(at)g(lev)o(el)g(0.)g
(In)o(tuitiv)o(ely)m(,)e(this)i(means)g(that)150 2015
y(w)o(e)g(are)g(trying)g(to)g(use)g FE(x)g FI(b)q(efore)h(it)f(is)f(a)o
(v)n(ailable.)150 2098 y(Staging-correctness)21 b(is)f(a)f(subtle)h
(problem)e(in)h(the)h(traditional)e(setting)i(where)h(the)f(ob)r
(ject-language)f(is)150 2173 y(not)c(itself)g(a)g(meta-language.)d(In)j
(particular,)g(there)h(is)f(an)g(acciden)o(tal)h(reason)f(that)h(prev)o
(en)o(ts)g(the)g(staging-)150 2248 y(correctness)g(problem)c(from)f
(manifesting)g(itself)h(in)h(a)g(t)o(w)o(o-lev)o(el)f(language)g(where)
i(there)g(is)f(no)g(construct)h(for)150 2322 y(executing)f(co)q(de.)g
(Let)g(us)g(consider)h(b)q(oth)f(the)g(string)g(and)f(datat)o(yp)q(e)h
(enco)q(dings)g(and)f(study)i(the)f(enco)q(ding)g(of)150
2397 y(the)h(MetaML)h(term)e Fy(h)p FE(fn)h(x)g Fy(\))h
FE(~x)p Fy(i)q FI(.)e(The)h(enco)q(dings)h(yield)e(the)i(follo)o(wing)c
(t)o(w)o(o)i FH(untyp)n(able)18 b FI(expressions:)168
2513 y(1.)i FE(\\fn)14 b(x)h Fy(\))f FE("^x)p FI(.)g(This)g(fragmen)o
(t)f(is)i(not)f(w)o(ell-t)o(yp)q(ed)h(\(generally)f(sp)q(eaking\))h(b)q
(ecause)h FE(x)f FI(is)f(not)h(a)f(v)n(ariable)221 2588
y(in)f(the)h(meta-language,)e(and)h(w)o(ould)h(b)q(e)g(considered)h(to)
f(b)q(e)h(an)e(\\unkno)o(wn)h(iden)o(ti\014er".)168 2663
y(2.)20 b FE(F)o(unction\(\\x",)14 b(x\))p FI(.)f(This)h(fragmen)o(t)e
(is)i(not)g(w)o(ell-t)o(yp)q(ed)g(for)f(precisely)i(the)g(same)e
(reason.)p eop
%%Page: 6 17
6 16 bop 1901 0 a FB(6)150 192 y FI(Th)o(us,)15 b(the)i(real)e(problem)
f(in)h(this)h(term,)e(namely)m(,)f(the)j(incorrect)h(staging,)e(is)g
(hidden)h(b)o(y)f(the)h(coinciden)o(tal)150 266 y(fact)e(that)g(b)q
(oth)g(enco)q(dings)g(are)h(un)o(t)o(ypable.)150 349
y(With)j(b)q(oth)g(enco)q(dings,)h(w)o(e)f(can)h(still)e(sho)o(w)h
(that)h(there)g(are)g(w)o(ell-t)o(yp)q(ed)f(terms)g(that)h(are)f
FH(not)23 b FI(correctly)150 424 y(staged.)12 b(Staging-correctness)i
(do)q(es)f(manifest)e(itself)h(in)g(b)q(oth)g(enco)q(dings)h(when)g(w)o
(e)f(b)q(egin)h(describing)f(m)o(ulti-)150 499 y(lev)o(el)i(terms)f
(suc)o(h)i(as)f Fy(hh)p FE(fn)g(x)g Fy(\))h FE(~x)p Fy(i)q(i)p
FI(.)e(Both)h(enco)q(dings)h(of)e(this)h(term)f(are)i(w)o(ell-t)o(yp)q
(ed:)168 615 y(1.)20 b FE(\\)p Fy(n)p FE(\\fn)13 b(x)h
Fy(\))f(n)p FE(")p Fy(n)p FE(^x")g FI(is)h(a)f(p)q(erfectly)i(v)n(alid)
d(string.)168 690 y(2.)20 b FE(Brack)o(et\(F)o(unction\(\\x",)g(Escap)q
(e)h(\(V)o(a)o(r)f(\\x"\)\)\))f FI(is)h(also)f(a)g(p)q(erfectly)i(v)n
(alid)d FE(exp)j FI(if)e(w)o(e)h(extend)h(the)f FE(exp)221
764 y FI(datat)o(yp)q(e)14 b(with)f(Brac)o(k)o(ets)j(and)d(Escap)q(es,)
i(that)f(is:)291 829 y FE(datat)o(yp)q(e)h(exp)g(=)f(V)o(a)o(riable)g
(of)g(string)528 894 y Fy(j)34 b FE(Apply)15 b(of)e(\(exp)i(*)f(exp\))
528 959 y Fy(j)34 b FE(T)m(uple)15 b(of)f(exp)g(list)528
1023 y Fy(j)34 b FE(F)o(unction)15 b(of)e(string)h(*)g(exp)528
1088 y Fy(j)34 b FE(Brack)o(et)15 b(of)e(exp)528 1153
y Fy(j)34 b FE(Escap)q(e)15 b(of)f(exp.)150 1254 y FI(No)o(w,)d(the)h
(staging-correctness)i(problem)c(is)h(not)h(eviden)o(t)g(at)f(the)i
(time)d(the)i(ob)r(ject-program)f(is)g(constructed,)150
1329 y(but)16 b FH(b)n(e)n(c)n(omes)j FI(eviden)o(t)c(when)h(the)g(ob)r
(ject-program)f(is)g(executed.)i(When)e(executing)i(the)f(program,)d(w)
o(e)j(get)150 1404 y(stuc)o(k)f(trying)e(to)h(construct)h(an)f(enco)q
(ding)g(of)f(the)i(un)o(t)o(ypable)e(term)h Fy(h)p FI(fn)f(x)h
Fy(\))h FE(~)q FI(x)p Fy(i)p FI(.)150 1487 y(The)e(staging-correctness)
j(problem)11 b(is)i(esp)q(ecially)g(subtle)g(when)h(w)o(e)f(allo)o(w)e
(the)j(execution)g(of)e(co)q(de,)h(b)q(ecause)150 1561
y(executing)g(co)q(de)h(in)o(v)o(olv)o(es)d(c)o(hanging)h(the)h(lev)o
(el)f(of)g(terms)g(at)g(run-time.)f(F)m(or)h(example,)f(executing)i
Fy(h)q FE(5)p Fy(i)f FI(w)o(e)h(get)150 1636 y FE(5)p
FI(,)g(and)g(the)h(lev)o(el)f(of)f FE(5)h FI(has)h(dropp)q(ed)g(b)o(y)f
(one.)g(Sheard)h(had)f(p)q(ostulated)h(that)f(ensuring)h
(staging-correctness)150 1711 y(should)e(b)q(e)h(one)g(of)f(the)h(resp)
q(onsibilities)f(of)g(MetaML's)g(t)o(yp)q(e)h(system.)f(This)g
(dissertation)h(presen)o(ts)i(t)o(w)o(o)c(t)o(yp)q(e)150
1785 y(systems)j(for)g(MetaML)g(where)h(w)o(ell-t)o(yp)q(ed)e(MetaML)i
(programs)d(are)j(also)e(correctly)i(staged.)150 1943
y FG(Re\015ection:)k FI(Re\015ection)14 b(is)g(sometimes)e(de\014ned)j
(b)o(y)f(\(the)h(presence)h(of)d(a)h(construct)i(in)d(the)i(language)e
(that)150 2018 y(allo)o(ws\))c(the)h(execution)g(of)f(ob)r
(ject-programs)h([27,)5 b(100,)h(17,)g(89],)i(and)i(sometimes)e(b)o(y)h
(the)h(abilit)o(y)e(of)h(a)h(language)150 2093 y(to)j(represen)o(t)j
(\(all)c(of)h(its)h(meta-\)programs)d(as)i(ob)r(ject-programs)g([85,)6
b(86].)12 b(Both)h(de\014nitions)h(are)g(prop)q(erties)150
2167 y(that)d(can)g(b)q(e)g(formalized,)e(and)h(b)q(oth)h(can)g(b)q(e)g
(in)o(terpreted)i(as)e(p)q(ositiv)o(e)f(qualities.)g(It)h(is)f
(therefore)j(unfortunate)150 2242 y(the)h(one)h(name)d(is)i(used)h(for)
e(t)o(w)o(o)h(di\013eren)o(t)h(prop)q(erties,)f(eac)o(h)h(of)e(whic)o
(h)h(is)g(imp)q(ortan)o(t)e(in)h(its)h(o)o(wn)g(righ)o(t.)150
2325 y(MetaML)i(enjo)o(ys)h(instances)g(of)e(b)q(oth)h(re\015ectiv)o(e)
i(prop)q(erties)1139 2310 y FA(3)1159 2325 y FI(.)e(Qualitativ)o(ely)m
(,)d(the)k(\014rst)g(kind)e(of)h(re\015ection)150 2400
y(suggests)g(that)f(the)h(meta-language)d(is)i(at)g(least)g(as)g
(expressiv)o(e)i(as)e(the)g(ob)r(ject-language.)g(This)f(kind)h(of)f
(re-)150 2475 y(\015ection)g(is)g(realized)g(in)f(MetaML)h(b)o(y)g
(incorp)q(orating)f(a)g(Run)g(construct)j(to)d(execute)j(ob)r
(ject-programs.)d(The)p 150 2555 237 2 v 158 2582 a Fz(3)188
2598 y FB(Rei\014cation,)j(when)d(de\014ned)h(as)f(the)g(mapping)i(of)e
(a)g(v)n(alue)h(in)o(to)g(a)f(represen)o(tation)i(of)e(that)g(v)n
(alue,)h(is)g(not)f(a)o(v)n(ailable)188 2643 y(in)h(MetaML.)p
eop
%%Page: 7 18
7 17 bop 1901 0 a FB(7)150 192 y FI(MetaML)15 b(program)e
FE(run)g Fy(h)p FE(1+2)p Fy(i)i FI(returns)h FE(3)p FI(,)e(and)h
Fy(h)p FE(run)e Fy(hh)p FE(1+5)p Fy(iii)i FI(is)g(a)f(v)n(alid)g
FH(multi-level)j FI(program.)c(Qualita-)150 266 y(tiv)o(ely)m(,)h(the)i
(second)h(kind)e(of)g(re\015ection)i(suggests)g(that)e(the)i(ob)r
(ject-language)e(is)h(at)f(least)h(as)g(expressiv)o(e)h(as)150
341 y(the)e(meta-language.)c(This)k(kind)e(of)h(re\015ection)h(is)f
(realized)h(in)f(MetaML)g(b)o(y)g(allo)o(wing)e(an)o(y)i(ob)r
(ject-program)150 416 y(to)g(b)q(e)g(itself)g(a)f(meta-program.)150
499 y(T)m(o)k(summarize)f(this)h(section,)h(MetaML)g(w)o(as)g(designed)
g(to)g(solv)o(e)f(a)g(host)h(of)f(fundamen)o(tal)f(problems)h(en-)150
573 y(coun)o(tered)k(when)g(writing)e(program)g(generators,)h(th)o(us)h
(freeing)f(generator)h(dev)o(elop)q(ers)g(from)d(ha)o(ving)h(to)150
648 y(con)o(tin)o(ually)12 b(re-in)o(v)o(en)o(t)i(the)h(solutions)e(to)
h(these)h(problems.)150 807 y FD(1.2)56 b(Meta-Programmi)o(ng)16
b(for)j(Optimization)150 940 y FI(Meta-programming)14
b(is)j(often)h(used)g(to)g(o)o(v)o(ercome)f(limitati)o(ons)e(of)i(an)g
(existing)g(programming)d(language.)150 1014 y(Suc)o(h)f(limitati)o
(ons)d(can)i(either)h(b)q(e)f(p)q(erformance)g(or)g(expressivit)o(y)h
(problems.)e(The)h(fo)q(cus)h(of)e(this)i(dissertation)150
1089 y(is)g(on)g(a)g(seman)o(tic)f(basis)i(for)e(impro)o(ving)f(p)q
(erformance.)i(W)m(e)f(mak)o(e)g(a)h(broad)g(distinction)g(b)q(et)o(w)o
(een)i(t)o(w)o(o)d(w)o(a)o(ys)150 1164 y(of)e(impro)o(ving)e(p)q
(erformance)j(using)f(meta-programm)o(i)o(ng:)d(T)m(ranslation,)i(and)i
(staging.)e(While)h(our)h(w)o(ork)f(do)q(es)150 1238
y(touc)o(h)k(on)g(translation,)g(our)g(fo)q(cus)g(is)g(on)g(the)h
(staging)f(asp)q(ect)h(of)f(meta-programm)o(i)o(ng.)d(In)j(this)g
(section,)h(w)o(e)150 1313 y(explain)e(the)i(di\013erence)g(b)q(et)o(w)
o(een)h(translation)d(and)h(staging.)150 1461 y FG(1.2.1)48
b(Meta-Programming)13 b(as)j(T)l(ranslation,)d(or)i(Re-mapping)f
(Abstract)g(Mac)o(hines)150 1577 y FI(Abstract)f(mac)o(hines,)d
(whether)i(realized)g(b)o(y)f(soft)o(w)o(are)h(or)f(b)o(y)g(hardw)o
(are,)h(v)n(ary)f(in)g(sp)q(eed)h(and)g(resource)h(usage.)150
1652 y(It)d(is)h(therefore)g(p)q(ossible)g(to)f(reduce)i(the)f(cost)g
(of)f(executing)h(a)f(program)e(b)o(y)i(re-mapping)f(it)h(from)f(one)h
(abstract)150 1727 y(mac)o(hine)19 b(to)i(another.)f(As)h(hardw)o(are)g
(mac)o(hines)f(can)h(b)q(e)g(b)q(oth)g(faster)g(and)g(more)e(space)j
(e\016cien)o(t)f(than)150 1801 y(soft)o(w)o(are)15 b(ones,)g(suc)o(h)h
(re-mappings)e(commonl)o(y)e(in)o(v)o(olv)o(e)i(pro)q(ducing)h(mac)o
(hine)f(or)h(b)o(yte)g(co)q(de.)h(W)m(e)e(will)g(call)150
1876 y(this)g(tec)o(hnique)i FH(tr)n(anslation)e FI(to)g(distinguish)g
(it)g(from)f(staging)h(\(whic)o(h)g(discussed)i(in)e(the)h(next)g
(subsection\).)150 1951 y(T)m(ranslation)h(is)h(an)g(in)o(tegral)f
(part)i(of)e(the)i(practical)f(compilation)d(of)j(a)g(programmi)o(ng)d
(languages,)i(and)h(is)150 2025 y(t)o(ypically)c(p)q(erformed)g(b)o(y)h
(the)g FH(b)n(ack-end)19 b FI(of)13 b(a)h(compiler.)150
2108 y(T)m(ranslation)k(in)o(v)o(olv)o(es)g(b)q(oth)i(insp)q(ecting)f
(and)h(constructing)g(co)q(de.)f(MetaML)h(implemen)o(tatio)o(ns)d(supp)
q(ort)150 2183 y(some)d(exp)q(erimen)o(tal)g(constructs)i(for)e(insp)q
(ecting)i(co)q(de,)f(but)f(they)h(are)h(not)e(the)h(fo)q(cus)g(of)f
(this)h(dissertation.)150 2258 y(Ho)o(w)o(ev)o(er,)k(w)o(e)g(do)g
(study)h(v)n(arious)e(forms)g(of)g(a)h(Run)g(construct)h(whic)o(h)f
(allo)o(w)f(the)i(meta-programm)n(er)d(to)150 2333 y(exploit)g(the)h
(full)e(p)q(o)o(w)o(er)h(of)g(the)h(underlying)f(mac)o(hine.)f(The)h
(distinction)g(b)q(et)o(w)o(een)i(Run)e(and)g(generalized)150
2407 y(co)q(de)c(insp)q(ection)g(is)f(subtle,)g(but)g(has)h(profound)e
(implications)f(on)i(the)g(seman)o(tics)g(\(see)i(Section)e(6.3\))f
(and)h(the)150 2482 y(t)o(yp)q(e)i(system)g(\(see)h(Section)g(7.1.3\))d
(of)h(a)h(m)o(ulti-stage)e(programmi)o(ng)f(language.)p
eop
%%Page: 8 19
8 18 bop 1901 0 a FB(8)150 192 y FG(1.2.2)48 b(Meta-Programming)13
b(as)j(Staging)150 304 y FI(The)g(goal)f(of)g(staging)g(is)g(to)h
(impro)o(v)o(e)e(a)h(program)f(based)i(on)g FH(a)g(priori)j
FI(information)13 b(ab)q(out)j(ho)o(w)f(it)g(will)f(b)q(e)150
379 y(used.)k(As)f(the)h(name)e(suggests,)i FH(staging)f
FI(is)g(a)g(program)e(transformation)g(that)j(in)o(v)o(olv)o(es)e
(reorganizing)g(the)150 454 y(program's)c(execution)j(in)o(to)e(stages)
i([42].)150 537 y(The)e(concept)h(of)e(a)g(stage)h(arises)g(naturally)f
(in)g(a)g(wide)g(v)n(ariet)o(y)g(of)g(situations.)g(Compilatio)o
(n-based)f(program)150 612 y(execution)21 b(in)o(v)o(olv)o(es)e(t)o(w)o
(o)h(distinct)g(stages:)h(compile-tim)o(e,)c(and)j(run-time.)f
(Generated)i(program)e(execu-)150 686 y(tion)c(in)o(v)o(olv)o(es)f
(three:)i(generation-time,)d(compile-tim)o(e,)f(and)j(run-time.)f(F)m
(or)h(example,)e(consider)j(the)g(Y)m(acc)150 761 y(parser)g
(generator:)g(\014rst,)f(it)g(reads)g(a)g(grammar)d(and)j(generates)i
(C)e(co)q(de;)g(second,)h(the)f(generated)i(program)150
836 y(is)c(compiled;)e(third,)i(the)h(user)g(runs)g(this)f(compiled)f
(program.)f(Both)i(compilation)d(and)j(high-lev)o(el)g(program)150
911 y(generation)i(can)g(b)q(e)g(used)h(to)e(reduce)j(the)e(cost)h(of)e
(a)g(program's)f(execution.)i(As)h(suc)o(h,)f(staging)f(pro)o(vides)h
(us)150 985 y(with)f(a)f(to)q(ol)g(to)h(impro)o(v)o(e)e(the)j(p)q
(erformance)e(of)h(high-lev)o(el)e(programs.)150 1140
y FG(Cost)19 b(Mo)q(dels)f(for)g(Staged)g(Computation)k
FI(Cost)17 b(mo)q(dels)e(are)i(not)g(an)f(absolute,)h(and)f(are)h
(generally)150 1214 y(dictated)d(b)o(y)e(the)i(surrounding)f(en)o
(vironmen)o(t)f(in)h(whic)o(h)g(an)g(algorithm,)d(program,)h(or)i
(system)g(is)f(to)h(b)q(e)h(used)150 1289 y(or)g(deplo)o(y)o(ed.)g
(Staging)f(allo)o(ws)g(us)i(to)f(tak)o(e)g(adv)n(an)o(tage)g(of)g
(features)h(of)f(b)q(oth)g(the)h(inputs)f(to)g(a)g(program)f(and)150
1364 y(the)g(cost)f(mo)q(del)f(to)h(impro)o(v)o(e)e(p)q(erformance.)i
(In)g(particular,)f(while)h(staging)f(ma)o(y)f(b)q(e)j(an)f
(optimization)d(under)150 1439 y(one)15 b(mo)q(del,)e(it)h(ma)o(y)f
(not)i(b)q(e)h(under)f(another.)g(There)h(are)f(three)h(imp)q(ortan)o
(t)e(classes)i(of)e(cost)h(mo)q(dels)f(under)150 1513
y(whic)o(h)g(staging)f(can)h(b)q(e)h(b)q(ene\014cial:)176
1626 y FG({)21 b FI(Ov)o(erall)12 b(cost)i(is)f(the)h(total)e(cost)i
(of)f(all)f(stages,)h FH(for)h(most)g(inputs)p FI(.)f(This)g(mo)q(del)f
(applies,)g(for)h(example,)e(in)221 1700 y(implem)o(en)o(tations)f(of)i
(programmi)o(ng)e(languages.)h(The)i(cost)g(of)f(a)g(simple)g
(compilation)d(follo)o(w)o(ed)i(b)o(y)h(exe-)221 1775
y(cution)e(is)f FH(usual)r(ly)14 b FI(lo)o(w)o(er)c(than)g(the)g(cost)h
(of)e(in)o(terpretation.)h(F)m(or)g(example,)e(the)j(program)d(b)q
(eing)i(executed)221 1850 y(usually)i(con)o(tains)h(lo)q(ops,)f(whic)o
(h)h(t)o(ypically)f(incur)h(large)g(o)o(v)o(erhead)h(in)e(an)h(in)o
(terpreted)i(implemen)o(tatio)o(n.)176 1924 y FG({)21
b FI(Ov)o(erall)c(cost)i(is)f(a)g FH(weighte)n(d)g(aver)n(age)k
FI(of)17 b(the)i(cost)g(of)e(all)g(stages.)i(The)f(w)o(eigh)o(ts)g
(re\015ect)i(the)f(relativ)o(e)221 1998 y(frequency)11
b(at)f(whic)o(h)g(the)g(result)h(of)f(a)g(stage)g(can)g(b)q(e)h
(reused.)g(This)f(mo)q(del)f(is)h(useful)g(in)g(man)o(y)e(applications)
221 2073 y(of)h(sym)o(b)q(olic)f(computation.)g(Often,)i(solving)f(a)h
(problem)e(sym)o(b)q(olically)m(,)e(and)k(then)h(graphing)e(the)i
(solution)221 2148 y(at)j(a)g(thousand)h(p)q(oin)o(ts)f(can)h(b)q(e)g
(c)o(heap)q(er)g(than)g(n)o(umerically)d(solving)h(the)j(problem)d(a)h
(thousand)g(times.)221 2222 y(This)j(cost)h(mo)q(del)d(can)j(mak)o(e)e
(a)g(sym)o(b)q(olic)g(approac)o(h)h(w)o(orth)o(while)g(ev)o(en)h(when)f
(it)g(is)g(100)g(times)f(more)221 2297 y(exp)q(ensiv)o(e)d(than)g(a)g
(direct)g(n)o(umerical)e(one.)i(Sym)o(b)q(olic)d(computation)h(is)i(a)f
(form)f(of)h(staged)i(computation)221 2372 y(where)h(free)f(v)n
(ariables)f(are)i(v)n(alues)e(that)h(will)f(only)g(b)q(ecome)h(a)o(v)n
(ailable)d(at)j(a)g(later)g(stage.)176 2446 y FG({)21
b FI(Ov)o(erall)10 b(cost)i(is)g(the)g(cost)g(of)e(the)i
FH(last)g(stage)p FI(.)f(This)h(cost)g(mo)q(del)e(is)h(often)g(just)h
(a)f(practical)g(appro)o(ximation)221 2521 y(of)i(the)i(previous)g(mo)q
(del,)d(where)k(the)f(relativ)o(e)f(frequency)i(of)e(executing)h(the)g
(last)f(stage)h(is)f(m)o(uc)o(h)f(larger)221 2595 y(than)k(that)g(for)g
(an)o(y)f(of)h(the)g(previous)h(stages.)f(T)m(o)f(illustrate,)h
(consider)h(an)f(em)o(b)q(edded)g(system)g(where)221
2670 y(the)f FF(sin)h FI(function)f(ma)o(y)e(b)q(e)j(implemen)o(ted)d
(as)i(a)g(large)g(lo)q(ok-up)f(table.)h(The)h(cost)g(of)e(constructing)
i(the)p eop
%%Page: 9 20
9 19 bop 1901 0 a FB(9)221 192 y FI(table)17 b(is)g(not)g(relev)n(an)o
(t.)g(Only)h(the)g(cost)g(of)e(computing)g(the)i(function)f(at)h
(run-time)e(is)h(relev)n(an)o(t.)g(This)221 266 y(observ)n(ation)12
b(also)g(applies)h(to)g(optimizing)d(compilers,)h(whic)o(h)i(ma)o(y)e
(sp)q(end)j(an)e(un)o(usual)h(amoun)o(t)e(of)h(time)221
341 y(to)k(generate)i(a)e(high-p)q(erformance)g(computational)e
(library)m(.)h(The)i(cost)h(of)e(optimization)e(is)i(often)h(not)221
416 y(relev)n(an)o(t)d(to)f(the)i(users)g(of)e(suc)o(h)i(libraries)891
401 y FA(4)909 416 y FI(.)150 529 y(The)20 b(last)e(mo)q(del)g(seems)h
(to)g(b)q(e)h(the)g(most)e(commonl)o(y)e(referenced)22
b(one)d(in)g(the)h(literature,)f(and)g(is)g(often)150
603 y(describ)q(ed)f(as)e(\\there)h(is)e(ample)g(time)f(b)q(et)o(w)o
(een)k(the)e(arriv)n(al)f(of)g(di\013eren)o(t)i(inputs",)e(\\there)i
(is)f(a)f(signi\014can)o(t)150 678 y(di\013erence)21
b(b)q(et)o(w)o(een)g(the)e(frequency)i(at)e(whic)o(h)g(the)h(v)n
(arious)e(inputs)h(to)g(a)g(program)f(c)o(hange",)h(and)g(\\the)150
753 y(p)q(erformance)14 b(of)f(the)i(program)d(matters)h(only)g(after)i
(the)f(arriv)n(al)f(of)g(its)h(last)f(input".)150 836
y(Finally)m(,)7 b(w)o(e)i(wish)h(to)f(emphasize)g(that)g(non-trivial)f
(p)q(erformance)h(gains)g(can)h(b)q(e)g(ac)o(hiev)o(ed)f(using)h(only)e
(staging,)150 911 y(and)i(without)f(an)o(y)g(need)i(for)f(translation.)
e(MetaML)j(pro)o(vides)f(the)g(soft)o(w)o(are)g(dev)o(elop)q(er)h(with)
e(a)h(programmi)o(ng)150 985 y(language)k(where)j(the)f(staging)e(asp)q
(ect)j(of)e(a)g(computation)e(can)j(b)q(e)g(expressed)i(in)c(a)h
(concise)i(manner,)d(b)q(oth)150 1060 y(at)k(the)g(lev)o(el)g(of)f(syn)
o(tax)h(and)g(t)o(yp)q(es.)g(This)g(w)o(a)o(y)m(,)e(the)i(programmer)e
(do)q(es)j(not)e(need)i(to)f(learn)g(a)f(lo)o(w-lev)o(el)150
1135 y(language,)h(y)o(et)h(con)o(tin)o(ues)g(to)g(enjo)o(y)g(man)o(y)e
(of)h(the)i(p)q(erformance)f(impro)o(v)o(emen)o(ts)d(previously)j(asso)
q(ciated)150 1209 y(only)c(with)h(program)e(generation.)h(F)m
(urthermore,)h(when)g(translation)f(is)h(emplo)o(y)o(ed)e(in)h(an)h
FH(implementation)150 1284 y FI(of)i(MetaML,)h(translation)f(to)q(o)g
(can)h(b)q(e)h(exploited)e(b)o(y)h(the)g(meta-programm)o(er)e(through)h
(using)h(the)g(Run)150 1359 y(construct.)150 1514 y FD(1.3)56
b(P)n(artial)18 b(Ev)m(aluation)g(and)h(Multi-Lev)n(el)d(Languages)150
1644 y FI(T)m(o)q(da)o(y)m(,)d(the)j(most)e(sophisticated)i(automated)e
(staging)h(systems)g(are)h(partial)e(ev)n(aluation)g(systems.)h(P)o
(artial)150 1718 y(ev)n(aluation)h(optimizes)g(a)g(program)g(using)h
(partial)f(information)e(ab)q(out)j(some)f(of)h(that)g(program's)e
(inputs.)150 1793 y(Jones)g(in)o(tro)q(duced)g(o\013-line)e(partial)g
(ev)n(aluation)g(to)h(sho)o(w)g(that)g(partial)g(ev)n(aluation)e(can)j
(b)q(e)f(p)q(erformed)g(e\016-)150 1868 y(cien)o(tly)g([41].)f(An)h
(o\013-line)g(partial)f(ev)n(aluator)g(is)i(itself)f(a)g(staged)g
(system.)g(First,)g(a)g(Binding-Time)e(Analysis)150 1943
y(\(BT)m(A\))j(annotates)h(the)f(input)g(program)e(to)i(indicate)g
(whether)i(eac)o(h)e(sub)q(expression)i(can)e(b)q(e)h(computed)e(at)150
2017 y(partial-ev)n(aluation-tim)o(e)8 b(\(static\),)k(or)f(at)g
(run-time)f(\(dynamic\).)f(In)o(tuitiv)o(ely)m(,)g(only)i(the)h(sub)q
(expressions)h(that)150 2092 y(dep)q(end)k(on)e(static)h(inputs)f(can)h
(b)q(e)g(computed)f(at)g(partial-ev)n(aluation)e(time.)h(Second,)h(the)
i(annotated)e(pro-)150 2167 y(gram)10 b(is)i(sp)q(ecialized)h(on)f(the)
h(static)f(inputs)g(to)g(pro)q(duce)h(the)g(new)g(sp)q(ecialized)f
(program.)e(MetaML)j(pro)o(vides)150 2242 y(a)f FH(c)n(ommon)i
(language)i FI(for)11 b(illustrating)g(the)i(w)o(orkings)e(of)h
(o\013-line)f(partial)g(ev)n(aluation.)f(F)m(or)i(example,)e(w)o(e)j
(can)150 2316 y(construct)h(a)d(represen)o(tation)j(of)d(a)h(program)e
(in)i(MetaML.)g(Let)g(us)h(consider)f(a)g(simple)f(MetaML)h(session.)g
(W)m(e)150 2391 y(t)o(yp)q(e)i(in:)221 2493 y FE(-)p
Fy(j)f FE(val)h(p)g(=)g Fy(h)p FE(fn)g(x)g Fy(\))f FE(fn)h(y)g
Fy(\))g FE(\(x+1\)+y)p Fy(i)q FE(;)p 150 2582 237 2 v
158 2608 a Fz(4)188 2624 y FB(Not)g(to)f(men)o(tion)i(the)f(cen)o
(tury-long)i(\\stages")e(that)g(w)o(ere)g(needed)g(to)g(ev)o(olv)o(e)h
(the)f(theory)g(b)q(ehind)i(man)o(y)e(of)f(these)188
2670 y(libraries.)p eop
%%Page: 10 21
10 20 bop 1882 0 a FB(10)150 192 y FI(and)14 b(the)g(MetaML)g(implemen)
o(tation)d(prin)o(ts:)221 297 y FE(val)i(p)i(=)f Fy(h)p
FE(fn)g(x)g Fy(\))f FE(fn)h(y)g Fy(\))g FE(\(x+1\)+y)p
Fy(i)319 362 y FE(:)f Fy(h)p FE(int)h Fy(!)g FE(int)g
Fy(!)f FE(int)p Fy(i)q FE(.)150 462 y FI(If)f(the)i(program)d
FE(p)i FI(is)f(fed)h(to)g(a)f(partial)g(ev)n(aluator,)g(it)g(m)o(ust)g
(\014rst)h(go)f(through)h(BT)m(A.)f(A)o(t)h(an)f(implemen)o(tation)150
537 y(lev)o(el,)i(BT)m(A)g(can)g(b)q(e)h(view)o(ed)g(as)f(a)g
(source-to-source)j(transformation.)12 b(T)o(ypically)m(,)g(BT)m(A)i
(is)g(giv)o(en)g(a)g(sp)q(eci\014-)150 612 y(cation)f(of)g(whic)o(h)g
(inputs)g(are)h(static)g(and)f(whic)o(h)g(inputs)g(are)h(dynamic.)d(F)m
(or)i(simplicit)o(y)m(,)d(let)j(us)h(assume)f(that)150
686 y(w)o(e)k(are)g(only)f(in)o(terested)j(in)d(programs)g(that)h(tak)o
(e)g(t)o(w)o(o)f(curried)i(argumen)o(ts,)e(and)g(the)i(\014rst)f(one)g
(is)g(static,)150 761 y(and)f(the)h(second)g(one)g(is)f(dynamic.)e
(Although)i(our)g(MetaML)g(implemen)o(tation)d(do)q(es)k(not)f(pro)o
(vide)g(suc)o(h)h(a)150 836 y(function)d(to)q(da)o(y)m(,)e(one)i(can,)g
(in)f(principle,)h(add)f(a)h FH(c)n(onstant)k FE(BT)m(A)13
b FI(to)h(MetaML)g(with)g(the)g(follo)o(wing)e(t)o(yp)q(e)1852
821 y FA(5)1871 836 y FI(:)221 941 y FE(-)p Fy(j)h FE(BT)m(A;)221
1006 y(val)g(BT)m(A)g(=)i(-fn-)377 1071 y(:)f Fy(h)p
FE('a)f Fy(!)25 b FE('b)14 b Fy(!)25 b FE('c)p Fy(i)14
b(!)f(h)f FE('a)h Fy(!)g(h)f FE('b)i Fy(!)25 b FE('c)p
Fy(ii)p FE(.)150 1171 y FI(Then,)14 b(to)g(p)q(erform)f(BT)m(A,)g(w)o
(e)h(apply)f(this)h(constan)o(t)h(to)f(the)g(source)h(program:)221
1277 y FE(-)p Fy(j)e FE(val)h(ap)g(=)g(BT)m(A)f(p;)221
1341 y(val)g(ap)i(=)f Fy(h)p FE(fn)g(x)g Fy(\))f(h)p
FE(fn)h(y)g Fy(\))h FE(~)q(\(lift)e(\(x+1\)\)+y)p Fy(i)q(i)339
1406 y FE(:)g Fy(h)p FE(int)h Fy(!)g(h)p FE(int)g Fy(!)f
FE(int)p Fy(i)q(i)150 1507 y FI(yielding)e(the)i(\\annotated)f
(program".)e(The)j(lift)e(function)h(is)g(a)g(secondary)h(annotation)e
(that)h(tak)o(es)h(a)f(ground)150 1581 y(v)n(alue)h(and)h(returns)h(a)f
(co)q(de)g(fragmen)o(t)f(con)o(taining)g(that)g(v)n(alue.)g(F)m(or)h
(no)o(w,)f(the)h(reader)h(can)f(view)g FE(lift)f FI(simply)150
1656 y(as)h(b)q(eing)g FE(fn)g(x)g Fy(\))f(h)p FE(x)p
Fy(i)q FI(.)150 1739 y(The)h(next)h(step)g(is)e(sp)q(ecialization.)g
(It)h(in)o(v)o(olv)o(es)f(running)h(the)g(program)e(on)i(the)h(input)e
(term:)221 1844 y FE(-)p Fy(j)g FE(val)h(p5)g(=)g(\(run)h(ap\))f(5;)221
1909 y(val)f(p5)h(=)h Fy(h)p FE(fn)f(y)g Fy(\))f FE(6+y)p
Fy(i)339 1974 y FE(:)h Fy(h)p FE(int)g Fy(!)g FE(int)p
Fy(i)150 2074 y FI(yielding,)e(in)i(turn,)g(the)g(sp)q(ecialized)h
(program.)150 2157 y(P)o(artial)d(ev)n(aluation)f(in)h(general,)h(and)f
(o\013-line)g(partial)g(ev)n(aluation)f(in)i(particular,)f(ha)o(v)o(e)g
(b)q(een)i(the)f(sub)r(ject)i(of)150 2232 y(a)e(substan)o(tial)g(b)q(o)
q(dy)h(of)f(researc)o(h.)i(Muc)o(h)f(of)e(our)i(understanding)g(of)f
(the)h(applications)f(and)g(the)h(limitations)150 2307
y(of)j(staged)g(computation)f(has)h(gro)o(wn)g(out)h(of)e(that)i
(literature.)f(The)h(w)o(ord)f(\\m)o(ulti-stage")e(itself)i(seems)g(to)
150 2382 y(ha)o(v)o(e)11 b(b)q(een)i(\014rst)g(in)o(tro)q(duce)f(b)o(y)
g(Jones)g FH(et)h(al.)e FI([40].)f(In)h(the)i(illustration)d(ab)q(o)o
(v)o(e,)h(w)o(e)h(ha)o(v)o(e)f(tak)o(en)h(the)g(view)g(that)150
2456 y(the)k(output)f(of)g(BT)m(A)g(is)g(simply)e(a)i(t)o(w)o(o-stage)g
(annotated)h(program.)d(This)i(view)g(seems)h(to)f(ha)o(v)o(e)g(b)q
(een)h(\014rst)p 150 2536 237 2 v 158 2563 a Fz(5)188
2579 y FB(BT)m(A)11 b(cannot)i(b)q(e)f(expressed)h(using)g(only)g(the)e
(staging)j(constructs)e(that)g(w)o(e)f(study)i(in)f(this)h
(dissertation.)g(In)f(partic-)188 2624 y(ular,)i(an)f(analysis)i(suc)o
(h)f(as)f(BT)m(A)f(requires)i(in)o(tensional)j(analysis,)e(whic)o(h)e
(is)h(only)g(addressed)g(tangen)o(tially)i(in)e(this)188
2670 y(dissertation.)p eop
%%Page: 11 22
11 21 bop 1882 0 a FB(11)150 192 y FI(suggested)15 b(in)e(the)h(w)o
(orks)f(of)g(Nielson)g(and)h(Nielson)f([62])f(and)h(b)o(y)g(Gomard)f
(and)h(Jones)h([32],)e(when)i(t)o(w)o(o-lev)o(el)150
266 y(languages)h(w)o(ere)h(in)o(tro)q(duced.)g(Recen)o(tly)m(,)f(t)o
(w)o(o-lev)o(el)g(languages)g(ha)o(v)o(e)g(b)q(een)i(prop)q(osed)f(as)f
(an)h(in)o(termediate)150 341 y(represen)o(tation)i(for)d(o\013-line)h
(partial)f(ev)n(aluation)g(systems.)g(Gl)q(\177)-22 b(uc)o(k)16
b(generalized)h(t)o(w)o(o-stage)f(o\013-line)f(partial)150
416 y(ev)n(aluation)i(to)h(m)o(ulti-lev)o(el)e(o\013-line)i(partial)f
(ev)n(aluation)g(and)h(in)o(tro)q(duced)i(m)o(ulti-lev)o(el)15
b(languages.)j(These)150 490 y(ideas)e(where)h(the)f(starting)g(p)q
(oin)o(t)f(for)h(this)f(dissertation.)h(F)m(or)g(example,)e(MetaML)i
(is)f(essen)o(tially)h(a)f(m)o(ulti-)150 565 y(lev)o(el)f(language)g
(with)g(the)h(addition)e(of)h(Run.)g(This)g(view)h(of)e(MetaML)i(is)g
(precisely)g(the)g(sense)h(in)e(whic)o(h)h(w)o(e)150
640 y(use)g(the)f(term)f(\\m)o(ulti-stage":)532 756 y(Multi-Stage)g
(Language)h(=)g(Multi-Lev)o(el)f(Language)g(+)i(Run.)150
915 y FD(1.4)56 b(Multi-Stage)17 b(Programming)f(with)j(Explicit)d
(Annotations)150 1047 y FI(F)m(rom)i(a)h(soft)o(w)o(are)h(engineering)g
(p)q(oin)o(t)f(of)h(view,)f(the)h(no)o(v)o(elt)o(y)f(of)g(MetaML)h(is)g
(that)g(it)f(admits)f(an)i(in)o(tu-)150 1122 y(itiv)o(ely)14
b(app)q(ealing)h(metho)q(d)f(of)h(dev)o(eloping)g(meta-programs.)d(A)k
(m)o(ulti-stage)d(program)h(can)h(b)q(e)h(dev)o(elop)q(ed)150
1197 y(in)d(MetaML)i(as)f(follo)o(ws:)168 1313 y(1.)20
b(A)14 b(single-stage)f(program)g(is)g(dev)o(elop)q(ed,)i(implem)o(en)o
(ted,)d(and)h(tested.)168 1388 y(2.)20 b(The)c(t)o(yp)q(e)g(of)f(the)h
(single-stage)g(program)e(is)i(annotated)g(using)f(the)h(co)q(de)h(t)o
(yp)q(e)f(constructor)i(to)d(re\015ect)221 1463 y(the)f(order)h(in)e
(whic)o(h)h(inputs)g(arriv)o(e.)168 1537 y(3.)20 b(The)c(organization)e
(and)i(data-structures)h(of)e(the)i(program)d(are)i(studied)g(to)f
(ensure)j(that)d(they)h(can)g(b)q(e)221 1612 y(used)f(in)f(a)g(staged)g
(manner.)f(This)i(analysis)e(ma)o(y)g(indicate)h(a)g(need)h(for)f
(\\factoring")f(some)h(parts)h(of)e(the)221 1687 y(program)h(and)h(its)
h(data)f(structures.)j(This)e(step)h(can)e(b)q(e)i(subtle,)f(and)f(can)
h(b)q(e)g(a)g(critical)f(step)i(to)o(w)o(ards)221 1761
y(e\013ectiv)o(e)k(m)o(ulti-stage)d(programming)o(.)f(F)m(ortunately)m
(,)i(it)g(has)h(b)q(een)i(thoroughly)d(in)o(v)o(estigated)h(in)f(the)
221 1836 y(con)o(text)14 b(of)f(partial)g(ev)n(aluation)g(where)i(it)e
(is)h(kno)o(wn)g(as)g FH(binding-time)g(engine)n(ering)k
FI([40].)168 1911 y(4.)i(Staging)d(annotations)g(are)i(in)o(tro)q
(duced)g(to)f(sp)q(ecify)h(explicitly)e(the)i(ev)n(aluation)d(order)j
(of)f(the)h(v)n(arious)221 1986 y(computations)8 b(of)i(the)g(program.)
e(The)j(staged)f(program)e(ma)o(y)g(then)j(b)q(e)g(tested)g(to)f
(ensure)i(that)e(it)f(ac)o(hiev)o(es)221 2060 y(the)14
b(desired)h(p)q(erformance.)150 2177 y(The)k(metho)q(d)f(describ)q(ed)i
(ab)q(o)o(v)o(e,)e(called)h FH(multi-stage)f(pr)n(o)n(gr)n(amming)h
(with)f(explicit)h(annotations)p FI(,)g(can)g(b)q(e)150
2251 y(summarized)12 b(b)o(y)i(the)g(slogan:)387 2368
y(A)g(Staged)g(Program)e(=)i(A)g(Con)o(v)o(en)o(tional)f(Program)f(+)i
(Staging)f(Annotations.)150 2484 y(The)h(conciseness)i(of)c
(meta-programs)f(written)j(in)f(MetaML)h(allo)o(ws)e(us)i(to)g(view)f
(meta-programs)e(as)i(simple)150 2558 y(v)n(ariations)c(on)g(con)o(v)o
(en)o(tional)g(\(that)h(is,)f(\\non-meta-"\))f(programs.)g(These)j(v)n
(ariations)e(are)h(minor,)e(orthogonal,)150 2633 y(and)17
b(lo)q(calized,)f(compared)g(to)h(writing)f(meta-programs)e(in)i(a)h
(general-purp)q(ose)h(programming)13 b(language,)p eop
%%Page: 12 23
12 22 bop 1882 0 a FB(12)150 192 y FI(a)15 b(task)h(whic)o(h)f(w)o
(ould)g(b)q(e)h(riddled)f(b)o(y)g(the)h(problems)f(describ)q(ed)i(in)e
(Section)h(1.1.)e(F)m(urthermore,)g(staging)h(is)150
266 y(accurately)g(re\015ected)h(in)d(the)i(manifest)d(in)o(terfaces)j
(\(the)g(t)o(yp)q(es\))f(of)g(the)g(MetaML)g(programs.)150
349 y(Because)k(program)c(generation)i(is)g(often)g(used)h(for)f(the)g
(purp)q(ose)h(of)f(staging,)e(w)o(e)j(can)f(widen)g(the)g(scop)q(e)i
(of)150 424 y(applicabilit)o(y)12 b(of)h(the)h(slogan)f(ab)q(o)o(v)o(e)
h(b)o(y)g(restating)g(it)f(as:)303 524 y(Man)o(y)h(a)f(Program)g
(Generator)h(=)h(A)e(Con)o(v)o(en)o(tional)g(Program)f(+)i(Staging)f
(Annotations.)150 667 y FD(1.5)56 b(Thesis)18 b(and)h(Con)n(tributions)
150 784 y FI(Our)14 b(thesis)f(is)g(that)g(MetaML)g(is)g(a)g(w)o
(ell-designed)g(language)f(that)h(is)g(useful)g(in)f(dev)o(eloping)g
(meta-programs)150 859 y(and)i(program)e(generators.)j(W)m(e)e(break)h
(do)o(wn)g(the)g(thesis)h(in)o(to)e(three)j(main)11 b(h)o(yp)q
(otheses:)113 956 y(H1.)44 b(MetaML)14 b(is)g(a)f(useful)h(medium)d
(for)j(meta-programm)o(i)o(ng.)113 1027 y(H2.)44 b(MetaML)19
b(can)g(b)q(e)h(placed)f(on)g(a)g(standard,)f(formal)f(foundation)h
(whereb)o(y)i(staging)e(annotations)h(are)221 1101 y(view)o(ed)14
b(as)g(language)f(constructs)i(amenable)e(to)h(the)g(formal)e(tec)o
(hniques)j(of)e(programming)d(languages.)113 1172 y(H3.)44
b(MetaML)18 b(in)f(particular,)h(and)g(m)o(ulti-lev)o(el)d(languages)i
(in)h(general,)g(can)g(b)q(e)h(impro)o(v)o(ed)d(b)q(oth)i(in)g(their)
221 1247 y(design)13 b(and)h(implem)o(en)o(tation)c(b)o(y)k(what)f(w)o
(e)h(ha)o(v)o(e)f(learned)h(while)f(building)f(MetaML's)i(formal)d
(founda-)221 1321 y(tions.)150 1422 y(This)j(dissertation)g(presen)o
(ts)i(the)e(follo)o(wing)e(con)o(tributions)i(to)f(supp)q(ort)i(the)f
(h)o(yp)q(otheses:)150 1564 y FG(Application)o(s)d(of)j(MetaML)g
(\(H1\))19 b FI(W)m(e)12 b(ha)o(v)o(e)g(used)h(MetaML)g(to)f(dev)o
(elop)h(program)d(generators.)k(An)e(im-)150 1639 y(p)q(ortan)o(t)f(b)q
(ene\014t)i(of)e(the)g(approac)o(h)h(seems)f(to)g(b)q(e)h(its)f
(simplicit)o(y)e(and)i(transparency)m(.)h(F)m(urthermore,)f(MetaML)150
1713 y(has)i(b)q(een)h(a)f(p)q(o)o(w)o(erful)f(p)q(edagogical)g(to)q
(ol)g(for)h(explaining)e(the)i(w)o(orkings)g(of)f(partial)g(ev)n
(aluation)f(systems.)i(A)o(t)150 1788 y(the)18 b(same)e(time,)f(w)o(e)j
(ha)o(v)o(e)f(also)f(iden)o(ti\014ed)i(some)e(limitations)e(of)j(the)h
(approac)o(h,)e(and)h(iden)o(ti\014ed)h(w)o(a)o(ys)e(in)150
1863 y(whic)o(h)f(they)i(could)e(b)q(e)h(addressed)i(in)d(the)h
(future.)g(In)f(Chapter)i(3)e(w)o(e)h(presen)o(t)h(a)e(detailed)h
(example)e(proto-)150 1938 y(t)o(ypical)f(of)g(our)h(exp)q(erience.)150
2080 y FG(A)19 b(F)l(ormal)f(Basis)h(for)f(Multi-Stage)e(Programming)g
(\(H2\))24 b FI(W)m(e)17 b(presen)o(t)h(a)f(formal)d(seman)o(tics)i
(and)150 2154 y(a)f(t)o(yp)q(e)h(system)g(for)f(MetaML,)g(and)h(a)f
(common)e(framew)o(ork)h(that)i(uni\014es)g(previous)g(prop)q(osals)f
(for)g(formal)150 2229 y(foundations)f(for)g(high-lev)o(el)g(program)f
(generation)h(and)h(run-time)e(co)q(de)j(generation.)e(W)m(e)g(ha)o(v)o
(e)h(formalized)150 2304 y(the)h(seman)o(tics)f(in)g(t)o(w)o(o)f
(di\013eren)o(t)j(st)o(yles)e(\(big-step)h(st)o(yle)g(in)e(Chapter)i
(5,)f(and)g(reduction)h(st)o(yle)f(in)g(Chapter)150 2379
y(6\))f(and)f(ha)o(v)o(e)h(dev)o(elop)q(ed)h(a)e(t)o(yp)q(e)i(system)e
(\(Chapter)i(5\))f(for)f(MetaML)i(that)f(w)o(e)g(pro)o(v)o(ed)g(sound.)
150 2521 y FG(Impro)o(ving)d(the)h(Design)f(and)i(Implemen)o(tati)o(on)
d(of)i(MetaML)i(\(H3\))k FI(In)11 b(the)i(pro)q(cess)g(of)e
(formalizing)150 2595 y(the)17 b(seman)o(tics,)f(w)o(e)h(ha)o(v)o(e)g
(unco)o(v)o(ered)h(a)e(v)n(ariet)o(y)g(of)h(subtleties)g(and)g(some)f
(\015a)o(ws)h(in)f(the)h(early)g(implemen-)150 2670 y(tations)f(of)f
(MetaML)h(and)g(prop)q(osed)h(remedies)f(for)g(them.)e(Examples)h(of)g
(suc)o(h)i(\014ndings)f(are)g(presen)o(ted)i(in)p eop
%%Page: 13 24
13 23 bop 1882 0 a FB(13)150 192 y FI(Chapter)15 b(4.)f(F)m
(urthermore,)g(w)o(e)h(ha)o(v)o(e)g(iden)o(ti\014ed)g(extensions)g(to)g
(the)g(language)f(and)g(sho)o(w)o(ed)h(ho)o(w)g(they)g(can)150
266 y(b)q(e)e(incorp)q(orated)g(in)e(a)h(t)o(yp)q(e-safe)h(manner.)e
(In)h(particular,)f(w)o(e)i(presen)o(t)h(a)d(prop)q(osal)h(for)g
(extending)h(MetaML)150 341 y(with)h(a)f(t)o(yp)q(e)i(constructor)g
(for)f(closedness)h(in)f(Chapter)g(5.)150 499 y FD(1.6)56
b(Organization)18 b(and)h(Reading)f(Plans)150 632 y FI(This)c
(dissertation)g(is)f(organized)h(in)o(to)f(three)i(parts.)f(P)o(art)g
(I)f(in)o(tro)q(duces)i(MetaML,)e(and)h(pro)o(vides)g(examples)150
707 y(of)h(m)o(ulti-stage)e(programmi)o(ng)f(with)j(explicit)f
(annotations.)g(P)o(art)i(I)q(I)f(presen)o(ts)i(the)f(formal)c(seman)o
(tics)j(and)150 781 y(t)o(yp)q(e)d(system)g(that)f(w)o(e)h(prop)q(ose)g
(for)g(MetaML.)f(P)o(art)h(I)q(I)q(I)g(co)o(v)o(ers)g(related)g(w)o
(orks,)g(a)f(discussion)h(of)f(the)h(results,)150 856
y(and)i(concludes)h(the)f(dissertation.)150 939 y(The)g(follo)o(wing)e
(is)h(a)h(detailed)g(o)o(v)o(erview)g(of)f(the)h(three)h(parts.)150
1087 y FG(1.6.1)48 b(P)o(art)15 b(I)150 1203 y FI(Chapter)f(2)e(pro)o
(vides)h(the)h(basic)e(bac)o(kground)h(needed)i(for)d(dev)o(eloping)g
(m)o(ulti-stage)f(programs)h(in)g(MetaML,)150 1278 y(including:)176
1394 y FG({)21 b FI(The)13 b(in)o(tuitiv)o(e)f(seman)o(tics)g(of)g
(MetaML's)h(staging)f(annotations,)g(illustrated)g(b)o(y)h(some)f
(small)e(examples.)176 1468 y FG({)21 b FI(The)12 b(design)h
(principles)g(that)f(ha)o(v)o(e)g(shap)q(ed)h(MetaML.)g(W)m(e)f(stress)
i(the)f(no)o(v)o(elt)o(y)f(and)g(signi\014cance)h(of)e(t)o(w)o(o)221
1543 y(principles,)i(called)h(cross-stage)h(p)q(ersistence)i(and)d
(cross-stage)h(safet)o(y)m(.)176 1618 y FG({)21 b FI(Simple)12
b(t)o(w)o(o-stage)j(examples)e(of)h(m)o(ulti-stage)f(programmi)o(ng)f
(with)i(explicit)g(annotations.)f(The)i(exam-)221 1692
y(ples)f(illustrates)g(the)g(p)q(ositiv)o(e)g(role)g(of)f(t)o(yp)q(es)i
(in)e(the)i(dev)o(elopmen)o(t)e(metho)q(d.)176 1767 y
FG({)21 b FI(A)14 b(three-stage)h(example)e(of)g(m)o(ulti-stage)f
(programmi)o(ng)f(with)j(explicit)f(annotations.)150
1883 y(Chapter)k(3)g(presen)o(ts)i(an)d(extended)j(example)c(of)h(m)o
(ulti-stage)f(programming)e(with)k(explicit)f(annotations.)150
1958 y(This)h(example)f(sho)o(ws)h(that)g(while)g(dev)o(eloping)f
(staged)h(programs)f(can)i(b)q(e)f(c)o(hallenging,)e(b)q(orro)o(wing)i
(w)o(ell-)150 2033 y(kno)o(wn)d(tec)o(hniques)i(from)d(the)i(area)f(of)
g(partial)g(ev)n(aluation)f(can)i(yield)f(w)o(orth)o(while)g(results.)h
(W)m(e)f(consider)h(a)150 2107 y(simple)e(term-rewriting)h(system)h
(and)g(mak)o(e)e(a)i(\014rst)h(attempt)e(at)h(staging)f(it.)g(Searc)o
(hing)h(for)f(a)h(staged)g(t)o(yp)q(e)150 2182 y(for)d(this)g(system)g
(suggests)h(that)f(this)g(direct)h(attempt)f(migh)o(t)e(not)i(yield)f
(an)h(optimal)d(result.)k(Indeed,)f(w)o(e)h(\014nd)150
2257 y(that)f(this)h(is)f(the)g(case.)h(W)m(e)f(then)h(mak)o(e)e(a)g
(second)j(attempt)d(using)h(a)g(tec)o(hnique)h(that)f(has)h(b)q(een)g
(exploited)f(b)o(y)150 2332 y(users)i(of)e(o\013-line)f(partial)h(ev)n
(aluation)f(systems,)h(and)g(sho)o(w)g(that)h(this)f(approac)o(h)h
(yields)f(satisfactory)g(results.)150 2479 y FG(1.6.2)48
b(P)o(art)15 b(I)q(I)150 2595 y FI(Chapter)f(4)g(summarizes)e(the)i
(problems)f(that)h(m)o(ust)f(b)q(e)h(addressed)i(when)e(w)o(e)g(wish)f
(to)h(implemen)o(t)d(a)i(m)o(ulti-)150 2670 y(stage)h(programmi)o(ng)c
(language)i(suc)o(h)i(as)f(MetaML,)g(and)g(giv)o(es)g(examples)f(of)h
(ho)o(w)f(our)i(study)f(of)g(the)g(formal)p eop
%%Page: 14 25
14 24 bop 1882 0 a FB(14)150 192 y FI(seman)o(tics)10
b(impro)o(v)o(ed)f(our)i(understanding)g(of)f(MetaML)h(implemen)o
(tatio)o(ns.)d(These)k(problems)d(and)i(examples)150
266 y(pro)o(vide)21 b(the)g(motiv)n(ation)d(for)i(the)i(theoretical)f
(pursuit)g(presen)o(ted)i(in)d(the)i(rest)g(of)e(P)o(art)h(I)q(I.)g(W)m
(e)f(b)q(egin)150 341 y(b)o(y)c(reviewing)g(the)h(implemen)o(tatio)o(n)
d(problems)h(that)h(w)o(ere)h(kno)o(wn)f(when)h(MetaML)g(w)o(as)f
(\014rst)h(dev)o(elop)q(ed,)150 416 y(including)i(the)h(basic)g
(scoping)g(and)g(t)o(yping)f(problems.)f(W)m(e)i(then)g(describ)q(e)i
(the)e(seman)o(tics)g(of)f(a)g(simple)150 490 y(implemen)o(tatio)o(n)8
b(of)h(subset)j(of)d(MetaML)i(that)f(w)o(e)h(call)e FF(\025)p
FI(-M)1113 475 y FA(6)1132 490 y FI(.)g(This)h(simple)f(implemen)o
(tation)e(is)j(protot)o(ypical)150 565 y(of)15 b(ho)o(w)h(implemen)o
(tations)d(of)j(m)o(ulti-stage)e(languages)h(are)i(dev)o(elop)q(ed)g
(in)e(practice.)i(The)f(implemen)o(tation)150 640 y(allo)o(ws)c(us)h
(to)f(p)q(oin)o(t)h(out)f(a)h(new)g(set)h(of)e(problems,)f(including)h
(new)h(scoping)g(subtleties,)g(more)f(t)o(yping)g(issues,)150
715 y(and)h(the)h(need)g(for)f(a)g(b)q(etter)i(understanding)f(of)e
(what)i(MetaML)f(programs)f(can)i(b)q(e)f(considered)i(equiv)n(alen)o
(t.)150 789 y(This)f(c)o(hapter)h(is)f(illustrativ)o(e)f(of)g(the)i
(state)g(of)e(the)i(art)f(in)f(the)i(\(p)q(oten)o(tially)e(v)o
(eri\014able\))h(implemen)o(tation)d(of)150 864 y(m)o(ulti-stage)h
(programmi)o(ng)f(languages.)150 947 y(Chapter)16 b(5)f(presen)o(ts)j
(a)d(basic)g(t)o(yp)q(e)h(system)f(for)g(the)i FF(\025)p
FI(-M)e(subset)i(of)e(MetaML,)g(together)h(with)f(a)h(pro)q(of)f(of)150
1022 y(the)i(soundness)i(of)d(this)h(t)o(yp)q(e)g(system)g(with)f(resp)
q(ect)j(to)e(a)g(big-step)g(seman)o(tics)f(for)g FF(\025)p
FI(-M.)h(W)m(e)f(then)i(argue)150 1096 y(for)e(extending)h(the)h(t)o
(yp)q(e)f(system)f(and)h(presen)o(t)h(a)e(big-step)h(seman)o(tics)f
(for)h(the)g(a)f(prop)q(osed)i(extension)f(to)150 1171
y(MetaML)d(that)g(w)o(e)g(call)f FF(\025)572 1156 y FE(BN)s
FA(7)650 1171 y FI(.)h(The)g(c)o(hapter)h(presen)o(ts:)176
1287 y FG({)21 b FI(A)d(big-step)g(seman)o(tics.)f(A)h(big-step)g
(seman)o(tics)g(pro)o(vides)g(us)h(with)e(a)h(functional)f(seman)o
(tics.)g(It)h(is)g(a)221 1362 y(partial)12 b(function,)h(and)h
(therefore)h(resem)o(bles)f(an)g(in)o(terpreter)h(for)f(our)g
(language.)e(Because)k(\\ev)n(aluation)221 1437 y(under)e(lam)o(b)q
(da")c(is)j(explicit)g(in)g(this)g(seman)o(tics,)f(it)h(is)g(a)g(go)q
(o)q(d,)g(realistic)g(mo)q(del)e(of)i(m)o(ulti-stage)e(compu-)221
1512 y(tation.)f(Using)h(only)f(capture-free)k(substitution)d(in)g(suc)
o(h)h(a)f(seman)o(tics)g(is)g(the)h FH(essenc)n(e)j FI(of)c(static)g
(scoping.)221 1586 y(F)m(urthermore,)j(this)g(seman)o(tics)g
(illustrates)h(ho)o(w)f(MetaML)h(violates)f(one)h(of)f(the)h(basic)g
(assumptions)f(of)221 1661 y(man)o(y)9 b(w)o(orks)j(on)g(programmi)o
(ng)d(language)i(seman)o(tics,)f(namely)m(,)f(that)j(w)o(e)g(are)g
(dealing)f(only)g(with)g(closed)221 1736 y(terms.)176
1810 y FG({)21 b FI(A)15 b(T)o(yp)q(e-safet)o(y)h(result.)g(W)m(e)f
(sho)o(w)g(that)h(a)f(basic)h(t)o(yp)q(e)g(system)f(for)g
FF(\025)p FI(-M)h(guaran)o(tees)g(run-time)f(safet)o(y)m(,)221
1885 y(based)f(on)g(an)f(augmen)o(ted)g(big-step)h(seman)o(tics.)176
1960 y FG({)21 b FI(Closedness)14 b(t)o(yp)q(es.)f(After)h(explaining)d
(an)i(expressivit)o(y)h(problem)d(in)i(the)h(basic)f(t)o(yp)q(e)g
(system)g(presen)o(ted)221 2035 y(for)h FF(\025)p FI(-M,)h(w)o(e)g(sho)
o(w)g(ho)o(w)f(this)h(problem)f(can)h(b)q(e)h(remedied)e(b)o(y)h(in)o
(tro)q(ducing)g(a)f(sp)q(ecial)h(t)o(yp)q(e)h(for)e(closed)221
2109 y(v)n(alues.)d(This)g(extension)i(pa)o(v)o(es)f(the)g(w)o(a)o(y)f
(for)h(a)f(new)i(and)e(more)g(expressiv)o(e)j(form)c(of)h(the)h(Run)g
(construct.)150 2226 y(This)e(c)o(hapter)i(represen)o(ts)h(the)e(state)
g(of)f(the)h(art)f(in)g(\(un)o(t)o(yp)q(ed\))h(seman)o(tics)f(and)g(t)o
(yp)q(e)h(systems)g(for)f(m)o(ulti-stage)150 2300 y(programming)g
(languages.)p 150 2381 237 2 v 158 2407 a Fz(6)188 2423
y FB(The)j(letter)h(M)f(stands)h(for)e(MetaML.)158 2453
y Fz(7)188 2469 y FB(The)g(letters)g(B)g(and)h(N)e(stand)h(for)g(Bo)o
(x)g(and)g(Next,)g(resp)q(ectiv)o(ely)m(,)h(after)f(the)g(names)g(of)g
(the)f(logical)k(mo)q(dalities)f(used)188 2522 y(in)f(the)f(w)o(ork)g
(of)f(Da)o(vies)j(and)e(Pfenning)h([23,)7 b(22].)k(It)g(should)j(b)q(e)
e(noted,)g(ho)o(w)o(ev)o(er,)g(that)g Fx(\025)1515 2506
y Fw(BN)1582 2522 y FB(no)g(longer)h(has)g(a)e(t)o(yp)q(e)188
2568 y(for)i(closed)h(co)q(de,)g(but)f(rather,)g(a)g(t)o(yp)q(e)g(for)g
(closedness.)p eop
%%Page: 15 26
15 25 bop 1882 0 a FB(15)150 192 y FI(Chapter)15 b(6)e(presen)o(ts)j(a)
e(reduction)g(seman)o(tics)g(for)f(a)h(subset)h(of)f(MetaML)g(that)g(w)
o(e)g(call)f FF(\025)p FI(-U)1655 176 y FA(8)1674 192
y FI(.)h(The)g(c)o(hapter)150 266 y(presen)o(ts:)176
382 y FG({)21 b FI(A)15 b(reduction)h(seman)o(tics.)e(The)h(reduction)h
(seman)o(tics)f(is)g(a)g(set)h(of)e(directed)j(rewrite)f(rules.)f(In)o
(tuitiv)o(ely)m(,)221 457 y(the)f(rewrite)h(rules)f(capture)h(the)g
(\\notions)e(of)h(reduction")g(in)f(MetaML.)176 532 y
FG({)21 b FI(Sub)r(ject)c(reduction.)g(W)m(e)f(sho)o(w)g(that)h(eac)o
(h)f(reduction)i(preserv)o(es)g(t)o(yping)e(under)h(the)g(t)o(yp)q(e)g
(system)f(for)221 607 y FF(\025)p FI(-M.)176 681 y FG({)21
b FI(Con\015uence.)e(This)f(result)h(is)f(an)f(indicator)h(of)g(the)g
(w)o(ell-b)q(eha)o(v)o(edness)i(of)d(our)h(notions)g(of)g(reduction.)
221 756 y(It)d(states)i(that)f(the)g(result)h(of)e(an)o(y)g(t)o(w)o(o)h
(\(p)q(ossibly)f(di\013eren)o(t\))i(sequences)h(of)d(reduction)i(can)f
(alw)o(a)o(ys)e(b)q(e)221 831 y(reduced)h(to)f(a)g(common)d(term.)176
906 y FG({)21 b FI(Soundness.)e(This)f(result)i(has)e(t)o(w)o(o)g
(parts.)h(First,)f(all)g(what)g(can)h(b)q(e)g(ac)o(hiev)o(ed)g(b)o(y)f
(the)h FF(\025)p FI(-M)g(big-step)221 980 y(seman)o(tics,)11
b(can)j(b)q(e)f(ac)o(hiev)o(ed)g(b)o(y)g(the)g(reductions.)h(Second,)f
(applying)f(the)h(reductions)h(to)f(an)o(y)f(subterm)221
1055 y(of)18 b(a)h(program)f(do)q(es)i(not)f(c)o(hange)h(the)g
(termination)d(b)q(eha)o(vior)i(of)g(the)h FF(\025)p
FI(-M)f(big-step)h(seman)o(tics.)e(In)221 1130 y(essence,)h(this)e
(result)h(establishes)g(that)f FF(\025)p FI(-U)g(and)g
FF(\025)p FI(-M)g(are)h(\\equiv)n(alen)o(t")d(form)o(ulations)g(of)h
(the)i(same)221 1204 y(language.)150 1321 y(This)11 b(c)o(hapter)g
(presen)o(ts)i(new)e(results)h(on)f(the)g(un)o(t)o(yp)q(ed)h(seman)o
(tics)e(of)g(m)o(ulti-stage)f(programmi)o(ng)f(languages.)150
1468 y FG(1.6.3)48 b(P)o(art)15 b(I)q(I)q(I)150 1585
y FI(Chapter)d(7)g(summarizes)e(related)i(w)o(ork)f(and)g(p)q(ositions)
h(our)f(con)o(tributions)h(in)f(the)h(con)o(text)h(of)e(programmi)o(ng)
150 1659 y(languages,)i(partial)g(ev)n(aluation,)f(and)h(program)g
(generation)h(researc)o(h.)h(The)f(c)o(hapter)h(presen)o(ts:)176
1776 y FG({)21 b FI(A)14 b(summary)d(of)i(k)o(ey)h(dev)o(elopmen)o(ts)g
(in)f(m)o(ulti-lev)o(el)e(sp)q(ecialization)i(and)h(languages.)176
1850 y FG({)21 b FI(A)15 b(brief)g(review)g(of)g(the)g(history)g(of)g
(quasi-quotations,)e(revisiting)i(Quine's)g(original)e(w)o(ork)i(and)g
(LISP's)221 1925 y(bac)o(k-quote)f(and)f(comma)e(mec)o(hanism.)150
2041 y(In)16 b(Chapter)g(8)f(w)o(e)h(appraise)f(our)h(\014ndings,)f
(outline)g(directions)h(for)f(future)h(w)o(orks,)f(and)h(conclude)g
(the)g(dis-)150 2116 y(sertation.)150 2199 y(App)q(endix)g(A)f(presen)o
(ts)i(some)e(remarks)f(on)h(an)g(in)o(termediate)g(language)f(that)i(w)
o(e)f(do)g(not)g(dev)o(elop)g(fully)f(in)150 2274 y(this)g
(dissertation,)g(but)g(w)o(e)g(in)o(tend)g(to)g(study)g(in)g(more)e
(detail)i(in)f(future)i(w)o(ork.)p 150 2354 237 2 v 158
2381 a Fz(8)188 2397 y FB(W)m(e)i(call)h(this)f(reduction)i(seman)o
(tics)f Fx(\025)p FB(-U)e(to)g(a)o(v)o(oid)i(asserting)g
FC(a)f(priori)e FB(that)i(it)g(is)g(equiv)n(alen)o(t)i(to)e(the)g
(big-step)188 2442 y(seman)o(tics)c(\()p Fx(\025)p FB(-M\).)f(The)f
(letter)i(U)e(is)h(the)g(last)g(in)h(the)f(sequence)h(R,)e(S,)g(T,)g
(U.)g(Our)h(\014rst)g(attempt)g(at)f(a)h(calculus)i(w)o(as)188
2488 y(called)e Fx(\025)p FB(-R.)e(W)m(e)g(ha)o(v)o(e)h(included)h
Fx(\025)p FB(-T)e(in)h(App)q(endix)h(A)d(b)q(ecause)i(it)g(ma)o(y)f(ha)
o(v)o(e)g(applicatio)q(ns)j(in)e(the)f(implemen)o(tation)188
2534 y(of)j(m)o(ulti-stage)i(languages,)g(but)e(it)g(is)h(not)f(as)g
(suitable)j(as)d Fx(\025)p FB(-U)g(for)f(the)h(purp)q(ose)i(of)d
(equational)k(reasoning.)p eop
%%Page: 16 27
16 26 bop 1882 0 a FB(16)150 192 y FG(1.6.4)48 b(Reading)14
b(Plans)150 308 y FI(The)f(reader)g(in)o(terested)h(primarily)9
b(in)j(the)h(practice)g(of)e(writing)g(program)g(generators,)i(and)f
(the)g(relev)n(ance)i(of)150 382 y(MetaML)g(and)f(m)o(ulti-stage)e
(programmi)o(ng)f(to)j(program)f(generation)i(ma)o(y)d(\014nd)i
(Chapters)h(1)f(to)g(3)g(to)g(b)q(e)h(the)150 457 y(most)i(useful.)g
(The)i(reader)g(in)o(terested)h(in)d(understanding)i(the)f
(di\016culties)g(in)f(implemen)o(ting)e(m)o(ulti-stage)150
532 y(languages)g(suc)o(h)i(as)f(MetaML)g(as)g(extensions)h(of)e
(existing)g(programming)e(languages)i(ma)o(y)f(\014nd)i(Chapter)g(4)150
607 y(\(skipping)c(Section)h(4.6.2\))e(to)i(b)q(e)g(the)g(most)f
(useful,)g(and)g(Chapter)i(2)e(can)h(serv)o(e)h(as)e(a)h(complete)f(in)
o(tro)q(duction.)150 690 y(The)i(reader)h(in)o(terested)h(primarily)10
b(in)i(the)i(formal)c(seman)o(tics)i(of)g(m)o(ulti-lev)o(el)e
(languages)j(ma)o(y)d(\014nd)j(Chapter)150 764 y(5)j(and)f(6)h(to)f(b)q
(e)i(the)f(most)f(useful,)g(and)h(Chapter)h(2)e(\(and)h(Section)g
(4.6.2\))e(can)i(again)f(serv)o(e)i(as)f(a)g(complete)150
839 y(in)o(tro)q(duction.)150 922 y(Chapter)e(7)f(is)g(primarily)e(for)
i(readers)i(in)o(terested)g(in)e(b)q(ecoming)f(more)g(acquain)o(ted)i
(with)f(the)h(related)f(litera-)150 997 y(ture)i(on)e(m)o(ulti-stage)f
(languages.)150 1080 y(Chapter)k(8)f(is)g(primarily)d(for)j(readers)i
(in)o(terested)f(in)f(the)h(summary)c(of)j(\014ndings)g(presen)o(ted)i
(in)e(this)g(disser-)150 1155 y(tation)e(and)h(an)g(o)o(v)o(erview)f
(of)h(op)q(en)g(problems.)p eop
%%Page: 17 28
17 27 bop 907 968 a FL(P)m(art)32 b(I)322 1221 y Fv(The)38
b(Practice)i(of)e(Multi-Stage)687 1383 y(Programming)p
eop
%%Page: 18 29
18 28 bop 822 436 a FL(Chapter)31 b(2)582 662 y(MetaML)h(and)g(Staging)
949 875 y FC(A)o(l)r(l)13 b(the)g(world's)g(a)g(stage,)949
935 y(A)o(nd)g(al)r(l)g(the)f(men)i(and)e(women)i(mer)n(ely)f(players:)
949 994 y(They)g(have)g(their)f(exits)h(and)f(their)h(entr)n(anc)n(es;)
949 1053 y(A)o(nd)g(one)f(man)i(in)f(his)f(time)i(plays)e(many)h(p)n
(arts...)1443 1146 y FB(Jacques,)h(Act)e(2,)h(Scene)h(7,)1375
1205 y FC(As)f(Y)m(ou)g(Like)f(it)p FB(,)g(Shak)o(esp)q(eare)150
1385 y FI(This)e(c)o(hapter)g(in)o(tro)q(duces)h(staging)e(and)h
(MetaML.)g(W)m(e)f(presen)o(t)i(MetaML's)f(staging)f(constructs)j(and)e
(explain)150 1460 y(ho)o(w)16 b(staging,)g(ev)o(en)i(at)e(a)h(fairly)f
(abstract)h(lev)o(el,)f(can)h(b)q(e)h(useful)f(for)f(impro)o(ving)f(p)q
(erformance.)h(Then,)h(w)o(e)150 1535 y(explain)e(the)i(k)o(ey)f
(design)g(c)o(hoices)h(in)f(MetaML)h(and)e(illustrate)h(MetaML's)h
(utilit)o(y)d(in)i(staging)f(three)j(w)o(ell-)150 1610
y(kno)o(wn)13 b(functions.)150 1768 y FD(2.1)56 b(MetaML)18
b(the)g(Conceptual)h(F)-5 b(ramew)n(ork)150 1901 y FI(A)13
b(go)q(o)q(d)g(formalism)c(for)k(staging)g(should)g(allo)o(w)e(us)j(to)
f(explain)f(the)i(concept)g(of)f(staging)g(clearly)m(.)f(In)h(essence,)
150 1976 y(staging)k(is)g(altering)g(a)g(program's)f(order)i(of)f(ev)n
(aluation)f(in)h(order)i(to)e(c)o(hange)h(the)g(cost)g(of)f(its)h
(execution.)150 2050 y(MetaML)c(is)g(a)f(go)q(o)q(d)g(formalism)d(for)j
(staging)g(b)q(ecause)j(it)d(pro)o(vides)h(four)g(staging)f
(annotations)g(that)g(can)h(b)q(e)150 2125 y(used)h(to)f(explain)f(suc)
o(h)h(alterations:)168 2241 y(1.)20 b(Brac)o(k)o(ets)15
b Fy(h)p 408 2241 13 2 v 15 w(i)f FI(for)f(dela)o(ying)g(a)h
(computation,)168 2316 y(2.)20 b(Escap)q(e)c FE(~)p 386
2316 V 30 w FI(for)d(com)o(bining)f(dela)o(y)o(ed)i(computations,)168
2391 y(3.)20 b(Run)13 b FE(run)p 382 2391 V 41 w FI(for)h(executing)h
(a)e(dela)o(y)o(ed)h(computation,)e(and)168 2466 y(4.)20
b(Lift)13 b FE(lift)p 362 2466 V 40 w FI(for)g(constructing)i(a)f(dela)
o(y)o(ed)f(computation)f(from)h(a)g(\(ground\))h(v)n(alue.)150
2582 y(With)f(just)i(this)f(abstract)h(description)g(of)e(MetaML's)i
(annotations,)e(w)o(e)h(can)g(explain)g(ho)o(w)g(one)g(can)g(reduce)150
2656 y(the)g(cost)h(of)e(a)h(program)e(using)i(staging.)1014
2795 y(18)p eop
%%Page: 19 30
19 29 bop 1882 0 a FB(19)150 192 y FG(2.1.1)48 b(Staging)14
b(and)h(Reducing)e(Cost)150 298 y FI(Although,)18 b(MetaML)i(is)f(a)g
(call-b)o(y-v)n(alue)f(\(CBV\))i(language,)e(the)i(cost)g(of)e
(executing)i(a)f(program)f(under)150 373 y(b)q(oth)d(CBV)g(and)g
(call-b)o(y-name)d(\(CBN\))k(seman)o(tics)e(can)h(b)q(e)g(reduced)i(b)o
(y)d(staging.)g(Consider)h(the)h(follo)o(wing)150 448
y(computation:)221 542 y FE(\(fn)e(f)f Fy(\))h FE(\(f)f(9\)+\(f)h
(13\)\))g(\(fn)g(x)g Fy(\))f FE(x+\(7*2\)\).)150 633
y FI(Ignore)j(the)g(fact)f(that)g(part)h(or)f(all)f(of)h(this)g
(computation)f(can)h(b)q(e)h(p)q(erformed)f(b)o(y)h(an)f(optimizing)d
(compiler)150 708 y(b)q(efore)e(a)f(program)f(is)i(executed.)g(Suc)o(h)
g(optimizing)d(compilers)i(constitute)h(an)f(additional)f(lev)o(el)h
(of)g(complexit)o(y)150 783 y(that)16 b(w)o(e)g(are)g(not)g(concerned)i
(with)d(at)h(the)g(momen)o(t.)d(Consider)j(a)g(cost)g(mo)q(del)e(where)
j(w)o(e)f(coun)o(t)g(only)f(the)150 858 y(n)o(um)o(b)q(er)i(of)h
(arithmetic)f(op)q(erations)i(p)q(erformed.)e(W)m(e)h(mak)o(e)e(this)j
(c)o(hoice)f(only)g(for)f(simplicit)o(y)m(.)e(This)j(cost)150
932 y(mo)q(del)f(is)i(realistic)f(in)g(situations)h(where)g(the)g
(arithmetic)f(op)q(erations)h(in)f(the)h(program)e(ab)q(o)o(v)o(e)h
(stand)h(in)150 1007 y(place)14 b(of)f(more)g(costly)h(op)q(erations.)
150 1090 y(Ev)n(aluating)f(the)i(program)e(ab)q(o)o(v)o(e)h(under)h
(CBV)g(seman)o(tics)f(pro)q(ceeds)i(as)f(follo)o(ws)e(\(the)i(cost)g
(of)f(eac)o(h)h(step)g(is)150 1165 y(indicated)f(b)o(y)g(\\...)e
FF(n)h FI(arith)h(op\(s\)"\):)168 1269 y(1.)20 b FE(\(\(fn)14
b(x)g Fy(\))f FE(x+\(7*2\)\))h(9\)+\(\(fn)h(x)f Fy(\))f
FE(x+\(7*2\)\))h(13\))f FI(...)g(0)g(arith)h(ops)168
1341 y(2.)20 b FE(\(9+\(7*2\)\)+\(13+\(7*2\)\))13 b FI(...)g(0)g(arith)
h(ops)168 1414 y(3.)20 b FE(50)13 b FI(...)f(5)i(arith)g(ops)150
1520 y(The)21 b(total)f(cost)i(is)e(5)h(ops.)f(Ev)n(aluating)f(the)j
(same)e(computation)f(under)i(CBN)g(seman)o(tics)g(pro)q(ceeds)h(in)150
1595 y(essen)o(tially)14 b(the)g(same)f(w)o(a)o(y)m(.)g(Again,)f(the)j
(total)e(cost)h(is)g(5.)150 1733 y FG(2.1.2)48 b(Staging)14
b(Reduces)g(Cost)i(in)e(CBV)150 1840 y FI(In)g(the)g(CBV)h(setting,)f
(w)o(e)g(can)g(stage)g(our)g(computation)e(as)i(follo)o(ws:)221
1934 y FE(\(fn)g(f)f Fy(\))h FE(\(f)f(9\)+\(f)h(13\)\))g(\(run)e
Fy(h)q FE(fn)i(x)g Fy(\))f FE(x+)q(~)q(\(lift)f(\(7*2\)\))p
Fy(i)o FE(\).)150 2025 y FI(Ev)n(aluating)g(this)i(staged)h
(computation)d(under)i(CBV)h(seman)o(tics)e(pro)q(ceeds)j(as)e(follo)o
(ws:)168 2130 y(1.)20 b FE(\(fn)14 b(f)f Fy(\))h FE(\(f)f(x\)+\(f)h
(y\)\))h(\(run)d Fy(h)q FE(fn)i(x)g Fy(\))f FE(x+)q(~)q(\(lift)f(14\))p
Fy(i)o FE(\))i FI(...)f(1)g(arith)h(op)168 2202 y(2.)20
b FE(\(fn)14 b(f)f Fy(\))h FE(\(f)f(x\)+\(f)h(y\)\))h(\(run)d
Fy(h)q FE(fn)i(x)g Fy(\))f FE(x+)q(~)q Fy(h)q FE(14)p
Fy(i)o(i)p FE(\))h FI(...)f(0)g(arith)h(ops)168 2274
y(3.)20 b FE(\(fn)14 b(f)f Fy(\))h FE(\(f)f(x\)+\(f)h(y\)\))h(\(run)d
Fy(h)q FE(fn)i(x)g Fy(\))f FE(x+14)p Fy(i)p FE(\))h FI(...)e(0)i(arith)
g(ops)168 2346 y(4.)20 b FE(\(fn)14 b(f)f Fy(\))h FE(\(f)f(x\)+\(f)h
(y\)\))h(\(fn)f(x)g Fy(\))f FE(x+14\))h FI(...)e(0)i(arith)g(ops)168
2419 y(5.)20 b FE(\(\(\(fn)14 b(x)g Fy(\))f FE(x+14\))h(9\)+\(\(fn)h(x)
f Fy(\))f FE(x+14\))h(13\)\))g FI(...)e(0)i(arith)f(ops)168
2491 y(6.)20 b FE(\(\(9+14\)+\(13+14\)\))13 b FI(...)g(0)g(arith)h(ops)
168 2563 y(7.)20 b FE(50)13 b FI(...)f(3)i(arith)g(ops)150
2670 y(The)g(staged)h(v)o(ersion)f(costs)h(1)e(op)h(less.)p
eop
%%Page: 20 31
20 30 bop 1882 0 a FB(20)150 192 y FG(2.1.3)48 b(Staging)14
b(Reduces)g(Cost)i(in)e(CBN)150 308 y FI(In)g(the)g(CBN)h(setting,)f(w)
o(e)g(can)g(stage)g(our)g(computation)e(as)i(follo)o(ws:)221
414 y FE(run)e Fy(h)p FE(\(fn)i(f)g Fy(\))f FE(\(f)h(9\)+\(f)g(13\)\))f
(\(fn)i(x)f Fy(\))f FE(x+)q(~)q(\(lift)f(\(7*2\)\)\))p
Fy(i)p FE(.)150 515 y FI(Ev)n(aluating)g(the)j(staged)f(computation)e
(ab)q(o)o(v)o(e)i(under)h(CBN)f(seman)o(tics)f(pro)q(ceeds)j(as)e
(follo)o(ws:)168 631 y(1.)20 b FE(run)12 b Fy(h)p FE(\(fn)i(f)g
Fy(\))f FE(\(f)h(9\)+\(f)g(13\)\))f(\(fn)i(x)f Fy(\))f
FE(x+)q(~)q(\(lift)f(14\)\))p Fy(i)h FI(...)g(1)g(arith)h(ops)168
706 y(2.)20 b FE(run)12 b Fy(h)p FE(\(fn)i(f)g Fy(\))f
FE(\(f)h(9\)+\(f)g(13\)\))f(\(fn)i(x)f Fy(\))f FE(x+)q(~)q
Fy(h)q FE(14)p Fy(i)o FE(\))p Fy(i)h FI(...)f(0)g(arith)h(ops)168
781 y(3.)20 b FE(run)12 b Fy(h)p FE(\(fn)i(f)g Fy(\))f
FE(\(f)h(9\)+\(f)g(13\)\))f(\(fn)i(x)f Fy(\))f FE(x+14\))p
Fy(i)h FI(...)e(0)i(arith)g(ops)168 856 y(4.)20 b FE(\(fn)14
b(f)f Fy(\))h FE(\(f)f(9\)+\(f)h(13\)\))g(\(fn)g(x)g
Fy(\))f FE(x+14\))h FI(...)e(0)i(arith)g(ops)168 930
y(5.)20 b FE(\(\(\(fn)14 b(x)g Fy(\))f FE(x+14\))h(9\)+\(\(fn)h(x)f
Fy(\))f FE(x+14\))h(13\)\))g FI(...)e(0)i(arith)f(ops)168
1005 y(6.)20 b FE(\(9+14\)+\(13+14\))13 b FI(...)g(0)g(arith)h(ops)168
1080 y(7.)20 b FE(50)13 b FI(...)f(3)i(arith)g(ops)150
1196 y(The)c(cost)h(is)e(again)g(1)g(op)h(less)g(than)g(without)f
(staging.)g(It)h(is)f(in)g(this)h(sense)i(that)d(staging)g(giv)o(es)h
(the)g(programmer)150 1271 y(con)o(trol)k(o)o(v)o(er)g(the)g(ev)n
(aluation)f(order)h(in)g(a)f(manner)g(that)h(can)g(b)q(e)h(exploited)e
(to)h(enhance)h(p)q(erformance.)150 1354 y(Ha)o(ving)10
b(explained)i(the)g(concept)g(of)f(staging,)f(w)o(e)i(are)g(no)o(w)f
(ready)g(to)h(in)o(tro)q(duce)g(MetaML)g(the)g(programmi)o(ng)150
1428 y(language.)150 1587 y FD(2.2)56 b(MetaML)18 b(the)g(Programming)e
(Language)150 1720 y FI(MetaML)h(is)f(a)g(functional)g(programmi)o(ng)d
(language)j(with)g(sp)q(ecial)h(constructs)h(for)e(staging)g(programs.)
f(In)150 1795 y(addition)e(to)h(most)f(features)i(of)e(SML,)h(MetaML)g
(pro)o(vides)g(the)h(follo)o(wing)c(sp)q(ecial)j(supp)q(ort)h(for)f(m)o
(ulti-stage)150 1869 y(programming)o(:)176 1986 y FG({)21
b FI(F)m(our)16 b(staging)g(annotations,)f(whic)o(h)h(w)o(e)h(b)q
(eliev)o(e)g(are)g(a)f(go)q(o)q(d)g(basis)h(for)f(general-purp)q(ose)i
(m)o(ulti-stage)221 2060 y(programmi)o(ng.)176 2135 y
FG({)j FI(Static)12 b(t)o(yp)q(e-c)o(hec)o(king)i(and)e(a)h(p)q
(olymorphic)e(t)o(yp)q(e-inference)j(system.)e(In)h(MetaML,)g(a)f(m)o
(ulti-stage)f(pro-)221 2210 y(gram)16 b(is)j(t)o(yp)q(e-c)o(hec)o(k)o
(ed)h(once)f(and)g(for)f(all)f(b)q(efore)i(it)g(b)q(egins)g(executing,)
f(ensuring)h(the)h(safet)o(y)e(of)g(all)221 2284 y(computations)d(in)h
(all)f(stages.)i(This)g(feature)g(of)f(MetaML)h(is)g(sp)q(ecially)f
(useful)h(in)f(systems)h(where)g(the)221 2359 y(later)d(stages)g(are)h
(executed)g(when)g(the)f(original)e(programmer)g(is)i(no)f(longer)h
(around.)176 2434 y FG({)21 b FI(Static)13 b(scoping)h(for)g(b)q(oth)g
(meta-lev)o(el)e(and)i(ob)r(ject-lev)o(el)g(v)n(ariables.)150
2550 y(MetaML)19 b(implemen)o(ts)d(dela)o(y)o(ed)i(computations)f(as)i
(abstract)g(syn)o(tax)g(trees)h(represen)o(ting)g(MetaML)f(pro-)150
2625 y(grams.)12 b(The)i(four)g(MetaML)g(staging)f(constructs)j(are)f
(implem)o(en)o(ted)d(as)i(follo)o(ws:)p eop
%%Page: 21 32
21 31 bop 1882 0 a FB(21)168 192 y FI(1.)20 b(Brac)o(k)o(ets)15
b Fy(h)p 408 192 13 2 v 15 w(i)f FI(construct)h(a)f(co)q(de)h(fragmen)o
(t,)168 265 y(2.)20 b(Escap)q(e)c FE(~)p 386 265 V 30
w FI(com)o(bines)d(co)q(de)h(fragmen)o(ts,)168 339 y(3.)20
b(Run)13 b FE(run)p 382 339 V 41 w FI(executes)k(a)c(co)q(de)i(fragmen)
o(t,)d(and)168 413 y(4.)20 b(Lift)13 b FE(lift)p 363
413 V 40 w FI(constructs)j(a)e(co)q(de)h(fragmen)o(t)d(from)g(a)i
(ground)g(v)n(alue,)f(suc)o(h)i(that)f(the)g(co)q(de)h(fragmen)o(t)e
(repre-)221 487 y(sen)o(ts)i(the)f(ground)g(v)n(alue.)150
607 y(In)g(this)g(section,)g(w)o(e)g(explain)f(the)i(in)o(tuitiv)o(e)e
(seman)o(tics)g(of)g(eac)o(h)i(of)e(these)i(four)f(constructs.)150
751 y FG(2.2.1)48 b(Brac)o(k)o(ets)150 863 y FI(Brac)o(k)o(ets)18
b(can)e(b)q(e)h(inserted)g(around)g(an)o(y)e(expression)j(to)e(dela)o
(y)g(its)g(execution.)g(MetaML)h(implemen)o(ts)d(de-)150
938 y(la)o(y)o(ed)j(expressions)j(b)o(y)e(building)e(a)i(represen)o
(tation)i(of)d(the)i(source)g(co)q(de.)f(While)f(using)h(the)h(source)g
(co)q(de)150 1012 y(represen)o(tation)g(is)f(not)f(the)i(only)e(w)o(a)o
(y)g(of)g(implem)o(en)o(ting)e(dela)o(y)o(ed)i(expressions,)i(it)e(is)h
(the)g(simplest.)f(The)150 1087 y(follo)o(wing)11 b(short)k(in)o
(teractiv)o(e)f(session)h(illustrates)f(the)g(b)q(eha)o(vior)g(of)f
(Brac)o(k)o(ets)i(in)f(MetaML:)221 1188 y FE(-)p Fy(j)f
FE(val)h(result0)g(=)g(1+5;)221 1253 y(val)f(result0)i(=)f(6)g(:)f(int)
221 1383 y(-)p Fy(j)g FE(val)h(co)q(de0)g(=)h Fy(h)p
FE(1+5)p Fy(i)p FE(;)221 1447 y(val)e(co)q(de0)i(=)f
Fy(h)q FE(1)p Fu(\045)o FE(+5)p Fy(i)g FE(:)f Fy(h)q
FE(int)p Fy(i)p FE(.)150 1545 y FI(The)k(p)q(ercen)o(tage)h(signs)e(in)
g Fu(\045)o FI(+)h(simply)d(indicates)i(that)h FE(+)f
FI(is)g(not)g(a)g(free)h(v)n(ariable.)e(The)h(reader)i(can)e(treat)150
1619 y(suc)o(h)f(p)q(ercen)o(tage)g(signs)f(as)g(white)g(space)h(un)o
(til)e(their)h(signi\014cance)h(is)e(explained)h(in)g(Section)g(2.3.1.)
150 1702 y(In)h(addition)f(to)h(dela)o(ying)e(the)j(computation,)d
(Brac)o(k)o(ets)j(are)f(also)g(re\015ected)i(in)d(the)i(t)o(yp)q(e.)f
(The)g(t)o(yp)q(e)h(in)e(the)150 1777 y(last)g(declaration)f(is)h
Fy(h)p FE(int)p Fy(i)q FI(,)f(read)h FH(\\Co)n(de)h(of)g(Int")p
FI(.)f(The)g(co)q(de)h(t)o(yp)q(e)f(constructor)i(is)e(the)g(primary)e
(devise)j(that)150 1852 y(the)j(t)o(yp)q(e)h(system)f(uses)h(for)e
(distinguishing)g(dela)o(y)o(ed)h(v)n(alues)f(from)f(other)j(v)n(alues)
e(and)h(prev)o(en)o(ts)h(the)g(user)150 1927 y(from)12
b(acciden)o(tally)h(attempting)g(unsafe)h(op)q(erations)g(suc)o(h)h(as)
f FE(1+)p Fy(h)p FE(5)p Fy(i)p FI(.)150 2070 y FG(2.2.2)48
b(Escap)q(e)150 2183 y FI(Escap)q(e)12 b(allo)o(ws)e(the)i(com)o
(bination)c(of)j(smaller)e(dela)o(y)o(ed)i(v)n(alues)g(to)g(construct)h
(larger)f(ones.)h(This)e(com)o(bination)150 2257 y(is)h(ac)o(hiev)o(ed)
h(b)o(y)f(\\splicing-in")f(the)i(argumen)o(t)e(of)h(the)h(Escap)q(e)h
(in)e(the)h(con)o(text)g(of)e(the)i(surrounding)g(Brac)o(k)o(ets:)221
2359 y FE(-)p Fy(j)h FE(val)h(co)q(de1)g(=)h Fy(h)p FE(\()q(~)q(co)q
(de0,)q(~)r(co)q(de0\))p Fy(i)q FE(;)221 2423 y(val)e(co)q(de1)i(=)f
Fy(h)q FE(\(1)p Fu(\045)o FE(+5,1)p Fu(\045)o FE(+5\))p
Fy(i)g FE(:)g Fy(h)p FE(int)g(*)g(int)p Fy(i)p FE(.)150
2521 y FI(This)e(declaration)g(binds)g FE(co)q(de1)h
FI(to)f(a)f(new)i(dela)o(y)o(ed)f(computation,)d(represen)o(ting)14
b(a)e(tuple)g(of)g(t)o(w)o(o)f(arithmetic)150 2595 y(expressions.)17
b(Escap)q(e)g(com)o(bines)d(dela)o(y)o(ed)i(computations)e(e\016cien)o
(tly)h(in)g(the)i(sense)g(that)e(the)h(com)o(bination)150
2670 y(of)f(the)h(sub)q(comp)q(onen)o(ts)g(of)f(the)i(new)f
(computation)e(is)h(p)q(erformed)h(while)f(the)h(new)g(computation)e
(is)i(b)q(eing)p eop
%%Page: 22 33
22 32 bop 1882 0 a FB(22)150 192 y FH(c)n(onstructe)n(d)p
FI(,)10 b(rather)h(than)g(while)f(it)g(is)g(b)q(eing)h
FH(exe)n(cute)n(d)p FI(.)f(This)h(subtle)g(distinction)f(is)g(crucial)g
(for)g(staging.)g(And)150 266 y(as)16 b(w)o(e)f(will)f(see)j(in)e
(examples)f(to)i(come,)e(this)h(particular)h(b)q(eha)o(vior)f(of)g
(Escap)q(e)i(can)e(mak)o(e)f(a)h(big)g(di\013erence)150
341 y(in)e(the)i(run-time)e(p)q(erformance)g(of)h(the)g(dela)o(y)o(ed)g
(computation.)150 489 y FG(2.2.3)48 b(Run)150 605 y FI(Run)13
b(allo)o(ws)e(the)j(execution)g(of)e(a)h(co)q(de)g(fragmen)o(t.)e(Ha)o
(ving)h(Run)h(in)f(the)i(language)e(is)h(imp)q(ortan)o(t)e(if)h(w)o(e)h
(w)o(an)o(t)150 680 y(to)i(use)i(co)q(de)f(constructed)i(using)d(the)h
(other)g(MetaML)g(constructs,)i FH(without)d(going)i(outside)g(the)g
(language)p FI(.)150 754 y(This)d(added)f(expressivit)o(y)i(mak)o(es)d
(Run)i(imp)q(ortan)o(t)d(from)h(b)q(oth)i(practical)g(and)f
(theoretical)h(p)q(oin)o(ts)g(of)f(view.)150 829 y(F)m(rom)g(the)j
(practical)e(p)q(oin)o(t)h(of)f(view,)g(ha)o(ving)g(Run)h(in)f(a)h
(statically)f(t)o(yp)q(ed)h(language)f(allo)o(ws)g(us)h(to)g(dev)o
(elop)150 904 y(m)o(ulti-stage)d(systems)i(as)g(part)g(of)g(an)o(y)f
(program)g(and)h(still)f(b)q(e)h(sure)h(that)f(the)h
FH(whole)g(system)f FI(will)e(b)q(e)j(free)g(of)150 979
y(run-time)d(errors.)i(F)m(rom)d(the)j(theoretical)f(p)q(oin)o(t)g(of)g
(view,)f(it)h(allo)o(ws)e(us)j(to)f(formalize)e(the)j(problem)d(of)i
(safet)o(y)150 1053 y(in)g(m)o(ulti-stage)f(systems)i(and)g(to)g
(address)h(it)e(with)h(formal)d(rigor.)150 1136 y(The)j(use)h(of)e(Run)
h(in)f(MetaML)i(can)f(b)q(e)g(illustrated)g(with)f(the)i(follo)o(wing)c
(simple)h(example:)221 1243 y FE(-)p Fy(j)h FE(val)h(co)q(de0)g(=)h
Fy(h)p FE(1+5)p Fy(i)p FE(;)221 1307 y(val)e(co)q(de0)i(=)f
Fy(h)q FE(1)p Fu(\045)o FE(+5)p Fy(i)g FE(:)f Fy(h)q
FE(int)p Fy(i)221 1437 y FE(-)p Fy(j)g FE(val)h(result1)g(=)g(run)f(co)
q(de0;)221 1502 y(val)g(result1)i(=)f(6)g(:)f(int.)150
1668 y FG(2.2.4)48 b(Lift)150 1784 y FI(Lift)12 b(allo)o(ws)f(us)i(to)g
(inject)g(v)n(alues)f(of)g(ground)h(t)o(yp)q(e)g(in)o(to)f(a)g(v)n
(alue)g(of)g(t)o(yp)q(e)i(co)q(de.)f(In)f(MetaML,)h(base)g(t)o(yp)q(es)
h(are)150 1859 y(t)o(yp)q(es)j(con)o(taining)e(no)h(arro)o(ws)h
(\(function)f(t)o(yp)q(es\).)h(Examples)e(of)h(ground)g(t)o(yp)q(es)h
(are)g FE(int)p FI(,)f FE(string)p FI(,)g FE(b)q(o)q(ol)p
FI(,)g(and)150 1933 y FE(int)e(list)p FI(:)221 2040 y
FE(-)p Fy(j)f FE(val)h(co)q(de2)g(=)h(lift)c(6)i(;)221
2104 y(val)g(co)q(de2)i(=)f Fy(h)q FE(6)p Fy(i)f FE(:)h
Fy(h)p FE(int)p Fy(i)p FE(.)150 2206 y FI(While)e(b)q(oth)i(Brac)o(k)o
(ets)g(and)g(Lift)e(construct)j(co)q(de,)f(Lift)e(do)q(es)i
FH(not)g FI(dela)o(y)e(its)i(argumen)o(t.)d(Lift)i(\014rst)h(ev)n
(aluates)150 2280 y(its)g(argumen)o(t,)e(then)j(constructs)h(a)d
(represen)o(tation)j(for)d(this)h(v)n(alue:)221 2387
y FE(-)p Fy(j)f FE(val)h(co)q(de3)g(=)h(lift)c(1+5;)221
2451 y(val)i(co)q(de3)i(=)f Fy(h)q FE(6)p Fy(i)f FE(:)h
Fy(h)p FE(int)p Fy(i)p FE(.)150 2552 y FI(Because)20
b(Lift)c(is)i(implemen)o(ted)d(b)o(y)j(pro)q(ducing)f(a)h(source-lev)o
(el)g(represen)o(tation)h(of)e(the)h(its)g(op)q(erand,)g(Lift)150
2627 y(cannot)13 b(b)q(e)g(de\014ned)h(for)e(functions:)g(Giv)o(en)g
(an)g(arbitrary)h(function,)e(there)j(is)f(no)f(general)h(w)o(a)o(y)f
(of)g(computing)p eop
%%Page: 23 34
23 33 bop 1882 0 a FB(23)150 192 y FI(a)20 b(source-lev)o(el)i
(represen)o(tation)g(for)e(that)h(function)1014 176 y
FA(1)1032 192 y FI(.)g(Ho)o(w)o(ev)o(er,)f(functions)h(can)g(still)e(b)
q(e)j(dela)o(y)o(ed)e(using)150 266 y(Brac)o(k)o(ets:)221
372 y FE(-)p Fy(j)13 b FE(val)h(result2)g(=)g(fn)g(x)g
Fy(\))g FE(x+1;)221 437 y(val)f(result2)i(=)f(-fn-)g(:)f(int)h
Fy(!)g FE(int)221 567 y(-)p Fy(j)f FE(val)h(co)q(de4)g(=)h
Fy(h)p FE(result2)f(5)p Fy(i)p FE(;)221 632 y(val)f(co)q(de4)i(=)f
Fy(h)q Fu(\045)o FE(result2)h(5)p Fy(i)e FE(:)h Fy(h)p
FE(int)p Fy(i)221 761 y FE(-)p Fy(j)f FE(val)h(result3)g(=)g(run)f(co)q
(de4;)221 826 y(val)g(result3)i(=)f(6)g(:)f(int.)150
927 y FI(In)i(the)g(\014rst)g(declaration,)f FE(result2)h
FI(is)f(b)q(ound)h(to)f(the)h(function)g(that)f(tak)o(es)h(an)g
FE(int)f FI(and)h(returns)h(an)e FE(int)p FI(.)h(The)150
1002 y(second)g(declaration)f(constructs)h(a)f(piece)h(of)e(co)q(de)i
(that)f(uses)h FE(result2)f FI(in)g(a)f(dela)o(y)o(ed)h(con)o(text.)150
1150 y FG(2.2.5)48 b(The)15 b(Notion)g(of)g(Lev)o(el)150
1266 y FI(Determining)j(when)h(an)g(Escap)q(ed)i(expression)g(should)e
(b)q(e)h(p)q(erformed)e(requires)j(a)e(notion)f(of)h(lev)o(el.)g(The)
150 1340 y FH(level)14 b FI(of)g(a)g(term)g(is)g(the)h(n)o(um)o(b)q(er)
f(of)f(surrounding)i(Brac)o(k)o(ets)h(min)o(us)d(the)i(n)o(um)o(b)q(er)
e(of)h(surrounding)h(Escap)q(es.)150 1415 y(Escap)q(es)h(in)d(MetaML)h
(are)h(only)e(ev)n(aluated)g(when)i(they)f(are)g(at)g(lev)o(el)g(one.)
150 1498 y(MetaML)g(is)f(a)g(m)o(ulti-lev)o(el)e(language.)h(This)i
(feature)g(is)f(imp)q(ortan)o(t)f(b)q(ecause)j(it)e(allo)o(ws)g(us)h
(to)f(ha)o(v)o(e)g(m)o(ultiple)150 1573 y(distinct)h(stages)h(of)e
(execution.)h(F)m(or)g(example,)e(w)o(e)i(can)g(write)g(expressions)i
(suc)o(h)e(as:)221 1679 y FE(-)p Fy(j)f(hh)p FE(5+5)p
Fy(ii)p FE(;)221 1744 y(val)g(it)h(=)g Fy(hh)q FE(5)p
Fu(\045)o FE(+5)p Fy(ii)g FE(:)g Fy(hh)p FE(int)p Fy(ii)150
1845 y FI(and)g(the)g(t)o(yp)q(e)h(re\015ects)h(the)e(n)o(um)o(b)q(er)f
(of)h(times)e(the)j(enclosed)g(in)o(teger)f(expression)h(is)f(dela)o(y)
o(ed.)150 1928 y(Escap)q(es)21 b(can)f(b)q(e)g(also)f(used)h(in)f(ob)r
(ject-programs.)g(In)g(suc)o(h)i(m)o(ulti-lev)o(el)16
b(expressions,)21 b(w)o(e)f(can)f(also)g(use)150 2003
y(Escap)q(es:)221 2109 y FE(-)p Fy(j)13 b FE(val)h(co)q(de5)g(=)h
Fy(hh)p FE(\(5+5,)q(~\(co)q(de2\)\))p Fy(i)r(i)p FE(;)221
2174 y(val)e(co)q(de5)i(=)f Fy(h)q(h)p FE(\(5)p Fu(\045)o
FE(+5,)q(~)q(\(co)q(de2\)\))p Fy(i)r(i)f FE(:)h Fy(hh)p
FE(int*int)p Fy(i)q(i)p FE(.)150 2275 y FI(The)d(Escap)q(e)i(is)e(not)g
(\\p)q(erformed")f(when)h(this)g(expression)h(w)o(as)f(ev)n(aluated,)g
(b)q(ecause)h(there)h(are)e(t)o(w)o(o)g(Brac)o(k)o(ets)150
2350 y(surrounding)j(this)g(Escap)q(e.)h(W)m(e)e(can)h(Run)g(the)g
(doubly)g(dela)o(y)o(ed)f(v)n(alue)h FE(co)q(de5)h FI(as)f(follo)o(ws:)
p 150 2430 237 2 v 158 2457 a Fz(1)188 2473 y FB(Recen)o(t)i(w)o(ork)g
(on)f FC(typ)n(e-dir)n(e)n(cte)n(d)e(p)n(artial)h(evaluation)e
FB([18])i(suggests)j(that)e(there)h(are)g(practical)h(w)o(a)o(ys)e(of)g
(deriving)188 2519 y(the)i(source-lev)o(el)i(represen)o(tations)g(for)e
(functions)h(at)e(run-time)i(when)f(the)g(executables)i(a)o(v)n
(ailable)g(at)e(run-time)188 2564 y(are)d(su\016cien)o(tly)h(instrumen)
o(ted.)g(Sheard)f(has)f(in)o(v)o(estigated)j(t)o(yp)q(e-directed)f
(partial)g(ev)n(aluation)g(in)f(the)f(con)o(text)h(of)188
2610 y(MetaML)g([81].)e(The)h(treatmen)o(t)g(of)g(this)h(sub)r(ject)f
(is,)h(ho)o(w)o(ev)o(er,)f(b)q(ey)o(ond)h(the)f(scop)q(e)h(of)e(the)i
(presen)o(t)f(w)o(ork.)p eop
%%Page: 24 35
24 34 bop 1882 0 a FB(24)221 195 y FE(-)p Fy(j)13 b FE(val)h(co)q(de6)g
(=)h(run)d(co)q(de5;)221 260 y(val)h(co)q(de6)i(=)f Fy(h)q
FE(\(5)p Fu(\045)o FE(+5,6\))p Fy(i)g FE(:)f Fy(h)p FE(int*int)p
Fy(i)q FE(.)150 361 y FI(Run)g(eliminates)f(one)i(Brac)o(k)o(et)650
346 y FA(2)670 361 y FI(,)f(th)o(us)h(lo)o(w)o(ering)e(the)i(lev)o(el)f
(of)g(the)h(Escap)q(e)h(from)d(2)h(to)h(1,)f(and)g(the)h(Escap)q(e)h
(is)150 436 y(p)q(erformed.)150 595 y FD(2.3)56 b(The)18
b(Pragmatics)f(of)i(V)-5 b(ariables)19 b(and)g(Lev)n(els)150
727 y FI(Is)14 b(it)f(reasonable)h(to)g(write)g(a)f(program)f(where)j
(a)e(v)n(ariable)f(is)i(b)q(ound)g(at)f(one)h(lev)o(el)f(and)h(is)f
(used)h(at)g(another?)150 802 y(On)g(one)f(hand,)g(it)g(seems)h
(completely)e(justi\014able)i(to)f(write)h(terms)f(suc)o(h)h(as)g
Fy(h)p FE(sqrt)g(16.0)p Fy(i)o FI(.)f(It)g(is)h(t)o(ypical)e(in)h(the)
150 877 y(formal)f(treatmen)o(t)i(of)g(programming)d(languages)j(to)g
(consider)h FE(sqrt)g FI(to)g(b)q(e)g(a)f(free)h(v)n(ariable)e(\(b)q
(ound)i(at)f(lev)o(el)150 952 y(0\).)e(In)g(this)g(case)h
FE(sqrt)g FI(is)f(b)q(ound)g(at)g(lev)o(el)g(0)g(and)g(is)g(used)h(at)f
(lev)o(el)g(1.)g(On)g(the)h(other)g(hand,)e(w)o(e)i(do)f(not)g(wish)g
(to)150 1026 y(allo)o(w)h(terms)h(suc)o(h)h(as)g Fy(h)p
FE(fn)f(x)h Fy(\))g FE(~)q(x)p Fy(i)g FI(whic)o(h)f(dictates)h(that)g
FE(x)f FI(b)q(e)h(ev)n(aluated)g(\(at)f(lev)o(el)g(0\))h
FH(b)n(efor)n(e)e FI(it)i(is)f(b)q(ound)150 1101 y(\(at)e(lev)o(el)f
(1\).)g(The)h(\014rst)h(term)e(is)g(an)g(example)g(of)g(wh)o(y)g
FH(cr)n(oss-stage)i(p)n(ersistenc)n(e)e FI(is)h(desirable,)f(and)h(the)
g(second)150 1176 y(term)h(is)h(an)g(example)e(of)i(wh)o(y)f(violating)
f FH(cr)n(oss-stage)i(safety)g FI(is)g(undesirable.)150
1324 y FG(2.3.1)48 b(Cross-Stage)14 b(P)o(ersistence)150
1440 y FI(W)m(e)d(sa)o(y)g(that)h(a)f(v)n(ariable)f(is)h(cross-stage)i
(p)q(ersisten)o(t)g(when)f(it)f(is)g(b)q(ound)h(at)f(one)h(lev)o(el)f
(and)g(is)g(used)i(at)e(a)g(higher)150 1514 y(lev)o(el.)i(P)o
(ermitting)g(this)h(usage)g(of)f(v)n(ariables)h(means)f(allo)o(wing)f
(the)i(programmer)e(to)i(tak)o(e)g(full)e(adv)n(an)o(tage)i(of)150
1589 y(all)d(primitiv)o(es)f(and)i(bindings)g(that)g(are)g(a)o(v)n
(ailable)e(in)i(the)g(curren)o(t)i(stage)f(b)o(y)e(reusing)i(them)e(in)
h(future)h(stages.)150 1664 y(A)j(p)q(ercen)o(tage)h(sign)e(is)g(prin)o
(ted)h(b)o(y)f(the)h(displa)o(y)f(mec)o(hanism)e(to)i(indicate)h(that)f
Fu(\045)p FE(a)h FI(is)f FH(not)h FI(a)f(v)n(ariable,)f(but)150
1739 y(rather,)g(a)g(new)g FH(c)n(onstant)p FI(.)g(F)m(or)g(example)e
(the)j(program)221 1845 y FE(let)f(val)g(a)f(=)i(1+4)e(in)h
Fy(h)p FE(72+a)p Fy(i)g FE(end)150 1946 y FI(computes)j(the)h(co)q(de)h
(fragmen)o(t)d Fy(h)p FE(72)h Fu(\045)o FE(+)h Fu(\045)p
FE(a)p Fy(i)p FI(.)f(The)h(p)q(ercen)o(tage)h(sign)e
Fu(\045)p 1350 1946 13 2 v 32 w FI(indicates)h(that)f(the)h
(cross-stage)150 2021 y(p)q(ersisten)o(t)f(v)n(ariables)e
FE(a)g FI(and)h FE(+)f FI(are)h(b)q(ound)g(in)f(the)h(co)q(de's)g(lo)q
(cal)f(en)o(vironmen)o(t.)f(The)h(v)n(ariable)g FE(a)g
FI(has)h(b)q(een)150 2096 y(b)q(ound)e(during)g(the)h(\014rst)g(stage)g
(to)f(the)h(constan)o(t)f FE(5)p FI(.)g(The)g(name)g(\\)p
FE(a)p FI(")f(is)h(prin)o(ted)h(only)e(to)h(pro)o(vide)g(a)g(hin)o(t)g
(to)150 2170 y(the)g(user)h(ab)q(out)f(where)h(this)f(new)h(constan)o
(t)f(originated)f(from.)150 2253 y(When)f Fu(\045)p FE(a)g
FI(is)g(ev)n(aluated)g(in)g(a)f(later)i(stage,)f(it)f(will)g(return)i
FE(5)f FI(indep)q(enden)o(tly)h(of)f(the)g(binding)g(for)f(the)i(v)n
(ariable)150 2328 y FE(a)j FI(in)f(the)h(new)h(con)o(text.)f(Arbitrary)
g(v)n(alues)f(\(including)g(functions\))h(can)g(b)q(e)g(injected)h(in)o
(to)e(a)g(piece)i(of)e(co)q(de)150 2403 y(using)f(this)g(h)o(ygienic)f
(binding)g(mec)o(hanism.)p 150 2483 237 2 v 158 2510
a Fz(2)188 2526 y FB(Despite)i(that,)f(there)g(is)g(a)g(sense)g(in)g
(whic)o(h)h(ev)n(aluation)h(and)e(reduction)i(b)q(oth)e(\\preserv)o(e)h
(lev)o(el".)g(Suc)o(h)f(prop)q(erties)188 2571 y(will)h(b)q(e)e
(established)j(as)d(part)g(of)g(the)g(formal)h(treatmen)o(t)f(of)g
(MetaML)g(in)h(P)o(art)f(I)q(I)g(of)f(this)i(dissertation.)p
eop
%%Page: 25 36
25 35 bop 1882 0 a FB(25)150 192 y FG(2.3.2)48 b(Cross-Stage)14
b(Safet)o(y)150 306 y FI(W)m(e)g(sa)o(y)f(the)i(that)f(a)g(v)n(ariable)
e(violates)i FH(cr)n(oss-stage)g(safety)g FI(when)h(it)e(is)h(b)q(ound)
g(at)g(one)g(lev)o(el)g(and)f(is)h(used)h(at)150 381
y(a)f(lo)o(w)o(er)f(lev)o(el.)g(This)h(violation)e(o)q(ccurs)j(in)f
(the)g(expression:)221 485 y FE(fn)g(a)f Fy(\))h(h)p
FE(fn)g(b)g Fy(\))h FE(~\(a+b\))p Fy(i)r FE(.)150 585
y FI(The)g(annotations)g(in)f(this)i(expression)g(dictate)f(computing)f
FE(a+b)h FI(in)g(the)h(\014rst)g(stage,)f(when)g(the)h(v)n(alue)e(of)h
FE(b)150 660 y FI(will)d(b)q(e)j(a)o(v)n(ailable)d(only)h(in)g(the)i
(second)g(stage!)150 743 y(Supp)q(orting)e(cross-stage)i(p)q
(ersistence)g(means)e(that)g(a)g(t)o(yp)q(e)g(system)g(for)g(MetaML)g
(m)o(ust)f(ensure)j(that)e(\\w)o(ell-)150 817 y(t)o(yp)q(ed)f(programs)
e(w)o(on't)h(go)g FF(W)6 b(r)q(ong)q FI(",)11 b(where)h(going)f(wrong)g
(no)o(w)g(includes)h(the)g(violation)e(of)g(the)i(cross-stage)150
892 y(safet)o(y)h(condition,)f(as)h(w)o(ell)g(as)g(the)h(standard)f
(notions)g(of)f(going)g(wrong)h([48])f(in)g(statically-t)o(yp)q(ed)h
(languages.)150 975 y(In)c(our)h(exp)q(erience,)h(ha)o(ving)d(a)h(t)o
(yp)q(e)h(system)f(to)g(screen)i(out)e(suc)o(h)h(programs)e(is)h(a)g
(signi\014can)o(t)g(aid)g(in)g(dev)o(eloping)150 1050
y(a)14 b(m)o(ulti-stage)d(program.)150 1133 y(W)m(e)i(are)i(no)o(w)e
(ready)i(to)e(see)i(ho)o(w)f(MetaML)g(can)g(b)q(e)h(used)f(to)g(stage)h
(some)e(simple)f(functions.)150 1290 y FD(2.4)56 b(Staging)18
b(the)g(List-Mem)n(b)r(ership)e(F)-5 b(unction)150 1421
y FI(Using)16 b(MetaML,)g(the)h(programmer)d(can)i(stage)h(programs)e
(b)o(y)h(inserting)h(the)f(prop)q(er)i(annotations)d(at)h(the)150
1496 y(righ)o(t)e(places)i(in)e(the)h(program.)e(The)i(programmer)d
(uses)k(these)g(annotations)e(to)h(mo)q(dify)d(the)k(default)e(strict)
150 1571 y(ev)n(aluation)e(order)j(of)e(the)i(program.)150
1654 y(Let)j(us)g(consider)h(staging)e(the)h(function)f(that)h(tak)o
(es)g(a)f(list)g(and)h(a)f(v)n(alue)g(and)h(searc)o(hes)h(the)f(list)g
(for)f(this)150 1728 y(v)n(alue.)c(W)m(e)g(b)q(egin)h(b)o(y)g(writing)f
(the)h(single-stage)g(function)1095 1713 y FA(3)1114
1728 y FI(:)221 1841 y FE(\(*)f(memb)q(er1)h(:)24 b("a)14
b Fy(!)25 b FE("a)13 b(list)h Fy(!)f FE(b)q(o)q(ol)h(*\))221
1905 y(fun)g(memb)q(er1)f(v)h(l)g(=)290 1970 y(if)f(\(null)i(l\))326
2035 y(then)h(false)326 2100 y(else)f(if)e(v=\(hd)j(l\))403
2164 y(then)f(true)403 2229 y(else)g(memb)q(er1)e(v)h(\(tl)g(l\).)150
2337 y FI(W)m(e)f(ha)o(v)o(e)h(observ)o(ed)h(that)f(the)h(p)q(ossible)f
(annotations)f(in)g(a)h(staged)g(v)o(ersion)h(of)e(a)g(program)g(are)h
(signi\014can)o(tly)150 2411 y(constrained)e(b)o(y)g(its)f(t)o(yp)q(e.)
h(This)f(observ)n(ation)g(suggests)i(that)e(a)g(go)q(o)q(d)g(strategy)i
(for)e(hand-staging)f(a)i(program)p 150 2490 237 2 v
158 2517 a Fz(3)188 2533 y FB(In)17 b(SML,)g(whereas)h(t)o(yp)q(e)f(v)n
(ariables)i(written)f(as)28 b Fw('a)17 b FB(are)g(unrestricted)h(p)q
(olymorphic)i(v)n(ariables,)f(t)o(yp)q(e)f(v)n(ariables)188
2579 y(written)10 b(as)21 b Fw("a)10 b FB(are)f(also)i(p)q(olymorphic,)
h(but)e(are)f(restricted)i(to)e FC(e)n(quality)f(typ)n(es)s
FB(,)g(that)i(us,)f(t)o(yp)q(es)h(whose)g(elemen)o(ts)g(can)188
2624 y(b)q(e)j(tested)h(for)e(equalit)o(y)m(.)i(F)m(unction)h(t)o(yp)q
(es)e(are)g(the)g(protot)o(ypical)i(example)f(of)f(a)g(t)o(yp)q(e)g
(whose)g(elemen)o(ts)h FC(c)n(annot)g FB(b)q(e)188 2670
y(tested)f(for)e(equalit)o(y)m(.)j(Th)o(us,)d(equalit)o(y)j(t)o(yp)q(e)
f(v)n(ariables)h(cannot)e(b)q(e)h(instan)o(tiated)h(to)e(functions)h(t)
o(yp)q(es,)f(for)g(example.)p eop
%%Page: 26 37
26 36 bop 1882 0 a FB(26)150 192 y FI(is)19 b(to)f(\014rst)i(determine)
e(the)i(target)f(t)o(yp)q(e)g(of)f(the)i(desired)g(annotated)e
(program.)f(Th)o(us,)i(w)o(e)g(will)e(start)i(b)o(y)150
266 y(studying)c(the)g(t)o(yp)q(e)g(of)g(the)g(single-stage)g
(function.)f(Supp)q(ose)i(the)f(list)g(parameter)f(is)h(a)o(v)n
(ailable)d(in)j(the)g(\014rst)150 341 y(stage,)h(and)g(the)g(elemen)o
(t)f(sough)o(t)h(is)g(a)o(v)n(ailable)e(later.)h(A)h(natural)f(target)i
(t)o(yp)q(e)f(for)g(the)g(staged)h(function)e(is)150
416 y(then)813 532 y Fy(h)c FE("a)p Fy(i)j(!)25 b FE("a)13
b(list)h Fy(!h)p FE(b)q(o)q(ol)p Fy(i)p FI(.)150 648
y(This)k(t)o(yp)q(e)h(re\015ects)i(the)e(fact)f(that)h(b)q(oth)f(the)h
(\014rst)g(argumen)o(t)f(and)g(the)h(result)g(of)f(this)g(function)g
(will)f(b)q(e)150 723 y(\\late".)c(In)h(other)g(w)o(ords,)g(only)f(the)
h(second)h(argumen)o(t)e(is)h(a)o(v)n(ailable)e(at)h(the)i(curren)o(t)g
(time.)150 806 y(Ha)o(ving)c(c)o(hosen)i(a)e(suitable)h(target)h(t)o
(yp)q(e,)f(w)o(e)g(b)q(egin)g(annotating)f(the)h(single-stage)g
(program.)e(W)m(e)i(start)g(with)150 881 y(the)i(whole)f(expression)i
(and)e(w)o(orking)g(in)o(w)o(ards)g(un)o(til)f(all)g(sub-expressions)k
(ha)o(v)o(e)d(b)q(een)i(considered.)f(A)o(t)f(eac)o(h)150
955 y(step,)f(w)o(e)g(try)g(to)g(\014nd)g(the)g(annotations)f(that)h
(will)e(\\correct")j(the)g(t)o(yp)q(e)f(of)f(the)h(expression)h(so)f
(that)g(the)g(whole)150 1030 y(function)k(has)g(a)g(t)o(yp)q(e)g
(closer)h(to)f(the)h(target)f(t)o(yp)q(e.)g(The)h(follo)o(wing)c
(function)j(realizes)h(the)f(target)h(t)o(yp)q(e)f(for)150
1105 y(the)e(staged)h FE(memb)q(er)e FI(function:)221
1211 y FE(\(*)g(memb)q(er2)h(:)f Fy(h)f FE("a)p Fy(i)h(!)25
b FE("a)14 b(list)f Fy(!)h(h)p FE(b)q(o)q(ol)p Fy(i)g
FE(*\))221 1276 y(fun)g(memb)q(er2)f(v)h(l)g(=)290 1341
y(if)f(\(null)i(l\))326 1405 y(then)h Fy(h)p FE(false)p
Fy(i)326 1470 y FE(else)f Fy(h)p FE(if)g(~)q(v=)q(~)q(\(lift)c(\(hd)k
(l\)\))456 1535 y(then)g(true)456 1600 y(else)g(~)q(\(memb)q(er2)f(v)g
(\(tl)f(l\)\))p Fy(i)q FE(.)150 1701 y FI(Not)i(all)f(annotations)h
(are)g(explicitly)g(dictated)g(b)o(y)g(the)h(t)o(yp)q(e.)g(The)f
(annotated)h(term)f FE(~)q(\(lift)c(\(hd)17 b(l\)\))e
FI(has)g(the)150 1776 y(same)j(t)o(yp)q(e)i(as)g FE(hd)g(l)p
FI(,)e(but)i(it)f(ensures)i(that)e FE(hd)h(l)g FI(is)f(p)q(erformed)g
(during)g(the)h(\014rst)g(stage.)f(Otherwise,)h(all)150
1850 y(selections)d(of)f(the)h(head)g(elemen)o(t)e(of)h(the)h(list)f(w)
o(ould)f(b)q(e)i(dela)o(y)o(ed)f(un)o(til)g(the)h(generated)g(co)q(de)g
(is)f(Run)g(in)g(a)150 1925 y(later)e(stage)339 1910
y FA(4)358 1925 y FI(.)150 2008 y(The)i(Brac)o(k)o(ets)h(around)e(the)h
(branc)o(hes)g(of)f(the)h(outermost)f FE(if)p FI(-expression)h(ensure)h
(that)e(the)h(return)h(v)n(alue)e(of)150 2083 y FE(memb)q(er2)f
FI(will)e(b)q(e)j(a)f(co)q(de)h(t)o(yp)q(e)g Fy(h)p 703
2083 13 2 v 15 w(i)p FI(.)e(The)i(\014rst)g(branc)o(h)g
Fy(h)p FE(false)p Fy(i)f FI(needs)i(no)d(further)j(annotations)d(and)h
(mak)o(es)150 2157 y(the)h(return)h(v)n(alue)e(precisely)h(a)g
Fy(h)p FE(b)q(o)q(ol)p Fy(i)p FI(.)f(Mo)o(ving)g(in)o(w)o(ards)g(in)g
(the)h(second)h(branc)o(h,)e(the)h(condition)g FE(~)q(v)g
FI(forces)150 2232 y(the)f(t)o(yp)q(e)h(of)e(the)i FE(v)f
FI(parameter)f(to)h(ha)o(v)o(e)g(t)o(yp)q(e)g Fy(h)e
FE("a)p Fy(i)p FI(,)h(as)h(planned.)150 2315 y(Just)k(lik)o(e)e(the)i
(\014rst)g(branc)o(h)f(of)g(the)g(outer)h FE(if)p FI(-statemen)o(t,)e
(the)i(inner)f FE(if)p FI(-statemen)o(t)g(m)o(ust)f(return)i
FE(b)q(o)q(ol)p FI(.)f(So,)150 2390 y(the)h(\014rst)g(branc)o(h)f
(returns)i FE(true)f FI(without)f(an)o(y)f(further)i(annotations.)e
(But)i(b)q(ecause)g(the)g(recursiv)o(e)h(call)d(to)150
2465 y FE(memb)q(er2)c FI(has)g(t)o(yp)q(e)g Fy(h)q FE(b)q(o)q(ol)p
Fy(i)p FI(,)g(it)f(m)o(ust)h(b)q(e)g(Escap)q(ed.)i(Inserting)e(this)g
(Escap)q(e)i(also)e(implies)e(that)i(the)h(recursion)p
150 2547 237 2 v 158 2574 a Fz(4)188 2590 y FB(More)h(signi\014can)o
(tly)m(,)i(recursiv)o(e)e(programs)g(can)f(b)q(e)h(annotated)g(in)g(t)o
(w)o(o)e(fundamen)o(tally)k(di\013eren)o(t)f(w)o(a)o(ys)e(and)g(t)o(yp)
q(es)188 2636 y(do)h(not)f(pro)o(vide)i(an)o(y)e(help)h(in)g(this)g
(regard.)f(W)m(e)g(expand)i(on)e(this)h(p)q(oin)o(t)g(in)g(Chapter)f
(7.)p eop
%%Page: 27 38
27 37 bop 1882 0 a FB(27)150 192 y FI(will)17 b(b)q(e)j(p)q(erformed)e
(in)h(the)g(\014rst)h(stage,)e(whic)o(h)h(is)g(exactly)g(the)g(desired)
h(b)q(eha)o(vior.)e(Th)o(us,)h(the)g(result)h(of)150
266 y FE(memb)q(er2)13 b FI(is)h(a)g(recursiv)o(ely-constructed)i
(piece)f(of)f(co)q(de)g(of)g(t)o(yp)q(e)g(t)o(yp)q(e)g
FE(b)q(o)q(ol)p FI(.)150 349 y(Ev)n(aluating)e Fy(h)p
FE(fn)i(x)g Fy(\))h FE(~)q(\(memb)q(er2)e Fy(h)p FE(x)p
Fy(i)h FE([1,2,3]\))p Fy(i)f FI(yields:)221 456 y Fy(h)p
FE(fn)h(d1)g Fy(\))221 520 y FE(if)f(d1)h Fu(\045)p FE(=)g(1)f(then)j
(true)419 585 y(else)f(if)e(d1)i Fu(\045)o FE(=)f(2)g(then)h(true)695
650 y(else)g(if)e(d1)h Fu(\045)p FE(=)g(3)f(then)j(true)970
715 y(else)f(false)p Fy(i)p FE(.)150 891 y FD(2.5)56
b(Staging)18 b(the)g(P)n(o)n(w)n(er)j(F)-5 b(unction)150
1024 y FI(Computing)11 b(the)j(p)q(o)o(w)o(ers)g(of)f(a)g(real)h(n)o
(um)o(b)q(er)e(is)h(a)h(classic)f(example)f(from)g(the)i(partial)e(ev)n
(aluation)g(literature)150 1099 y([40].)g(Consider)i(the)h(follo)o
(wing)c(de\014nition)j(of)f(exp)q(onen)o(tiation:)857
1207 y FF(x)881 1192 y FA(0)1003 1207 y FI(=)f(1)857
1282 y FF(x)881 1267 y Ft(n)p FA(+)p Ft(n)p FA(+1)1003
1282 y FI(=)g FF(x)c Fy(\002)i FF(x)1145 1267 y Ft(n)p
FA(+)p Ft(n)857 1357 y FF(x)881 1342 y Ft(n)p FA(+)p
Ft(n)p FA(+2)1003 1357 y FI(=)i(\()p FF(x)1087 1342 y
Ft(n)p FA(+1)1151 1357 y FI(\))1167 1342 y FA(2)150 1459
y FI(This)g(de\014nition)h(can)f(b)q(e)h(used)h(to)e(compute)g
(expressions)i(suc)o(h)f(as)g(1)p FF(:)p FI(7)1277 1443
y FA(5)1295 1459 y FI(.)f(More)h(in)o(terestingly)m(,)e(it)h(can)h(b)q
(e)g(used)150 1533 y(to)g(compute)f(or)h(\\generate")g(an)g(e\016cien)o
(t)g(form)o(ula)e(for)h(expressions)i(suc)o(h)g(as)f
FF(x)1428 1518 y FA(72)1476 1533 y FI(where)h(only)e(the)h(exp)q(onen)o
(t)150 1608 y(is)h(kno)o(wn.)f(W)m(e)g(ha)o(v)o(e)h(underlined)g(the)h
(term)e(b)q(eing)h(expanded:)527 1714 y FF(x)551 1699
y FA(72)p 527 1721 59 2 v 598 1714 a FI(=)e(\()p FF(x)682
1699 y FA(36)p 658 1721 V 717 1714 a FI(\))733 1699 y
FA(2)763 1714 y FI(=)g(\(\(\()p FF(x)879 1699 y FA(18)p
855 1721 V 914 1714 a FI(\))930 1699 y FA(2)949 1714
y FI(\))965 1699 y FA(2)984 1714 y FI(\))1000 1699 y
FA(2)1030 1714 y FI(=)g(\(\()p FF(x)1130 1699 y FA(9)p
1106 1721 43 2 v 1148 1714 a FI(\))1164 1699 y FA(2)1183
1714 y FI(\))1199 1699 y FA(2)1229 1714 y FI(=)g(\(\(\()p
FF(x)e Fy(\002)f FF(x)1420 1699 y FA(8)p 1396 1721 V
1438 1714 a FI(\))1454 1699 y FA(2)1473 1714 y FI(\))1489
1699 y FA(2)1508 1714 y FI(\))1524 1699 y FA(2)598 1789
y FI(=)j(\(\(\()p FF(x)d Fy(\002)h FI(\()p FF(x)805 1774
y FA(4)p 781 1796 V 823 1789 a FI(\))839 1774 y FA(2)858
1789 y FI(\))874 1774 y FA(2)893 1789 y FI(\))909 1774
y FA(2)927 1789 y FI(\))943 1774 y FA(2)974 1789 y FI(=)h(\(\(\()p
FF(x)f Fy(\002)f FI(\(\()p FF(x)1196 1774 y FA(2)p 1172
1796 V 1215 1789 a FI(\))1231 1774 y FA(2)1250 1789 y
FI(\))1266 1774 y FA(2)1284 1789 y FI(\))1300 1774 y
FA(2)1319 1789 y FI(\))1335 1774 y FA(2)1354 1789 y FI(\))1370
1774 y FA(2)598 1863 y FI(=)j(\(\(\()p FF(x)d Fy(\002)h
FI(\(\(\()p FF(x)f Fy(\002)g FI(1\))924 1848 y FA(2)943
1863 y FI(\))959 1848 y FA(2)978 1863 y FI(\))994 1848
y FA(2)1012 1863 y FI(\))1028 1848 y FA(2)1047 1863 y
FI(\))1063 1848 y FA(2)1082 1863 y FI(\))1098 1848 y
FA(2)150 1960 y FI(This)17 b(sequence)h(of)e(expansions)h(is)g(an)f
(example)g(of)g(sym)o(b)q(olic)f(computation,)f(b)q(ecause)19
b(w)o(e)d(are)i(computing)150 2035 y(with)13 b(free)h(v)n(ariables.)e
(It)h(is)g(also)f(an)h(example)f(of)h(staged)g(computation,)e(b)q
(ecause)k(w)o(e)e(are)h(doing)e(useful)h(w)o(ork)150
2110 y(in)g(a)h(stage)g(distinct)g(from)f(the)h(\014nal)f(stage)i(of)e
(computation.)150 2193 y(The)i(computation)e(ab)q(o)o(v)o(e)h(can)h(b)q
(e)g(b)q(e)h(programmed)c(in)i(MetaML.)g(First,)h(w)o(e)g(write)g(the)g
(single-stage)g(\\all-)150 2268 y(inputs)f(are)g(kno)o(wn")g(function:)
221 2374 y FE(fun)g(exp)h(\(n,x\))f(=)g(\(*)g(:)f(int)i
Fy(\002)f FE(real)g Fy(!)f FE(real)i(*\))255 2439 y(if)e(n)h(=)h(0)e
(then)i(1.0)407 2503 y(else)g(if)e(even)i(n)g(then)g(sqr)f(\(exp)h(\(n)
g(div)f(2,x\)\))647 2568 y(else)g(x)g(*)g(exp)h(\(n)f(-)g(1,x\).)150
2669 y FI(Then,)g(w)o(e)g(add)g(staging)f(annotations:)p
eop
%%Page: 28 39
28 38 bop 1882 0 a FB(28)221 195 y FE(fun)14 b(exp')g(\(n,x\))h(=)f
(\(*)f(:)h(int)g Fy(\002)g(h)p FE(real)p Fy(i)h(!)e(h)p
FE(real)p Fy(i)i FE(*\))255 260 y(if)e(n)h(=)h(0)e(then)i
Fy(h)p FE(1.0)p Fy(i)407 325 y FE(else)g(if)e(even)i(n)g(then)g(sqr')f
(\(exp')g(\(n)h(div)f(2,x\)\))647 390 y(else)g Fy(h)r
FE(~)q(x-345)f(*)h(~)q(\(exp')h(\(n)f(-)g(1,x\)\))p Fy(i)p
FE(.)150 491 y FI(W)m(e)f(also)h(need)h(to)e(stage)i(the)f(function)g
FE(sqr)p FI(:)221 597 y FE(fun)g(sqr)g(x)g(=)g(\(*)g(:)g(real)g
Fy(!)f FE(real)i(*\))255 662 y(x)f(*)f(x;)150 763 y FI(to)221
869 y FE(fun)h(sqr')g(x)g(=)g(\(*)g(:)f Fy(h)p FE(real)p
Fy(i)i(!)e(h)p FE(real)p Fy(i)i FE(*\))255 934 y Fy(h)p
FE(let)f(val)g(y)g(=)h(~)q(x)f(in)g(y)g(*)g(y)g(end)p
Fy(i)q FE(.)150 1035 y FI(The)g(pattern)h(of)e(m)o(ultiplying)e(a)i(v)n
(ariable)g(b)o(y)h(itself)f(after)h(a)g(let-binding)f
FE(let)h(...)e(in)i(y)g(*)g(y)p FI(,)f(will)g(b)q(e)h(eviden)o(t)g(in)
150 1110 y(the)g(generated)i(co)q(de.)e(No)o(w,)f(w)o(e)h(can)g(use)h
FE(exp')f FI(to)g(generate)h(the)g(co)q(de)f(for)g FF(x)1389
1095 y FA(72)1438 1110 y FI(as)g(follo)o(ws:)221 1216
y FE(-)f(val)h(exp72')g(=)g Fy(h)p FE(fn)g(x)g Fy(\))h
FE(~)q(\(exp')f(\(72,)p Fy(h)o FE(x)p Fy(i)q FE(\)\))p
Fy(i)p FE(;)221 1281 y(val)f(exp72')h(=)g Fy(h)q FE(fn)g(x)g
Fy(\))472 1346 y FE(let)g(val)g(a)f(=)529 1411 y(let)h(val)g(b)g(=)586
1475 y(let)g(val)g(c)g(=)g(x)g Fu(\045)p FE(*)643 1540
y(let)g(val)g(d)g(=)700 1605 y(let)h(val)e(e)i(=)758
1670 y(let)f(val)g(f)f(=)h(x)g Fu(\045)p FE(*)g(1.0)758
1734 y(in)g(f)f Fu(\045)p FE(*)h(f)f(end)700 1799 y(in)i(e)f
Fu(\045)p FE(*)f(e)h(end)643 1864 y(in)g(d)h Fu(\045)o
FE(*)f(d)g(end)586 1929 y(in)g(c)g Fu(\045)p FE(*)g(c)g(end)529
1993 y(in)g(b)g Fu(\045)p FE(*)g(b)g(end)472 2058 y(in)g(a)g
Fu(\045)o FE(*)g(a)g(end)p Fy(i)h FE(:)e Fy(h)q FE(real)h
Fy(!)f FE(real)p Fy(i)q FE(.)150 2159 y FI(MetaML)h(p)q(erforms)g(an)f
(optimization)e(on)j(let-bindings)f(whereb)o(y)i(a)f(term)f(of)g(the)i
(form:)643 2276 y FE(let)g(val)e FF(x)h FI(=)26 b(\()p
FE(let)14 b(val)g FF(y)h FI(=)g FF(e)f FE(in)g FF(f)19
b FE(end)p FI(\))c FE(in)f FF(g)h FE(end)150 2392 y FI(is)f(replaced)h
(b)o(y)754 2508 y FE(let)f(val)g FF(y)i FI(=)e FF(e)g
FE(val)g FF(x)f FI(=)i FF(f)j FE(in)c FF(g)i FE(end)150
2624 y FI(Th)o(us,)e(the)g(co)q(de)h(returned)g(b)o(y)f(the)h(system)e
(is)h(in)f(fact)h(simpler:)p eop
%%Page: 29 40
29 39 bop 1882 0 a FB(29)221 195 y FE(val)13 b(exp72')h(=)g
Fy(h)q FE(fn)g(x)g Fy(\))472 260 y FE(let)g(val)g(f)f(=)h(x)g
Fu(\045)p FE(*)g(1.0)529 325 y(val)g(e)g(=)g(f)g Fu(\045)o
FE(*)g(f)529 390 y(val)g(d)g(=)g(e)g Fu(\045)p FE(*)g(e)529
454 y(val)g(c)g(=)g(x)g Fu(\045)p FE(*)f(\(d)i Fu(\045)o
FE(*)f(d\))529 519 y(val)g(b)g(=)g(c)g Fu(\045)p FE(*)g(c)529
584 y(val)g(a)f(=)i(b)f Fu(\045)p FE(*)f(b)472 649 y(in)h(a)g
Fu(\045)o FE(*)g(a)g(end)p Fy(i)h FE(:)e Fy(h)q FE(real)h
Fy(!)f FE(real)p Fy(i)q FE(.)150 749 y FI(Finally)m(,)e(w)o(e)j(can)h
(re-in)o(tegrate)f(this)g(sp)q(ecialized)h(function)e(in)o(to)h(the)g
(run-time)f(system)h(using)f(Run:)221 855 y FE(-)g(val)h(exp72)g(=)h
(run)d(exp72';)i(\(*)f(:)h(real)g Fy(!)f FE(real)i(*\).)150
955 y FI(This)c(new)h(function)f(can)g(no)o(w)g(b)q(e)h(used)g(an)o
(ywhere)g(where)h(need)f(to)f(compute)g FF(x)1420 940
y FA(72)1466 955 y FI(e\016cien)o(tly)m(.)f(Ha)o(ving)g(Run)h(in)150
1030 y(the)k(language)e(is)h(essen)o(tial)h(for)f(allo)o(wing)e(the)j
(programmer)d(to)i(use)h(an)f(automatically)e(generated)j(function)150
1105 y(an)o(ywhere)g(a)e(hand-written)h(function)g(can)g(b)q(e)h(used.)
150 1188 y(The)k(recursion)g(has)g(b)q(een)g(p)q(erformed)f(in)g(the)h
(\014rst)g(stage.)f(Eliminating)d(the)k(function)f(calls)g(in)o(v)o
(olv)o(ed)f(in)150 1262 y(recursion)j(can)f(yield)f(a)h(p)q(erformance)
g(impro)o(v)o(emen)o(t)d(for)j(short)g(lists.)f(F)m(or)h(longer)g
(lists,)f(the)h(size)h(of)e(the)150 1337 y(generated)d(expression)g
(could)f(burden)h(the)f(memory)e(managemen)o(t)f(system.)150
1495 y FD(2.6)56 b(Bac)n(k)18 b(and)i(F)-5 b(orth:)18
b(Tw)n(o)i(Useful)e(F)-5 b(unctions)19 b(on)g(Co)r(de)f(T)n(yp)r(es)150
1627 y FI(While)13 b(staging)g(programs,)f(w)o(e)j(found)e(an)h(in)o
(teresting)g(pair)g(of)f(functions)h(to)g(b)q(e)g(useful:)221
1741 y FE(fun)g(back)h(f)e(=)i Fy(h)p FE(fn)f(x)g Fy(\))g
FE(~)q(\(f)g Fy(h)p FE(x)p Fy(i)p FE(\))p Fy(i)p FE(;)g(\(*)g(:)f(\()p
Fy(h)f FE('a)p Fy(i)h(!)h(h)d FE('b)p Fy(i)p FE(\))j
Fy(!)g(h)d FE('a)j Fy(!)25 b FE('b)p Fy(i)14 b FE(*\))221
1806 y(fun)g(fo)o(rth)g(f)f(x)h(=)g Fy(h)r FE(~)q(f)g(~)q(x)p
Fy(i)p FE(;)156 b(\(*)14 b(:)f Fy(h)f FE('a)h Fy(!)25
b FE('b)p Fy(i)14 b(!)f(h)f FE('a)p Fy(i)h(!)h(h)d FE('b)p
Fy(i)j FE(*\).)150 1914 y FI(The)e(function)f Fy(h)p
FI(bac)o(k)p Fy(i)h FI(tak)o(es)f(a)h(function)f FE(f)g
FI(and)g(constructs)i(a)f(co)q(de)g(fragmen)o(t)e(represen)o(ting)j(a)e
(new)h(function.)150 1989 y(The)i(b)q(o)q(dy)f(of)g(the)g(new)h
(function)f(is)g(the)h(result)g(of)f(unfolding)e(the)j(function)f
FE(f)g FI(on)g(the)h(argumen)o(t)e(of)h(the)h(new)150
2064 y(function.)k(The)i(function)e FE(fo)o(rth)h FI(tak)o(es)h(a)e(co)
q(de)i(fragmen)o(t)d FE(f)i FI(and)g(a)g(co)q(de)g(fragmen)o(t)f
FE(x)p FI(,)g(and)h(constructs)i(a)150 2139 y(co)q(de)c(fragmen)o(t)d
(represen)o(ting)k(the)e(application)f(of)g(the)i(\014rst)f(to)g(the)g
(second.)h(These)g(t)o(w)o(o)f(\\computational)150 2213
y(patterns")d(come)f(up)g(often)g(in)g(the)h(course)g(of)f(m)o
(ulti-stage)e(programmers.)g(W)m(e)i(ha)o(v)o(e)g(already)f(used)j(a)d
(similar)150 2288 y(construction)k(to)f(stage)h(the)f
FE(memb)q(er2)g FI(function)f(of)h(t)o(yp)q(e)g Fy(h)e
FE("a)p Fy(i)i(!)25 b FE("a)14 b(list)g Fy(!)f(h)p FE(b)q(o)q(ol)p
Fy(i)q FI(,)g(within)h(the)g(term)g Fy(h)p FE(fn)150
2363 y(x)g Fy(\))g FE(~)q(\(memb)q(er2)g Fy(h)p FE(x)p
Fy(i)g FE([1,2,3]\))p Fy(i)e FI(whic)o(h)i(has)g(t)o(yp)q(e)h
Fy(h)c FE("a)j Fy(!)f FE(b)q(o)q(ol)p Fy(i)q FI(.)150
2446 y(In)h(our)h(exp)q(erience,)h(annotating)d(a)h(function)g(to)g(ha)
o(v)o(e)g(t)o(yp)q(e)h Fy(h)c FE('a)p Fy(i)j(!)g(h)e
FE('b)p Fy(i)i FI(requires)h(less)g(annotations)f(than)150
2521 y(annotating)i(it)g(to)h(ha)o(v)o(e)g(t)o(yp)q(e)g
Fy(h)12 b FE('a)k Fy(!)28 b FE('b)p Fy(i)17 b FI(and)g(is)f(often)h
(easier)h(to)f(think)f(ab)q(out.)h(F)m(urthermore,)f(p)q(erhaps)150
2595 y(b)q(ecause)g(w)o(e)e(are)h(functional)e(programmers,)e(it)j
(seemed)g(more)g(con)o(v)o(enien)o(t)g(to)g(think)g(of)f(co)q(de)i
(transformers)150 2670 y(\(functions)h(from)e(co)q(de)j(to)f(co)q(de\))
h(rather)g(than)f(represen)o(tations)i(of)d(functions)h(\(co)q(de)h(of)
f(functions\).)g(Both)p eop
%%Page: 30 41
30 40 bop 1882 0 a FB(30)150 192 y FI(reasons)21 b(lead)e(us)h(to)g(a)o
(v)o(oid)e(writing)h(programs)g(of)g(the)h(latter)g(t)o(yp)q(e)h
(except)g(when)f(w)o(e)g(need)h(to)e(see)i(the)150 266
y(generated)15 b(co)q(de.)150 349 y(The)f(same)f(observ)n(ations)h
(apply)f(to)h(programs)f(with)g(more)g(than)h(t)o(w)o(o)g(stages.)g
(Consider)g(the)h(function:)221 452 y FE(\(*)e(back2)i(:)e(\()p
Fy(h)f FE('a)p Fy(i)i(!)f(hh)f FE('b)p Fy(ii)i(!)f(hh)f
FE('c)p Fy(ii)p FE(\))i Fy(!)g(h)d FE('a)j Fy(!)f(h)f
FE('b)i Fy(!)24 b FE('c)p Fy(i)q(i)13 b FE(*\))221 516
y(fun)h(back2)h(f)e(=)h Fy(h)q FE(fn)f(x)h Fy(\))g(h)p
FE(fn)g(y)g Fy(\))g FE(~)r(~)q(\(f)g Fy(h)p FE(x)p Fy(i)g(hh)q
FE(y)p Fy(ii)p FE(\))p Fy(ii)p FE(.)150 614 y FI(This)g(function)f
(allo)o(ws)g(us)h(to)g(write)g(a)f(program)f(whic)o(h)i(tak)o(es)g(a)g
Fy(h)p FE(a)p Fy(i)g FI(and)f(a)h Fy(hh)p FE(b)p Fy(i)q(i)g
FI(as)f(argumen)o(ts)g(and)h(whic)o(h)150 689 y(pro)q(duces)k(a)e
Fy(hh)p FE(c)p Fy(i)q(i)p FI(,)g(and)g(turns)h(it)f(in)o(to)g(a)g
(three-stage)i(function.)e(Our)h(exp)q(erience)h(is)e(that)h(suc)o(h)g
(functions)150 764 y(ha)o(v)o(e)e(considerably)g(few)o(er)g
(annotations,)f(and)h(are)g(easier)h(to)f(reason)g(ab)q(out.)g(W)m(e)f
(expand)h(on)g(this)g(p)q(oin)o(t)f(in)150 839 y(the)g(next)h(section.)
150 994 y FD(2.7)56 b(Staging)18 b(the)g(Inner)h(Pro)r(duct:)f(A)h
(Three-Stage)e(Example)150 1124 y FI(The)h(function)f(for)h(computing)e
(the)i(inner)g(pro)q(duct)g(of)f(t)o(w)o(o)g(v)o(ectors)i(has)f(b)q
(een)h(studied)f(in)f(sev)o(eral)h(other)150 1198 y(w)o(orks)c([29,)5
b(45],)13 b(and)h(its)f(execution)i(can)f(b)q(e)h(usefully)e(separated)
i(in)o(to)e(three)j(distinct)e(stages:)168 1311 y(1.)20
b(In)15 b(the)i(\014rst)g(stage,)e(kno)o(wing)g(the)h(size)h(of)e(the)i
(t)o(w)o(o)e(v)o(ectors)i(o\013ers)g(an)f(opp)q(ortunit)o(y)f(to)h(sp)q
(ecialize)g(the)221 1385 y(inner)10 b(pro)q(duct)i(function)e(on)g
(that)g(size,)h(remo)o(ving)e(a)h(lo)q(oping)f(o)o(v)o(erhead)i(from)d
(the)j(b)q(o)q(dy)g(of)f(the)h(function.)168 1459 y(2.)20
b(In)14 b(the)g(second)h(stage,)f(kno)o(wing)f(the)i(\014rst)f(v)o
(ector)h(o\013ers)g(an)f(opp)q(ortunit)o(y)f(for)h(sp)q(ecialization)g
(based)g(on)221 1534 y(the)j(v)n(alues)f(in)g(the)h(v)o(ector.)f(If)g
(the)h(inner)g(pro)q(duct)g(of)f(that)g(v)o(ector)h(is)g(to)f(b)q(e)h
(tak)o(en)f(man)o(y)f(times)g(with)221 1609 y(other)e(v)o(ectors)h(it)f
(can)g(b)q(e)h(sp)q(ecialized)g(b)o(y)f(remo)o(ving)e(the)j(o)o(v)o
(erhead)f(of)g(lo)q(oking)e(up)i(the)h(elemen)o(ts)f(of)f(the)221
1683 y(\014rst)g(v)o(ector)g(eac)o(h)g(time.)d(Kno)o(wing)i(the)h(size)
g(and)f(the)h(\014rst)g(v)o(ector)g(is)f(exactly)h(the)f(case)i(when)f
(computing)221 1758 y(the)k(m)o(ultiplication)d(of)i(t)o(w)o(o)h
(matrices.)f(F)m(or)g(eac)o(h)i(ro)o(w)e(in)h(the)h(\014rst)f(matrix,)e
(the)j(dot)f(pro)q(duct)h(of)e(that)221 1833 y(ro)o(w)e(will)g(b)q(e)h
(tak)o(en)g(with)g(eac)o(h)g(column)e(of)i(the)g(second)h(matrix.)168
1907 y(3.)20 b(In)13 b(the)i(third)f(stage,)g(kno)o(wing)e(the)j
(second)g(v)o(ector,)f(the)h(computation)d(is)h(brough)o(t)h(to)g
(completion.)150 2020 y(W)m(e)i(will)f(presen)o(t)j(three)g(v)o
(ersions)f(of)f(the)h(inner)g(pro)q(duct)g(function.)f(One)h(\()p
FE(ip)o(ro)q(d)p FI(\))g(with)f(no)h(staging)f(anno-)150
2094 y(tations,)e(the)h(second)h(\()p FE(ip)o(ro)q(d2)p
FI(\))f(with)f(t)o(w)o(o)g(lev)o(els)h(of)f(annotations,)f(and)i(the)g
(third)f(\()p FE(ip)o(ro)q(d3)p FI(\))i(with)e(t)o(w)o(o)g(lev)o(els)
150 2169 y(of)e(annotations)h(but)g(constructed)i(with)e(the)g
FE(back2)h FI(function.)e(In)h(MetaML)h(w)o(e)f(quote)g(relational)f
(op)q(erators)150 2244 y(suc)o(h)j(as)f(less-than)g FF(<)g
FI(and)g(greater-than)h FF(>)f FI(b)q(ecause)h(of)f(the)g(p)q(ossible)g
(confusion)g(with)f(Brac)o(k)o(ets.)221 2346 y FE(\(*)g(ip)o(ro)q(d)i
(:)e(int)h Fy(!)g FE(V)o(ecto)o(r)g Fy(!)f FE(V)o(ecto)o(r)h
Fy(!)g FE(int)g(*\))221 2411 y(fun)g(ip)o(ro)q(d)h(n)f(v)g(w)g(=)290
2476 y(if)f(n)i(')p FF(>)p FE(')e(0)326 2540 y(then)j(\(\(nth)f(v)f
(n\))g(*)g(\(nth)g(w)h(n\)\))f(+)g(\(ip)o(ro)q(d)h(\(n-1\))f(v)g(w\))
326 2605 y(else)h(0;)p eop
%%Page: 31 42
31 41 bop 1882 0 a FB(31)221 195 y FE(\(*)13 b(ip)o(ro)q(d2)i(:)e(int)h
Fy(!)g(h)p FE(V)o(ecto)o(r)g Fy(!)f(h)p FE(V)o(ecto)o(r)h
Fy(!)g FE(int)p Fy(ii)g FE(*\))221 260 y(fun)g(ip)o(ro)q(d2)g(n)h(=)f
Fy(h)p FE(fn)g(v)g Fy(\))f(h)p FE(fn)h(w)g Fy(\))291
325 y FE(~)r(~)q(\(if)g(n)g(')p FF(>)p FE(')f(0)389 390
y(then)i Fy(hh)p FE(\()q(~)q(\(lift)d(\(nth)i(v)i(~\(lift)c(n\)\)\))i
(*)g(\(nth)h(w)g(~)q(\(lift)c(\()q(~)q(lift)g(n\)\)\)\))k(+)f(\()q(~)r
(\()q(~)q(\(ip)o(ro)q(d2)g(\(n-1\)\))h(v\))f(w\))p Fy(ii)389
454 y FE(else)g Fy(hh)q FE(0)p Fy(i)o(i)q FE(\))p Fy(ii)p
FE(;)221 584 y(\(*)f(ip)o(ro)q(dF2)h(:)g(int)g Fy(!)f(h)p
FE(V)o(ecto)o(r)p Fy(i)i(!)e(hh)p FE(V)o(ecto)o(r)p Fy(ii)h(!)g(hh)p
FE(int)p Fy(i)q(i)g FE(*\))221 649 y(fun)g(ip)o(ro)q(dF2)g(n)g(v)g(w)g
(=)290 713 y(if)f(n)i(')p FF(>)p FE(')e(0)326 778 y(then)j
Fy(hh)e FE(\()q(~)q(\(lift)d(\(nth)16 b(~)q(v)f(~)q(\(lift)c(n\)\)\))k
(*)f(\(nth)i(~)r(~)q(w)f(~)q(\(lift)c(\()q(~)q(lift)g(n\)\)\)\))k(+)g
(~)r(~)q(\(ip)o(ro)q(dF2)f(\(n-1\))h(v)f(w\))p Fy(ii)326
843 y FE(else)h Fy(hh)p FE(0)p Fy(ii)p FE(;)221 972 y(fun)f(ip)o(ro)q
(d3)g(n)h(=)f(back2)g(\(ip)o(ro)q(dF2)h(n\).)150 1074
y FI(As)g(w)o(e)f(predicted)i(in)e(the)h(last)f(section,)h(the)g(v)o
(ersion)f(written)h(with)f FE(back2)h FI(has)g(one)g(less)g
(annotation.)d(More)150 1148 y(imp)q(ortan)o(tly)m(,)f(annotating)i
(the)h(v)o(ersion)g(written)h(with)e FE(back2)i FI(seems)f(less)h(cum)o
(b)q(ersome.)d(While)h(this)h(obser-)150 1223 y(v)n(ation)g(is)g(a)h
(somewhat)f(sub)r(jectiv)o(e,)h(it)g(ma)o(y)d(b)q(ene\014t)17
b(future)e(MetaML)g(or)g(m)o(ulti-stage)e(programmi)o(ng.)e(W)m(e)150
1298 y(emphasize)g(that)h(the)g(t)o(yp)q(e)g(inference)h(mec)o(hanism)c
(and)j(the)g(in)o(teractiv)o(e)g(en)o(vironmen)o(t)e(are)i(esp)q
(ecially)g(useful)150 1373 y(when)i(exploring)g(di\013eren)o(t)g
(approac)o(hes)h(to)f(annotation)f(and)g(staging.)150
1456 y(Another)k(b)q(ene\014t)h(of)e(MetaML)h(is)f(pro)o(viding)f(us)i
(with)f(a)h(w)o(a)o(y)e(to)i(visualize)f(m)o(ulti-stage)e(computation,)
g(in)150 1530 y(essence,)h(b)o(y)d(running)g(them)g(stage)h(b)o(y)g
(stage)g(and)f(insp)q(ecting)h(the)g(in)o(termediate)f(results.)i(By)e
(testing)h FE(ip)o(ro)q(d3)150 1605 y FI(on)h(some)f(inputs)h(w)o(e)g
(can)g(immedia)o(tely)d(see)k(the)g(results:)221 1711
y FE(-)p Fy(j)e FE(val)h(f1)f(=)h(ip)o(ro)q(d3)g(3;)221
1776 y(f1)f(=)h Fy(h)p FE(fn)g(d1)g Fy(\))378 1841 y(h)p
FE(fn)g(d5)g Fy(\))442 1906 y FE(\()q(~)q(\(lift)e(\()p
Fu(\045)o FE(nth)j(d1)f(3\)\))g Fu(\045)p FE(*)f(\()p
Fu(\045)p FE(nth)i(d5)f(3\)\))g Fu(\045)p FE(+)442 1970
y(\()q(~)q(\(lift)e(\()p Fu(\045)o FE(nth)j(d1)f(2\)\))g
Fu(\045)p FE(*)f(\()p Fu(\045)p FE(nth)i(d5)f(2\)\))g
Fu(\045)p FE(+)442 2035 y(\()q(~)q(\(lift)e(\()p Fu(\045)o
FE(nth)j(d1)f(1\)\))g Fu(\045)p FE(*)f(\()p Fu(\045)p
FE(nth)i(d5)f(1\)\))g Fu(\045)p FE(+)442 2100 y(0)p Fy(ii)268
2165 y FE(:)f Fy(h)p FE(V)o(ecto)o(r)h Fy(!)g(h)p FE(V)o(ecto)o(r)g
Fy(!)f FE(int)p Fy(i)q(i)p FE(.)150 2266 y FI(When)g
FE(f1)g FI(is)g(Run,)g(it)f(returns)j(a)e(function.)g(When)g(this)g
(function)g(is)h(applied)e(to)h(a)g(v)o(ector,)h(it)f(builds)g(another)
150 2341 y(piece)e(of)e(co)q(de.)i(This)f(building)e(pro)q(cess)k
(includes)f(lo)q(oking)d(up)i(eac)o(h)h(elemen)o(t)e(in)h(the)g
(\014rst)h(v)o(ector)g(and)f(splicing-)150 2415 y(in)16
b(the)g(actual)g(v)n(alue)f(using)h(the)h(Lift)e(op)q(erator.)h(Lift)f
(is)h(esp)q(ecially)g(useful)h(when)f(w)o(e)g(wish)g(to)g(insp)q(ect)h
(the)150 2490 y(generated)e(co)q(de:)221 2596 y FE(val)e(f2)h(=)g
(\(run)h(f1\))e([1,0,4];)221 2661 y(f2:)f Fy(h)q FE(V)o(ecto)o(r)i
Fy(!)f FE(int)p Fy(i)h FE(=)p eop
%%Page: 32 43
32 42 bop 1882 0 a FB(32)221 195 y Fy(h)p FE(fn)14 b(d1)g
Fy(\))f FE(\(4)h Fu(\045)p FE(*)f(\()p Fu(\045)p FE(nth)i(d1)f(3\)\))g
Fu(\045)o FE(+)396 260 y(\(0)g Fu(\045)p FE(*)f(\()p
Fu(\045)p FE(nth)i(d1)f(2\)\))g Fu(\045)o FE(+)396 325
y(\(1)g Fu(\045)p FE(*)f(\()p Fu(\045)p FE(nth)i(d1)f(1\)\))g
Fu(\045)o FE(+)g(0)p Fy(i)p FE(.)150 414 y FI(The)e(actual)g(v)n(alues)
f(of)g(the)i(\014rst)f(arra)o(y)g(app)q(ear)g(in)g(the)g(co)q(de,)g
(and)g(the)g(access)i(function)d FE(nth)i FI(app)q(ears)g(applied)150
488 y(to)h(the)g(second)h(v)o(ector)g FE(d1)p FI(.)150
571 y(This)f(co)q(de)h(still)f(do)q(es)h(not)f(tak)o(e)g(full)f(adv)n
(an)o(tage)h(of)g(all)f(the)i(information)c(kno)o(wn)j(in)g(the)h
(second)g(stage.)f(F)m(or)150 646 y(example,)9 b(w)o(e)i(ma)o(y)e(wish)
i(to)f(eliminate)f(m)o(ultiplications)f(b)o(y)j FE(0)f
FI(or)h FE(1)p FI(.)f(Suc)o(h)h(m)o(ultiplications)d(can)j(b)q(e)g
(optimized)150 721 y(without)i(kno)o(wing)g(the)h(v)n(alue)f(of)g(the)h
(second)g(op)q(erand.)g(T)m(o)f(this)g(end,)h(w)o(e)g(write)g(a)f
(\\smarter")g(function)g FE(add)150 796 y FI(whic)o(h)h(giv)o(en)f(a)h
(v)o(ector)h(index)f FE(i)p FI(,)f(an)h(in)o(teger)g
FE(x)g FI(from)e(the)j(\014rst)g(v)o(ector,)f(and)g(a)f(piece)i(of)e
(co)q(de)i FE(y)f FI(represen)o(ting)150 870 y(the)i(second)h(v)o
(ector,)e(constructs)j(a)d(piece)i(of)d(co)q(de)j(whic)o(h)e(adds)h
(the)g(result)g(of)f(the)h FE(x)g FI(and)f FE(y)g FI(m)o(ultiplication)
150 945 y(to)f(the)g(co)q(de-v)n(alued)g(fourth)g(argumen)o(t)f
FE(e)p FI(.)221 1036 y FE(\(*)g(add)i(:)e(int)i Fy(!)e
FE(int)h Fy(!)f(h)q FE(V)o(ecto)o(r)p Fy(i)h(!)f(h)p
FE(int)p Fy(i)i(!)e(h)p FE(int)p Fy(i)h FE(*\))221 1101
y(fun)g(add)h(i)e(x)h(y)g(e)h(=)290 1165 y(if)e(x=0)h(then)i(e)412
1230 y(else)f(if)e(x=1)h(then)i Fy(h)p FE(\(nth)g(~)q(y)f(~)q(\(lift)c
(i\)\))j(+)h(~)q(e)p Fy(i)611 1295 y FE(else)g Fy(h)p
FE(\()q(~)q(\(lift)d(x\))i(*)f(\(nth)j(~)q(y)q(~)q(\(lift)c(i\)\)\))i
(+)h(~)q(e)p Fy(i)q FE(.)150 1384 y FI(This)f(sp)q(ecialized)g
(function)g(can)g(no)o(w)g(b)q(e)g(used)h(to)f(build)f(an)g(impro)o(v)o
(ed)f(v)o(ersion)j(of)e(the)h FE(ip)o(ro)q(dF2)g FI(function:)221
1475 y FE(\(*)f(ip)o(ro)q(dFS2)h(:)g(int)g Fy(!)f(h)p
FE(V)o(ecto)o(r)p Fy(i)i(!)e(hh)p FE(V)o(ecto)o(r)p Fy(i)q(i)h(!)f(hh)p
FE(int)p Fy(i)q(i)h FE(*\))221 1540 y(fun)g(ip)o(ro)q(dFS2)g(n)g(v)g(w)
g(=)290 1604 y(if)f(n)i(=)f(1)f(then)j Fy(h)p FE(add)e(n)h(\(nth)h(~)q
(v)e(n\))h(~)q(w)f Fy(h)p FE(0)p Fy(ii)442 1669 y FE(else)h
Fy(h)p FE(add)g(n)f(\(nth)i(~)q(v)e(n\))i(~w)g(~)q(\(ip)o(ro)q(dFS2)e
(\(n-1\))g(v)g(w\))p Fy(i)q FE(;)221 1799 y(fun)g(ip)o(ro)q(dS2)g(n)h
(=)f(back2)h(\(ip)o(ro)q(dFS2)f(n\).)150 1887 y FI(No)o(w)g(let)g(us)g
(lo)q(ok)f(at)g(the)i(result)g(of)e(the)h(\014rst)h(stage)f
(computation:)221 1978 y FE(val)f(f3)h(=)g(ip)o(ro)q(dS2)g(3;)221
2043 y(f3:)e Fy(h)q FE(V)o(ecto)o(r)i Fy(!)f(h)p FE(V)o(ecto)o(r)h
Fy(!)f FE(int)p Fy(i)q(i)h FE(=)221 2108 y Fy(h)p FE(fn)g(d1)g
Fy(\))285 2173 y(h)p FE(fn)g(d5)g Fy(\))350 2237 y FE(~)q(\()p
Fu(\045)p FE(add)g(3)g(\()p Fu(\045)p FE(nth)h(d1)f(3\))f
Fy(h)q FE(d5)p Fy(i)490 2302 y(h)j FE(~\()p Fu(\045)p
FE(add)f(2)f(\()p Fu(\045)o FE(nth)h(d1)f(2\))g Fy(h)p
FE(d5)p Fy(i)662 2367 y(h)q FE(~)q(\()p Fu(\045)p FE(add)h(1)e(\()p
Fu(\045)p FE(nth)i(d1)f(1\))g Fy(h)p FE(d5)p Fy(i)820
2432 y(h)p FE(0)p Fy(i)p FE(\))p Fy(i)p FE(\))p Fy(i)p
FE(\))p Fy(i)q(i)p FE(.)150 2521 y FI(This)i(co)q(de)g(is)g(linear)f
(in)g(the)i(size)f(of)f(the)i(v)o(ector.)f(If)f(w)o(e)h(had)g(actually)
f(in-lined)f(the)j(calls)e(to)h FE(add)g FI(it)g(w)o(ould)150
2595 y(b)q(e)f(exp)q(onen)o(tial.)e(Con)o(trolling)f(co)q(de)i
(explosion)g(is)f(a)h(side)g(b)q(ene\014t)i(of)d(the)h(sharing)g(pro)o
(vided)g(b)o(y)f(cross-stage)150 2670 y(p)q(ersisten)o(t)j(constan)o
(ts)e(suc)o(h)h(as)f FE(add)p FI(.)p eop
%%Page: 33 44
33 43 bop 1882 0 a FB(33)150 192 y FI(No)o(w)14 b(let)g(us)g(observ)o
(e)h(the)f(result)h(of)e(the)i(second)g(stage)f(computation:)221
298 y FE(val)f(f4)h(=)g(\(run)f(f3\))g([1,0,4];)221 363
y(f4:)f Fy(h)q FE(V)o(ecto)o(r)i Fy(!)f FE(int)p Fy(i)h
FE(=)g Fy(h)q FE(fn)f(d1)i Fy(\))e FE(\(4)h Fu(\045)o
FE(*)g(\()p Fu(\045)p FE(nth)h(d1)f(3\)\))f Fu(\045)p
FE(+)h(\()p Fu(\045)p FE(nth)h(d1)f(1\))g Fu(\045)o FE(+)g(0)p
Fy(i)p FE(.)150 464 y FI(No)o(w)i(only)f(the)i(m)o(ultiplicatio)o(ns)d
(that)i(con)o(tribute)h(to)f(the)h(answ)o(er)g(remain.)d(If)i(the)g(v)o
(ector)h(is)f(sparse,)h(then)150 538 y(this)d(sort)g(of)g(optimization)
d(can)j(ha)o(v)o(e)g(dramatic)e(e\013ects.)150 622 y(Finally)m(,)g
(note)j(that)f(while)g FE(ip)o(ro)q(dFS2)h FI(is)f(a)g(three-stage)i
(function,)e(the)h(terms)f(in)g(the)h(b)q(o)q(dy)g(of)f(this)g
(function)150 696 y(in)o(v)o(olv)o(e)c(only)h(t)o(w)o(o)g(lev)o(els)h
(of)f(terms.)g(Suc)o(h)h(implicit)d(increase)k(in)e(the)h(n)o(um)o(b)q
(er)f(of)g(stages)h(is)g(a)f(protot)o(ypical)g(ex-)150
771 y(ample)f(of)h(ho)o(w)g(m)o(ulti-stage)f(programs)g(dev)o(elop)i
(naturally)e(from)g(the)i(comp)q(osition)e(of)h(t)o(w)o(o-stage)h
(programs,)150 846 y(or)i(an)o(y)f(lo)o(w)o(er-n)o(um)o(b)q(er-of)f
(stages)j(programs.)p eop
%%Page: 34 45
34 44 bop 822 430 a FL(Chapter)31 b(3)324 656 y(Staging)i(a)g(Simple)f
(T)-8 b(erm-Rewriting)700 791 y(Implemen)m(tation)949
1004 y FC(A)o(nd)13 b(let)g(this)f(world)i(no)f(longer)f(b)n(e)h(a)g
(stage)949 1063 y(T)m(o)h(fe)n(e)n(d)f(c)n(ontention)d(in)j(a)g
(lingering)f(act;)1317 1156 y(Northumb)n(erland)p FB(,)d(Act)k(1,)g
(Scene1,)1368 1215 y FC(King)g(Henry)g(IV)p FB(,)e(Shak)o(esp)q(eare)
150 1389 y FI(In)f(this)f(c)o(hapter)i(w)o(e)f(presen)o(t)h(an)f
(extended)h(example)d(of)h(applying)g(the)h(metho)q(d)f(of)g(m)o
(ulti-stage)f(programmi)o(ng)150 1463 y(with)15 b(explicit)f
(annotations.)h(Starting)f(with)h(a)g(single-stage)g(term-rewriting)f
(function,)h(w)o(e)g(annotate)g(it)g(to)150 1538 y(deriv)o(e)k(a)f(t)o
(w)o(o-stage)g(function.)g(W)m(e)g(p)q(oin)o(t)g(out)h(some)e
(limitations)f(of)i(this)g(direct)h(attempt)f(to)g(stage)h(the)150
1613 y(function)11 b(and)h(sho)o(w)g(ho)o(w)f(re-implemen)o(ting)e(the)
j(function)g(in)f(con)o(tin)o(uation-passing)f(st)o(yle)i(\(CPS\))g
(impro)o(v)o(es)150 1688 y(the)h(generated)h(co)q(de)f(substan)o
(tially)m(.)e(Rewriting)h(the)h(program)d(in)o(to)i(CPS)h(is)f(an)h
(example)e(of)h(what)g(is)g(kno)o(wn)150 1762 y(in)h(the)i(partial)e
(ev)n(aluation)f(literature)j(as)f FH(binding-time)g(impr)n(ovement)p
FI(.)150 1916 y FD(3.1)56 b(T)-5 b(erm-Rewriti)o(ng)150
2043 y FI(Dersho)o(witz)16 b([24])d(de\014nes)k(a)d FH(term)i(r)n
(ewriting)e(system)h FI(as)g(a)f(set)i(of)f(directed)h(rules.)f(Eac)o
(h)h(rule)f(is)g(made)f(of)g(a)150 2118 y(left-hand)d(side)i(and)e(a)h
(righ)o(t-hand)f(side.)h(A)g(rule)g(ma)o(y)e(b)q(e)j(applied)e(to)h(a)f
(term)h FF(t)g FI(if)f(a)g(sub-term)h FF(s)g FI(of)f
FF(t)h FI(matc)o(hes)150 2193 y(the)j(left-hand)f(side)g(under)i(some)d
(substitution)i FF(\033)q FI(.)f(A)g(rule)h(is)f(applied)f(b)o(y)i
(replacing)f FF(s)g FI(with)g FF(s)1688 2178 y Fs(0)1700
2193 y FI(,)g(where)i FF(s)1866 2178 y Fs(0)1892 2193
y FI(is)150 2268 y(the)d(result)g(of)e(applying)g(the)h(substitution)h
FF(\033)g FI(to)f(the)h(righ)o(t-hand)e(side.)h(W)m(e)g(call)f(the)i
(mo)q(di\014ed)d FF(t)i FI(term)g FF(t)1818 2252 y Fs(0)1830
2268 y FI(,)f(and)150 2342 y(sa)o(y)j FH(\\)p FF(t)i
FH(r)n(ewrites)d(\(in)j(one)g(step\))f(to)g FF(t)747
2327 y Fs(0)759 2342 y FH(")p FI(,)f(and)g(write)h FF(t)d
Fy(\000)-7 b(!)14 b FF(t)1117 2327 y Fs(0)1129 2342 y
FI(.)g(The)h(c)o(hoice)g(of)e(whic)o(h)h(rule)h(to)f(apply)g(is)g(made)
150 2417 y(non-deterministically)m(.)d(As)j(an)g(example,)e(the)j
(rules)f(for)g(a)f(Monoid)g([24])g(are:)879 2519 y FF(x)c
FI(+)g(0)i Fy(\000)-6 b(!)1053 2525 y Fr(r)1067 2531
y Fq(1)1096 2519 y FF(x)879 2594 y FI(0)9 b(+)g FF(x)i
Fy(\000)-6 b(!)1053 2600 y Fr(r)1067 2606 y Fq(2)1096
2594 y FF(x)773 2668 y(x)9 b FI(+)h(\()p FF(y)h FI(+)f
FF(z)r FI(\))h Fy(\000)-6 b(!)1053 2674 y Fr(r)1067 2680
y Fq(3)1096 2668 y FI(\()p FF(x)9 b FI(+)h FF(y)q FI(\))g(+)f
FF(z)1014 2795 y FI(34)p eop
%%Page: 35 46
35 45 bop 1882 0 a FB(35)150 192 y FI(V)m(ariables)14
b FF(x)p FI(,)f FF(y)q FI(,)i(and)f FF(z)j FI(in)d(suc)o(h)h(rules)g
(can)g(eac)o(h)g(matc)o(h)e(an)o(y)h(term.)f(If)h(a)g(v)n(ariable)g(o)q
(ccurs)h(more)f(than)g(once)150 266 y(on)f(the)g(left-hand)g(side)g(of)
f(a)h(rule,)g(all)e(o)q(ccurrences)17 b(m)o(ust)11 b(matc)o(h)h(iden)o
(tical)g(terms.)h(These)h(rules)f(allo)o(w)f(us)h(to)150
341 y(ha)o(v)o(e)h(deriv)n(ations)f(suc)o(h)i(as:)795
439 y(\()p FF(a)9 b FI(+)h FF(b)p FI(\))f(+)h(\(0)f(+)g(\()p
FF(d)g FI(+)h FF(e)p FI(\)\))p 969 456 228 2 v 714 514
a Fy(\000)-6 b(!)27 b FI(b)o(y)14 b FF(r)886 520 y FA(2)904
514 y FF(;)7 b(\033)12 b FI(=)g([\()p FF(d)c FI(+)i FF(e)p
FI(\))p FF(=x)p FI(])795 588 y(\()p FF(a)f FI(+)h FF(b)p
FI(\))f(+)h(\()p FF(d)f FI(+)g FF(e)p FI(\))p 795 605
298 2 v 714 663 a Fy(\000)-6 b(!)27 b FI(b)o(y)14 b FF(r)886
669 y FA(3)904 663 y FF(;)7 b(\033)12 b FI(=)g([\()p
FF(a)d FI(+)g FF(b)p FI(\))p FF(=x;)e(d=y)q(;)g(e=z)r
FI(])795 738 y(\(\()p FF(a)i FI(+)h FF(b)p FI(\))f(+)h
FF(d)p FI(\))f(+)g FF(e)150 835 y FI(where)15 b(the)g(sub-term)e
FF(s)h FI(b)q(eing)g(rewritten)h(has)f(b)q(een)h(underlined.)150
918 y(Generally)m(,)c(suc)o(h)i(rules)g(do)g(not)f(c)o(hange)h(o)o(v)o
(er)f(the)h(life)f(of)g(a)g(term-rewriting)g(system.)f(A)o(t)i(the)g
(same)f(time,)e(the)150 992 y(basic)15 b(form)f(of)g(a)h(matc)o(hing)e
(function)i(is)g(a)g(sim)o(ultaneous)f(tra)o(v)o(ersal)h(of)f(a)h(term)
g(and)g(the)g(left-hand)g(side)h(of)150 1067 y(the)f(rule)f(it)f(is)h
(b)q(eing)g(matc)o(hed)f(against.)g(The)h(in)o(v)n(ariance)g(of)f(the)i
(rules)f(during)g(the)g(normal)e(lifetime)g(of)h(the)150
1142 y(rewriting)h(system)f(o\013ers)i(an)e(opp)q(ortunit)o(y)h(for)f
(staging:)g(W)m(e)g(can)h(sp)q(ecialize)h(matc)o(hing)c(o)o(v)o(er)j
(the)h(rules)f(in)f(a)150 1217 y(\014rst)d(stage,)f(and)h(eliminate)d
(the)j(o)o(v)o(erhead)f(of)g(tra)o(v)o(ersing)h(the)f(left-hand)g(side)
h(of)f(the)h(rules.)f(Not)g(only)g(that,)g(but)150 1291
y(w)o(e)14 b(will)e(see)j(that)f(w)o(e)g(can)g(also)f(remo)o(v)o(e)g(a)
h(signi\014can)o(t)f(amoun)o(t)f(of)h(administrativ)o(e)f(computations)
g(in)o(v)o(olv)o(ed)150 1366 y(in)j(constructing)i(and)f(applying)e
(the)j(substitution)f FF(\033)q FI(.)f(W)m(e)h(exp)q(ect)h(that)f(this)
g(staging)f(w)o(ould)g(signi\014can)o(tly)150 1441 y(reduce)h(the)e
(cost)h(of)e(rewriting)h(a)f(term.)150 1599 y FD(3.2)56
b(A)19 b(Single-Stage)e(Implem)o(en)n(tation)150 1732
y FI(In)d(this)g(section,)g(w)o(e)g(presen)o(t)i(the)e(implemen)o
(tatio)o(n)d(of)j(part)g(of)f(a)h(simple)e(term-rewriting)h(system.)150
1880 y FG(3.2.1)48 b(An)15 b(Implemen)o(tati)o(on)e(of)i(T)l(erms)g
(and)h(P)o(atterns)150 1996 y FI(Both)e(terms)g(and)g(patterns)h(can)f
(b)q(e)g(represen)o(ted)j(using)d(the)g(follo)o(wing)d(MetaML)k(t)o(yp)
q(e:)221 2102 y FE(datat)o(yp)q(e)g(term)e(=)h(V)o(a)o(r)g(of)f(string)
479 2167 y Fy(j)34 b FE(Int)14 b(of)f(int)479 2232 y
Fy(j)34 b FE(Op)14 b(of)f(term)h(*)f(string)i(*)e(term.)150
2333 y FI(The)18 b(constructors)h(of)d(this)h(t)o(yp)q(e)h(are)f
FE(V)o(a)o(r)p FI(,)g FE(Int)g FI(and)f FE(Op)p FI(,)h(corresp)q
(onding)h(to)f(v)n(ariables,)f(in)o(tegers,)h(and)g(ap-)150
2408 y(plications)f(of)f(binary)h(op)q(erators.)h(Th)o(us,)g(w)o(e)f
(can)h(represen)o(t)i(terms)d(suc)o(h)h(as)g FF(t)1447
2414 y FA(1)1481 2408 y FI(=)f(\()p FF(a)11 b FI(+)g
FF(b)p FI(\))g(+)g(\()p FF(d)g FI(+)g FF(e)p FI(\))17
b(and)150 2483 y FF(t)165 2489 y FA(2)195 2483 y FI(=)12
b(\(\()p FF(a)d FI(+)h FF(b)p FI(\))f(+)h FF(d)p FI(\))f(+)g
FF(e)14 b FI(as:)221 2589 y FE(val)f(t1)h(=)g(Op\(Op\(V)o(a)o(r)g
("a","+",V)o(a)o(r)d("b"\),"+",Op\(V)o(a)o(r)i("d","+",V)o(a)o(r)f
("e"\)\);)221 2654 y(val)h(t2)h(=)g(Op\(Op\(Op\(V)o(a)o(r)g("a","+",V)o
(a)o(r)e("b"\),"+",V)o(a)o(r)g("d"\),"+",V)o(a)o(r)g("e"\).)p
eop
%%Page: 36 47
36 46 bop 1882 0 a FB(36)150 192 y FI(W)m(e)13 b(will)g(represen)o(t)j
(rewrite)f(rules)f(as)g(ordered)h(pairs)f(of)f(terms.)g(F)m(or)h
(example,)e(the)i(rules)h(for)e(a)h(Monoid)f(are)150
266 y(represen)o(ted)k(as:)221 371 y FE(val)c(r1)h(=)g(\(Op\(V)o(a)o(r)
g("x","+",Int)e(0\),V)o(a)o(r)h("x"\);)221 436 y(val)g(r2)h(=)g
(\(Op\(Int)g(0,"+",V)o(a)o(r)e("x"\),V)o(a)o(r)h("x"\);)221
501 y(val)g(r3)h(=)g(\(Op\(V)o(a)o(r)g("x","+",Op\(V)o(a)o(r)e
("y","+",V)o(a)o(r)g("z"\)\),)394 566 y(Op\(Op\(V)o(a)o(r)i("x","+",V)o
(a)o(r)e("y"\),)h("+",)g(V)o(a)o(r)h("z"\)\).)150 666
y FI(W)m(e)e(will)f(represen)o(t)k(substitutions)e(as)g(lists)g(of)f
(pairs)g(of)g(strings)h(and)g(terms.)f(F)m(or)g(example,)f(the)i
(substitution)150 741 y([\()p FF(a)c FI(+)g FF(b)p FI(\))p
FF(=x;)e(d=y)q(;)g(e=z)r FI(])12 b(is)i(represen)o(ted)j(as:)221
846 y FE(val)c(s1)h(=)g([\("x",Op\(V)o(a)o(r"a","+",V)o(a)o(r"b"\)\),)
392 911 y(\("y",V)o(a)o(r"d"\),)392 975 y(\("z",V)o(a)o(r"e"\)].)150
1076 y FI(Finally)m(,)j(b)q(ecause)22 b(matc)o(hing)17
b(can)j(succeed)i(or)e(fail,)d(w)o(e)j(will)f(use)h(an)g(instance)g(of)
f(the)h(follo)o(wing)d(simple)150 1151 y(datat)o(yp)q(e)d(for)g(the)g
(return)h(v)n(alue)e(of)h(matc)o(hing:)221 1256 y FE(datat)o(yp)q(e)26
b('a)14 b(option)g(=)g(Nothing)g Fy(j)g FE(Just)g(of)24
b('a.)150 1356 y FI(The)12 b FE(option)g FI(t)o(yp)q(e)f(constructor)i
(pro)o(vides)f(a)f(mec)o(hanism)e(whereb)o(y)k(one)e(can)h(write)g
(functions)f(that)g(can)h(either)150 1431 y(succeed)i(and)e(return)h(a)
f(v)n(alue)g(of)f(an)h(arbitrary)g(t)o(yp)q(e)24 b FE('a)p
FI(,)11 b(or)h(fail)f(to)h(return)h(suc)o(h)g(a)e(v)n(alue)h(and)g
(simply)e(return)150 1506 y(the)k(v)n(alue)g FE(Nothing)p
FI(.)150 1652 y FG(3.2.2)48 b(An)15 b(Implemen)o(tati)o(on)e(of)i(Matc)
o(hing)150 1768 y FI(W)m(e)e(fo)q(cus)h(on)g(the)g(function)f(that)h
(tries)g(to)g(matc)o(h)e(a)i(candidate)g(term)f(with)g(a)g(left-hand)g
(side)i(of)e(a)g(rule.)g(W)m(e)150 1843 y(assume)i(that)h(separate)g
(help)q(er)h(functions)e(tak)o(e)h(care)g(of)f(applying)f(this)i
(function)f(to)h(all)e(sub-terms)h(of)g(the)150 1917
y(candidate)f(term.)f(The)h(single-stage)g(implemen)o(tation)c(of)k
(this)g(matc)o(hing)e(function)h(is)h(as)g(follo)o(ws:)221
2022 y FE(fun)g(match1)f(pat)i(msigma)c(t)j(=)221 2087
y(case)g(msigma)d(of)259 2152 y(Nothing)k Fy(\))e FE(Nothing)221
2217 y Fy(j)26 b FE(Just)14 b(\(sigma\))e Fy(\))221 2281
y FE(\(case)i(pat)h(of)275 2346 y(V)o(a)o(r)e(u)i Fy(\))e
FE(\(case)i(\014nd)g(u)f(sigma)e(of)494 2411 y(Nothing)i
Fy(\))g FE(Just)f(\(\(u,t\))i(::)d(sigma\))455 2476 y
Fy(j)27 b FE(Just)13 b(w)i Fy(\))e FE(if)g(w)i(=)f(t)g(then)h(Just)f
(sigma)e(else)i(Nothing\))221 2540 y Fy(j)42 b FE(Int)14
b(n)g Fy(\))g FE(\(case)g(t)g(of)482 2605 y(Int)g(u)g
Fy(\))g FE(if)f(u=n)i(then)g(msigma)c(else)k(Nothing)428
2670 y Fy(j)p 485 2670 13 2 v 71 w(\))e FE(Nothing\))p
eop
%%Page: 37 48
37 47 bop 1882 0 a FB(37)221 195 y Fy(j)42 b FE(Op\(t11,s1,t12\))12
b Fy(\))h FE(\(case)i(t)f(of)656 260 y(Op)g(\(t21,s2,t22\))e
Fy(\))h FE(\(if)g(s2)h(=)g(s1)1048 325 y(then)i(\(match1)d(t11)1139
390 y(\(match1)g(t12)h(msigma)d(t22\))i(t21\))1048 454
y(else)i(Nothing\))617 519 y Fy(j)p 658 519 13 2 v 56
w(\))e FE(Nothing\)\).)150 620 y FI(The)19 b FE(match1)e
FI(function)h(tak)o(es)g(a)g(pattern)h FE(pat)p FI(,)f(a)g
(substitution)g FE(msigma)p FI(,)d(a)j(candidate)g(term)g
FE(t)p FI(,)f(and)h(tries)150 695 y(to)d(compute)f(a)h(substitution)g
(that)g(w)o(ould)f(instan)o(tiate)h(the)h(pattern)g(to)e(the)i(term.)e
(First,)h FE(match1)f FI(insp)q(ects)150 770 y FE(msigma)p
FI(.)h(If)i FE(msigma)e FI(is)j FE(Nothing)p FI(,)g(this)g(means)f
(that)g(a)h(failure)f(has)h(o)q(ccurred)h(in)f(a)f(previous)h(matc)o
(h,)e(and)150 845 y(w)o(e)g(simply)d(propagate)i(this)g(failure)g(b)o
(y)g(returning)h FE(Nothing)p FI(.)f(Otherwise,)h(a)f(case)i(analysis)d
(on)h(the)h(pattern)150 919 y FE(pat)k FI(is)g(p)q(erformed.)e(If)i
(the)g(pattern)h(is)e(a)g(v)n(ariable,)g(the)h(substitution)g(is)f
(extended)j(appropriately)d(after)150 994 y(c)o(hec)o(king)e(for)f
(consistency)i(with)e(the)h(new)g(binding.)f(W)m(e)g(c)o(hec)o(k)h
(consistency)h(b)o(y)f(lo)q(oking)d(up)j(the)g(name)f
FE(u)150 1069 y FI(in)e(the)i(en)o(vironmen)o(t)e FE(sigma)p
FI(.)e(Then,)j(if)f(there)i(is)f(no)g(binding)f(for)g(that)h(name,)e
(then)j(w)o(e)f(simply)d(extend)k(the)150 1143 y(en)o(vironmen)o(t.)c
(If)h(there)i(is)e(already)h(a)f(binding)f(for)h(that)h(name,)e(and)h
(it)g(is)h(the)g(same)e(as)i(the)g(one)g(w)o(e)g(wish)f(to)150
1218 y(add,)i(then)g(there)i(is)e(no)g(need)h(to)f(p)q(erform)g(the)h
(extension.)f(If)g(there)h(is)f(already)g(a)g(binding)f(for)h(that)h
(name,)150 1293 y(but)e(it)g(is)f(di\013eren)o(t)i(from)d(the)j(one)f
(w)o(e)g(wish)g(to)g(add,)f(then)h(w)o(e)g(fail.)150
1376 y(If)e(the)g(pattern)h(is)f(an)g(in)o(teger,)g(then)g(the)h(term)e
(m)o(ust)g(also)h(b)q(e)g(an)g(in)o(teger)h(with)e(the)i(same)e(v)n
(alue.)g(In)h(this)g(case)150 1451 y(the)j(original)e(substitution)i
(is)f(returned.)i(If)e(the)h(pattern)h(is)e(an)g(op)q(erator,)h(w)o(e)g
(c)o(hec)o(k)g(that)g(the)g(term)f(is)h(also)150 1525
y(an)g(op)q(erator)h(with)g(the)g(same)e(op)q(eration,)h(and)h(then)g
(the)g(righ)o(t-)f(and)g(left-hand)g(sides)i(of)e(the)h(pattern)g(and)
150 1600 y(the)g(term)f(are)g(recursiv)o(ely)h(matc)o(hed,)f(p)q
(ossibly)g(extending)g(the)h(substitution.)f(In)g(all)f(other)i(cases,)
g FE(match1)150 1675 y FI(returns)f FE(Nothing)g FI(to)f(indicate)g
(that)f(it)h(has)g(failed.)150 1758 y(The)g FE(match1)g
FI(function)f(has)h(t)o(yp)q(e:)434 1874 y FE(term)d
Fy(!)g FI(\()p FE(string)f Fy(\003)f FE(term)p FI(\))e
FE(list)g(option)k Fy(!)g FE(term)g Fy(!)g FI(\()p FE(string)g
Fy(\003)e FE(term)p FI(\))e FE(list)g(option)150 1990
y FI(The)18 b(t)o(w)o(o)g(o)q(ccurrences)j(of)c FE(option)h
FI(in)f(the)i(t)o(yp)q(e)f(can)g(b)q(e)h(explained)e(as)h(follo)o(ws:)e
(First,)i FE(match1)f FI(returns)i(a)150 2065 y(substitution)13
b FE(option)p FI(,)g(b)q(ecause)i(it)d(can)i(fail)d(to)i(matc)o(h)f
(the)h(pattern)h(to)f(the)h(term.)e(Suc)o(h)h(failure)f(o)q(ccurs)j(in)
d(all)150 2140 y(places)k(where)h FE(match1)e FI(returns)i
FE(Nothing)p FI(.)f(Second,)g(the)g(result)g(of)f(one)h(call)e(to)i
FE(match1)f FI(gets)h(fed-bac)o(k)g(in)o(to)150 2214
y(another)c(call)f(to)h FE(match1)p FI(,)f(hence)i(the)f(incoming)e
(and)h(outgoing)g(substitutions)h(m)o(ust)f(ha)o(v)o(e)h(exactly)f(the)
i(same)150 2289 y(t)o(yp)q(e.)h(This)g FH(thr)n(e)n(ading)g
FI(of)f(the)h(substitution)g(happ)q(ens)h(in)f(the)g(case)h(of)e(an)h
FE(Op)g FI(pattern:)221 2395 y FE(...)221 2460 y(\(match1)f(t11)221
2525 y(\(match1)g(t12)g(msigma)f(t22\))h(t21\))221 2590
y(...)f(.)p eop
%%Page: 38 49
38 48 bop 1882 0 a FB(38)150 192 y FI(But)16 b(matc)o(hing)d(the)j
(righ)o(t)f(op)q(erand)h FE(t22)f FI(can)g(also)g(fail,)e(in)i(whic)o
(h)g(case)h(the)g(whole)f(matc)o(h)f(should)h(fail.)f(So,)150
266 y(if)j FE(match1)h FI(is)g(passed)i(an)e(in)o(v)n(alid)e
(substitution)i FE(Nothing)p FI(,)h(then)g(the)g(outer)g
FE(case)p FI(-statemen)o(t)f(immediately)150 341 y(returns)d
FE(Nothing)p FI(,)g(th)o(us)f(correctly)h(propagating)e(the)h(failure)f
(of)h(matc)o(hing)e FE(t22)p FI(.)150 488 y FG(3.2.3)48
b(Help)q(er)15 b(F)l(unctions)150 603 y FI(T)m(o)e(use)i
FE(match1)p FI(,)e(w)o(e)h(need)h(some)e(help)q(er)i(functions:)221
708 y FE(fun)f(\014nd)h(v)f([])g(=)g(Nothing)255 772
y Fy(j)23 b FE(\014nd)15 b(v)f(\(\(n,t\)::bs\))g(=)g(if)f(v=n)i(then)g
(Just)f(t)g(else)g(\014nd)h(v)f(bs.)150 872 y FI(This)e(function)h(tak)
o(es)g(a)f(v)n(ariable)f(name)g(and)i(a)f(substitution)h(and)f(returns)
i(the)f(term)f(corresp)q(onding)i(to)e(this)150 947 y(name,)h(if)i(an)o
(y)m(.)e(Again,)h(w)o(e)h(use)h(the)g FE(option)f FI(t)o(yp)q(e)h(for)e
(dealing)h(with)f(failure.)g(Applying)g(the)i(substitution)f(is)150
1022 y(p)q(erformed)f(b)o(y)f(the)i(follo)o(wing)c(function:)221
1127 y FE(fun)j(subst1)g(sigma)f(pat)h(=)221 1192 y(case)g(pat)g(of)259
1256 y(V)o(a)o(r)f(v)h Fy(\))g FE(\(case)g(\014nd)h(v)f(sigma)f(of)g
(Just)h(w)g Fy(\))f FE(w\))221 1321 y Fy(j)26 b FE(Int)14
b(i)g Fy(\))f FE(Int)h(i)221 1386 y Fy(j)26 b FE(Op\(t1,s,t2\))13
b Fy(\))g FE(Op)h(\(subst1)g(sigma)f(t1,)g(s,)g(subst1)h(sigma)f(t2\).)
150 1486 y FI(This)19 b(function)g(tak)o(es)h(a)f(substitution)h(and)f
(a)g(pattern,)h(and)f(applies)g(the)h(substitution)f(to)h(the)g
(pattern.)150 1561 y(The)13 b(function)g(w)o(orks)g(b)o(y)f(recursiv)o
(ely)i(tra)o(v)o(ersing)f(the)h(pattern)f(and)g(replacing)f(an)o(y)h(v)
n(ariables)f(b)o(y)h(the)g(corre-)150 1635 y(sp)q(onding)e(binding)g
(in)g(the)h(substitution)f FE(msigma)p FI(.)d(Applying)j(a)g(rewrite)h
(rule)g(is)f(p)q(erformed)g(b)o(y)h(the)g(follo)o(wing)150
1710 y(function:)221 1815 y FE(fun)i(rewrite1)h(\(lhs,rhs\))g(t)e(=)221
1880 y(case)h(match1)g(lhs)g(\(Just)g([]\))g(t)f(of)259
1944 y(Nothing)i Fy(\))e FE(t)221 2009 y Fy(j)26 b FE(Just)14
b(\(sigma\))e Fy(\))i FE(subst1)g(sigma)e(rhs.)150 2109
y FI(This)h(function)g(tak)o(es)h(a)f(rule)g(and)g(a)g(term,)f(and)h
(uses)i FE(match1)d FI(to)h(try)h(to)f(compute)g(a)f(unifying)g
(substitution.)150 2184 y(If)k(matc)o(hing)e(is)h(successful,)j(it)d
(applies)h(the)g(substitution)g(using)g FE(subst1)p FI(.)g(Otherwise,)h
(it)f(returns)h(the)g(term)150 2259 y(unc)o(hanged.)150
2405 y FG(3.2.4)48 b(What)15 b(to)h(Exp)q(ect)g(from)f(Staging)150
2521 y FI(Often,)h(w)o(e)f(can)h(appraise)g(the)g(success)i(of)d
(staging)g(qualitativ)o(ely)m(,)e(without)i(need)h(for)f(quan)o
(titativ)o(e)g(b)q(enc)o(h-)150 2595 y(marking.)j(Suc)o(h)j(an)f
(appraisal)g(can)h(b)q(e)g(ac)o(hiev)o(ed)g(b)o(y)f(insp)q(ecting)h(an)
f(in)o(termediate)g(result)h(of)f(a)g(staged)150 2670
y(computation,)10 b(comparing)h(it)i(to)f(what)h(can)g(b)q(e)g(ac)o
(hiev)o(ed)g(b)o(y)f(hand-programming)d(a)j(sp)q(ecialized)i(v)o
(ersion)f(of)p eop
%%Page: 39 50
39 49 bop 1882 0 a FB(39)150 192 y FI(the)16 b(desired)h(program,)c
(based)j(on)g(the)g(con)o(textual)f(information)e(that)i(is)h(a)o(v)n
(ailable.)c(F)m(or)j(example,)f(a)h(go)q(o)q(d)150 266
y(hand-crafted)f(v)o(ersion)g(of)g FE(rewrite1)h FI(sp)q(ecialized)f
(for)g(the)h(rule)f FF(r)1179 272 y FA(1)1209 266 y FI(:)22
b FF(x)9 b FI(+)h(0)h Fy(!)g FF(x)i FI(is)h(as)g(follo)o(ws:)221
370 y FE(fun)g(rewriteR1)h(term)e(=)221 435 y(case)h(term)g(of)259
500 y(Op)g(\(t1,s,t2\))e Fy(\))i FE(if)f(s)h(=)g("+")g(then)h(\(case)g
(t2)e(of)g(Int)h(n)h Fy(\))e FE(if)g(n=0)i(then)g(t1)e(else)i(term)1013
564 y Fy(j)p 1040 564 13 2 v 42 w(\))e FE(term\))737
629 y(else)h(term)221 694 y Fy(j)p 261 694 V 55 w(\))f
FE(term.)150 793 y FI(This)k(function)g(tak)o(es)h(a)f(term,)g(c)o(hec)
o(ks)h(if)f(it)g(is)g(a)g(binary)g(op)q(eration,)g(the)h(op)q(eration)f
(is)g(an)h(addition,)d(the)150 868 y(second)g(argumen)o(t)f(is)g(an)g
(in)o(teger,)g(and)g(the)h(in)o(teger)g(is)f(0,)f(then)i(returns)h(the)
f(\014rst)g(argumen)o(t.)e(If)h(an)o(y)g(of)f(the)150
943 y(c)o(hec)o(ks)j(fails,)d(it)i(returns)h(the)f(term)f(unc)o
(hanged.)h(This)g(function)f(do)q(es)i(not)e(pa)o(y)h(the)g(in)o
(terpretiv)o(e)h(o)o(v)o(erhead)150 1017 y(of)f(tra)o(v)o(ersing)g(the)
h(pattern,)f(and)h(the)f(e\013ect)i(of)e(the)h(substitution)f(op)q
(eration)g(has)h(also)e(b)q(een)j(computed)d(in)150 1092
y(adv)n(ance.)150 1175 y(In)f(the)h(rest)h(of)e(this)g(c)o(hapter,)h(w)
o(e)f(will)f(study)i(ho)o(w)f(far)g(MetaML)h(can)f(tak)o(e)h(us)g(to)o
(w)o(ards)f(turning)g(our)g(single-)150 1250 y(stage)h(program)f(in)o
(to)g(a)g(generator)i(that)f(pro)q(duces)h(suc)o(h)g(highly)e(sp)q
(ecialized)h(co)q(de.)150 1407 y FD(3.3)56 b(A)19 b(First)f(A)n(ttempt)
f(at)i(Staging)949 1494 y FC(Defer)13 b(no)g(time,)g(delays)f(have)g
(danger)n(ous)f(ends;)1433 1587 y(R)n(eignier)p FB(,)g(Act)h(3,)h
(Scene)h(2,)1368 1646 y FC(King)f(Henry)g(VI)p FB(,)e(Shak)o(esp)q
(eare)150 1734 y FI(In)g(this)g(section)h(w)o(e)f(analyze)g(the)h(t)o
(yp)q(e)g(of)e(the)i FE(match1)f FI(function)f(and)h(dev)o(elop)h(a)e
(target)i(t)o(yp)q(e)g(for)e(a)h(t)o(w)o(o-stage)150
1809 y(matc)o(hing)g(function)h(based)h(on)f FE(match1)p
FI(.)f(W)m(e)h(then)h(presen)o(t)h(the)f(t)o(w)o(o-stage)g(matc)o(hing)
d(function.)i(Finally)m(,)e(w)o(e)150 1883 y(insp)q(ect)15
b(the)g(generated)g(co)q(de)f(and)g(con)o(trast)h(it)e(to)h(the)h(goal)
d(that)i(w)o(e)g(ha)o(v)o(e)g(set)h(in)e(Section)h(3.2.4.)150
2029 y FG(3.3.1)48 b(Designing)12 b(the)j(Multi-Stage)e(T)o(yp)q(e)150
2143 y FI(W)m(e)19 b(ha)o(v)o(e)f(already)h(decided)h(that)f(w)o(e)g
(will)e(consider)j(the)f(candidate)h(term)e(to)h(b)q(e)g(a)o(v)n
(ailable)e(only)h(in)g(the)150 2218 y(second)c(stage.)e(This)h(c)o
(hoice)g(means)f(that)h(a)f(\014rst)i(appro)o(ximation)9
b(of)j(our)h(target)g(for)g(the)g(t)o(yp)q(e)g(of)f(the)h(staged)150
2293 y(function)h(is:)412 2407 y FE(term)d Fy(!)g FI(\()p
FE(string)f Fy(\003)f FE(term)p FI(\))e FE(list)g(option)k
Fy(!)g(h)q FE(term)p Fy(i)g(!)g FI(\()p FE(string)f Fy(\003)f
FE(term)p FI(\))e FE(list)g(option)p FF(:)150 2521 y
FI(But)k(based)h(on)e(our)h(kno)o(wledge)f(of)g(the)i(algorithm,)7
b(w)o(e)k(kno)o(w)f(that)h(the)g(substitution)g(returned)h(b)o(y)f(the)
g(matc)o(h)150 2595 y(function)17 b(m)o(ust)e(con)o(tain)i(sub-terms)g
(of)f(the)i(term)e(b)q(eing)h(matc)o(hed.)f(Th)o(us,)g(the)i(resulting)
f(substitution)g(is)150 2670 y(going)12 b(to)g(b)q(e)i(a)f
FH(p)n(artial)r(ly-static)f(datatyp)n(e)p FI(.)h(In)g(particular,)f
(what)h(w)o(e)g(will)e(get)j(bac)o(k)e(is)h(a)g(sk)o(eleton)g(of)g(a)f
(list)h(of)p eop
%%Page: 40 51
40 50 bop 1882 0 a FB(40)150 192 y FI(pairs,)12 b(where)i(the)f
(\014rst)g(elemen)o(t)f(in)g(the)h(pair)f(is)g(a)g(string,)g(but)h(the)
g(second)h(elemen)o(t)e(will)f(not)h(y)o(et)h(b)q(e)g(kno)o(wn.)150
266 y(Th)o(us,)h(a)f(second)i(appro)o(ximation)c(of)i(the)i(desired)g
(t)o(yp)q(e)f(is:)396 367 y FE(term)d Fy(!)g FI(\()p
FE(string)f Fy(\003)f FE(term)p FI(\))e FE(list)g(option)k
Fy(!)g(h)p FE(term)p Fy(i)h(!)f FI(\()p FE(string)f Fy(\003)f(h)p
FE(term)p Fy(i)p FI(\))e FE(list)g(option)p FF(:)150
477 y FI(Going)13 b(bac)o(k)h(to)f(the)i(algorithm,)c(recall)j(that)g
(w)o(e)g FH(thr)n(e)n(ad)g FI(the)g(substitution)g(through)h(t)o(w)o(o)
e(recursiv)o(e)j(calls)d(to)150 551 y(the)18 b(matc)o(h)e(function)h
(in)g(the)h(case)g(of)e(matc)o(hing)g(binary)h(op)q(erations.)g(This)g
(threading)g(means)g(that,)f(in)h(a)150 626 y(staged)e(implemen)o
(tation)c(of)k FE(match1)p FI(,)e(the)j(result)f(of)g(the)g(term)f
FE(match1)g(t12)h(msigma)d(t22)i FI(will)f(also)i(ha)o(v)o(e)f(to)150
701 y(ha)o(v)o(e)g(t)o(yp)q(e)h FE(\(string)g(*)g Fy(h)p
FE(term)p Fy(i)p FE(\))7 b(list)f(option)p FI(.)15 b(The)g(c)o(hange)g
(in)f(the)h(t)o(yp)q(e)g(of)f(this)h(term)f(forces)h(us)g(to)f(c)o
(hange)h(the)150 775 y(t)o(yp)q(e)f(of)g(the)g(substitution)g
FH(p)n(asse)n(d)h FI(to)e(the)i(staged)f(matc)o(h)f(function:)380
876 y FE(term)e Fy(!)g FI(\()p FE(string)f Fy(\003)f(h)p
FE(term)p Fy(i)p FI(\))e FE(list)g(option)k Fy(!)g(h)q
FE(term)p Fy(i)g(!)g FI(\()p FE(string)f Fy(\003)f(h)p
FE(term)p Fy(i)p FI(\))e FE(list)g(option)p FF(:)150
1022 y FG(The)18 b(\\If)5 b(")19 b(Problem)i FI(The)c(t)o(yp)q(e)g(ab)q
(o)o(v)o(e)f(lo)q(oks)g(promising.)e(Unfortunately)m(,)i(there)h(is)g
(a)f(subtlet)o(y)h(in)f(our)150 1097 y(matc)o(hing)11
b(algorithm)g(that)i(forces)i(us)e(to)h(re\015ect)h(more)d(dela)o(ys)h
(in)g(the)h(staged)g(t)o(yp)q(e.)f(W)m(e)g(sa)o(y)g(unfortunately)150
1171 y(b)q(ecause)19 b(ha)o(ving)e(more)g(dela)o(ys)g(in)h(the)g(t)o
(yp)q(e)g(usually)f(suggests)i(that)f(w)o(e)g(will)e(not)h(b)q(e)i
(able)e(to)h(stage)g(this)150 1246 y(function)e(as)g(e\013ectiv)o(ely)h
(as)f(w)o(e)g(w)o(ould)f(lik)o(e.)g(The)i(problem)e(with)g(our)h
(algorithm)e(is)i(that)g(the)g FE(option)h FI(part)150
1321 y(of)g(the)g(return)i(v)n(alue)d(dep)q(ends)j(on)e(testing)h(the)g
(equalit)o(y)e(of)h(terms)g(in)f(the)i(substitutions.)f(In)h
(particular,)150 1396 y(testing)e(the)g(consistency)h(of)e(a)g(new)h
(binding)e(with)i(the)g(existing)f(substitution)h(is)f(p)q(erformed)g
(b)o(y)g(equating)150 1470 y(terms.)e(This)h(test)h(is)f(carried)g(out)
g(in)f(the)i(statemen)o(t:)221 1561 y FE(...)221 1626
y(if)e(w)h(=)g(t)g(then)h(Just)f(sigma)e(else)j(Nothing)221
1691 y(...)d(.)150 1780 y FI(When)k(the)h(condition)f(of)f(an)h
FE(if)p FI(-statemen)o(t)g(is)g(dela)o(y)o(ed,)f(the)i(result)g(of)e
(the)i(whole)f FE(if)p FI(-statemen)o(t)f(m)o(ust)h(also)150
1855 y(b)q(e)h(considered)h(as)f(dela)o(y)o(ed.)f(The)h(reason)h(is)e
(that)h(w)o(e)g(will)e(not)i(kno)o(w)f(whic)o(h)h(branc)o(h)g(to)f
(pursue)i(un)o(til)e(all)150 1929 y(the)g(information)d(for)i(the)h
(condition)f(b)q(ecomes)h(a)o(v)n(ailable.)d(Th)o(us,)i(the)i(return)f
(t)o(yp)q(e)h(for)e(the)h(staged)g(matc)o(h)150 2004
y(function)e(will)e(ha)o(v)o(e)i(to)f(b)q(e)i Fy(h)p
613 2004 13 2 v 29 w FE(option)p Fy(i)p FI(.)f(W)m(e)f(are)h(left)g
(with)g(the)g(follo)o(wing)d(target)k(t)o(yp)q(e:)385
2105 y FE(term)c Fy(!)h(h)p FI(\()p FE(string)e Fy(\003)f
FE(term)p FI(\))e FE(list)g(option)p Fy(i)k(!)g(h)p FE(term)p
Fy(i)h(!)f(h)p FI(\()p FE(string)f Fy(\003)f FE(term)p
FI(\))e FE(list)g(option)p Fy(i)150 2206 y FI(This)j(t)o(yp)q(e)h
(indicates)f(that)h(only)e(the)i(pattern)g(is)f(insp)q(ected)i(in)e
(the)h(\014rst)g(stage)f(and)g(the)h(result)g(is)f(a)g(sp)q(ecialized)
150 2281 y(function)j(that)g(can)g(b)q(e)h(Run)f(in)g(the)g(second)i
(stage.)e(In)g(the)h(follo)o(wing)c(subsection,)k(w)o(e)f(will)f(see)j
(ho)o(w)d(w)o(ell)h(w)o(e)150 2356 y(can)h(tak)o(e)g(adv)n(an)o(tage)f
(of)g(this)h(information)d(in)j(a)f(m)o(ulti-stage)f(program.)150
2491 y FG(3.3.2)48 b(A)16 b(Tw)o(o-Stage)f(Implemen)o(tati)o(on)150
2595 y FI(F)m(ollo)o(wing)8 b(a)j(similar)d(pro)q(cess)13
b(to)e(that)g(describ)q(ed)h(for)f(staging)f(the)i(list)e(mem)o(b)q
(ership)f(function)i(\(Section)g(2.4\),)150 2670 y(w)o(e)j(arriv)o(e)g
(at)g(the)g(follo)o(wing)d(t)o(w)o(o-stage)j(v)o(ersion)g(of)f
FE(match1)p FI(:)p eop
%%Page: 41 52
41 51 bop 1882 0 a FB(41)221 195 y FE(fun)14 b(match2)f(pat)i(msigma)c
(t)j(=)221 260 y Fy(h)p FE(case)h(~)q(msigma)d(of)275
325 y(Nothing)j Fy(\))e FE(Nothing)221 390 y Fy(j)42
b FE(Just)14 b(\(sigma\))f Fy(\))222 454 y FE(~)q(\(case)h(pat)h(of)298
519 y(V)o(a)o(r)f(u)g Fy(\))f(h)p FE(case)i(\014nd)g(u)f(sigma)e(of)517
584 y(Nothing)i Fy(\))g FE(Just)f(\(\(u,)q(~)r(t\))h(::)f(sigma\))478
649 y Fy(j)27 b FE(Just)13 b(w)i Fy(\))e FE(if)g(w)i(=)g(~)q(t)f(then)h
(Just)f(sigma)e(else)j(Nothing)p Fy(i)221 713 y(j)65
b FE(Int)14 b(n)g Fy(\))g(h)p FE(case)h(~)q(t)f(of)505
778 y(Int)g(u)g Fy(\))g FE(if)f(u=)q(~)r(\(lift)e(n\))j(then)j(~)q
(msigma)11 b(else)k(Nothing)467 843 y Fy(j)p 508 843
13 2 v 55 w(\))e FE(Nothing)p Fy(i)221 908 y(j)65 b FE
(Op\(t11,s1,t12\))12 b Fy(\))h(h)q FE(case)i(~)q(t)f(of)679
972 y(Op)g(\(t21,s2,t22\))e Fy(\))h FE(\(if)h(s2)f(=)h(s1)1035
1037 y(then)i(~)q(\(match2)e(t11)1148 1102 y(\(match2)g(t12)f(msigma)f
Fy(h)p FE(t22)p Fy(i)o FE(\))i Fy(h)p FE(t21)p Fy(i)p
FE(\))1035 1167 y(else)h(Nothing\))298 1231 y Fy(j)p
326 1231 V 42 w(\))f FE(Nothing)p Fy(i)q FE(\))p Fy(i)p
FE(.)150 1328 y FI(Note)i(that)g(if)f(w)o(e)h(erase)h(the)f
(annotations)f(from)f(the)j(source)g(for)e FE(match2)p
FI(,)g(w)o(e)h(get)g(the)g(source)h(for)f FE(match1)p
FI(.)150 1403 y(W)m(e)d(will)g(also)g(need)i(to)f(stage)g(the)h(help)q
(er)f(function)g FE(rewrite1)p FI(:)221 1504 y FE(fun)g(rewrite2)h
(\(lhs,rhs\))g(t)e(=)221 1569 y Fy(h)p FE(case)i(~)q(\(match2)f(lhs)g
Fy(h)p FE(Just)g([])p Fy(i)g FE(t\))g(of)275 1634 y(Nothing)h
Fy(\))f FE(~)q(t)221 1698 y Fy(j)42 b FE(Just)14 b(\(sigma\))f
Fy(\))g FE(subst1)h(sigma)f(rhs)p Fy(i)p FE(.)150 1795
y FI(W)m(e)g(are)i(no)o(w)e(ready)i(to)e(insp)q(ect)i(the)g(co)q(de)g
(generated)g(b)o(y)e(this)h(function)g(and)g(to)f(appraise)h(its)g
(qualit)o(y)m(.)150 1939 y FG(3.3.3)48 b(Using)14 b(the)h(Tw)o(o-Stage)
g(Implemen)o(tati)o(on)150 2051 y FI(W)m(e)e(can)i(use)f(the)h
FE(rewrite2)g FI(function)f(to)f(generate)i(co)q(de)g(sp)q(ecialized)g
(for)e FF(r)1358 2057 y FA(1)1388 2051 y FI(:)23 b FF(x)9
b FI(+)g(0)j Fy(!)f FF(x)i FI(as)h(follo)o(ws:)221 2152
y FE(-)p Fy(j)f FE(rewrite2)i(r1;)221 2217 y(val)e(it)h(=)g(fn)g(:)g
Fy(h)p FE(term)p Fy(i)f(!)h(h)p FE(term)p Fy(i)221 2346
y FE(-)p Fy(j)f(h)p FE(fn)h(x)g Fy(\))g FE(~)q(\(it)g
Fy(h)p FE(x)p Fy(i)q FE(\))p Fy(i)p FE(;)221 2411 y(val)f(it)h(=)221
2476 y Fy(h)p FE(fn)g(a)f Fy(\))221 2540 y FE(\(case)h(\(case)h(a)f(of)
378 2605 y(Op\(e,d,c\))g Fy(\))g FE(if)f(d)h Fu(\045)p
FE(=)g Fu(\045)p FE(s1'1230)649 2670 y(then)h(\(case)g(\(case)g(c)f(of)
p eop
%%Page: 42 53
42 52 bop 1882 0 a FB(42)897 195 y FE(Int)13 b(h)i Fy(\))e
FE(if)g(h)i Fu(\045)p FE(=)f(0)f(then)i(Just)f(\([]\))g(else)h(Nothing)
858 260 y Fy(j)p 899 260 13 2 v 55 w(\))f FE(Nothing\))g(of)794
325 y(Nothing)g Fy(\))g FE(Nothing)755 390 y Fy(j)27
b FE(Just)14 b(f)f Fy(\))h FE(\(case)g Fu(\045)p FE(\014nd)h
Fu(\045)p FE(u'1237)e(f)g(of)1016 454 y(Nothing)i Fy(\))e
FE(Just)h(\(::\(\()p Fu(\045)o FE(u'1237,e\),f)s(\)\))978
519 y Fy(j)26 b FE(Just)14 b(g)f Fy(\))h FE(if)f(g)h
Fu(\045)p FE(=)g(e)g(then)h(Just)f(f)f(else)i(Nothing\)\))649
584 y(else)g(Nothing)339 649 y Fy(j)p 380 649 V 56 w(\))e
FE(Nothing\))i(of)275 713 y(Nothing)g Fy(\))e FE(a)237
778 y Fy(j)26 b FE(Just)14 b(b)g Fy(\))g Fu(\045)o FE(subst1)h(b)f
Fu(\045)p FE(rhs\))p Fy(i)221 843 y FE(:)f Fy(h)p FE(term)h
Fy(!)f FE(term)p Fy(i)p FE(.)150 937 y FI(The)j(tra)o(v)o(ersal)h(of)e
(the)i(pattern)f(has)g(b)q(een)i(p)q(erformed.)d(But)h(compared)g(to)g
(the)g(target)h(co)q(de)f(w)o(e)h(wrote)f(b)o(y)150 1012
y(hand,)j(there)i(are)f(still)e(to)q(o)h(man)o(y)f(nested)j
FE(case)p FI(-statemen)o(ts,)f(and)f(the)h(call)f(to)g
FE(subst1)h FI(and)g(the)g(test)g(for)150 1087 y(consistency)15
b(with)f(the)g(substitution)h(w)o(ere)f(not)g(p)q(erformed.)150
1170 y(Closer)g(insp)q(ection)g(of)e(the)i(generated)h(co)q(de)f(sho)o
(ws)g(that)g(it)f(ough)o(t)g(b)q(e)h(p)q(ossible)f(to)g(reduce)j(the)e
(nested)g FE(case)p FI(-)150 1245 y(statemen)o(ts)19
b(b)o(y)g(some)f(meaning-preserving)g(transformations.)g(If)g(the)i
(outer)g FE(case)p FI(-statemen)o(ts)f(could)g(b)q(e)150
1319 y(\\pushed")e(through)f(the)h(inner)f(ones,)h(then)g(w)o(e)f(w)o
(ould)g(b)q(e)h(able)f(to)g(simplify)d(all)i(the)i(v)n(alues)f(at)g
(the)h(lea)o(v)o(es)150 1394 y(of)e(the)i(inner)f FE(if)p
FI(-statemen)o(ts.)f(In)h(particular,)f(at)h(ev)o(ery)h(p)q(oin)o(t)e
(where)i(w)o(e)f(return)h FE(Nothing)g FI(w)o(e)f(ough)o(t)g(to)f(b)q
(e)150 1469 y(able)d(to)h(simply)d(return)k FE(a)p FI(,)e(and)h(ev)o
(ery)g(p)q(oin)o(t)f(where)i(w)o(e)f(return)h FE(Just)e
FF(\033)q FI(,)h(w)o(e)g(ough)o(t)f(to)g(b)q(e)i(able)e(to)h(return)g
(the)150 1544 y(result)i(of)e(applying)f(the)j(substitution)f
FE(subst)h FF(\033)g FE(rhs)p FI(.)150 1695 y FD(3.4)56
b(A)19 b(Second)f(A)n(ttempt)150 1822 y FI(It)h(is)g(not)g(un)o(usual)f
(that)h(the)h(\014rst)f(attempt)f(at)h(staging)f(do)q(es)i(not)f(yield)
f(the)i(b)q(est)g(results.)f(Ev)o(en)g(when)150 1896
y(staging)13 b(is)h(automated,)f(as)h(is)g(the)g(case)h(with)f(BT)m(A,)
f(it)h(is)g(common)d(for)j(users)h(of)f(o\017ine)f(partial)g(ev)n
(aluators)150 1971 y(to)f(restructure)j(their)e(programs)e(to)h(help)g
(BT)m(A)h(yield)e(b)q(etter)j(results)g([39].)c(Just)j(b)q(ecause)h(w)o
(e)f(place)f(binding-)150 2046 y(time)e(annotations)g(man)o(ually)e(do)
q(es)k(not)f(exempt)g(us)g(from)f(this)h(requiremen)o(t.)f(But)i(b)q
(ecause)h(MetaML)e(allo)o(ws)150 2120 y(us)16 b(to)f(\\touc)o(h,)f
(see,)i(and)f(exp)q(erimen)o(t")g(with)g(b)q(oth)g(the)h(explicit)e
(annotations)h(and)g(the)g(co)q(de)h(pro)q(duced,)g(it)150
2195 y(helps)10 b(us)g(b)q(etter)h(understand)g(the)f(problem)f(of)g
(staging)f(a)i(particular)f(algorithm.)e(W)m(e)i(b)q(eliev)o(e)h(that)f
(a)h(strength)150 2270 y(of)j(MetaML)i(is)e(the)i(men)o(tal)d(mo)q(del)
g(it)i(pro)o(vides)g(for)f(reasoning)h(ab)q(out)g(m)o(ulti-stage)e
(computation.)150 2411 y FG(3.4.1)48 b(An)15 b(Implemen)o(tati)o(on)e
(of)i(Matc)o(hing)f(in)h(Con)o(tin)o(uati)o(on)o(-P)o(ass)o(in)o(g)e
(St)o(yle)150 2521 y FI(One)e(p)q(ossible)f(approac)o(h)g(to)g(impro)o
(ving)d(the)k(generated)g(co)q(de)g(is)f(to)g(rewrite)h
FE(match1)e FI(in)h FH(c)n(ontinuation-p)n(assing)150
2595 y(style)15 b FI(\(CPS\).)h(This)f(tec)o(hnique)h(has)g(b)q(een)g
(found)f(to)h(b)q(e)g(quite)f(useful)h(in)f(partial)f(ev)n(aluation)g
(systems)i([15].)150 2670 y(In)o(tuitiv)o(ely)m(,)h(a)i
FH(c)n(ontinuation)h FI(is)f(a)g(function)f(that)h(sp)q(eci\014es)i(ho)
o(w)e(the)h(computation)d(will)h(\\con)o(tin)o(ue".)g(A)p
eop
%%Page: 43 54
43 53 bop 1882 0 a FB(43)150 192 y FI(function)12 b(written)h(in)e(CPS)
i(alw)o(a)o(ys)e(tak)o(es)h(a)g(con)o(tin)o(uation)f
FE(k)i FI(as)f(an)g(argumen)o(t,)f(and)h(applies)g FE(k)g
FI(to)g(the)h(results)150 266 y(it)j(w)o(ould)g(normally)f(just)i
(return.)g(When)g(a)g(CPS)g(function)f(calls)h(another)g(CPS)g
(function,)f(it)h(passes)h FE(k)f FI(as)150 341 y(the)h(new)f(con)o
(tin)o(uation)f(to)h(the)g(second)h(function.)e(F)m(urthermore,)h
(whenev)o(er)h(there)g(is)f(an)o(y)g(sequencing)h(of)150
416 y(function)12 b(calls)f(in)o(v)o(olv)o(ed,)f(a)i(function)g(in)f
(CPS)h(m)o(ust)f(explicitly)g(pass)i(around)f(and)f(extend)i(the)g(con)
o(tin)o(uation)150 490 y FE(k)h FI(as)g(necessary)m(.)150
573 y(This)d(subtle)i(c)o(hange)e(to)h(the)g(form)e(of)h(the)h
(algorithm)d(giv)o(es)i(us)h(an)f(extra)h(degree)h(of)e(freedom)g(that)
h(pro)o(vides)f(a)150 648 y(new)j(opp)q(ortunit)o(y)f(for)g(a)g(b)q
(etter)i(design)e(for)g(our)h(m)o(ulti-stage)d(t)o(yp)q(e,)j(and)f(in)g
(turn,)g(for)g(a)g(b)q(etter)i(m)o(ulti-stage)150 723
y(program.)150 806 y(The)g(CPS)f(matc)o(hing)e(function)i(tak)o(es)h(a)
f(con)o(tin)o(uation)f FE(k)h FI(of)g(t)o(yp)q(e)h FE(\(string)f(*)g
(term\))g(list)g(option)g Fy(!)25 b FE('a)p FI(.)13 b(Infor-)150
881 y(mally)m(,)d(w)o(e)k(can)g(read)h(this)f(t)o(yp)q(e)g(as)g(sa)o
(ying)f(that)h(the)h(con)o(tin)o(uation)d(is)i(some)f(\\consumer)h(of)f
(substitutions".)150 955 y(The)h(CPS)g(matc)o(hing)e(function)i(is)g
(de\014ned)h(as)f(follo)o(ws:)221 1062 y FE(fun)g(matchK1)f(pat)h(k)h
(msigma)c(t)j(=)221 1126 y(case)g(\(msigma\))e(of)259
1191 y(Nothing)j Fy(\))e FE(k)h(Nothing)221 1256 y Fy(j)26
b FE(Just)14 b(\(sigma\))e Fy(\))221 1321 y FE(\(case)i(pat)h(of)275
1385 y(V)o(a)o(r)e(u)i Fy(\))e FE(\(case)i(\014nd)g(u)f(sigma)e(of)494
1450 y(Nothing)i Fy(\))g FE(k)g(\(Just)g(\(\(u,t\))g(::)f(sigma\)\))455
1515 y Fy(j)27 b FE(Just)13 b(w)i Fy(\))e FE(if)g(w)i(=)f(t)g(then)h(k)
f(\(Just)g(sigma\))e(else)j(k)f(Nothing\))237 1580 y
Fy(j)26 b FE(Int)14 b(n)g Fy(\))g FE(case)g(t)g(of)466
1644 y(Int)g(u)g Fy(\))f FE(if)h(u=)g(n)h(then)g(k)f(msigma)d(else)k(k)
f(Nothing)428 1709 y Fy(j)p 468 1709 13 2 v 55 w(\))f
FE(k)h(Nothing)237 1774 y Fy(j)26 b FE(Op\(p11,s1,p12\))13
b Fy(\))g FE(case)i(t)f(of)653 1839 y(Op\(t21,s2,t22\))d
Fy(\))j FE(if)f(s1)h(=)g(s2)979 1903 y(then)h(\(matchK1)e(p11)1085
1968 y(\(fn)h(msig)f Fy(\))g FE(matchK1)g(p12)h(k)g(msig)f(t22\))1085
2033 y(msigma)e(t21\))979 2098 y(else)j(k)h(Nothing)237
2162 y Fy(j)p 265 2162 V 42 w(\))e FE(k)h(Nothing\).)150
2264 y FI(The)19 b(threading)g(of)f(the)h(substitution)g(in)f(the)h
(case)h(of)e FE(Op)g FI(patterns)i(has)f(b)q(een)g(replaced)h(b)o(y)e
(one)h(call)f(to)150 2338 y FE(matchK1)p FI(,)d(whic)o(h)h(itself)f
(tak)o(es)i(the)g(second)g(call)e(to)h FE(matchK1)f FI(as)h(part)g(of)g
(its)g(con)o(tin)o(uation.)e(More)j(imp)q(or-)150 2413
y(tan)o(tly)m(,)11 b(the)j(con)o(tin)o(uation)d(has)i(b)q(een)h
(explicitly)e(placed)h(on)f(the)i FH(br)n(anches)f FI(of)f(the)i
FE(if)p FI(-expression,)e(as)h(opp)q(osed)150 2488 y(to)k(just)g
(around)f(the)i(whole)e(expression.)i(This)e(minor)f(v)n(ariation)g
(will)h(ha)o(v)o(e)g(a)h(signi\014can)o(t)f(e\013ect)j(on)d(what)150
2563 y(can)e(b)q(e)h(ac)o(hiev)o(ed)f(b)o(y)f(staging)h(the)g(matc)o
(hing)e(function.)p eop
%%Page: 44 55
44 54 bop 1882 0 a FB(44)150 192 y FI(T)m(o)13 b(use)h(a)g(function)f
(written)h(in)f(CPS,)h(one)g(m)o(ust)e(pro)o(vide)i(an)f(initial)f(con)
o(tin)o(uation.)g(In)o(tuitiv)o(ely)m(,)g(the)i(initial)150
266 y(con)o(tin)o(uation)9 b(is)h(the)h(\014nal)e(step)i(of)f(the)g
(computation.)e(The)j(initial)d(con)o(tin)o(uation)h(can)h(simply)e(b)q
(e)j(the)f(iden)o(tit)o(y)150 341 y(function,)g(sp)q(ecifying)h(no)f
(further)i(computation)d(on)h(the)i(\014nal)e(result.)h(In)g(the)g
(case)h(of)e(the)i FE(matchK1)e FI(function,)150 416
y(ho)o(w)o(ev)o(er,)15 b(w)o(e)f(need)i(a)e(more)g(in)o(teresting)h
(con)o(tin)o(uation:)e(the)j(application)d(of)h(the)h(\014nal)f
(substitution)h(to)f(the)150 490 y(righ)o(t-hand)g(side)g(of)g(the)h
(rewrite)h(rule.)e(T)m(o)f(pass)i(this)g(con)o(tin)o(uation)e(to)h
FE(matchK1)p FI(,)g(w)o(e)g(write)h(a)f(new)h(v)o(ersion)150
565 y(of)e FE(rewrite1)i FI(as)f(follo)o(ws:)221 666
y FE(fun)g(rewriteK1)h(\(lhs,rhs\))f(=)221 731 y(fn)g(t)f
Fy(\))h FE(\(matchK1)f(lhs)269 796 y(\(fn)h(Nothing)g
Fy(\))g FE(t)297 861 y Fy(j)g FE(Just)g(s)f Fy(\))h FE(substK2)g(s)f
(rhs\))i(\(Just)f([]\))g(t\).)150 958 y FI(The)i(con)o(tin)o(uation)f
(that)h(w)o(e)g(pass)h(to)f FE(matchK1)f FI(\014rst)h(insp)q(ects)i
(the)e(\014nal)g(result)g(of)g(matc)o(hing.)d(If)j(it)f(w)o(as)h(a)150
1033 y(failure,)d(the)i(result)g(is)f(returned)i(unc)o(hanged.)e
(Otherwise,)i(the)e(substitution)h(is)f(applied)g(to)g(the)h(righ)o
(t-hand)150 1107 y(side)e(of)e(the)i(rewrite)g(rule.)f(As)h(usual,)f
(the)g(call)g(to)g FE(matchK1)g FI(is)g(also)f(passed)j(an)e(empt)o(y)f
(substitution)h(and)g(the)150 1182 y(term.)150 1326 y
FG(3.4.2)48 b(Re-Designin)o(g)13 b(the)i(Multi-Stage)e(T)o(yp)q(e)150
1438 y FI(The)h(t)o(yp)q(e)h(of)e(the)h(CPS)h(matc)o(hing)d(function)h
(is:)383 1550 y(\(\()p FE(string)d Fy(\003)f FE(term)p
FI(\))e FE(list)g(option)k Fy(!)899 1533 y Fs(0)910 1550
y FE(a)p FI(\))h Fy(!)f FI(\()p FE(string)f Fy(\003)f
FE(term)p FI(\))e FE(list)g(option)k Fy(!)g FE(term)g
Fy(!)1656 1533 y Fs(0)1668 1550 y FE(a)150 1661 y FI(This)k(function)g
(has)g(a)f(p)q(olymorphic)g(t)o(yp)q(e)h(b)q(ecause)i(nothing)d
(constrains)i(the)f(v)n(alue)g(returned)i(b)o(y)d(the)i(con-)150
1736 y(tin)o(uation)c FE(k)p FI(.)h(But)h(note)g(that)g(w)o(e)f(should)
g(not)h(read)g(the)g(\\return")g(t)o(yp)q(e)g(of)e(this)i(function)f
(as)25 b FE('a)p FI(,)12 b(but)i(rather)150 1810 y(as)g(the)g(t)o(yp)q
(e)g(of)f(the)h(argumen)o(t)f(of)g(the)h(con)o(tin)o(uation,)e(whic)o
(h)i(is)f(the)h(\014rst)h(o)q(ccurrence)h(of)d(the)h(t)o(yp)q(e)g
FE(\(string)g(*)150 1885 y(term\))g(list)f(option)p FI(.)150
1968 y(In)g(con)o(trast)h(to)e(the)i(\014rst)f(attempt)g(at)f
(designing)h(a)f(m)o(ulti-stage)f(t)o(yp)q(e)i(for)g(the)g(matc)o(hing)
f(function,)g(nothing)150 2043 y(forces)g(us)f(to)f(\\return")i(a)e
(dela)o(y)o(ed)h FE(option)g FI(t)o(yp)q(e.)g(Recall)f(from)f(Section)i
(3.3.1)e(that)i(the)g(di\016cult)o(y)f(in)h(ac)o(hieving)150
2118 y(a)k(t)o(yp)q(e)h(for)f(the)h(staged)g(function)f(w)o(as)g
(caused)i(b)o(y)e(the)h FE(if)p FI(-statemen)o(t)f(that)g(tested)i(for)
e(the)h(equalit)o(y)f(of)f(t)o(w)o(o)150 2192 y(terms.)d(This)h(test)g
(forced)g(the)h(whole)e FE(if)p FI(-expression)h(to)g(b)q(e)g(dela)o(y)
o(ed.)f(No)o(w,)g(the)h(dep)q(endencies)j(ha)o(v)o(e)c(c)o(hanged:)221
2294 y FE(...)221 2358 y(if)i(u=n)i(then)g(k)f(msigma)e(else)i(k)g
(Nothing)221 2423 y(...)e(.)150 2521 y FI(The)19 b(una)o(v)n(ailabilit)
o(y)d(of)i(the)i(condition)e(of)h(the)g FE(if)p FI(-statemen)o(t)g(no)f
(longer)h(matters.)f(Because)j(w)o(e)e(ha)o(v)o(e)g(an)150
2595 y(explicit)13 b(handle)h(on)f(the)h(con)o(tin)o(uation,)e(w)o(e)i
(do)g(not)f(ha)o(v)o(e)h(to)f(\\freeze")i(b)q(oth)f(branc)o(hes)h(of)e
(the)h FE(if)p FI(-statemen)o(t.)150 2670 y(Instead)i
FH(we)f(c)n(an)h(pursue)g(b)n(oth)g(p)n(ossible)f(ways)h(in)f(which)h
(the)g(c)n(omputation)g(might)f(c)n(ontinue)p FI(.)g(Pursuing)g(the)p
eop
%%Page: 45 56
45 55 bop 1882 0 a FB(45)150 192 y FI(con)o(tin)o(uations)11
b(could)h(mean)f(eliminating)e(man)o(y)h(sup)q(er\015uous)k
FE(Nothing)f FI(and)f FE(Just)f FI(constructs.)j(F)m(or)e(example,)150
266 y(the)i(initial)e(con)o(tin)o(uation)h(passed)h(to)g
FE(matchK1)f FI(b)o(y)g FE(rewriteK1)i FI(is)e(a)h(case)g(analysis)f(o)
o(v)o(er)h(the)g(result.)g(As)g(suc)o(h)150 341 y(the)j(initial)d(con)o
(tin)o(uation)h FH(eliminates)g FI(the)i(constructs)h(of)e(the)g
FE(option)h FI(t)o(yp)q(e.)f(F)m(urthermore,)f(the)i(only)e(time)150
416 y(w)o(e)f(extend)h(the)g(con)o(tin)o(uation)d(is)i(when)g(w)o(e)h
(are)f(matc)o(hing)e(binary)h(op)q(erators:)221 522 y
FE(...)221 587 y(\(matchK1)g(p11)237 651 y(\(fn)h(msig)e
Fy(\))i FE(matchK1)f(p12)h(k)g(msig)e(t22\))237 716 y(msigma)f(t21\))
221 781 y(...)h(.)150 882 y FI(As)j(long)f(as)g(matc)o(h)f(con)o(tin)o
(ues)i(to)g(\\consume")f(the)h FE(option)f FI(constructors)j(of)d
(sigma,)e(the)j(new)g(con)o(tin)o(uation)150 957 y(will)i(also)h(b)q(e)
i(a)e(\\consumer".)g(This)g(observ)n(ation)h(suggests)h(that)e(the)i
(dela)o(y)o(ed)e(computations)g(generated)150 1032 y(b)o(y)e(b)q(oth)h
(branc)o(hes)h(of)e(the)h FE(if)p FI(-statemen)o(t)f(ma)o(y)f(b)q(e)i
(free)h(of)e(an)o(y)g FE(option)h FI(constructors.)h(A)o(t)f(the)g
(same)f(time,)150 1106 y(eliminating)7 b(these)12 b(constructors)g
(should)e(coincide)h(with)e(eliminating)f(the)i(complex)f(nested)j
FE(case)p FI(-statemen)o(ts)150 1181 y(that)i(infested)h(the)f(output)g
(of)f(our)h(\014rst)h(attempt)e(at)h(staging)f(the)i(matc)o(h)d
(function.)150 1264 y(In)i(summary)m(,)c(no)o(w)k(there)h(is)f(no)f
(reason)i(wh)o(y)f(w)o(e)g(cannot)g(ac)o(hiev)o(e)g(the)g(t)o(yp)q(e:)
296 1380 y(\(\()p FE(string)c Fy(\003)f(h)p FE(term)p
Fy(i)p FI(\))e FE(list)g(option)12 b Fy(!)f(h)860 1363
y Fs(0)872 1380 y FE(a)p Fy(i)p FI(\))h Fy(!)f FI(\()p
FE(string)f Fy(\003)f(h)p FE(term)p Fy(i)p FI(\))e FE(list)g(option)12
b Fy(!)f(h)p FE(term)p Fy(i)g(!)g(h)1715 1363 y Fs(0)1726
1380 y FE(a)p Fy(i)p FF(:)150 1528 y FG(3.4.3)48 b(A)16
b(Tw)o(o-Stage)f(Con)o(tin)o(uati)o(on)o(-P)o(assi)o(n)o(g)e(St)o(yle)h
(Implemen)o(tati)o(on)150 1644 y FI(Adding)f(staging)h(annotations)f
(to)h FE(matchK1)f FI(w)o(e)h(arriv)o(e)g(at)g(the)g(follo)o(wing)d(t)o
(w)o(o-stage)j(function:)221 1751 y FE(fun)g(matchK2)f(pat)h(k)h
(msigma)c(t)j(=)221 1815 y(case)g(\(msigma\))e(of)259
1880 y(Nothing)j Fy(\))e FE(k)h(Nothing)221 1945 y Fy(j)26
b FE(Just)14 b(\(sigma\))e Fy(\))221 2010 y FE(\(case)i(pat)h(of)275
2074 y(V)o(a)o(r)e(u)i Fy(\))e FE(\(case)i(\014nd)g(u)f(sigma)e(of)494
2139 y(Nothing)i Fy(\))g FE(k)g(\(Just)g(\(\(u,t\))g(::)f(sigma\)\))455
2204 y Fy(j)27 b FE(Just)13 b(w)i Fy(\))e(h)p FE(if)i(~)q(w)f(=)h(~)q
(t)f(then)i(~)q(\(k)e(\(Just)g(sigma\)\))f(else)j(~\(k)f(Nothing\))p
Fy(i)q FE(\))237 2269 y Fy(j)26 b FE(Int)14 b(n)g Fy(\))g(h)p
FE(case)h(~)q(t)f(of)482 2333 y(Int)g(u)g Fy(\))g FE(if)f(u=)j(~)q
(\(lift)11 b(n\))j(then)j(~\(k)e(msigma\))c(else)16 b(~)q(\(k)e
(Nothing\))444 2398 y Fy(j)p 485 2398 13 2 v 55 w(\))g
FE(~)q(\(k)h(Nothing\))p Fy(i)237 2463 y(j)26 b FE(Op\(p11,s1,p12\))13
b Fy(\))g(h)p FE(case)j(~)q(t)e(of)669 2528 y(Op\(t21,s2,t22\))e
Fy(\))h FE(if)i(~\(lift)d(s1\))h(=)h(s2)995 2592 y(then)i(~)q
(\(matchK2)e(p11)1124 2657 y(\(fn)g(msig)f Fy(\))g FE(matchK2)g(p12)h
(k)g(msig)f Fy(h)p FE(t22)p Fy(i)p FE(\))p eop
%%Page: 46 57
46 56 bop 1882 0 a FB(46)1124 195 y FE(msigma)12 b Fy(h)p
FE(t21)p Fy(i)o FE(\))995 260 y(else)k(~)q(\(k)e(Nothing\))237
325 y Fy(j)p 265 325 13 2 v 42 w(\))g FE(~)q(\(k)h(Nothing\))p
Fy(i)q FE(\).)150 423 y FI(The)k(t)o(yp)q(e)g(of)e(the)i(substitutions)
g(m)o(ust)f(c)o(hange:)g(The)h(sk)o(eleton)g(of)e(the)i(list)f(and)h
(the)g(\014rst)g(pro)r(jection)g(of)150 498 y(eac)o(h)e(binding)e
(\(the)i(v)n(ariable)e(names\))h(are)g(no)o(w)g(a)o(v)n(ailable)e(in)i
(the)h(\014rst)g(stage.)f(Th)o(us,)g(w)o(e)h(can)f(rewrite)h(the)150
573 y(substitution)d(function)g(to)f(tak)o(e)h(adv)n(an)o(tage)f(of)h
(this)g(information:)221 676 y FE(fun)g(substK2)g(sigma)e(pat)j(=)221
741 y(case)f(pat)g(of)259 805 y(V)o(a)o(r)f(v)h Fy(\))g
FE(\(case)g(\014nd)h(v)f(sigma)f(of)g(Just)h(w)g Fy(\))f
FE(w\))221 870 y Fy(j)26 b FE(Int)14 b(i)g Fy(\))f(h)p
FE(Int)i(~)q(\(lift)c(i\))p Fy(i)221 935 y(j)26 b FE(Op\(t1,s,t2\))13
b Fy(\))g(h)p FE(Op)h(\()q(~)q(\(substK2)g(sigma)f(t1\),)h(~)q(\(lift)d
(s\),)k(~)q(\(substK2)f(sigma)e(t2\)\))p Fy(i)p FE(.)150
1033 y FI(Finally)m(,)f(w)o(e)j(also)g(need)h(to)e(annotate)h(the)h
(CPS)f(rewriting)g(function:)221 1136 y FE(fun)g(rewriteK2)h
(\(lhs,rhs\))f(=)221 1201 y Fy(h)p FE(fn)g(t)g Fy(\))g
FE(~)q(\(matchK2)f(lhs)285 1266 y(\(fn)h(Nothing)g Fy(\))g(h)p
FE(t)p Fy(i)314 1331 y(j)f FE(Just)h(s)f Fy(\))h FE(substK2)g(s)g
(rhs\))g(\(Just)g([]\))g Fy(h)p FE(t)p Fy(i)p FE(\))p
Fy(i)q FE(.)150 1491 y FG(3.4.4)48 b(Using)14 b(the)h(Tw)o(o-Stage)g
(Con)o(tin)o(uati)o(on)o(-P)o(assi)o(n)o(g)e(St)o(yle)h(Implemen)o
(tati)o(on)150 1605 y FI(The)g(output)g(of)g(the)g(CPS)g(rewrite)h
(function)f(for)f(the)i(rule)f FF(r)1126 1611 y FA(1)1158
1605 y FI(is)g(as)g(follo)o(ws:)221 1708 y FE(-)p Fy(j)f
FE(rewriteK2)i(r1;)221 1773 y(val)e(it)h(=)g Fy(h)p FE(\(fn)h(a)e
Fy(\))221 1837 y FE(case)h(a)g(of)259 1902 y(Op\(d,c,b\))g
Fy(\))g FE(if)f("+")h Fu(\045)p FE(=)g(c)g(then)h(\(case)g(b)f(of)g
(Int)f(e)i Fy(\))e FE(if)g(e)p Fu(\045)q FE(=0)g(then)j(d)e(else)g(a)g
Fy(j)p 1561 1902 V 42 w(\))g FE(a\))725 1967 y(else)h(a)221
2032 y Fy(j)p 261 2032 V 55 w(\))e FE(a\))p Fy(i)221
2097 y FE(:)g Fy(h)p FE(term)h Fy(!)f FE(term)p Fy(i)p
FE(.)150 2195 y FI(The)e(generated)g(co)q(de)h(is)e(b)q(oth)g(compact)g
(and)g(free)h(of)f(reducible)h(nested)h FE(case)p FI(-statemen)o(ts,)e
(calls)g(to)h FE(subst)p FI(,)f(and)150 2270 y(tests)16
b(on)f(the)g(consistency)i(of)d(the)h(substitution.)g(F)m(urthermore,)f
(it)h(is)f(virtually)g(iden)o(tical)g(to)h(the)g(idealized)150
2345 y(co)q(de)j(w)o(e)f(presen)o(ted)i(for)e FE(rewriteR1)h
FI(in)f(Section)g(3.2.4:)e(It)i(con)o(tains)g(no)g(sup)q(er\015uous)i
(redices,)f(and)f(rather,)150 2419 y(only)c(those)i(that)f(really)f
(dep)q(end)i(on)f(the)g(parameter)g(to)g(the)g(v)n(ariable)f
FE(a)p FI(.)150 2502 y(The)h(co)q(de)h(generated)g(for)f(the)g(more)f
(in)o(v)o(olv)o(ed)g FF(r)941 2508 y FA(3)973 2502 y
FI(is)h(also)f(concise:)221 2605 y FE(-)p Fy(j)g FE(rewriteK2)i(r3;)221
2670 y(val)e(it)h(=)g Fy(h)p FE(fn)g(a)g Fy(\))p eop
%%Page: 47 58
47 57 bop 1882 0 a FB(47)221 195 y FE(\(case)14 b(a)g(of)275
260 y(Op\(d,c,b\))h Fy(\))e FE(if)g("+")h Fu(\045)p FE(=)g(c)g(then)h
(\(case)g(b)f(of)886 325 y(Op\(g,f,e\))f Fy(\))g FE(if)h("+")f
Fu(\045)p FE(=)h(f)g(then)h(Op\(Op\(d,"+",g\),"+",e\))1151
390 y(else)f(a)848 454 y Fy(j)p 888 454 13 2 v 55 w(\))f
FE(a\))741 519 y(else)i(a)237 584 y Fy(j)p 278 584 V
55 w(\))e FE(a\))p Fy(i)221 649 y FE(:)g Fy(h)p FE(term)h
Fy(!)f FE(term)p Fy(i)p FE(.)150 805 y FG(3.4.5)48 b(Remark)15
b(on)h(the)e(Role)h(of)h(MetaML)f(in)g(Multi-Stage)e(Programming)150
916 y FI(If)h(the)i(reader)g(is)e(not)h(famili)o(ar)d(with)i(t)o(yp)q
(e)i(systems)f(and)f(with)h(programmi)o(ng)d(languages)i(suc)o(h)h(as)g
(SML,)f(it)150 990 y(ma)o(y)h(app)q(ear)j(that)g(designing)f(the)h(t)o
(yp)q(e)g(for)f(the)h(staged)g(v)o(ersion)f(\(Sections)h(3.3.1)e(and)h
(3.4.2\))f(is)h(a)g(blac)o(k)150 1065 y(art.)i(What)g(w)o(e)g(ha)o(v)o
(e)g(describ)q(ed)i(in)e(this)g(c)o(hapter)h(as)f(\\designing)g(the)g
(m)o(ulti-stage)f(t)o(yp)q(e")h(is)g(essen)o(tially)150
1140 y(what)14 b(binding-time)e(analysis)i(\(BT)m(A\))g(p)q(erforms)g
(automatically)m(.)c(MetaML)15 b(pro)o(vides)g(p)q(edagogical)e(help)h
(in)150 1215 y(\\remo)o(ving)e(the)i(magic")e(from)g(BT)m(A)i(in)f(t)o
(w)o(o)h(w)o(a)o(ys:)168 1324 y(1.)20 b(It)c(pro)o(vides)h(a)f(formal)e
(seman)o(tic)h(basis)i(for)f(m)o(ulti-stage)e(programs.)h(This)h
(foundation)g(is)g(needed,)h(for)221 1399 y(example,)c(to)h(pro)o(v)o
(e)h(that)g(MetaML)h(can)f(indeed)g(ha)o(v)o(e)g(a)f
(\\staging-sensitiv)o(e")h(t)o(yp)q(e)g(system,)f(and)h(that)221
1474 y(this)f(t)o(yp)q(e)g(system)g(ensures)h(that)f(w)o(ell-t)o(yp)q
(ed)g(programs)f(are)h(indeed)g(safe.)168 1547 y(2.)20
b(It)10 b(pro)o(vides)g(a)g(system)g(for)g(executing)h(m)o(ulti-stage)d
(programs.)g(F)m(or)i(example,)e(ha)o(ving)h(the)i(t)o(yp)q(e)g
(inference)221 1622 y(system)k(and)g(the)h(in)o(teractiv)o(e)g(section)
g(pro)o(vided)f(b)o(y)g(the)h(implemen)o(tation)c(giv)o(es)j(the)h
(programmer)d(an)221 1697 y(automatic)h(to)q(ol)h(that)g(will)g(p)q
(oin)o(t)g(out)h FH(al)r(l)f FI(the)i(problems)d(that)i(w)o(e)g
(describ)q(ed)i(in)d(the)i(last)e(subsection.)221 1772
y(Th)o(us,)j(the)g(programmer)e(can)j(b)q(egin)f(learning)f(m)o
(ulti-stage)g(programmi)o(ng)e(b)o(y)j(trial-and-error.)g(The)221
1846 y(in)o(teractiv)o(e)c(t)o(yp)q(e)g(system)g(will)e(alw)o(a)o(ys)h
(tell)h(y)o(ou)f(when)h(y)o(ou)g(try)g(to)g(do)f(something)g(unsafe!)
150 1957 y(In)f(our)g(exp)q(erience,)i(the)f(feedbac)o(k)g(pro)o(vided)
f(b)o(y)f(the)i(t)o(yp)q(e)g(system)f(help)q(ed)h(greatly)f(in)f(dev)o
(eloping)h(the)g(righ)o(t)150 2032 y(insigh)o(ts)k(and)g(in)o(tuitions)
f(ab)q(out)h(the)h(structure)h(of)e(the)h(algorithms)d(that)i(w)o(e)g
(w)o(ere)h(in)o(terested)h(in)e(staging.)150 2107 y(Ev)o(en)j(after)f
(a)g(programmer)e(has)i(gained)g(the)h(necessary)h(exp)q(ertise)g(and)e
(has)h(b)q(ecome)f(\015uen)o(t)h(at)f(staging)150 2182
y(programs,)f(the)i(t)o(yp)q(e)f(inference)i(system)e(will)f
(automatically)e(c)o(hec)o(k)20 b(the)e(programmer's)e(annotations)i
(to)150 2256 y(ensure)d(that)f(they)h(are)f(indeed)h(sound.)150
2399 y FG(3.4.6)48 b(Remark)15 b(on)h(the)e(Sp)q(ecialization)e(of)k(T)
l(erm-Rewriting)d(Systems)150 2510 y FI(Bondorf)h(seems)g(to)g(ha)o(v)o
(e)g(b)q(een)h(the)g(\014rst)g(to)f(systematically)e(study)j(the)f
(application)f(of)g(partial)g(ev)n(aluation)150 2585
y(to)19 b(term-rewriting)g(systems)h([7].)e(F)m(or)h(the)h(reader)g(in)
o(terested)i(in)d(the)h(sp)q(ecialization)f(of)g(term-rewriting)150
2660 y(systems,)14 b(w)o(e)g(recommend)e(consulting)i(Bondorf)s('s)g
(thesis)g([8].)p eop
%%Page: 48 59
48 58 bop 888 968 a FL(P)m(art)32 b(I)s(I)348 1221 y
Fv(The)38 b(Theory)h(of)f(Multi-Stage)687 1383 y(Programming)p
eop
%%Page: 49 60
49 59 bop 822 436 a FL(Chapter)31 b(4)309 662 y(Ho)m(w)i(Do)g(W)-8
b(e)32 b(Implemen)m(t)f(MetaML?)333 797 y(Or,)h(the)g(Basic)h(Seman)m
(tic)f(Concerns)1099 1010 y FC(I)14 b(test)e(my)i(b)n(ath)f(b)n(efor)n
(e)f(I)h(sit,)1099 1070 y(A)o(nd)g(I'm)g(always)g(move)n(d)g(to)g
(wonderment)1099 1129 y(That)h(what)f(chil)r(ls)f(the)g(\014nger)h(not)
f(a)i(bit)1099 1188 y(Is)g(so)f(frigid)f(up)n(on)g(the)h(fundament.)
1315 1281 y(Samson)f(A)n(gonistes)s FB(,)d(Ogden)14 b(Nash)150
1461 y FI(In)e(previous)g(c)o(hapters,)g(w)o(e)g(ha)o(v)o(e)f(in)o(tro)
q(duced)i(MetaML,)e(staging,)g(m)o(ulti-stage)e(programming)f(with)j
(explicit)150 1536 y(annotations,)16 b(cross-stage)i(p)q(ersistence,)h
(and)e(cross-stage)h(safet)o(y)m(.)e(In)h(this)g(c)o(hapter)h(w)o(e)f
(explain)f(the)i(basic)150 1610 y(c)o(hallenges)13 b(in)g(implemen)o
(ting)d(and)j(t)o(yping)g(a)g(m)o(ulti-stage)e(programmi)o(ng)g
(language)h(suc)o(h)i(as)f(MetaML.)g(W)m(e)150 1685 y(break)i(do)o(wn)e
(these)j(problems)d(in)o(to)h(t)o(w)o(o)f(sets:)i(Ones)h(that)e(w)o
(ere)h(kno)o(wn)f(when)g(the)h(early)f(implemen)o(tations)150
1760 y(of)f(MetaML)i(w)o(ere)f(dev)o(elop)q(ed,)g(and)g(new)g(ones)h
(that)f(w)o(e)g(recognized)h(while)e(using)h(these)h(implemen)o
(tations.)150 1843 y(This)f(c)o(hapter)h(is)f(illustrativ)o(e)f(of)g
(the)i(state)g(of)e(the)i(art)f(in)f(the)i(\(p)q(oten)o(tially)e(v)o
(eri\014able\))h(implemen)o(tation)d(of)150 1918 y(m)o(ulti-stage)h
(programmi)o(ng)f(languages.)150 2076 y FD(4.1)56 b(Kno)n(wn)19
b(Concerns)150 2209 y FI(W)m(e)14 b(b)q(egin)h(b)o(y)f(explaining)f
(the)j(need)f(for)g(renaming)e(of)h(b)q(ound)g(v)n(ariables)g(in)h
(quoted)g(expressions)h(and)e(wh)o(y)150 2284 y(suc)o(h)i(renaming)d
(is)h(necessary)j(for)e(implem)o(en)o(ting)d(static)j(scoping.)f(W)m(e)
h(also)f(explain)g(wh)o(y)g(retaining)h(static)150 2358
y(scoping)h(is)g(desirable)h(from)d(the)j(p)q(oin)o(t)e(of)h(view)g(of)
f(the)i(design)f(goals)g(of)f(MetaML.)h(W)m(e)g(then)h(presen)o(t)g
(the)150 2433 y(syn)o(tax)f(and)f(t)o(yp)q(e)h(system)g(for)f(a)g(to)o
(y)h(functional)e(language)h(and)h(explain)f(ho)o(w)g(the)h(t)o(yp)q(e)
g(system)g(m)o(ust)e(b)q(e)150 2508 y(c)o(hanged)g(to)g(accommo)q(date)
e(extending)i(this)g(to)o(y)f(language)g(with)h(staging)f(annotations.)
1014 2795 y(49)p eop
%%Page: 50 61
50 60 bop 1882 0 a FB(50)150 192 y FG(4.1.1)48 b(Scoping)14
b(and)h(the)g FE(h)h FG(F)l(unction)150 298 y FI(A)g(name-generating)f
(function)g(\(\\gensym"\))g(can)h(b)q(e)g(used)h(to)e(a)o(v)o(oid)g
(acciden)o(tal)h(name)e(capture)j(in)e(m)o(ulti-)150
373 y(lev)o(el)d(languages.)f(The)i(use)g(of)f(suc)o(h)h(a)f(function)g
(has)h(b)q(een)g(asso)q(ciated)g(with)f(use)h(of)f(bac)o(k-quote)h(and)
f(comma)150 447 y(in)j(LISP)g(ev)o(er)h(since)g(they)f(w)o(ere)h(in)o
(tro)q(duced)g([88].)d(The)j(bac)o(k-quote)f(and)g(comma)d(mec)o
(hanism)g(is)j(an)g(early)150 522 y(ancestor)e(of)e(Brac)o(k)o(ets)j
(and)e(Escap)q(e)h(\(See)g(Section)f(7.4.2.\))e(V)m(arious)i(w)o(orks)g
(ha)o(v)o(e)f(studied)i(and)f(explained)f(the)150 597
y(need)i(for)e(run-time)g(renaming)f(of)h(b)q(ound)h(v)n(ariables)f
([13].)f(In)i(what)g(follo)o(ws,)d(w)o(e)j(presen)o(t)i(a)d(brief)h
(explanation)150 672 y(of)i(the)h(need)h(for)e(renaming,)e(and)j(wh)o
(y)f(it)g(m)o(ust)g(b)q(e)h(p)q(erformed)f(at)g(run-time.)f(T)m(o)h
(illustrate)h(this)f(p)q(oin)o(t,)g(w)o(e)150 746 y(will)e(in)o(tro)q
(duce)j(a)f(simple)e(function)i(called)f FE(h)h FI(that)g(w)o(e)h(use)f
(throughout)g(this)g(c)o(hapter.)150 894 y FG(The)19
b(Need)g(for)f(Renaming)23 b FI(In)16 b(a)h(m)o(ulti-lev)o(el)d
(language,)h(ob)r(ject-lev)o(el)i(b)q(ound)g(v)n(ariables)f(m)o(ust)g
(b)q(e)h(re-)150 969 y(named.)12 b(Consider)j(the)f(function)g
FE(T)g FI(from)e(Chapter)i(1:)221 1063 y FE(fun)g(T)g(e)g(=)g
Fy(h)q FE(fn)g(x)g Fy(\))f FE(x)h(+)h(~)q(e)p Fy(i)q
FE(.)150 1154 y FI(The)h(function)g FE(T)g FI(tak)o(es)h(an)f
(expression)h FE(e)f FI(and)g(returns)i(a)d(new)i(expression)g
(represen)o(ting)g(a)f(function)g(that)150 1229 y(tak)o(es)e(an)g
(argumen)o(t)f FE(x)h FI(and)f(adds)i(it)e(to)h FE(e)p
FI(.)g(W)m(e)f(can)h(use)h FE(T)f FI(as)g(follo)o(ws:)221
1323 y FE(val)f(e)i(=)f Fy(h)p FE(fn)g(y)g Fy(\))g FE(~)q(\(T)h
Fy(h)p FE(y)p Fy(i)p FE(\))p Fy(i)p FE(.)150 1414 y FI(And)f(the)h
(result)f(is:)221 1508 y Fy(h)p FE(fn)g(y)g Fy(\))f FE(fn)h(x)g
Fy(\))f FE(x)h(+)g(y)p Fy(i)q FE(.)150 1600 y FI(If)f(w)o(e)h(do)g(not)
f(rename)h(b)q(ound)f(v)n(ariables)g(while)h(constructing)g(a)g(piece)g
(of)f(co)q(de,)h(w)o(e)g(run)g(in)o(to)f(the)i(follo)o(wing)150
1674 y(problem.)d(If,)h(in)h FE(e)p FI(,)f(w)o(e)h(had)g(called)g(the)g
(lo)q(cal)f(v)n(ariable)g FE(x)h FI(instead)g(of)g FE(y)p
FI(,)f(then)i(w)o(e)f(w)o(ould)f(get)h(the)g(result:)221
1768 y Fy(h)p FE(fn)g(x)g Fy(\))f FE(fn)h(x)g Fy(\))f
FE(x)h(+)g(x)p Fy(i)q FE(.)150 1860 y FI(This)g(term)f(represen)o(ts)j
(a)e(function)f(that)h(is)g(v)o(ery)g(di\013eren)o(t)h(from)d(the)i
(\014rst)h(one,)e(b)q(ecause)j(it)d(simply)f(ignores)150
1934 y(its)h(\014rst)g(argumen)o(t,)e(and)i(returns)h(the)f(result)g
(of)f(adding)g(the)i(second)f(argumen)o(t)f(to)g(itself.)g(W)m(e)g
(consider)i(this)150 2009 y(dynamic)d(capture)j(of)e(names)g
(unsatisfactory)m(,)g(b)q(ecause)i(w)o(e)f(wish)g(to)f(main)o(tain)e(a)
i(relativ)o(ely)g(simple)g(relation)150 2084 y(b)q(et)o(w)o(een)i(our)f
(m)o(ulti-lev)o(el)d(programs)i(and)h(their)g(\\unannotated)g(coun)o
(terparts".)h(In)e(particular,)h(if)f(w)o(e)h(erase)150
2159 y(the)h(annotations)g(from)e FE(T)i FI(and)g FE(e)g
FI(w)o(e)g(get:)221 2253 y FE(fun)g(T')g(e)g(=)g(fn)g(x)g
Fy(\))f FE(x)h(+)g(e)221 2317 y(val)f(e')h(=)g(fn)g(x)g
Fy(\))g FE(T')f(x.)150 2409 y FI(The)i(standard)g(seman)o(tics)f(for)h
(a)f(CBV)h(language)f(do)q(es)h(not)g(confuse)g(the)g(t)o(w)o(o)f(o)q
(ccurrences)k(of)c(the)h(name)f FE(x)150 2483 y FI(in)f(this)h
(declaration.)f(W)m(e)h(can)g(c)o(hec)o(k)h(this)f(fact)g(using)f(an)h
(implemen)o(tatio)o(n)d(of)j(SML:)221 2577 y FE(-)f(e')h(4)g(5;)221
2642 y(val)f(it)h(=)g(9)g(:)f(int.)p eop
%%Page: 51 62
51 61 bop 1882 0 a FB(51)150 192 y FG(Renaming)16 b(Cannot)i(Be)g(P)o
(erformed)d(at)j(Compile-Time)j FI(If)15 b(w)o(e)h(consider)h(only)e
(examples)g(suc)o(h)i(as)150 266 y(the)c(function)f FE(T)p
FI(,)g(it)g(ma)o(y)e(seem)i(enough)g(to)h(rename)e(v)n(ariables)h(in)g
(a)g(program)e FH(b)n(efor)n(e)i FI(w)o(e)h(b)q(egin)f(executing)h(it.)
150 341 y(But)g(renaming)e(b)q(efore)i(execution)g(is)g(not)f(enough:)g
(Bound)h(v)n(ariables)e(in)h(ob)r(ject-terms)h(m)o(ust)f(b)q(e)h(rep)q
(eatedly)150 416 y(renamed)i(at)h(run-time.)e(T)m(o)h(illustrate)g
(this)h(p)q(oin)o(t,)f(w)o(e)h(will)e(presen)o(t)j(t)o(w)o(o)f(v)o
(ersions)g(of)f(a)h(function)f(that)h(w)o(e)150 490 y(call)f
FE(h)p FI(.)g(The)h(\014rst,)g(single-stage)f(v)o(ersion)g(is)h(called)
f FE(h1)p FI(,)g(and)g(second,)h(t)o(w)o(o-stage)f(v)o(ersion)h(is)f
(called)g FE(h2)p FI(.)h(The)150 565 y(single-stage)e
FE(h1)g FI(function)f(is)h(de\014ned)h(as)f(follo)o(ws:)221
666 y FE(fun)g(h1)g(n)g(z)g(=)g(if)g(n=0)g(then)h(z)f(else)h(\(fn)f(x)g
Fy(\))f FE(\(h1)h(\(n-1\))g(x+\(z\)\)\))h(n.)150 764
y FI(This)h(function)g(tak)o(es)g(t)o(w)o(o)g(in)o(teger)g(argumen)o
(ts.)f(If)h(the)g(\014rst)h(argumen)o(t)e(is)h FE(0)p
FI(,)f(then)i(it)f(simply)e(returns)j(the)150 838 y(second)e(argumen)o
(t.)c(Otherwise,)k(it)e(mak)o(es)f(a)i(recursiv)o(e)h(call)d(to)i
(itself)f(after)h(subtracting)g(one)f(from)f(the)i(\014rst)150
913 y(argumen)o(t)f(and)g(adding)h(the)g(\014rst)h(argumen)o(t)d(to)i
(the)h(second.)f(Note)g(ho)o(w)o(ev)o(er)h(that)f(w)o(e)g(use)g(a)g(lo)
q(cal)f(v)n(ariable)150 988 y FE(x)i FI(as)g(a)f(lo)q(cal)g(name)g(for)
g(the)i(second)f(argumen)o(t)f FE(n)p FI(.)h(This)f(fact)h(is)g
(inconsequen)o(tial)g(to)f(the)i(result)f(of)f FE(h1)p
FI(,)h(but)150 1063 y(will)d(b)q(e)j(signi\014can)o(t)e(when)i(w)o(e)f
(analyze)g(the)g(staged)g(v)o(ersion)g FE(h2)p FI(:)221
1164 y FE(fun)g(h2)g(n)g(z)g(=)g(if)g(n=0)g(then)h(z)f(else)h
Fy(h)p FE(\(fn)f(x)g Fy(\))g FE(~)q(\(h2)h(\(n-1\))f
Fy(h)g FE(x+\()q(~)q(z\))p Fy(i)q FE(\)\))g(n)p Fy(i)p
FE(.)150 1261 y FI(Note)g(that)g(an)o(y)f(renaming)f(of)h(this)h(one)g
(v)n(ariable)e(b)q(efore)j(run-time)d(is)i(inconsequen)o(tial:)f(It)h
(will)e(still)g(b)q(e)j(one)150 1336 y(v)n(ariable.)d(Without)i
(renaming)e(at)i(run-time,)e(the)i(application)f FE(h2)h(3)f
Fy(h)q FE(4)p Fy(i)g FI(ev)n(aluates)h(to:)221 1437 y
Fy(h)p FE(\(fn)g(x)g Fy(\))f FE(\(\(fn)h(x)g Fy(\))g
FE(\(\(fn)g(x)g Fy(\))f FE(x+\(x+\(x+4\)\)\))j(1)p 574
1454 443 2 v(\)\))e(2)p 405 1463 679 2 v(\)\))g(3)p 237
1471 914 2 v -1 w Fy(i)150 1535 y FI(and)f(all)g(the)h(o)q(ccurrences)j
(of)12 b(the)j(name)d FE(x)i FI(in)f(the)h(arithmetic)e(expression)j
(refer)g(to)e(the)h(argumen)o(t)f(from)e(the)150 1609
y(innermost)16 b(binding.)g(But)h(this)g(acciden)o(tal)g(capture)h(of)f
(all)e(references)20 b(b)o(y)d(the)h(innermost)e(binder)h(should)150
1684 y(not)e(tak)o(e)g(place.)f(If)h(w)o(e)g(follo)o(w)d(the)k
(execution)f(of)f(the)i(program)d(closely)m(,)h(w)o(e)h(\014nd)g(that)g
(eac)o(h)g(o)q(ccurrence)j(of)150 1759 y(an)c FE(x)g
FI(should)f(b)q(e)i(asso)q(ciated)f(to)g(a)g(di\013eren)o(t)h(binding)e
(in)g(the)h(follo)o(wing)e(manner:)221 1860 y Fy(h)p
FE(\(fn)i(x)320 1866 y FA(1)352 1860 y Fy(\))g FE(\(\(fn)g(x)507
1866 y FA(2)540 1860 y Fy(\))f FE(\(\(fn)h(x)694 1866
y FA(3)727 1860 y Fy(\))f FE(x)801 1866 y FA(3)820 1860
y FE(+\(x)887 1866 y FA(2)906 1860 y FE(+\(x)973 1866
y FA(1)992 1860 y FE(+4\)\)\))i(1)p 611 1877 518 2 v
-1 w(\)\))g(2)p 424 1885 772 2 v -1 w(\)\))f(3)p 237
1894 1026 2 v Fy(i)p FE(.)150 1957 y FI(Again,)g(the)j(reader)f(can)g
(v)o(erify)f(that)h(the)g(result)h(of)e(ev)n(aluating)f(this)i(last)f
(co)q(de)i(fragmen)o(t)d(is)h(more)g(closely)150 2032
y(related)f(to)g(the)h(\\unannotated")e(seman)o(tics)h(of)f(the)i
FE(h)f FI(function.)150 2115 y(In)g(Section)g(4.3.2,)e(w)o(e)i(will)e
(sho)o(w)i(ho)o(w)g(this)g(renaming)e(is)i(p)q(erformed)f(in)h(the)g
(implemen)o(tation.)150 2259 y FG(4.1.2)48 b(T)o(yping)14
b(F)l(unctional)f(Languages)h(and)i(MetaML)g(\()p Fp(\025)f
FG(and)g Fp(\025)p FG(-M\))150 2371 y FI(Most)e(functional)f
(programming)d(languages)k(are)g(inspired)g(b)o(y)g(the)g(lam)o(b)q(da)
e(calculus)i([1].)e(In)i(order)g(to)g(b)q(egin)150 2446
y(dev)o(eloping)g(the)h(seman)o(tics)f(and)g(t)o(yp)q(e)h(system)f(for)
h(MetaML,)f(w)o(e)h(fo)q(cus)f(on)h(a)f(minim)o(al)d(subset)15
b(of)e(MetaML)150 2521 y(that)18 b(can)h(b)q(e)f(studied)h(as)f(an)g
(extension)h(of)e(the)i(lam)o(b)q(da)d(calculus.)i(In)g(what)g(follo)o
(ws,)e(w)o(e)i(in)o(tro)q(duce)h(the)150 2595 y(syn)o(tax)c(and)f(t)o
(yp)q(e)h(system)g(of)f(a)g(lam)o(b)q(da)e(calculus)j(extended)h(to)f
(include)g(in)o(tegers,)g(and)f(then)h(explain)f(ho)o(w)150
2670 y(the)g(t)o(yp)q(e)h(judgemen)o(t)e(m)o(ust)g(b)q(e)h(extended)i
(in)d(order)i(to)e(b)q(e)i(able)f(to)f(express)j(the)e(notion)g(of)f
(staging.)p eop
%%Page: 52 63
52 62 bop 1882 0 a FB(52)150 192 y FG(The)16 b Fp(\025)g
FG(Language:)f(T)l(erms)g(and)h(T)o(yp)q(e)g(System)j
FI(A)14 b(basic)h(lam)o(b)q(da)c(calculus)k([1])d(extended)k(to)e
(include)150 266 y(in)o(teger)g(constan)o(ts)h(has)f(the)h(follo)o
(wing)c(syn)o(tax:)796 372 y FF(e)h Fy(2)f FF(E)j FI(:=)d
FF(i)19 b Fy(j)f FF(x)g Fy(j)g FF(\025x:e)g Fy(j)g FF(e)7
b(e)150 467 y FI(where)14 b FF(E)h FI(is)d(the)h(set)h(of)e
(expressions.)i(Expressions)g(can)f(b)q(e)g(in)o(tegers)h(from)d(the)i
(set)h Fo(I)-8 b FI(,)9 b(lam)o(b)q(da-abstractions,)150
542 y(free)h(o)q(ccurrences)i(of)d(v)n(ariables)g FF(x)p
FI(,)f(or)h(applications)g FF(e)e(e)i FI(of)g(one)h(expression)g(to)f
(another.)g(A)h(lam)o(b)q(da-abstraction)150 616 y FF(\025x:e)i
FI(in)o(tro)q(duces)h(the)g(v)n(ariable)f FF(x)f FI(so)i(that)f(it)g
(can)h(o)q(ccur)g(free)g(in)f(the)h(expression)g FF(e)p
FI(,)f(whic)o(h)h(is)f(called)g(the)h FH(b)n(o)n(dy)150
691 y FI(of)g(the)i(lam)o(b)q(da)c(term.)150 774 y(T)o(yp)q(e)g
(systems)g(allo)o(w)e(us)i(to)f(restrict)i(the)g(set)f(of)f(programs)g
(that)g(w)o(e)h(are)g(in)o(terested)i(in)d(\(F)m(or)g(an)h(in)o(tro)q
(duction,)150 849 y(see)16 b([2,)6 b(10,)g(12,)g(36,)g(104].\))13
b(F)m(or)i(example,)e(in)h(the)i(language)e(presen)o(ted)j(ab)q(o)o(v)o
(e,)d(w)o(e)h(migh)o(t)e(not)i(b)q(e)g(in)o(terested)150
924 y(in)g(programs)f(that)i(apply)e(in)o(tegers)i(to)g(other)g
(expressions.)g(Th)o(us,)f(a)g(common)e(restriction)j(on)f(application)
150 998 y(is)f(to)f(allo)o(w)g(only)g(terms)g(that)h(ha)o(v)o(e)g(a)g
FH(function)h(typ)n(e)f FI(to)g(b)q(e)g(applied.)f(T)o(yp)q(es)i(ha)o
(v)o(e)e(the)i(follo)o(wing)c(syn)o(tax:)847 1104 y FF(\034)17
b Fy(2)11 b FF(T)17 b FI(:=)12 b FE(int)19 b Fy(j)f FF(\034)e
Fy(!)11 b FF(\034)150 1199 y FI(The)k(t)o(w)o(o)e(pro)q(ductions)i
(stand)f(for)g(in)o(tegers)h(and)f(for)f(function)h(t)o(yp)q(es,)h
(resp)q(ectiv)o(ely)m(.)f(This)g(simple)f(language)150
1274 y(includes)h(t)o(yp)q(e)h(terms)e(suc)o(h)i(as:)176
1374 y FG({)21 b FE(int)p FI(,)176 1446 y FG({)g FE(int)11
b Fy(!)g FE(int)q FI(,)176 1517 y FG({)21 b FE(int)11
b Fy(!)g FI(\()p FE(int)i Fy(!)e FE(int)p FI(\),)i(usually)g(written)i
(simply)d(as)i FE(int)e Fy(!)f FE(int)h Fy(!)f FE(int)p
FI(,)i(and)176 1589 y FG({)21 b FI(\()p FE(int)12 b Fy(!)f
FE(int)p FI(\))h Fy(!)f FE(int)p FI(.)150 1692 y(T)m(o)h(build)f(a)i(t)
o(yp)q(e)g(system,)e(w)o(e)i(usually)f(also)g(need)h(a)f(notion)g(of)g
(a)g(t)o(yp)q(e)h(en)o(vironmen)o(t)f(\(or)g(t)o(yp)q(e)h(assignmen)o
(t\).)150 1767 y(Suc)o(h)h(en)o(vironmen)o(ts)f(simply)f(asso)q(ciate)j
(v)n(ariable)e(names)g(to)g(t)o(yp)q(es,)i(and)f(can)g(b)q(e)g
(represen)o(ted)j(as)d(follo)o(ws)1877 1752 y FA(1)1894
1767 y FI(:)845 1872 y FF(\000)j Fy(2)11 b FF(D)i FI(:=)f([])17
b Fy(j)11 b FF(x)g FI(:)h FF(\034)5 b FI(;)i FF(\000)150
1968 y FI(A)15 b(t)o(yp)q(e)h(system)f(for)g(the)g FF(\025)h
FI(language)e(can)h(b)q(e)h(sp)q(eci\014ed)h(b)o(y)e(a)g(judgmen)o(t)e
FF(\000)19 b Fy(`)14 b FF(e)g FI(:)f FF(\034)20 b FI(where)d
FF(e)d Fy(2)f FF(E)r FI(,)i FF(\034)j Fy(2)13 b FF(T)6
b FI(,)150 2043 y FF(\000)19 b Fy(2)13 b FF(D)q FI(.)i(In)o(tuitiv)o
(ely)m(,)f(the)h(t)o(yp)q(e)h(judgemen)o(t)e(will)g(asso)q(ciate)i(the)
f(term)g FE(int)p FI(,)g(whic)o(h)g(up)g(un)o(til)f(no)o(w)h(w)o(as)g
(mere)150 2117 y(syn)o(tax,)f(with)f(in)o(tegers,)i(and)f(the)h(t)o(yp)
q(e)f(term)g FF(\034)919 2123 y FA(1)950 2117 y Fy(!)d
FF(\034)1021 2123 y FA(2)1054 2117 y FI(with)j(partial)f(functions)h
(that)g(tak)o(e)h(an)f(argumen)o(t)f(of)150 2192 y(t)o(yp)q(e)g
FF(\034)260 2198 y FA(1)292 2192 y FI(and)g(ma)o(y)e(return)j(a)f
(result)g(of)g(t)o(yp)q(e)g FF(\034)892 2198 y FA(2)924
2192 y FI(\(or)g(div)o(erge\).)g(Because)h(terms)f(can)g(con)o(tain)g
(free)h(v)n(ariables)1891 2177 y FA(2)1908 2192 y FI(,)p
150 2262 237 2 v 158 2289 a Fz(1)188 2305 y FB(T)m(ec)o(hnically)m(,)i
(elemen)o(ts)e(of)f Fx(D)h FB(represen)o(t)g(\(or)f(implemen)o(t\))j
(\014nite)e(mappings)h(of)e(names)h(to)g(t)o(yp)q(es.)f(F)m(or)g(this)h
(imple-)188 2350 y(men)o(tation)f(to)f(b)q(e)g(correct,)f(w)o(e)g(also)
h(need)h(the)e(additional)k(assumption)f(of)d(ha)o(ving)i(a)f(v)n
(ariable)h(o)q(ccur)f(at)g(most)f(once)188 2396 y(in)j(the)f(en)o
(vironmen)o(t.)158 2426 y Fz(2)188 2442 y FB(F)m(ree)k(v)n(ariables)j
(m)o(ust)d(b)q(e)h(addressed)h(ev)o(en)e(if)h(w)o(e)f(are)g
(considering)j(only)f(closed)f(terms.)f(In)g(particular,)i(t)o(yping)
188 2487 y(judgemen)o(ts)14 b(are)e(generally)j(de\014ned)f(b)o(y)e
(induction)k(on)c(the)h(structure)g(of)f(the)h(expression)h(that)f(w)o
(e)f(wish)h(to)f(assign)188 2533 y(a)i(t)o(yp)q(e)g(to.)f(In)h(the)f
(case)h(of)f(lam)o(b)q(da-abstractio)q(n,)j(the)e(judgemen)o(t)g(m)o
(ust)g(go)f(\\under)i(the)f(lam)o(b)q(da".)h(In)e(the)h(b)q(o)q(dy)188
2579 y(of)j(this)h(lam)o(b)q(da-abstraction,)i(the)d(b)q(ound)h(v)n
(ariable)h(in)o(tro)q(duced)g(b)o(y)f(the)f(lam)o(b)q(da)h(is)g(free.)e
(T)m(o)g(giv)o(e)i(a)f(concrete)188 2624 y(example,)d(try)f(to)f(see)h
(what)f(happ)q(ens)j(when)e(w)o(e)f(wish)h(to)g(establish)h(that)f(the)
g(\(closed)h(expression\))g Fx(\025x:x)e FB(has)h(t)o(yp)q(e)188
2670 y Fw(int)d Fn(!)h Fw(int)h FB(under)i(the)f(empt)o(y)g(en)o
(vironmen)o(t)i([].)p eop
%%Page: 53 64
53 63 bop 1882 0 a FB(53)150 192 y FI(the)14 b(t)o(yp)q(e)h(judgemen)o
(t)d(in)o(v)o(olv)o(es)h(an)h(en)o(vironmen)o(t)e(that)i(simply)e(asso)
q(ciates)j(the)f(free)h(v)n(ariables)e(in)g(the)h(giv)o(en)150
266 y(term)f(with)h(a)f(single)h(t)o(yp)q(e.)150 349
y(The)f(t)o(yp)q(e)f(system,)g(or)g(more)f(precisely)m(,)h(the)h(deriv)
n(abilit)o(y)d(of)i(the)h(t)o(yping)e(judgmen)o(t)g(is)h(de\014ned)h(b)
o(y)f(induction)150 424 y(on)i(the)g(structure)i(of)d(the)i(term)e
FF(e)h FI(as)g(follo)o(ws:)p 917 548 175 2 v 917 586
a FF(\000)i Fy(`)c FF(i)g FI(:)f FE(int)1105 558 y FI(In)o(t)355
686 y FF(\000)6 b FI(\()p FF(x)p FI(\))11 b(=)h FF(\034)p
355 715 166 2 v 357 753 a(\000)18 b Fy(`)12 b FF(x)f
FI(:)g FF(\034)535 725 y FI(V)m(ar)681 686 y FF(x)h FI(:)f
FF(\034)763 671 y Fs(0)774 686 y FI(;)c FF(\000)16 b
Fy(`)c FF(e)g FI(:)f FF(\034)p 658 715 316 2 v 658 753
a(\000)16 b Fy(`)c FF(\025x:e)g FI(:)f FF(\034)874 741
y Fs(0)897 753 y Fy(!)g FF(\034)987 725 y FI(Lam)1126
686 y FF(\000)17 b Fy(`)12 b FF(e)1225 692 y FA(2)1255
686 y FI(:)f FF(\034)1301 671 y Fs(0)1354 686 y FF(\000)17
b Fy(`)12 b FF(e)1453 692 y FA(1)1483 686 y FI(:)f FF(\034)1529
671 y Fs(0)1553 686 y Fy(!)g FF(\034)p 1126 715 503 2
v 1265 753 a(\000)17 b Fy(`)12 b FF(e)1364 759 y FA(1)1394
753 y FF(e)1413 759 y FA(2)1444 753 y FI(:)f FF(\034)1642
725 y FI(App)150 842 y(The)h(rule)g(for)f(In)o(tegers)i(\(In)o(t\))f
(sa)o(ys)g(that)f(an)h(in)o(teger)g FF(i)f FI(can)h(ha)o(v)o(e)g(t)o
(yp)q(e)g FE(int)g FI(under)g(all)e(en)o(vironmen)o(ts.)h(The)h(rule)
150 916 y(for)g(v)n(ariables)h(\(V)m(ar\))f(sa)o(ys)h(that)g(a)g(v)n
(ariable)e FF(x)i FI(has)g(t)o(yp)q(e)g FF(\034)18 b
FI(under)13 b(all)f(en)o(vironmen)o(ts)g(where)i FF(x)e
FI(w)o(as)h(b)q(ound)g(to)150 991 y(t)o(yp)q(e)i FF(\034)5
b FI(.)14 b(The)h(rule)g(for)f(lam)o(b)q(da-abstractions)e(\(Lam\))h
(sa)o(ys)i(that)g(an)f(abstraction)h(can)g(ha)o(v)o(e)f(an)g(arro)o(w)g
(t)o(yp)q(e)150 1066 y(from)f FF(\034)272 1051 y Fs(0)298
1066 y FI(to)h FF(\034)19 b FI(under)c(all)e(en)o(vironmen)o(ts)h(as)h
(long)e(as)i(the)g(b)q(o)q(dy)f(of)g(the)h(abstraction)g(can)f(b)q(e)h
(sho)o(wn)g(to)f(ha)o(v)o(e)150 1141 y(t)o(yp)q(e)e FF(\034)k
FI(when)c(the)g(en)o(vironmen)o(t)f(is)g(extended)i(with)e(a)h(binding)
e(of)h(the)h(v)n(ariable)f FF(x)g FI(with)g(the)h(t)o(yp)q(e)g
FF(\034)1750 1125 y Fs(0)1762 1141 y FI(.)f(Finally)m(,)150
1215 y(the)18 b(rule)f(for)f(application)g(\(App\))h(sa)o(ys)g(that)g
(an)g(application)e(can)i(ha)o(v)o(e)g(t)o(yp)q(e)h FF(\034)j
FI(under)d(all)e(en)o(vironmen)o(ts)150 1290 y(where)f(the)g(op)q
(erator)f(can)g(b)q(e)h(sho)o(wn)e(to)h(ha)o(v)o(e)g(t)o(yp)q(e)g
FF(\034)1030 1275 y Fs(0)1053 1290 y Fy(!)d FF(\034)19
b FI(and)14 b(the)g(argumen)o(t)f(to)h(ha)o(v)o(e)f(t)o(yp)q(e)i
FF(\034)1744 1275 y Fs(0)1755 1290 y FI(.)150 1445 y
FG(The)k Fp(\025)p FG(-M)g(Language:)f(T)l(erms)g(and)g(T)o(yp)q(e)h
(System)k FI(The)17 b(\014rst)g(step)h(to)e(extending)h(the)g
FF(\025)g FI(language)150 1520 y(with)d(staging)f(constructs)j(is)d
(adding)g(Brac)o(k)o(ets,)i(Escap)q(e,)g(and)f(Run)1255
1505 y FA(3)1287 1520 y FI(to)g(the)g(syn)o(tax:)627
1638 y FF(e)e Fy(2)f FF(E)i FI(:=)19 b FF(i)g Fy(j)f
FF(x)g Fy(j)g FF(e)7 b(e)19 b Fy(j)f FF(\025x:e)g Fy(j)g(h)p
FF(e)p Fy(i)h(j)g FE(~)q FF(e)12 b Fy(j)18 b FE(run)12
b FF(e:)150 1755 y FI(The)j(second)h(step)f(is)g(extending)g(the)g(t)o
(yp)q(e)g(system.)f(Extending)h(the)g(t)o(yp)q(e)g(system)g(in)o(v)o
(olv)o(es)e(extending)i(the)150 1830 y(t)o(yp)q(e)f(terms)g(to)g
(include)g(a)f(t)o(yp)q(e)i(term)e(for)h(co)q(de:)796
1948 y FF(\034)i Fy(2)11 b FF(T)18 b FI(:=)11 b FF(b)19
b Fy(j)f FF(\034)1051 1954 y FA(1)1081 1948 y Fy(!)11
b FF(\034)1152 1954 y FA(2)1189 1948 y Fy(j)18 b(h)p
FF(\034)5 b Fy(i)150 2056 y FI(W)m(e)13 b(will)e(also)h(need)i(to)f
(extend)h(the)f(t)o(yp)q(e)h(en)o(vironmen)o(ts)e(to)h(k)o(eep)g(trac)o
(k)h(of)e(the)h(lev)o(el)g(at)g(whic)o(h)g(a)f(v)n(ariable)g(is)150
2131 y(b)q(ound.)i(T)m(o)f(represen)o(t)j(en)o(vironmen)o(ts)d(w)o(e)h
(will)f(need)h(a)g(represen)o(tation)h(of)f(the)g(naturals:)858
2249 y FF(n;)7 b(m)k Fy(2)h Fo(N)d FI(:=)j(0)18 b Fy(j)g
FF(n)p FI(+)150 2357 y(With)13 b(a)h(sligh)o(t)f(abuse)h(of)g
(notation,)e(w)o(e)i(will)f(also)g(write:)825 2460 y
FF(n)c FI(+)g(0)92 b(:=)12 b FF(n)825 2535 y(n)d FI(+)g(\()p
FF(m)p FI(+\))k(:=)f(\()p FF(n)d FI(+)g FF(m)p FI(\)+)p
150 2627 237 2 v 158 2654 a Fz(3)188 2670 y FB(W)m(e)i(drop)g(Lift)g
(from)f(the)g(rest)h(of)f(our)h(treatmen)o(t)f(b)q(ecause)i(it)f(do)q
(es)g(not)g(in)o(tro)q(duce)h(an)o(y)f(unexp)q(ected)h(complications.)p
eop
%%Page: 54 65
54 64 bop 1882 0 a FB(54)150 192 y FI(The)12 b(t)o(w)o(o)f(pro)q
(ductions)h(stand)g(for)g(0)f(and)g(for)h(\\next")f(n)o(um)o(b)q(er,)g
(resp)q(ectiv)o(ely)m(.)h(No)o(w)f(w)o(e)h(can)g(presen)o(t)h(the)f(t)o
(yp)q(e)150 266 y(en)o(vironmen)o(ts)h(that)h(will)f(b)q(e)h(used)h
(for)e(t)o(yping)g FF(\025)p FI(-M:)834 387 y FF(\000)k
Fy(2)11 b FF(D)i FI(:=)e([])18 b Fy(j)11 b FF(x)g FI(:)g
FF(\034)1164 371 y Ft(n)1187 387 y FI(;)c FF(\000)150
497 y FI(T)m(o)14 b(b)q(e)i(able)f(to)g(address)i(the)e(issue)h(of)f
(cross-stage)h(safet)o(y)g(in)e(a)h(t)o(yp)q(e)h(system,)e(w)o(e)i(in)o
(tro)q(duce)g(a)e(lev)o(el-index)150 572 y(in)o(to)f(the)i(t)o(yping)e
(judgmen)o(t.)f(The)i(t)o(yp)q(e)h(judgmen)o(t)d(is)i(th)o(us)h
(extended)g(to)f(ha)o(v)o(e)g(the)g(form)e FF(\000)17
b Fy(`)1688 557 y Ft(n)1723 572 y FF(e)12 b FI(:)f FF(\034)19
b FI(where)150 646 y FF(e)12 b Fy(2)f FF(E)r FI(,)i FF(\034)j
Fy(2)c FF(T)6 b FI(,)13 b FF(\000)k Fy(2)11 b FF(D)q
FI(,)i(and)h FF(n)d Fy(2)g FF(N)5 b FI(.)13 b(The)h(judgemen)o(t)f
FF(\000)j Fy(`)1123 631 y Ft(n)1158 646 y FF(e)c FI(:)f
FF(\034)18 b FI(is)c(read)g FH(\\)p FF(e)h FH(has)g(typ)n(e)f
FF(\034)20 b FH(at)14 b(level)g FF(n)h FH(under)150 721
y(envir)n(onment)g FF(\000)6 b FH(")p FI(.)13 b(It)h(is)g(imp)q(ortan)o
(t)e(to)h(note)h(that)g(the)h(lev)o(el)e FF(n)h FI(is)g(part)f(of)h
(the)g(judgemen)o(t)f(and)h FH(not)k FI(part)c(of)150
796 y(the)g(t)o(yp)q(e.)789 901 y FF(\034)25 b Fy(2)11
b FF(T)23 b FI(:=)11 b FF(b)19 b Fy(j)f FF(\034)1058
907 y FA(1)1088 901 y Fy(!)11 b FF(\034)1159 907 y FA(2)1196
901 y Fy(j)18 b(h)p FF(\034)5 b Fy(i)789 976 y FF(\000)17
b Fy(2)11 b FF(D)i FI(:=)e([])18 b Fy(j)11 b FF(x)g FI(:)g
FF(\034)1119 961 y Ft(n)1142 976 y FI(;)c FF(\000)150
1072 y FI(Note)16 b(that)g(w)o(e)f(ha)o(v)o(e)h(also)f(extended)i(t)o
(yp)q(e)f(assignmen)o(ts)f(to)g(k)o(eep)i(trac)o(k)e(of)g(the)i(lev)o
(el)e(at)g(whic)o(h)h(a)f(v)n(ariable)150 1146 y(is)f(b)q(ound.)f(The)h
(lev)o(el)g(index)f(on)h(the)g(judgemen)o(t)f(com)o(bined)f(with)i(the)
g(lev)o(el-annotations)f(on)g(v)n(ariables)g(will)150
1221 y(b)q(e)i(used)f(to)g(reject)h(terms)f(where)h(a)f(v)n(ariable)e
(violates)i(cross-stage)h(safet)o(y)m(.)150 1304 y(The)f(t)o(yp)q(e)h
(judgmen)o(t)d(is)i(de\014ned)h(b)o(y)f(induction)f(on)h(the)g
(structure)i(of)e(the)g(term)f FF(e)h FI(as)g(follo)o(ws)1673
1289 y FA(4)1691 1304 y FI(:)p 905 1438 198 2 v 905 1476
a FF(\000)j Fy(`)973 1464 y Ft(n)1008 1476 y FF(i)11
b FI(:)g FE(int)1117 1448 y FI(In)o(t)270 1576 y FF(\000)6
b FI(\()p FF(x)p FI(\))k(=)i FF(\034)435 1561 y FA(\()p
Ft(n)p Fs(\000)p Ft(m)p FA(\))p 270 1606 270 2 v 313
1644 a FF(\000)k Fy(`)380 1632 y Ft(n)415 1644 y FF(x)11
b FI(:)g FF(\034)553 1615 y FI(V)m(ar)688 1576 y FF(x)g
FI(:)g FF(\034)769 1561 y Fs(0)781 1556 y Ft(n)803 1576
y FI(;)c FF(\000)17 b Fy(`)890 1561 y Ft(n)924 1576 y
FF(e)12 b FI(:)f FF(\034)p 676 1606 338 2 v 676 1644
a(\000)17 b Fy(`)744 1632 y Ft(n)778 1644 y FF(\025x:e)11
b FI(:)g FF(\034)914 1632 y Fs(0)937 1644 y Fy(!)h FF(\034)1027
1615 y FI(Lam)1167 1576 y FF(\000)k Fy(`)1234 1561 y
Ft(n)1269 1576 y FF(e)1288 1582 y FA(2)1318 1576 y FI(:)11
b FF(\034)1364 1561 y Fs(0)1417 1576 y FF(\000)17 b Fy(`)1485
1561 y Ft(n)1520 1576 y FF(e)1539 1582 y FA(1)1569 1576
y FI(:)11 b FF(\034)1615 1561 y Fs(0)1638 1576 y Fy(!)g
FF(\034)p 1167 1606 548 2 v 1317 1644 a(\000)17 b Fy(`)1385
1632 y Ft(n)1419 1644 y FF(e)1438 1650 y FA(1)1469 1644
y FF(e)1488 1650 y FA(2)1518 1644 y FI(:)11 b FF(\034)1728
1615 y FI(App)515 1726 y FF(\000)17 b Fy(`)583 1711 y
Ft(n)p FA(+)643 1726 y FF(e)12 b FI(:)f FF(\034)p 495
1755 244 2 v 495 1793 a(\000)17 b Fy(`)563 1781 y Ft(n)598
1793 y Fy(h)p FF(e)p Fy(i)12 b FI(:)f Fy(h)p FF(\034)5
b Fy(i)753 1765 y FI(Brk)887 1726 y FF(\000)17 b Fy(`)955
1711 y Ft(n)989 1726 y FF(e)12 b FI(:)f Fy(h)p FF(\034)5
b Fy(i)p 879 1755 228 2 v 879 1793 a FF(\000)16 b Fy(`)946
1781 y Ft(n)p FA(+)1008 1793 y FE(~)q FF(e)11 b FI(:)g
FF(\034)1120 1765 y FI(Esc)1259 1726 y FF(\000)17 b Fy(`)1327
1711 y Ft(n)1362 1726 y FF(e)12 b FI(:)f Fy(h)p FF(\034)5
b Fy(i)p 1241 1755 248 2 v 1241 1793 a FF(\000)17 b Fy(`)1309
1781 y Ft(n)1344 1793 y FE(run)12 b FF(e)g FI(:)f FF(\034)1503
1765 y FI(Run)150 1888 y(The)17 b(rule)g(for)g(In)o(tegers)h(\(In)o
(t\))f(allo)o(ws)f(us)h(to)g(assign)f(the)i(t)o(yp)q(e)f
FE(int)g FI(to)g(an)o(y)f(in)o(teger)i FF(i)p FI(,)e(at)h(an)o(y)f(lev)
o(el)h FF(n)p FI(,)f(and)150 1962 y(under)f(an)o(y)e(en)o(vironmen)o(t)
g FF(\000)6 b FI(.)150 2045 y(The)15 b(rule)f(for)g(v)n(ariables)g(\(V)
m(ar\))g(allo)o(ws)f(us)h(to)h(assign)f(an)o(y)f(t)o(yp)q(e)i
FF(\034)k FI(to)14 b(an)o(y)g(v)n(ariable)f FF(x)h FI(at)g(an)o(y)g
(lev)o(el)g FF(n)g FI(under)150 2120 y(an)o(y)h(en)o(vironmen)o(t)e
(where)k FF(x)d FI(has)h(b)q(een)i(asso)q(ciated)e(with)g(the)h(same)e
(t)o(yp)q(e)h FF(\034)20 b FI(and)15 b(with)g(an)o(y)f(lev)o(el)h
FH(less)g(than)150 2195 y(or)g(e)n(qual)g(to)e FF(n)p
FI(.)150 2278 y(The)20 b(rule)h(for)e(lam)o(b)q(da-abstractions)f
(\(Lam\))h(w)o(orks)h(essen)o(tially)g(in)f(the)i(same)e(w)o(a)o(y)g
(as)h(for)g(the)g(lam)o(b)q(da)150 2353 y(language.)d(The)j(notew)o
(orth)o(y)f(di\013erence)h(is)f(that)g(it)f(asso)q(ciates)i(the)f(lev)o
(el)g FF(n)f FI(with)h(the)g(v)n(ariable)f FF(x)g FI(when)150
2427 y(it)e(is)h(used)g(to)f(extend)i(the)f(en)o(vironmen)o(t.)e(The)i
(lam)o(b)q(da)d(rule)j(is)f(the)h(only)f(rule)h(where)g(lev)o(el)g
(bindings)f(are)150 2502 y(in)o(tro)q(duced)f(in)o(to)e(the)h(en)o
(vironmen)o(ts,)f(and)h(is)g(essen)o(tial)g(for)f(ensuring)i
(cross-stage)g(safet)o(y)m(.)p 150 2582 237 2 v 158 2608
a Fz(4)188 2624 y FB(W)m(arning:)g(W)m(e)e(ha)o(v)o(e)g(not)g(y)o(et)g
(pro)o(v)o(ed)g(whether)g(these)g(rules)h(are)f(sound)h(or)f(not.)f
(The)h(soundness)i(of)d(these)h(rules)h(is)188 2670 y(discussed)h(in)f
(Section)h(4.4.2.)p eop
%%Page: 55 66
55 65 bop 1882 0 a FB(55)150 192 y FI(The)13 b(rule)g(for)f
(application)f(\(App\))i(is)f(also)g(essen)o(tially)g(the)h(same)f(as)h
(b)q(efore,)f(the)h(only)f(di\013erence)i(b)q(eing)f(that)150
266 y(w)o(e)h(t)o(yp)q(e)h(the)f(sub)q(expressions)i(under)f(the)f
(same)f(lev)o(el)h FF(n)g FI(as)g(the)g(whole)g(expression.)150
349 y(The)k(rule)h(for)e(Brac)o(k)o(ets)j(\(Bra\))e(\\in)o(tro)q
(duces")h(the)g(co)q(de)f(t)o(yp)q(e,)h(and)e(at)h(the)h(same)e(time,)f
(incremen)o(ts)i(the)150 424 y(lev)o(el)d(at)f(whic)o(h)h(w)o(e)g(t)o
(yp)q(e)h(its)f(sub)q(expression)h(to)f FF(n)p FI(+.)g(This)g(c)o
(hange)g(to)g(the)g(lev)o(el)g(index)g(on)f(the)i(judgemen)o(t)150
499 y(ensures)h(that)e(the)h(lev)o(el-index)e(on)h(our)g(t)o(yp)q(e)h
(system)f(is)g(coun)o(ting)f(the)i(n)o(um)o(b)q(er)e(of)h(surround)h
(Brac)o(k)o(ets)g(for)150 573 y(an)o(y)d(sub)q(expression)j(consisten)o
(tly)m(.)150 656 y(The)d(rule)g(for)f(Escap)q(es)j(\(Esc\))f
(\\eliminates")d(the)i(co)q(de)g(t)o(yp)q(e,)g(and)g(at)f(the)h(same)f
(time,)f(decremen)o(ts)j(the)f(lev)o(el)150 731 y(at)h(whic)o(h)f(w)o
(e)h(t)o(yp)q(e)h(its)e(sub)q(expression)j(to)e FF(n)p
FI(.)f(This)h(c)o(hange)g(to)f(the)i(lev)o(el)e(index)h(on)g(the)g
(judgemen)o(t)f(ensures)150 806 y(that)k(the)g(lev)o(el-index)f(on)h
(our)g(t)o(yp)q(e)g(system)f(is)h(coun)o(ting)f(the)i(n)o(um)o(b)q(er)e
(of)g(surrounding)h(Escap)q(es)h(for)e(an)o(y)150 881
y(sub)q(expression)g(consisten)o(tly)m(.)d(Note)i(that)f(the)g(t)o(yp)q
(e)g(system)g(do)q(es)h(not)f(allo)o(w)e(Escap)q(es)j(to)f(o)q(ccur)h
(at)f(lev)o(el)f(0.)150 964 y(The)k(rule)h(for)e(Run)h(\(Run\))g
(\\eliminates")e(the)i(co)q(de)h(t)o(yp)q(e)g(without)e(an)o(y)h
(constrain)o(ts)g(on)g(the)h(lev)o(el)e(or)h(the)150
1038 y(en)o(vironmen)o(t.)150 1197 y FD(4.2)56 b(A)19
b(Simple)d(Approac)n(h)k(to)e(Impleme)o(n)n(ting)e(a)j(F)-5
b(unctional)19 b(Language)150 1320 y FG(4.2.1)48 b(V)l(alues)150
1436 y FI(An)20 b(elegan)o(t)g(implemen)o(tation)d(of)j(a)g(to)o(y)f
(functional)g(language)h(can)g(b)q(e)h(dev)o(elop)q(ed)g(around)f(a)g
(datat)o(yp)q(e)150 1511 y(con)o(taining)13 b(functions)h(\(See)h(for)f
(example)f([75].\))f(An)i(elemen)o(t)f(of)h(this)g(datat)o(yp)q(e)g
(represen)o(ts)j(the)e FH(value)f FI(of)f(a)150 1585
y(term)g(in)h(the)g(to)o(y)g(functional)f(language.)150
1668 y(A)h(datat)o(yp)q(e)g(con)o(taining)f(functions)h(can)g(b)q(e)g
(declared)h(in)f(SML)g(as)g(follo)o(ws:)221 1783 y FE(datat)o(yp)q(e)h
(value)g(=)f(VI)f(of)g(int)249 b(\(*)14 b(Integer)h(values)f(*\))488
1848 y Fy(j)34 b FE(VF)13 b(of)g(value)i Fy(!)e FE(value)37
b(\(*)14 b(F)o(unction)h(values)g(*\).)150 1957 y FI(This)j(datat)o(yp)
q(e)g(allo)o(ws)f(us)h(to)g(pass)g(around)g(v)n(alues)g(corresp)q
(onding)h(to)f(the)g(in)o(terpretation)h(of)e(functions)150
2032 y(suc)o(h)e(as)168 2148 y(1.)20 b(Iden)o(tit)o(y:)13
b FE(fn)h(x)g Fy(\))f FE(x)p FI(,)168 2223 y(2.)20 b(F)m(unction)13
b(comp)q(osition:)f FE(fn)i(f)f Fy(\))g FE(fn)h(g)g Fy(\))f
FE(fn)h(x)g Fy(\))g FE(f)f(\(g)h(x\))p FI(,)168 2298
y(3.)20 b(Square:)13 b FE(fn)h(x)g Fy(\))g FE(x)g Fy(\003)f
FE(x)p FI(,)h(or)168 2372 y(4.)20 b(F)m(actorial:)12
b FE(fn)i(x)g Fy(\))f FE(x)p FI(!,)g(where)i Fy(\003)f
FI(and)f(!)h(are)g(the)h(in)o(teger)f(m)o(ultiplicatio)o(n)d(and)j
(factorial)f(functions.)150 2489 y(These)i(v)n(alues)f(can)g(b)q(e)g
(represen)o(ted)j(in)c(the)i(datat)o(yp)q(e)f FE(value)p
FI(:)221 2595 y FE(val)f(id)153 b(=)14 b(VF)f(\(fn)h(x)g
Fy(\))g FE(x\);)221 2660 y(val)f(comp)q(ose)34 b(=)14
b(VF)f(\(fn)h(\(VF)g(f)s(\))f Fy(\))h FE(VF)f(\(fn)h(\(VF)f(g\))h
Fy(\))f FE(VF)g(\(fn)h(x)g Fy(\))g FE(f)f(\(g)h(x\)\)\)\);)p
eop
%%Page: 56 67
56 66 bop 1882 0 a FB(56)221 195 y FE(val)13 b(squa)o(re)75
b(=)14 b(VF)f(\(fn)h(\(VI)g(x\))g Fy(\))f FE(\(VI)g(\(x*x\)\)\);)221
260 y(val)g(bang)101 b(=)14 b(let)g(fun)h(fact)f(n)g(=)g(if)f(n=0)i
(then)g(1)f(else)g(n*\(fact)g(\(n-1\))523 325 y(in)g(VF)f(\(fn)h(\(VI)g
(x\))g Fy(\))f FE(\(VI)g(\(fact)h(x\)\)\))h(end.)150
414 y FI(The)f(last)f(example)f(illustrates)h(ho)o(w)g(this)g(enco)q
(ding)g(allo)o(ws)f(us)i(to)f(tak)o(e)g(features)i(of)d(the)i
(meta-language)d(\(in)150 489 y(this)i(case)g(SML\))g(and)g(em)o(b)q
(ed)f(them)g(in)o(to)g(the)h(v)n(alue)f(domain)e(of)i(our)h(to)o(y)f
(ob)r(ject-language.)g(In)h(the)g(factorial)150 564 y(example,)f(w)o(e)
i(are)h(taking)e(adv)n(an)o(tage)g(of)g(the)h(follo)o(wing)e(features)j
(of)e(the)h(meta-language:)176 665 y FG({)21 b FI(recursion,)176
737 y FG({)g FI(conditionals,)176 809 y FG({)g FI(arithmetic)12
b(op)q(erations,)150 914 y(to)i(in)o(tro)q(duce)g(factorial)f(in)o(to)g
(the)i(ob)r(ject-language.)150 1050 y FG(4.2.2)48 b(Expressions)150
1154 y FI(Just)15 b(as)f(w)o(e)h(implemen)o(ted)d(v)n(alues)i(in)f(the)
i(datat)o(yp)q(e)g FE(value)p FI(,)f(a)g(datat)o(yp)q(e)h(to)f(implem)o
(en)o(t)e(the)j(expressions)h(of)150 1229 y(our)e(language)f(can)h(b)q
(e)g(declared)h(in)f(SML)g(as)g(follo)o(ws:)221 1326
y FE(datat)o(yp)q(e)h(exp)g(=)f(EI)f(of)g(int)236 b(\(*)14
b(Integers)g(*\))458 1391 y Fy(j)34 b FE(EA)13 b(of)g(exp)i(*)f(exp)100
b(\(*)14 b(Applications)g(*\))458 1455 y Fy(j)34 b FE(EL)14
b(of)f(string)h(*)g(exp)67 b(\(*)14 b(Lamb)q(da-abstractions)h(*\))458
1520 y Fy(j)34 b FE(EV)13 b(of)g(string)169 b(\(*)14
b(V)o(a)o(riables)f(*\).)150 1615 y FI(Closed)g(terms)h(suc)o(h)g(as)f
FE(fn)h(x)f Fy(\))g FE(x)g FI(and)h FE(fn)f(f)g Fy(\))g
FE(fn)g(g)g Fy(\))g FE(fn)h(x)f Fy(\))g FE(f)g(\(g)g(x\))h
FI(can)f(b)q(e)h(enco)q(ded)h(in)o(to)e(the)h(datat)o(yp)q(e)150
1690 y FE(exp)h FI(as)f(follo)o(ws:)221 1787 y FE(val)f(ID)166
b(=)14 b(EL)g(\("x",)f(EV)h("x"\);)221 1852 y(val)f(COMPOSE)8
b(=)14 b(EL)g(\("f",)f(EL)h(\("g",)f(EL)h(\("x",)f(EA)g(\(EV)h("f",)e
(EA)i(\(EV)f("g",)g(EV)g("x"\)\)\)\)\).)150 1947 y FI(There)21
b(are)g(no)f(closed)h(terms)f(in)g(the)g(syn)o(tax)h(of)e(our)h(\(t)o
(yp)q(ed\))i(ob)r(ject-language)e(that)g(can)g(express)i(the)150
2021 y(functions)16 b FE(squa)o(re)h FI(and)f FE(bang)623
2006 y FA(5)642 2021 y FI(.)g(Ho)o(w)o(ev)o(er,)g(w)o(e)g(will)f(see)i
(ho)o(w)f(they)g(can)h(expressed)h(as)e(op)q(en)h(terms)e(using)h(a)150
2096 y(su\016cien)o(tly)e(ric)o(h)g(en)o(vironmen)o(t.)150
2232 y FG(4.2.3)48 b(En)o(vironmen)o(t)o(s)150 2337 y
FI(The)13 b(job)g(of)f(our)h(in)o(terpreter)i(will)c(b)q(e)j(to)e(tak)o
(e)h(terms)g(suc)o(h)h(as)f FE(ID)f FI(and)h FE(COMPOSE)e
FI(and)i(pro)q(duce)h(the)f(v)n(alues)150 2411 y FE(id)f
FI(and)f FE(comp)q(ose)p FI(,)g(resp)q(ectiv)o(ely)m(.)h(W)m(e)f(can)h
(write)f(a)g(v)o(ery)h(concise)h(in)o(terpreter)g FE(ev0)f
FI(ha)o(ving)e(the)i(follo)o(wing)d(t)o(yp)q(e:)867 2513
y FE(exp)j Fy(!)f FE(env)i Fy(!)e FE(value)p 150 2582
237 2 v 158 2608 a Fz(5)188 2624 y FB(W)m(e)k(are)g(not)f(a)o(w)o(are)h
(of)f(an)o(y)h(pro)q(of)g(of)f(this)i(statemen)o(t.)e(Negativ)o(e)i
(results)f(on)g(expressivit)o(y)i(are)e(generally)i(a)d(sub-)188
2670 y(stan)o(tial)h(c)o(hallenge.)g(Th)o(us)e(the)h(reader)f(should)i
(tak)o(e)e(this)h(statemen)o(t)f(as)h(nothing)g(more)f(than)h
(folklore.)p eop
%%Page: 57 68
57 67 bop 1882 0 a FB(57)150 192 y FI(where)15 b FE(env)f
FI(is)f(the)h(t)o(yp)q(e)g(of)f(an)g(en)o(vironmen)o(t.)f(The)i(en)o
(vironmen)o(t)e(asso)q(ciates)j(a)e(v)n(alue)g(to)g(eac)o(h)h(free)g(v)
n(ariable)150 266 y(in)j(the)h(expression)h(b)q(eing)f(ev)n(aluated.)f
(F)m(or)g(simplicit)o(y)m(,)d(w)o(e)k(will)e(tak)o(e)i
FE(env)g FI(to)g(simply)d(b)q(e)k FE(string)e Fy(!)h
FE(value)p FI(,)150 341 y(that)f(is,)g(w)o(e)h(will)e(represen)o(t)j
(en)o(vironmen)o(ts)e(b)o(y)g(a)g(function)g(that)h(tak)o(es)g(a)f(v)n
(ariable)f(name)g(and)h(returns)i(a)150 416 y(v)n(alue.)14
b(All)g(w)o(e)h(need)h(to)e(supp)q(ort)i(this)f(simple)e(implemen)o
(tation)f(of)i(en)o(vironmen)o(ts)g(is)h(to)g(de\014ne)h(the)f(empt)o
(y)150 490 y(en)o(vironmen)o(t,)d(and)i(an)g(en)o(vironmen)o(t)f
(extension)h(function:)221 578 y FE(exception)h(NotBound)221
643 y(val)e(env0)i(=)f(fn)g(x)g Fy(\))f FE(raise)i(NotBound)221
772 y(fun)f(ext)g(env)h(x)f(v)g(=)g(fn)g(y)g Fy(\))g
FE(if)f(x=y)h(then)i(v)e(else)g(env)h(y)m(.)150 858 y
FI(The)e(empt)o(y)e(en)o(vironmen)o(t)g(is)h(a)g(function)f(that)i(tak)
o(es)f(a)g(v)n(ariable)f(and)h(raises)h(an)f(exception)h(to)f(indicate)
g(that)150 933 y(this)j(v)n(ariable)e(is)i(not)f(b)q(ound.)h(Raising)e
(this)i(exception)g(is)g(one)g(of)f(the)h(w)o(a)o(ys)f(in)g(whic)o(h)h
(our)g(seman)o(tics)f(\\can)150 1008 y(go)g FF(W)6 b(r)q(ong)q
FI(")15 b(and)f(it)g(is)h(the)g(role)g(of)f(the)h(t)o(yp)q(e)g(system)g
(to)f(ensure)i(that)f(an)o(y)f(w)o(ell-t)o(yp)q(ed)h(program)e(do)q(es)
i(not)150 1083 y(go)e(wrong)h(when)g(it)g(is)g(b)q(eing)f(ev)n(aluated)
h(\(or)g(in)o(terpreted\).)150 1166 y(The)20 b(en)o(vironmen)o(t)e
(extension)i(function)f(tak)o(es)h(an)f(en)o(vironmen)o(t,)f(a)h(v)n
(ariable)g(name,)e(and)j(a)f(v)n(alue,)f(and)150 1240
y(returns)j(a)f(new)h(function)e(of)g(t)o(yp)q(e)i FE(string)f
Fy(!)f FE(value)i FI(\(whic)o(h)f(is)g(the)h(new)f(en)o(vironmen)o
(t\).)e(This)i(function)150 1315 y(returns)15 b FE(v)f
FI(when)h(it)e(is)h(applied)f(to)h FE(x)g FI(and)g(returns)h
FE(env)g FI(applied)e(to)h FE(y)g FI(otherwise.)150 1448
y FG(4.2.4)48 b(In)o(terpretati)o(on)150 1549 y FI(W)m(e)13
b(can)i(no)o(w)e(de\014ne)i(a)f(CBV)g(in)o(terpreter)i(for)d(the)i
FF(\025)f FI(language)f(in)g(a)h(mere)f(six)h(lines:)221
1637 y FE(fun)g(ev0)g(env)h(e)f(=)221 1701 y(\(case)g(e)h(of)275
1766 y(EI)e(i)h Fy(\))f FE(VI)g(i)237 1831 y Fy(j)26
b FE(EA)13 b(\(e1,e2\))h Fy(\))g FE(\(case)h(\(ev0)f(env)h(e1,)e(ev0)i
(env)f(e2\))h(of)e(\(VF)g(f,)g(v\))h Fy(\))g FE(f)f(v\))237
1896 y Fy(j)26 b FE(EL)14 b(\(x,e1\))g Fy(\))g FE(VF)f(\(fn)h(v)g
Fy(\))f FE(ev0)h(\(ext)h(env)g(x)f(v\))g(e1\))237 1960
y Fy(j)26 b FE(EV)13 b(x)h Fy(\))g FE(env)h(x\).)150
2047 y FI(This)f(in)o(terpreter)i(is)f(easy)f(to)g(use.)h(By)g
(equational)e(reasoning)h(at)g(the)h(lev)o(el)f(of)g(the)h
(meta-language)d(\(SML\),)150 2121 y(w)o(e)g(can)f(see)i(that)e(the)h
(in)o(terpretation)g(for)f FE(ID)g FI(and)g FE(COMPOSE)e
FI(under)k(the)f(empt)o(y)e(en)o(vironmen)o(t)g FE(env0)i
FI(should)150 2196 y(pro)q(duce)j(the)f(v)n(alues)g FE(id)g
FI(and)g FE(comp)q(ose)p FI(,)f(resp)q(ectiv)o(ely)m(.)h(But)g(b)q
(ecause)i(these)f(v)n(alues)f(con)o(tain)f(function)h(t)o(yp)q(es,)150
2271 y(they)k(are)g(not)f(prin)o(table,)g(so)g(w)o(e)h(cannot)f(\\see")
i(the)f(output.)f(W)m(e)g(can,)g(ho)o(w)o(ev)o(er,)g(see)i(the)f
(output)g(of)e(the)150 2346 y(in)o(terpreter)h(when)f(the)g(result)g
(is)f(an)g(in)o(teger.)g(F)m(or)g(example,)f(w)o(e)h(w)o(ould)g(exp)q
(ect)h(the)g(ob)r(ject-term)g FE(\(fn)f(x)g Fy(\))150
2420 y FE(x\))g(5)g FI(to)f(ev)n(aluate)h(to)g FE(5)p
FI(.)f(The)h(enco)q(ding)g(of)f(the)i(term)e(is)g(simply)f
FE(EA)i(\(ID,)e(EI)i(5\))p FI(.)f(Applying)g(the)h(in)o(terpreter)150
2495 y FE(ev0)f FI(to)g(this)g(term)f(under)i(the)f(empt)o(y)f(en)o
(vironmen)o(t)g FE(env0)i FI(pro)q(duces)g(the)g(exp)q(ected)h(result:)
221 2583 y FE(-)d(ev0)h(env1)h(\(EA)f(\(EL)g(\("x",EV)e("x"\),)i(EI)f
(5\)\);)221 2647 y(val)g(it)h(=)g(VI)f(5)h(:)f(value.)p
eop
%%Page: 58 69
58 68 bop 1882 0 a FB(58)150 192 y FG(4.2.5)48 b(In)o(tro)q(ducing)12
b(Constan)o(ts)150 308 y FI(The)19 b(implemen)o(tation)d(tec)o(hnique)j
(describ)q(ed)i(ab)q(o)o(v)o(e)e(is)f(app)q(ealing,)g(partly)g(b)q
(ecause)j(it)d(allo)o(ws)g(us)h(to)g(in-)150 382 y(tro)q(duce)h(a)e
(ric)o(h)g(set)h(of)f(constan)o(ts)h(in)o(to)f(our)g(language)f(b)o(y)h
(simply)f(extending)h(the)h(en)o(vironmen)o(t,)e(rather)150
457 y(than)f(mo)q(difying)e(the)j(in)o(terpreter)h(itself.)d(Suc)o(h)i
(constan)o(ts)g(can)g(include)g(an)f(addition)f(function)h(or)g(ev)o
(en)h(a)150 532 y(\014xed-p)q(oin)o(t)d(op)q(erator)g(\(allo)o(wing)e
(us)i(to)g(implemen)o(t)d(recursion\).)150 615 y(W)m(e)j(can)h(easily)f
(extend)i(the)f(ob)r(ject-language)f(without)g(mo)q(difying)e(the)j
(syn)o(tax,)f(the)h(set)h(of)e(v)n(alues,)g(or)g(the)150
690 y(in)o(terpreter)k(itself.)d(A)h(lot)f(of)g(expressivit)o(y)i(can)f
(b)q(e)g(added)g(to)g(the)h(ob)r(ject-language)e(b)o(y)h(simply)e
(extending)150 764 y(the)g(initial)d(en)o(vironmen)o(t)g(under)j(whic)o
(h)f(the)h(terms)e(of)h(the)g(language)f(are)i(ev)n(aluated.)e(F)m(or)g
(example,)g(w)o(e)h(can)150 839 y(de\014ne)i(the)f(follo)o(wing)e
(meta-lev)o(el)g(constan)o(ts:)221 954 y FE(val)h(plus)43
b(=)14 b(VF)f(\(fn)h(\(VI)f(x\))h Fy(\))g FE(VF)f(\(fn)h(\(VI)f(y\))h
Fy(\))g FE(VI)f(\(x+y\)\)\);)221 1018 y(val)g(minus)c(=)14
b(VF)f(\(fn)h(\(VI)f(x\))h Fy(\))g FE(VF)f(\(fn)h(\(VI)f(y\))h
Fy(\))g FE(VI)f(\(x-y\)\)\);)221 1083 y(val)g(times)18
b(=)c(VF)f(\(fn)h(\(VI)f(x\))h Fy(\))g FE(VF)f(\(fn)h(\(VI)f(y\))h
Fy(\))g FE(VI)f(\(x*y\)\)\).)150 1193 y FI(With)i(these)h(constan)o
(ts,)g(w)o(e)f(can)h(express)h(terms)e(that)g(ev)n(aluate)g(to)g
FE(squa)o(re)p FI(.)h(Suc)o(h)g(terms)f(can)g(con)o(tain)g(free)150
1267 y(v)n(ariables)e(that)i(are)f(b)q(ound)h(in)e(an)h(extended)i(en)o
(vironmen)o(t.)d(F)m(or)g(example,)g(w)o(e)h(can)h(construct)g(an)f(en)
o(viron-)150 1342 y(men)o(t)f(binding)g(a)g(v)n(ariable)g(called)h
FE(*)f FI(to)h(the)h(function)e(v)n(alue)g FE(times)p
FI(:)221 1448 y FE(val)g(env1)i(=)f(ext)h(env0)f("*")f(times.)150
1550 y FI(W)m(e)g(enco)q(de)j(the)e(term)f FE(fn)h(x)g
Fy(\))g FE(x*x)g FI(using)f(the)i(follo)o(wing)c(op)q(en)j(term)1280
1535 y FA(6)1298 1550 y FI(:)221 1656 y FE(val)f(SQUARE)g(=)h(EL)g
(\("x",)f(EA)g(\(EA)h(\(EV)f("*",)g(EV)g("x"\),)g(EV)h("x"\)\).)150
1757 y FI(No)o(w)g(w)o(e)g(can)g(use)g FE(ev0)h FI(to)e(ev)n(aluate)h
FE(squa)o(re)h(5)p FI(:)221 1863 y FE(-)e(ev0)h(env0)h(\(EA)f
(\(SQUARE,)d(EI)j(5\)\);)221 1928 y(val)f(it)h(=)g(VI)f(25)h(:)f
(value.)150 2029 y FI(Whic)o(h)g(pro)q(duces)j(an)e(enco)q(ding)g(of)f
(the)h(in)o(teger)h(v)n(alue)e(25,)g(as)h(exp)q(ected.)150
2187 y FG(In)o(tro)q(ducing)j(Conditional)o(s)g(through)h(a)i(Constan)o
(t)k FI(W)m(e)17 b(can)h(in)o(tro)q(duce)h(a)e(conditional)f(statemen)o
(t)150 2262 y(in)o(to)11 b(the)h(language)f(through)h(a)f(constan)o(t.)
h(In)g(general,)f(the)i(use)f(of)f(conditional)g(statemen)o(ts)h(can)g
(b)q(e)g(replaced)150 2337 y(b)o(y)i(using)f(the)i(follo)o(wing)c
(function:)221 2443 y FE(val)i(Z)i(=)f(fn)g(n)g Fy(\))f
FE(fn)h(tf)g Fy(\))f FE(fn)h(\013)g Fy(\))g FE(if)f(n=0)h(then)h(tf)f
(0)g(else)g(\013)g(n.)p 150 2534 237 2 v 158 2561 a Fz(6)188
2577 y FB(Our)h(con)o(v)o(en)o(tion)h(is)f(that)g Fw(x*y)f
FB(is)h(syn)o(tactic)g(sugar)g(for)g Fw(\(*)f(x\))g(y)p
FB(,)f(where)i Fw(*)f FB(is)h(a)f(free)h(v)n(ariable.)h(This)f(con)o(v)
o(en)o(tion)h(is)188 2623 y(di\013eren)o(t)g(from)f(the)f(SML)h(con)o
(v)o(en)o(tion)h(where)f(the)f(same)h(term)f(is)h(syn)o(tactic)h(sugar)
f(for)f Fw(*)h(\(x,y\))p FB(.)e(Using)i(the)f(SML)188
2669 y(con)o(v)o(en)o(tion)h(w)o(ould)f(require)h(in)o(tro)q(ducing)h
(tuples)e(or)f(at)g(least)h(pairs)g(in)o(to)g(our)f(to)o(y)g(language.)
p eop
%%Page: 59 70
59 69 bop 1882 0 a FB(59)150 192 y FI(This)13 b(function)g(tak)o(es)g
(an)g(in)o(teger)g FE(n)p FI(,)g(a)g(function)g(from)e(in)o(tegers)j
(to)f(b)q(o)q(oleans,)f(and)h(a)g(second)h(function)f(from)150
266 y(in)o(tegers)i(to)g(b)q(o)q(oleans.)f(If)g(the)h(in)o(teger)g(is)f
(0,)g(it)g(is)h(simply)d(passed)k(to)e(the)h(\014rst)g(function)1589
251 y FA(7)1622 266 y FI(and)g(the)g(result)g(is)150
341 y(returned.)f(Otherwise,)g(the)g(in)o(teger)g(is)f(passed)h(to)f
(the)g(second)i(function)d(and)h(the)h(result)g(is)f(returned.)h(So,)e
(in)150 416 y(general,)i(w)o(e)g(can)g(replace)h(an)o(y)e(expression)
794 519 y FE(case)i FF(e)900 525 y FA(1)933 519 y FE(of)e(0)h
Fy(\))f FF(e)1089 525 y FA(2)1122 519 y Fy(j)g FE(n)h
Fy(\))g FF(e)1257 525 y FA(3)150 623 y FI(b)o(y)g(an)f(expression)i
(with)f(one)g(less)h(conditional)d(statemen)o(t:)774
727 y FE(Z)i FF(e)832 733 y FA(1)865 727 y FE(\(fn)g(0)g
Fy(\))f FF(e)1038 733 y FA(2)1057 727 y FE(\))h(\(fn)g(n)g
Fy(\))g FF(e)1261 733 y FA(3)1280 727 y FE(\))150 839
y FI(The)g(function)g FE(Z)g FI(can)g(b)q(e)h(represen)o(ted)h(in)e
(the)g(datat)o(yp)q(e)g FE(value)h FI(as:)221 933 y FE(val)e(ifzero)h
(=)g(VF)g(\(fn)g(\(VI)f(n\))h Fy(\))g FE(VF)f(\(fn)h(\(VF)f(tf)s(\))h
Fy(\))f FE(VF)g(\(fn)h(\(VF)g(\013)s(\))g Fy(\))f FE(if)g(n=0)i(then)g
(tf)e(\(VI)h(0\))1517 998 y(else)g(\013)g(\(VI)g(n\)\)\)\).)150
1154 y FG(In)o(tro)q(ducing)g(Recursion)h(through)f(a)k(Constan)o(t)i
FI(Recursion)c(can)f(also)f(b)q(e)i(in)o(tro)q(duced)g(in)o(to)e(the)i
(lan-)150 1229 y(guage)e(through)g(a)f(\014xed-p)q(oin)o(t)h(function)
817 1213 y FA(8)835 1229 y FI(.)g(In)f(essence,)j(the)f(function)f(w)o
(e)g(need)h(is)1488 1213 y FA(9)1506 1229 y FI(:)221
1322 y FE(val)e(Y)h(=)g(let)g(fun)h(Y')e(f)g(=)h(f)g(\(fn)g(v)g
Fy(\))f FE(\(Y')g(f)s(\))h(v\))g(in)g(Y')f(end.)150 1414
y FI(No)o(w,)g(a)h(declaration:)892 1517 y FE(fun)g(f)f(n)i(=)f
FF(:::)e FE(f)i FF(:::)150 1621 y FI(can)g(b)q(e)h(replaced)f(b)o(y)g
(another)g(declaration)g(con)o(taining)f(one)h(few)o(er)g(recursiv)o(e)
i(expression:)741 1725 y FE(val)e(f)g(=)g(Y)f(\(fn)h(f)g
Fy(\))f FE(fn)h(n)h Fy(\))e FF(:::)f FE(f)i FF(:::)p
FE(\))150 1829 y FI(The)g(function)g FE(Y)f FI(can)i(b)q(e)f(implemen)o
(ted)e(in)h(the)i(datat)o(yp)q(e)f FE(value)g FI(as:)221
1923 y FE(val)f(recur)j(=)e(let)g(fun)h(recur')g(\(VF)e(f)s(\))h(=)557
1987 y(f)f(\(VF)h(\(fn)g(v)g Fy(\))681 2052 y FE(case)g(\(recur')h
(\(VF)f(f)s(\)\))f(of)h(VF)f(fp)h Fy(\))f FE(fp)h(v\)\))440
2117 y(in)g(VF)f(recur')i(end.)150 2208 y FI(No)o(w,)d(equipp)q(ed)i
(with)f(a)g(w)o(a)o(y)f(of)g(expressing)j(conditionals)d(and)g
(recursion,)i(w)o(e)g(can)f(express)i(a)d(wide)i(v)n(ariet)o(y)150
2283 y(of)f(in)o(teresting)i(programs)d(in)i(our)g(to)o(y)f(functional)
g(language.)p 150 2353 237 2 v 158 2380 a Fz(7)188 2396
y FB(If)c(our)h(meta-language)i(\(SML\))e(and)g(our)g(to)o(y)g
(language)h(w)o(ere)f(CBN)f(rather)h(than)g(CBV,)f(the)g(conditional)k
(statemen)o(t)188 2442 y(w)o(ould)g(ha)o(v)o(e)g(b)q(een)g(sligh)o(tly)
h(simpler.)g(In)e(particular,)h(w)o(e)f(w)o(ould)h(not)f(need)h(to)f
(pass)g(the)g(0)g(to)g(the)h(\014rst)f(function.)h(In)188
2487 y(a)g(CBV)g(language,)i(this)f(otherwise)g(obsolete)g(argumen)o(t)
g(is)g(needed)g(to)f(main)o(tain)i(correct)e(termination)i(b)q(eha)o
(vior.)188 2533 y(But)g(b)q(ecause)g(b)q(oth)g(the)f(MetaML)g(implemen)
o(tation)k(and)c(SML)h(are)f(CBV,)f(w)o(e)h(c)o(hose)h(the)f
(de\014nitions)j(presen)o(ted)188 2579 y(in)d(this)g(c)o(hapter.)158
2608 y Fz(8)188 2624 y FB(Again,)g(in)g(a)f(CBN)f(setting,)i(the)f
(de\014nition)j(of)d(the)g(\014xed-p)q(oin)o(t)i(op)q(erator)f(w)o
(ould)g(ha)o(v)o(e)f(b)q(een)h(sligh)o(tly)i(simpler.)158
2654 y Fz(9)188 2670 y Fw(Y)d FB(is)g(the)h(name)f(usually)i(used)f
(for)f(the)g(\014xed-p)q(oin)o(t)i(com)o(binator,)f(of)f(whic)o(h)h
(this)g(function)g(is)g(an)f(instance.)p eop
%%Page: 60 71
60 70 bop 1882 0 a FB(60)150 192 y FG(4.2.6)48 b(Expressing)14
b(and)h(Executing)f(the)h FE(h)h FG(F)l(unction)150 296
y FI(The)g FE(h1)g FI(function)g(of)f(Section)h(4.1.1)e(can)j(b)q(e)f
(expressed)i(in)e(our)g(language.)e(T)m(o)h(demonstrate)h(this,)f(w)o
(e)h(will)150 370 y(\014rst)i(sho)o(w)g(ho)o(w)f(w)o(e)h(can)g
(construct)h(an)e(en)o(vironmen)o(t)g(that)h(con)o(tains)f(all)f(the)j
(necessary)g(ingredien)o(ts)f(for)150 445 y(expressing)c(this)f
(function,)f(and)g(then)h(w)o(e)g(will)f(sho)o(w)g(ho)o(w)h(eac)o(h)g
(use)g(of)f(a)h(non-)p FF(\025)f FI(construct)j(can)e(b)q(e)g(replaced)
150 520 y(b)o(y)h(the)g(use)h(of)e(a)h(constan)o(t)g(from)e(this)i(en)o
(vironmen)o(t.)150 603 y(All)h(the)i(meta-lev)o(el)e(concepts)j(presen)
o(ted)g(ab)q(o)o(v)o(e)e(can)g(b)q(e)h(in)o(tro)q(duced)g(directly)g
(in)o(to)e(the)i(ob)r(ject-language)150 677 y(b)o(y)d(including)f(them)
g(in)g(the)i(initial)c(en)o(vironmen)o(t:)221 774 y FE(val)i(env1)i(=)f
(ext)h(\(ext)f(\(ext)h(\(ext)f(\(ext)h(env0)f("+")g(plus\))h("-")e
(minus\))h("*")f(times\))g("Z")h(ifzero\))g("Y")f(recur.)150
868 y FI(Giv)o(en)i(this)g(extended)i(en)o(vironmen)o(t,)d(w)o(e)i(can)
f(express)i(and)f(ev)n(aluate)f(terms)g(suc)o(h)h(as)f(the)h
FE(h)g FI(function)f(dis-)150 943 y(cussed)d(ab)q(o)o(v)o(e.)d(The)h
(in)o(teresting)h(part)f(of)f(this)h(task)h(is)e(enco)q(ding)i(the)f
(term)f(in)o(to)h(our)g(represen)o(tation)h(of)f(terms.)150
1017 y(In)k(a)h(complete)e(in)o(terpreter,)j(this)f(enco)q(ding)g(is)f
(p)q(erformed)g(b)o(y)g(a)g(parser.)i(Here)f(w)o(e)g(do)f(it)g(b)o(y)g
(clarifying)f(the)150 1092 y(mec)o(hanics)g(of)h(the)g(in)o(terpreter.)
h(The)g(original)d(declaration)h(w)o(as:)221 1183 y FE(fun)h(h1)g(n)g
(z)g(=)g(if)g(n=0)g(then)h(z)f(else)h(\(fn)f(x)g Fy(\))f
FE(\(h1)h(\(n-1\))g(\(x+z\)\)\))h(n.)150 1272 y FI(T)m(o)c(a)o(v)o(oid)
g(the)i(need)g(for)f(tuples)h(in)e(our)h(language,)f(w)o(e)i(minim)o(i)
o(ze)d(the)j(parameters)f(of)g(the)h(recursiv)o(e)g(function)150
1347 y(declaration)h(to)f(the)i(one)f(that)g(the)g(recursion)h(really)f
(dep)q(ends)h(on:)221 1438 y FE(fun)f(h1)g(n)g(=)g(fn)g(z)g
Fy(\))g FE(if)f(n=0)h(then)i(z)d(else)i(\(fn)f(x)g Fy(\))f
FE(\(h1)i(\(n-1\))f(\(x+z\)\)\))h(n.)150 1527 y FI(Using)f(the)g
FE(Y)g FI(function)f(w)o(e)h(turn)h(recursion)g(in)o(to)e(lam)o(b)q(da)
e(abstractions,)j(applications,)f(and)g(a)h(conditional:)221
1618 y FE(val)f(h1)h(=)h(Y)e(\(fn)h(h1')g Fy(\))f FE(fn)h(n)g
Fy(\))g FE(fn)g(z)g Fy(\))f FE(if)g(n=0)i(then)g(z)f(else)614
1683 y(\(fn)g(x)g Fy(\))g FE(\(h1')f(\(n-1\))h(\(x+z\)\)\))h(n\).)150
1772 y FI(Similarly)l(,)g(using)k(the)g(function)g FE(Z)p
FI(,)f(w)o(e)h(turn)g(the)h FE(if)p FI(-statemen)o(t)e(used)h(in)g(the)
g(function)g FE(h1)f FI(in)o(to)g(lam)o(b)q(da-)150 1847
y(abstractions)c(and)g(applications:)221 1938 y FE(val)f(h1)h(=)h(Y)e
(\(fn)h(h1')g Fy(\))f FE(fn)h(n)g Fy(\))g FE(fn)g(z)g
Fy(\))662 2002 y FE(Z)g(n)h(\(fn)p 803 2002 13 2 v 42
w Fy(\))f FE(z\))g(\(fn)g(n)g Fy(\))g FE(\(fn)g(x)g Fy(\))f
FE(\(h1')h(\(n-1\))g(\(x+z\)\)\))h(n\)\).)150 2091 y
FI(Finally)m(,)h(w)o(e)i(enco)q(de)h(this)f(SML)h(program)d(in)o(to)h
(the)i(datat)o(yp)q(e)f(for)g(represen)o(ting)i(the)f(syn)o(tax)f(of)f
(our)h(to)o(y)150 2166 y(language:)221 2257 y FE(-)13
b(val)h(H1)g(=)g(EA)g(\(EV)f("Y",)g(EL)h(\("h1'",)e FF(:::)p
FE(\)\);)221 2387 y(-)h(val)h(IT)g(=)g(EA)f(\(EA)h(\(H1,)f(EI)g(3\),)h
(EI)f(4\);)221 2516 y(-)g(val)h(answ)o(er)h(=)f(ev0)g(env1)h(IT;)221
2581 y(val)e(answ)o(er)i(=)g(VI)e(10)g(:)g(value.)150
2670 y FI(where)i(the)g(\014nal)e(result)h(represen)o(ts)j(the)d(in)o
(teger)h(v)n(alue)e(10.)p eop
%%Page: 61 72
61 71 bop 1882 0 a FB(61)150 192 y FD(4.3)56 b(Extending)17
b(the)h(Simple)f(Implem)o(en)n(tation)e(with)k(Staging)g(Annotations)
150 324 y FI(The)11 b(\014rst)g(t)o(w)o(o)f(implemen)o(tations)e(of)h
(MetaML)i(w)o(ere)h(based)f(on)f(an)g(in)o(terpreter)j(similar)8
b(to)i(the)h(one)g(presen)o(ted)150 399 y(ab)q(o)o(v)o(e.)17
b(The)h(h)o(yp)q(othesis)g(w)o(as)g(that)f(w)o(e)h(can)g(in)o(tro)q
(duce)g(staging)f(constructs)j(in)o(to)c(the)j(language)d(without)150
474 y(adding)g(to)q(o)g(m)o(uc)o(h)g(complexit)o(y)f(to)i(the)g(in)o
(terpreter.)h(In)f(this)g(section,)g(w)o(e)g(will)e(discuss)j(what)f
(is)f(in)o(v)o(olv)o(ed)150 549 y(in)f(extending)h(this)g(simple)e
(implemen)o(tatio)o(n)f(with)i(MetaML's)h(staging)f(annotations.)g(W)m
(e)g(will)f(sho)o(w)i(that)150 623 y(a)i(n)o(um)o(b)q(er)f(of)g(subtle)
i(problems)e(arise,)h(some)f(of)g(whic)o(h)h(are)g(not)g(easily)f
(addressed.)j(The)e(signi\014cance)h(of)150 698 y(these)14
b(di\016culties)e(comes)g(from)e(the)j(fact)f(that)h(extending)f(an)g
(existing)g(implemen)o(tation)d(of)j(a)g(programmi)o(ng)150
773 y(language)f(to)g(include)h(staging)f(annotations)g(is)g(protot)o
(ypical)g(of)g(ho)o(w)g(m)o(ulti-stage)e(languages)i(are)h(dev)o(elop)q
(ed)150 847 y(in)g(practice)i(\(See)f(for)f(example)g([3,)5
b(26,)h(84,)g(97].\))11 b(As)i(suc)o(h,)g(the)g(existence)i(of)d(these)
h(problems)f(underlines)h(the)150 922 y(p)q(oten)o(tial)f(dangers)h(of)
e(this)h(widespread)i(practice)f(and)f(the)h(imp)q(ortance)e(of)h
(studying)g(the)h(formal)c(seman)o(tics)150 997 y(of)k(m)o(ulti-stage)f
(languages.)150 1145 y FG(4.3.1)48 b(V)l(alues)15 b(and)g(Expressions)
150 1261 y FI(T)m(o)i(extend)h(the)g(in)o(terpreter)h(to)e(deal)g(with)
g(a)g(m)o(ulti-stage)e(language)i(suc)o(h)h(as)f FF(\025)p
FI(-M)g(of)g(Section)h(4.1.2,)d(w)o(e)150 1336 y(m)o(ust)f(enric)o(h)j
(the)f(expression)g(datat)o(yp)q(e)g FE(exp)g FI(with)g(new)g(v)n
(arian)o(ts)e(to)i(represen)o(t)h(the)g(constructs)g(Brac)o(k)o(ets,)
150 1410 y(Escap)q(e,)f(Run,)f(and)g(cross-stage)i(p)q(ersisten)o(t)g
(constan)o(ts.)f(W)m(e)f(m)o(ust)f(also)h(enric)o(h)h(the)g(v)n(alue)f
(datat)o(yp)q(e)g FE(value)150 1485 y FI(with)e(a)h(v)n(arian)o(t)f(to)
g(represen)o(t)j(co)q(de)f(fragmen)o(ts.)d(The)i(de\014nitions)g(of)f
FE(exp)i FI(and)f FE(value)g FI(will)f(no)o(w)g(b)q(e)i(m)o(utually)150
1560 y(recursiv)o(e)g(b)q(ecause)h(w)o(e)e(can)g(ha)o(v)o(e)g
(expressions)h(in)f(v)n(alues)f(and)h(v)n(alues)g(in)f(expressions:)221
1666 y FE(datat)o(yp)q(e)i(exp)139 b(=)14 b(EI)f(of)h(int)263
b(\(*)14 b(Integers)g(*\))582 1731 y Fy(j)34 b FE(EA)14
b(of)f(exp)i(*)e(exp)128 b(\(*)14 b(Applications)g(*\))582
1795 y Fy(j)34 b FE(EL)14 b(of)g(string)g(*)f(exp)95
b(\(*)14 b(Lamb)q(da-abstractions)h(*\))582 1860 y Fy(j)34
b FE(EV)14 b(of)f(string)196 b(\(*)14 b(V)o(a)o(riables)g(*\))582
1925 y Fy(j)34 b FE(EB)14 b(of)f(exp)235 b(\(*)14 b(Brack)o(ets)g(*\))
582 1990 y Fy(j)34 b FE(ES)14 b(of)f(exp)240 b(\(*)14
b(Escap)q(e)h(*\))582 2055 y Fy(j)34 b FE(ER)14 b(of)f(exp)236
b(\(*)14 b(Run)g(*\))582 2119 y Fy(j)34 b FE(EC)13 b(of)h(value)206
b(\(*)14 b(Cross-stage)f(constants)h(*\))221 2249 y(and)102
b(value)109 b(=)14 b(VI)f(of)h(int)260 b(\(*)14 b(Integer)g(V)o(alues)g
(*\))582 2314 y Fy(j)34 b FE(VF)13 b(of)h(value)g Fy(!)g
FE(value)48 b(\(*)14 b(F)o(unction)h(V)o(alues)f(*\))582
2378 y Fy(j)34 b FE(V)o(C)13 b(of)g(exp;)223 b(\(*)14
b(Exp)o(ressions)g(\(object-co)q(de\))j(*\).)150 2480
y FI(W)m(e)c(no)o(w)h(ha)o(v)o(e)g(all)e(the)j(infrastructure)g
(necessary)h(for)e(de\014ning)f(an)h(in)o(terpretation)g(function.)p
eop
%%Page: 62 73
62 72 bop 1882 0 a FB(62)150 192 y FG(4.3.2)48 b(En)o(vironmen)o(t)o(s)
13 b(and)i(Bound)g(V)l(ariable)f(Renaming)150 293 y FI(T)m(o)i(address)
j(the)e(renaming)f(problem)g(describ)q(ed)j(in)d(the)i(Section)g
(4.1.1,)d(the)i(extended)i(in)o(terpreter)g(m)o(ust)150
368 y(explicitly)14 b(rename)g(b)q(ound)h(v)n(ariables)f(in)h(ob)r
(ject-programs.)e(One)j(w)o(a)o(y)e(of)g(p)q(erforming)g(the)h
(renaming)e(is)i(to)150 443 y(use)k(the)g(en)o(vironmen)o(t)e(to)h
(carry)h(the)f(new)h(names)e(that)i(w)o(e)f(assign)g(to)g(ob)r
(ject-lev)o(el)g(b)q(ound)h(v)n(ariables)e(at)150 517
y(run-time.)c(This)h(tec)o(hnique)h(is)f(used)i(in)d(the)i(in)o
(terpreter)h(of)e(Jones)h FH(et)g(al.)f FI([40].)f(T)m(o)g(p)q(erform)h
(this)g(renaming,)150 592 y(w)o(e)g(use)h(a)e(stateful)h(function)g
FE(NextV)o(a)o(r)g FI(that)g(computes)g(a)g(\\new)g(name")e(for)i(a)f
(v)n(ariable:)221 680 y FE(val)g(ctr)i(=)f(ref)g(0;)221
810 y(fun)g(NextV)o(a)o(r)g(s)g(=)g(let)g(val)p 644 810
13 2 v 43 w(=)g(\(ctr)h(:=)e(\(!ctr)i(+1\)\))f(in)h(s)p
Fy(^)p FE(\(Integer.mak)o(estring)e(\(!ctr\)\))i(end.)150
897 y FI(T)m(o)j(distinguish)g(b)q(et)o(w)o(een)i(the)f(instances)g
(when)h(w)o(e)e(are)h(using)f(the)i(en)o(vironmen)o(t)d(to)h(carry)i
(around)e(real)150 972 y(v)n(alues)d(and)g(when)g(w)o(e)h(are)f(simply)
e(using)i(it)g(to)g(implem)o(en)o(t)e(renaming,)g(w)o(e)i(generalize)h
(our)f(in)o(terpreter)i(b)o(y)150 1046 y(w)o(eak)o(ening)c(the)g(t)o
(yp)q(e)g(of)g(en)o(vironmen)o(ts.)e(One)j(w)o(a)o(y)e(of)h(ac)o
(hieving)f(this)h(w)o(eak)o(ening)f(is)h(b)o(y)g(c)o(hanging)f(the)h(t)
o(yp)q(e)150 1121 y(of)d(the)h(en)o(vironmen)o(t)f(to)g
FE(string)h Fy(!)f FE(exp)i FI(instead)f(of)f FE(string)h
Fy(!)f FE(value)p FI(.)h(This)g(c)o(hange)g(in)f(t)o(yp)q(es)h(is)g
(not)f(to)q(o)h(drastic,)150 1196 y(as)k(our)g(datat)o(yp)q(es)h
FE(exp)g FI(and)e FE(val)h FI(are)h(m)o(utually)c(recursiv)o(e,)k(and)f
(are)g(essen)o(tially)g(of)g(the)g(same)f(expressivit)o(y)m(.)150
1270 y(Using)j FE(exp)h FI(instead)g(of)f FE(val)g FI(simply)e(mak)o
(es)h(our)i(in)o(terpreter)h(more)d(concise.)i(No)o(w,)f(normal)e
(bindings)i(of)f(a)150 1345 y(name)d FE(x)h FI(to)f(a)h(v)n(alue)f
FE(v)h FI(will)f(b)q(e)h(replaced)h(b)o(y)f(bindings)f(to)h(the)g
(expression)h FE(EC)e(v)p FI(.)150 1428 y(F)m(or)18 b(reasons)h(that)f
(will)e(b)q(ecome)i(apparen)o(t)h(in)e(the)i(next)f(section,)h(it)e
(will)g(also)g(b)q(e)i(useful)f(to)g(c)o(hange)g(the)150
1503 y(default)12 b(b)q(eha)o(vior)g(of)f(the)i(empt)o(y)e(en)o
(vironmen)o(t)h(on)g(v)n(ariables.)f(In)h(particular,)f(the)i(empt)o(y)
e(en)o(vironmen)o(t)g(will)150 1578 y(no)o(w)i(simply)f(return)j(a)f(v)
n(ariable)f(expression)i(for)e(an)o(y)h(v)n(ariable:)221
1666 y FE(fun)g(env0)h(x)f(=)g(EV)f(x.)150 1753 y FI(No)o(w,)f(w)o(e)i
(extend)g(our)g(in)o(terpretation)f(function)g(to)g(deal)h(with)e(Brac)
o(k)o(ets,)j(Run,)d(and)h(cross-stage)i(constan)o(ts)150
1827 y(as)f(follo)o(ws:)221 1916 y FE(fun)g(ev1)g(env)h(e)f(=)221
1980 y(\(case)g(e)h(of)275 2045 y(EI)e(i)h Fy(\))f FE(VI)g(i)237
2110 y Fy(j)26 b FE(EA)13 b(\(e1,e2\))h Fy(\))g FE(\(case)h(\(ev1)f
(env)h(e1,)e(ev1)i(env)f(e2\))h(of)e(\(VF)g(f,)g(v\))h
Fy(\))g FE(f)f(v\))237 2175 y Fy(j)26 b FE(EL)14 b(\(x,e1\))g
Fy(\))g FE(VF)f(\(fn)h(v)g Fy(\))f FE(ev1)h(\(ext)h(env)g(x)f(\(EC)f
(v\)\))h(e1\))237 2239 y Fy(j)26 b FE(EV)13 b(x)h Fy(\))g
FE(\(case)g(\(env)h(x\))g(of)e(EC)g(v)h Fy(\))f FE(v\))237
2304 y Fy(j)26 b FE(EB)13 b(e1)h Fy(\))g FE(V)o(C)f(\(eb1)h(1)g(env)h
(e1\))237 2369 y Fy(j)26 b FE(ER)14 b(e1)g Fy(\))f FE(\(case)i(\(ev1)f
(env)h(e1\))f(of)f(V)o(C)g(e2)h Fy(\))g FE(ev1)g(env0)g(e2\))237
2434 y Fy(j)26 b FE(EC)13 b(v)h Fy(\))g FE(v\).)150 2521
y FI(The)f(\014rst)h(four)e(cases)j(are)e(essen)o(tially)g(the)g(same)f
(as)h(b)q(efore.)g(The)g(only)f(di\013erence)j(is)e(that)g(the)g(v)n
(ariable)f(case)150 2595 y(requires)18 b(the)f(v)n(ariable)f(to)g(b)q
(e)i(asso)q(ciated)f(with)f(a)h(constan)o(t)g(in)f(the)h(en)o(vironmen)
o(t.)e(If)i(the)g(v)n(ariable)f(is)g(not)150 2670 y(asso)q(ciated)f
(with)e(a)h(constan)o(t,)g(a)f(run-time)g(error)i(o)q(ccurs.)p
eop
%%Page: 63 74
63 73 bop 1882 0 a FB(63)150 192 y FI(W)m(e)12 b(p)q(ostp)q(one)h
(explaining)e(the)i(case)g(of)f(Brac)o(k)o(ets)i(momen)o(taril)o(y)m(,)
9 b(as)j(their)h(in)o(terpretation)g(uses)g(the)g(rebuild-)150
266 y(ing)h(function)g FE(eb1)p FI(.)h(Note)g(also)f(that)h(there)h(is)
e(no)h(case)h(for)e(Escap)q(es,)i(b)q(ecause)g(Escap)q(es)h(are)e(not)f
(treated)i(b)o(y)150 341 y(the)e(ev)n(aluation)f(function,)g(but)h
(rather,)g(the)h(rebuilding)e(function.)150 424 y(The)h(case)g(of)e
(Run)h(is)g(in)o(terpreted)i(b)o(y)e(\014rst)h(in)o(terpreting)g(the)g
(argumen)o(t)e(to)h(get)h(a)e(co)q(de)j(fragmen)o(t)c(and)i(then)150
499 y(re-in)o(terpreting)i(this)e(co)q(de)i(fragmen)o(t)d(in)h(the)h
(empt)o(y)e(en)o(vironmen)o(t.)g(Cross-stage)j(p)q(ersisten)o(t)g
(constan)o(ts)g(are)150 573 y(in)o(terpreted)h(as)e(simply)d(the)k(v)n
(alue)e(they)h(carry)m(.)150 656 y(The)i(case)g(of)f(Brac)o(k)o(ets)i
(mak)o(es)d(a)h(call)g(to)g(a)g FH(r)n(ebuilding)g FI(function)g
FE(eb1)p FI(.)h(The)g(primary)d(role)j(of)e(rebuilding)h(is)150
731 y(to)g(ev)n(aluate)f(an)o(y)h(Escap)q(es)h(at)f(lev)o(el)g(1.)f(Ev)
n(aluating)f(Escap)q(es)k(is)d(p)q(erformed)h(b)o(y)g(tra)o(v)o(ersing)
g(the)g(inside)g(of)f(a)150 806 y(Brac)o(k)o(eted)g(expression)f(un)o
(til)f(a)g(lev)o(el)g(1)g(Escap)q(e)h(is)g(encoun)o(tered,)g(at)g(whic)
o(h)f(p)q(oin)o(t,)f(the)i(Escap)q(ed)h(expression)150
881 y(is)f(ev)n(aluated,)f(and)h(the)h(result)g(of)e(this)i(ev)n
(aluation)d(is)i(\\spliced-in)o(to")f(the)i(curren)o(t)h(con)o(text.)e
(The)h(rebuilding)150 955 y(function)g FE(eb1)g FI(is)g(de\014ned)h(in)
e(m)o(utual)f(recursion)j(with)f FE(ev1)p FI(:)221 1062
y FE(and)g(eb1)h(n)f(env)h(e)f(=)221 1126 y(\(case)g(e)h(of)275
1191 y(EI)e(i)h Fy(\))f FE(EI)h(i)237 1256 y Fy(j)26
b FE(EA)13 b(\(e1,e2\))h Fy(\))g FE(EA)f(\(eb1)i(n)f(env)h(e1,)e(eb1)i
(n)f(env)h(e2\))237 1321 y Fy(j)26 b FE(EL)14 b(\(x,e1\))g
Fy(\))g FE(let)g(val)g(x')f(=)h(NextV)o(a)o(r)h(x)f(in)g(EL)g(\(x',)f
(eb1)i(n)f(\(ext)g(env)h(x)f(\(EV)g(\(x'\)\)\))g(e1\))g(end)237
1385 y Fy(j)26 b FE(EV)13 b(y)h Fy(\))g FE(env)h(y)237
1450 y Fy(j)26 b FE(EB)13 b(e1)h Fy(\))g FE(EB)f(\(eb1)i(\(n+1\))f(env)
h(e1\))237 1515 y Fy(j)26 b FE(ES)14 b(e1)g Fy(\))f FE(\(if)h(n=1)g
(then)h(\(case)g(\(ev1)f(env)h(e1\))f(of)g(V)o(C)f(e)h
Fy(\))f FE(e\))i(else)f(ES)g(\(eb1)h(\(n-1\))f(env)h(e1\)\))237
1580 y Fy(j)26 b FE(ER)14 b(e1)g Fy(\))f FE(ER)g(\(eb1)i(n)f(env)h
(e1\))237 1644 y Fy(j)26 b FE(EC)13 b(v)h Fy(\))g FE(EC)f(v\).)150
1746 y FI(The)h(parameter)g FE(n)g FI(is)f(the)i(lev)o(el)e(of)g(the)h
(expression)h(b)q(eing)f(rebuilt.)f(Rebuilding)f(in)o(teger)j
(expressions)g(lea)o(v)o(es)150 1820 y(them)h(unc)o(hanged.)g
(Rebuilding)f(all)h(other)h(expressions)h(\(except)g(Escap)q(e)g(at)f
(lev)o(el)f(1\))g(in)o(v)o(olv)o(es)g(rebuilding)150
1895 y(the)e(sub)q(expressions)h(with)e(an)g(appropriate)g(correction)h
(to)f(the)h(lev)o(el)e(parameter.)h(F)m(or)f(example,)g(rebuilding)150
1970 y(the)j(sub)q(expression)h(of)d(a)h(Brac)o(k)o(et)h(expression)h
(requires)f(adding)e(one)i(to)f(the)g(lev)o(el.)g(Rebuilding)e(the)j
(sub)q(ex-)150 2045 y(pressions)j(of)f(an)g(Escap)q(e)h(at)f(lev)o(el)g
(higher)g(than)g(1)g(requires)h(subtracting)g(one)f(from)f(the)h(lev)o
(el.)g(The)g(lev)o(el)150 2119 y(parameter)d(is)h(nev)o(er)h(c)o
(hanged)f(otherwise.)g(Because)i(of)d(the)h(w)o(a)o(y)f(w)o(e)h(c)o
(hose)h(to)e(t)o(yp)q(e)i(our)e(en)o(vironmen)o(t,)f(re-)150
2194 y(building)d(v)n(ariables)h(w)o(orks)g(in)g(a)g(simple)f(w)o(a)o
(y:)g(If)h(the)h(en)o(vironmen)o(t)e(is)h(carrying)h(a)f(new)g(name,)f
(then)i(it)f(simply)150 2269 y(replaces)i(the)g(old)f(one.)f(If)h(the)h
(en)o(vironmen)o(t)e(is)h(carrying)g(a)g(\\real")f(v)n(alue,)g(then)i
(it)f(is)g(already)f(equipp)q(ed)i(with)150 2343 y(a)g(surround)h
FE(EC)p FI(,)e(whic)o(h)h(is)g(exactly)h(the)g(form)d(w)o(e)j(need)g
(to)f(ha)o(v)o(e)g(a)g(v)n(alue)g(so)g(that)g(it)g(can)h(replace)g(a)f
(v)n(ariable)150 2418 y(in)g(an)h(expression.)150 2501
y(Rebuilding)g(a)h(lam)o(b)q(da)e(term)i(in)o(v)o(olv)o(es)f(pro)q
(ducing)i(a)f(new)h(name)e(for)h(the)h(b)q(ound)f(v)n(ariable)f(and)i
(extending)150 2576 y(the)e(en)o(vironmen)o(t)e(with)g(this)i(new)f
(name)f(so)h(that)g(the)h(old)f(name)e(is)i(replaced)h(with)f(the)h
(new)f(one)h(when)f(it)g(is)150 2651 y(encoun)o(tered.)p
eop
%%Page: 64 75
64 74 bop 1882 0 a FB(64)150 192 y FG(4.3.3)48 b(In)o(tro)q(ducing)12
b(Constan)o(ts)150 305 y FI(W)m(e)17 b(can)h(use)g(extended)h(initial)d
(en)o(vironmen)o(ts)h(in)g(essen)o(tially)g(the)i(same)d(manner)h(as)h
(b)q(efore.)f(T)m(o)g(accom-)150 380 y(mo)q(date)e(the)i(c)o(hange)g
(in)f(the)h(t)o(yp)q(e)f(of)g(en)o(vironmen)o(ts,)f(w)o(e)i(mo)q(dify)d
(the)j(w)o(a)o(y)e(w)o(e)i(extend)g(the)g(en)o(vironmen)o(t)150
454 y(sligh)o(tly:)221 564 y FE(val)c(env1)i(=)f(ext)h(\(ext)f(\(ext)h
(\(ext)f(\(ext)h(env0)442 629 y("+")e(\(EC)h(plus\)\))442
694 y("-")31 b(\(EC)14 b(minus\)\))442 759 y("*")24 b(\(EC)14
b(times\)\))442 824 y("Z")20 b(\(EC)14 b(ifzero\)\))442
888 y("Y")j(\(EC)d(recur\).)150 994 y FI(Ev)n(aluating)e(the)j(enco)q
(ding)f(of)f FE(h1)h(4)g(4)f FI(pro)q(duces)j(exactly)e(the)g(same)f
(result)i(as)f(b)q(efore.)150 1139 y FG(4.3.4)48 b(Expressing)14
b(and)h(Executing)f(the)h(Staged)g FE(h)h FG(F)l(unction)150
1252 y FI(No)o(w)e(w)o(e)g(can)g(express)h(the)g(staged)f
FE(h)h FI(function)e(in)h(our)g(to)o(y)f(language:)221
1355 y FE(fun)h(h2)g(n)g(z)g(=)g(if)g(n=0)g(then)h(z)f(else)h
Fy(h)p FE(\(fn)f(x)g Fy(\))g FE(~)q(\(h2)h(\(n-1\))f
Fy(h)g FE(x+\()28 b(z\))p Fy(i)p FE(\))14 b(\))g(1)p
Fy(i)p FE(.)150 1453 y FI(W)m(e)f(mo)q(dify)f(this)i(de\014nition)f
(sligh)o(tly)g(to)h(mak)o(e)e(it)i(amenable)e(to)i(enco)q(ding)g(in)o
(to)f FE(exp)p FI(:)221 1556 y FE(val)g(h2)h(=)h(Y)e(\(fn)h(h2')g
Fy(\))f FE(fn)h(n)g Fy(\))g FE(fn)g(z)g Fy(\))662 1621
y FE(Z)g(n)h(\(fn)p 803 1621 13 2 v 42 w Fy(\))f FE(z\))737
1685 y(\(fn)g(n)g Fy(\))f(h)p FE(\(fn)i(x)f Fy(\))g FE(~)q(\(h2')g
(\(n-1\))g Fy(h)p FE(x+)h(~)q(z)p Fy(i)p FE(\)\))g(n)f
Fy(i)p FE(\)\).)150 1784 y FI(No)o(w)f(the)h(de\014nition)f(con)o
(tains)g(only)g(applications,)f(abstraction,)h(v)n(ariables,)f(and)i
(in)o(tegers,)f(all)g(of)f(whic)o(h)i(w)o(e)150 1858
y(can)i(express)i(in)e(the)h(syn)o(tax)f(of)f(our)i(language.)d(It)j
(also)e(con)o(tains)h(the)h(free)g(v)n(ariables)e FE(Y)p
FI(,)h FE(Z)p FI(,)g(and)g FE(+)p FI(,)g(all)f(of)150
1933 y(whic)o(h)e(w)o(e)g(already)g(kno)o(w)f(ho)o(w)h(to)g(include)g
(in)g(the)g(initial)f(en)o(vironmen)o(t.)f(The)j(enco)q(ding)f(of)f
(this)h(function)g(is)150 2008 y(essen)o(tially:)221
2111 y FE(-)g(val)h(H2)g(=)g(EA)g(\(EV)f("Y",)g(EL)h(\("h2'",)e
FF(:::)h FE(\)\);)221 2240 y(-)g(val)h(IT)g(=)g(EA)f(\(EA)h(\(H2,)f(EI)
g(3\),)h(EB)f(\(EI)g(4\)\);)221 2370 y(-)g(val)h(answ)o(er)h(=)f(ev1)g
(env1)h(IT;)221 2434 y(val)e(it)h(=)g(V)o(C)f(\(EA)h(\(EL)g(\("x1",EA)e
(\(EL)j(\("x2",EA)d FF(:::)p FE(\),EI)f(2\)\),EI)i(3\)\))h(:)f(value.)
150 2533 y FI(corresp)q(onding)i(to)f(the)g(result)h(w)o(e)f(exp)q
(ected:)221 2635 y Fy(h)p FE(\(fn)g(x)320 2641 y FA(1)352
2635 y Fy(\))g FE(\(\(fn)g(x)507 2641 y FA(2)540 2635
y Fy(\))f FE(\(\(fn)h(x)694 2641 y FA(3)727 2635 y Fy(\))f
FE(x)801 2641 y FA(3)820 2635 y FE(+\(x)887 2641 y FA(2)906
2635 y FE(+\(x)973 2641 y FA(1)992 2635 y FE(+4\)\)\))i(1\)\))f(2\)\))f
(3)p Fy(i)p FE(.)p eop
%%Page: 65 76
65 75 bop 1882 0 a FB(65)150 192 y FD(4.4)56 b(New)18
b(Concerns)150 324 y FI(One)h(of)f(our)h(h)o(yp)q(otheses)h(is)f(that)g
(studying)f(the)h(formal)d(seman)o(tics)j(of)f(MetaML)h(can)g(impro)o
(v)o(e)d(our)j(un-)150 399 y(derstanding)c(of)f(this)h(language,)f(and)
g(in)g(turn,)h(allo)o(w)e(us)i(to)g(impro)o(v)o(e)e(implemen)o(tatio)o
(ns)f(of)j(MetaML.)f(It)h(is)150 474 y(di\016cult)10
b(to)g(explain)g(accurately)i(ho)o(w)e(studying)h(the)g(formal)d(seman)
o(tics)i(of)g(a)h(language)e(enhances)k(our)d(under-)150
549 y(standing)j(of)g(ho)o(w)g(the)h(language)e(can)i(and)f(should)g(b)
q(e)h(implemen)o(ted.)c(In)k(some)e(cases,)i(studying)f(the)h(formal)
150 623 y(seman)o(tics)e(helps)h(us)f(solv)o(e)g(problems)g(and)g(in)f
(other)i(cases,)h(it)d(helps)i(us)g(iden)o(tify)e(problems.)g(Dev)o
(eloping)g(the)150 698 y(t)o(yp)q(e)k(systems)f(presen)o(ted)j(in)d
(the)h(rest)g(of)f(this)g(dissertation)h(are)g(examples)e(of)h(where)h
(our)g(study)g(help)q(ed)g(us)150 773 y(solv)o(e)h(a)f(problem.)f(It)i
(has)g(also)f(b)q(een)i(the)g(case)g(that)e(our)h(scrutin)o(y)h(of)e
(the)h(MetaML)h(implem)o(en)o(tation)c(has)150 847 y(brough)o(t)e(to)g
(ligh)o(t)g(previously)g(unkno)o(wn)g(problems.)e(This)j(section)g
(describ)q(es)h(t)o(w)o(o)e(new)h(anomalies)d(iden)o(ti\014ed)150
922 y(in)15 b(the)i(course)g(of)e(our)h(study)m(,)f(and)h(whic)o(h)f
(constitute)i(ample)d(justi\014cation)i(for)f(the)h(pursuit)h(of)e(a)g
(rigorous)150 997 y(seman)o(tics)e(of)h(MetaML.)150 1145
y FG(4.4.1)48 b(Scoping,)14 b(Cross-Stage)g(P)o(ersistence,)f(and)j
(Hidden)d(F)l(ree-V)l(ariables)150 1261 y FI(Cross-stage)h(p)q
(ersistence)i(gets)e(in)f(the)h(w)o(a)o(y)e(of)h(the)h(b)q(ound-v)n
(ariable)e(renaming)f(strategy)j(used)g(in)f(the)h(in)o(ter-)150
1336 y(preter)h(ab)q(o)o(v)o(e.)d(In)h(particular,)g
FE(ev1)g FI(p)q(erforms)g(renaming)e(using)i(the)h(rebuilding)e
(function)h(itself.)g(This)g(usage)150 1410 y(of)i(rebuilding)g(is)h(a)
f(limited)f(kind)h(of)g(substitution,)g(namely)f(one)i(v)n(ariable)f
(name)g(for)g(another.)h(But)g(cross-)150 1485 y(stage)i(p)q(ersisten)o
(t)h(constan)o(ts)g(can)f(b)q(e)g(functions.)f(Because)j(w)o(e)d
(cannot)h(\\tra)o(v)o(erse")h(functions,)e(rebuilding)150
1560 y(do)q(es)g(not)f(\\go)g(inside")g(cross-stage)i(p)q(ersisten)o(t)
g(constan)o(ts.)e(Th)o(us,)h(the)f(renaming)f(strategy)i(fails.)e(W)m
(e)h(call)150 1634 y(this)e(the)g FH(hidden)i(fr)n(e)n(e-variable)g
FI(problem.)150 1792 y FG(Ho)o(w)i(did)d(the)h(F)l(ormal)g(Seman)o
(tics)f(Help?)g(\(I\))22 b FI(Iden)o(tifying)14 b(this)h(failure)f
(came)g(as)h(a)g(direct)h(result)g(of)150 1867 y(studying)g(the)i
(formal)c(seman)o(tics)i(of)g(MetaML.)g(W)m(e)g(observ)o(ed)i(this)f
(problem)e(while)h(dev)o(eloping)g(an)g(early)150 1942
y(v)o(ersion)11 b(of)g(the)h(reduction)g(seman)o(tics)f(presen)o(ted)i
(in)e(Chapter)h(6.)f(W)m(e)g(ma)o(y)e(ha)o(v)o(e)i(run)h(in)o(to)e(a)h
(similar)e(problem)150 2016 y(while)14 b(testing)h(the)h(existing)e
(implemen)o(tation,)d(but)k(when)g(examining)e(an)h(implemen)o(tation)e
(that)j(do)q(es)g(not)150 2091 y(\(y)o(et\))g(ha)o(v)o(e)g(an)f(asso)q
(ciated)i(formal)c(sp)q(eci\014cation,)j(it)g(is)f(hard)h(to)g
(distinguish)f(b)q(et)o(w)o(een)i(what)f(is)f(merely)g(an)150
2166 y(implemen)o(tatio)o(n)d(mistak)o(e)h(and)h(what)h(is)f(a)g(more)f
(fundamen)o(tal)g(problem)g(with)h(our)g(understanding)i(of)d(ho)o(w)
150 2240 y(the)i(language)e FH(should)i FI(b)q(e)f(implemen)o(ted.)e
(The)j(reduction)f(seman)o(tics)g(allo)o(w)o(ed)f(us)i(to)f(see)h
(clearly)f(that)g(using)150 2315 y(functions)g(to)h(represen)o(t)h(the)
f(v)n(alues)f(of)g(functions)g(can)h(mak)o(e)e(p)q(erforming)g(the)h
(renaming)f(di\016cult.)g(Indeed,)150 2390 y(shortly)h(after)h(making)d
(this)j(observ)n(ation,)f(w)o(e)g(syn)o(thesised)i(the)f(follo)o(wing)d
(concrete)16 b(coun)o(ter-example)d(that)150 2465 y(caused)i(the)f
(MetaML)h(implem)o(en)o(tation)c(to)j(exhibit)f(anomalous)f(b)q(eha)o
(vior:)221 2571 y FE(-)h(val)h(puzzle)h(=)f Fy(h)q FE(fn)g(a)f
Fy(\))i FE(~)q(\(\(fn)f(x)g Fy(\))f(h)p FE(x)p Fy(i)q
FE(\))h(\(fn)g(x)g Fy(\))f(h)p FE(a)p Fy(i)p FE(\)\))h(0)p
Fy(i)p FE(;)221 2636 y(-)f(\(run)g(puzzle\))i(5.)p eop
%%Page: 66 77
66 76 bop 1882 0 a FB(66)150 192 y FI(As)20 b(w)o(e)f(will)f(see)j(in)e
(the)h(rest)h(of)d(the)i(dissertation,)g(the)g(term)f(is)g(w)o(ell)f(t)
o(yp)q(ed,)i(and)f(under)h(fairly)e(simple)150 266 y(sp)q
(eci\014cations)f(of)e(MetaML)h(seman)o(tics,)e(should)i(ev)n(aluate)f
(to)h Fy(h)p FE(5)p Fy(i)p FI(.)f(In)g(the)i(implem)o(en)o(tations)c
(ho)o(w)o(ev)o(er,)j(w)o(e)150 341 y(get)e(a)g(di\013eren)o(t)h
(result.)150 424 y(T)m(o)f(see)i(the)f(problem,)e(note)i(that)g(the)g
(Escap)q(ed)h(computation)d(constructs)k(a)d(co)q(de)i(fragmen)o(t)d
(con)o(taining)g(a)150 499 y(cross-stage)g(p)q(ersisten)o(t)h
(function,)c(whic)o(h)i(itself)f(con)o(tains)h(a)f(dynamic)f(v)n
(ariable)h(in)g(its)h(b)q(o)q(dy)m(.)e(Th)o(us,)i(the)g(co)q(de)150
573 y(fragmen)o(t)i(w)o(e)h(get)h(bac)o(k)f(to)g(\\splice")g(in)o(to)g
(con)o(text)h(con)o(tains)f(a)g(cross-stage)i(p)q(ersisten)o(t)g
(constan)o(t)f(carrying)150 648 y(a)f(v)n(alue)g(that)h(itself)f(con)o
(tains)g(a)g(free)i(ob)r(ject-lev)o(el)f(v)n(ariable.)d(The)j
(conceptual)h(error)f(in)f(the)h(design)g(of)f FE(ev1)150
723 y FI(and)j FE(eb1)g FI(w)o(as)g(that)g(w)o(e)g(assumed)f(that)h(v)n
(alues)g(carried)g(b)o(y)g(cross-stage)h(p)q(ersisten)o(t)h(constan)o
(ts)e(are)h(\\fully)150 798 y(dev)o(elop)q(ed")14 b(in)g(the)g(sense)i
(that)e(they)g(do)g(not)g(need)g(further)h(pro)q(cessing.)150
881 y(The)h(function)g FE(ev1)g FI(is)g(a)g(faithful)e(mo)q(del)g(of)h
(the)i(implemen)o(tatio)o(ns,)c(and)j(so)g(w)o(e)g(will)f(use)h
FE(ev1)g FI(to)g(illustrate)150 955 y FE(puzzle)g FI(problem.)e(The)h
(application)f(of)g(the)i(result)f(of)g(Running)f(the)h
FE(puzzle)i FI(on)e(5)f(presen)o(ted)j(ab)q(o)o(v)o(e)e(can)g(b)q(e)150
1030 y(enco)q(ded)g(and)f(ev)n(aluated)g(as)g(follo)o(ws:)221
1122 y FE(-)f(val)h(PUZZLE)g(=)g
(\(EA\(ER\(EB\(EL\("a",EA\(ES\(EA\(EL\("x",EB\(EV)c("x"\)\),)540
1187 y(EL\("x",EB)j(\(EV)h("a"\)\)\)\),)f(EI)g(0\)\)\)\),)h(EI)f
(5\)\);)221 1316 y(-)g(ev1)h(env0)h(PUZZLE)221 1381 y(val)e(it)h(=)g(V)
o(C)f(\(EV)h("a1"\))f(:)g(value.)150 1472 y FI(The)18
b(obscure)g(result)g(represen)o(ts)i Fy(h)p FE(a)746
1478 y FA(1)764 1472 y Fy(i)p FI(:)d(A)g(b)q(ound)g(v)n(ariable)f(has)h
(escap)q(ed)i(from)c(the)j(scop)q(e)g(of)f(its)g(binding)150
1546 y(abstraction.)c(This)g(anomaly)e(should)i(not)h(o)q(ccur)g(in)f
(a)g(statically)g(scop)q(ed)h(language,)e(where)j(all)d(o)q(ccurrences)
150 1621 y(of)h(a)h(v)n(ariable)f(should)g(remain)g(syn)o(tactically)g
(inside)h(the)g(scop)q(e)h(of)f(their)g(binder.)150 1764
y FG(Ho)o(w)g(did)e(the)h(F)l(ormal)g(Seman)o(tics)e(Help?)h(\(I)q(I\))
19 b FI(In)12 b(the)g(next)h(section,)f(w)o(e)g(presen)o(t)i(a)e
(curren)o(t)h(prop)q(osal)150 1838 y(for)d(mo)q(difying)e(the)k
(implemen)o(tati)o(on)c(to)j(deal)f(with)h(this)g(problem.)e(This)i
(prop)q(osal)f(is)h(based)g(primarily)e(on)h(an)150 1913
y(op)q(erational)h(view)i(of)e(ho)o(w)h FF(\025)p FI(-M)g(implemen)o
(tation)d(presen)o(ted)14 b(in)e(this)h(c)o(hapter)g(can)f(b)q(e)h
(corrected.)h(Both)f(this)150 1988 y(problem)e(and)h(the)h(prop)q(osed)
g(solution)f(w)o(ere)h(iden)o(ti\014ed)f FH(during)h
FI(the)g(dev)o(elopmen)o(t)e(of)h(the)h(formal)c(seman)o(tics)150
2063 y(of)k(MetaML.)h(W)m(e)f(presen)o(t)i(our)f(prop)q(osal)f(not)h
(just)g(b)q(ecause)h(w)o(e)f(exp)q(ect)h(it)f(to)f(solv)o(e)h(the)g
(problem,)e(but)i(also)150 2137 y(b)q(ecause)g(the)f(sheer)h(complexit)
o(y)c(of)i(the)h(solution)e(is)h(our)h(\014nal)e(argumen)o(t)g(for)h
(the)h(need)h(to)e(study)h(the)f(formal)150 2212 y(seman)o(tics)g
(MetaML)h(and)g(m)o(ulti-stage)d(programming)f(languages.)j(The)h
FE(puzzle)h FI(problem)d(do)q(es)i FH(not)k FI(arise)c(at)150
2287 y(all)h(if)g(w)o(e)i(simply)d(use)j(a)f(standard)h(\(formal\))d
(notion)h(of)h(substitution,)g(as)g(is)g(done)h(in)f(all)f(the)i(form)o
(ulations)150 2361 y(of)d(MetaML)i(seman)o(tics)e(in)g(the)i(rest)g(of)
e(part)h(I)q(I.)150 2494 y FG(4.4.2)48 b(T)o(yping)14
b(and)h(the)g(F)l(ailure)f(of)h(Cross-Stage)g(Safet)o(y)150
2595 y FI(As)d(w)o(as)f(the)i(case)f(with)f(the)h(scoping)g(problem)e
(ab)q(o)o(v)o(e,)h(w)o(e)h(ran)f(in)o(to)g(a)g(n)o(um)o(b)q(er)g(of)g
(obscure)i(\\bugs")e(in)o(v)o(olving)150 2670 y(the)k(use)h(of)d(the)j
(Run)e(construct.)i(W)m(e)e(do)q(cumen)o(ted)g(these)i(as)f(simply)d(b)
q(eing)j(implemen)o(tatio)o(n)d(mistak)o(es.)h(It)p eop
%%Page: 67 78
67 77 bop 1882 0 a FB(67)150 192 y FI(w)o(as)15 b(not)h(un)o(til)f(w)o
(e)g(presen)o(ted)j(a)d(v)o(ersion)h(of)f(a)g(formal)e(soundness)k(pro)
q(of)f(of)f(MetaML's)g(t)o(yp)q(e)i(system)e(that)150
266 y(Ro)o(w)o(an)d(Da)o(vies)h(p)q(oin)o(ted)g(out)g(that)h(soundness)
g(of)f(the)h(t)o(yp)q(e)g(system)f(do)q(es)h(not)f(hold.)f(Ro)o(w)o(an)
g(presen)o(ted)j(the)150 341 y(follo)o(wing)c(expression:)796
455 y Fy(h)q FE(fn)j(x)g Fy(\))g FE(~)q(\(run)f(\(run)f
Fy(h)q(h)p FE(x)p Fy(ii)p FE(\)\))p Fy(i)150 569 y FI(This)h
(expression)h(is)f(w)o(ell-t)o(yp)q(ed)g(under)h(the)g(t)o(yp)q(e)g
(systems)f(presen)o(ted)i(in)e(Section)h(4.1.2,)d(but)i(it)g(is)g(not)g
(w)o(ell-)150 644 y(b)q(eha)o(v)o(ed.)h(Enco)q(ding)h(and)f(executing)h
(this)f(expression)i(in)e(the)g(implemen)o(tation)d(presen)o(ted)17
b(ab)q(o)o(v)o(e)d(leads)g(to)150 718 y(a)g(run-time)e(error.)150
801 y(The)k(ro)q(ot)f(cause)h(of)f(the)h(problem)e(presen)o(ted)k(in)c
(this)i(subsection)g(is)g(that)f(Run)g(dynamically)d(c)o(hanges)k(the)
150 876 y(lev)o(el)f(of)g(a)g(term.)f(In)i(the)g(expression)g(ab)q(o)o
(v)o(e,)f FE(x)g FI(starts)i(o\013)e(at)g(lev)o(el)g(2.)g(When)h(the)g
(expression)g(is)f(executed,)150 951 y(the)g(lev)o(el)f(of)g
FE(x)g FI(drops)h(to)f(0.)g(An)g(attempt)g(is)g(therefore)i(made)d(to)h
(ev)n(aluate)g FE(x)h FI(b)o(y)f(lo)q(oking)f(up)h(an)g(asso)q(ciated)
150 1026 y(v)n(alue)f(in)h(the)g(en)o(vironmen)o(t,)e(but)j(no)e(suc)o
(h)i(v)n(alue)e(is)h(a)o(v)n(ailable)e(y)o(et.)150 1109
y(The)17 b(problem)d(presen)o(ted)k(in)e(this)g(subsection)h(is)f(a)g
(result)h(of)e(a)h(\015a)o(w)g(in)f(the)i(t)o(yp)q(e)g(system)e(rather)
i(than)f(in)150 1183 y(the)d(\\implem)o(en)o(tation")c(of)j(MetaML.)g
(In)g(Chapter)h(5,)e(w)o(e)i(will)e(presen)o(t)i(t)o(w)o(o)f(solutions)
g(to)g(this)g(problem)f(and)150 1258 y(explain)i(wh)o(y)h(w)o(e)g
(prefer)h(one)f(of)f(these)j(solutions)d(to)h(the)g(other.)150
1408 y FD(4.5)56 b(Co)n(v)n(ers:)16 b(A)h(Plausible)e(Solution)h(to)g
(the)g(Hidden)g(F)-5 b(ree-V)g(ariables)16 b(Problem)150
1533 y FI(Before)i(w)o(e)f(go)f(on)g(to)h(describ)q(e)h(more)e(subtle)h
(reasons)h(for)f(studying)f(the)h(formal)e(seman)o(tics)h(of)g(MetaML,)
150 1607 y(w)o(e)g(will)e(consider)j(a)e(p)q(ossible)h(solution)f(to)h
(the)g(problem)e(of)h(hidden)h(free-v)n(ariables.)g(W)m(e)f(will)f(see)
j(ho)o(w)e(the)150 1682 y(solution)9 b(itself)h(is)h(quite)f(complex,)f
(and)h(ev)o(en)h(though)f(the)h(solution)e(ma)o(y)g(seem)h(plausible,)f
(formally)e(v)o(erifying)150 1757 y(its)14 b(correctness)j(remains)c(a)
g(non-trivial)f(task.)150 1840 y(Because)i(cross-stage)f(p)q(ersisten)o
(t)h(constan)o(ts)f(carry)g(\\v)n(alues",)d(it)i(ma)o(y)e(seem)i(that)g
(rebuilding)f(do)q(es)i(not)f(need)150 1914 y(to)g(\\go)g(inside")g
(cross-stage)i(p)q(ersisten)o(t)h(constan)o(ts.)e(As)g(w)o(e)g(men)o
(tioned)e(earlier,)h(this)h(fallacy)e(arises)i(b)q(ecause)150
1989 y(one)j(generally)f(exp)q(ects)i(\\v)n(alues")e(to)g(b)q(e)h
(fully)e(dev)o(elop)q(ed)i(terms,)f(th)o(us)h(requiring)f(no)g(further)
h(pro)q(cessing.)150 2064 y(This)h(confusion)f(results)i(from)d(the)j
(fact)f(that)g(cross-stage)h(p)q(ersisten)o(t)h(constan)o(ts)e(carry)h
(\(SML\))f(v)n(alues)g(of)150 2139 y(t)o(yp)q(e)d FE(value)p
FI(.)g(Unfortunately)m(,)e(not)h(all)f(things)h(represen)o(ted)j(b)o(y)
d(our)h FE(value)g FI(datat)o(yp)q(e)f(are)h FH(values)h(in)f(the)h
(sense)150 2213 y(of)h(wel)r(l-forme)n(d)e(interpr)n(etations)h(of)g
FF(\025)p FH(-M)h(terms.)e FI(The)i(coun)o(ter-example)e
FE(puzzle)i FI(presen)o(ted)h(at)e(the)g(end)h(of)150
2288 y(the)h(previous)g(subsection)h(is)f(evidence)h(of)e(this)h
(problem.)e(The)i(result)h(of)e(ev)n(aluating)f FE(PUZZLE)i
FI(using)g FE(ev1)150 2363 y FI(can)e(b)q(e)g(represen)o(ted)i(in)d
FE(value)p FI(,)h(but)g(it)f(do)q(es)h(not)g(corresp)q(ond)h(to)e(an)o
(ything)g(that)g(w)o(e)h(accept)h(as)e(a)h(MetaML)150
2438 y FH(value)p FI(.)150 2521 y(As)i(w)o(e)h(hin)o(ted)f(earlier,)f
(the)i(problem)e(with)g(ev)n(aluating)g FE(PUZZLE)h FI(is)g(that)g
(renaming)e(do)q(es)j(not)f(go)f(inside)150 2595 y(cross-stage)22
b(p)q(ersisten)o(t)f(constan)o(ts.)g(Making)e(renaming)f(go)i(inside)g
(cross-stage)h(p)q(ersisten)o(t)h(constan)o(ts)f(is)150
2670 y(tric)o(ky)c(b)q(ecause)i(it)e(is)g(not)g(ob)o(vious)g(ho)o(w)f
(w)o(e)i(can)f(rename)g(free)h(v)n(ariables)e FH(inside)i(function)h
(values)i FI(in)16 b(the)p eop
%%Page: 68 79
68 78 bop 1882 0 a FB(68)150 192 y FE(value)14 b FI(datat)o(yp)q(e.)f
(The)h(solution)f(w)o(e)g(prop)q(ose)h(here)h(is)e(based)h(on)f(what)g
(w)o(e)h(ha)o(v)o(e)f(called)g(a)g FH(c)n(over)p FI(.)g(In)o(tuitiv)o
(ely)m(,)150 266 y(a)j(co)o(v)o(er)h(allo)o(ws)f(us)h(to)f(p)q(erform)g
(a)h(substitution)f(on)h(a)f(datat)o(yp)q(e)h(con)o(taining)f
(functions.)g(Alternativ)o(ely)m(,)f(a)150 341 y(co)o(v)o(er)i(can)h(b)
q(e)f(view)o(ed)g(as)h(a)e(dela)o(y)o(ed)h(en)o(vironmen)o(t.)f(The)h
(essen)o(tial)g(idea)g(is)g(to)g(p)q(erform)f(substitution)h(on)150
416 y(non-function)f(terms)h(in)f(the)i(normal)d(manner)h(and)h(then)g
(to)g FH(c)n(over)k FI(functions)c(b)o(y)g(making)d(the)k(functions)150
490 y(themselv)o(es)f(apply)g(the)g(substitution)h(to)f(their)g(o)o(wn)
g(results)h(whenev)o(er)h(these)f(results)h(b)q(ecome)e(a)o(v)n
(ailable.)150 565 y(This)d(w)o(a)o(y)m(,)e(a)h(free)h(v)n(ariable)f
(that)h(has)f(b)q(een)i(eliminated)d(b)o(y)h(a)g(substitution)h(\(or)g
(a)f(renaming\))g(should)g(nev)o(er)150 640 y(b)q(e)i(able)e(to)h
(escap)q(e)h(from)e(the)h(scop)q(e)h(of)e(its)h(binding)f(o)q
(ccurrence.)150 723 y(W)m(e)g(de\014ne)i(t)o(w)o(o)f(m)o(utually)d
(recursiv)o(e)16 b(functions)d(to)h(co)o(v)o(er)h(b)q(oth)f
(expressions)h(and)f(v)n(alues)f(as)h(follo)o(ws:)221
829 y FE(fun)g(CoverE)g(env)h(e)f(=)221 894 y(\(case)g(e)h(of)275
959 y(EI)e(i)h Fy(\))f FE(EI)h(i)237 1023 y Fy(j)26 b
FE(EA)13 b(\(e1,e2\))h Fy(\))g FE(EA)f(\(CoverE)h(env)h(e1,)e(CoverE)h
(env)h(e2\))237 1088 y Fy(j)26 b FE(EL)14 b(\(y)m(,e1\))g
Fy(\))f FE(EL)h(\(y)m(,CoverE)f(env)i(e1\))237 1153 y
Fy(j)26 b FE(EV)13 b(y)h Fy(\))g FE(env)h(y)237 1218
y Fy(j)26 b FE(EB)13 b(e1)h Fy(\))g FE(EB)f(\(CoverE)h(env)h(e1\))237
1282 y Fy(j)26 b FE(ES)14 b(e1)g Fy(\))f FE(ES)h(\(CoverE)g(env)h(e1\))
237 1347 y Fy(j)26 b FE(ER)14 b(e1)g Fy(\))f FE(ER)g(\(CoverE)h(env)h
(e1\))237 1412 y Fy(j)26 b FE(EC)13 b(v)h Fy(\))g FE(EC)f(\(CoverV)g
(env)i(v\)\))221 1477 y(and)f(CoverV)g(env)h(v)f(=)221
1541 y(\(case)g(v)g(of)275 1606 y(VI)f(i)h Fy(\))f FE(VI)g(i)237
1671 y Fy(j)26 b FE(VF)13 b(f)h Fy(\))f FE(VF)g(\(\(CoverV)h(env\))h(o)
f(f)s(\))237 1736 y Fy(j)26 b FE(V)o(C)13 b(e)h Fy(\))g
FE(V)o(C)f(\(CoverE)g(env)i(e\)\).)150 1837 y FI(W)m(e)e(revised)i(the)
g(de\014nition)e(of)h(our)g(in)o(terpreter)h(as)f(follo)o(ws:)221
1943 y FE(fun)g(ev2)g(env)h(e)f(=)221 2008 y(\(case)g(e)h(of)275
2073 y(EI)e(i)h Fy(\))f FE(VI)g(i)237 2137 y Fy(j)26
b FE(EA)13 b(\(e1,e2\))h Fy(\))g FE(\(case)h(\(ev2)f(env)h(e1,)e(ev2)i
(env)f(e2\))h(of)e(\(VF)g(f,)g(v\))h Fy(\))g FE(f)f(v\))237
2202 y Fy(j)26 b FE(EL)14 b(\(x,e1\))g Fy(\))g FE(VF)f(\(fn)h(v)g
Fy(\))f FE(ev2)h(\(ext)h(env)g(x)f(\(EC)f(v\)\))h(e1\))237
2267 y Fy(j)26 b FE(EV)13 b(x)h Fy(\))g FE(\(case)g(\(env)h(x\))g(of)e
(EC)g(v)h Fy(\))f FE(v\))237 2332 y Fy(j)26 b FE(EB)13
b(e1)h Fy(\))g FE(V)o(C)f(\(eb2)h(1)g(env)h(e1\))237
2397 y Fy(j)26 b FE(ER)14 b(e1)g Fy(\))f FE(\(case)i(\(ev2)f(env)h
(e1\))f(of)f(V)o(C)g(e2)h Fy(\))g FE(ev2)g(env0)g(e2\))237
2461 y Fy(j)26 b FE(EC)13 b(v)h Fy(\))g FE(CoverV)f(env)i(v\))221
2526 y(and)f(eb2)h(n)f(env)h(e)f(=)221 2591 y(\(case)g(e)h(of)275
2656 y(EI)e(i)h Fy(\))f FE(EI)h(i)p eop
%%Page: 69 80
69 79 bop 1882 0 a FB(69)237 195 y Fy(j)26 b FE(EA)13
b(\(e1,e2\))h Fy(\))g FE(EA)f(\(eb2)i(n)f(env)h(e1,)e(eb2)i(n)f(env)h
(e2\))237 260 y Fy(j)26 b FE(EL)14 b(\(x,e1\))g Fy(\))g
FE(let)g(val)g(x')f(=)h(NextV)o(a)o(r)h(x)f(in)g(EL)g(\(x',)f(eb2)i(n)f
(\(ext)g(env)h(x)f(\(EV)g(\(x'\)\)\))g(e1\))g(end)237
325 y Fy(j)26 b FE(EV)13 b(y)h Fy(\))g FE(env)h(y)237
390 y Fy(j)26 b FE(EB)13 b(e1)h Fy(\))g FE(EB)f(\(eb2)i(\(n+1\))f(env)h
(e1\))237 454 y Fy(j)26 b FE(ES)14 b(e1)g Fy(\))f FE(\(if)h(n=1)g(then)
h(\(case)g(\(ev2)f(env)h(e1\))f(of)g(V)o(C)f(e)h Fy(\))f
FE(e\))i(else)f(ES)g(\(eb2)h(\(n-1\))f(env)h(e1\)\))237
519 y Fy(j)26 b FE(ER)14 b(e1)g Fy(\))f FE(ER)g(\(eb2)i(n)f(env)h(e1\))
237 584 y Fy(j)26 b FE(EC)13 b(v)h Fy(\))g FE(EC)f(\(CoverV)g(env)i
(v\)\).)150 685 y FI(The)10 b(only)f(c)o(hanges)i(to)e(the)h(ev)n
(aluation)f(and)g(rebuilding)g(functions)h(are)g(in)f(the)i(cases)g(of)
e(cross-stage)i(p)q(ersisten)o(t)150 760 y(constan)o(ts:)j(Cross-stage)
g(p)q(ersisten)o(t)i(constan)o(ts)e(are)g(co)o(v)o(ered)g(using)g(the)g
(curren)o(t)h(en)o(vironmen)o(t)d(b)q(efore)i(they)150
835 y(are)j(returned.)g(Cross-stage)h(p)q(ersisten)o(t)g(v)n(ariables)e
(are)h(co)o(v)o(ered)g(ev)o(en)g(during)f(rebuilding,)f(to)i(address)g
(the)150 909 y(p)q(ossibilit)o(y)8 b(of)h(them)f(b)q(eing)i(added)f(to)
g(the)h(en)o(vironmen)o(t)e(and)i(then)g(mo)o(v)o(ed)d(under)j(another)
g(dynamic)e(lam)o(b)q(da,)150 984 y(whic)o(h)21 b(could)f(then)h
(incorrectly)h(capture)g(a)e(dynamic)f(v)n(ariable)h(that)g(originated)
g(from)f(the)i(cross-stage)150 1059 y(p)q(ersisten)o(t)16
b(constan)o(t.)150 1142 y(No)o(w,)d(ev)n(aluating)g(the)h(term)f
FE(PUZZLE)h FI(under)h(this)f(seman)o(tics)f(pro)q(duces)j(the)e(exp)q
(ected)i(result:)221 1248 y FE(-)d(ev2)h(env0)h(PUZZLE;)221
1313 y(val)e(it)h(=)g(V)o(C)f(\(EC)g(\(VI)h(5\)\))g(:)f(value.)150
1414 y FI(Finally)m(,)c(w)o(e)k(p)q(oin)o(t)e(out)h(that)g(the)g(accum)
o(ulation)e(of)h(suc)o(h)i(wrapp)q(ers)g(can)g(lead)e(to)h(unnecessary)
i(p)q(erformance)150 1489 y(degradation,)i(esp)q(ecially)h(for)f
(cross-stage)i(p)q(ersisten)o(t)h(constan)o(ts)f(whic)o(h)e(do)h(not)f
(con)o(tain)h(an)o(y)f(co)q(de.)h(This)150 1563 y(problem)10
b(can)j(b)q(e)f(alleviated)f(b)o(y)g(p)q(ostp)q(oning)h(the)g
(application)f(of)g(co)o(v)o(ers)i(un)o(til)e(a)g(co)q(de)i(fragmen)o
(t)d(is)i(actually)150 1638 y(encoun)o(tered.)i(This)e(idea)f(is)h
(similar)e(in)i(spirit)g(to)g(what)g(can)g(b)q(e)h(done)f(with)g
(calculi)f(of)h(explicit)f(substitutions)150 1713 y([4].)h(As)j(of)e(y)
o(et,)h(this)f(optimization)f(is)h(still)g(unexplored.)150
1871 y FD(4.6)56 b(More)18 b(Concerns)150 2004 y FI(The)12
b(concerns)g(describ)q(ed)h(in)e(the)h(last)f(section)g(are)h(\\bugs":)
e(they)i(are)f(instances)i(where)f(the)f(implemen)o(tation)150
2079 y(and)i(the)g(t)o(yp)q(e)h(system)f(break.)g(There)h(are)f(other)h
(more)e(qualitativ)o(e)g(concerns)i(that)g(w)o(e)f(ha)o(v)o(e)g(iden)o
(ti\014ed.)f(W)m(e)150 2154 y(presen)o(t)j(t)o(w)o(o)f(in)f(this)h
(section:)168 2270 y(1.)20 b(The)14 b(need)h(for)e(v)n(alidating)f
(certain)i(run-time)f(optimizations)f(of)h(ob)r(ject-co)q(de,)i(and)168
2345 y(2.)20 b(The)e(seeming)f(existence)i(of)e(in)o(teresting)h(in)o
(trinsic)g(prop)q(erties)h(that)f(the)g(MetaML)g(co)q(de)h(t)o(yp)q(e)f
(migh)o(t)221 2419 y(enjo)o(y)m(.)150 2536 y(W)m(e)13
b(revisit)i(the)f(\014rst)h(concern)g(at)f(the)g(end)h(of)e(Chapter)h
(6.)p eop
%%Page: 70 81
70 80 bop 1882 0 a FB(70)150 192 y FG(4.6.1)48 b(Optimizati)o(on)13
b(on)i(Generated)f(Co)q(de)150 308 y FI(While)k(the)i(in)o
(terpretation)g(presen)o(ted)h(ab)q(o)o(v)o(e)e(w)o(as)g(considered)h
(su\016cien)o(t)g(for)f(executing)h(MetaML)f(pro-)150
382 y(grams,)14 b(it)h(w)o(as)h(kno)o(wn)f(that)h(the)h(co)q(de)f
(generated)h(b)o(y)f(suc)o(h)h(programs)d(w)o(ould)h(con)o(tain)g(some)
g(sup)q(er\015uous)150 457 y(computations.)8 b(Not)i(only)g(can)g
(these)i(sup)q(er\015uous)g(computations)c(mak)o(e)h(it)h(more)f
(costly)h(to)g(execute)i(the)f(gen-)150 532 y(erated)i(programs,)d(but)
i(it)g(can)g(also)f(mak)o(e)g(the)h(co)q(de)h(larger)f(and)f(hence)j
(harder)e(for)g(h)o(umans)e(to)i(understand.)150 607
y(In)i(this)g(section,)g(w)o(e)g(explain)f(the)i(need)g(for)e(these)i
(optimizations.)150 764 y FG(Safe)i Fp(\014)i FG(Reduction)h
FI(It)c(is)f(not)g(uncommon)e(that)i(executing)h(a)f(m)o(ulti-stage)f
(program)f(will)h(result)i(in)f(the)150 839 y(construction)e(of)e(man)o
(y)e(applications)i(that)h(w)o(e)f(w)o(ould)g(lik)o(e)g(to)g
(eliminate.)f(Consider)i(the)g(follo)o(wing)d(example:)221
945 y FE(val)k(g)h(=)g Fy(h)p FE(fn)g(x)g Fy(\))g FE(x)g(*)f(5)p
Fy(i)p FE(;)221 1010 y(val)g(h)i(=)f Fy(h)p FE(fn)g(x)g
Fy(\))f FE(\()q(~)q(g)h(x\))g(-)g(2)p Fy(i)p FE(.)150
1111 y FI(If)d(w)o(e)g(use)h(the)g(in)o(terpreter)h(presen)o(ted)g(ab)q
(o)o(v)o(e,)d(the)i(declaration)e(for)h FE(h)h FI(ev)n(aluates)f(to)g
Fy(h)p FE(fn)g(d1)g Fy(\))g FE(\(\(fn)g(d2)g Fy(\))g
FE(d2)g(*)150 1186 y(5\))h(d1\))h(-)g(2)p Fy(i)o FI(.)g(But)g(the)g
(MetaML)g(implem)o(en)o(tation)d(returns)k Fy(h)p FE(fn)f(d1)f
Fy(\))g FE(\(d1)h(*)f(5\))h(-)f(2)p Fy(i)h FI(b)q(ecause)h(it)e
(attempts)g(to)150 1261 y(p)q(erform)f(a)g(kind)g(of)h
FH(safe)g FF(\014)j FI(reduction)d(whenev)o(er)h(a)f(piece)g(is)g(co)q
(de)g(is)g(Escap)q(ed)h(in)o(to)e(another.)h(Generally)m(,)e(a)h
FF(\014)150 1335 y FI(reduction)i(is)g FH(safe)g FI(if)f(it)g(do)q(es)i
(not)e(a\013ect)i(seman)o(tics)e(prop)q(erties,)i(suc)o(h)g(as)f
(termination)1560 1320 y FA(10)1593 1335 y FI(.)f(There)i(is)f(one)g
(safe)150 1410 y(case)i(whic)o(h)e(is)g(particularly)g(easy)h(to)f
(recognize:)i(An)e(application)f(of)h(a)g(lam)o(b)q(da-abstraction)f
(to)h(a)g(constan)o(t)150 1485 y(or)g(a)g(v)n(ariable.)f(W)m(e)h(w)o
(ould)f(lik)o(e)h(to)g(kno)o(w)f(that)i(suc)o(h)g(an)f(application)f
(can)h(alw)o(a)o(ys)f(b)q(e)i(reduced)h(sym)o(b)q(olically)150
1560 y(without)j(a\013ecting)g(termination.)d(F)m(urthermore,)j
(restricting)g(this)g(optimization)e(to)h(the)i(cases)g(when)f(the)150
1634 y(argumen)o(t)13 b(is)h(a)f(small)f(constan)o(t)i(or)g(a)g(v)n
(ariable)e(allo)o(ws)h(us)h(to)g(a)o(v)o(oid)f(the)h(p)q(ossibilit)o(y)
f(of)g(co)q(de)i(explosion.)150 1717 y(This)e(rebuilding-time)e
(optimization)g(can)i(b)q(e)h(easily)f(incorp)q(orated)h(in)o(to)e(the)
i(in)o(terpretation)g(b)o(y)f(mo)q(difying)150 1792 y(the)h
(application)f(case)i(in)e(the)i(rebuilding)e(function)g
FE(eb2)p FI(:)221 1898 y FE(...)221 1963 y Fy(j)g FE(EA)g(\(e1,e2\))h
Fy(\))g FE(case)g(\(eb2)h(n)f(env)h(e1,)f(eb2)g(n)g(env)h(e2\))f(of)542
2028 y(\(EL)g(\(x,e3\),)g(EI)f(i\))h Fy(\))f FE(eb2)i(n)f(e3)g(\(ext)h
(env0)f(x)g(\(EI)g(1\)\))504 2093 y Fy(j)26 b FE(\(EL)14
b(\(x,e3\),)g(EV)f(x\))h Fy(\))g FE(eb2)g(n)g(e3)g(\(ext)h(env0)g(x)f
(\(EV)f(x\)\))504 2157 y Fy(j)26 b FE(\(e4,e5\))14 b
Fy(\))f FE(EA)h(\(e4,e5\))221 2222 y(...)e(.)150 2323
y FI(This)17 b(optimization)d(requires)k(that)f(the)h
FF(\014)h FI(rule)e(is)g(exp)q(ected)i(to)e(hold)f(at)h(all)f(lev)o
(els.)g(V)m(erifying)g(this)h(claim)150 2398 y(is)h(not)g(trivial.)f
(In)h(fact,)g(without)g(a)g(simple)f(formal)f(seman)o(tics)i(for)g
(MetaML,)g(this)g(claim)e(is)j(practically)150 2473 y(imp)q(ossible)12
b(to)i(v)o(erify)m(.)e(W)m(e)i(return)h(to)f(the)g(issue)h(of)e
FF(\014)k FI(in)c(Chapter)i(6.)p 150 2553 237 2 v 143
2580 a Fz(10)188 2596 y FB(Resp)q(ecting)h(termination)g(b)q(eha)o
(vior)f(is)g(su\016cien)o(t)g(if)f(the)f(only)i(e\013ect)f(in)h(the)f
(language)h(is)g(termination.)g(In)f(ric)o(her)188 2642
y(languages,)h(a)e(safe)g Fx(\014)i FB(reduction)f(ma)o(y)g(also)g
(need)f(to)g(resp)q(ect)h(other)f(seman)o(tic)h(prop)q(erties.)p
eop
%%Page: 71 82
71 81 bop 1882 0 a FB(71)150 192 y FG(Safe)16 b(Rebuild)o(in)o(g)i
FI(Rebuilding)13 b(expressions)j(in)e(a)g(m)o(ulti-lev)o(el)e(language)
h(can)i(b)q(e)g(more)e(costly)i(than)f(nec-)150 266 y(essary)m(.)h(The)
g(follo)o(wing)d(example)h(is)i(somewhat)e(unnatural,)h(but)h(it)f
(allo)o(ws)f(us)i(to)g(exhibit)f(a)h(b)q(eha)o(vior)f(that)150
341 y(can)g(arise)g(in)g(more)f(\\natural")g(programs:)221
447 y FE(val)g(a)h(=)g Fy(hh)q FE(5)p Fy(ii)p FE(;)f(val)h(b)g(=)g
Fy(hh)r FE(~)r(~)q(a)p Fy(ii)p FE(.)150 548 y FI(If)h(w)o(e)g(use)h
(the)g(in)o(terpreter)h(presen)o(ted)h(ab)q(o)o(v)o(e,)c(the)i
(declaration)f(for)g FE(b)g FI(ev)n(aluates)h(to)f Fy(hh)q
FE(~)q Fy(h)p FE(5)p Fy(iii)p FI(.)g(Computing)150 623
y(this)g(result)h(in)o(v)o(olv)o(ed)e(rebuilding)g Fy(h)p
FE(5)p Fy(i)h FI(and,)g(in)g(turn,)g(rebuilding)f FE(5)p
FI(.)g(Then,)i(Running)e FE(b)h FI(w)o(ould)g(in)o(v)o(olv)o(e)e(the)
150 698 y(rebuilding)h(of)g FE(5)h FI(again.)e(Our)i(concern)h(is)f
(that)f(the)i(last)e(rebuilding)g(is)h(redundan)o(t)g(b)q(ecause)i(w)o
(e)e(kno)o(w)f(that)150 773 y(rebuilding)f(has)g(already)h(b)q(een)g(p)
q(erformed)f(b)q(efore.)h(If)f(in)g(place)h(of)f FE(5)g
FI(w)o(e)h(had)f(a)g(larger)h(expression,)g(the)g(cost)150
847 y(of)f(this)h(redundancy)h(could)f(b)q(e)g(substan)o(tial.)150
930 y(The)j(MetaML)g(implemen)o(tation)c(alleviates)j(this)h(problem)f
(b)o(y)g(c)o(hec)o(king)h(the)g(result)h(of)e(rebuilding)g(inside)150
1005 y(an)g(Escap)q(e)i(at)e(lev)o(els)h(greater)g(than)g(1.)e(If)i
(the)g(result)g(of)f(rebuilding)f(inside)i(an)f(Escap)q(e)i(w)o(as)e(a)
g(Brac)o(k)o(eted)150 1080 y(expression,)d(the)g(Escap)q(e)h(and)f(the)
g(Brac)o(k)o(ets)h(are)f(eliminated,)d(and)i(the)h(result)h(is)e(just)h
(the)g(expression)h(itself.)150 1155 y(This)k(optimization)e(w)o(ould)h
(b)q(e)i(correct)h(if)26 b FE(~)8 b Fy(h)p FF(e)p Fy(i)19
b FI(w)o(ere)g(alw)o(a)o(ys)f(equal)g(to)g FF(e)p FI(.)g(But)h(again,)d
(this)j(equalit)o(y)e(is)150 1229 y(not)e(ob)o(vious,)g(and)g(cannot)h
(b)q(e)g(supp)q(orted)h(or)f(refuted)g(without)f(a)h(rigourous)f
(de\014nition)g(of)g(the)h(seman)o(tics)150 1304 y(of)g(MetaML.)h(F)m
(urthermore,)f(suc)o(h)h(a)g(seman)o(tics)f(m)o(ust)g(b)q(e)h(fairly)f
(simple)f(for)h(an)o(y)g(pro)q(ofs)h(to)g(b)q(e)g(practical)150
1379 y(and)d(reliable.)g(Again,)f(our)i(need)g(to)g(determine)f
(whether)i(this)f(optimization)c(w)o(as)k(sound)g(or)f(not)h(is)f
(further)150 1453 y(motiv)n(ation)9 b(for)j(seeking)h(an)f
FH(e)n(quational)i(the)n(ory)f FI(for)f(MetaML.)g(W)m(e)g(will)f
(outline)h(an)g(elemen)o(tary)g(equational)150 1528 y(theory)i(at)g
(the)h(end)f(of)f(the)i(Chapter)f(6)g(whic)o(h)g(w)o(ould)f(supp)q(ort)
i(this)e(optimization.)150 1611 y(Again,)f(this)i(optimization)c(can)k
(b)q(e)g(incorp)q(orated)g(in)o(to)f(the)h(rebuilding)e(function)i(b)o
(y)f(c)o(hanging)f(the)j(Escap)q(e)150 1686 y(case)g(of)e
FE(eb2)i FI(as)f(follo)o(ws:)221 1792 y FE(...)221 1857
y Fy(j)f FE(ES)h(e1)g Fy(\))f FE(\(if)h(n=1)g(then)h(\(case)g(\(ev2)f
(env)h(e1\))f(of)f(V)o(C)g(e)i Fy(\))e FE(e\))557 1922
y(else)h(case)h(\(eb2)g(\(n-1\))f(env)h(e1\))f(of)672
1986 y(EB)f(e2)h Fy(\))g FE(e2)633 2051 y Fy(j)27 b FE(e3)14
b Fy(\))f FE(ES)h(e3)221 2116 y(...)e(.)150 2217 y FI(Finally)m(,)17
b(b)q(ecause)k(the)f(t)o(w)o(o)e(optimization)f(describ)q(ed)k(in)e
(this)g(subsection)h(eliminate)e(some)g(redices)j(that)150
2292 y(the)16 b(user)h(migh)o(t)d(exp)q(ect)k(to)d(see)j(in)d(the)i
(generated)g(co)q(de,)f(these)h(optimization)c(could,)j(in)f
(principle,)g(mak)o(e)150 2367 y(it)h(hard)g(to)h(understand)g
FH(why)j FI(a)c(particular)h(program)d(w)o(as)j(generated.)g(In)f(our)h
(exp)q(erience,)h(the)f(resulting)150 2441 y(smaller,)c(simpler)g
(programs)h(ha)o(v)o(e)g(b)q(een)i(easier)f(to)g(understand)h(and)e
(seemed)h(to)g(mak)o(e)e(the)i(optimizations)150 2516
y(w)o(orth)o(while.)p eop
%%Page: 72 83
72 82 bop 1882 0 a FB(72)150 192 y FG(4.6.2)48 b(A)16
b(Conjecture)e(on)h(an)h(Isomorphism)949 265 y FC(A)o(l)r(l)d(gr)n(e)n
(at)g(truths)f(b)n(e)n(gin)g(as)h(blasphemies.)1481 357
y FB(George)h(Bernard)g(Sha)o(w)150 440 y FI(W)m(e)d(conclude)g(this)g
(c)o(hapter)h(b)o(y)f(describing)h(a)f(simple)e(y)o(et)i(con)o(tro)o(v)
o(ersial)g(observ)n(ation)g(that)g(w)o(e)g(made)f(shortly)150
514 y(after)k(w)o(e)g(b)q(egan)g FH(pr)n(o)n(gr)n(amming)f
FI(in)g(MetaML)883 499 y FA(11)919 514 y FI(.)g(The)h(purp)q(ose)h(of)e
(this)h(section)h(is)e(not)h(only)f(to)h(presen)o(t)h(this)150
589 y(observ)n(ation,)i(but)h(to)g(emphasize)f(that)h(programming)c(in)
k(MetaML)g(has)g(illumina)o(ted)e(the)i(w)o(a)o(y)f(for)h(deep)150
664 y(insigh)o(ts)c(in)o(to)f(the)h(nature)h(of)e(m)o(ulti-stage)f
(programmi)o(ng.)150 747 y(W)m(e)h(sa)o(y)h(that)g(there)h(is)e(an)g
FH(isomorphism)h FI(b)q(et)o(w)o(een)h(t)o(w)o(o)e(t)o(yp)q(es)i(when)f
(there)h(is)e(a)h(pair)f(of)g(functions)h FF(f)k FI(and)c
FF(g)150 822 y FI(that)g(go)g(bac)o(k)g(and)g(fourth)g(b)q(et)o(w)o
(een)h(the)g(t)o(w)o(o)f(t)o(yp)q(es)h(and)e(the)i(comp)q(osition)d(of)
i(the)h(t)o(w)o(o)e(functions)h(is)g(equal)150 896 y(to)e(iden)o(tit)o
(y)f(\(See)i(for)e(example)f(Di)h(Cosmo)f([25].\))g(More)j(precisely)m
(,)e(w)o(e)h(are)g(referring)h(to)e(the)i(situation)e(where)150
971 y(t)o(w)o(o)16 b(terms)g FF(f)21 b FI(and)c FF(g)g
FI(represen)o(t)i(functions,)d(and)g(the)h(represen)o(tation)h(of)e
(their)h(comp)q(ositions)e(is)h(pro)o(v)n(ably)150 1046
y(equal)g(to)g FF(\025x:x)f FI(in)h(an)g(equational)f(theory)845
1031 y FA(12)881 1046 y FI(.)h(A)g(simple)f(example)g(of)g(t)o(w)o(o)h
(isomorphic)f(t)o(yp)q(es)i(are)28 b FE('a)16 b(*)27
b('b)150 1120 y FI(and)f FE('b)14 b(*)25 b('a)p FI(.)13
b(In)i(this)f(example,)e(the)j(pair)f(of)g(functions)g
FF(f)19 b FI(and)14 b FF(g)i FI(are)e(iden)o(tical)g(and)g(are)h
FE(fn)f(\(x,y\))g Fy(\))g FE(\(y)m(,x\))p FI(.)150 1195
y(While)d(w)o(orking)g(with)h(the)h(implemen)o(tatio)o(n)c(of)j
(MetaML,)g(w)o(e)g(b)q(egan)g(to)g(w)o(onder)h(if)e(the)i(functions)f
FE(back)h FI(and)150 1270 y FE(fo)o(rth)h FI(\(of)g(Section)h(2.6\))f
(are)h(t)o(w)o(o)f(suc)o(h)h(functions.)f(They)h(are)f(not.)g(Let)h(us)
g(recall)f(the)h(de\014nition)g(of)e(the)i(t)o(w)o(o)150
1345 y(functions:)221 1443 y FE(fun)f(back)h(f)e(=)i
Fy(h)p FE(fn)f(x)g Fy(\))g FE(~)q(\(f)g Fy(h)p FE(x)p
Fy(i)p FE(\))p Fy(i)p FE(;)g(\(*)g(:)f(\()p Fy(h)f FE('a)p
Fy(i)h(!)h(h)d FE('b)p Fy(i)p FE(\))j Fy(!)g(h)d FE('a)j
Fy(!)25 b FE('b)p Fy(i)14 b FE(*\))221 1508 y(fun)g(fo)o(rth)g(f)f(x)h
(=)g Fy(h)r FE(~)q(f)g(~)q(x)p Fy(i)p FE(;)156 b(\(*)14
b(:)f Fy(h)f FE('a)h Fy(!)25 b FE('b)p Fy(i)14 b(!)f(h)f
FE('a)p Fy(i)h(!)h(h)d FE('b)p Fy(i)j FE(*\).)150 1603
y FI(The)c(reason)g(these)h(function)f(do)f(not)g(form)f(an)i
(isomorphism)c(is)k(that)f(if)g FE(back)i FI(is)e(applied)g(to)h(a)f
(non-terminating)150 1677 y(function,)15 b(it)g(fails)f(to)i(terminate)
f(\(instead)h(of)f(returning)h(the)g(co)q(de)h(of)e(a)g
(non-terminating)e(function\).)i(But)150 1752 y(at)k(the)g(same)f
(time,)e(functions)j(that)g(tak)o(e)g(a)f(co)q(de)i(fragmen)o(t)d(and)h
(div)o(erge)h(immediately)c(thereafter)21 b(are)150 1827
y(not)14 b(lik)o(ely)e(to)i(b)q(e)h(useful)f(functions.)f(In)h
(particular,)g(\\co)q(de)g(fragmen)o(ts")f(in)g(MetaML)i(are)f
FH(not)g FI(an)g(inductiv)o(e)150 1902 y(structure:)k(The)e(programmer)
e(cannot)j(tak)o(e)f(apart)g(co)q(de)h(fragmen)o(ts)e(or)h(\\lo)q(ok)f
(inside")h(them)f(in)h(an)o(y)g(w)o(a)o(y)150 1976 y(other)h(than)f(b)o
(y)g(Running)f(them)684 1961 y FA(13)718 1976 y FI(.)h(It)g(is)g
(therefore)i(not)e(clear)g(wh)o(y)g(a)g FH(useful)g FI(function)g(that)
g(tak)o(es)g(suc)o(h)h(a)150 2051 y(co)q(de)f(fragmen)o(t)d(w)o(ould)h
(fail)g(to)h(terminate.)e(Th)o(us,)i(w)o(e)g(con)o(tin)o(ued)h(to)e
(searc)o(h)j(for)d(a)h(coun)o(ter-example,)f(that)p 150
2125 237 2 v 143 2152 a Fz(11)188 2168 y FB(This)h(section)h(ma)o(y)f
(b)q(e)f(safely)i(skipp)q(ed)g(b)o(y)f(the)f(reader)h
FC(not)i FB(in)o(terested)f(in)f(the)g(details)h(of)e(the)g(formal)i
(seman)o(tics)188 2213 y(of)d(MetaML.)g(The)g(section)h(requires)h
(familiarit)o(y)g(with)f(the)f(formal)h(notion)g(of)f(an)g(equational)j
(theory)m(.)143 2243 y Fz(12)188 2259 y FB(It)d(is)h(imp)q(ortan)o(t)g
(to)f(emphasize)i(that)e(w)o(e)f(are)h(taking)i(an)e
(equational-theoreti)q(c)j(view,)d(and)h(not)f(a)g(view)g(where)g(w)o
(e)188 2305 y(are)i(concerned)g(with)g(domain-theoretic)h(in)o
(terpretations)h(of)d(the)g(t)o(yp)q(es.)h(The)f(latter)g(view)h(is)g
(in)o(teresting,)h(but)e(is)188 2350 y(not)g(our)f(presen)o(t)h(sub)r
(ject.)143 2380 y Fz(13)188 2396 y FB(Close)f(insp)q(ection)h(of)e(the)
g(in)o(terpreter)h(presen)o(ted)g(in)g(this)f(c)o(hapter)h(will)g(rev)o
(eal)g(that)f(the)g(en)o(vironmen)o(t)i(can)e(indeed)188
2442 y(b)q(e)18 b(enric)o(hed)g(with)g(constan)o(ts)g(that)f(w)o(ould)h
(allo)o(w)g(us)g(to)f(tak)o(e)g(apart)g(a)g(piece)h(of)f(co)q(de.)g
(This)h(p)q(ossibili)q(t)o(y)i(is)d(an)188 2487 y(artifact)g(of)f(the)h
(implemen)o(tation,)i(and)e(not)f(what)g(the)h(language)h(studied)g(in)
f(this)g(dissertation)i(is)e FC(intende)n(d)c FB(to)188
2533 y(do.)k(The)f(fragile)i(nature)g(of)e(the)h(distinction)i(b)q(et)o
(w)o(een)e(what)g(is)g(implemen)o(ted)i(\(and)e(is)g(therefore)g
(formal\))g(and)188 2579 y(what)d(is)h(in)o(tended)h(\(and)f(is)f
(therefore)h(p)q(ossibly)h(still)g(informal\))g(made)e(it)h(harder)f
(for)g(us)h(to)e(mak)o(e)i(the)f(argumen)o(t)188 2624
y(presen)o(ted)f(in)f(this)h(subsection.)g(This)g(di\016cult)o(y)g(w)o
(as)f(therefore)f(further)h(incen)o(tiv)o(e)i(to)e(seek)f(alternativ)o
(e)j(\(stronger\))188 2670 y(form)o(ulations)i(of)c(MetaML's)h(seman)o
(tics.)h(W)m(e)g(presen)o(t)f(instances)i(of)e(suc)o(h)g(seman)o(tics)i
(in)e(the)h(rest)e(of)h(P)o(art)g(I)q(I.)p eop
%%Page: 73 84
73 83 bop 1882 0 a FB(73)150 192 y FI(is,)13 b(a)g FH(useful)h
FI(MetaML)g(function)f(for)g(whic)o(h)h(the)g(comp)q(osition)e(of)h
(the)h(t)o(w)o(o)f(functions)h FE(back)h FI(and)e FE(fo)o(rth)h
FI(is)f(not)150 266 y(iden)o(tit)o(y)m(.)f(T)m(o)i(date,)f(w)o(e)h(ha)o
(v)o(e)g(not)g(found)f(suc)o(h)i(a)f(function.)150 349
y(Th)o(us,)f(w)o(e)g(conjectured)i(that)f FE(back)g FI(and)f
FE(fo)o(rth)g FI(form)f(an)h(isomorphism)d(b)q(et)o(w)o(een)k(t)o(w)o
(o)f FH(inter)n(esting)g FI(subsets)i(of)150 424 y(the)f(t)o(yp)q(es)h
Fy(h)c FI('a)p Fy(i)i(!)h(h)d FI('b)p Fy(i)i FI(and)h
Fy(h)e FI('a)g Fy(!)25 b FI('b)p Fy(i)p FI(.)13 b(These)i(subsets)g(m)o
(ust)e(exclude,)h(for)f(example,)f(non-terminating)150
499 y(functions)i(in)g(the)g(t)o(yp)q(e)h Fy(h)d FI('a)p
Fy(i)h(!)h(h)d FI('b)p Fy(i)p FI(.)i(This)h(c)o(hoice)h(is)f(not)g(to)q
(o)g(restrictiv)o(e,)g(b)q(ecause)i(suc)o(h)f(functions)f(seem)150
573 y(generally)g(unin)o(teresting)g(\(no)g(useful)g(induction)f(can)h
(b)q(e)h(p)q(erformed)f(on)f(a)h Fy(h)p 1396 573 13 2
v 15 w(i)g FI(t)o(yp)q(e\).)150 656 y(Finally)m(,)e(Dan)o(vy)i
FH(et)i(al.)e FI(ha)o(v)o(e)h(observ)o(ed)g(that)g(t)o(w)o(o-lev)o(el)f
FF(\021)q FI(-expansions)h(can)g(b)q(e)h(used)f(for)g(binding-time)d
(im-)150 731 y(pro)o(v)o(emen)o(t)g([20,)5 b(21].)12
b(The)h(t)o(w)o(o)f(functions,)g FE(back)i FI(and)e FE(fo)o(rth)h
FI(are)g(closely)g(related)g(to)f(t)o(w)o(o-lev)o(el)g
FF(\021)q FI(-expansions.)150 806 y(The)i(application)e(of)g(m)o
(ulti-lev)o(el)f(expansions)i(for)g(impro)o(ving)e(staged)j(programs)e
(has)h(not)g(b)q(een)i(studied)f(ex-)150 881 y(plicitly)c(in)h(this)g
(dissertation,)g(and)g(remains)f(an)h(imp)q(ortan)o(t)f(op)q(en)h
(question.)g(The)h(relation)f(b)q(et)o(w)o(een)h(our)f(t)o(w)o(o)150
955 y(functions)j(and)g(t)o(w)o(o-lev)o(el)g FF(\021)q
FI(-expansion)g(has)g(b)q(een)i(further)f(motiv)n(ation)c(for)j(us)h
(to)f(v)n(alidate)f(our)h(conjecture)150 1030 y(on)g(t)o(yp)q(e)g
(isomorphisms.)p eop
%%Page: 74 85
74 84 bop 822 436 a FL(Chapter)31 b(5)285 662 y(Big-Step)i(Seman)m
(tics,)f(T)m(yp)s(e)h(Systems,)714 797 y(and)f(Closedness)949
994 y FC(The)14 b(art)f(of)g(r)n(ese)n(ar)n(ch)f(is)h(the)g(ability)f
(to)h(lo)n(ok)949 1053 y(at)g(the)g(details,)f(and)g(se)n(e)h(the)f(p)n
(assion.)1381 1145 y FB(Daryl)i(Zero,)g FC(The)f(Zer)n(o)g(E\013e)n(ct)
150 1326 y FI(This)f(c)o(hapter)h(presen)o(ts)h(a)d(formal)f(seman)o
(tics)h(for)h(MetaML)g(in)g(the)g(big-step)h(st)o(yle,)e(and)h(a)g(t)o
(yp)q(e)g(system)g(that)150 1400 y(w)o(e)18 b(ha)o(v)o(e)f(pro)o(v)o
(en)h(to)g(b)q(e)g(t)o(yp)q(e-safe)g(with)f(resp)q(ect)j(to)e(the)g
(big-step)g(seman)o(tics.)f(The)h(resulting)f(language,)150
1475 y(alb)q(eit)c(useful)g(as)h(is,)f(has)g(an)g(expressivit)o(y)h
(limitation.)c(W)m(e)i(sho)o(w)i(ho)o(w)f(this)g(shortcoming)f(can)i(b)
q(e)g(o)o(v)o(ercome)150 1550 y(b)o(y)i(explicating)g(the)h(notion)f
(of)g(a)h(Closed)g(v)n(alue)f(at)g(the)h(lev)o(el)g(of)f(t)o(yp)q(es.)h
(On)g(these)h(grounds,)e(w)o(e)h(prop)q(ose)150 1624
y(that)g(MetaML)g(b)q(e)g(extended)i(with)d(a)h(new)g(t)o(yp)q(e)g(for)
g(Closed)g(v)n(alues,)f(and)h(presen)o(t)h(a)e(big-step)h(seman)o(tics)
150 1699 y(and)d(a)f(sound)h(t)o(yp)q(e)h(system)f(for)f(the)i(prop)q
(osal.)150 1782 y(This)10 b(c)o(hapter)i(represen)o(ts)h(the)e(state)g
(of)f(the)h(art)f(in)g(\(un)o(t)o(yp)q(ed\))h(seman)o(tics)f(and)g(t)o
(yp)q(e)h(systems)g(for)f(m)o(ulti-stage)150 1857 y(programming)g
(languages.)150 2015 y FD(5.1)56 b(A)19 b(Big-Step)e(Seman)n(tics)g
(for)i(CBV)g(and)h(CBN)e Fm(\025)150 2148 y FI(F)m(ormalizing)11
b(a)k FH(big-step)g(semantics)f FI(\(see)i(for)e(example)g(Gun)o(ter)h
([33]\))e(allo)o(ws)g(us)i(to)f(sp)q(ecify)h(the)g(seman)o(tics)150
2223 y(as)i(a)g(function)g(that)g(go)q(es)g(directly)h(from)d
(expressions)j(to)f(v)n(alues.)g(W)m(e)f(b)q(egin)h(b)o(y)g(reviewing)g
(the)h(big-step)150 2298 y(seman)o(tics)13 b(for)h(the)g
FF(\025)g FI(language.)150 2381 y(Recall)f(from)f(Chapter)j(4)e(that)h
(syn)o(tax)g(for)g(the)g FF(\025)g FI(language)f(is)h(as)g(follo)o(ws:)
790 2502 y FF(e)e Fy(2)f FF(E)j FI(:=)e FF(i)18 b Fy(j)g
FF(x)g Fy(j)g FF(\025x:e)h Fy(j)f FF(e)7 b(e:)1014 2795
y FI(74)p eop
%%Page: 75 86
75 85 bop 1882 0 a FB(75)150 192 y FI(The)13 b(CBV)g(big-step)g(seman)o
(tics)f(for)g FF(\025)h FI(is)f(sp)q(eci\014ed)j(b)o(y)d(a)g(partial)g
(function)p 1372 192 13 2 v 39 w FF(,)-7 b Fy(!)p 1456
192 V 37 w FI(:)11 b FF(E)i Fy(!)e FF(E)r FI(,)i(where)g
FF(E)i FI(is)d(the)150 266 y(set)j(of)e FF(\025)h FI(expressions)501
251 y FA(1)521 266 y FI(:)p 286 401 110 2 v 292 459 a
FF(i)e(,)-7 b Fy(!)10 b FF(i)428 411 y FI(In)o(t)p 553
401 239 2 v 559 459 a FF(\025x:e)h(,)-7 b Fy(!)11 b FF(\025x:e)824
411 y FI(Lam)983 373 y FF(e)1002 379 y FA(1)1033 373
y FF(,)-7 b Fy(!)10 b FF(\025x:e)42 b(e)1230 379 y FA(2)1260
373 y FF(,)-7 b Fy(!)11 b FF(e)1337 379 y FA(3)1397 373
y FF(e)p FI([)p FF(x)g FI(:=)h FF(e)1538 379 y FA(3)1557
373 y FI(])f FF(,)-7 b Fy(!)10 b FF(e)1656 379 y FA(4)p
977 401 704 2 v 1231 459 a FF(e)1250 465 y FA(1)1283
459 y FF(e)1302 465 y FA(2)1332 459 y FF(,)-7 b Fy(!)11
b FF(e)1409 465 y FA(4)1714 411 y FI(App)p FF(:)150 558
y FI(Note)k(that)f(there)i(are)e(terms)h(for)e(whic)o(h)i(none)f(of)g
(the)h(rules)g(in)f(this)g(seman)o(tics)g(can)g(apply)g(\(either)h(b)q
(ecause)150 633 y(they)f(get)h(\\stuc)o(k")f(or)g(the)g(seman)o(tics)f
(\\go)q(es)i(in)o(to)e(an)g(in\014nite)h(lo)q(op"\).)150
716 y(The)21 b(rule)f(for)g(in)o(tegers)h(sa)o(ys)f(that)g(they)h(ev)n
(aluate)e(to)h(themselv)o(es.)g(The)h(rule)f(for)g(lam)o(b)q
(da-abstractions)150 790 y(sa)o(ys)15 b(that)g(they)h(to)q(o)f(ev)n
(aluate)g(to)f(themselv)o(es.)h(The)h(rule)f(for)g(applications)f(sa)o
(ys)h(that)g(they)h(are)f(ev)n(aluated)150 865 y(b)o(y)g(ev)n(aluating)
f(the)i(op)q(erator)g(to)g(get)f(a)h(lam)o(b)q(da-abstraction,)c
(substituting)k(the)g(result)g(of)f(ev)n(aluating)f(the)150
940 y(op)q(erand)d(in)o(to)f(the)h(b)q(o)q(dy)g(of)f(the)h(lam)o(b)q
(da-abstraction,)d(and)i(ev)n(aluating)f(the)j(result)f(of)f(the)h
(substitution.)g(The)150 1014 y(de\014nition)f(of)f(substitution)i(is)f
(standard)g(and)g(is)g(denoted)h(b)o(y)f FF(e)1150 1020
y FA(1)1169 1014 y FI([)p FF(x)h FI(:=)g FF(e)1290 1020
y FA(2)1309 1014 y FI(])f(for)f(the)i(capture-free)h(substitution)1901
999 y FA(2)150 1089 y FI(of)j FF(e)218 1095 y FA(2)252
1089 y FI(for)h(the)g(free)g(o)q(ccurrences)j(of)c FF(x)g
FI(in)g FF(e)854 1095 y FA(1)873 1089 y FI(.)g(This)h(seman)o(tics)f
(is)g(a)h(partial)e(function)i(asso)q(ciating)f(at)g(most)150
1164 y(one)f(unique)g(v)n(alue)f(to)h(an)o(y)f(expression)i(in)f(its)g
(domain.)150 1247 y(Note)e(that)g(there)h(is)e(no)h(need)h(for)e(an)g
(en)o(vironmen)o(t)g(that)h(k)o(eeps)g(trac)o(k)g(of)f(bindings)h(of)f
(v)n(ariables:)f(whenev)o(er)j(a)150 1322 y(v)n(alue)g(is)h(a)o(v)n
(ailable)d(for)i(a)h(v)n(ariable,)e(w)o(e)i(immedia)o(tely)d
(substitute)k(the)f(v)n(alue)f(for)h(the)g(v)n(ariable.)e(This)i
(substi-)150 1396 y(tution)e(is)h(p)q(erformed)f(in)g(the)h(rule)g(for)
f(applications.)f(It)i(is)f(p)q(ossible)h(to)f(implemen)o(t)e(the)j
FF(\025)g FI(language)f(directly)150 1471 y(b)o(y)h(mimi)o(c)o(king)d
(the)k(big-step)f(seman)o(tics.)f(W)m(e)h(should)g(p)q(oin)o(t)g(out,)f
(ho)o(w)o(ev)o(er,)h(that)h(a)e(direct)i(implemen)o(tation)150
1546 y(based)f(on)f(this)g(big-step)g(seman)o(tics)g(w)o(ould)f(b)q(e)i
(somewhat)e(ine\016cien)o(t,)h(as)g(ev)o(ery)h(application)e(w)o(ould)g
(require)150 1621 y(a)16 b(tra)o(v)o(ersal)h(of)f(the)h(b)q(o)q(dy)f
(of)g(the)h(lam)o(b)q(da-abstraction.)d(Most)i(realistic)h(implemen)o
(tatio)o(n)d(do)i(not)g(in)o(v)o(olv)o(e)150 1695 y(tra)o(v)o(ersing)g
(terms)g(at)g(run-time)e(to)i(p)q(erform)f(substitution,)h(and)g(th)o
(us,)g(are)g(more)f(similar)e(in)j(spirit)g(to)f(the)150
1770 y(simple)d(in)o(terpreter)k(discussed)g(in)d(Chapter)i(4.)150
1928 y FG(The)g(Closedness)f(Assumption)j FI(The)e(seman)o(tics)e
(presen)o(ted)j(ab)q(o)o(v)o(e)d(for)h(the)g FF(\025)g
FI(language)f(is)g(fairly)g(stan-)150 2002 y(dard,)g(but)g(it)g(con)o
(tains)g(an)g(imp)q(ortan)o(t)f(assumption)g(that)h(will)f(b)q(e)h
(violated)g(when)g(w)o(e)h(extend)g(the)g(language)150
2077 y(to)j(a)f(m)o(ulti-lev)o(el)e(one.)j(In)f(particular,)h(the)g
(big-step)g(seman)o(tics)f(ab)q(o)o(v)o(e)h(has)g(no)f(rule)h(for)g(ev)
n(aluating)e(v)n(ari-)150 2152 y(ables.)c(The)h(k)o(ey)g(observ)n
(ation)f(is)g(that)h(ev)n(aluating)e(a)h FH(close)n(d)h
FF(\025)f FI(term)g(using)h(this)f(big-step)h(seman)o(tics)f(do)q(es)h
(not)150 2227 y(in)o(v)o(olv)o(e)i(ev)n(aluating)g(op)q(en)i
(sub-terms.)f(This)g(claim)e(can)j(b)q(e)g(established)g(as)g(a)f(prop)
q(ert)o(y)h(of)f(the)h(deriv)n(ation)150 2301 y(tree)i(induced)f(b)o(y)
g(this)g(de\014nition)f(of)h(the)g(seman)o(tics.)f(The)h(pro)q(of)f
(pro)q(ceeds)j(b)o(y)e(induction)f(on)h(the)g(heigh)o(t)150
2376 y(of)e(the)g(deriv)n(ation:)f(The)i(claim)d(is)h(true)i(in)f(the)h
(base)g(cases)g(of)f(in)o(tegers)h(and)f(lam)o(b)q(da-abstractions,)d
(and)j(it)p 150 2456 237 2 v 158 2483 a Fz(1)188 2499
y FB(T)o(ypically)m(,)i(suc)o(h)f(a)f(seman)o(tics)h(is)f(de\014ned)i
(only)f(for)e(closed)j(terms.)d(W)m(e)h(do)g(not)h(imp)q(ose)g(this)f
(restriction)i(on)e(our)188 2545 y(seman)o(tics.)158
2575 y Fz(2)188 2590 y FB(Capture-free)f(substitution)h(means)f(that)f
(no)g(free)g(v)n(ariables)i(of)e Fx(e)1174 2594 y Fz(2)1204
2590 y FB(are)g(captured)h(b)o(y)f(b)q(ound)i(v)n(ariables)g(in)f
Fx(e)1822 2594 y Fz(1)1839 2590 y FB(.)p eop
%%Page: 76 87
76 86 bop 1882 0 a FB(76)150 192 y FI(is)16 b(true)h(b)o(y)f(induction)
g(in)g(the)h(case)g(of)f(applications.)e(In)j(the)f(case)i(of)d
(application,)g(w)o(e)h(also)g(need)h(to)f(ha)o(v)o(e)150
266 y(established)f(that)f(ev)n(aluating)e(a)i(closed)g(expression)h
(returns)h(a)d(closed)i(expression.)150 418 y FD(5.2)56
b(A)19 b(Big-Step)e(Seman)n(tics)g(for)i(CBV)g Fm(\025)p
FD(-M)150 544 y FI(Recall)13 b(from)f(Chapter)j(4)e(that)h(the)h(terms)
e(of)h FF(\025)p FI(-M)g(are:)627 657 y FF(e)e Fy(2)f
FF(E)i FI(:=)f FF(i)19 b Fy(j)f FF(x)g Fy(j)g FF(\025x:e)g
Fy(j)g FF(e)7 b(e)19 b Fy(j)f(h)p FF(e)p Fy(i)h(j)g FE(~)q
FF(e)g Fy(j)f FE(run)12 b FF(e:)150 759 y FI(T)m(o)h(de\014ne)i(the)g
(big-step)f(seman)o(tics,)g(w)o(e)g(emplo)o(y)e(a)i(\014ner)h
(classi\014cation)f(of)f(expressions.)i(F)m(or)f(example,)e(the)150
834 y(ev)n(aluation)h(of)g(a)h(term)g FE(~)q FF(e)g FI(do)q(es)h(not)f
(in)o(terest)h(us)g(b)q(ecause)g(Escap)q(es)h(should)e(not)g(o)q(ccur)h
(at)f(top)g(lev)o(el.)f(Th)o(us,)150 909 y(w)o(e)h(in)o(tro)q(duce)h
FH(expr)n(ession)g(families)737 894 y FA(3)755 909 y
FI(:)498 1006 y FF(e)517 991 y FA(0)577 1006 y Fy(2)c
FF(E)649 991 y FA(0)709 1006 y FI(:=)g FF(x)h Fy(j)f
FF(\025x:e)902 991 y FA(0)932 1006 y Fy(j)g FF(e)974
991 y FA(0)1004 1006 y FF(e)1023 991 y FA(0)1054 1006
y Fy(j)g(h)p FF(e)1112 991 y FA(1)1131 1006 y Fy(i)h(j)f
FE(run)h FF(e)1269 991 y FA(0)498 1081 y FF(e)517 1066
y Ft(n)p FA(+)577 1081 y Fy(2)f FF(E)649 1066 y Ft(n)p
FA(+)709 1081 y FI(:=)g FF(x)h Fy(j)f FF(\025x:e)902
1066 y Ft(n)p FA(+)961 1081 y Fy(j)g FF(e)1003 1066 y
Ft(n)p FA(+)1063 1081 y FF(e)1082 1066 y Ft(n)p FA(+)1142
1081 y Fy(j)g(h)p FF(e)1200 1066 y Ft(n)p FA(++)1274
1081 y Fy(i)h(j)g FE(~)q FF(e)1367 1066 y Ft(n)1401 1081
y Fy(j)f FE(run)i FF(e)1512 1066 y Ft(n)p FA(+)1560 1081
y FF(:)150 1172 y FG(Lemma)i(5.2.1)h(\(Basic)f(Prop)q(erties)e(of)j
(Expressions)d(F)l(amilies\))18 b Fy(8)p FF(n)12 b Fy(2)f
Fo(N)p FF(:)166 1269 y FH(1.)21 b FF(E)254 1254 y Ft(n)288
1269 y Fy(\022)12 b FF(E)166 1332 y FH(2.)21 b FF(E)254
1317 y Ft(n)288 1332 y Fy(\022)12 b FF(E)365 1317 y Ft(n)p
FA(+)166 1395 y FH(3.)21 b Fy(8)p FF(e)263 1401 y FA(1)293
1395 y Fy(2)11 b FF(E)365 1380 y Ft(n)388 1395 y FF(;)c(e)426
1401 y FA(2)456 1395 y Fy(2)k FF(E)528 1380 y FA(0)547
1395 y FF(:)c(e)585 1401 y FA(1)603 1395 y FI([)p FF(x)k
FI(:=)g FF(e)724 1401 y FA(2)743 1395 y FI(])g Fy(2)g
FF(E)838 1380 y Ft(n)150 1497 y FH(Pr)n(o)n(of.)20 b
FI(All)13 b(parts)i(of)e(this)h(lemma)d(are)j(pro)o(v)o(en)g(b)o(y)f
(easy)i(inductions.)150 1570 y(W)m(e)e(illustrate)h(the)h(pro)q(of)e
(of)g(the)i(\014rst)g(part)f(of)f(this)h(lemma.)c(W)m(e)k(pro)o(v)o(e)g
(that:)821 1668 y Fy(8)p FF(n)d Fy(2)g Fo(N)p FF(:)c
Fy(8)p FF(e)j Fy(2)h FF(E)1094 1651 y Ft(n)1116 1668
y FF(:)c(e)12 b Fy(2)f FF(E)r(:)150 1766 y FI(The)16
b(pro)q(of)f(pro)q(ceeds)j(b)o(y)d(induction)h(on)f(the)h(deriv)n
(ation)f(of)g FF(e)g Fy(2)f FF(E)1252 1751 y Ft(n)1275
1766 y FI(.)h(If)g FF(e)g Fy(\021)f FF(x)i FI(then)g
FF(x)e Fy(2)g FF(E)k FI(b)o(y)d(de\014nition)150 1830
y(of)g Fy(2)g FF(E)r FI(.)h(If)f FF(e)h Fy(\021)f FF(e)447
1836 y FA(1)473 1830 y FF(e)492 1836 y FA(2)527 1830
y FI(then)i(b)o(y)e(the)i(de\014nition)f(of)f Fy(2)g
FF(E)1069 1815 y Ft(n)1107 1830 y FI(w)o(e)i(kno)o(w)e(that)h
FF(e)1392 1836 y FA(1)1411 1830 y FF(;)7 b(e)1449 1836
y FA(2)1483 1830 y Fy(2)14 b FF(E)1558 1815 y Ft(n)1581
1830 y FI(.)h(By)i(the)f(induction)150 1895 y(h)o(yp)q(othesis,)e(w)o
(e)h(ha)o(v)o(e)f FF(e)543 1901 y FA(1)562 1895 y FF(;)7
b(e)600 1901 y FA(2)630 1895 y Fy(2)12 b FF(E)r FI(.)i(By)g(the)h
(de\014nition)f(of)f Fy(2)f FF(E)k FI(w)o(e)f(ha)o(v)o(e)f
FF(e)1362 1901 y FA(1)1388 1895 y FF(e)1407 1901 y FA(2)1438
1895 y Fy(2)d FF(E)r FI(.)j(The)h(treatmen)o(t)f(of)f(the)150
1960 y(rest)i(cases)g(pro)q(ceeds)h(in)e(the)g(same)f(manner.)150
2033 y(The)k(second)h(and)f(the)g(third)g(parts)h(are)f(similar.)d(The)
j(third)g(part)g(is)g(b)o(y)f(induction)h(on)f(the)i(deriv)n(ation)e
(of)150 2098 y FF(e)169 2104 y FA(1)199 2098 y Fy(2)c
FF(E)272 2083 y Ft(n)294 2098 y FI(.)1586 b Fy(u)-28
b(t)p 150 2198 237 2 v 158 2225 a Fz(3)188 2241 y FB(This)11
b(presen)o(tation)h(of)e(the)h(sets)f(of)g(expressions)i(and)f(v)n
(alues)h(is)f(a)f(sligh)o(t)i(abuse)f(of)f(notation.)h(The)f
(de\014nition)j(of)d(lev)o(el)188 2287 y(annotated)15
b(terms)e(is)h(\\essen)o(tially")i(BNF)d(in)h(that)g(it)f(de\014nes)i
(a)e(set)g(of)g(terms)g(b)o(y)g(simple)i(induction.)h(T)m(ec)o
(hnically)m(,)188 2332 y(this)h(set)g(is)f(de\014ned)i(b)o(y)e
(induction)j(on)e(the)f(heigh)o(t)i(of)d(a)i(set)f(mem)o(b)q(ership)i
(judgmen)o(t)f Fx(e)e Fn(2)h Fx(E)1626 2316 y Fl(n)1648
2332 y FB(,)f(and)i(prop)q(erties)188 2378 y(of)f(this)g(set)f(are)h
(established)i(b)o(y)e(induction)i(on)e(the)g(heigh)o(t)g(of)g(the)f
(deriv)n(ation)j(of)d(this)i(judgmen)o(t.)e(This)i(can)f(b)q(e)188
2424 y(expressed)f(in)e(more)h(traditional)i(notation)e(as)f(follo)o
(ws:)p 328 2515 132 2 v 334 2552 a Fx(x)d Fn(2)g Fx(E)432
2536 y Fl(n)567 2496 y Fx(e)g Fn(2)g Fx(E)661 2480 y
Fl(n)p 533 2515 183 2 v 539 2552 a Fx(\025x:e)h Fn(2)f
Fx(E)689 2536 y Fl(n)796 2496 y Fx(e)814 2500 y Fz(1)831
2496 y Fx(;)c(e)866 2500 y Fz(2)894 2496 y Fn(2)k Fx(E)960
2480 y Fl(n)p 790 2515 198 2 v 801 2552 a Fx(e)819 2556
y Fz(1)843 2552 y Fx(e)861 2556 y Fz(2)889 2552 y Fn(2)g
Fx(E)955 2536 y Fl(n)1071 2496 y Fx(e)g Fn(2)h Fx(E)1166
2480 y Fl(n)p Fz(+)p 1062 2515 158 2 v 1068 2552 a Fn(h)p
Fx(e)p Fn(i)f(2)g Fx(E)1192 2536 y Fl(n)1322 2496 y Fx(e)g
Fn(2)h Fx(E)1417 2480 y Fl(n)p 1294 2515 173 2 v 1301
2552 a Fw(~)q Fx(e)f Fn(2)h Fx(E)1416 2536 y Fl(n)p Fz(+)1578
2496 y Fx(e)f Fn(2)h Fx(E)1673 2480 y Fl(n)p 1540 2515
192 2 v 1546 2552 a Fw(run)g Fx(e)f Fn(2)g Fx(E)1704
2536 y Fl(n)1750 2524 y Fx(:)188 2624 y FB(W)m(e)h(will)h(use)f(the)g
(BNF)f(notation)i(as)f(a)g(shorthand)h(for)e(suc)o(h)h(de\014nitions.)i
(The)e(shorthand)h(is)f(esp)q(ecially)j(con)o(v)o(enien)o(t)188
2670 y(for)f(de\014ning)i(the)e(sets)g(of)g FC(workable)h
FB(and)g FC(stuck)h FB(terms)e(presen)o(ted)h(in)g(Chapter)f(6.)p
eop
%%Page: 77 88
77 87 bop 1882 0 a FB(77)150 178 y FI(Syn)o(tax:)632
270 y FF(e)12 b Fy(2)g FF(E)h FI(:=)19 b FF(i)f Fy(j)g
FF(x)g Fy(j)g FF(e)7 b(e)19 b Fy(j)f FF(\025x:e)h Fy(j)f(h)p
FF(e)p Fy(i)h(j)g FE(~)q FF(e)12 b Fy(j)18 b FE(run)12
b FF(e)150 361 y FI(Big-Step)i(Rules:)p 456 618 110 2
v 462 666 a FF(i)500 639 y Ft(n)488 667 y FF(,)-7 b Fy(!)545
666 y FF(i)598 627 y FI(In)o(t)p 868 618 239 2 v 874
673 a FF(\025x:e)979 645 y FA(0)964 673 y FF(,)g Fy(!)11
b FF(\025x:e)1139 627 y FI(Lam)1341 465 y FF(e)1360 471
y FA(1)1405 438 y(0)1390 465 y FF(,)-7 b Fy(!)11 b FF(\025x:e)1341
531 y(e)1360 537 y FA(2)1405 503 y(0)1390 531 y FF(,)-7
b Fy(!)11 b FF(e)1467 537 y FA(3)1341 596 y FF(e)p FI([)p
FF(x)g FI(:=)g FF(e)1481 602 y FA(3)1500 596 y FI(])1538
568 y FA(0)1523 596 y FF(,)-7 b Fy(!)11 b FF(e)1600 602
y FA(4)p 1329 618 302 2 v 1382 673 a FF(e)1401 679 y
FA(1)1433 673 y FF(e)1452 679 y FA(2)1498 645 y(0)1483
673 y FF(,)-7 b Fy(!)11 b FF(e)1560 679 y FA(4)1663 627
y FI(App)317 767 y FF(e)336 773 y FA(1)381 740 y(0)366
767 y FF(,)-7 b Fy(!)11 b(h)p FF(e)459 773 y FA(2)478
767 y Fy(i)42 b FF(e)555 773 y FA(2)600 740 y(0)585 767
y FF(,)-7 b Fy(!)11 b FF(e)662 773 y FA(3)p 311 789 376
2 v 392 844 a FE(run)i FF(e)480 850 y FA(1)525 817 y(0)510
844 y FF(,)-7 b Fy(!)11 b FF(e)587 850 y FA(3)719 798
y FI(Run)p 915 789 129 2 v 921 843 a FF(x)956 816 y Ft(n)p
FA(+)956 843 y FF(,)-7 b Fy(!)11 b FF(x)1076 798 y FI(V)m(ar+)1298
767 y FF(e)1317 773 y FA(1)1348 740 y Ft(n)p FA(+)1348
767 y FF(,)-7 b Fy(!)10 b FF(e)1424 773 y FA(3)1485 767
y FF(e)1504 773 y FA(2)1534 740 y Ft(n)p FA(+)1534 767
y FF(,)-7 b Fy(!)11 b FF(e)1611 773 y FA(4)p 1292 789
344 2 v 1340 843 a FF(e)1359 849 y FA(1)1391 843 y FF(e)1410
849 y FA(2)1441 816 y Ft(n)p FA(+)1441 843 y FF(,)-7
b Fy(!)10 b FF(e)1517 849 y FA(3)1550 843 y FF(e)1569
849 y FA(4)1668 798 y FI(App+)408 938 y FF(e)427 944
y FA(1)457 910 y Ft(n)p FA(+)457 938 y FF(,)-7 b Fy(!)11
b FF(e)534 944 y FA(2)p 343 959 276 2 v 348 1014 a FF(\025x:e)427
1020 y FA(1)457 986 y Ft(n)p FA(+)457 1014 y FF(,)-7
b Fy(!)11 b FF(\025x:e)594 1020 y FA(2)651 969 y FI(Lam+)921
938 y FF(e)940 944 y FA(1)971 910 y Ft(n)p FA(+)971 938
y FF(,)-7 b Fy(!)11 b FF(e)1048 944 y FA(2)p 883 959
222 2 v 889 1008 a Fy(h)p FF(e)924 1014 y FA(1)943 1008
y Fy(i)984 981 y Ft(n)971 1008 y FF(,)-7 b Fy(!)11 b(h)p
FF(e)1064 1014 y FA(2)1083 1008 y Fy(i)1137 969 y FI(Brk)1371
938 y FF(e)1390 944 y FA(1)1420 910 y Ft(n)p FA(+)1420
938 y FF(,)-7 b Fy(!)11 b FF(e)1497 944 y FA(2)p 1296
959 294 2 v 1302 1014 a FE(run)i FF(e)1390 1020 y FA(1)1420
986 y Ft(n)p FA(+)1420 1014 y FF(,)-7 b Fy(!)11 b FE(run)i
FF(e)1566 1020 y FA(2)1623 969 y FI(Run+)401 1109 y FF(e)420
1115 y FA(1)450 1081 y Ft(n)p FA(+)450 1109 y FF(,)-7
b Fy(!)11 b FF(e)527 1115 y FA(2)p 359 1130 229 2 v 366
1185 a FE(~)q FF(e)407 1191 y FA(1)438 1158 y Ft(n)p
FA(++)450 1185 y FF(,)-7 b Fy(!)25 b FE(~)q FF(e)563
1191 y FA(2)620 1140 y FI(Esc++)908 1109 y FF(e)927 1115
y FA(1)972 1081 y(0)957 1109 y FF(,)-7 b Fy(!)11 b(h)p
FF(e)1050 1115 y FA(2)1069 1109 y Fy(i)p 902 1130 189
2 v 913 1185 a FE(~)q FF(e)954 1191 y FA(1)1000 1158
y(1)985 1186 y FF(,)-7 b Fy(!)1042 1185 y FF(e)1061 1191
y FA(2)1123 1140 y FI(Esc)515 1319 y FG(Fig.)8 b(5.1.)14
b FI(The)g(\(Coarse\))h(CBV)f(Big-Step)g(Seman)o(tics)f(for)h
FF(\025)p FI(-M)150 1468 y(The)k(CBV)h(big-step)f(seman)o(tics)f(for)g
FF(\025)p FI(-M)h(is)g(sp)q(eci\014ed)h(b)o(y)f(a)g(partial)e(function)
p 1486 1468 13 2 v 1530 1441 a Ft(n)1517 1468 y FF(,)-7
b Fy(!)p 1584 1468 V 50 w FI(:)18 b FF(E)1677 1453 y
Ft(n)1718 1468 y Fy(!)f FF(E)1810 1453 y Ft(n)1833 1468
y FI(.)g(W)m(e)150 1543 y(pro)q(ceed)g(b)o(y)e(\014rst)h(de\014ning)f
(the)g FH(c)n(o)n(arse)j FI(function)p 977 1543 V 1016
1515 a Ft(n)1003 1543 y FF(,)-7 b Fy(!)p 1065 1543 V
41 w FI(:)13 b FF(E)j Fy(!)d FF(E)r FI(,)i(and)g(then)g(sho)o(w)g(that)
h(w)o(e)f(can)g(restrict)150 1618 y(the)h(t)o(yp)q(e)g(of)f(this)g
(function)g(to)g(arriv)o(e)g(at)h(the)g FH(\014ne)j FI(function)p
1160 1618 V 1200 1590 a Ft(n)1187 1618 y FF(,)-7 b Fy(!)p
1249 1618 V 42 w FI(:)13 b FF(E)1334 1603 y Ft(n)1371
1618 y Fy(!)g FF(E)1459 1603 y Ft(n)1482 1618 y FI(.)i(Figure)g(5.1)g
(summarizes)150 1692 y(the)e(coarse)g(CBV)f(big-step)h(seman)o(tics)e
(for)h FF(\025)p FI(-M)925 1677 y FA(4)944 1692 y FI(.)f(T)m(aking)g
FF(n)h FI(to)g(b)q(e)h(0,)e(w)o(e)h(can)h(see)g(that)f(the)h(\014rst)g
(three)g(rules)150 1767 y(corresp)q(ond)i(to)f(the)h(rules)f(of)f
FF(\025)p FI(.)150 1850 y(The)g(rule)g(for)g(Run)g(at)f(lev)o(el)h(0)f
(sa)o(ys)i(that)f(an)f(expression)i(is)f(Run)g(b)o(y)f(\014rst)i(ev)n
(aluating)d(it)i(to)g(get)g(a)f(Brac)o(k)o(eted)150 1925
y(expression,)g(and)f(then)h(ev)n(aluating)e(the)i(Brac)o(k)o(eted)h
(expression.)f(The)f(rule)h(for)f(Brac)o(k)o(ets)h(at)f(lev)o(el)g(0)g
(sa)o(ys)h(that)150 2000 y(they)g(are)g(ev)n(aluated)f(b)o(y)g
(rebuilding)g(the)h(expression)g(they)g(surround)g(at)f(lev)o(el)g(1:)g
FH(R)n(ebuilding)p FI(,)g(or)h(\\ev)n(aluating)150 2074
y(at)h(lev)o(els)h(higher)f(than)h(0",)e(eliminates)g(lev)o(el)h(1)g
(Escap)q(es.)i(Rebuilding)d(is)i(p)q(erformed)f(b)o(y)g(tra)o(v)o
(ersing)h(expres-)150 2149 y(sions)i(while)f(correctly)h(k)o(eeping)g
(trac)o(k)g(of)e(lev)o(el.)h(Th)o(us)h(rebuilding)f(simply)e(tra)o(v)o
(erses)k(a)f(term)e(un)o(til)h(a)g(lev)o(el)150 2224
y(1)h(Escap)q(e)i(is)f(encoun)o(tered,)h(at)e(whic)o(h)h(p)q(oin)o(t)f
(the)h(ev)n(aluation)e(function)h(is)h(in)o(v)o(ok)o(ed)e(in)h(the)i
(Esc)f(rule.)g(The)150 2298 y(Escap)q(ed)e(expression)g(m)o(ust)e
(yield)h(a)f(Brac)o(k)o(eted)j(expression,)e(and)g(then)g(the)h
(expression)g(itself)f(is)f(returned.)p 150 2379 237
2 v 158 2419 a Fz(4)188 2435 y FB(F)m(or)k(regularit)o(y)m(,)i(w)o(e)d
(use)p 581 2435 12 2 v 623 2410 a Fz(0)610 2435 y Fx(,)-6
b Fn(!)p 672 2435 V 47 w FB(instead)p 839 2435 V 50 w
Fx(,)g Fn(!)p 930 2435 V 30 w FB(.)17 b(This)g(w)o(a)o(y)m(,)g(b)q(oth)
g(ev)n(aluation)j(and)d(rebuildi)q(ng)j(as)d(\(describ)q(ed)188
2481 y(in)g(Chapter)f(4\))f(are)h(treated)g(as)g(one)g(partial)i
(function)f(that)e(tak)o(es)h(a)g(natural)h(n)o(um)o(b)q(er)g(as)e(an)h
(extra)g(argumen)o(t.)188 2526 y(The)f(extra)f(argumen)o(t)i(can)e
(still)j(b)q(e)d(used)h(to)g(distinguish)j(b)q(et)o(w)o(een)c(ev)n
(aluation)j(\(the)e(extra)g(argumen)o(t)g(is)g(0\))f(and)188
2572 y(rebuildin)q(g)i(\(the)d(extra)g(argumen)o(t)h(is)g(greater)f
(than)h(zero\).)p eop
%%Page: 78 89
78 88 bop 1882 0 a FB(78)150 192 y FI(An)12 b(imm)o(ediate)d(b)q
(ene\014t)k(of)e(ha)o(ving)g(suc)o(h)h(a)f(seman)o(tics)g(is)h(that)f
(it)g(pro)o(vides)h(us)g(with)f(a)h(formal)d(w)o(a)o(y)i(of)f
(\014nding)150 266 y(what)j(result)g(an)g(implem)o(en)o(tation)d(of)i
(MetaML)h FH(should)18 b FI(return)c(for)e(a)h(giv)o(en)f(expression.)h
(F)m(or)g(example,)e(it)h(is)150 341 y(easy)j(to)g(compute)f(the)h
(result)g(of)f(ev)n(aluating)g(the)h(application)e(of)h(the)i(result)f
(of)f(Running)g FE(puzzle)i FI(to)e(5)h(\(see)150 416
y(Section)f(4.4.1\):)657 532 y(\()p FE(run)e Fy(h)q FF(\025a:)q
FE(~)p FI(\(\()p FF(\025x:)p Fy(h)p FF(x)p Fy(i)p FI(\))i(\()p
FF(\025x:)p Fy(h)p FF(a)p Fy(i)p FI(\)\))g(0)p Fy(i)p
FI(\))g(5)1306 504 y FA(0)1291 532 y FF(,)-7 b Fy(!)11
b(h)p FI(5)p Fy(i)p FF(:)150 679 y FG(5.2.1)48 b(Basic)15
b(Prop)q(erties)e(of)j(Big-Step)d(Seman)o(tics)150 796
y FI(Next)h(w)o(e)g(establish)g(some)f(prop)q(erties)i(of)f(the)g(op)q
(erational)f(seman)o(tics.)g(V)m(alues)g(are)i(a)e(subset)i(of)e(terms)
h(that)150 870 y(denote)i(the)g(results)h(of)e(computations.)e(Because)
18 b(of)d(the)h(relativ)o(e)f(nature)h(of)f(Brac)o(k)o(ets)i(and)e
(Escap)q(es,)i(it)e(is)150 945 y(imp)q(ortan)o(t)d(to)h(use)h(a)f
(family)d(of)j(sets)i(for)e(v)n(alues,)g(indexed)g(b)o(y)h(the)f(lev)o
(el)h(of)e(the)i(term,)f(rather)h(than)f(just)h(one)150
1020 y(set.)g(V)m(alues)g(are)g(de\014ned)h(as)f(follo)o(ws:)430
1118 y FF(v)451 1102 y FA(0)482 1118 y Fy(2)d FF(V)555
1102 y FA(0)640 1118 y FI(:=)g FF(\025x:e)774 1102 y
FA(0)806 1118 y Fy(j)j(h)p FF(v)869 1102 y FA(1)888 1118
y Fy(i)430 1209 y FF(v)451 1194 y FA(1)482 1209 y Fy(2)d
FF(V)555 1194 y FA(1)640 1209 y FI(:=)g FF(x)j Fy(j)f
FF(v)779 1194 y FA(1)812 1209 y FF(v)833 1194 y FA(1)866
1209 y Fy(j)h FF(\025x:v)973 1194 y FA(1)1005 1209 y
Fy(j)g(h)p FF(v)1068 1194 y FA(2)1087 1209 y Fy(i)g(j)f
FE(run)24 b FF(v)1243 1194 y FA(1)375 1300 y FF(v)396
1285 y Ft(n)p FA(++)482 1300 y Fy(2)11 b FF(V)555 1285
y Ft(n)p FA(++)640 1300 y FI(:=)g FF(x)j Fy(j)f FF(v)779
1285 y Ft(n)p FA(++)867 1300 y FF(v)888 1285 y Ft(n)p
FA(++)976 1300 y Fy(j)h FF(\025x:v)1083 1285 y Ft(n)p
FA(++)1170 1300 y Fy(j)f(h)q FF(v)1233 1285 y Ft(n)p
FA(+++)1332 1300 y Fy(i)h(j)h FE(~)q FF(v)1432 1285 y
Ft(n)p FA(+)1494 1300 y Fy(j)e FE(run)25 b FF(v)1621
1285 y Ft(n)p FA(++)150 1397 y FI(In)o(tuitiv)o(ely)m(,)16
b(lev)o(el)h(0)g(v)n(alues)g(are)h(what)g(w)o(e)f(get)h(as)g(a)f
(result)h(of)f(ev)n(aluating)f(a)i(term)f(at)g(lev)o(el)g(0,)g(and)g
(lev)o(el)150 1472 y FF(n)p FI(+)e(v)n(alues)g(are)h(what)f(w)o(e)h
(get)f(from)f(rebuilding)g(a)h(term)g(at)g(lev)o(el)g
FF(n)p FI(+.)g(Th)o(us,)g(the)h(set)g(of)e(v)n(alues)h(has)h(three)150
1546 y(imp)q(ortan)o(t)d(prop)q(erties:)j(First,)f(a)g(v)n(alue)f(at)h
(lev)o(el)f(0)h(can)g(b)q(e)h(a)e(lam)o(b)q(da-abstraction)f(or)i(a)g
(Brac)o(k)o(eted)h(v)n(alue,)150 1621 y(re\015ecting)g(the)g(fact)f
(that)g(lam)o(b)q(da-abstractions)f(and)h(terms)g(represen)o(ting)i(co)
q(de)f(are)f(b)q(oth)g(considered)i(ac-)150 1696 y(ceptable)f(results)f
(from)e(a)i(computation.)d(Second,)j(v)n(alues)g(at)f(lev)o(el)h
FF(n)p FI(+)g(can)f(con)o(tain)h(applications)e(suc)o(h)j(as)150
1771 y Fy(h)p FI(\()p FF(\025y)q(:y)q FI(\))d(\()p FF(\025x:x)p
FI(\))p Fy(i)p FI(,)f(re\015ecting)h(the)g(fact)f(that)g(computations)f
(at)h(these)h(lev)o(els)g(can)f(b)q(e)h(deferred.)g(Finally)m(,)d
(there)150 1845 y(are)16 b(no)f(lev)o(el)g(1)g(Escap)q(es)i(in)e(lev)o
(el)g(1)g(v)n(alues,)f(re\015ecting)j(the)f(fact)f(that)h(ha)o(ving)e
(suc)o(h)i(an)f(Escap)q(e)i(in)e(a)g(term)150 1920 y(w)o(ould)e(mean)f
(that)h(ev)n(aluating)f(the)i(term)f(has)g(not)g(y)o(et)h(b)q(een)h
(completed.)d(Ev)n(aluation)g(is)h(not)g(complete,)f(for)150
1995 y(example,)g(in)i(terms)f(lik)o(e)g Fy(h)r FE(~)q
FI(\()p FF(f)18 b(x)p FI(\))p Fy(i)p FI(.)150 2078 y(The)c(follo)o
(wing)e(lemma)e(establishes)15 b(a)f(simple)e(y)o(et)i(imp)q(ortan)o(t)
f(prop)q(ert)o(y)h(of)g FF(\025)p FI(-M:)150 2184 y FG(Lemma)h(5.2.2)h
(\(Strong)e(V)l(alue)h(Re\015ection)e(for)i(Un)o(t)o(yp)q(ed)f(T)l
(erms\))19 b Fy(8)p FF(n)12 b Fy(2)f Fo(N)p FF(:)933
2290 y(V)966 2273 y Ft(n)p FA(+)1026 2290 y FI(=)h FF(E)1103
2273 y Ft(n)1125 2290 y FF(:)150 2400 y FH(Pr)n(o)n(of.)20
b FI(By)14 b(simple)f(induction.)1234 b Fy(u)-28 b(t)150
2521 y FI(The)17 b(lemma)c(has)k(t)o(w)o(o)f(parts:)h(One)g(sa)o(ying)f
(that)g(ev)o(ery)h(elemen)o(t)f(of)g(in)g(a)h(set)g(of)f(\(co)q(de\))i
(v)n(alues)e(is)g(also)g(an)150 2595 y(elemen)o(t)c(of)g(a)h(set)g(of)g
(expressions,)g(and)g(the)g(other,)g(sa)o(ying)f(the)i(con)o(v)o(erse.)
f(As)g(w)o(e)g(men)o(tioned)f(in)g(Chapter)i(1,)150 2670
y(b)q(oth)f(of)f(these)i(prop)q(erties)f(can)g(b)q(e)g(in)o(terpreted)i
(as)d(p)q(ositiv)o(e)g(qualities)g(of)g(a)g(m)o(ulti-lev)o(el)e
(language.)h(The)i(\014rst)p eop
%%Page: 79 90
79 89 bop 1882 0 a FB(79)150 192 y FI(part)14 b(tells)g(us)g(that)g(ev)
o(ery)h(ob)r(ject-program)e(\(v)n(alue\))g(can)h(b)q(e)h(view)o(ed)f
(as)g(a)f(meta-program,)e(and)i(the)i(second)150 266
y(part)c(tells)g(us)h(that)f(ev)o(ery)h(meta-program)d(can)i(view)o(ed)
g(as)h(an)f(ob)r(ject-program)f(\(v)n(alue\).)g(Ha)o(ving)g
(established)150 341 y(re\015ection,)k(it)e(is)h(easy)h(to)f(v)o(erify)
f(that)i(the)f(big-step)g(seman)o(tics)g(at)g(lev)o(el)g
FF(n)g FI(\()p FF(e)1423 313 y Ft(n)1410 341 y FF(,)-7
b Fy(!)10 b FF(v)q FI(\))k(alw)o(a)o(ys)e(returns)j(a)e(v)n(alue)150
416 y FF(v)g Fy(2)e FF(V)256 401 y Ft(n)278 416 y FI(:)150
510 y FG(Lemma)k(5.2.3)h(\(Basic)f(Prop)q(erties)e(of)j(Big-Step)d
(Seman)o(tics\))18 b Fy(8)p FF(n)11 b Fy(2)h Fo(N)p FF(:)166
601 y FH(1.)21 b FF(V)254 586 y Ft(n)288 601 y Fy(\022)12
b FF(V)365 586 y Ft(n)p FA(+)413 601 y FH(,)166 663 y(2.)21
b Fy(8)p FF(e;)7 b(e)301 648 y Fs(0)324 663 y Fy(2)k
FF(E)396 648 y Ft(n)419 663 y FF(:)c(e)481 635 y Ft(n)468
663 y FF(,)-7 b Fy(!)11 b FF(e)545 648 y Fs(0)568 663
y FI(=)-7 b Fy(\))12 b FF(e)666 648 y Fs(0)689 663 y
Fy(2)f FF(V)762 648 y Ft(n)784 663 y FH(.)150 758 y(Pr)n(o)n(of.)20
b FI(P)o(art)14 b(1)g(is)f(b)o(y)h(a)g(simple)e(induction)i(on)f(the)i
(deriv)n(ation)e(of)g FF(v)g Fy(2)e FF(V)1334 743 y Ft(n)1370
758 y FI(to)j(pro)o(v)o(e)g(that:)794 849 y Fy(8)p FF(n)d
Fy(2)g Fo(N)p FF(:)c Fy(8)p FF(v)k Fy(2)g FF(V)1070 832
y Ft(n)1092 849 y FF(:)c(v)13 b Fy(2)e FF(V)1217 832
y Ft(n)p FA(+)1265 849 y FF(:)150 940 y FI(P)o(art)k(2)f(is)g(also)g(a)
g(simple)f(induction)h(on)h(the)g(deriv)n(ation)e(of)h
FF(e)1175 913 y Ft(n)1162 940 y FF(,)-7 b Fy(!)12 b FF(e)1240
925 y Fs(0)1251 940 y FI(.)i(Re\015ection)h(\(Lemma)d(5.2.2\))h(is)h
(needed)150 1005 y(in)f(the)i(case)g(of)e(Run.)1398 b
Fy(u)-28 b(t)150 1105 y FG(Corollary)14 b(5.2.4)i(\(Lev)o(el)e(Preserv)
m(ation\))k Fy(8)p FF(n)12 b Fy(2)f Fo(N)p FF(:)c Fy(8)p
FF(e)1114 1111 y FA(1)1142 1105 y Fy(2)k FF(E)1214 1089
y Ft(n)1237 1105 y FF(:)c Fy(8)p FF(e)1298 1111 y FA(2)1328
1105 y Fy(2)k FF(E)r(:)840 1196 y(e)859 1202 y FA(1)902
1168 y Ft(n)889 1196 y FF(,)-7 b Fy(!)11 b FF(e)966 1202
y FA(2)996 1196 y FI(=)-7 b Fy(\))12 b FF(e)1094 1202
y FA(2)1124 1196 y Fy(2)f FF(E)1196 1179 y Ft(n)1219
1196 y FF(:)150 1291 y FH(Pr)n(o)n(of.)20 b FI(Noting)15
b(that)h FF(V)545 1276 y FA(0)578 1291 y Fy(\022)f FF(E)658
1276 y FA(0)693 1291 y FI(and)h FF(V)809 1276 y Ft(n)p
FA(+)872 1291 y FI(=)f FF(E)952 1276 y Ft(n)990 1291
y Fy(\022)g FF(E)1070 1276 y Ft(n)p FA(+)1118 1291 y
FI(,)h(this)g(result)g(is)g(immedia)o(te)e(from)g(the)j(previous)150
1356 y(lemma.)1607 b Fy(u)-28 b(t)150 1455 y FG(Remark)15
b(5.2.5)h(\(Fine)f(Big-Step)e(F)l(unction\))18 b FH(In)e(the)h(r)n(est)
e(of)h(the)h(dissertation,)e(we)h(wil)r(l)f(only)h(b)n(e)h(c)n(on-)150
1520 y(c)n(erne)n(d)e(with)f(the)h(\014ne)h(big-step)f(semantic)g
(function)p 1013 1520 13 2 v 1050 1492 a Ft(n)1037 1520
y FF(,)-7 b Fy(!)p 1097 1520 V 38 w FI(:)11 b FF(E)1178
1505 y Ft(n)1212 1520 y Fy(!)g FF(E)1298 1505 y Ft(n)1336
1520 y FH(for)j FF(\025)p FH(-M.)h(We)g(wil)r(l)f(also)h(r)n(efer)f(to)
g(it)150 1585 y(simply)g(as)i(the)e(big-step)h(semantics.)150
1730 y FG(The)j(Closedness)f(Assumption)e(Violated)22
b FI(The)16 b(seman)o(tics)g(is)g(standard)h(in)f(its)g(structure,)i
(but)f(note)150 1805 y(it)f(has)g(the)h(un)o(usual)f(feature)h(that)g
(it)f(manipulates)e FH(op)n(en)j FI(terms.)f(In)g(particular,)g
(rebuilding)g(go)q(es)g(\\under)150 1880 y(lam)o(b)q(da")d(in)i(the)h
(rule)g(Lam+,)e(and)h(Escap)q(e)j(at)d(lev)o(el)g(1)h(re-in)o(v)o(ok)o
(es)f(ev)n(aluation)f(during)i(rebuilding.)e(Th)o(us,)150
1954 y(ev)o(en)g(though)g(a)g(closed)g(term)f(suc)o(h)i(as)f
Fy(h)p FF(\025x:)q FE(~)p Fy(h)q FF(x)p Fy(i)o(i)g FI(ev)n(aluates)g
(to)g Fy(h)p FF(\025x:x)p Fy(i)f FI(\(that)h(is)g Fy(h)p
FF(\025x:)q FE(~)q Fy(h)p FF(x)p Fy(ii)1674 1927 y FA(0)1659
1954 y FF(,)-7 b Fy(!)11 b(h)p FF(\025x:x)p Fy(i)o FI(\))j(the)150
2029 y(deriv)n(ation)e(of)g(this)h(ev)n(aluation)f(in)o(v)o(olv)o(es)g
(the)i(sub-deriv)n(ation)e Fy(h)p FF(x)p Fy(i)1247 2002
y FA(0)1233 2029 y FF(,)-7 b Fy(!)10 b(h)p FF(x)p Fy(i)j
FI(whic)o(h)g(itself)g(is)f(the)i(ev)n(aluation)e(of)150
2104 y(the)i(op)q(en)h(term)e Fy(h)p FF(x)p Fy(i)p FI(.)150
2250 y FD(5.3)56 b(A)19 b(Basic)f(T)n(yp)r(e)g(System)e(for)j(MetaML)
150 2371 y FI(As)c(in)e(Chapter)i(4,)e(w)o(e)h(in)o(tro)q(duce)h(a)f
(lev)o(el-index)f(in)o(to)h(the)g(t)o(yping)g(judgmen)o(t.)e(The)i(t)o
(yp)q(e)h(judgmen)o(t)e(is)h(th)o(us)150 2446 y(extended)k(to)d(ha)o(v)
o(e)h(the)h(form)d FF(\000)20 b Fy(`)724 2431 y Ft(n)763
2446 y FF(e)15 b FI(:)g FF(\034)20 b FI(where)d FF(e)f
Fy(2)f FF(E)r FI(,)g FF(\034)20 b Fy(2)15 b FF(T)6 b
FI(,)15 b FF(\000)21 b Fy(2)14 b FF(D)q FI(,)i(and)g
FF(n)f Fy(2)g FF(N)5 b FI(.)15 b(The)i(judgemen)o(t)150
2521 y FF(\000)i Fy(`)220 2505 y Ft(n)256 2521 y FF(e)14
b FI(:)f FF(\034)20 b FI(is)15 b(read)h FH(\\)p FF(e)g
FH(has)h(typ)n(e)f FF(\034)21 b FH(at)16 b(level)f FF(n)h
FH(under)g(envir)n(onment)h FF(\000)6 b FH(")p FI(.)14
b(Again,)g(it)g(is)h(imp)q(ortan)o(t)f(to)h(note)150
2595 y(that)e(the)g(lev)o(el)g FF(n)g FI(is)g(part)g(of)f(the)h
(judgemen)o(t)f(and)h FH(not)k FI(part)c(of)g(the)g(t)o(yp)q(e.)g
(Figure)g(5.2)f(summarizes)f(the)j FF(\025)p FI(-M)150
2670 y(t)o(yp)q(e)g(system)g(that)g(w)o(e)g(study)h(in)e(this)h
(section.)p eop
%%Page: 80 91
80 90 bop 1882 0 a FB(80)150 178 y FI(Syn)o(tax:)632
270 y FF(e)12 b Fy(2)g FF(E)h FI(:=)19 b FF(i)f Fy(j)g
FF(x)g Fy(j)g FF(e)7 b(e)19 b Fy(j)f FF(\025x:e)h Fy(j)f(h)p
FF(e)p Fy(i)h(j)g FE(~)q FF(e)12 b Fy(j)18 b FE(run)12
b FF(e)150 361 y FI(T)o(yp)q(es)j(and)e(T)o(yp)q(e)i(En)o(vironmen)o
(ts:)789 450 y FF(\034)25 b Fy(2)11 b FF(T)23 b FI(:=)11
b FF(b)19 b Fy(j)f FF(\034)1058 456 y FA(1)1088 450 y
Fy(!)11 b FF(\034)1159 456 y FA(2)1196 450 y Fy(j)18
b(h)p FF(\034)5 b Fy(i)789 499 y FF(\000)17 b Fy(2)11
b FF(D)i FI(:=)e([])18 b Fy(j)11 b FF(x)g FI(:)g FF(\034)1119
484 y Ft(n)1142 499 y FI(;)c FF(\000)150 588 y FI(Op)q(erations)15
b(on)e(T)o(yp)q(e)i(En)o(vironmen)o(ts:)759 686 y FF(\000)791
671 y FA(+)818 686 y FI(\()p FF(x)p FI(\))888 662 y Ft(\001)886
686 y FI(=)d FF(\034)953 671 y Ft(n)p FA(+)1014 686 y
FI(where)j FF(\000)6 b FI(\()p FF(x)p FI(\))11 b(=)h
FF(\034)1300 671 y Ft(n)150 771 y FI(T)o(yp)q(e)i(Rules:)p
905 881 198 2 v 905 919 a FF(\000)j Fy(`)973 907 y Ft(n)1008
919 y FF(i)11 b FI(:)g FE(int)1117 891 y FI(In)o(t)270
997 y FF(\000)6 b FI(\()p FF(x)p FI(\))k(=)i FF(\034)435
981 y FA(\()p Ft(n)p Fs(\000)p Ft(m)p FA(\))p 270 1018
270 2 v 313 1056 a FF(\000)k Fy(`)380 1044 y Ft(n)415
1056 y FF(x)11 b FI(:)g FF(\034)553 1027 y FI(V)m(ar)688
997 y FF(x)g FI(:)g FF(\034)769 981 y Fs(0)781 976 y
Ft(n)803 997 y FI(;)c FF(\000)17 b Fy(`)890 981 y Ft(n)924
997 y FF(e)12 b FI(:)f FF(\034)p 676 1018 338 2 v 676
1056 a(\000)17 b Fy(`)744 1044 y Ft(n)778 1056 y FF(\025x:e)11
b FI(:)g FF(\034)914 1044 y Fs(0)937 1056 y Fy(!)h FF(\034)1027
1027 y FI(Lam)1167 997 y FF(\000)k Fy(`)1234 981 y Ft(n)1269
997 y FF(e)1288 1003 y FA(2)1318 997 y FI(:)11 b FF(\034)1364
981 y Fs(0)1417 997 y FF(\000)17 b Fy(`)1485 981 y Ft(n)1520
997 y FF(e)1539 1003 y FA(1)1569 997 y FI(:)11 b FF(\034)1615
981 y Fs(0)1638 997 y Fy(!)g FF(\034)p 1167 1018 548
2 v 1317 1056 a(\000)17 b Fy(`)1385 1044 y Ft(n)1419
1056 y FF(e)1438 1062 y FA(1)1469 1056 y FF(e)1488 1062
y FA(2)1518 1056 y FI(:)11 b FF(\034)1728 1027 y FI(App)509
1125 y FF(\000)17 b Fy(`)577 1110 y Ft(n)p FA(+)637 1125
y FF(e)12 b FI(:)f FF(\034)p 490 1147 244 2 v 490 1185
a(\000)16 b Fy(`)557 1173 y Ft(n)592 1185 y Fy(h)p FF(e)p
Fy(i)c FI(:)f Fy(h)p FF(\034)5 b Fy(i)747 1156 y FI(Brk)881
1125 y FF(\000)17 b Fy(`)949 1110 y Ft(n)983 1125 y FF(e)12
b FI(:)f Fy(h)p FF(\034)5 b Fy(i)p 873 1147 228 2 v 873
1185 a FF(\000)17 b Fy(`)941 1173 y Ft(n)p FA(+)1002
1185 y FE(~)q FF(e)12 b FI(:)f FF(\034)1114 1156 y FI(Esc)1252
1130 y FF(\000)1284 1115 y FA(+)1322 1130 y Fy(`)1347
1115 y Ft(n)1381 1130 y FF(e)h FI(:)f Fy(h)p FF(\034)5
b Fy(i)p 1247 1152 248 2 v 1247 1190 a FF(\000)17 b Fy(`)1315
1178 y Ft(n)1349 1190 y FE(run)c FF(e)f FI(:)f FF(\034)1509
1162 y FI(Run)740 1311 y FG(Fig.)d(5.2.)14 b FI(The)g
FF(\025)p FI(-M)g(T)o(yp)q(e)g(System)150 1452 y FG(5.3.1)48
b(Basic)15 b(Prop)q(erties)e(of)j(T)o(yp)q(e)f(System)150
1565 y FI(W)m(e)k(will)g(no)o(w)g(presen)o(t)i(some)e(tec)o(hnical)h
(lemmas)d(for)i FF(\025)p FI(-M)h(that)g(are)g(needed)h(to)e(establish)
h(t)o(yp)q(e-safet)o(y)m(.)150 1639 y(These)e(lemmas)13
b(establish)k(the)g(basic)f(prop)q(erties)i(of)e(the)h(t)o(yp)q(e)f
(system)g(that)h(are)g(needed)g(for)f(establishing)150
1714 y(more)d(in)o(teresting)h(prop)q(erties:)150 1825
y FG(Lemma)h(5.3.1)h(\(W)l(eak)o(ening\))j Fy(8)p FF(n;)7
b(m)k Fy(2)g Fo(N)p FF(;)c(e)i Fy(2)j FF(E)r(;)7 b(\000)16
b Fy(2)11 b FF(D)q(;)c(\034)r(;)g(\033)13 b Fy(2)e FF(T)s(:)493
1927 y(\000)17 b Fy(`)561 1909 y Ft(n)595 1927 y FF(e)12
b FI(:)f FF(\034)j Fy(^)9 b FF(x)i Fy(62)h FF(dom)p FI(\()p
FF(\000)6 b FI(\))j Fy(^)f FF(x)k Fy(62)f FI(FV)q(\()p
FF(e)p FI(\))h(=)-7 b Fy(\))11 b FF(\000)6 b FI(;)h FF(x)j
FI(:)h FF(\033)1388 1909 y Ft(m)1432 1927 y Fy(`)1457
1909 y Ft(n)1491 1927 y FF(e)h FI(:)f FF(\034)r(:)150
2033 y FH(Pr)n(o)n(of.)20 b FI(By)14 b(induction)g(on)f(the)i
(structure)h(of)d(the)i(deriv)n(ation)e FF(\000)j Fy(`)1218
2018 y Ft(n)1253 2033 y FF(e)c FI(:)f FF(\034)5 b FI(.)550
b Fy(u)-28 b(t)150 2149 y FI(A)14 b(k)o(ey)g(lemma)d(needed)k(for)f
(pro)o(ving)f(t)o(yp)q(e-safet)o(y)h(of)f(the)i(system)e(is)h(the)h
(follo)o(wing:)150 2259 y FG(Lemma)g(5.3.2)h(\(P)o(ersistence)d(of)i(T)
o(ypabilit)n(y\))j Fy(8)p FF(n)11 b Fy(2)h Fo(N)p FF(;)7
b(\000)14 b Fy(2)d FF(D)q(;)c(\034)16 b Fy(2)c FF(T)s(:)7
b Fy(8)p FF(e)12 b Fy(2)f FF(E)1540 2244 y Ft(n)1562
2259 y FF(:)775 2361 y(\000)17 b Fy(`)843 2344 y Ft(n)878
2361 y FF(e)11 b FI(:)g FF(\034)17 b Fy(\()-7 b(\))10
b FF(\000)1085 2344 y FA(+)1124 2361 y Fy(`)1149 2344
y Ft(n)p FA(+)1209 2361 y FF(e)i FI(:)f FF(\034)r(:)150
2468 y FH(Pr)n(o)n(of.)20 b FI(Eac)o(h)g(direction)h(of)e(the)h
(implication)d(is)j(b)o(y)g(a)g(simple)e(induction)i(on)f(the)i(heigh)o
(t)f(of)f(the)i(t)o(yping)150 2532 y(judgemen)o(t)c(in)h(the)g
(assumption.)e(The)j(forw)o(ard)e(direction)i(is)e(routine.)h(The)h
(bac)o(kw)o(ard)f(direction)g(is)g(also)150 2597 y(straigh)o(tforw)o
(ard,)9 b(but)i(the)g(case)h(of)e(Escap)q(e)h(is)g(notable.)f(In)g
(particular,)g(w)o(e)h(only)e(pro)o(v)o(e)i(that)f FF(\000)1671
2582 y FA(+)1710 2597 y Fy(`)1735 2582 y Ft(n)p FA(++)1821
2597 y FE(~)q FF(e)i FI(:)f FF(\034)150 2662 y FI(implies)h
FF(\000)17 b Fy(`)359 2647 y Ft(n)p FA(+)420 2662 y FE(~)q
FF(e)12 b FI(:)f FF(\034)5 b FI(,)13 b(b)q(ecause)k FE(~)q
FF(e)d FI(is)f(only)h(in)f FF(E)968 2647 y Ft(n)p FA(+)1030
2662 y FI(and)h(not)f(in)h FF(E)1266 2647 y FA(0)1285
2662 y FI(.)595 b Fy(u)-28 b(t)p eop
%%Page: 81 92
81 91 bop 1882 0 a FB(81)150 192 y FG(Notation)14 b(5.3.3)21
b FH(We)d(write)e FF(\000)682 198 y FA(1)700 192 y FF(;)7
b(\000)745 198 y FA(2)781 192 y FH(for)17 b(the)g(envir)n(onment)h
(determine)n(d)f(by)h(the)g(\(disjoint\))f(union)h(of)g(the)150
256 y(two)c(envir)n(onments)i FF(\000)510 262 y FA(1)539
256 y Fy(2)c FF(D)k FH(and)g FF(\000)736 262 y FA(2)765
256 y Fy(2)11 b FF(D)q FH(.)150 377 y FI(The)k(follo)o(wing)e(lemma)f
(sa)o(ys)j(that)g(an)o(y)g(term)f(remains)g(t)o(ypable)h(when)h(w)o(e)f
(reduce)i(the)e(lev)o(el)g(of)f(an)o(y)h(of)f(the)150
452 y(v)n(ariables)f(in)h(the)g(en)o(vironmen)o(t)f(under)i(whic)o(h)e
(the)i(term)e(is)h(t)o(ypable.)150 562 y FG(Lemma)h(5.3.4)h
(\(Co-Promotion\))h Fy(8)p FF(n)12 b Fy(2)f Fo(N)p FF(;)c(e)i
Fy(2)j FF(E)r(;)7 b(\000)1083 568 y FA(1)1100 562 y FF(;)g(\000)1145
568 y FA(2)1174 562 y Fy(2)12 b FF(D)q(;)7 b(\034)16
b Fy(2)11 b FF(T)s(:)723 665 y(\000)749 671 y FA(1)768
665 y FF(;)c(\000)819 647 y FA(+)813 676 y(2)857 665
y Fy(`)882 648 y Ft(n)916 665 y FF(e)12 b FI(:)f FF(\034)16
b FI(=)-7 b Fy(\))12 b FF(\000)1109 671 y FA(1)1127 665
y FF(;)7 b(\000)1172 671 y FA(2)1201 665 y Fy(`)1226
648 y Ft(n)1261 665 y FF(e)k FI(:)g FF(\034)r(:)150 771
y FH(Pr)n(o)n(of.)20 b FI(By)14 b(a)g(simple)e(induction)i(on)f(the)i
(deriv)n(ation)e(of)g FF(\000)1091 777 y FA(1)1109 771
y FF(;)7 b(\000)1154 777 y FA(2)1183 771 y Fy(`)1208
756 y Ft(n)1243 771 y FF(e)12 b FI(:)f FF(\034)5 b FI(.)560
b Fy(u)-28 b(t)150 888 y FI(W)m(e)14 b(will)f(no)o(w)h(in)o(tro)q(duce)
h(a)f(simple)e(notation)i(that)g(w)o(e)h(ha)o(v)o(e)f(found)g(useful)g
(for)g(writing)g(the)g(kind)g(of)g(pro)q(ofs)150 962
y(used)h(in)e(this)h(dissertation.)150 1073 y FG(Notation)g(5.3.5)i
(\(Pro)q(ofs)e(on)i(Deriv)m(ations\))h FH(Whenever)k(c)n(onvenient,)f
(pr)n(o)n(ofs)f(wil)r(l)f(b)n(e)h(laid)h(out)f(in)h(2-)150
1138 y(dimensions)14 b(to)e(r)n(e\015e)n(ct)h(that)g(we)g(ar)n(e)f(r)n
(elating)h(one)g(derivation)g(tr)n(e)n(e)f(to)h(another.)g(Symb)n(ols)g
(such)h(as)f Fr(R)5 b Fy(*)p FH(,)1859 1114 y Fr(R)1831
1138 y Fy(\()-7 b(\))o FH(,)150 1203 y(and)14 b Fr(R)5
b Fy(+)15 b FH(wil)r(l)d(b)n(e)i(use)n(d)g(for)f(\(one-)h(or)f
(two-way\))g(implic)n(ations,)g(wher)n(e)g FF(R)h FH(is)f(the)h(list)f
(of)h(rules)f(use)n(d)h(to)f(achieve)150 1267 y(this)18
b(implic)n(ation.)g(F)m(or)g(rules,)g(we)g(instantiate)g
FF(R)h FH(with)f Fy(`)h FH(when)f(we)g(have)i(applie)n(d)e(the)h(rules)
f(of)g(the)h(typ)n(e)150 1332 y(system,)c Fy(\006)g FH(for)f
(arithmetic,)g(and)h FF(I)s(H)k FH(for)14 b(use)h(of)g(the)g(induction)
g(hyp)n(othesis.)150 1405 y(Pr)n(o)n(ofs)g(start)h(fr)n(om)f(the)h
(left)f(and)h(pr)n(o)n(c)n(e)n(e)n(d)g(either)f(up,)h(down,)g(or)g
(right.)f(We)h(go)g(up)h(or)e(down)h(dep)n(ending)h(on)150
1470 y(the)e(normal)g(orientation)f(of)h(the)g(p)n(articular)f(rule)g
(that)h(is)g(b)n(eing)g(use)n(d)g(in)g(an)h(implic)n(ation.)150
1543 y(Horizontal)e(implic)n(ations)h(ar)n(e)f(aligne)n(d)h(with)f
(their)h(pr)n(e)n(c)n(e)n(dents)f(and)i(ante)n(c)n(e)n(dents.)150
1654 y FG(Lemma)f(5.3.6)h(\(Substitu)o(ti)o(on)o(\))i
Fy(8)p FF(n;)7 b(m)k Fy(2)g Fo(N)p FF(;)c(\000)979 1660
y FA(1)995 1654 y FF(;)g(\000)1040 1660 y FA(2)1069 1654
y Fy(2)k FF(D)q(;)c(\034)r(;)g(\033)13 b Fy(2)e FF(T)s(:)c
Fy(8)p FF(e)1365 1660 y FA(1)1396 1654 y Fy(2)k FF(E)1468
1639 y Ft(n)1491 1654 y FF(;)c(e)1529 1660 y FA(2)1559
1654 y Fy(2)k FF(E)1631 1639 y Ft(m)1662 1654 y FF(:)436
1756 y(\000)462 1762 y FA(1)480 1756 y FF(;)c(\000)525
1762 y FA(2)542 1756 y FI(;)g FF(x)k FI(:)g FF(\033)644
1739 y Ft(m)687 1756 y Fy(`)712 1739 y Ft(n)747 1756
y FF(e)766 1762 y FA(1)796 1756 y FI(:)h FF(\034)i Fy(^)8
b FF(\000)914 1762 y FA(2)944 1756 y Fy(`)969 1739 y
Ft(m)1013 1756 y FF(e)1032 1762 y FA(2)1062 1756 y FI(:)j
FF(\033)i FI(=)-7 b Fy(\))11 b FF(\000)1226 1762 y FA(1)1244
1756 y FF(;)c(\000)1289 1762 y FA(2)1319 1756 y Fy(`)1344
1739 y Ft(n)1378 1756 y FF(e)1397 1762 y FA(1)1416 1756
y FI([)p FF(x)k FI(:=)g FF(e)1537 1762 y FA(2)1556 1756
y FI(])g(:)g FF(\034)r(:)150 1863 y FH(Pr)n(o)n(of.)20
b FI(By)14 b(induction)g(on)f(the)i(deriv)n(ation)e(of)g(the)i
(judgemen)o(t)e FF(\000)1202 1869 y FA(1)1220 1863 y
FF(;)7 b(\000)1265 1869 y FA(2)1282 1863 y FI(;)g FF(x)k
FI(:)g FF(\033)1384 1848 y Ft(m)1427 1863 y Fy(`)1452
1848 y Ft(n)1487 1863 y FF(e)1506 1869 y FA(1)1536 1863
y FI(:)g FF(\034)5 b FI(.)176 1965 y FG({)21 b FI(V)m(ariables)14
b(I:)h FF(e)463 1971 y FA(1)496 1965 y Fy(\021)g FF(y)g
Fy(6\021)g FF(x)p FI(,)f(w)o(e)i(already)f(kno)o(w)g
FF(\000)1022 1971 y FA(1)1040 1965 y FF(;)7 b(\000)1085
1971 y FA(2)1103 1965 y FI(;)g FF(x)13 b FI(:)h FF(\033)1210
1950 y Ft(m)1255 1965 y Fy(`)1280 1950 y Ft(n)1317 1965
y FF(e)1336 1971 y FA(2)1369 1965 y FI(:)g FF(\034)20
b FI(and)15 b(b)o(y)h(w)o(eak)o(ening)f(w)o(e)g(ha)o(v)o(e)221
2030 y FF(\000)247 2036 y FA(1)265 2030 y FF(;)7 b(\000)310
2036 y FA(2)339 2030 y Fy(`)364 2015 y Ft(n)398 2030
y FF(e)417 2036 y FA(2)448 2030 y FI(:)k FF(\034)5 b
FI(.)176 2094 y FG({)21 b FI(V)m(ariables)15 b(I)q(I:)h
FF(e)481 2100 y FA(1)516 2094 y Fy(\021)f FF(x)p FI(,)h(then)h(from)d
(the)j(t)o(yping)f(rule)g(for)g(v)n(ariables)g(w)o(e)g(kno)o(w)g(that)g
FF(n)g FI(=)f FF(m)d FI(+)f FF(m)1825 2079 y Fs(0)1853
2094 y FI(and)221 2159 y(that)16 b FF(\033)h Fy(\021)f
FF(\034)5 b FI(,)16 b(for)g(some)f(natural)h(n)o(um)o(b)q(er)g
FF(m)963 2144 y Fs(0)975 2159 y FI(.)g(W)m(e)g(already)g(kno)o(w)g
FF(\000)1363 2165 y FA(1)1397 2159 y Fy(`)1422 2144 y
Ft(m)1469 2159 y FF(e)1488 2165 y FA(2)1523 2159 y FI(:)f
FF(\033)q FI(.)h(By)h(w)o(eak)o(ening)f(w)o(e)221 2223
y(ha)o(v)o(e)g FF(\000)345 2229 y FA(1)364 2223 y FF(;)7
b(\000)409 2229 y FA(2)443 2223 y Fy(`)468 2208 y Ft(m)517
2223 y FF(e)536 2229 y FA(2)572 2223 y FI(:)16 b FF(\033)q
FI(.)h(By)g(p)q(ersistence)j(of)d(t)o(ypabilit)o(y)e(w)o(e)i(ha)o(v)o
(e)g FF(\000)1375 2208 y Ft(m)1404 2196 y Fk(0)1369 2234
y FA(1)1417 2223 y FF(;)7 b(\000)1468 2208 y Ft(m)1497
2196 y Fk(0)1462 2234 y FA(2)1527 2223 y Fy(`)1552 2208
y Ft(m)p FA(+)p Ft(m)1635 2196 y Fk(0)1667 2223 y FF(e)1686
2229 y FA(2)1721 2223 y FI(:)17 b FF(\033)q FI(.)g(By)g
FF(m)1908 2208 y Fs(0)221 2288 y FI(applications)12 b(of)i
(co-promotion)d(w)o(e)k(ha)o(v)o(e)e FF(\000)935 2294
y FA(1)953 2288 y FF(;)7 b(\000)998 2294 y FA(2)1028
2288 y Fy(`)1053 2273 y Ft(m)p FA(+)p Ft(m)1136 2261
y Fk(0)1162 2288 y FF(e)1181 2294 y FA(2)1212 2288 y
FI(:)k FF(\033)k FI(and)f(w)o(e)g(are)g(done.)176 2352
y FG({)21 b FI(Lam)o(b)q(da-abstraction)12 b(I:)h FF(e)659
2358 y FA(1)690 2352 y Fy(\021)e FF(\025y)q(:e)p FI(,)k(and)e
FF(y)h Fy(6\021)e FF(x)p FI(.)h(By)h(Barendregt's)h(con)o(v)o(en)o
(tion,)e FF(y)h Fy(62)d FI(FV)q(\()p FF(e)1738 2358 y
FA(2)1757 2352 y FI(\).)341 2480 y Fk(`)5 b Fy(*)431
2450 y FF(\000)457 2456 y FA(1)475 2450 y FF(;)i(\000)520
2456 y FA(2)537 2450 y FI(;)g FF(x)k FI(:)g FF(\033)639
2434 y Ft(m)671 2450 y FI(;)c FF(y)13 b FI(:)e FF(\034)764
2456 y FA(3)783 2434 y Ft(n)817 2450 y Fy(`)842 2434
y Ft(n)876 2450 y FF(e)h FI(:)f FF(\034)948 2456 y FA(4)p
413 2471 573 2 v 418 2516 a FF(\000)444 2522 y FA(1)463
2516 y FF(;)c(\000)508 2522 y FA(2)525 2516 y FI(;)g
FF(x)k FI(:)g FF(\033)627 2501 y Ft(m)670 2516 y Fy(`)695
2501 y Ft(n)730 2516 y FF(\025y)q(:e)h FI(:)f FF(\034)859
2522 y FA(3)889 2516 y Fy(!)g FF(\034)960 2522 y FA(4)1028
2427 y Fr(I)r(H)1014 2450 y FI(=)-7 b Fy(\))47 b FF(\000)1154
2456 y FA(1)1172 2450 y FF(;)7 b(\000)1217 2456 y FA(2)1235
2450 y FI(;)g FF(y)12 b FI(:)g FF(\034)1328 2456 y FA(3)1346
2434 y Ft(n)1380 2450 y Fy(`)1405 2434 y Ft(n)1440 2450
y FF(e)p FI([)p FF(x)f FI(:=)g FF(e)1580 2456 y FA(2)1599
2450 y FI(])g(:)g FF(\034)1663 2456 y FA(4)p 1110 2471
591 2 v 1116 2516 a FF(\000)1142 2522 y FA(1)1160 2516
y FF(;)c(\000)1205 2522 y FA(2)1234 2516 y Fy(`)1259
2501 y Ft(n)1293 2516 y FF(\025y)q(:e)p FI([)p FF(x)12
b FI(:=)f FF(e)1491 2522 y FA(2)1510 2516 y FI(])g(:)g
FF(\034)1574 2522 y FA(3)1605 2516 y Fy(!)g FF(\034)1676
2522 y FA(4)1712 2480 y Fk(`)p Fr(;)p Fq(:=)5 b Fy(+)176
2605 y FG({)21 b FI(Lam)o(b)q(da-abstraction)12 b(I)q(I:)h
FF(e)675 2611 y FA(1)706 2605 y Fy(\021)f FF(\025y)q(:e)p
FI(,)i(and)g FF(y)f Fy(\021)f FF(x)p FI(.)h(By)i(w)o(eak)o(ening,)e(w)o
(e)h(ha)o(v)o(e)g FF(\000)1519 2611 y FA(1)1537 2605
y FF(;)7 b(\000)1582 2611 y FA(2)1611 2605 y Fy(`)1636
2590 y Ft(n)1670 2605 y FF(\025y)q(:e)13 b FI(:)e FF(\034)1800
2611 y FA(3)1830 2605 y Fy(!)g FF(\034)1901 2611 y FA(4)221
2670 y FI(and)i(w)o(e)h(are)h(done.)p eop
%%Page: 82 93
82 92 bop 1882 0 a FB(82)176 192 y FG({)21 b FI(Applications:)394
374 y Fk(`)5 b Fy(*)471 276 y FF(\000)497 282 y FA(1)515
276 y FF(;)i(\000)560 282 y FA(2)578 276 y FI(;)g FF(x)k
FI(:)g FF(\033)680 261 y Ft(m)723 276 y Fy(`)748 261
y Ft(n)782 276 y FF(e)801 282 y FA(3)832 276 y FI(:)g
FF(\034)873 282 y FA(1)903 276 y Fy(!)g FF(\034)471 341
y(\000)497 347 y FA(1)515 341 y FF(;)c(\000)560 347 y
FA(2)578 341 y FI(;)g FF(x)k FI(:)g FF(\033)680 326 y
Ft(m)723 341 y Fy(`)748 326 y Ft(n)782 341 y FF(e)801
347 y FA(4)832 341 y FI(:)g FF(\034)873 347 y FA(1)p
460 362 532 2 v 497 407 a FF(\000)523 413 y FA(1)541
407 y FF(;)c(\000)586 413 y FA(2)604 407 y FI(;)g FF(x)k
FI(:)g FF(\033)706 392 y Ft(m)749 407 y Fy(`)774 392
y Ft(n)808 407 y FF(e)827 413 y FA(3)858 407 y FF(e)877
413 y FA(4)907 407 y FI(:)g FF(\034)1022 253 y Fr(I)r(H)1008
277 y FI(=)-7 b Fy(\))1022 318 y Fr(I)r(H)1008 342 y
FI(=)g Fy(\))1104 276 y FF(\000)1130 282 y FA(1)1148
276 y FF(;)7 b(\000)1193 282 y FA(2)1222 276 y Fy(`)1247
261 y Ft(n)1282 276 y FF(e)1301 282 y FA(3)1320 276 y
FI([)p FF(x)k FI(:=)g FF(e)1441 282 y FA(2)1460 276 y
FI(])g(:)g FF(\034)1524 282 y FA(1)1554 276 y Fy(!)g
FF(\034)1104 341 y(\000)1130 347 y FA(1)1148 341 y FF(;)c(\000)1193
347 y FA(2)1222 341 y Fy(`)1247 326 y Ft(n)1282 341 y
FF(e)1301 347 y FA(4)1320 341 y FI([)p FF(x)k FI(:=)g
FF(e)1441 347 y FA(2)1460 341 y FI(])g(:)g FF(\034)1524
347 y FA(1)p 1092 362 550 2 v 1114 407 a FF(\000)1140
413 y FA(1)1158 407 y FF(;)c(\000)1203 413 y FA(2)1232
407 y Fy(`)1257 392 y Ft(n)1292 407 y FI(\()p FF(e)1327
413 y FA(3)1357 407 y FF(e)1376 413 y FA(4)1395 407 y
FI(\)[)p FF(x)k FI(:=)g FF(e)1532 413 y FA(2)1551 407
y FI(])g(:)h FF(\034)1659 374 y Fk(`)p Fr(;)p Fq(:=)5
b Fy(+)176 484 y FG({)21 b FI(Brac)o(k)o(ets:)450 591
y Fk(`)t Fy(*)538 560 y FF(\000)564 566 y FA(1)582 560
y FF(;)7 b(\000)627 566 y FA(2)645 560 y FI(;)g FF(x)j
FI(:)h FF(\033)746 545 y Ft(m)790 560 y Fy(`)815 545
y Ft(n)p FA(+1)891 560 y FF(e)h FI(:)f FF(\034)p 521
581 465 2 v 527 627 a(\000)553 633 y FA(1)571 627 y FF(;)c(\000)616
633 y FA(2)633 627 y FI(;)g FF(x)k FI(:)g FF(\033)735
612 y Ft(m)778 627 y Fy(`)803 612 y Ft(n)838 627 y Fy(h)p
FF(e)p Fy(i)h FI(:)f Fy(h)p FF(\034)5 b Fy(i)1028 537
y Fr(I)r(H)1014 561 y FI(=)-7 b Fy(\))1127 560 y FF(\000)1153
566 y FA(1)1171 560 y FF(;)7 b(\000)1216 566 y FA(2)1245
560 y Fy(`)1270 545 y Ft(n)p FA(+1)1347 560 y FF(e)p
FI([)p FF(x)k FI(:=)g FF(e)1487 566 y FA(2)1506 560 y
FI(])g(:)g FF(\034)p 1110 581 483 2 v 1116 627 a(\000)1142
633 y FA(1)1160 627 y FF(;)c(\000)1205 633 y FA(2)1234
627 y Fy(`)1259 612 y Ft(n)1293 627 y Fy(h)p FF(e)p Fy(i)q
FI([)p FF(x)k FI(:=)g FF(e)1466 633 y FA(2)1485 627 y
FI(])g(:)g Fy(h)p FF(\034)5 b Fy(i)1604 591 y Fk(`)p
Fr(;)p Fq(:=)g Fy(+)176 703 y FG({)21 b FI(Escap)q(es:)457
818 y Fk(`)5 b Fy(*)551 787 y FF(\000)577 793 y FA(1)595
787 y FF(;)i(\000)640 793 y FA(2)658 787 y FI(;)g FF(x)j
FI(:)h FF(\033)759 772 y Ft(m)803 787 y Fy(`)828 772
y Ft(n)862 787 y FF(e)h FI(:)f Fy(h)p FF(\034)5 b Fy(i)p
529 808 465 2 v 535 854 a FF(\000)561 860 y FA(1)579
854 y FF(;)i(\000)624 860 y FA(2)641 854 y FI(;)g FF(x)k
FI(:)g FF(\033)743 839 y Ft(m)786 854 y Fy(`)811 839
y Ft(n)p FA(+1)889 854 y FE(~)q FF(e)h FI(:)f FF(\034)1036
764 y Fr(I)r(H)1022 788 y FI(=)-7 b Fy(\))1132 787 y
FF(\000)1158 793 y FA(1)1176 787 y FF(;)7 b(\000)1221
793 y FA(2)1250 787 y Fy(`)1275 772 y Ft(n)1310 787 y
FF(e)p FI([)p FF(x)k FI(:=)g FF(e)1450 793 y FA(2)1469
787 y FI(])g(:)g Fy(h)p FF(\034)5 b Fy(i)p 1118 808 467
2 v 1124 854 a FF(\000)1150 860 y FA(1)1168 854 y FF(;)i(\000)1213
860 y FA(2)1242 854 y Fy(`)1267 839 y Ft(n)p FA(+)1328
854 y FE(~)q FF(e)p FI([)p FF(x)k FI(:=)h FF(e)1491 860
y FA(2)1510 854 y FI(])f(:)g FF(\034)1596 818 y Fk(`)p
Fr(;)p Fq(:=)5 b Fy(+)176 930 y FG({)21 b FI(Run:)398
1037 y Fk(`)5 b Fy(*)475 1006 y FF(\000)507 988 y FA(+1)501
1017 y(1)551 1006 y FF(;)i(\000)602 988 y FA(+1)596 1017
y(2)645 1006 y FI(;)g FF(x)j FI(:)h FF(\033)746 991 y
Ft(m)p FA(+1)832 1006 y Fy(`)857 991 y Ft(n)891 1006
y FF(e)h FI(:)f Fy(h)p FF(\034)5 b Fy(i)p 470 1027 537
2 v 509 1073 a FF(\000)535 1079 y FA(1)554 1073 y FF(;)i(\000)599
1079 y FA(2)616 1073 y FI(;)g FF(x)k FI(:)g FF(\033)718
1057 y Ft(m)761 1073 y Fy(`)786 1057 y Ft(n)821 1073
y FE(run)h FF(e)g FI(:)f FF(\034)1049 983 y Fr(I)r(H)1035
1007 y FI(=)-7 b Fy(\))1137 1006 y FF(\000)1169 988 y
FA(+1)1163 1017 y(1)1212 1006 y FF(;)7 b(\000)1263 988
y FA(+1)1257 1017 y(2)1317 1006 y Fy(`)1342 991 y Ft(n)1377
1006 y FF(e)p FI([)p FF(x)k FI(:=)g FF(e)1517 1012 y
FA(2)1536 1006 y FI(])g(:)g Fy(h)q FF(\034)5 b Fy(i)p
1131 1027 513 2 v 1150 1073 a FF(\000)1176 1079 y FA(1)1194
1073 y FF(;)i(\000)1239 1079 y FA(2)1268 1073 y Fy(`)1293
1057 y Ft(n)1327 1073 y FE(run)13 b FF(e)p FI([)p FF(x)e
FI(:=)g FF(e)1536 1079 y FA(2)1555 1073 y FI(])h(:)f
FF(\034)1655 1037 y Fk(`)p Fr(;)p Fq(:=)5 b Fy(+)1892
1127 y(u)-28 b(t)150 1274 y FD(5.4)56 b(T)n(yp)r(e-Safet)n(y)150
1396 y FI(While)12 b(the)h(statemen)o(t)f(and)h(pro)q(of)f(of)g(the)h
(T)o(yp)q(e-Safet)o(y)g(lemma)c(for)j FF(\025)p FI(-M)h(will)e(seem)h
(quite)h(straigh)o(tforw)o(ard,)150 1470 y(w)o(e)h(cannot)g(o)o(v)o
(er-emphasize)f(the)h(imp)q(ortance)f(of)g(de\014ning)h(carefully)f
(what)h(is)g(mean)o(t)e(b)o(y)i(t)o(yp)q(e-safet)o(y)g(for)f(a)150
1545 y(particular)e(language.)g(W)m(e)g(sp)q(ecify)h(the)h(o)q
(ccurrence)h(of)d(a)h(run-time)e(error)j(b)o(y)e(\014rst)i(augmen)o
(ting)c(the)k(big-step)150 1620 y(seman)o(tics)i(to)f(return)j(an)d
(error)i(v)n(alue)f FE(err)h FI(when)f(an)g(undesirable)g(condition)g
(tak)o(es)g(place.)g(Th)o(us,)g(the)g(t)o(yp)q(e)150
1695 y(of)h(the)h(big-step)f(seman)o(tic)f(function)h(b)q(ecomes)p
942 1695 13 2 v 983 1667 a Ft(n)970 1695 y FF(,)-7 b
Fy(!)p 1034 1695 V 45 w FI(:)15 b FF(E)1122 1679 y Ft(n)1160
1695 y Fy(!)g FI(\()p FF(E)1266 1679 y Ft(n)1300 1695
y Fy([)10 b(f)p FE(err)r Fy(g)p FI(\).)15 b(Second,)i(w)o(e)f(in)o(tro)
q(duce)h(an)150 1769 y(additional)c(set)j(of)e(rules)h(to)g(propagate)f
(this)h(v)n(alue)f(if)g(it)h(is)f(returned)j(b)o(y)d(sub-computations.)
f(The)i(\014rst)h(set)150 1844 y(of)d(rules)i(that)f(m)o(ust)f(b)q(e)h
(added)g(to)g(the)h(big-step)f(seman)o(tics)f(is)h(as)g(follo)o(ws:)p
583 1965 152 2 v 589 2022 a FF(x)639 1994 y FA(0)624
2022 y FF(,)-7 b Fy(!)11 b FE(err)768 1974 y FI(V)m(arErr)959
1936 y FF(e)978 1942 y FA(1)1023 1908 y(0)1009 1935 y
FF(,)-7 b Fy(!)1066 1936 y FF(e)1085 1942 y FA(3)1146
1936 y FF(e)1165 1942 y FA(3)1195 1936 y Fy(6\021)12
b FF(\025x:e)p 953 1965 371 2 v 1035 2022 a(e)1054 2028
y FA(1)1087 2022 y FF(e)1106 2028 y FA(2)1151 1994 y(0)1137
2022 y FF(,)-7 b Fy(!)10 b FE(err)1356 1974 y FI(AppErr)497
2112 y FF(e)516 2118 y FA(1)562 2084 y(0)547 2111 y FF(,)-7
b Fy(!)605 2112 y FF(e)624 2118 y FA(2)684 2112 y FF(e)703
2118 y FA(2)734 2112 y Fy(6\021)11 b(h)q FF(e)p Fy(i)p
492 2140 344 2 v 552 2198 a FE(run)h FF(e)639 2204 y
FA(1)685 2170 y(0)670 2197 y FF(,)-7 b Fy(!)727 2198
y FE(err)867 2150 y FI(SRnErr)1071 2112 y FF(e)1090 2118
y FA(1)1135 2084 y(0)1121 2111 y FF(,)g Fy(!)1178 2112
y FF(e)1197 2118 y FA(2)1258 2112 y FF(e)1277 2118 y
FA(2)1307 2112 y Fy(6\021)12 b(h)p FF(e)p Fy(i)p 1065
2140 V 1149 2198 a FE(~)q FF(e)1190 2204 y FA(1)1235
2170 y(1)1221 2197 y FF(,)-7 b Fy(!)1278 2198 y FE(err)1441
2150 y FI(Esc1Err)1591 2062 y FF(:)150 2280 y FI(W)m(e)13
b(also)f(add)h(propagation)e(rules)j(that)f(simply)e(return)j(an)f
(error)h(if)e(the)h(result)h(of)e(a)h(sub-computation)e(is)i(an)150
2355 y(error.)150 2438 y(The)i(most)e(subtle)i(of)e(these)j(error)f
(cases)h(to)e(iden)o(tify)g(has)g(b)q(een)i(the)f(one)f(for)g(v)n
(ariables.)f(In)i(particular,)e(it)h(is)150 2512 y(v)o(ery)f(easy)g(to)
f(forget)g(to)h(add)f(this)g(rule)h(as)g(an)f(error-emitting)f(case,)i
(and)f(then)h(it)g(b)q(ecomes)f(v)o(ery)h(hard)f(to)h(see)150
2587 y(wh)o(y)h(it)f(is)h(still)f(p)q(ossible)h(to)g(\\pro)o(v)o(e")f
(incorrect)i(t)o(yp)q(e-safet)o(y)g(theorems.)150 2670
y(Finally)m(,)c(it)j(is)g(instructiv)o(e)g(to)g(note)g(that)g(there)h
(is)f(a)g(sligh)o(t)f(redundancy)i(in)e(this)h(t)o(yp)q(ed)h(treatmen)o
(t)e(of)g FF(\025)p FI(-M:)p eop
%%Page: 83 94
83 93 bop 1882 0 a FB(83)150 192 y FG(Lemma)15 b(5.4.1)21
b Fy(8)p FF(n)12 b Fy(2)f Fo(N)p FF(;)c Fy(8)p FF(e)i
Fy(2)i FF(E)r(;)c(\000)17 b Fy(2)11 b FF(D)q(;)c(\034)16
b Fy(2)11 b FF(T)s(:)832 291 y(\000)17 b Fy(`)900 274
y Ft(n)934 291 y FF(e)12 b FI(:)f FF(\034)16 b FI(=)-7
b Fy(\))12 b FF(e)g Fy(2)f FF(E)1204 274 y Ft(n)1227
291 y FF(:)150 394 y FH(Pr)n(o)n(of.)20 b FI(By)14 b(a)g(simple)e
(induction)i(on)f(the)i(deriv)n(ation)e(of)g FF(\000)k
Fy(`)1133 379 y Ft(n)1167 394 y FF(e)12 b FI(:)f FF(\034)5
b FI(.)636 b Fy(u)-28 b(t)150 508 y FI(Th)o(us,)19 b(if)g(w)o(e)h(are)g
(only)f(in)o(terested)i(in)e(t)o(yp)q(ed)i(terms,)e(w)o(e)g(do)h(not)f
(\(strictly)h(sp)q(eaking\))g(need)h(the)f(family)150
582 y(classi\014cation)14 b(on)f(expressions.)i(Ho)o(w)o(ev)o(er,)f(as)
g(w)o(e)g(will)f(see)i(in)e(Chapter)i(6,)e(this)h(classi\014cation)g
(is)f(signi\014can)o(t)150 657 y(to)h(the)g(treatmen)o(t)g(of)f(the)i
(un)o(t)o(yp)q(ed)f(language.)150 740 y(Re\015ection)k(for)g(a)g(t)o
(yp)q(ed)h(m)o(ulti-lev)o(el)c(language)i(can)h(b)q(e)h(view)o(ed)f(as)
g(the)h(existence)h(of)d(a)h(corresp)q(ondence)150 815
y(b)q(et)o(w)o(een)f(programs)d Fy(;)g(`)556 800 y FA(0)589
815 y FF(e)g FI(:)f FF(\034)21 b FI(and)15 b(program)e(represen)o
(tations)18 b Fy(;)13 b(`)1284 800 y FA(0)1317 815 y
Fy(h)q FF(v)q Fy(i)h FI(:)g Fy(h)p FF(\034)5 b Fy(i)p
FI(.)15 b(This)g(prop)q(ert)o(y)h(holds)f(for)150 890
y FF(\025)p FI(-M.)e(It)h(is)g(an)g(instance)h(of)e(the)h(follo)o(wing)
e(result:)150 990 y FG(Lemma)j(5.4.2)h(\(Strong)e(V)l(alue)h
(Re\015ection)e(for)i(T)o(yp)q(ed)g(T)l(erms\))20 b Fy(8)p
FF(n)26 b Fy(2)f Fo(N)p FF(;)7 b(\000)29 b Fy(2)c FF(D)q(;)7
b(\034)30 b Fy(2)c FF(T)s(;)7 b(v)27 b Fy(2)150 1055
y FF(V)183 1040 y Ft(n)p FA(+)232 1055 y FF(;)7 b(e)k
Fy(2)g FF(E)353 1040 y Ft(n)376 1055 y FF(:)166 1154
y FH(1.)21 b FF(\000)253 1139 y FA(+)291 1154 y Fy(`)316
1139 y Ft(n)p FA(+)376 1154 y FF(v)13 b FI(:)e FF(\034)17
b FI(=)-7 b Fy(\))11 b FF(\000)17 b Fy(`)613 1139 y Ft(n)647
1154 y FF(v)c FI(:)e FF(\034)5 b FH(,)166 1218 y(2.)21
b FF(\000)16 b Fy(`)288 1203 y Ft(n)323 1218 y FF(e)c
FI(:)f FF(\034)16 b FI(=)-7 b Fy(\))12 b FI(\()p FF(\000)538
1203 y FA(+)576 1218 y Fy(`)601 1203 y Ft(n)p FA(+)661
1218 y FF(e)g FI(:)f FF(\034)j Fy(^)9 b FF(e)j Fy(2)f
FF(V)888 1203 y Ft(n)p FA(+)936 1218 y FI(\))p FH(.)150
1321 y(Pr)n(o)n(of.)20 b FI(P)o(art)c(1)g(is)g(b)o(y)f(induction)h(on)f
(the)i(deriv)n(ation)e(of)g FF(\000)1114 1306 y FA(+)1156
1321 y Fy(`)1181 1306 y Ft(n)p FA(+)1244 1321 y FF(v)i
FI(:)d FF(\034)5 b FI(,)15 b(and)h(case)h(analysis)e(on)h
FF(v)g Fy(2)f FF(V)1860 1306 y Ft(n)p FA(+)1908 1321
y FI(.)150 1386 y(P)o(art)f(2)g(is)f(b)o(y)h(induction)g(on)f(the)i
(deriv)n(ation)e(of)g FF(\000)k Fy(`)1002 1371 y Ft(n)1036
1386 y FF(e)12 b FI(:)f FF(\034)5 b FI(.)767 b Fy(u)-28
b(t)150 1493 y FG(Lemma)15 b(5.4.3)h(\(Basic)f(Prop)q(ert)o(y)f(of)i
(Augmen)o(ted)d(Seman)o(tics\))18 b Fy(8)p FF(n)11 b
Fy(2)g Fo(N)p FF(:)c Fy(8)p FF(e;)g(e)1570 1478 y Fs(0)1591
1493 y Fy(2)k FF(E)1663 1478 y Ft(n)1686 1493 y FF(:)772
1593 y(e)816 1565 y Ft(n)803 1593 y FF(,)-7 b Fy(!)11
b FF(e)880 1576 y Fs(0)903 1593 y FI(=)-7 b Fy(\))11
b FF(e)1000 1576 y Fs(0)1024 1593 y Fy(2)g FI(\()p FF(V)1113
1576 y Ft(n)1145 1593 y Fy([)d(f)p FE(err)r Fy(g)p FI(\))p
FF(:)150 1696 y FH(Pr)n(o)n(of.)20 b FI(By)15 b(a)g(simple)f(induction)
h(on)g(the)g(deriv)n(ation)f(of)h FF(e)1121 1669 y Ft(n)1108
1696 y FF(,)-7 b Fy(!)13 b FF(e)1187 1681 y Fs(0)1199
1696 y FI(.)h(Re\015ection)i(\(Lemma)c(5.2.2\))i(is)h(needed)h(in)150
1761 y(the)e(case)h(of)f(Run.)1446 b Fy(u)-28 b(t)150
1913 y FG(The)18 b(Closedness)e(Assumption)f(Re\014ned)22
b FI(As)16 b(w)o(e)h(ha)o(v)o(e)f(p)q(oin)o(ted)g(out)f(earlier,)h(an)g
(imp)q(ortan)o(t)e(feature)150 1988 y(in)j(the)h FF(\025)g
FI(language)e(is)i(that)f(reductions)i(alw)o(a)o(ys)d(op)q(erate)i(on)g
(closed)g(terms.)e(W)m(e)h(ha)o(v)o(e)h(also)f(p)q(oin)o(ted)g(out)150
2062 y(that)d(this)g(assumption)e(is)i(violated)f(in)h(the)g(big-step)g
(seman)o(tics)g(of)f FF(\025)p FI(-M,)g(b)q(ecause)j(rebuilding)d(go)q
(es)h(\\under)150 2137 y(lam)o(b)q(da".)f(A)j(crucial)g(observ)n(ation)
g(allo)o(ws)e(us)j(to)f(con)o(tin)o(ue)g(the)g(formal)e(dev)o(elopmen)o
(t)h(of)g(MetaML)i(in)e(the)150 2212 y(usual)i(manner:)e(All)h(terms)h
(are)g(closed)g(with)g(resp)q(ect)i(to)d(v)n(ariables)g(b)q(ound)h(at)g
(lev)o(el)f(0.)h(This)f(observ)n(ation)150 2287 y(dictates)f(the)f
(general)g(form)e(of)i(the)g(statemen)o(t)g(of)f(the)i(T)o(yp)q(e)f
(Preserv)n(ation)h(Theorem:)150 2394 y FG(Theorem)g(5.4.4)h(\(T)o(yp)q
(e)f(Preserv)m(ation)e(for)i(CBV)i FF(\025)p FG(-M\))k
Fy(8)p FF(n)11 b Fy(2)g Fo(N)p FF(;)c(\000)15 b Fy(2)c
FF(D)q(;)c(\034)16 b Fy(2)11 b FF(T)s(:)c(e)12 b Fy(2)g
FF(E)1712 2379 y Ft(n)1734 2394 y FF(;)7 b(v)13 b Fy(2)e
FF(V)1859 2379 y Ft(n)1881 2394 y FF(:)699 2494 y(\000)731
2476 y FA(+)770 2494 y Fy(`)795 2476 y Ft(n)829 2494
y FF(e)h FI(:)f FF(\034)j Fy(^)9 b FF(e)996 2466 y Ft(n)983
2494 y FF(,)-7 b Fy(!)11 b FF(v)i FI(=)-7 b Fy(\))11
b FF(\000)1184 2476 y FA(+)1223 2494 y Fy(`)1248 2476
y Ft(n)1282 2494 y FF(v)i FI(:)e FF(\034)r(:)150 2597
y FH(Pr)n(o)n(of.)20 b FI(By)14 b(induction)g(on)f(the)i(deriv)n(ation)
e(of)g FF(e)945 2569 y Ft(n)932 2597 y FF(,)-7 b Fy(!)11
b FF(v)q FI(.)j(The)g(case)h(for)e(application)g(uses)i(Substitution.)
150 2670 y(The)f(case)h(analysis)e(pro)q(ceeds)j(as)e(follo)o(ws:)p
eop
%%Page: 84 95
84 94 bop 1882 0 a FB(84)176 192 y FG({)21 b FI(V)m(ariables)13
b(I:)g FF(n)f FI(=)f(0)j(is)g(v)n(acuous,)f(b)q(ecause)j(w)o(e)e(can)g
(nev)o(er)h(deriv)o(e)f(the)h(t)o(yp)q(e)f(judgmen)o(t)f(in)g(this)h
(case.)176 254 y FG({)21 b FI(V)m(ariables)13 b(I)q(I:)g
FF(n)f(>)g FI(0)h(is)h(trivial)e(b)q(ecause)k FF(x)926
227 y Ft(n)p FA(+)926 254 y FF(,)-7 b Fy(!)11 b FF(x)p
FI(.)176 317 y FG({)21 b FI(Lam)o(b)q(da-abstraction)13
b(I:)h(In)o(terestingly)m(,)g(no)h(induction)g(is)f(needed)j(here.)e
(In)g(particular,)f FF(\025x:e)1785 290 y FA(0)1770 317
y FF(,)-7 b Fy(!)13 b FF(\025x:e)p FI(.)221 382 y(By)h(de\014nition,)f
FF(\025x:e)e Fy(2)g FF(V)645 367 y FA(0)663 382 y FI(,)j(and)f(from)g
(the)h(premise)g FF(\000)1124 367 y FA(+)1162 382 y Fy(`)1187
367 y FA(0)1218 382 y FF(\025x:e)d FI(:)g FF(\034)5 b
FI(.)176 445 y FG({)21 b FI(Lam)o(b)q(da-abstraction)12
b(I)q(I:)h(Straigh)o(tforw)o(ard)g(induction:)235 569
y Fk(`)t Fy(*)331 539 y FF(\000)363 524 y FA(+)390 539
y FI(;)7 b FF(x)j FI(:)i FF(\034)490 524 y Ft(n)485 549
y FA(1)524 539 y Fy(`)549 524 y Ft(n)583 539 y FF(e)g
FI(:)f FF(\034)p 306 560 380 2 v 312 605 a(\000)344 590
y FA(+)382 605 y Fy(`)407 590 y Ft(n)441 605 y FF(\025x:e)h
FI(:)f FF(\034)573 611 y FA(1)603 605 y Fy(!)g FF(\034)696
569 y Fr(,)-5 b Fk(!)5 b Fy(*)847 539 y FF(e)878 511
y Ft(n)p FA(+)878 539 y FF(,)-7 b Fy(!)11 b FF(e)955
524 y Fs(0)p 782 560 251 2 v 788 609 a FF(\025x:e)878
582 y Ft(n)p FA(+)878 609 y FF(,)-7 b Fy(!)11 b FF(\025x:e)1015
594 y Fs(0)1063 516 y Fr(I)r(H)1050 540 y FI(=)-7 b Fy(\))1169
539 y FF(e)1188 524 y Fs(0)1212 539 y Fy(2)11 b FF(V)1284
524 y Ft(n)p FA(+)p 1134 560 235 2 v 1140 605 a FF(\025x:e)1219
590 y Fs(0)1242 605 y Fy(2)g FF(V)1314 590 y Ft(n)p FA(+)1380
569 y Fr(V)f Fy(+)1481 539 y FF(\000)1513 524 y FA(+)1540
539 y FI(;)d FF(x)j FI(:)h FF(\034)1639 524 y Ft(n)1634
549 y FA(1)1673 539 y Fy(`)1698 524 y Ft(n)1733 539 y
FF(e)1752 524 y Fs(0)1775 539 y FI(:)g FF(\034)p 1456
560 391 2 v 1462 605 a(\000)1494 590 y FA(+)1532 605
y Fy(`)1557 590 y Ft(n)1591 605 y FF(\025x:e)1670 590
y Fs(0)1693 605 y FI(:)g FF(\034)1734 611 y FA(1)1765
605 y Fy(!)g FF(\034)1858 569 y Fk(`)5 b Fy(+)150 692
y FI(Application)10 b(I)g(and)h(Run)f(I)g(follo)o(w)f(a)i(more)e(in)o
(v)o(olv)o(ed)g(but)i(similar)e(pattern.)i(The)g(other)g(cases)h(are)f
(b)o(y)f(straigh)o(t-)150 757 y(forw)o(ard)j(induction.)176
853 y FG({)21 b FI(Applications)12 b(I:)g(First,)h(w)o(e)g(use)h(the)g
(induction)e(h)o(yp)q(othesis)i(\(t)o(wice\))g(,)e(whic)o(h)h(giv)o(es)
g(us)g(a)g(result)h(that)f(w)o(e)221 918 y(can)h(use)g(with)g(the)g
(substitution)h(lemma)10 b(\(:=\):)421 1174 y Fk(`)5
b Fy(*)481 1076 y FF(\000)513 1061 y FA(+)552 1076 y
Fy(`)577 1061 y Ft(n)611 1076 y FF(e)630 1082 y FA(1)661
1076 y FI(:)11 b FF(\034)702 1082 y FA(1)732 1076 y Fy(!)g
FF(\034)481 1140 y(\000)513 1125 y FA(+)552 1140 y Fy(`)577
1125 y Ft(n)611 1140 y FF(e)630 1146 y FA(2)661 1140
y FI(:)g FF(\034)702 1146 y FA(1)p 475 1161 339 2 v 481
1207 a FF(\000)513 1192 y FA(+)552 1207 y Fy(`)577 1192
y Ft(n)611 1207 y FF(e)630 1213 y FA(1)661 1207 y FF(e)680
1213 y FA(2)710 1207 y FI(:)g FF(\034)819 1238 y Fr(,)-5
b Fk(!)5 b Fy(*)894 1076 y FF(e)913 1082 y FA(1)956 1048
y Ft(n)943 1076 y FF(,)-7 b Fy(!)11 b FF(\025x:e)894
1140 y(e)913 1146 y FA(2)956 1113 y Ft(n)943 1140 y FF(,)-7
b Fy(!)11 b FF(e)1020 1125 y Fs(0)1020 1151 y FA(2)894
1205 y FF(e)p FI([)p FF(x)g FI(:=)g FF(e)1034 1190 y
Fs(0)1034 1215 y FA(2)1053 1205 y FI(])1089 1178 y Ft(n)1076
1205 y FF(,)-7 b Fy(!)11 b FF(e)1153 1190 y Fs(0)p 888
1226 283 2 v 894 1272 a FF(e)937 1244 y Ft(n)925 1272
y FF(,)-7 b Fy(!)10 b FF(e)1001 1256 y Fs(0)1190 1053
y Fr(I)r(H)1176 1076 y FI(=)-7 b Fy(\))1190 1118 y Fr(I)r(H)1176
1141 y FI(=)g Fy(\))1301 1010 y FF(\000)1333 995 y FA(+)1360
1010 y FI(;)7 b FF(x)k FI(:)g FF(\034)1460 995 y Ft(n)1455
1020 y FA(1)1494 1010 y Fy(`)1519 995 y Ft(n)1553 1010
y FF(e)h FI(:)f FF(t)p 1272 1031 380 2 v 1278 1076 a(\000)1310
1061 y FA(+)1348 1076 y Fy(`)1373 1061 y Ft(n)1408 1076
y FF(\025x:e)g FI(:)g FF(\034)1539 1082 y FA(1)1570 1076
y Fy(!)g FF(\034)1663 1041 y Fk(`)5 b Fy(*)1338 1141
y FF(\000)1370 1126 y FA(+)1408 1141 y Fy(`)1433 1126
y Ft(n)1467 1141 y FF(e)1486 1126 y Fs(0)1486 1152 y
FA(2)1517 1141 y FI(:)11 b FF(\034)1558 1147 y FA(1)p
1272 1162 370 2 v 1278 1208 a FF(\000)1310 1193 y FA(+)1348
1208 y Fy(`)1373 1193 y Ft(n)1408 1208 y FF(e)p FI([)p
FF(x)g FI(:=)g FF(e)1548 1193 y Fs(0)1548 1218 y FA(2)1567
1208 y FI(])g(:)g FF(\034)1654 1172 y Fq(:=)5 b Fy(+)221
1361 y FI(Note)11 b(that)f(w)o(e)h(w)o(e)g(are)g(also)f(using)h(the)g
(judgmen)o(t)e FF(\000)1053 1346 y FA(+)1080 1361 y FI(;)e
FF(x)k FI(:)g FF(\034)1180 1346 y Ft(n)1175 1371 y FA(1)1214
1361 y Fy(`)1239 1346 y Ft(n)1273 1361 y FF(e)h FI(:)f
FF(\034)16 b FI(when)11 b(w)o(e)g(apply)f(the)h(substitution)221
1426 y(lemma)o(.)i(Then,)j(based)g(on)g(this)g(information)c(ab)q(out)k
FF(e)p FI([)p FF(x)e FI(:=)h FF(e)1244 1432 y FA(2)1263
1426 y FI(])g(w)o(e)h(apply)f(the)i(induction)e(h)o(yp)q(othesis)221
1491 y(for)e(the)i(third)e(time)g(to)h(get)g FF(e)693
1475 y Fs(0)716 1491 y Fy(2)e FF(V)789 1475 y Ft(n)826
1491 y FI(and)h FF(\000)938 1475 y FA(+)977 1491 y Fy(`)1002
1475 y Ft(n)1036 1491 y FF(e)1055 1475 y Fs(0)1079 1491
y FI(:)e FF(\034)5 b FI(.)176 1553 y FG({)21 b FI(Applications)13
b(I)q(I:)268 1747 y Fk(`)5 b Fy(*)345 1649 y FF(\000)377
1634 y FA(+)416 1649 y Fy(`)441 1634 y Ft(n)475 1649
y FF(e)494 1655 y FA(1)525 1649 y FI(:)11 b FF(\034)566
1655 y FA(1)596 1649 y Fy(!)g FF(\034)345 1714 y(\000)377
1699 y FA(+)416 1714 y Fy(`)441 1699 y Ft(n)475 1714
y FF(e)494 1720 y FA(2)525 1714 y FI(:)g FF(\034)566
1720 y FA(1)p 334 1735 350 2 v 371 1781 a FF(\000)403
1766 y FA(+)442 1781 y Fy(`)467 1766 y Ft(n)501 1781
y FF(e)520 1787 y FA(1)551 1781 y FF(e)570 1787 y FA(2)600
1781 y FI(:)g FF(\034)701 1747 y Fr(,)-5 b Fk(!)t Fy(*)836
1647 y FF(e)855 1653 y FA(1)886 1620 y Ft(n)p FA(+)886
1647 y FF(,)e Fy(!)10 b FF(e)962 1632 y Fs(0)962 1658
y FA(1)836 1716 y FF(e)855 1722 y FA(2)886 1689 y Ft(n)p
FA(+)886 1716 y FF(,)-7 b Fy(!)10 b FF(e)962 1701 y Fs(0)962
1727 y FA(2)p 781 1737 256 2 v 787 1787 a FF(e)806 1793
y FA(1)836 1787 y FF(e)855 1793 y FA(2)886 1760 y Ft(n)p
FA(+)886 1787 y FF(,)-7 b Fy(!)10 b FF(e)962 1772 y Fs(0)962
1797 y FA(1)993 1787 y FF(e)1012 1772 y Fs(0)1012 1797
y FA(2)1068 1627 y Fr(I)r(H)1054 1650 y FI(=)-7 b Fy(\))1068
1691 y Fr(I)r(H)1054 1715 y FI(=)g Fy(\))1169 1649 y
FF(e)1188 1634 y Fs(0)1188 1660 y FA(1)1218 1649 y Fy(2)11
b FF(V)1291 1634 y Ft(n)p FA(+)1169 1714 y FF(e)1188
1699 y Fs(0)1188 1724 y FA(2)1218 1714 y Fy(2)g FF(V)1291
1699 y Ft(n)p FA(+)p 1138 1735 232 2 v 1144 1781 a FF(e)1163
1766 y Fs(0)1163 1791 y FA(1)1193 1781 y FF(e)1212 1766
y Fs(0)1212 1791 y FA(2)1243 1781 y Fy(2)g FF(V)1316
1766 y Ft(n)p FA(+)1387 1747 y Fr(V)f Fy(+)1469 1649
y FF(\000)1501 1634 y FA(+)1539 1649 y Fy(`)1564 1634
y Ft(n)1599 1649 y FF(e)1618 1634 y Fs(0)1618 1660 y
FA(1)1648 1649 y FI(:)h FF(\034)1689 1655 y FA(1)1719
1649 y Fy(!)g FF(\034)1469 1714 y(\000)1501 1699 y FA(+)1539
1714 y Fy(`)1564 1699 y Ft(n)1599 1714 y FF(e)1618 1699
y Fs(0)1618 1724 y FA(2)1648 1714 y FI(:)g FF(\034)1689
1720 y FA(1)p 1457 1735 350 2 v 1495 1781 a FF(\000)1527
1766 y FA(+)1565 1781 y Fy(`)1590 1766 y Ft(n)1624 1781
y FF(e)1643 1766 y Fs(0)1643 1791 y FA(1)1674 1781 y
FF(e)1693 1766 y Fs(0)1693 1791 y FA(2)1723 1781 y FI(:)g
FF(\034)1824 1747 y Fk(`)5 b Fy(+)176 1870 y FG({)21
b FI(Brac)o(k)o(et:)372 1986 y Fk(`)t Fy(*)468 1955 y
FF(\000)500 1940 y FA(+)539 1955 y Fy(`)564 1940 y Ft(n)p
FA(+)624 1955 y FF(e)11 b FI(:)g FF(\034)p 443 1977 283
2 v 449 2022 a(\000)481 2007 y FA(+)519 2022 y Fy(`)544
2007 y Ft(n)579 2022 y Fy(h)p FF(e)p Fy(i)h FI(:)f Fy(h)p
FF(\034)5 b Fy(i)737 1986 y Fr(,)-5 b Fk(!)t Fy(*)861
1955 y FF(e)892 1928 y Ft(n)p FA(+)892 1955 y FF(,)e
Fy(!)11 b FF(e)969 1940 y Fs(0)p 823 1977 196 2 v 829
2026 a Fy(h)p FF(e)p Fy(i)892 1999 y Ft(n)p FA(+)892
2026 y FF(,)-7 b Fy(!)11 b(h)p FF(e)985 2011 y Fs(0)997
2026 y Fy(i)1050 1933 y Fr(I)r(H)1036 1956 y FI(=)-7
b Fy(\))1155 1955 y FF(e)1174 1940 y Fs(0)1197 1955 y
Fy(2)12 b FF(V)1270 1940 y Ft(n)p 1120 1977 208 2 v 1126
2022 a Fy(h)p FF(e)1161 2007 y Fs(0)1173 2022 y Fy(i)g(2)f
FF(V)1273 2007 y Ft(n)p FA(+)1339 1986 y Fr(V)f Fy(+)1440
1955 y FF(\000)1472 1940 y FA(+)1511 1955 y Fy(`)1536
1940 y Ft(n)p FA(+)1596 1955 y FF(e)1615 1940 y Fs(0)1638
1955 y FI(:)h FF(\034)p 1415 1977 295 2 v 1421 2022 a(\000)1453
2007 y FA(+)1491 2022 y Fy(`)1516 2007 y Ft(n)1551 2022
y Fy(h)p FF(e)1586 2007 y Fs(0)1598 2022 y Fy(i)g FI(:)g
Fy(h)p FF(\034)5 b Fy(i)1721 1986 y Fk(`)g Fy(+)176 2108
y FG({)21 b FI(Escap)q(e)15 b(I:)416 2298 y Fk(`)t Fy(*)481
2268 y FF(\000)513 2253 y FA(+)551 2268 y Fy(`)576 2253
y FA(0)607 2268 y FF(e)d FI(:)f Fy(h)p FF(\034)5 b Fy(i)p
475 2289 247 2 v 481 2334 a FF(\000)513 2319 y FA(+)551
2334 y Fy(`)576 2319 y FA(1)608 2334 y FE(~)q FF(e)12
b FI(:)f FF(\034)745 2298 y Fr(,)-5 b Fk(!)t Fy(*)825
2268 y FF(e)870 2240 y FA(0)856 2268 y FF(,)e Fy(!)10
b(h)p FF(e)948 2253 y Fs(0)960 2268 y Fy(i)p 819 2289
164 2 v 825 2339 a FF(e)870 2312 y FA(0)856 2339 y FF(,)-7
b Fy(!)10 b FF(e)932 2324 y Fs(00)1002 2245 y Fr(I)r(H)988
2268 y FI(=)-7 b Fy(\))1100 2203 y FF(e)1119 2188 y Fs(0)1143
2203 y Fy(2)11 b FF(V)1215 2188 y FA(1)p 1078 2224 178
2 v 1084 2269 a Fy(h)p FF(e)1119 2254 y Fs(0)1131 2269
y Fy(i)h(2)f FF(V)1232 2254 y FA(0)1267 2233 y Fr(V)g
Fy(*)1382 2203 y FF(\000)1414 2188 y FA(++)1478 2203
y Fy(`)1503 2188 y FA(1)1533 2203 y FF(e)1552 2188 y
Fs(0)1576 2203 y FI(:)g FF(\034)p 1344 2224 317 2 v 1350
2269 a(\000)1382 2254 y FA(++)1445 2269 y Fy(`)1470 2254
y FA(0)1501 2269 y Fy(h)p FF(e)1536 2254 y Fs(0)1548
2269 y Fy(i)h FI(:)f Fy(h)p FF(\034)5 b Fy(i)1671 2233
y Fk(`)g Fy(*)176 2486 y FG({)21 b FI(Escap)q(e)15 b(I)q(I:)401
2610 y Fk(`)5 b Fy(*)487 2580 y FF(\000)519 2565 y FA(+)557
2580 y Fy(`)582 2565 y Ft(n)616 2580 y FF(e)12 b FI(:)f
Fy(h)q FF(\034)5 b Fy(i)p 473 2601 267 2 v 479 2646 a
FF(\000)511 2631 y FA(+)549 2646 y Fy(`)574 2631 y Ft(n)p
FA(+)635 2646 y FE(~)q FF(e)12 b FI(:)f FF(\034)751 2610
y Fr(,)-5 b Fk(!)t Fy(*)866 2580 y FF(e)897 2552 y Ft(n)p
FA(+)896 2580 y FF(,)e Fy(!)11 b FF(e)973 2565 y Fs(0)p
837 2601 178 2 v 844 2651 a FE(~)q FF(e)897 2623 y Ft(n)p
FA(+)896 2651 y FF(,)-7 b Fy(!)12 b FE(~)q FF(e)996 2636
y Fs(0)1045 2557 y Fr(I)r(H)1031 2581 y FI(=)-7 b Fy(\))1146
2580 y FF(e)1165 2565 y Fs(0)1188 2580 y Fy(2)11 b FF(V)1261
2565 y Ft(n)p 1116 2601 198 2 v 1122 2646 a FE(~)q FF(e)1163
2631 y Fs(0)1187 2646 y Fy(2)g FF(V)1260 2631 y Ft(n)p
FA(+)1325 2610 y Fr(V)g Fy(+)1415 2580 y FF(\000)1447
2565 y FA(+)1485 2580 y Fy(`)1510 2565 y Ft(n)1545 2580
y FF(e)1564 2565 y Fs(0)1587 2580 y FI(:)g Fy(h)q FF(\034)5
b Fy(i)p 1401 2601 279 2 v 1407 2646 a FF(\000)1439 2631
y FA(+)1477 2646 y Fy(`)1502 2631 y Ft(n)p FA(+)1563
2646 y FE(~)q FF(e)1604 2631 y Fs(0)1628 2646 y FI(:)11
b FF(\034)1691 2610 y Fk(`)5 b Fy(+)p eop
%%Page: 85 96
85 95 bop 1882 0 a FB(85)176 192 y FG({)21 b FI(Run)13
b(I:)g(Similar)d(to)k(application,)d(except)k(that)f(w)o(e)f(use)i(p)q
(ersistence)h(of)d(t)o(ypabilit)o(y)m(.)e(First,)i(w)o(e)h(apply)e(the)
221 256 y(induction)h(h)o(yp)q(othesis)i(once,)f(then)g(reconstruct)i
(the)f(t)o(yp)q(e)f(judgmen)o(t)f(of)g(the)i(result:)540
483 y Fk(`)5 b Fy(*)600 417 y FF(\000)632 402 y FA(++)696
417 y Fy(`)721 402 y FA(0)751 417 y FF(e)12 b FI(:)f
Fy(h)p FF(\034)5 b Fy(i)p 594 438 283 2 v 600 483 a FF(\000)632
468 y FA(+)670 483 y Fy(`)695 468 y FA(0)726 483 y FE(run)12
b FF(e)g FI(:)f FF(\034)883 515 y Fr(,)-5 b Fk(!)t Fy(*)957
414 y FF(e)1003 387 y FA(0)988 414 y FF(,)e Fy(!)11 b(h)p
FF(e)1081 399 y Fs(0)1093 414 y Fy(i)957 484 y FF(e)976
469 y Fs(0)993 484 y Fy(#)1028 457 y FA(0)1014 484 y
FF(,)-7 b Fy(!)10 b FF(e)1090 469 y Fs(00)p 951 505 167
2 v 957 556 a FF(e)1003 528 y FA(0)988 556 y FF(,)-7
b Fy(!)11 b FF(e)1065 541 y Fs(0)o(0)1137 394 y Fr(I)r(H)1123
418 y FI(=)-7 b Fy(\))1257 352 y FF(\000)1289 337 y FA(++)1353
352 y Fy(`)1378 337 y FA(1)1409 352 y FF(e)1428 337 y
Fs(0)1451 352 y FI(:)11 b FF(\034)p 1219 373 317 2 v
1225 419 a(\000)1257 404 y FA(++)1321 419 y Fy(`)1346
404 y FA(0)1376 419 y Fy(h)p FF(e)1411 404 y Fs(0)1423
419 y Fy(i)h FI(:)f Fy(h)p FF(\034)5 b Fy(i)1547 383
y Fk(`)t Fy(*)221 644 y FI(By)15 b(applying)e(p)q(ersistence)18
b(of)c(t)o(ypabilit)o(y)f(to)i(the)g(top-most)f(result)h(in)g(w)o(e)g
(get)g FF(\000)1539 629 y FA(+)1579 644 y Fy(`)1604 629
y FA(0)1636 644 y FF(e)1655 629 y Fs(0)1680 644 y FI(:)e
FF(\034)5 b FI(.)14 b(Applying)221 709 y(the)g(induction)g(h)o(yp)q
(othesis)g(again)f(w)o(e)h FF(\000)885 694 y FA(+)923
709 y Fy(`)948 694 y FA(0)979 709 y FF(e)998 694 y Fs(00)1031
709 y FI(:)d FF(\034)5 b FI(.)176 771 y FG({)21 b FI(Run)13
b(I)q(I:)313 887 y Fk(`)5 b Fy(*)396 856 y FF(\000)428
841 y FA(++)491 856 y Fy(`)516 841 y Ft(n)551 856 y FF(e)12
b FI(:)f Fy(h)p FF(\034)5 b Fy(i)p 384 877 287 2 v 390
922 a FF(\000)422 907 y FA(+)460 922 y Fy(`)485 907 y
Ft(n)520 922 y FE(run)13 b FF(e)e FI(:)h FF(\034)683
887 y Fr(,)-5 b Fk(!)t Fy(*)843 856 y FF(e)874 828 y
Ft(n)p FA(+)874 856 y FF(,)e Fy(!)10 b FF(e)950 841 y
Fs(0)p 768 877 269 2 v 774 927 a FE(run)j FF(e)874 899
y Ft(n)p FA(+)874 927 y FF(,)-7 b Fy(!)10 b FE(run)j
FF(e)1019 912 y Fs(0)1068 833 y Fr(I)r(H)1054 857 y FI(=)-7
b Fy(\))1178 856 y FF(e)1197 841 y Fs(0)1221 856 y Fy(2)11
b FF(V)1294 841 y Ft(n)p FA(+)p 1138 877 244 2 v 1144
922 a FE(run)i FF(e)1232 907 y Fs(0)1255 922 y Fy(2)e
FF(V)1328 907 y Ft(n)p FA(+)1393 887 y Fr(V)g Fy(+)1481
856 y FF(\000)1513 841 y FA(++)1576 856 y Fy(`)1601 841
y Ft(n)1636 856 y FF(e)1655 841 y Fs(0)1678 856 y FI(:)g
Fy(h)q FF(\034)5 b Fy(i)p 1469 877 299 2 v 1475 922 a
FF(\000)1507 907 y FA(+)1545 922 y Fy(`)1570 907 y Ft(n)1605
922 y FE(run)13 b FF(e)1693 907 y Fs(0)1716 922 y FI(:)e
FF(\034)1779 887 y Fk(`)5 b Fy(+)1892 982 y(u)-28 b(t)150
1086 y FG(Theorem)15 b(5.4.5)h(\(T)o(yp)q(e-Safet)o(y)e(for)h(CBV)h
FF(\025)p FG(-M\))21 b Fy(8)p FF(n)11 b Fy(2)h Fo(N)p
FF(;)7 b(\000)14 b Fy(2)d FF(D)q(;)c(\034)16 b Fy(2)c
FF(T)s(:)7 b Fy(8)p FF(e)12 b Fy(2)f FF(E)1601 1070 y
Ft(n)1623 1086 y FF(;)c(v)13 b Fy(2)e FF(V)1748 1070
y Ft(n)1770 1086 y FF(:)741 1181 y(\000)773 1164 y FA(+)811
1181 y Fy(`)836 1164 y Ft(n)871 1181 y FF(e)g FI(:)g
FF(\034)k Fy(^)8 b FF(e)1037 1154 y Ft(n)1024 1181 y
FF(,)-7 b Fy(!)11 b FF(v)i FI(=)-7 b Fy(\))11 b FF(v)j
Fy(6\021)d FE(err)r FF(:)150 1281 y FH(Pr)n(o)n(of.)20
b FI(F)m(ollo)o(ws)12 b(directly)i(from)f(T)o(yp)q(e)h(Preserv)n
(ation.)871 b Fy(u)-28 b(t)150 1431 y FD(5.5)56 b(A)19
b(Big-Step)e(Seman)n(tics)g(for)i(CBN)g Fm(\025)p FD(-M)150
1555 y FI(The)10 b(di\013erence)i(b)q(et)o(w)o(een)g(the)e(CBN)h(seman)
o(tics)e(and)h(the)h(CBV)f(seman)o(tics)g(for)f FF(\025)p
FI(-M)h(is)g(only)f(in)h(the)g(ev)n(aluation)150 1630
y(rule)k(for)g(application)e(at)i(lev)o(el)f(0.)h(F)m(or)f(CBN,)h(this)
g(rule)g(b)q(ecomes)683 1725 y FF(e)702 1731 y FA(1)748
1697 y(0)733 1725 y FF(,)-7 b Fy(!)11 b FF(\025x:e)41
b(e)p FI([)p FF(x)11 b FI(:=)g FF(e)1051 1731 y FA(2)1070
1725 y FI(])1108 1697 y FA(0)1093 1725 y FF(,)-7 b Fy(!)11
b FF(v)p 678 1754 501 2 v 838 1812 a(e)857 1818 y FA(1)890
1812 y FF(e)909 1818 y FA(2)954 1784 y(0)939 1811 y FF(,)-7
b Fy(!)997 1812 y FF(v)1211 1764 y FI(App{CBN)q FF(:)150
1898 y FI(Figure)15 b(5.3)e(summarizes)g(the)i(full)e(seman)o(tics.)h
(The)h(T)o(yp)q(e)g(Preserv)n(ation)g(pro)q(of)f(need)i(only)d(b)q(e)i
(c)o(hanged)g(for)150 1972 y(the)f(application)f(case.)150
2076 y FG(Theorem)i(5.5.1)h(\(T)o(yp)q(e)f(Preserv)m(ation)e(for)i(CBN)
i FF(\025)p FG(-M\))k Fy(8)p FF(n)11 b Fy(2)h Fo(N)p
FF(;)7 b(\000)14 b Fy(2)d FF(D)q(;)c(\034)16 b Fy(2)c
FF(T)s(:)7 b(e)12 b Fy(2)f FF(E)1713 2061 y Ft(n)1736
2076 y FF(;)c(v)12 b Fy(2)f FF(V)1860 2061 y Ft(n)699
2172 y FF(\000)731 2154 y FA(+)770 2172 y Fy(`)795 2154
y Ft(n)829 2172 y FF(e)h FI(:)f FF(\034)j Fy(^)9 b FF(e)996
2144 y Ft(n)983 2172 y FF(,)-7 b Fy(!)11 b FF(v)i FI(=)-7
b Fy(\))11 b FF(\000)1184 2154 y FA(+)1223 2172 y Fy(`)1248
2154 y Ft(n)1282 2172 y FF(v)i FI(:)e FF(\034)r(:)150
2322 y FD(5.6)56 b(A)19 b(Limitation)c(of)k(the)f(Basic)h(T)n(yp)r(e)f
(System:)e(Re-in)n(tegration)150 2446 y FI(The)e(basic)g(t)o(yp)q(e)g
(system)f(presen)o(ted)j(in)d(the)h(previous)g(c)o(hapter)h(has)e(a)h
(problem)e(that)h(renders)j(it)d(unsuitable)150 2521
y(for)f(supp)q(orting)h(m)o(ulti-stage)d(programming)f(with)j(explicit)
g(annotations:)g(It)g(cannot)h(t)o(yp)q(e)g(some)f(simple)f(y)o(et)150
2595 y(v)o(ery)i(useful)f(terms.)f(F)m(or)h(example,)f(in)h(Chapter)g
(2,)g(w)o(e)g(re-in)o(tegrated)i(the)e(dynamically)e(generated)j
(function)150 2670 y(as)h(follo)o(ws:)p eop
%%Page: 86 97
86 96 bop 1882 0 a FB(86)150 178 y FI(Syn)o(tax:)632
270 y FF(e)12 b Fy(2)g FF(E)h FI(:=)19 b FF(i)f Fy(j)g
FF(x)g Fy(j)g FF(e)7 b(e)19 b Fy(j)f FF(\025x:e)h Fy(j)f(h)p
FF(e)p Fy(i)h(j)g FE(~)q FF(e)12 b Fy(j)18 b FE(run)12
b FF(e)150 361 y FI(Big-Step)i(Rules:)p 437 552 110 2
v 443 601 a FF(i)482 574 y Ft(n)469 601 y FF(,)-7 b Fy(!)11
b FF(i)580 562 y FI(In)o(t)p 849 552 239 2 v 855 607
a FF(\025x:e)960 580 y FA(0)946 608 y FF(,)-7 b Fy(!)1003
607 y FF(\025x:e)1121 562 y FI(Lam)1285 465 y FF(e)1304
471 y FA(1)1350 438 y(0)1335 465 y FF(,)g Fy(!)11 b FF(\025x:e)1285
531 y(e)p FI([)p FF(x)g FI(:=)h FF(e)1426 537 y FA(2)1445
531 y FI(])1483 503 y FA(0)1468 531 y FF(,)-7 b Fy(!)10
b FF(e)1544 537 y FA(3)p 1274 552 302 2 v 1326 607 a
FF(e)1345 613 y FA(1)1378 607 y FF(e)1397 613 y FA(2)1442
580 y(0)1427 608 y FF(,)-7 b Fy(!)1485 607 y FF(e)1504
613 y FA(3)1608 562 y FI(App{CBN)298 701 y FF(e)317 707
y FA(1)363 674 y(0)348 702 y FF(,)g Fy(!)406 701 y(h)p
FF(e)441 707 y FA(2)460 701 y Fy(i)41 b FF(e)536 707
y FA(2)582 674 y(0)567 702 y FF(,)-7 b Fy(!)624 701 y
FF(e)643 707 y FA(3)p 293 723 376 2 v 374 778 a FE(run)12
b FF(e)461 784 y FA(1)506 751 y(0)492 779 y FF(,)-7 b
Fy(!)549 778 y FF(e)568 784 y FA(3)701 733 y FI(Run)p
897 723 129 2 v 903 778 a FF(x)938 750 y Ft(n)p FA(+)938
778 y FF(,)g Fy(!)10 b FF(x)1058 733 y FI(V)m(ar+)1298
702 y FF(e)1317 708 y FA(1)1348 674 y Ft(n)p FA(+)1348
702 y FF(,)-7 b Fy(!)10 b FF(e)1424 708 y FA(3)1485 702
y FF(e)1504 708 y FA(2)1534 674 y Ft(n)p FA(+)1534 702
y FF(,)-7 b Fy(!)11 b FF(e)1611 708 y FA(4)p 1292 723
344 2 v 1340 778 a FF(e)1359 784 y FA(1)1391 778 y FF(e)1410
784 y FA(2)1441 750 y Ft(n)p FA(+)1441 778 y FF(,)-7
b Fy(!)10 b FF(e)1517 784 y FA(3)1550 778 y FF(e)1569
784 y FA(4)1668 733 y FI(App+)389 872 y FF(e)408 878
y FA(1)439 845 y Ft(n)p FA(+)439 872 y FF(,)-7 b Fy(!)10
b FF(e)515 878 y FA(2)p 324 894 276 2 v 330 949 a FF(\025x:e)409
955 y FA(1)439 921 y Ft(n)p FA(+)439 949 y FF(,)-7 b
Fy(!)10 b FF(\025x:e)575 955 y FA(2)632 903 y FI(Lam+)903
872 y FF(e)922 878 y FA(1)953 845 y Ft(n)p FA(+)952 872
y FF(,)-7 b Fy(!)11 b FF(e)1029 878 y FA(2)p 865 894
222 2 v 871 943 a Fy(h)p FF(e)906 949 y FA(1)925 943
y Fy(i)965 915 y Ft(n)952 943 y FF(,)-7 b Fy(!)11 b(h)p
FF(e)1045 949 y FA(2)1064 943 y Fy(i)1119 903 y FI(Brk)1371
872 y FF(e)1390 878 y FA(1)1420 845 y Ft(n)p FA(+)1420
872 y FF(,)-7 b Fy(!)11 b FF(e)1497 878 y FA(2)p 1296
894 294 2 v 1302 949 a FE(run)i FF(e)1390 955 y FA(1)1420
921 y Ft(n)p FA(+)1420 949 y FF(,)-7 b Fy(!)11 b FE(run)i
FF(e)1566 955 y FA(2)1623 903 y FI(Run+)382 1043 y FF(e)401
1049 y FA(1)432 1016 y Ft(n)p FA(+)432 1043 y FF(,)-7
b Fy(!)10 b FF(e)508 1049 y FA(2)p 341 1065 229 2 v 348
1120 a FE(~)q FF(e)389 1126 y FA(1)419 1092 y Ft(n)p
FA(++)432 1120 y FF(,)-7 b Fy(!)24 b FE(~)q FF(e)544
1126 y FA(2)602 1075 y FI(Esc++)889 1043 y FF(e)908 1049
y FA(1)953 1016 y(0)939 1043 y FF(,)-7 b Fy(!)10 b(h)p
FF(e)1031 1049 y FA(2)1050 1043 y Fy(i)p 883 1065 189
2 v 895 1120 a FE(~)q FF(e)936 1126 y FA(1)981 1093 y(1)966
1120 y FF(,)-7 b Fy(!)11 b FF(e)1043 1126 y FA(2)1105
1075 y FI(Esc)515 1254 y FG(Fig.)d(5.3.)14 b FI(The)g(\(Coarse\))h(CBN)
f(Big-Step)g(Seman)o(tics)f(for)h FF(\025)p FI(-M)221
1401 y FE(-)f(val)h(exp72)g(=)h(run)d(exp72';)i(\(*)f(:)h(real)g
Fy(!)f FE(real)i(*\).)150 1499 y FI(But)h(this)f(declaration)g(w)o(as)g
(only)f(t)o(ypable)h(in)g(the)h(fault)o(y)e(t)o(yp)q(e)i(system)f
(presen)o(ted)i(in)e(Chapter)h(4,)e(and)h(not)150 1574
y(in)j(t)o(yp)q(e)g(system)g(presen)o(ted)i(ab)q(o)o(v)o(e.)e(In)g
(fact,)f(w)o(e)i(cannot)f(ev)o(en)h(t)o(yp)q(e)f(the)h(follo)o(wing)d
(simple)g(sequence)21 b(of)150 1649 y(declarations)14
b(in)f(the)i(ab)q(o)o(v)o(e)e(t)o(yp)q(e)i(system:)221
1751 y FE(-)e(val)h(a)g(=)g Fy(h)p FE(1)p Fy(i)p FE(;)221
1816 y(-)f(val)h(b)g(=)g(run)f(a;)150 1914 y FI(This)f(sequence)i(is)d
(not)h(t)o(ypable)f(b)q(ecause)j(\(with)d(the)i(standard)f(in)o
(terpretation)g(of)f FE(let)p FI(\))i(it)e(corresp)q(onds)j(to)d(the)
150 1989 y(lam)o(b)q(da)k(term)h(\()p FF(\025a:)p FE(run)h
FF(a)p FI(\))7 b Fy(h)q FI(1)p Fy(i)o FI(,)17 b(whic)o(h)g(is)f(not)h
(t)o(ypable.)f(Without)h(o)o(v)o(ercoming)e(this)i(problem,)e(w)o(e)i
(cannot)150 2064 y(ac)o(hiev)o(e)d(m)o(ulti-stage)e(programming)e(\\as)
k(adv)o(ertised")g(in)g(Chapters)h(1)e(to)h(3.)150 2147
y(Understanding)i(this)g(problem)e(and)i(its)f(signi\014cance)h
(requires)h(understanding)f(the)g(relation)f(b)q(et)o(w)o(een)i(the)150
2222 y(t)o(yp)q(es)11 b(and)f(the)h(metho)q(d)e(of)g(m)o(ulti-stage)f
(programming.)e(T)m(o)j(this)i(end,)f(w)o(e)g(b)q(egin)g(b)o(y)g(an)g
(analysis)f(of)g(the)i(t)o(yp)q(es)150 2296 y(of)j(the)h(six)f(ma)r
(jor)f(artifacts)i(pro)q(duced)h(at)e(the)h(end)g(of)f(the)h(six)g
(main)d(steps)k(of)e(the)h(metho)q(d)f(of)g(m)o(ulti-stage)150
2371 y(programming)o(.)c(It)j(is)g(then)g(clear)g(that)g(the)h(t)o(yp)q
(e)f(system)g(do)q(es)h(not)f(allo)o(w)e(for)h(a)h(general)g(w)o(a)o(y)
f(of)h(conducting)150 2446 y(the)18 b(last)f(step)i(of)e(the)h(metho)q
(d.)e(W)m(e)h(then)i(argue)e(that)h(the)g(ro)q(ot)g(of)e(the)j(problem)
d(lies)h(in)g(the)h(lac)o(k)f(of)g(an)150 2521 y(e\013ectiv)o(e)e(mec)o
(hanism)c(for)i(trac)o(king)h(free)g(v)n(ariables.)e(W)m(e)h(prop)q
(ose)i(a)e(solution)g(to)g(this)h(problem)e(at)h(the)h(lev)o(el)150
2595 y(of)g(t)o(yp)q(es,)g(and)g(sho)o(w)g(ho)o(w)g(the)h(new)g(t)o(yp)
q(es)g(can)f(b)q(e)h(a)f(basis)g(for)g(a)g(re\014ned)i(metho)q(d)d
(that)h(can)h(b)q(e)g(supp)q(orted)150 2670 y(b)o(y)f(a)f(pro)o(v)n
(ably)g(sound)h(t)o(yp)q(e)g(system.)p eop
%%Page: 87 98
87 97 bop 1882 0 a FB(87)150 192 y FG(5.6.1)48 b(T)o(yp)q(es)15
b(of)h(the)f(Artifacts)f(of)h(Multi-Stage)e(Programming)150
304 y FI(The)h(main)e(steps)j(of)f(m)o(ulti-stage)d(programming)g(are:)
168 415 y(1.)20 b(W)m(rite)13 b(the)h(con)o(v)o(en)o(tional)f(program)
866 526 y FH(pr)n(o)n(gr)n(am)e FI(:)g FF(t)1061 532
y Ft(S)1097 526 y Fy(!)g FF(t)1165 532 y Ft(D)1206 526
y Fy(!)g FF(t)221 637 y FI(where)k FF(t)356 643 y Ft(S)394
637 y FI(is)f(the)h(t)o(yp)q(e)g(of)e(the)i(\\static")f(or)g(\\kno)o
(wn")g(parameters,)f FF(t)1342 643 y Ft(D)1387 637 y
FI(is)h(the)g(t)o(yp)q(e)h(of)f(the)h(\\dynamic",)221
712 y(or)e(\\unkno)o(wn")h(parameters,)f(and)h FF(t)g
FI(is)f(the)i(t)o(yp)q(e)f(of)f(the)i(result)g(of)e(the)h(program.)168
786 y(2.)20 b(Add)14 b(staging)f(annotations)g(to)h(the)g(program)f(to)
g(deriv)o(e)738 897 y FH(annotate)n(d)p 916 897 13 2
v 17 w(pr)n(o)n(gr)n(am)d FI(:)i FF(t)1125 903 y Ft(S)1160
897 y Fy(!)f(h)p FF(t)1244 903 y Ft(D)1274 897 y Fy(i)h(!)f(h)p
FF(t)p Fy(i)168 1007 y FI(3.)20 b(Comp)q(ose)8 b(the)j(annotated)e
(program)f(with)i(an)f(unfolding)f(com)o(binator)g FE(back)13
b FI(:)e(\()p Fy(h)p FF(A)p Fy(i)h(!)f(h)p FF(B)r Fy(i)q
FI(\))g Fy(!)g(h)q FF(A)g Fy(!)g FF(B)r Fy(i)792 1119
y FH(c)n(o)n(de)p 871 1119 V 16 w(gener)n(ator)g FI(:)g
FF(t)1103 1125 y Ft(S)1139 1119 y Fy(!)g(h)p FF(t)1223
1125 y Ft(D)1264 1119 y Fy(!)g FF(t)p Fy(i)168 1229 y
FI(4.)20 b(Construct)15 b(or)e(read)i(the)f(static)h
FH(inputs)p FI(:)1025 1340 y FH(s)c FI(:)h FF(t)1092
1346 y Ft(S)168 1450 y FI(5.)20 b(Apply)13 b(the)i(co)q(de)f(generator)
h(to)f(the)g(static)g(inputs)h(to)e(get)836 1561 y FH(sp)n(e)n(cialize)
n(d)p 1024 1561 V 15 w(c)n(o)n(de)f FI(:)f Fy(h)p FF(t)1178
1567 y Ft(D)1220 1561 y Fy(!)g FF(t)p Fy(i)168 1672 y
FI(6.)20 b(Run)c(the)i(sp)q(ecialized)g(co)q(de)g(to)f(re-in)o(tro)q
(duce)i(the)e(generated)i(function)e(as)g(a)g(\014rst-class)h(v)n(alue)
f(in)f(the)221 1746 y(curren)o(t)f(en)o(vironmen)o(t:)818
1858 y FH(sp)n(e)n(cialize)n(d)p 1006 1858 V 15 w(pr)n(o)n(gr)n(am)c
FI(:)g FF(t)1213 1864 y Ft(D)1254 1858 y Fy(!)h FF(t)150
1968 y FI(All)e(the)i(steps)h(of)d(the)i(metho)q(d)e(except)j(the)f
(last)f(one)g(can)g(b)q(e)h(carried)g(out)f(within)f(the)i(t)o(yp)q(e)g
(system)f(presen)o(ted)150 2042 y(in)i(the)i(previous)f(c)o(hapter.)h
(The)f(last)g(step,)g(ho)o(w)o(ev)o(er,)g(is)f(problematic.)150
2186 y FG(5.6.2)48 b(The)15 b(Problem)f(of)h(Abstracting)e(Run)150
2298 y FI(The)k(ro)q(ot)g(of)f(the)h(expressivit)o(y)g(problem)f
(describ)q(ed)i(ab)q(o)o(v)o(e)e(seems)h(to)g(b)q(e)g(that)g(there)h
(is)e(no)h(general)f(t)o(yp)q(e)150 2373 y(safe)f(w)o(a)o(y)g(for)g
(going)f(from)f(a)i(MetaML)h(v)n(alue)e(of)h(co)q(de)h(t)o(yp)q(e)f
Fy(h)q FF(A)p Fy(i)g FI(to)g(a)g(MetaML)g(v)n(alue)g(of)g(t)o(yp)q(e)g
FF(A)p FI(.)g(A)o(t)g(the)150 2448 y(lev)o(el)d(of)f(language)g
(constructs,)j(MetaML)f(pro)o(vides)f(a)g(construct)h(Run.)f(Run)g(is)f
(a)h FH(c)n(onstruct)g FI(that)h(allo)o(ws)d(the)150
2523 y(execution)15 b(of)e(a)h(co)q(de)g(fragmen)o(t)f(and)g(has)h(the)
h(t)o(yp)q(e)f(rule:)873 2624 y FF(\000)905 2609 y FA(+)943
2624 y Fy(`)968 2609 y Ft(n)1003 2624 y FF(e)e FI(:)f
Fy(h)p FF(\034)5 b Fy(i)p 868 2653 248 2 v 868 2691 a
FF(\000)17 b Fy(`)936 2679 y Ft(n)971 2691 y FE(run)12
b FF(e)g FI(:)f FF(\034)1130 2662 y FI(Run)p eop
%%Page: 88 99
88 98 bop 1882 0 a FB(88)150 192 y FI(F)m(or)15 b(example,)f
FE(run)i Fy(h)p FE(3)9 b FI(+)h FE(4)p Fy(i)15 b FI(is)h(w)o(ell-t)o
(yp)q(ed)f(and)g(ev)n(aluates)h(to)f FE(7)p FI(.)g(But)h(Run)f(still)f
(has)i(limited)d(expressivit)o(y)m(.)150 266 y(In)19
b(particular,)f(it)g(is)g(not)h(a)f(function,)g(and)h(cannot)g(b)q(e)g
(turned)h(in)o(to)d(a)i(function,)f(b)q(ecause)i(the)f(lam)o(b)q(da-)
150 341 y(abstraction)14 b FF(\025x:)p FE(run)e FF(x)h
FI(is)h(not)g(t)o(ypable)f(using)h(the)g(t)o(yp)q(e)g(system)g(of)f
(Section)h(5.2.)e(Without)h(suc)o(h)i(a)e(function)150
416 y(co)q(de)k(fragmen)o(ts)d(declared)j(at)f(top-lev)o(el)f(can)h
(nev)o(er)g(b)q(e)h(executed)h(using)d(w)o(ell-t)o(yp)q(ed)h(terms.)f
(A)o(t)g(the)i(same)150 490 y(time,)9 b(adding)h(a)g(function)g(suc)o
(h)h(as)g FE(unsafe)p 825 490 13 2 v 16 w(run)h FI(:)f
Fy(h)q FF(A)p Fy(i)g(!)g FF(A)g FI(breaks)g(the)h(safet)o(y)e(of)g(the)
h(t)o(yp)q(e)g(system)g(presen)o(ted)150 565 y(in)j(the)h(previous)g
(section,)g(b)q(ecause)h(it)e(is)g(equiv)n(alen)o(t)g(to)h(rein)o(tro)q
(ducing)f(the)i(fault)o(y)d(Run)h(rule)h(presen)o(ted)h(in)150
640 y(Chapter)f(4.)e(\(Th)o(us,)h(the)g(same)f(coun)o(terexample)h(to)f
(t)o(yp)q(e)i(safet)o(y)f(applies.\))150 723 y(Despite)k(a)f(long)f
(searc)o(h,)i(w)o(e)g(ha)o(v)o(e)f(not)g(b)q(een)i(able)e(to)g(\014nd)g
(reasonable)h(t)o(yp)q(e)g(systems)f(where)h(a)f FH(function)150
798 y FE(unsafe)p 261 798 V 16 w(run)h FI(:)f Fy(h)p
FF(A)p Fy(i)h(!)f FF(A)g FI(can)h(exist)730 783 y FA(5)749
798 y FI(.)f(Th)o(us)g(w)o(e)h(are)g(inclined)e(to)i(b)q(eliev)o(e)f
(that)h(a)f(single)g(parametric)f(t)o(yp)q(e)150 872
y(constructor)g Fy(h)p 389 872 V 15 w(i)f FI(for)f(co)q(de)h(do)q(es)h
(not)e(allo)o(w)f(for)h(a)g(natural)g(w)o(a)o(y)g(of)g(executing)h(co)q
(de.)g(This)g(observ)n(ation)f(can)150 947 y(b)q(e)k(in)o(terpreted)h
(as)e(sa)o(ying)f(that)h(\\generated)i(co)q(de")e(cannot)h(b)q(e)g
(easily)e(in)o(tegrated)i(with)f(the)g(rest)i(of)d(the)150
1022 y(run-time)d(system.)150 1179 y FG(A)h(Closer)g(Lo)q(ok)g(at)g
(What)g(Go)q(es)f(W)l(rong)19 b FI(Op)q(erationally)m(,)11
b(a)h(co)q(de)h(fragmen)o(t)e(of)h(t)o(yp)q(e)h Fy(h)p
FF(A)p Fy(i)g FI(can)f(con)o(tain)150 1254 y(\\free)h(dynamic)e(v)n
(ariables".)h(Because)i(the)g(original)c(co)q(de)k(t)o(yp)q(e)f(of)f
(MetaML)h(do)q(es)h(not)e(pro)o(vide)h(us)g(with)f(an)o(y)150
1329 y(information)h(as)i(to)g(whether)i(or)f(not)f(there)i(are)e
(\\free)h(dynamic)e(v)n(ariables")h(in)g(the)h(fragmen)o(t,)d(there)k
(is)e(no)150 1404 y(w)o(a)o(y)e(of)g(ensuring)i(that)f(this)g(co)q(de)g
(fragmen)o(t)f(can)h(b)q(e)g(safely)g(executed.)150 1487
y(Th)o(us,)k(there)i(is)e(a)g(need)h(for)f(a)g(\014ner)h(t)o(yping)e
(mec)o(hanism)f(that)i(pro)o(vides)h(a)f(means)f(for)h(reasoning)g(ab)q
(out)150 1561 y(free)d(v)n(ariables.)e(As)i(this)f(observ)n(ation)g
(holds)g(in)g(a)g(v)o(ery)g(minima)o(l)d(language)i(for)h(m)o
(ulti-stage)f(programmi)o(ng)150 1636 y(language,)f(w)o(e)j(b)q(eliev)o
(e)f(that)g(it)f(is)h(v)o(ery)g(lik)o(ely)f(to)h(hold)f(for)g(man)o(y)f
(m)o(ulti-stage)g(languages.)150 1795 y FD(5.7)56 b(The)18
b Fm(\025)425 1777 y Fj(B)q(N)513 1795 y FD(Language.)g(Or)h(Adding)g
(Closedness)f(to)h Fm(\025)p FD(-M)150 1928 y FI(Our)13
b(prop)q(osal)g(is)g(to)f(add)h(a)g(sp)q(ecial)g(t)o(yp)q(e)g
(constructor)i(to)e(mark)e(Closed)i(terms)g(to)f(MetaML.)h(Closed)g
(terms)150 2002 y(ev)n(aluate)f(to)h(closed)g(v)n(alues,)e(that)i(is,)f
(v)n(alues)g(con)o(taining)g(no)g(free)h(v)n(ariables.)f(The)h
(viabilit)o(y)d(of)i(this)g(prop)q(osal)150 2077 y(will)18
b(b)q(e)i(demonstrated)f(b)o(y)g(adding)g(a)g(Closed)g(t)o(yp)q(e)h(to)
f FF(\025)p FI(-M,)g(and)g(presen)o(ting)i(a)e(pro)o(v)n(ably)f(sound)h
(t)o(yp)q(e)150 2152 y(system.)13 b(The)i(extended)g(language)e(is)h
(called)f FF(\025)917 2137 y FE(BN)990 2152 y FI(and)h(adds)g(the)h
(Closed)f(t)o(yp)q(e)g FE([)p 1482 2152 V 15 w(])g FI(to)g(the)g(t)o
(yp)q(es)h(of)e FF(\025)p FI(-M:)741 2260 y FF(\034)25
b Fy(2)11 b FF(T)23 b FI(:=)12 b FF(b)18 b Fy(j)g FF(\034)1010
2266 y FA(1)1040 2260 y Fy(!)11 b FF(\034)1111 2266 y
FA(2)1149 2260 y Fy(j)18 b(h)p FF(\034)5 b Fy(i)18 b(j)g
FE([)p FF(\034)5 b FE(])741 2335 y FF(\000)17 b Fy(2)11
b FF(D)i FI(:=)f([])17 b Fy(j)11 b FF(x)h FI(:)f FF(\034)1072
2320 y Ft(n)1094 2335 y FI(;)c FF(\000)p 150 2429 237
2 v 158 2456 a Fz(5)188 2472 y FB(It)17 b(is)h(tempting)h(here)e(to)h
(sa)o(y)f(that)h(w)o(e)f(w)o(ere)g(searc)o(hing)i(for)e(a)g
(\\\014rst-class)i(function",)f(but)g(an)o(y)g(function)h(in)f(a)188
2518 y(functional)d(language)g(b)q(ecomes)e(a)g(\\\014rst-class)h
(citizen",)g(and)f(an)g(op)q(erator)h(that)e(is)i(not)e(a)h(function)h
(is)f(not)g(a)g(\014rst-)188 2563 y(class)j(citizen.)f(Lo)q(oking)h
(for)e(a)g(w)o(a)o(y)g(to)g(\014t)g(an)g(op)q(erator)h(in)o(to)g(a)f
(functional)j(language)f(as)e(a)g(function)i(is)e(the)h(same)188
2609 y(as)f(lo)q(oking)h(for)e(a)g(w)o(a)o(y)g(to)f(\014t)i(the)f(op)q
(erator)h(in)o(to)f(the)h(functional)h(language)g(as)e(a)g
(\014rst-class)h(citizen.)p eop
%%Page: 89 100
89 99 bop 1882 0 a FB(89)150 194 y FI(The)16 b FF(\025)261
179 y FE(BN)336 194 y FI(language)f(re\014nes)j FF(\025)p
FI(-M)e(b)o(y)f(adding)g(constructs)j(for)e(marking)d(and)j(un-marking)
e(Closed)i(terms,)150 269 y(replacing)10 b(Run)g(with)f(a)h(new)h
(construct)h(called)e(Safe-run,)f(and)h(b)o(y)g(pro)o(viding)f(an)h
(explicit)g(form)e(of)h(cross-stage)150 343 y(p)q(ersistence)17
b(for)c(only)g(closed)i(v)n(alues:)218 459 y FF(e)d Fy(2)f
FF(E)j FI(:=)d FF(c)j Fy(j)g FF(x)f Fy(j)g FF(\025x:e)h
Fy(j)f FF(e)7 b(e)15 b Fy(j)e(h)p FF(e)p Fy(i)i(j)f FE(~)q
FF(e)g Fy(j)g FE(close)e FF(e)g FE(with)g Fy(f)p FF(x)1141
465 y Ft(i)1166 459 y FI(=)f FF(e)1228 465 y Ft(i)1243
459 y Fy(j)p FF(i)g Fy(2)g FF(m)p Fy(g)j(j)g FE(op)q(en)e
FF(e)j Fy(j)e FE(safe)p 1638 459 13 2 v 15 w(run)f FF(e)j
Fy(j)e FE(up)f FF(e)150 564 y FI(The)18 b(\014rst)g(pro)q(duction)f
(allo)o(ws)f(the)i(use)g(of)f(an)o(y)f(set)i(of)f(constan)o(ts)h(suc)o
(h)g(as)g(in)o(tegers,)f(strings,)g(and)g(so)h(on.)150
639 y(The)g(next)h(three)g(pro)q(ductions)g(are)f(the)g(standard)h
(ones)f(in)g(a)f FF(\025)p FI(-calculus.)h(Brac)o(k)o(et)h(and)f(Escap)
q(e)h(are)f(the)150 714 y(same)13 b(as)h(w)o(e)h(ha)o(v)o(e)f(seen)h(b)
q(efore.)f(The)h(Close-with)f(construct)i(will)c(assert)k(\(when)e(w)o
(e)h(ha)o(v)o(e)f(imp)q(osed)f(a)g(t)o(yp)q(e)150 788
y(system)f(on)h(these)h(terms\))e(that)h FF(e)g FI(is)f(closed)h
(except)h(for)f(a)f(set)i(of)e(v)n(ariables)f FF(x)1389
794 y Ft(i)1403 788 y FI(,)h(eac)o(h)h(of)f(whic)o(h)h(is)f(b)q(ound)h
(to)f(a)150 863 y(Closed)h(term)f FF(e)400 869 y Ft(i)414
863 y FI(.)g(Op)q(en)h(allo)o(ws)f(us)h(to)f(forget)h(the)g(Closedness)
h(assertion)f(on)g FF(e)p FI(.)f(Safe-run)h(executes)i(a)d(Closed)150
938 y(Co)q(de)i(fragmen)o(t)f(and)h(returns)h(a)f(Closed)g(result.)g
(Finally)m(,)e(Up)i(allo)o(ws)e(us)j(to)f(use)g(an)o(y)g(Closed)g
(expression)h(at)150 1013 y(a)f(higher)g(lev)o(el,)f(th)o(us)h(pro)o
(viding)f(cross-stage)i(p)q(ersistence)i(for)c(Closed)h(v)n(alues.)150
1156 y FG(5.7.1)48 b(Big-Step)13 b(Seman)o(tics)h(for)h
Fp(\025)819 1141 y FE(B)o(N)150 1268 y FI(The)i(big-step)f(seman)o
(tics)g(of)f FF(\025)661 1252 y FE(BN)737 1268 y FI(is)h(v)o(ery)g
(similar)e(to)i(that)g(of)g FF(\025)p FI(-M,)f(and)h(is)g(summarized)e
(in)i(Figure)g(5.4.)150 1342 y(The)g(\014rst)g(t)o(w)o(o)f(ev)n
(aluation)g(rules)h(are)g(those)g(of)f(ev)n(aluation)f(in)h(the)h
FF(\025)g FI(language.)e(The)i(next)g(rule)g(sa)o(ys)g(that)150
1417 y(ev)n(aluating)c(Brac)o(k)o(eted)i(expression)h(is)e(done)g(b)o
(y)g(rebuilding)f(the)i(expression.)g(The)f(next)h(t)o(w)o(o)f(rules)g
(are)h(new,)150 1492 y(and)g(sp)q(ecify)g(the)h(seman)o(tics)e(of)g
(the)i(Closedness)g(annotations.)150 1575 y(The)h(ev)n(aluation)f(rule)
h(for)f(Close-with)g(sa)o(ys)h(that)g(it)g(\014rst)g(ev)n(aluates)g
(the)g(expressions)i(in)d(the)h(with-clause,)150 1649
y(and)11 b(then)h(substitutes)g(these)h(results)f(in)f(place)g(of)g
(the)g(v)n(ariables)g(in)f(the)i(b)q(o)q(dy)f(of)g(the)g(Close-with.)g
(The)g(result)150 1724 y(of)i(the)g(substitution)h(is)f(then)g(ev)n
(aluated,)g(and)g(returned)i(as)e(the)h(\014nal)e(result.)i(The)f(rule)
h(for)e(Op)q(en)j(sa)o(ys)e(that)150 1799 y(it)f(simply)e(ev)n(aluates)
j(its)f(argumen)o(t)f(to)h(get)h(a)f(Closed)g(result,)h(and)f(returns)i
(that)e(result.)h(The)g(next)f(t)o(w)o(o)g(rules)150
1874 y(are)18 b(also)f(new,)g(and)g(sp)q(ecify)h(the)h(seman)o(tics)e
(of)f(t)o(w)o(o)h(new)h(op)q(erations)g(that)f(exploit)g(a)g(useful)h
(in)o(teraction)150 1948 y(b)q(et)o(w)o(een)d(the)g(Closed)f(and)f(Co)q
(de)i(t)o(yp)q(es.)150 2031 y(The)d(de\014nition)f(for)g(rebuilding)f
(is)h(essen)o(tially)g(the)h(same)f(as)g(b)q(efore,)h(with)f(lev)o(el)g
(annotations)f(b)q(eing)i(c)o(hanged)150 2106 y(only)h(in)h(the)g
(cases)h(of)f(Brac)o(k)o(ets)h(and)f(Escap)q(es.)150
2189 y(Note)g(that)g(this)g(seman)o(tics)g(do)q(es)h(not)e(explicitly)g
(sp)q(ecify)i(an)o(y)e(renaming)g(on)g(b)q(ound)h(ob)r(ject-lev)o(el)h
(v)n(ariables)150 2264 y(when)d(w)o(e)g(are)h(rebuilding)e(co)q(de.)h
(The)g(capture-free)i(substitution)e(p)q(erformed)f(in)h(the)g
(application)e(rule)j(tak)o(es)150 2338 y(care)i(of)e(all)g(the)h
(necessary)i(renaming.)c(F)m(or)h(example,)g(the)h(expression)784
2449 y Fy(h)p FF(\025x:)q FE(~)p FI(\(\()p FF(\025z)r(:)p
Fy(h)q FF(\025x:x)8 b FI(+)j FE(~)q FF(z)r Fy(i)p FI(\))p
Fy(h)p FF(x)p Fy(i)p FI(\))p Fy(i)150 2559 y FI(ev)n(aluates)j(at)g
(lev)o(el)f(0)h(to:)906 2670 y Fy(h)q FF(\025x:\025y)q(:y)d
FI(+)e FF(x)p Fy(i)p FF(:)p eop
%%Page: 90 101
90 100 bop 1882 0 a FB(90)150 369 y FI(Syn)o(tax:)218
460 y FF(e)12 b Fy(2)f FF(E)j FI(:=)d FF(c)j Fy(j)g FF(x)f
Fy(j)g FF(\025x:e)h Fy(j)f FF(e)7 b(e)15 b Fy(j)e(h)p
FF(e)p Fy(i)i(j)f FE(~)q FF(e)g Fy(j)g FE(close)e FF(e)g
FE(with)g Fy(f)p FF(x)1141 466 y Ft(i)1166 460 y FI(=)f
FF(e)1228 466 y Ft(i)1243 460 y Fy(j)p FF(i)g Fy(2)g
FF(m)p Fy(g)j(j)g FE(op)q(en)e FF(e)j Fy(j)e FE(safe)p
1638 460 13 2 v 15 w(run)f FF(e)j Fy(j)e FE(up)f FF(e)150
552 y FI(Shorthands:)792 632 y FE(close)g FF(e)26 b FH(for)f
FE(close)12 b FF(e)g FE(with)g Fy(;)568 682 y FE(close)g
FF(e)g FE(with)h FF(x)805 688 y Ft(i)830 682 y FI(=)e
FF(e)892 688 y Ft(i)932 682 y FH(for)25 b FE(close)12
b FF(e)g FE(with)g Fy(f)p FF(x)1266 688 y Ft(i)1291 682
y FI(=)g FF(e)1354 688 y Ft(i)1368 682 y Fy(j)p FF(i)f
Fy(2)g FF(m)p Fy(g)150 774 y FI(Big-Step)j(Rules)g(at)g(lev)o(el)f(0)h
(\(Ev)n(aluation\):)p 424 902 239 2 v 430 957 a FF(\025x:e)535
930 y FA(0)520 957 y FF(,)-7 b Fy(!)11 b FF(\025x:e)695
911 y FI(Lam)843 880 y FF(e)862 886 y FA(1)907 853 y(0)892
880 y FF(,)-7 b Fy(!)11 b FF(\025x:e)41 b(e)1089 886
y FA(2)1134 853 y(0)1120 880 y FF(,)-7 b Fy(!)10 b FF(v)1197
886 y FA(1)1258 880 y FF(e)p FI([)p FF(x)h FI(:=)g FF(v)1399
886 y FA(1)1418 880 y FI(])1456 853 y FA(0)1441 880 y
FF(,)-7 b Fy(!)11 b FF(v)1519 886 y FA(2)p 837 902 707
2 v 1091 957 a FF(e)1110 963 y FA(1)1143 957 y FF(e)1162
963 y FA(2)1207 930 y(0)1192 957 y FF(,)-7 b Fy(!)11
b FF(v)1270 963 y FA(2)1576 911 y FI(App)933 1039 y FF(e)979
1011 y FA(1)964 1039 y FF(,)-7 b Fy(!)11 b FF(v)p 895
1061 187 2 v 901 1116 a Fy(h)p FF(e)p Fy(i)979 1088 y
FA(0)964 1116 y FF(,)-7 b Fy(!)11 b(h)p FF(v)q Fy(i)1114
1070 y FI(Brk)564 1197 y FF(e)583 1203 y Ft(i)624 1170
y FA(0)609 1198 y FF(,)-7 b Fy(!)667 1197 y FF(v)687
1203 y Ft(i)742 1197 y FF(e)p FI([)p FF(x)797 1203 y
Ft(i)822 1197 y FI(:=)11 b FF(v)897 1203 y Ft(i)911 1197
y FI(])949 1170 y FA(0)934 1198 y FF(,)-7 b Fy(!)992
1197 y FF(v)p 521 1219 536 2 v 527 1274 a FE(close)12
b FF(e)g FE(with)g FF(x)763 1280 y Ft(i)788 1274 y FI(=)g
FF(e)851 1280 y Ft(i)891 1247 y FA(0)877 1275 y FF(,)-7
b Fy(!)934 1274 y FE(close)12 b FF(v)1089 1229 y FI(Clos)1234
1197 y FF(e)1280 1170 y FA(0)1265 1198 y FF(,)-7 b Fy(!)1323
1197 y FE(close)12 b FF(v)p 1228 1219 217 2 v 1234 1274
a FE(op)q(en)h FF(e)1375 1247 y FA(0)1360 1275 y FF(,)-7
b Fy(!)1418 1274 y FF(v)1478 1229 y FI(Opn)562 1356 y
FF(e)607 1329 y FA(0)593 1357 y FF(,)g Fy(!)650 1356
y FE(close)12 b Fy(h)p FF(v)782 1341 y Fs(0)795 1356
y Fy(i)41 b FF(v)873 1341 y Fs(0)912 1329 y FA(0)897
1357 y FF(,)-7 b Fy(!)955 1356 y FF(v)p 556 1378 427
2 v 591 1433 a FE(safe)p 660 1433 13 2 v 15 w(run)13
b FF(e)787 1406 y FA(0)773 1434 y FF(,)-7 b Fy(!)830
1433 y FE(close)12 b FF(v)1015 1388 y FI(SRn)1185 1356
y FF(e)1230 1329 y FA(0)1216 1357 y FF(,)-7 b Fy(!)1273
1356 y FE(close)12 b FF(v)1389 1341 y Fs(0)p 1152 1378
283 2 v 1158 1433 a FE(up)g FF(e)1258 1406 y FA(1)1243
1434 y FF(,)-7 b Fy(!)1301 1433 y FE(close)12 b FF(v)1417
1418 y Fs(0)1467 1388 y FI(Up)1659 1149 y FF(:)150 1525
y FI(Big-Step)i(Rules)g(at)g(lev)o(el)f FF(n)c FI(+)h(1)j
(\(Rebuilding\):)p 900 1638 117 2 v 906 1692 a FF(c)936
1665 y Ft(n)p FA(+)936 1692 y FF(,)-7 b Fy(!)10 b FF(c)1050
1647 y FI(Const+)p 418 1796 129 2 v 424 1850 a FF(x)459
1823 y Ft(n)p FA(+)459 1850 y FF(,)-7 b Fy(!)11 b FF(x)579
1805 y FI(V)m(ar+)802 1774 y FF(e)833 1747 y Ft(n)p FA(+)832
1774 y FF(,)-7 b Fy(!)11 b FF(v)p 736 1796 241 2 v 742
1850 a(\025x:e)833 1823 y Ft(n)p FA(+)832 1850 y FF(,)-7
b Fy(!)11 b FF(\025x:v)1010 1805 y FI(Lam+)1189 1774
y FF(e)1208 1780 y FA(1)1239 1747 y Ft(n)p FA(+)1239
1774 y FF(,)-7 b Fy(!)11 b FF(v)1317 1780 y FA(1)1377
1774 y FF(e)1396 1780 y FA(2)1426 1747 y Ft(n)p FA(+)1426
1774 y FF(,)-7 b Fy(!)11 b FF(v)1504 1780 y FA(2)p 1184
1796 345 2 v 1231 1850 a FF(e)1250 1856 y FA(1)1283 1850
y FF(e)1302 1856 y FA(2)1332 1823 y Ft(n)p FA(+)1332
1850 y FF(,)-7 b Fy(!)11 b FF(v)1410 1856 y FA(1)1442
1850 y FF(v)1462 1856 y FA(2)1561 1805 y FI(App+)591
1933 y FF(e)622 1905 y Ft(n)p FA(++)635 1933 y FF(,)-7
b Fy(!)23 b FF(v)p 566 1955 187 2 v 572 2009 a Fy(h)p
FF(e)p Fy(i)635 1982 y Ft(n)p FA(+)635 2009 y FF(,)-7
b Fy(!)10 b(h)p FF(v)q Fy(i)785 1964 y FI(Brk+)951 1933
y FF(e)996 1905 y FA(0)982 1933 y FF(,)-7 b Fy(!)10 b(h)p
FF(v)q Fy(i)p 945 1955 155 2 v 956 2010 a FE(~)q FF(e)1024
1982 y FA(1)1009 2010 y FF(,)-7 b Fy(!)11 b FF(v)1132
1964 y FI(Esc1)1276 1933 y FF(e)1307 1905 y Ft(n)p FA(+)1307
1933 y FF(,)-7 b Fy(!)10 b FF(v)p 1234 1955 194 2 v 1241
2009 a FE(~)q FF(e)1294 1982 y Ft(n)p FA(++)1307 2009
y FF(,)-7 b Fy(!)24 b FE(~)q FF(v)1460 1964 y FI(Esc)655
2091 y FF(e)674 2097 y Ft(i)700 2063 y(n)p FA(+)700 2091
y FF(,)-7 b Fy(!)11 b FF(v)778 2097 y Ft(i)p 344 2113
758 2 v 350 2167 a FE(close)h FF(e)g FE(with)g FF(x)586
2173 y Ft(i)611 2167 y FI(=)g FF(e)674 2173 y Ft(i)700
2140 y(n)p FA(+)700 2167 y FF(,)-7 b Fy(!)11 b FE(close)h
FF(e)f FE(with)i FF(x)994 2173 y Ft(i)1019 2167 y FI(=)f
FF(v)1083 2173 y Ft(i)1135 2122 y FI(Clo+)1390 2091 y
FF(e)1421 2063 y Ft(n)p FA(+)1421 2091 y FF(,)-7 b Fy(!)11
b FF(v)p 1290 2113 312 2 v 1296 2167 a FE(op)q(en)h FF(e)1421
2140 y Ft(n)p FA(+)1421 2167 y FF(,)-7 b Fy(!)11 b FE(op)q(en)i
FF(v)1634 2122 y FI(Opn+)695 2249 y FF(e)726 2221 y Ft(n)p
FA(+)726 2249 y FF(,)-7 b Fy(!)11 b FF(v)p 539 2271 423
2 v 545 2325 a FE(safe)p 614 2325 13 2 v 14 w(run)i FF(e)726
2298 y Ft(n)p FA(+)726 2325 y FF(,)-7 b Fy(!)11 b FE(safe)p
853 2325 V 14 w(run)i FF(v)994 2280 y FI(SRn+)1236 2249
y FF(e)1267 2221 y Ft(n)p FA(+)1267 2249 y FF(,)-7 b
Fy(!)11 b FF(v)1346 2234 y Fs(0)p 1163 2271 268 2 v 1169
2325 a FE(up)i FF(e)1255 2298 y Ft(n)p FA(++)1267 2325
y FF(,)-7 b Fy(!)24 b FE(up)12 b FF(v)1413 2310 y Fs(0)1464
2280 y FI(Up+)596 2471 y FG(Fig.)7 b(5.4.)14 b FI(The)h(CBV)f(Big-Step)
g(Seman)o(tics)f(for)h FF(\025)1415 2456 y FE(BN)p eop
%%Page: 91 102
91 101 bop 1882 0 a FB(91)150 192 y FI(Because)15 b(capture-free)g
(substitution)e(renames)g(the)g(b)q(ound)g(v)n(ariable)f(when)i(it)e
(go)q(es)i(inside)f(a)f(lam)o(b)q(da,)f(there)150 266
y(w)o(as)j(no)f(inadv)o(erten)o(t)i(capture)g(of)e(the)i(v)n(ariable)d
FE(x)i FI(in)g(the)g(v)n(alue)g Fy(h)p FE(x)p Fy(i)g
FI(during)f(substitution.)150 349 y(It)j(is)f(also)g(w)o(orth)g(noting)
g(that)g(there)i(is)e(a)h(rule)f(for)g(rebuilding)g(constan)o(ts,)h
(whic)o(h)f(sa)o(ys)h(that)f(they)h(remain)150 424 y(unc)o(hanged.)11
b(There)i(are,)e(ho)o(w)o(ev)o(er,)g(no)g(ev)n(aluation)f(rules)i(for)f
(Escap)q(es,)h(b)q(ecause)h(Escap)q(es)g(are)f(only)e(in)o(tended)150
499 y(to)f(o)q(ccur)i(inside)e(Brac)o(k)o(ets,)i(and)e(are)h
(meaningless)e(at)i(lev)o(el)f(0.)g(When)g(the)h(language)f(is)g
(extended)i(with)e(sp)q(eci\014c)150 573 y(constan)o(ts)15
b(\(and)f(sp)q(eci\014c)i(rules)f(for)f(ev)n(aluating)e(them\),)h(one)i
(will)e(ha)o(v)o(e)h(to)g(ensure)h(that)g(these)g(rules)g(do)f(not)150
648 y(violate)f(an)o(y)g(prop)q(erties)j(\(suc)o(h)e(as)g(T)o(yp)q
(e-Safet)o(y)m(,)f(for)h(example\).)150 796 y FG(5.7.2)48
b(T)o(yp)q(e)16 b(System)e(for)h Fp(\025)687 781 y FE(BN)150
912 y FI(T)o(yping)h(judgmen)o(ts)g(for)h FF(\025)591
897 y FE(BN)667 912 y FI(ha)o(v)o(e)g(the)h(form)d FF(\000)22
b Fy(`)1015 897 y Ft(n)1055 912 y FF(e)12 b FI(:)f FF(\034)5
b FI(,)16 b(where)i FF(\000)23 b Fy(2)16 b FF(G)h FI(and)g
FF(n)f FI(is)h(a)g(natural)g(n)o(um)o(b)q(er)150 987
y(called)c(the)g(lev)o(el)g(of)f(the)i(term.)d(The)j
FH(level)e FI(of)g(the)i(term)e(is)h(the)h(n)o(um)o(b)q(er)e(of)g(Brac)
o(k)o(ets)i(surrounding)g(this)f(term)150 1062 y(less)f(the)g(n)o(um)o
(b)q(er)e(of)h(Escap)q(es)i(surrounding)f(this)f(term.)f(Figure)i(5.5)e
(summarizes)f(the)j(t)o(yp)q(e)g(system)f(for)g FF(\025)1849
1047 y FE(BN)1908 1062 y FI(.)150 1145 y(The)17 b(rule)g(for)f(a)g
(constan)o(t)h(sa)o(ys)g(that)g(it)f(has)h(the)g(t)o(yp)q(e)g(asso)q
(ciated)g(with)f(that)h(constan)o(t.)g(The)g(next)g(three)150
1219 y(rules)d(are)f(essen)o(tially)g(the)g(same)f(as)i(b)q(efore,)f
(but)g(note)g(that)g(the)h(v)n(ariable)e(rule)h(no)g(longer)f(allo)o
(ws)g(\\implicit")150 1294 y(cross-stage)i(p)q(ersistence.)i(No)o(w,)c
(v)n(ariables)g(can)h(only)f(b)q(e)i(used)g(at)e(the)i(lev)o(el)e(at)h
(whic)o(h)g(they)g(are)h(b)q(ound.)e(But)150 1369 y(w)o(e)k(will)e(see)
j(ho)o(w)e(one)g(of)g(the)i(rules)f(allo)o(ws)e(us)i(to)f(ac)o(hiev)o
(e)h(a)f(restricted)j(form)c(of)h(cross-stage)i(p)q(ersistence.)150
1443 y(The)h(next)g(t)o(w)o(o)e(rules)i(are)g(for)f(Brac)o(k)o(ets)i
(and)e(Escap)q(e,)h(and)f(are)h(exactly)f(the)h(same)f(as)g(b)q(efore.)
h(The)f(next)150 1518 y(t)o(w)o(o)e(rules)g(are)h(new,)f(and)g(sp)q
(ecify)h(the)f(t)o(yping)g(of)f(the)i(Closedness)h(annotations.)d(The)h
(rule)h(for)e(Close-with)150 1593 y(sa)o(ys)j(it)g(is)f(t)o(ypable)h
(if)f(all)f(the)j(bindings)e(in)g(the)i(with-clause)f(are)g(Closed,)g
(and)f(the)i(term)e(in)g(the)i(b)q(o)q(dy)f(of)150 1668
y(the)d(Close-with)f(is)g(t)o(ypable)g(at)g(lev)o(el)g(0)f(assuming)g
(that)h(all)f(the)i(v)n(ariables)f(in)f(the)i(with-clause)g(are)f(a)o
(v)n(ailable)150 1742 y(at)k(lev)o(el)g(0.)g(In)g(essence,)j(this)d
(ensures)i(that)f(a)f(Closed)g(expression)i(can)e(only)g(con)o(tain)g
(v)n(ariables)f(that)i(are)150 1817 y(themselv)o(es)11
b(b)q(ound)g(to)g(Closed)g(expressions.)h(The)f(rule)h(for)e(op)q(en)i
(simply)c(forgets)k(the)f(Closed)g(t)o(yp)q(e.)g(The)h(rule)150
1892 y(for)j(Safe-run)g(allo)o(ws)f(us)h(to)g(eliminate)f(the)h(Co)q
(de)h(t)o(yp)q(e)f(when)h(it)f(o)q(ccurs)h(under)g(the)g(Closed)f(t)o
(yp)q(e.)h(Finally)m(,)150 1967 y(the)d(rule)f(for)g(Up)g(allo)o(ws)e
(us)j(to)f(lift)f(an)o(y)g(Closed)h(v)n(alue)g(from)e(an)o(y)h(lev)o
(el)h(to)g(the)h(next,)f(th)o(us)g(pro)o(viding)f(us)h(with)150
2041 y(a)i(limited)d(form)h(of)i(cross-stage)h(p)q(ersistence:)h
(cross-stage)g(p)q(ersistence)g(for)e(Closed)g(v)n(alues.)150
2189 y FG(5.7.3)48 b(Remark)15 b(on)h(Up,)f(Co)o(v)o(ers,)g(and)h(P)o
(erformance)150 2305 y FI(It)e(is)h(w)o(orth)f(noting)g(that)g(if)g(w)o
(e)g(build)g(an)g(implemen)o(tati)o(on)e(along)h(the)i(lines)f(of)g
(Chapter)h(4)f(for)g(a)g(language)150 2380 y(that)19
b(only)e(has)i(cross-stage)h(p)q(ersistence)h(for)d(Closed)h(v)n
(alues,)e(there)j(should)e(b)q(e)h(no)g(need)g(for)f(the)h(co)o(v)o
(ers)150 2455 y(discussed)c(in)f(Section)g(4.5.)e(In)i(particular,)f
(cross-stage)i(p)q(ersisten)o(t)h(constan)o(ts)e(in)g(suc)o(h)g(an)f
(implemen)o(tation)150 2529 y(can)h(nev)o(er)h(carry)f(free)h(v)n
(ariables.)e(T)m(o)g(see)i(this)f(claim,)d(recall)j(that:)168
2646 y(1.)20 b(co)o(v)o(ers)14 b(are)h(used)f(to)g(p)q(erform)f
(substitution)h(on)g(functional)f(v)n(alues,)p eop
%%Page: 92 103
92 102 bop 1882 0 a FB(92)150 671 y FI(Syn)o(tax:)218
762 y FF(e)12 b Fy(2)f FF(E)j FI(:=)d FF(c)j Fy(j)g FF(x)f
Fy(j)g FF(\025x:e)h Fy(j)f FF(e)7 b(e)15 b Fy(j)e(h)p
FF(e)p Fy(i)i(j)f FE(~)q FF(e)g Fy(j)g FE(close)e FF(e)g
FE(with)g Fy(f)p FF(x)1141 768 y Ft(i)1166 762 y FI(=)f
FF(e)1228 768 y Ft(i)1243 762 y Fy(j)p FF(i)g Fy(2)g
FF(m)p Fy(g)j(j)g FE(op)q(en)e FF(e)j Fy(j)e FE(safe)p
1638 762 13 2 v 15 w(run)f FF(e)j Fy(j)e FE(up)f FF(e)150
854 y FI(T)o(yp)q(es)j(and)e(T)o(yp)q(e)i(En)o(vironmen)o(ts:)741
942 y FF(\034)25 b Fy(2)11 b FF(T)23 b FI(:=)12 b FF(b)18
b Fy(j)g FF(\034)1010 948 y FA(1)1040 942 y Fy(!)11 b
FF(\034)1111 948 y FA(2)1149 942 y Fy(j)18 b(h)p FF(\034)5
b Fy(i)18 b(j)g FE([)p FF(\034)5 b FE(])741 992 y FF(\000)17
b Fy(2)11 b FF(D)i FI(:=)f([])17 b Fy(j)11 b FF(x)h FI(:)f
FF(\034)1072 977 y Ft(n)1094 992 y FI(;)c FF(\000)150
1081 y FI(Op)q(erations)15 b(on)e(T)o(yp)q(e)i(En)o(vironmen)o(ts:)759
1178 y FF(\000)791 1163 y FA(+)818 1178 y FI(\()p FF(x)p
FI(\))888 1155 y Ft(\001)886 1178 y FI(=)d FF(\034)953
1163 y Ft(n)p FA(+)1014 1178 y FI(where)j FF(\000)6 b
FI(\()p FF(x)p FI(\))11 b(=)h FF(\034)1300 1163 y Ft(n)150
1264 y FI(T)o(yp)q(e)i(Rules:)p 882 1374 190 2 v 882
1412 a FF(\000)j Fy(`)950 1400 y Ft(n)985 1412 y FF(c)11
b FI(:)g FF(\034)1055 1418 y Ft(c)1086 1383 y FI(Const)272
1496 y FF(\000)6 b FI(\()p FF(x)p FI(\))11 b(=)h FF(\034)438
1480 y Ft(n)p 272 1517 189 2 v 274 1555 a FF(\000)17
b Fy(`)342 1543 y Ft(n)377 1555 y FF(x)11 b FI(:)g FF(\034)474
1527 y FI(V)m(ar)621 1496 y FF(\000)6 b FI(;)h FF(x)j
FI(:)h FF(\034)752 1480 y Ft(n)747 1506 y FA(1)786 1496
y Fy(`)811 1480 y Ft(n)845 1496 y FF(e)h FI(:)f FF(\034)917
1502 y FA(2)p 585 1517 387 2 v 585 1555 a FF(\000)17
b Fy(`)653 1543 y Ft(n)688 1555 y FF(\025x:e)11 b FI(:)g(\()p
FF(\034)835 1561 y FA(1)866 1555 y Fy(!)g FF(\034)937
1561 y FA(2)955 1555 y FI(\))985 1527 y(Lam)1113 1496
y FF(\000)17 b Fy(`)1181 1480 y Ft(n)1215 1496 y FF(e)1234
1502 y FA(1)1265 1496 y FI(:)11 b(\()p FF(\034)1322 1502
y FA(1)1352 1496 y Fy(!)h FF(\034)1424 1502 y FA(2)1442
1496 y FI(\))42 b FF(\000)17 b Fy(`)1568 1480 y Ft(n)1602
1496 y FF(e)1621 1502 y FA(2)1652 1496 y FI(:)11 b FF(\034)1693
1502 y FA(1)p 1113 1517 599 2 v 1281 1555 a FF(\000)16
b Fy(`)1348 1543 y Ft(n)1383 1555 y FF(e)1402 1561 y
FA(1)1435 1555 y FF(e)1454 1561 y FA(2)1484 1555 y FI(:)11
b FF(\034)1525 1561 y FA(2)1725 1527 y FI(App)719 1639
y FF(\000)17 b Fy(`)787 1624 y Ft(n)p FA(+)847 1639 y
FF(e)12 b FI(:)f FF(\034)p 699 1660 244 2 v 699 1698
a(\000)17 b Fy(`)767 1686 y Ft(n)802 1698 y Fy(h)p FF(e)p
Fy(i)12 b FI(:)f Fy(h)p FF(\034)5 b Fy(i)957 1670 y FI(Brk)1079
1639 y FF(\000)17 b Fy(`)1147 1624 y Ft(n)1181 1639 y
FF(e)12 b FI(:)f Fy(h)q FF(\034)5 b Fy(i)p 1071 1660
228 2 v 1071 1698 a FF(\000)17 b Fy(`)1139 1686 y Ft(n)p
FA(+)1200 1698 y FE(~)q FF(e)12 b FI(:)f FF(\034)1312
1670 y FI(Esc)437 1787 y FF(\000)17 b Fy(`)505 1772 y
Ft(n)539 1787 y FF(e)558 1793 y Ft(i)584 1787 y FI(:)11
b FE([)p FF(\034)637 1793 y Ft(i)651 1787 y FE(])41 b
Fy(f)p FF(x)749 1793 y Ft(i)774 1787 y FI(:)11 b FE([)p
FF(\034)827 1793 y Ft(i)841 1787 y FE(])853 1766 y FA(0)872
1787 y Fy(j)p FF(i)g Fy(2)g FF(m)p Fy(g)h(`)1042 1772
y FA(0)1073 1787 y FF(e)g FI(:)f FF(\034)p 437 1808 713
2 v 532 1846 a(\000)17 b Fy(`)600 1834 y Ft(n)635 1846
y FE(close)12 b FF(e)f FE(with)i FF(x)871 1852 y Ft(i)896
1846 y FI(=)f FF(e)959 1852 y Ft(i)984 1846 y FI(:)f
FE([)p FF(\034)5 b FE(])1163 1818 y FI(Clo)1307 1787
y FF(\000)17 b Fy(`)1375 1772 y Ft(n)1410 1787 y FF(e)12
b FI(:)f FE([)p FF(\034)5 b FE(])p 1272 1808 274 2 v
1272 1846 a FF(\000)17 b Fy(`)1340 1834 y Ft(n)1374 1846
y FE(op)q(en)c FF(e)f FI(:)f FF(\034)1560 1818 y FI(Opn)676
1930 y FF(\000)17 b Fy(`)744 1915 y Ft(n)778 1930 y FF(e)12
b FI(:)f FE([)p Fy(h)p FF(\034)5 b Fy(i)p FE(])p 617
1951 354 2 v 617 1989 a FF(\000)16 b Fy(`)684 1977 y
Ft(n)719 1989 y FE(safe)p 788 1989 13 2 v 15 w(run)d
FF(e)e FI(:)g FE([)p FF(\034)5 b FE(])984 1961 y FI(SRn)1147
1930 y FF(\000)17 b Fy(`)1215 1915 y Ft(n)1250 1930 y
FF(e)11 b FI(:)h FE([)o FF(\034)5 b FE(])p 1107 1951
283 2 v 1107 1989 a FF(\000)17 b Fy(`)1175 1977 y Ft(n)p
FA(+)1235 1989 y FE(up)c FF(e)e FI(:)g FE([)p FF(\034)5
b FE(])1404 1961 y FI(Up)737 2169 y FG(Fig.)i(5.5.)14
b FI(The)g FF(\025)1022 2154 y FE(BN)1096 2169 y FI(T)o(yp)q(e)g
(System)p eop
%%Page: 93 104
93 103 bop 1882 0 a FB(93)168 192 y FI(2.)20 b(functional)12
b(v)n(alues)i(arise)g(only)f(inside)h(cross-stage)i(p)q(ersisten)o(t)f
(constan)o(ts,)168 263 y(3.)20 b(Closed)14 b(cross-stage)h(p)q
(ersisten)o(t)h(constan)o(ts)e(do)g(not)g(con)o(tain)f(free)i(v)n
(ariables.)150 368 y(F)m(or)e(example,)g(the)h FE(puzzle)h
FI(term)f(of)f(Chapter)h(4)221 460 y Fy(h)p FE(fn)g(a)f
Fy(\))i FE(~)q(\(\(fn)f(x)g Fy(\))f(h)q FE(x)p Fy(i)p
FE(\))h(\(fn)g(x)g Fy(\))f(h)p FE(a)p Fy(i)q FE(\)\))h(0)p
Fy(i)150 550 y FI(is)h(no)g(longer)f(acceptable)i(b)o(y)f(the)h(t)o(yp)
q(e)f(system,)f(b)q(ecause)j(a)e(cross-stage)h(p)q(ersisten)o(t)h(v)n
(ariable)d(suc)o(h)h(as)g FE(x)g FI(in)150 624 y(the)g(\014rst)g(lam)o
(b)q(da-abstraction)d(m)o(ust)i(b)q(e)h(of)f(Closed)g(t)o(yp)q(e,)h
(and)f(at)g(the)h(same)f(time,)e FE(a)j FI(is)f(a)g(free)h(v)n(ariable)
e(in)150 699 y(the)h(second)h(lam)o(b)q(da-abstraction)d(and)i(so)g
(the)g(lam)o(b)q(da-abstraction)e(cannot)i(ha)o(v)o(e)g(Closed)g(t)o
(yp)q(e.)150 782 y(As)d(co)o(v)o(ering)g(in)o(v)o(olv)o(es)f(adding)h
(an)f(extra)i(function)f(comp)q(osition)e(and)i(a)f(laten)o(t)h(tra)o
(v)o(ersal)g(of)g(co)q(de)g(ev)o(ery)h(time)150 857 y(a)f(cross-stage)h
(p)q(ersisten)o(t)h(v)n(ariable)d(is)h(ev)n(aluated)g(\(indep)q(enden)o
(tly)h(of)f(whether)h(it)f(con)o(tains)g(an)o(y)g(hidden)g(free-)150
931 y(v)n(ariables)h(or)h(not\),)f(co)o(v)o(ering)g(is)h(a)f(costly)h
(op)q(eration.)f(The)h(observ)n(ations)g(ab)q(o)o(v)o(e)f(also)g
(suggest)h(that)g(co)o(v)o(ering)150 1006 y(can)h(b)q(e)h(a)o(v)o
(oided)e(completely)f(if)h(w)o(e)i(restrict)g(cross-stage)g(p)q
(ersistence)i(to)d(Closed)g(v)n(alues.)150 1142 y FG(5.7.4)48
b(Basic)15 b(Prop)q(erties)e(of)j(T)o(yp)q(e)f(System)150
1247 y FI(W)m(e)e(no)o(w)h(presen)o(t)h(some)e(tec)o(hnical)i(lemma)o
(s)d(for)h FF(\025)968 1232 y FE(BN)1041 1247 y FI(needed)j(to)e
(establish)g(t)o(yp)q(e-safet)o(y)m(.)150 1342 y FG(Lemma)h(5.7.1)h
(\(W)l(eak)o(ening\))j Fy(8)p FF(n;)7 b(m)k Fy(2)g Fo(N)p
FF(;)c(e)i Fy(2)j FF(E)r(;)7 b(\000)16 b Fy(2)11 b FF(D)q(;)c(\034)r(;)
g(\033)13 b Fy(2)e FF(T)s(:)493 1434 y(\000)17 b Fy(`)561
1416 y Ft(n)595 1434 y FF(e)12 b FI(:)f FF(\034)j Fy(^)9
b FF(x)i Fy(62)h FF(dom)p FI(\()p FF(\000)6 b FI(\))j
Fy(^)f FF(x)k Fy(62)f FI(FV)q(\()p FF(e)p FI(\))h(=)-7
b Fy(\))11 b FF(\000)6 b FI(;)h FF(x)j FI(:)h FF(\033)1388
1416 y Ft(m)1432 1434 y Fy(`)1457 1416 y Ft(n)1491 1434
y FF(e)h FI(:)f FF(\034)r(:)150 1530 y FH(Pr)n(o)n(of.)20
b FI(Same)13 b(as)h(for)f FF(\025)p FI(-M.)1299 b Fy(u)-28
b(t)150 1630 y FG(Lemma)15 b(5.7.2)h(\(Substitu)o(ti)o(on)o(\))i
Fy(8)p FF(n;)7 b(m)k Fy(2)g Fo(N)p FF(;)c(e)972 1636
y FA(1)989 1630 y FF(;)g(e)1027 1636 y FA(2)1057 1630
y Fy(2)k FF(E)r(;)c(\000)1174 1636 y FA(1)1191 1630 y
FF(;)g(\000)1236 1636 y FA(2)1266 1630 y Fy(2)k FF(D)q(;)c(\034)r(;)g
(\033)13 b Fy(2)e FF(T)s(:)436 1722 y(\000)462 1728 y
FA(1)480 1722 y FF(;)c(\000)525 1728 y FA(2)542 1722
y FI(;)g FF(x)k FI(:)g FF(\033)644 1704 y Ft(m)687 1722
y Fy(`)712 1704 y Ft(n)747 1722 y FF(e)766 1728 y FA(1)796
1722 y FI(:)h FF(\034)i Fy(^)8 b FF(\000)914 1728 y FA(2)944
1722 y Fy(`)969 1704 y Ft(m)1013 1722 y FF(e)1032 1728
y FA(2)1062 1722 y FI(:)j FF(\033)i FI(=)-7 b Fy(\))11
b FF(\000)1226 1728 y FA(1)1244 1722 y FF(;)c(\000)1289
1728 y FA(2)1319 1722 y Fy(`)1344 1704 y Ft(n)1378 1722
y FF(e)1397 1728 y FA(1)1416 1722 y FI([)p FF(x)k FI(:=)g
FF(e)1537 1728 y FA(2)1556 1722 y FI(])g(:)g FF(\034)r(:)150
1818 y FH(Pr)n(o)n(of.)20 b FI(Same)13 b(as)h(Substitution)f(for)h
FF(\025)p FI(-M.)1061 b Fy(u)-28 b(t)150 1954 y FG(5.7.5)48
b(T)o(yp)q(e-Safet)o(y)150 2058 y FI(The)14 b(\014rst)h(set)g(of)e
(rules)i(that)f(m)o(ust)e(b)q(e)j(added)f(to)g(the)g(big-step)g(seman)o
(tics)g(is)g(as)g(follo)o(ws:)p 583 2179 152 2 v 589
2237 a FF(x)639 2209 y FA(0)624 2236 y FF(,)-7 b Fy(!)682
2237 y FE(err)768 2189 y FI(V)m(arErr)959 2150 y FF(e)978
2156 y FA(1)1023 2122 y(0)1009 2150 y FF(,)g Fy(!)10
b FF(e)1085 2156 y FA(3)1146 2150 y FF(e)1165 2156 y
FA(3)1195 2150 y Fy(6\021)i FF(\025x:e)p 953 2179 371
2 v 1035 2237 a(e)1054 2243 y FA(1)1087 2237 y FF(e)1106
2243 y FA(2)1151 2209 y(0)1137 2236 y FF(,)-7 b Fy(!)1194
2237 y FE(err)1356 2189 y FI(AppErr)419 2326 y FF(e)438
2332 y FA(1)483 2298 y(0)469 2326 y FF(,)g Fy(!)10 b
FF(e)545 2332 y FA(2)606 2326 y FF(e)625 2332 y FA(2)655
2326 y Fy(6\021)i FE(close)g FF(v)p 413 2355 409 2 v
493 2412 a FE(op)q(en)g FF(e)606 2418 y FA(1)652 2384
y(0)637 2412 y FF(,)-7 b Fy(!)11 b FE(err)854 2364 y
FI(OpnErr)1059 2326 y FF(e)1078 2332 y FA(1)1124 2298
y(0)1109 2326 y FF(,)-7 b Fy(!)10 b FF(e)1185 2332 y
FA(2)1246 2326 y FF(e)1265 2332 y FA(2)1295 2326 y Fy(6\021)i
FE(close)g Fy(h)p FF(v)q Fy(i)p 1054 2355 441 2 v 1121
2412 a FE(safe)p 1190 2412 13 2 v 15 w(run)h FF(e)1291
2418 y FA(1)1336 2384 y(0)1321 2412 y FF(,)-7 b Fy(!)11
b FE(err)1527 2364 y FI(SRnErr)475 2502 y FF(e)494 2508
y FA(1)539 2474 y(0)525 2501 y FF(,)-7 b Fy(!)582 2502
y FF(e)601 2508 y FA(2)662 2502 y FF(e)681 2508 y FA(2)711
2502 y Fy(6\021)12 b FE(close)g FF(v)p 469 2530 409 2
v 569 2588 a FE(up)g FF(e)642 2594 y FA(1)688 2560 y(1)673
2588 y FF(,)-7 b Fy(!)10 b FE(err)910 2540 y FI(UpErr)1091
2502 y FF(e)1110 2508 y FA(1)1155 2474 y(0)1141 2501
y FF(,)-7 b Fy(!)1198 2502 y FF(e)1217 2508 y FA(2)1278
2502 y FF(e)1297 2508 y FA(2)1327 2502 y Fy(6\021)12
b(h)p FF(v)q Fy(i)p 1085 2530 346 2 v 1170 2588 a FE(~)q
FF(e)1211 2594 y FA(1)1257 2560 y(1)1242 2588 y FF(,)-7
b Fy(!)10 b FE(err)1463 2540 y FI(Esc1Err)1670 2364 y
FF(:)150 2670 y FI(Again,)i(the)i(propagation)e(rules)i(simply)e
(return)i(an)f(error)i(if)d(the)i(result)g(of)f(a)g(sub-computation)f
(is)h(an)g(error.)p eop
%%Page: 94 105
94 104 bop 1882 0 a FB(94)150 192 y FG(5.7.6)48 b(Basic)15
b(Prop)q(erties)e(of)j(Big-Step)d(Seman)o(tics)150 297
y FI(V)m(alues)h(for)f FF(\025)369 282 y FE(BN)442 297
y FI(are)i(de\014ned)g(as)f(follo)o(ws:)303 381 y FF(v)324
366 y FA(0)355 381 y Fy(2)d FF(V)428 366 y FA(0)513 381
y FI(:=)g FF(\025x:e)j Fy(j)f(h)p FF(v)723 366 y FA(1)743
381 y Fy(i)g(j)h FE(close)e FF(v)914 366 y FA(0)303 472
y FF(v)324 457 y FA(1)355 472 y Fy(2)f FF(V)428 457 y
FA(1)513 472 y FI(:=)g FF(c)j Fy(j)f FF(x)h Fy(j)f FF(v)709
457 y FA(1)742 472 y FF(v)763 457 y FA(1)796 472 y Fy(j)h
FF(\025x:v)903 457 y FA(1)935 472 y Fy(j)g(h)p FF(v)998
457 y FA(2)1017 472 y Fy(i)g(j)f FE(close)f FF(e)g FE(with)h
FF(x)1309 478 y Ft(i)1334 472 y FI(=)e FF(v)1398 457
y FA(1)1397 483 y Ft(i)1431 472 y Fy(j)j FE(op)q(en)f
FF(v)1573 457 y FA(1)1606 472 y Fy(j)g FE(safe)p 1700
472 13 2 v 15 w(run)g FF(v)1803 457 y FA(1)248 563 y
FF(v)269 548 y Ft(n)p FA(++)355 563 y Fy(2)e FF(V)428
548 y Ft(n)p FA(++)513 563 y FI(:=)g FF(c)j Fy(j)f FF(x)h
Fy(j)f FF(v)709 548 y Ft(n)p FA(++)797 563 y FF(v)818
548 y Ft(n)p FA(++)906 563 y Fy(j)h FF(\025x:v)1013 548
y Ft(n)p FA(++)1100 563 y Fy(j)f(h)q FF(v)1163 548 y
Ft(n)p FA(+++)1262 563 y Fy(i)h(j)h FE(~)q FF(v)1362
548 y Ft(n)p FA(+)1424 563 y Fy(j)568 655 y FE(up)e FF(v)644
640 y Ft(n)p FA(+)706 655 y Fy(j)g FE(close)f FF(e)g
FE(with)h FF(x)968 661 y Ft(i)993 655 y FI(=)e FF(v)1057
637 y Ft(n)p FA(++)1056 666 y Ft(i)1145 655 y Fy(j)j
FE(op)q(en)f FF(v)1287 640 y Ft(n)p FA(++)1375 655 y
Fy(j)g FE(safe)p 1469 655 V 15 w(run)g FF(v)1572 640
y Ft(n)p FA(++)150 740 y FG(Lemma)i(5.7.3)h(\(V)l(alues\))j
Fy(8)p FF(n)12 b Fy(2)f Fo(N)p FF(:)166 832 y FH(1.)21
b FF(v)13 b Fy(2)e FF(V)326 817 y Ft(n)360 832 y FI(=)-7
b Fy(\))12 b FF(v)h Fy(2)e FF(V)545 817 y Ft(n)p FA(+)166
894 y FH(2.)21 b Fy(8)p FF(e;)7 b(e)301 879 y Fs(0)324
894 y Fy(2)k FF(E)396 879 y Ft(n)419 894 y FF(:)c(e)481
867 y Ft(n)468 894 y FF(,)-7 b Fy(!)11 b FF(e)545 879
y Fs(0)568 894 y FI(=)-7 b Fy(\))12 b FF(e)666 879 y
Fs(0)689 894 y Fy(2)f FI(\()p FF(V)778 879 y Ft(n)810
894 y Fy([)e(f)p FE(err)q Fy(g)p FI(\))150 991 y FH(Pr)n(o)n(of.)20
b FI(Just)15 b(as)f(for)f FF(\025)p FI(-M.)1319 b Fy(u)-28
b(t)150 1098 y FI(The)18 b(k)o(ey)f(prop)q(ert)o(y)h(to)f(establish)h
(for)f FF(\025)810 1082 y FE(BN)886 1098 y FI(is)h(that)f(a)g(v)n(alue)
g(pro)q(duced)h(b)o(y)f(ev)n(aluating)f(an)h(expression)i(of)150
1172 y(Closed)c(t)o(yp)q(e)h(will)e(actually)g(b)q(e)i(a)f
FH(close)n(d)k FI(v)n(alue.)c(The)g(follo)o(wing)e(lemma)f(formalizes)h
(this)j(claim)d(b)o(y)i(sa)o(ying)150 1247 y(that)f(a)g(v)n(alue)f(of)g
(Closed)h(t)o(yp)q(e)g(is)g(t)o(ypable)g(under)h(the)f(empt)o(y)f(en)o
(vironmen)o(t:)150 1348 y FG(Lemma)i(5.7.4)h(\(Closedness\))i
Fy(8)p FF(v)13 b Fy(2)e FF(V)845 1333 y FA(0)864 1348
y FF(;)c(\000)16 b Fy(2)11 b FF(D)q(;)c(\034)16 b Fy(2)c
FF(T)s(:)788 1440 y(\000)17 b Fy(`)856 1423 y FA(0)887
1440 y FF(v)c FI(:)e FE([)p FF(\034)5 b FE(])11 b FI(=)-7
b Fy(\))11 b(;)h(`)1137 1423 y FA(0)1167 1440 y FF(v)h
FI(:)e FE([)p FF(\034)5 b FE(])p FF(:)150 1537 y FH(Pr)n(o)n(of.)20
b FI(Immediate)11 b(from)i(the)h(de\014nition)g(of)f(v)n(alues.)882
b Fy(u)-28 b(t)150 1637 y FG(Lemma)15 b(5.7.5)h(\(Strong)e(V)l(alue)h
(Re\015ection)e(for)i(T)o(yp)q(ed)g(T)l(erms\))20 b Fy(8)p
FF(n)26 b Fy(2)f Fo(N)p FF(;)7 b(\000)29 b Fy(2)c FF(D)q(;)7
b(\034)30 b Fy(2)c FF(T)s(;)7 b(v)27 b Fy(2)150 1702
y FF(V)183 1687 y Ft(n)p FA(+)232 1702 y FF(;)7 b(e)k
Fy(2)g FF(E)353 1687 y Ft(n)376 1702 y FF(:)166 1795
y FH(1.)21 b FF(\000)253 1779 y FA(+)291 1795 y Fy(`)316
1779 y Ft(n)p FA(+)376 1795 y FF(v)13 b FI(:)e FF(\034)17
b FI(=)-7 b Fy(\))11 b FF(\000)17 b Fy(`)613 1779 y Ft(n)647
1795 y FF(v)c FI(:)e FF(\034)5 b FH(,)166 1857 y(2.)21
b FF(\000)16 b Fy(`)288 1841 y Ft(n)323 1857 y FF(e)c
FI(:)f FF(\034)16 b FI(=)-7 b Fy(\))12 b FI(\()p FF(\000)538
1841 y FA(+)576 1857 y Fy(`)601 1841 y Ft(n)p FA(+)661
1857 y FF(e)g FI(:)f FF(\034)j Fy(^)9 b FF(e)j Fy(2)f
FF(V)888 1841 y Ft(n)p FA(+)936 1857 y FI(\))p FH(.)150
1953 y(Pr)n(o)n(of.)20 b FI(Just)15 b(as)f(for)f FF(\025)p
FI(-M.)1319 b Fy(u)-28 b(t)150 2054 y FG(Theorem)15 b(5.7.6)h(\(T)o(yp)
q(e)f(Preserv)m(ation)e(for)i(CBV)i FF(\025)1105 2039
y FE(BN)1164 2054 y FG(\))k Fy(8)p FF(n)11 b Fy(2)g Fo(N)p
FF(;)c(e)j Fy(2)h FF(E)r(;)c(\000)16 b Fy(2)11 b FF(D)q(;)c(\034)17
b Fy(2)11 b FF(T)s(:)c(v)13 b Fy(2)e FF(V)1834 2039 y
Ft(n)699 2146 y FF(\000)731 2129 y FA(+)770 2146 y Fy(`)795
2129 y Ft(n)829 2146 y FF(e)h FI(:)f FF(\034)j Fy(^)9
b FF(e)996 2119 y Ft(n)983 2146 y FF(,)-7 b Fy(!)11 b
FF(v)i FI(=)-7 b Fy(\))11 b FF(\000)1184 2129 y FA(+)1223
2146 y Fy(`)1248 2129 y Ft(n)1282 2146 y FF(v)i FI(:)e
FF(\034)r(:)150 2243 y FH(Pr)n(o)n(of.)20 b FI(By)c(induction)f(on)g
(the)h(deriv)n(ation)e(of)h FF(e)956 2215 y Ft(n)943
2243 y FF(,)-7 b Fy(!)13 b FF(v)q FI(.)i(The)h(case)g(for)f
(application)f(uses)j(Substitution.)e(The)150 2307 y(case)f(for)f(Up)h
(in)o(v)o(olv)o(es)e(Closedness,)i(Re\015ection,)f(and)h(W)m(eak)o
(ening,)d(in)i(addition)f(to)i(applying)d(the)j(induction)150
2372 y(h)o(yp)q(othesis.)g(The)g(case)h(for)f(Safe-run)g(in)o(v)o(olv)o
(es)f(Re\015ection.)776 b Fy(u)-28 b(t)150 2473 y FG(Theorem)15
b(5.7.7)h(\(T)o(yp)q(e-Safet)o(y)e(for)h(CBV)h FF(\025)971
2458 y FE(BN)1030 2473 y FG(\))21 b Fy(8)p FF(n)11 b
Fy(2)g Fo(N)p FF(;)c(e)j Fy(2)h FF(E)r(;)c(\000)16 b
Fy(2)11 b FF(D)q(;)c(\034)17 b Fy(2)11 b FF(T)s(:)c Fy(8)p
FF(v)13 b Fy(2)f FF(V)1723 2458 y Ft(n)1746 2473 y FF(:)741
2565 y(\000)773 2548 y FA(+)811 2565 y Fy(`)836 2548
y Ft(n)871 2565 y FF(e)f FI(:)g FF(\034)k Fy(^)8 b FF(e)1037
2538 y Ft(n)1024 2565 y FF(,)-7 b Fy(!)11 b FF(v)i FI(=)-7
b Fy(\))11 b FF(v)j Fy(6\021)d FE(err)r FF(:)150 2662
y FH(Pr)n(o)n(of.)20 b FI(F)m(ollo)o(ws)12 b(directly)i(from)f(T)o(yp)q
(e)h(Preserv)n(ation.)871 b Fy(u)-28 b(t)p eop
%%Page: 95 106
95 105 bop 1882 0 a FB(95)150 194 y FG(5.7.7)48 b(CBN)17
b Fp(\025)446 179 y FE(B)o(N)150 305 y FI(As)d(for)f
FF(\025)p FI(-M,)f(the)i(di\013erence)h(b)q(et)o(w)o(een)g(the)f(CBN)f
(seman)o(tics)g(and)g(the)h(CBV)g(seman)o(tics)e(for)h
FF(\025)1681 290 y FE(BN)1754 305 y FI(is)g(only)f(in)150
380 y(the)i(ev)n(aluation)f(rule)h(for)g(application)e(at)i(lev)o(el)f
(0.)h(F)m(or)f(CBN,)h(the)g(application)f(rule)h(b)q(ecomes)689
480 y FF(e)708 486 y FA(1)753 452 y(0)739 479 y FF(,)-7
b Fy(!)796 480 y FF(\025x:e)42 b(e)p FI([)p FF(x)11 b
FI(:=)g FF(e)1057 486 y FA(2)1076 480 y FI(])1114 452
y FA(0)1099 479 y FF(,)-7 b Fy(!)1157 480 y FF(v)p 683
508 501 2 v 844 566 a(e)863 572 y FA(1)895 566 y FF(e)914
572 y FA(2)960 538 y(0)945 566 y FF(,)g Fy(!)10 b FF(v)1217
518 y FI(App{CBN)150 656 y(Again,)j(the)h(T)o(yp)q(e)g(Preserv)n(ation)
h(pro)q(of)f(need)g(only)g(b)q(e)g(c)o(hanged)g(for)g(the)g
(application)f(case.)150 757 y FG(Theorem)i(5.7.8)h(\(T)o(yp)q(e)f
(Preserv)m(ation)e(for)i(CBV)i FF(\025)1105 742 y FE(BN)1164
757 y FG(\))k Fy(8)p FF(n)11 b Fy(2)g Fo(N)p FF(;)c Fy(8)p
FF(e)j Fy(2)h FF(E)r(;)c(\000)16 b Fy(2)11 b FF(D)q(;)c(\034)17
b Fy(2)11 b FF(T)s(:)c(v)13 b Fy(2)e FF(V)1857 742 y
Ft(n)699 857 y FF(\000)731 840 y FA(+)770 857 y Fy(`)795
840 y Ft(n)829 857 y FF(e)h FI(:)f FF(\034)j Fy(^)9 b
FF(e)996 829 y Ft(n)983 857 y FF(,)-7 b Fy(!)11 b FF(v)i
FI(=)-7 b Fy(\))11 b FF(\000)1184 840 y FA(+)1223 857
y Fy(`)1248 840 y Ft(n)1282 857 y FF(v)i FI(:)e FF(\034)r(:)150
965 y FG(Theorem)k(5.7.9)h(\(T)o(yp)q(e-Safet)o(y)e(for)h(CBN)h
FF(\025)972 950 y FE(BN)1032 965 y FG(\))k Fy(8)p FF(n)12
b Fy(2)f Fo(N)p FF(;)c(e)i Fy(2)i FF(E)r(;)c(\000)17
b Fy(2)11 b FF(D)q(;)c(\034)16 b Fy(2)11 b FF(T)s(:)c
Fy(8)p FF(v)14 b Fy(2)d FF(V)1724 950 y Ft(n)1747 965
y FF(:)741 1065 y(\000)773 1048 y FA(+)811 1065 y Fy(`)836
1048 y Ft(n)871 1065 y FF(e)g FI(:)g FF(\034)k Fy(^)8
b FF(e)1037 1037 y Ft(n)1024 1065 y FF(,)-7 b Fy(!)11
b FF(v)i FI(=)-7 b Fy(\))11 b FF(v)j Fy(6\021)d FE(err)r
FF(:)150 1218 y FD(5.8)56 b(Re\014ning)18 b(the)g(T)n(yp)r(es)150
1346 y FI(The)13 b(crucial)f(insigh)o(t)g(presen)o(ted)i(in)e(this)g(c)
o(hapter)h(is)g(that)f(there)h(are)g(useful)g(t)o(yp)q(e)f(systems)h
(where)g(a)f(function)150 1421 y FE(safe)p 219 1421 13
2 v 15 w(run)22 b FI(:)f([)p Fy(h)p FF(A)p Fy(i)p FI(])g
Fy(!)g FI([)p FF(A)p FI(])d(exists.)i(Safe-run)g(has)g(the)g(same)f(op)
q(erational)g(b)q(eha)o(vior)h(that)f FE(unsafe)p 1763
1421 V 16 w(run)i FI(w)o(as)150 1495 y(in)o(tended)12
b(to)g(ac)o(hiev)o(e,)f(namely)f FH(running)i FI(co)q(de.)g(The)g
(di\013erence)i(is)d FH(only)h FI(in)f(the)h(t)o(yping)f(of)g(this)h
(function.)f(In)g(a)150 1570 y(n)o(utshell,)g FE(safe)p
384 1570 V 15 w(run)i FI(allo)o(ws)e(the)i(programmer)c(to)j(exploit)f
(the)i(fact)f(that)g FH(close)n(d)h(c)n(o)n(de)g(c)n(an)h(b)n(e)f
(safely)g(exe)n(cute)n(d.)150 1713 y FG(5.8.1)48 b(Re\014ning)13
b(the)i(Metho)q(d)150 1824 y FI(W)m(e)i(prop)q(ose)i(a)f(re\014nemen)o
(t)g(of)f(m)o(ulti-stage)f(programmi)o(ng)f(with)i(explicit)h
(assertions)g(ab)q(out)g FH(close)n(dness)p FI(,)150
1898 y(and)c(where)h(these)g(assertions)g(are)f(c)o(hec)o(k)o(ed)h(b)o
(y)f(the)h(t)o(yp)q(e)f(system:)168 2008 y(1.)20 b(W)m(rite)13
b(the)h(con)o(v)o(en)o(tional)f(program)g(\(exactly)h(the)g(same)f(as)h
(b)q(efore\))860 2118 y FH(pr)n(o)n(gr)n(am)d FI(:)g
FF(t)1055 2124 y Ft(S)1091 2118 y Fy(!)g FF(t)1159 2124
y Ft(D)1201 2118 y Fy(!)g FF(t:)168 2226 y FI(2.)20 b(Add)14
b(staging)f FH(and)i(Close)n(dness)f FI(annotations)g(to)f(the)i
(program)d(to)i(ac)o(hiev)o(e)660 2336 y FH(close)n(d)p
769 2336 V 16 w(annotate)n(d)p 960 2336 V 16 w(pr)n(o)n(gr)n(am)d
FI(:)g([)p FF(t)1180 2342 y Ft(S)1215 2336 y Fy(!)g(h)p
FF(t)1299 2342 y Ft(D)1329 2336 y Fy(i)h(!)f(h)p FF(t)p
Fy(i)p FI(])p FF(:)221 2446 y FI(Almost)j(the)i(same)f(as)h(b)q(efore.)
h(The)f(di\013erence)i(is)d(that)h(the)h(programmer)c(m)o(ust)i(no)o(w)
h(use)g(the)h(Closed)221 2521 y(t)o(yp)q(e)e(constructor)i([)p
550 2521 V 14 w(])e(to)f(demonstrate)h(to)g(the)h(t)o(yp)q(e)f(system)g
(that)g(the)h(annotated)f(program)e(do)q(es)j(not)221
2595 y(in)o(tro)q(duce)d(an)o(y)e(\\free)i(dynamic)e(v)n(ariables".)g
(This)h(new)h(requiremen)o(t)f(means)f(that,)h(in)g(constructing)h(the)
221 2670 y(annotated)h(program,)d(the)k(programmer)c(will)i(only)g(b)q
(e)h(allo)o(w)o(ed)f(to)h(use)h(Closed)f(v)n(alues.)p
eop
%%Page: 96 107
96 106 bop 1882 0 a FB(96)168 192 y FI(3.)20 b(Comp)q(ose)13
b(the)h(annotated)g(program)e(with)i(an)g(unfolding)e(com)o(binator)g
(to)i(get)714 308 y FH(close)n(d)p 823 308 13 2 v 15
w(c)n(o)n(de)p 914 308 V 16 w(gener)n(ator)d FI(:)g([)p
FF(t)1158 314 y Ft(S)1193 308 y Fy(!)h(h)p FF(t)1278
314 y Ft(D)1319 308 y Fy(!)f FF(t)p Fy(i)p FI(])p FF(:)221
424 y FI(No)o(w)17 b FE(back)i FI(m)o(ust)e(itself)h(b)q(e)h(Closed)f
(if)f(w)o(e)h(are)h(to)e(use)i(it)f(inside)g(a)g(Closed)g(v)n(alue,)f
(that)h(is,)f(w)o(e)h(use)h(a)221 499 y(sligh)o(tly)12
b(di\013eren)o(t)j(com)o(binator)d FE(closed)p 854 499
V 16 w(back)h FI(:)e([\()p Fy(h)o FF(A)p Fy(i)h(!)f(h)p
FF(B)r Fy(i)q FI(\))h Fy(!)f(h)p FF(A)h Fy(!)f FF(B)r
Fy(i)p FI(])168 573 y(4.)20 b(T)m(urn)13 b(the)i(Closed)f(co)q
(de-generator)h(in)o(to)678 690 y FH(gener)n(ator)p 851
690 V 15 w(of)p 900 690 V 15 w(close)n(d)p 1021 690 V
15 w(c)n(o)n(de)d FI(:)f([)p FF(t)1171 696 y Ft(S)1195
690 y FI(])g Fy(!)g FI([)p Fy(h)p FF(t)1314 696 y Ft(D)1355
690 y Fy(!)g FF(t)p Fy(i)q FI(])p FF(:)221 806 y FI(This)i(new)i
(program)d(is)i(exhibited)g(b)o(y)f(applying)g(a)g(com)o(binator)f
FE(closed)p 1375 806 V 16 w(apply)h FI(:)e([)p FF(A)g
Fy(!)g FF(B)r FI(])h Fy(!)f FI([)p FF(A)p FI(])g Fy(!)g
FI([)p FF(B)r FI(].)168 881 y(5.)20 b(Construct)15 b(or)e(read)i(the)f
(static)h(inputs)f FH(as)h(Close)n(d)f(values)p FI(:)1004
997 y FH(cs)e FI(:)f([)p FF(t)1102 1003 y Ft(S)1125 997
y FI(])221 1113 y(This)i(step)h(is)g(similar)d(to)i(m)o(ulti-stage)e
(programming)f(with)j(explicit)g(annotations.)g(Ho)o(w)o(ev)o(er,)g
(requiring)221 1188 y(the)h(input)g(to)f(b)q(e)i(Closed)f(is)g(m)o(uc)o
(h)e(more)h(sp)q(eci\014c)j(than)d(in)h(the)g(original)e(metho)q(d.)h
(Th)o(us,)h(w)o(e)g(no)o(w)f(ha)o(v)o(e)221 1262 y(to)g(mak)o(e)g(sure)
i(that)f(all)e(com)o(binators)h(used)h(in)g(constructing)h(this)f(v)n
(alue)f(are)h(themselv)o(es)g(Closed.)168 1337 y(6.)20
b(Apply)13 b(the)i(co)q(de)f(generator)h(to)f(the)g(static)g(inputs)h
(to)e(get)758 1453 y FH(close)n(d)p 867 1453 V 16 w(sp)n(e)n(cialize)n
(d)p 1068 1453 V 15 w(c)n(o)n(de)f FI(:)f([)p Fy(h)o
FF(t)1233 1459 y Ft(D)1275 1453 y Fy(!)g FF(t)p Fy(i)p
FI(])p FF(:)168 1570 y FI(7.)20 b(Run)13 b(the)i(result)f(ab)q(o)o(v)o
(e)g(to)g(get:)740 1686 y FH(close)n(d)p 849 1686 V 15
w(sp)n(e)n(cialize)n(d)p 1049 1686 V 15 w(pr)n(o)n(gr)n(am)d
FI(:)g([)p FF(t)1268 1692 y Ft(D)1309 1686 y Fy(!)g FF(t)p
FI(])p FF(:)221 1802 y FI(This)i(step)i(exploits)e(an)h(in)o(teraction)
f(b)q(et)o(w)o(een)i(the)g(Closed)e(and)h(Co)q(de)g(t)o(yp)q(es)g(in)g
(our)f(t)o(yp)q(e)i(system.)e(The)221 1877 y(step)h(is)g(p)q(erformed)g
(b)o(y)f(applying)g(a)g(function)h FE(safe)p 1042 1877
V 15 w(run)f FI(:)e([)p Fy(h)o FF(A)p Fy(i)q FI(])g Fy(!)g
FI([)p FF(A)p FI(].)168 1952 y(8.)20 b(F)m(orget)13 b(that)h(the)h(sp)q
(ecialized)f(program)f(is)g(Closed:)812 2068 y FH(sp)n(e)n(cialize)n(d)
p 1000 2068 V 15 w(pr)n(o)n(gr)n(am)e FI(:)g FF(t)1207
2074 y Ft(D)1249 2068 y Fy(!)g FF(t:)221 2184 y FI(The)j(step)h(is)f(p)
q(erformed)f(b)o(y)h(applying)e(a)i(function)f FE(op)q(en)p
FI(:[)p FF(A)p FI(])f Fy(!)f FF(A)p FI(.)150 2300 y(The)j(full)f(dev)o
(elopmen)o(t)g(of)g(v)n(arious)g(m)o(ulti-stage)f(programming)e
(examples)j(from)f(previous)i(c)o(hapter)h(can)f(b)q(e)150
2375 y(expressed)i(in)e FF(\025)409 2360 y FE(BN)468
2375 y FI(.)150 2534 y FD(5.9)56 b(Staging)18 b(the)g(P)n(o)n(w)n(er)j
(F)-5 b(unction)19 b(Revisited)150 2666 y FI(Recall)13
b(the)i(p)q(o)o(w)o(er)f(function)f(that)h(w)o(e)g(staged)h(in)e
(Section)i(2.5:)p eop
%%Page: 97 108
97 107 bop 1882 0 a FB(97)221 195 y FE(fun)14 b(exp)h(\(n,x\))f(=)g
(\(*)g(:)f(int)i Fy(\002)f FE(real)g Fy(!)f FE(real)i(*\))255
260 y(if)e(n)h(=)h(0)e(then)i(1.0)407 325 y(else)g(if)e(even)i(n)g
(then)g(sqr)f(\(exp)h(\(n)g(div)f(2,x\)\))647 390 y(else)g(x)g(*)g(exp)
h(\(n)f(-)g(1,x\).)150 491 y FI(Staging)c(this)i(function)f(in)g
FF(\025)606 476 y FE(BN)677 491 y FI(is)g(essen)o(tially)h(the)g(same)e
(as)i(staging)f(it)g(in)g(MetaML.)g(The)h(di\013erence)i(is)d(that)150
566 y(w)o(e)16 b(surround)i(the)e(MetaML-st)o(yle)h(staged)g(function)f
(with)g(Closedness)h(annotations.)e(W)m(e)h(use)h(Close-with)150
640 y(to)e(mark)e(a)i(term)f(as)h(Closed,)g(and)f(w)o(e)i(use)f(Op)q
(en)h(to)f(\\forget")f(the)i(Closedness)g(of)e(the)i(free)g(v)n
(ariables)e(that)150 715 y(w)o(e)g(wish)g(to)g(use)g(in)g(de\014ning)g
(the)g(Closed)g(term.)f(Th)o(us,)h(the)g(program)e(is)i(annotated)g(as)
g(follo)o(ws:)221 821 y FE(val)f(exp")i(=)f(\(*)g(:)f([int)h
Fy(\002)h(h)p FE(real)p Fy(i)f(!)g(h)p FE(real)p Fy(i)p
FE(])g(*\))260 886 y(close)g(let)g(val)g(even)h(=)f(op)q(en)i(even")f
(\(*)e(:)h(int)g Fy(!)f FE(b)q(o)q(ol)h(*\))414 951 y(val)g(sqr')g(=)g
(op)q(en)h(sqr")f(\(*)g(:)f Fy(h)q FE(real)p Fy(i)h(!)f(h)p
FE(real)p Fy(i)i FE(*\))414 1016 y(fun)g(exp')f(\(n,x\))g(=)g(\(*)g(:)f
(int)i Fy(\002)f(h)p FE(real)p Fy(i)g(!)g(h)p FE(real)p
Fy(i)g FE(*\))448 1080 y(if)g(n)g(=)g(0)g(then)h Fy(h)p
FE(1.0)p Fy(i)601 1145 y FE(else)f(if)g(even)h(n)f(then)i(sqr')d
(\(exp')i(\(n)f(div)h(2,x\)\))840 1210 y(else)g Fy(h)q
FE(~)q(x)f(*)h(~)q(\(exp')f(\(n)h(-)e(1,x\)\))p Fy(i)p
FE(;)357 1275 y(in)h(exp')h(end)260 1339 y(with)f(even")h(=)f(even",)h
(sqr")f(=)g(sqr".)150 1441 y FI(where)g FE(even")g FI(and)f
FE(sqr")g FI(are)g(v)o(ersions)g(of)g(the)g FE(even)h
FI(and)f(the)g FE(sqr')g FI(functions)g(Closed)g(in)g(the)g(same)f
(manner)g(as)150 1515 y(ab)q(o)o(v)o(e)254 1500 y FA(6)272
1515 y FI(.)i(F)m(or)f(example,)f FE(sqr")j FI(is)e(de\014ned)i(as:)221
1622 y FE(val)e(sqr")i(=)f(\(*)f(:)h([)p Fy(h)p FE(real)p
Fy(i)g(!)g(h)p FE(real)p Fy(i)q FE(])f(*\))260 1686 y(close)h(let)g
(fun)h(sqr')e(x)h(=)h(\(*)e(:)h Fy(h)p FE(real)p Fy(i)g(!)g(h)p
FE(real)p Fy(i)g FE(*\))448 1751 y Fy(h)p FE(let)h(val)e(y)h(=)i(~)q(x)
e(in)g(y)g(*)f(y)h(end)p Fy(i)r FE(;)357 1816 y(in)g(sqr')g(end.)150
1917 y FI(Note)k(that)h(the)f FE(fun)h(exp')f FI(part)h(of)e(the)i
FE(val)f(exp")h FI(declaration)e(is)h(exactly)g(the)h(text)g(for)f(the)
g FE(exp)h FI(function)150 1992 y(staged)14 b(in)g(MetaML.)g(\(See)h
(Section)f(2.5.\))150 2075 y(In)d(general,)g(w)o(e)g(ha)o(v)o(e)g(to)g
(explicitly)f(Close)h(all)f(v)n(alues)h(that)g(w)o(e)h(wish)f(to)g(use)
g(in)g(constructing)h(a)f(bigger)g(Closed)150 2149 y(v)n(alue,)k(with)h
(the)g(exception)h(of)f(primitiv)o(e)e(op)q(erations.)i(Programs)f(pro)
q(duced)i(in)f(this)g(w)o(a)o(y)f(are)i(somewhat)150
2224 y(v)o(erb)q(ose,)e(but)f(w)o(e)h(b)q(eliev)o(e)f(that)h(this)f
(problem)f(can)h(b)q(e)h(alleviated)f(b)o(y)g(a)f(careful)i(separation)
f(of)g(Closed)g(and)150 2299 y(non-Closed)g(v)n(alues)f(in)h(the)g(en)o
(vironmen)o(t.)f(The)h(study)g(of)g(this)g(separation)f(is)h(left)g
(for)f(future)i(w)o(ork.)p 150 2379 237 2 v 158 2406
a Fz(6)188 2422 y FB(The)g(op)q(erationall)q(y)j(unnecessary)e
(re-binding)i Fw(with)13 b(even")i(=)f(even",)g(sqr")h(=)f(sqr")h
FB(is)g(needed)h(for)f(t)o(yp)q(e-c)o(hec)o(king)188
2468 y(\(see)e(t)o(yp)q(e)h(system\).)f(Op)q(erationally)m(,)j(it)d(is)
h(no)f(di\013eren)o(t)h(from)f(writing)i(\()p Fx(\025y)q(:)p
FB(\()p Fx(\025x:e)p FB(\)\))10 b Fx(y)i(x)p FB(.)p eop
%%Page: 98 109
98 108 bop 1882 0 a FB(98)150 192 y FD(5.10)56 b(The)18
b(Re\014ned)g(Metho)r(d)g(is)g(In)n(tuitiv)n(ely)f(App)r(ealing)150
324 y FI(MetaML's)k(original)d(t)o(yp)q(e)j(system)f(\(Section)h
(4.1.2\))d(has)j(one)f(Co)q(de)h(t)o(yp)q(e)g(constructor,)g(whic)o(h)f
(tries)h(to)150 399 y(com)o(bine)16 b(the)i(features)g(of)e(op)q(en)i
(and)f(closed)h(co)q(de)g(t)o(yp)q(e)f(constructors:)i(The)f
(constructor)h(w)o(as)e(supp)q(osed)150 474 y(to)f(allo)o(w)e(us)i(to)g
(\\ev)n(aluate)g(under)g(lam)o(b)q(da")e(\(th)o(us)i(w)o(ork)g(with)g
(op)q(en)g(co)q(de\))h(and)f(to)f(run)i(co)q(de)f(\(for)g(whic)o(h)150
549 y(it)h(m)o(ust)f(b)q(e)i(closed\).)g(This)f FH(c)n(ombination)h
FI(leads)f(to)g(the)h(t)o(yping)e(problem)g(discussed)j(in)e(Section)h
(4.4.2.)d(In)150 623 y(con)o(trast,)g FF(\025)347 608
y FE(BN)406 623 y FI('s)g(t)o(yp)q(e)g(system)f(incorp)q(orates)i
(separate)g(op)q(en-co)q(de)f(and)g(closed-v)n(alue)f(t)o(yp)q(e)h
(constructors,)150 698 y(thereb)o(y)g(pro)o(viding)e
FH(c)n(orr)n(e)n(ct)g(semantics)h FI(for)g(the)g(follo)o(wing)e
(natural)h(and)h(desirable)g(functions:)168 814 y(1.)20
b FE(op)q(en)33 b FI(:)15 b FE([)p FF(\034)5 b FE(])16
b Fy(!)f FF(\034)5 b FI(.)16 b(This)g(function)h(allo)o(ws)e(us)i(to)f
(forget)g(the)i(Closedness)f(of)f(its)h(argumen)o(t.)e(The)i
FF(\025)1861 799 y FE(BN)221 889 y FI(language)c(has)h(no)f(function)h
(of)f(the)i(in)o(v)o(erse)f(t)o(yp)q(e)h FF(\034)h Fy(!)11
b FE([)p FF(\034)5 b FE(])p FI(.)168 964 y(2.)20 b FE(up)k
FI(:)11 b FE([)p FF(\034)5 b FE(])11 b Fy(!)g(h)p FE([)p
FF(\034)5 b FE(])p Fy(i)p FI(.)11 b(This)h(function)f(corresp)q(onds)i
(to)f(cross-stage)h(p)q(ersistence)h(for)d(Closed)h(v)n(alues.)f(In)g
(fact,)221 1038 y(it)j(em)o(b)q(eds)h(an)o(y)g(Closed)g(v)n(alue)f(in)o
(to)h(a)f(co)q(de)i(fragmen)o(t,)d(including)h(v)n(alues)h(of)g
(functional)f(t)o(yp)q(e.)h(Suc)o(h)g(a)221 1113 y(function)e(do)q(es)h
(not)f(exist)h(in)f FF(\025)719 1098 y Fs(\015)767 1113
y FI([22].)f(A)o(t)h(the)h(same)f(time,)e FF(\025)1220
1098 y FE(BN)1293 1113 y FI(has)i(no)h(function)f(of)f(the)i(in)o(v)o
(erse)g(t)o(yp)q(e)221 1188 y Fy(h)p FE([)p FF(\034)5
b FE(])p Fy(i)11 b(!)g FE([)p FF(\034)5 b FE(])p FI(,)13
b(re\015ecting)i(the)g(fact)f(that)g(there)h(is)f(no)f(general)h(w)o(a)
o(y)g(of)f(going)g(bac)o(kw)o(ards.)168 1262 y(3.)20
b FE(safe)p 290 1262 13 2 v 15 w(run)12 b FI(:)f FE([)p
Fy(h)p FF(\034)5 b Fy(i)p FE(])12 b Fy(!)f FE([)p FF(\034)5
b FE(])p FI(.)12 b(This)h(function)g(allo)o(ws)e(us)j(to)f(execute)h(a)
f(Closed)g(piece)h(of)e(co)q(de)i(to)f(get)g(a)g(Closed)221
1337 y(v)n(alue.)g(It)i(can)h(b)q(e)f(view)o(ed)g(as)g(the)h(essence)h
(of)d(the)i(in)o(teraction)f(b)q(et)o(w)o(een)h(the)g(Brac)o(k)o(et)g
(and)e(the)i(Closed)221 1412 y(t)o(yp)q(es.)p eop
%%Page: 99 110
99 109 bop 822 436 a FL(Chapter)31 b(6)591 662 y(Reduction)i(Seman)m
(tics)949 859 y FC(I)14 b(am)g(the)e(one)h(who)g(was)h(se)n(duc)n(e)n
(d)d(by)i(The)g(Imp)n(ossible.)949 918 y(I)h(saw)f(the)g(mo)n(on,)g(I)g
(jump)n(e)n(d)g(high,)f(high)g(in)h(the)g(sky.)949 977
y(R)n(e)n(ache)n(d)f(it)h(|)h(or)g(not;)e(what)h(do)g(I)h(c)n(ar)n(e?)
949 1037 y(Now)g(that)e(my)i(he)n(art)e(was)i(quenche)n(d)d(with)i
(joy!)1439 1129 y(Quatrians)p FB(,)d(Salah)15 b(Jaheen)150
1309 y FI(In)d(this)g(c)o(hapter)h(w)o(e)f(b)q(egin)f(b)o(y)h
(explaining)e(wh)o(y)i(de\014ning)g(a)f(reduction)i(seman)o(tics)e(for)
h(MetaML)g(is)g(c)o(halleng-)150 1384 y(ing.)g(W)m(e)h(then)h(presen)o
(t)h(a)e(strikingly)f(simple)g(reduction)i(seman)o(tics)f(for)g(MetaML)
h(that)f(is)g(con\015uen)o(t,)h(and)f(is)150 1459 y(sound)h(with)g
(resp)q(ect)i(to)e(the)g(big-step)g(seman)o(tics.)150
1542 y(This)d(c)o(hapter)g(presen)o(ts)i(new)e(results)h(on)f(the)g(un)
o(t)o(yp)q(ed)h(seman)o(tics)e(of)g(m)o(ulti-stage)f(programmi)o(ng)f
(languages.)150 1700 y FD(6.1)56 b(A)19 b(Reduction)e(Seman)n(tics)h
(for)g(CBN)h(and)g(CBV)h Fm(\025)150 1833 y FI(A)f(formal)d(seman)o
(tics,)i(in)g(general,)g(pro)o(vides)h(us)g(with)f(a)h(means)e(for)i
(going)e(from)g(arbitrary)h(expressions)150 1908 y(to)g(v)n(alues,)g
(with)g(the)g(pro)o(vision)g(that)g(certain)h(expressions)h(ma)o(y)c
(not)i(ha)o(v)o(e)g(a)g(corresp)q(onding)i(v)n(alue.)d(An)150
1983 y(imp)q(ortan)o(t)d(conceptual)j(to)q(ol)e(for)h(the)g(study)h(of)
e(a)h(programming)c(language)k(is)f(a)h(reduction)h(seman)o(tics.)e(A)
150 2057 y(reduction)h(seman)o(tics)e(is)h(a)f(set)i(of)f(rewrite)g
(rules)h(that)f(formalize)e(the)i(\\notions)g(of)f(reduction")h(for)g
(a)f(giv)o(en)150 2132 y(language.)d(Ha)o(ving)h(suc)o(h)h(a)f(seman)o
(tics)g(can)h(b)q(e)g(useful)g(in)f(dev)o(eloping)g(an)g(equational)g
(theory)1658 2117 y FA(1)1677 2132 y FI(.)g(W)m(e)g(will)f(\014rst)150
2207 y(review)j(ho)o(w)g(this)g(seman)o(tics)f(can)h(b)q(e)h(sp)q
(eci\014ed)g(for)f(the)g FF(\025)g FI(language)f(of)h(Section)g(4.1.2.)
p 150 2287 237 2 v 158 2314 a Fz(1)188 2330 y FB(In)f(our)h(exp)q
(erience,)g(it)g(has)f(also)h(b)q(een)g(the)f(case)g(that)g(studying)i
(suc)o(h)f(a)f(seman)o(tics)h(has)f(help)q(ed)i(us)e(in)h(dev)o
(eloping)188 2376 y(the)i(\014rst)f(t)o(yp)q(e)h(system)f(presen)o(ted)
i(in)f(Chapter)f(5.)g(It)g(is)h(lik)o(ely)i(that)d(a)g(reduction)i
(seman)o(tics)g(can)e(b)q(e)h(helpful)h(in)188 2421 y(dev)o(eloping)f
(a)c(t)o(yp)q(e)h(system.)g(In)f(particular,)j(an)e(imp)q(ortan)o(t)h
(prop)q(ert)o(y)f(of)f(an)h(appropriate)i(t)o(yp)q(e)e(system)g(is)g
(that)f(it)188 2467 y(should)17 b(remain)f(in)o(v)n(arian)o(t)h(under)f
(reductions)h(\(Sub)r(ject)e(Reduction\).)i(Because)f(reduction)g
(seman)o(tics)h(are)e(often)188 2512 y(simple,)g(they)e(can)h(help)g
(language)h(designers)g(eliminate)g(man)o(y)f(inappropriate)i(t)o(yp)q
(e)d(systems.)1014 2795 y FI(99)p eop
%%Page: 100 111
100 110 bop 1862 0 a FB(100)150 192 y FI(Recall)11 b(that)h(the)g(set)h
(of)e(expressions)j(and)d(the)i(set)f(of)g(v)n(alues)f(for)h(the)g
FF(\025)g FI(language)f(can)h(b)q(e)g(de\014ned)h(as)f(follo)o(ws:)795
287 y FF(e)i Fy(2)d FF(E)j FI(:=)e FF(i)18 b Fy(j)g FF(x)h
Fy(j)f FF(\025x:e)g Fy(j)g FF(e)7 b(e)795 362 y(v)13
b Fy(2)e FF(V)21 b FI(:=)12 b FF(i)18 b Fy(j)g FF(\025x:e:)150
449 y FI(In)d(order,)h(the)g(pro)q(ductions)g(for)g(expressions)h(are)e
(for)h(in)o(tegers,)f(lam)o(b)q(da)f(abstractions,)h(and)g
(applications.)150 524 y(V)m(alues)f(for)f(this)h(language)f(are)h(in)o
(tegers)h(and)f(lam)o(b)q(da-abstractions.)150 607 y(In)o(tuitiv)o(ely)
m(,)h(expressions)k(are)f(\\commands")d(or)i(\\computations",)e(and)j
(v)n(alues)f(are)h(the)g(\\answ)o(ers",)f(\\ac-)150 681
y(ceptable)g(results")g(or)f(simply)e(\\expressions)k(that)e(require)h
(no)f(further)h(ev)n(aluation".)d(Note)i(that)g(w)o(e)h(allo)o(w)150
756 y(an)o(y)e(v)n(alue)g(to)g(b)q(e)i(used)f(as)g(an)f(expression)i
(with)e(no)g(computational)f(con)o(ten)o(t.)h(In)h(order)g(to)g(build)e
(a)i(mec)o(h-)150 831 y(anism)d(for)i(going)e(from)h(expressions)i(to)f
(v)n(alues,)f(w)o(e)h(need)h(to)f(sp)q(ecify)g(a)g(formal)d(rule)j(for)
g(eliminating)d(b)q(oth)150 906 y(v)n(ariables)h(and)g(applications)f
(from)g(a)h(program.)e(In)j(a)f FH(r)n(e)n(duction)h(semantics)p
FI(,)f(\(see)i(for)e(example)f(Barendregt)150 980 y([1]\))g(this)h
(elimination)d(pro)q(cess)15 b(is)e(sp)q(eci\014ed)i(b)o(y)e(in)o(tro)q
(ducing)g(rewrite)h(rules)g(called)f(\\notions)f(of)h(reduction".)150
1055 y(The)h(w)o(ell-kno)o(wn)f FF(\014)j FI(rule)f(helps)f(us)g
(eliminate)e(b)q(oth)i(applications)f(and)h(v)n(ariables)f(at)h(the)g
(same)f(time:)792 1166 y(\()p FF(\025x:e)887 1172 y FA(1)906
1166 y FI(\))7 b FF(e)948 1172 y FA(2)979 1166 y Fy(\000)-7
b(!)1046 1172 y Fr(\014)1077 1166 y FF(e)1096 1172 y
FA(1)1115 1166 y FI([)p FF(x)10 b FI(:=)i FF(e)1236 1172
y FA(2)1255 1166 y FI(])p FF(:)150 1267 y FI(This)j(rule)g(sa)o(ys)g
(that)g(the)h(application)e(of)g(a)h(lam)o(b)q(da-abstraction)d(to)j
(an)g(expression)h(can)f(b)q(e)h(simpli\014ed)d(to)150
1342 y(the)k(substitution)g(the)g(expression)h(in)o(to)d(the)j(b)q(o)q
(dy)e(of)g(the)h(lam)o(b)q(da-abstraction.)d(The)j(CBN)g(seman)o(tics)f
(is)150 1417 y(based)f(on)e(this)h(rule.)g(A)g(similar)d(rule)j(is)g
(used)h(for)e(CBV:)819 1528 y(\()p FF(\025x:e)p FI(\))7
b FF(v)13 b Fy(\000)-6 b(!)1038 1534 y Fr(\014)1054 1538
y(v)1085 1528 y FF(e)p FI([)p FF(x)11 b FI(:=)g FF(v)q
FI(])p FF(;)150 1629 y FI(where)20 b(the)e(argumen)o(t)g(is)g
(restricted)i(to)f(b)q(e)g(a)f(CBV)g(v)n(alue)1134 1614
y FA(2)1152 1629 y FI(,)g(th)o(us)h(forcing)f(it)g(b)q(e)h(ev)n
(aluated)f(b)q(efore)h(it)f(is)150 1704 y(passed)c(to)f(the)g
(function.)g(The)g(MetaML)g(implemen)o(tation)d(is)j(CBV,)g(but)g(w)o
(e)g(will)e(simply)g(use)j FF(\014)i FI(in)c(the)i(rest)150
1778 y(of)f(this)h(c)o(hapter,)h(emphasizing)d(the)j(applicabilit)o(y)c
(of)i(the)i(w)o(ork)e(to)h(a)g(CBN)g(language)1553 1763
y FA(3)1571 1778 y FI(.)150 1861 y(Using)20 b(the)g FF(\014)j
FI(rule,)c(w)o(e)h(build)g(a)f(new)h(relation)g Fy(\000)-7
b(!)22 b FI(\(with)d(no)h(subscript\))h(that)f(allo)o(ws)f(us)h(to)g(p)
q(erform)150 1936 y(this)g(rewrite)g(on)f(an)o(y)g(sub)q(expressions.)j
(\(See)e(for)f(example)g(Section)h(3.1.\))e(More)i(formally)l(,)c(for)j
(an)o(y)g(t)o(w)o(o)150 2011 y(expressions)14 b FF(C)s
FI([)p FF(e)p FI(])e(and)h FF(C)s FI([)p FF(e)597 1996
y Fs(0)608 2011 y FI(])g(whic)o(h)g(are)g(iden)o(tical)f(ev)o(erywhere)
j(but)e(in)g(exactly)g(one)g(hole)g(\014lled)f(with)h
FF(e)g FI(and)150 2085 y FF(e)169 2070 y Fs(0)181 2085
y FI(,)g(resp)q(ectiv)o(ely)m(,)i(w)o(e)f(can)g(sa)o(y:)783
2192 y FF(e)e Fy(\000)-7 b(!)881 2198 y Fr(\014)912 2192
y FF(e)931 2174 y Fs(0)955 2192 y FI(=)g Fy(\))11 b FF(C)s
FI([)p FF(e)p FI(])g Fy(\000)-7 b(!)13 b FF(C)s FI([)p
FF(e)1264 2174 y Fs(0)1275 2192 y FI(])150 2298 y(When)h(there)i(is)e
(more)f(than)i(one)f(rule)h(in)e(our)i(reduction)g(seman)o(tics,)e(the)
i(left)f(hand)g(side)h(of)e(this)i(condition)150 2372
y(is)g(the)h(disjunction)f(of)g(the)h(rewrites)g(from)e
FF(e)i FI(to)f FF(e)967 2357 y Fs(0)994 2372 y FI(using)g
FH(any)20 b FI(of)15 b(the)g(rules)h(in)f(our)h(rewrite)g(system.)f(Th)
o(us)p 150 2445 237 2 v 158 2471 a Fz(2)188 2487 y FB(CBV)e(v)n(alues)i
(are)e(sligh)o(tly)i(di\013eren)o(t)g(from)e(CBN)g(v)n(alues,)h(most)f
(notably)m(,)h(in)g(that)g(CBV)e(v)n(alues)j(t)o(ypically)h(include)188
2533 y(v)n(ariables)i(also.)d(Note)g(also)h(that)f(this)h(distinction)i
(only)e(arises)g(for)f(reduction)h(seman)o(tics,)g(and)g(not)f(for)g
(big-step)188 2579 y(seman)o(tics.)158 2608 y Fz(3)188
2624 y FB(It)c(should)h(b)q(e)f(noted)g(that,)g(due)g(to)g(time)g
(limitations,)j(w)o(e)c(ha)o(v)o(e)h(only)h(formally)g(v)o(eri\014ed)g
(con\015uence)h(and)e(soundness)188 2670 y(for)i(CBN)g(MetaML,)g(and)g
(not)h(for)e(CBV)h(MetaML.)g(Ho)o(w)o(ev)o(er,)f(w)o(e)h(exp)q(ect)h
(these)f(prop)q(erties)i(to)e(hold.)p eop
%%Page: 101 112
101 111 bop 1862 0 a FB(101)150 192 y FI(the)16 b(relation)f
Fy(\000)-7 b(!)17 b FI(holds)e(b)q(et)o(w)o(een)i(an)o(y)e(t)o(w)o(o)g
(terms)g(if)f(exactly)i(one)f(of)g(their)h(subterms)f(is)h(rewritten)g
(using)150 266 y(an)o(y)d(of)h(the)g(rules)h(in)e(our)h(reduction)h
(seman)o(tics.)150 399 y FG(6.1.1)48 b(Coherence)15 b(and)g
(Con\015uence)150 500 y FI(Tw)o(o)i(imp)q(ortan)o(t)f(concepts)j(that)f
(will)e(b)q(e)i(cen)o(tral)h(to)e(this)h(c)o(hapter)g(are)g(coherence)i
(and)e(con\015uence)h(\(F)m(or)150 575 y(con\015uence,)c(see)h(for)d
(example)g(Barendregt)j([1]\).)c(Recall)h(from)g(Section)h(3.1)f(that)h
(a)g(term-rewriting)f(system)150 650 y(is)g(non-deterministic.)f
(Therefore,)i(dep)q(ending)g(on)f(the)h(order)f(in)g(whic)o(h)g(w)o(e)h
(apply)e(the)i(rules,)f(w)o(e)h(migh)o(t)d(get)150 724
y(di\013eren)o(t)16 b(results.)g(When)f(this)h(is)f(the)g(case,)h(our)f
(seman)o(tics)g(could)g(reduce)i(a)e(program)e FF(e)j
FI(to)f(either)h(0)f(or)g(1.)150 799 y(W)m(e)i(sa)o(y)g(a)h(reduction)g
(seman)o(tics)f(is)g FH(c)n(oher)n(ent)h FI(when)g(an)o(y)f(path)g
(that)h(leads)g(to)f(a)g(ground)h(v)n(alue)e(leads)i(to)150
874 y(the)g(same)f(ground)g(v)n(alue.)f(A)i(seman)o(tics)f(that)g(lac)o
(ks)g(coherence)j(is)d(not)h(satisfactory)f(for)g(a)g(deterministic)150
949 y(programming)10 b(language.)150 1032 y(In)o(tuitiv)o(ely)m(,)g
(kno)o(wing)g(that)i(a)g(rewriting)g(system)f(is)h FH(c)n(on\015uent)h
FI(tells)f(us)g(that)g(the)g(reductions)h(can)f(b)q(e)h(applied)150
1106 y(in)i(an)o(y)f(order,)i(without)e(a\013ecting)i(the)f(set)h(of)f
(results)h(that)f(w)o(e)h(can)f(reac)o(h)h(b)o(y)f(applying)e(more)h
(reductions.)150 1181 y(Th)o(us,)f(con\015uence)j(of)d(a)g
(term-rewriting)g(system)h(is)f(a)g(w)o(a)o(y)g(of)g(ensuring)i
(coherence.)g(Con)o(v)o(ersely)m(,)e(if)g(w)o(e)h(lose)150
1256 y(coherence,)i(w)o(e)e(lose)g(con\015uence.)150
1339 y(W)m(e)19 b(no)o(w)h(turn)g(to)f(the)i(problem)d(of)h(ho)o(w)h
(to)f(extend)i(the)f(reduction)h(seman)o(tics)e(of)g
FF(\025)h FI(to)g(a)f(m)o(ulti-stage)150 1413 y(language.)150
1557 y FD(6.2)56 b(Extending)17 b(the)h(Reduction)g(Seman)n(tics)f(for)
i Fm(\025)150 1675 y FI(A)12 b(\014rst)i(attempt)d(at)h(extending)h
(the)g(set)g(of)f(expressions)i(and)e(v)n(alues)g(of)g
FF(\025)g FI(to)g(incorp)q(orate)h(the)g(basic)g(staging)150
1749 y(constructs)j(of)d(MetaML)h(yields)g(the)h(follo)o(wing)c(set)k
(of)e(expressions)i(and)f(v)n(alues:)637 1852 y FF(e)e
Fy(2)f FF(E)j FI(:=)d FF(i)19 b Fy(j)f FF(x)g Fy(j)g
FF(\025x:e)g Fy(j)g FF(e)7 b(e)19 b Fy(j)11 b(h)q FF(e)p
Fy(i)19 b(j)12 b FE(~)q FF(e)18 b Fy(j)12 b FE(run)g
FF(e;)150 1944 y FI(and)i(w)o(e)g(add)g(the)g(follo)o(wing)d(t)o(w)o(o)
j(rules)g(to)g(the)g FF(\014)j FI(rule:)949 2032 y FE(~)q
Fy(h)p FF(e)p Fy(i)12 b(\000)-6 b(!)1102 2038 y Fr(E)1137
2032 y FF(e)902 2106 y FE(run)13 b Fy(h)p FF(e)p Fy(i)f(\000)-6
b(!)1102 2112 y Fr(R)1137 2106 y FF(e:)150 2184 y FI(But)13
b(there)h(are)f(sev)o(eral)g(reasons)g(wh)o(y)f(this)h(naiv)o(e)f
(approac)o(h)g(is)g(unsatisfactory)m(.)g(In)g(the)h(rest)h(of)e(this)g
(c)o(hapter,)150 2259 y(w)o(e)j(will)e(explain)g(the)j(problems)d(with)
h(this)h(approac)o(h,)f(and)g(explore)h(the)g(space)h(of)e(p)q(ossible)
g(impro)o(v)o(emen)o(ts)150 2334 y(to)g(this)g(seman)o(tics.)150
2477 y FD(6.3)56 b(In)n(tensional)18 b(Analysis)g(Con\015icts)h(with)g
Fm(\014)h FD(on)f(Ra)n(w)g(MetaML)g(T)-5 b(erms)150 2595
y FI(Our)20 b(\014rst)g(observ)n(ation)f(is)g(that)g(there)h(is)f(a)g
(con\015ict)h(b)q(et)o(w)o(een)g(the)g FF(\014)i FI(rule)e(and)f(supp)q
(orting)g(in)o(tensional)150 2670 y(analysis.)12 b(Supp)q(ort)i(for)e
(in)o(tensional)h(analysis)f(means)g(adding)h(constructs)i(to)e(MetaML)
g(that)g(w)o(ould)g(allo)o(w)e(a)p eop
%%Page: 102 113
102 112 bop 1862 0 a FB(102)150 192 y FI(program)10 b(to)i(insp)q(ect)i
(a)d(piece)i(of)f(co)q(de,)g(and)g(p)q(ossibly)g(c)o(hange)g(its)g
(execution)h(based)f(on)g(either)h(the)g(structure)150
266 y(or)j(con)o(ten)o(t)h(of)e(that)h(piece)h(of)f(co)q(de.)g(This)g
(con\015ict)h(is)e(an)h(example)f(of)h(a)f(high-lev)o(el)g(insigh)o(t)h
(that)g(resulted)150 341 y(from)c(studying)h(the)h(formal)d(seman)o
(tics)i(of)g(MetaML.)h(In)f(particular,)g(MetaML)h(w)o(as)f(dev)o(elop)
q(ed)h(as)g(a)f FH(meta-)150 416 y(pr)n(o)n(gr)n(amming)k(language)p
FI(,)f(and)h(while)e(m)o(ulti-stage)g(programmi)o(ng)e(do)q(es)18
b(not)e(need)h(to)f(concern)i(itself)e(with)150 490 y(ho)o(w)h(the)g
(co)q(de)h(t)o(yp)q(e)f(is)g(represen)o(ted,)i(the)f(long-term)d(goals)
h(of)h(the)g(MetaML)h(pro)r(ject)g(ha)o(v)o(e)e(at)h(one)g(time)150
565 y(included)e(supp)q(ort)h(for)f(in)o(tensional)f(analysis.)g(The)i
(idea)e(is)h(that)h(in)o(tensional)e(analysis)g(could)h(b)q(e)h(used,)f
(for)150 640 y(example,)d(to)i(allo)o(w)e(programers)h(to)h(write)g
(their)h(o)o(wn)e(optimizers)g(for)h(co)q(de.)150 723
y(It)20 b(turns)g(out)g(that)g(suc)o(h)g(in)o(tensional)f(analysis)g
(is)h(in)f(direct)i(con)o(ten)o(tion)e(with)h(allo)o(wing)d(the)k
FF(\014)r FI(-rule)f(on)150 798 y(ob)r(ject-co)q(de)c(\(that)e(is,)f
(at)h(lev)o(els)g(higher)h(than)f(0\).)f(T)m(o)g(illustrate)h(the)h(in)
o(teraction)f(b)q(et)o(w)o(een)h(the)g FF(\014)i FI(rule)d(and)150
872 y(in)o(tensional)f(analysis,)g(assume)g(that)i(w)o(e)f(ha)o(v)o(e)g
(a)f(minima)o(l)e(extension)k(to)f(core)g(MetaML)h(that)f(tests)h(a)f
(piece)150 947 y(of)h(co)q(de)h(to)g(see)h(if)d(it)h(is)h(an)f
(application.)f(This)h(extension)i(can)e(b)q(e)i(ac)o(hiev)o(ed)f
(using)f(a)g(simple)f(h)o(yp)q(othetical)150 1022 y(construct)i(with)d
(the)i(follo)o(wing)c(seman)o(tics:)221 1128 y FE(-)p
Fy(j)i FE(IsApp)h Fy(h)p FE(\(fn)g(x)g Fy(\))f FE(x\))h(\(fn)g(y)g
Fy(\))g FE(y\))p Fy(i)p FE(;)221 1193 y(val)f(it)h(=)g(true)h(:)f(b)q
(o)q(ol.)150 1295 y FI(Allo)o(wing)j FF(\014)k FI(on)d(ob)r(ject-co)q
(de)i(then)g(means)d(that)i Fy(h)p FE(\(fn)g(x)g Fy(\))f
FE(x\))h(\(fn)f(y)h Fy(\))f FE(y\))p Fy(i)h FI(can)g(b)q(e)g(replaced)h
(b)o(y)e Fy(h)p FE(fn)h(y)150 1370 y Fy(\))c FE(y)p Fy(i)q
FI(.)g(Suc)o(h)i(a)e(reduction)i(could)f(b)q(e)h(p)q(erformed)e(b)o(y)h
(an)g(optimizing)d(compiler,)h(and)i(could)g(b)q(e)h(justi\014able,)150
1444 y(b)q(ecause)c(it)e(eliminates)e(a)i(function)g(call)f(in)h(the)h
(ob)r(ject-program.)d(But)j(suc)o(h)g(an)f(\\optimization")d(w)o(ould)i
(ha)o(v)o(e)150 1519 y(a)15 b(dev)n(astating)f(e\013ect)j(on)e(the)g
(seman)o(tics)g(of)f(MetaML.)h(In)g(particular,)f(it)h(w)o(ould)f(also)
h(allo)o(w)e(our)i(language)150 1594 y(to)f(b)q(eha)o(v)o(e)g(as)g
(follo)o(ws:)221 1700 y FE(-)p Fy(j)f FE(IsApp)h Fy(h)p
FE(\(fn)g(x)g Fy(\))f FE(x\))h(\(fn)g(y)g Fy(\))g FE(y\))p
Fy(i)p FE(;)221 1765 y(val)f(it)h(=)g(false)g(:)f(b)q(o)q(ol.)150
1867 y FI(When)i(the)h(reduction)g(is)f(p)q(erformed,)f(the)i(argumen)o
(t)e(to)h FE(IsApp)g FI(is)g(no)g(longer)g(an)f(application,)g(but)h
(simply)150 1942 y(the)d(lam)o(b)q(da)d(term)i Fy(h)p
FE(fn)h(y)f Fy(\))g FE(y)p Fy(i)p FI(.)g(In)h(other)g(w)o(ords,)f(allo)
o(wing)e(b)q(oth)i(in)o(tensional)g(analysis)g(and)g(ob)r(ject-program)
150 2016 y(optimization)f(implies)g(that)j(w)o(e)g(can)g(get)g(the)g
(result)g FE(false)g FI(just)g(as)f(w)o(ell)g(as)h(w)o(e)g(can)f(get)h
(the)h(result)f FE(true)p FI(.)g(This)150 2091 y(example)d(illustrates)
h(a)f(problem)g(of)g(coherence)j(of)d(MetaML's)i(seman)o(tics)e(with)h
(the)g(presence)i(of)e FF(\014)i FI(reduction)150 2166
y(at)h(higher)g(lev)o(els,)f(and)h(co)q(de)h(insp)q(ection.)f(While)f
(this)h(issue)h(is)f(what)g(\014rst)g(drew)h(our)f(atten)o(tion)g(to)g
(the)g(care)150 2241 y(needed)h(in)f(sp)q(ecifying)g(what)g(equalities)
f(should)h(hold)g(in)f(MetaML,)h(there)h(are)g(more)e(subtle)h
(concerns)i(that)150 2315 y(are)e(of)g(direct)g(relev)n(ance)h(to)f(m)o
(ulti-stage)e(programmi)o(ng,)e(ev)o(en)15 b(in)e(the)i(absence)g(of)f
(in)o(tensional)f(analysis.)150 2468 y FD(6.4)56 b(Lev)n(el-Annotated)
17 b(MetaML)h(T)-5 b(erms)17 b(and)i(Expression)f(F)-5
b(amilies)150 2595 y FI(In)16 b(order)h(to)g(con)o(trol)f(the)h
(applicabilit)o(y)d(of)h(the)i FF(\014)i FI(at)d(v)n(arious)g(lev)o
(els,)g(w)o(e)g(dev)o(elop)q(ed)h(the)g(notion)f(of)g
FH(level-)150 2670 y(annotate)n(d)e(terms)p FI(.)e(Lev)o(el-annotated)g
(terms)g(carry)h(around)f(a)g(natural)g(n)o(um)o(b)q(er)g(at)g(the)h
(lea)o(v)o(es)f(to)g(re\015ect)i(the)p eop
%%Page: 103 114
103 113 bop 1862 0 a FB(103)150 192 y FI(lev)o(el)14
b(of)g(the)h(term.)f(Suc)o(h)h(terms)f(k)o(eep)h(trac)o(k)g(of)f
(meta-lev)o(el)f(information)e(\(the)k(lev)o(el)g(of)f(a)g(subterm\))g
(in)g(the)150 266 y(terms)g(themselv)o(es,)f(so)h(as)g(to)g(giv)o(e)f
(us)h(\014ner)h(con)o(trol)f(o)o(v)o(er)g(where)h(di\013eren)o(t)g
(reductions)g(are)f(applicable.)150 349 y(Lev)o(el-annotated)h(terms)f
(induce)i(an)e(in\014nite)h(family)d(of)i(sets)i FF(E)1196
334 y FA(0)1214 349 y FF(;)7 b(E)1266 334 y FA(1)1285
349 y FF(;)g(E)1337 334 y FA(2)1355 349 y FF(;)g(:::)12
b FI(where)k(eac)o(h)g(annotated)f(term)150 424 y(liv)o(es.)e(The)h
FH(family)j FI(of)d(lev)o(el-annotated)f(expressions)j(and)d(v)n(alues)
h(is)g(de\014ned)h(as)f(follo)o(ws:)201 530 y FF(e)220
515 y FA(0)308 530 y Fy(2)d FF(E)380 515 y FA(0)466 530
y FI(:=)g FF(i)535 515 y FA(0)566 530 y Fy(j)g FF(x)613
515 y FA(0)642 530 y Fy(j)h FF(\025x:e)745 515 y FA(0)774
530 y Fy(j)g FF(e)817 515 y FA(0)835 530 y FF(e)854 515
y FA(0)885 530 y Fy(j)f(h)p FF(e)943 515 y FA(1)962 530
y Fy(i)h(j)f FE(run)h FF(e)1100 515 y FA(0)201 605 y
FF(e)220 590 y Ft(n)p FA(+)308 605 y Fy(2)f FF(E)380
590 y Ft(n)p FA(+)466 605 y FI(:=)g FF(i)535 590 y Ft(n)p
FA(+)595 605 y Fy(j)g FF(x)642 590 y Ft(n)p FA(+)701
605 y Fy(j)g FF(\025x:e)803 590 y Ft(n)p FA(+)863 605
y Fy(j)g FF(e)905 590 y Ft(n)p FA(+)953 605 y FF(e)972
590 y Ft(n)p FA(+)1032 605 y Fy(j)g(h)p FF(e)1090 590
y Ft(n)p FA(++)1164 605 y Fy(i)h(j)g FE(~)q FF(e)1257
590 y Ft(n)1292 605 y Fy(j)f FE(run)h FF(e)1402 590 y
Ft(n)p FA(+)201 679 y FF(v)222 664 y FA(0)308 679 y Fy(2)f
FF(V)380 664 y FA(0)466 679 y FI(:=)g FF(i)535 664 y
FA(0)566 679 y Fy(j)g FF(\025x:e)668 664 y FA(0)698 679
y Fy(j)g(h)p FF(v)758 664 y FA(1)777 679 y Fy(i)201 754
y FF(v)222 739 y FA(1)308 754 y Fy(2)g FF(V)380 739 y
FA(1)466 754 y FI(:=)g FF(i)535 739 y FA(1)566 754 y
Fy(j)g FF(x)613 739 y FA(1)642 754 y Fy(j)h FF(\025x:v)747
739 y FA(1)777 754 y Fy(j)f FF(v)821 739 y FA(1)840 754
y FF(v)861 739 y FA(1)892 754 y Fy(j)g(h)p FF(v)952 739
y FA(2)971 754 y Fy(i)h(j)f FE(run)i FF(v)1112 739 y
FA(1)201 829 y FF(v)222 814 y Ft(n)p FA(++)308 829 y
Fy(2)e FF(V)380 814 y Ft(n)p FA(++)466 829 y FI(:=)g
FF(i)535 814 y Ft(n)p FA(++)620 829 y Fy(j)h FF(x)668
814 y Ft(n)p FA(++)752 829 y Fy(j)f FF(\025x:v)856 814
y Ft(n)p FA(++)942 829 y Fy(j)g FF(v)986 814 y Ft(n)p
FA(++)1060 829 y FF(v)1081 814 y Ft(n)p FA(++)1167 829
y Fy(j)g FF(\025x:v)1271 814 y Ft(n)p FA(++)1356 829
y Fy(j)g(h)p FF(v)1416 814 y Ft(n)p FA(+++)1516 829 y
Fy(i)g(j)h FE(~)q FF(v)1610 814 y Ft(n)p FA(+)1671 829
y Fy(j)f FE(run)h FF(v)1783 814 y Ft(n)p FA(++)1857 829
y FF(:)150 926 y FI(The)17 b(k)o(ey)g(di\013erence)h(b)q(et)o(w)o(een)g
(lev)o(el-annotated)e(terms)h(and)f(ra)o(w)h(terms)f(is)g(in)g(the)i
(\\lea)o(v)o(es",)d(namely)m(,)f(the)150 1001 y(v)n(ariables)h(and)h
(in)o(tegers.)h(In)f(lev)o(el-annotated)g(terms,)f(v)n(ariables)h(and)f
(in)o(tegers)i(explicitly)f(carry)g(around)g(a)150 1075
y(natural)e(n)o(um)o(b)q(er)g(that)h(represen)o(ts)j(their)d(lev)o(el.)
f(F)m(or)g(all)g(other)h(constructs,)h(w)o(e)f(can)g(simply)e(infer)i
(the)g(lev)o(el)150 1150 y(of)e(the)i(whole)e(term)h(b)o(y)f(lo)q
(oking)g(at)g(the)i(subterm.)e(F)m(or)h(Brac)o(k)o(ets)h(and)f(Escap)q
(es,)h(the)f(ob)o(vious)f(\\correction")150 1225 y(to)h(lev)o(els)g(is)
f(p)q(erformed.)150 1308 y(Note)19 b(that)g(whenev)o(er)g(w)o(e)g(\\go)
f(inside")g(a)g(Brac)o(k)o(et)i(or)e(an)h(Escap)q(e,)g(the)g(index)g
(of)f(the)h(expression)h(set)f(is)150 1382 y(c)o(hanged)12
b(in)f(accordance)i(with)e(the)i(w)o(a)o(y)d(the)j(lev)o(el)e(c)o
(hanges)h(when)g(w)o(e)g(\\go)f(inside")g(a)g(Brac)o(k)o(et)i(or)f(an)f
(Escap)q(e.)150 1541 y FD(6.5)56 b(Escap)r(es)18 b(Con\015ict)g(with)h
Fm(\014)h FD(on)f(Annotated)g(MetaML)f(terms)150 1674
y FI(There)c(is)e(a)h(problematic)e(in)o(teraction)h(b)q(et)o(w)o(een)i
(the)g FF(\014)h FI(rule)e(at)f(higher)h(lev)o(els)g(and)f(Escap)q(e.)i
(In)e(particular,)g FF(\014)150 1749 y FI(do)q(es)j(not)e(preserv)o(e)j
(the)f(syn)o(tactic)f(categories)h(of)e(lev)o(el)h(annotated)g(terms.)f
(Consider)h(the)h(follo)o(wing)c(term:)221 1855 y Fy(h)p
FE(\(fn)j(x)g Fy(\))g FE(~)q(x)431 1840 y FA(0)450 1855
y FE(\))h(~)q Fy(h)p FE(4)540 1840 y FA(0)559 1855 y
Fy(ii)p FE(.)150 1956 y FI(The)g(lev)o(el)f(of)f(the)i(whole)f(term)g
(is)g(0.)g(If)g(w)o(e)g(allo)o(w)f(the)i FF(\014)i FI(rule)d(at)g
(higher)h(lev)o(els,)f(this)g(term)g(can)g(b)q(e)h(reduced)150
2031 y(to:)221 2145 y Fy(h)q FE(~)r(~)q Fy(h)p FI(4)320
2130 y FA(0)338 2145 y Fy(ii)q FE(.)150 2255 y FI(This)i(result)h(con)o
(tains)f(t)o(w)o(o)g(nested)h(Escap)q(es.)h(Th)o(us,)e(the)g(lev)o(el)g
(of)g(the)g(whole)g(term)g(can)g(no)g(longer)g(b)q(e)h(0.)150
2330 y(The)g(outer)h(Escap)q(e)g(corresp)q(onds)h(to)d(the)i(Brac)o(k)o
(et,)f(but)g(what)f(ab)q(out)h(the)g(inner)h(Escap)q(e?)f(Originally)m
(,)d(it)150 2404 y(corresp)q(onded)j(to)e(the)h(same)e(Brac)o(k)o(et,)i
(but)f(after)g(the)h FF(\014)i FI(reduction,)d(what)g(w)o(e)g(get)h(is)
f(an)g(expression)h(that)150 2479 y(cannot)d(b)q(e)h(read)f(in)f(the)i
(same)e(manner)g(as)h(the)g(original)e(term.)p eop
%%Page: 104 115
104 114 bop 1862 0 a FB(104)150 192 y FD(6.6)56 b(Substitution)18
b(Con\015icts)g(with)h Fm(\014)h FD(on)f(Lev)n(el)e(0)i(Annotated)g(T)
-5 b(erms)150 324 y FI(One)15 b(p)q(ossibilit)o(y)d(for)i(a)o(v)o
(oiding)e(the)i(problem)f(ab)q(o)o(v)o(e)g(is)h(to)g(limit)d
FF(\014)17 b FI(to)c(lev)o(el)h(0)f(terms:)792 446 y(\()p
FF(\025x:e)887 430 y FA(0)887 455 y(1)906 446 y FI(\))7
b FF(e)948 430 y FA(0)948 455 y(2)979 446 y Fy(\000)-7
b(!)1046 452 y Fr(\014)1077 446 y FF(e)1096 430 y FA(0)1096
455 y(1)1115 446 y FI([)p FF(x)10 b FI(:=)i FF(e)1236
430 y FA(0)1236 455 y(2)1255 446 y FI(])p FF(:)150 557
y FI(A)o(t)19 b(\014rst,)h(this)g(approac)o(h)f(seems)h(app)q(ealing)e
(b)q(ecause)j(it)e(mak)o(es)f(the)i(extension)h(of)d(MetaML)i(with)f
(co)q(de)150 632 y(insp)q(ection)14 b(op)q(erations)h(less)f
(problematic.)e(But)j(consider)f(the)h(follo)o(wing)c(term:)221
746 y FE(\(fn)j(x)g Fy(\))f(h)p FE(x)408 731 y FA(1)427
746 y Fy(i)p FE(\))h(\(fn)g(y)g Fy(\))f FE(\(fn)i(x)f
Fy(\))f FE(x)797 731 y FA(0)816 746 y FE(\))h(5)867 731
y FA(0)885 746 y FE(\).)150 856 y FI(There)h(are)e(t)o(w)o(o)g(p)q
(ossible)h FF(\014)i FI(reductions)f(at)e(lev)o(el)g(0)g(in)g(this)h
(term.)e(The)i(\014rst)g(is)g(the)g(outermost)f(application,)150
930 y(and)j(the)h(second)g(is)f(the)h(application)d(inside)i(the)h
(argumen)o(t.)e(If)g(w)o(e)i(do)f(the)g(\014rst)h(application,)e(w)o(e)
h(get)g(the)150 1005 y(follo)o(wing)11 b(result:)221
1111 y Fy(h)p FE(fn)j(y)g Fy(\))f FE(\(fn)h(x)g Fy(\))f
FE(x)544 1096 y FA(1)563 1111 y FE(\))h(5)614 1096 y
FA(1)633 1111 y Fy(i)p FE(.)150 1213 y FI(The)j(lev)o(el)f(annotations)
f(need)i(to)f(b)q(e)h(adjusted)g(after)f(substitution.)g(\(See)i
(Section)e(A.1.1.\))f(But)i(\014rst)g(note)150 1287 y(that)c(there)i
(are)f(no)f FF(\014)j FI(reductions)e(at)f(lev)o(el)g(0)h(left)f(in)f
(this)i(term.)e(If)h(w)o(e)h(do)f(the)h(second)g(application)e
(\014rst,)i(w)o(e)150 1362 y(get)221 1468 y FE(\(fn)g(x)g
Fy(\))f(h)p FE(x)408 1453 y FA(1)427 1468 y Fy(i)p FE(\))h(\(fn)g(y)g
Fy(\))f FE(5)646 1453 y FA(0)665 1468 y FE(\).)150 1570
y FI(and)h(then)g(w)o(e)g(can)g(still)f(go)h(bac)o(k)g(and)f(p)q
(erform)g(the)i(outermost)e(application)g(to)g(get:)221
1676 y Fy(h)p FE(fn)h(y)g Fy(\))f FE(5)394 1661 y FA(1)412
1676 y Fy(i)q FE(.)150 1777 y FI(Again,)j(in)g(the)i(presence)h(of)e
(co)q(de)h(insp)q(ection,)f(this)g(example)e(illustrates)j(an)e
(incoherence)j(problem.)c(But)150 1852 y(ev)o(en)c(in)f(the)h(absence)h
(of)e(co)q(de)h(insp)q(ection,)g(w)o(e)g(still)e(lose)i(the)g
FH(c)n(on\015uenc)n(e)h FI(of)e(our)g(reductions,)h(despite)h(the)f
(fact)150 1926 y(that)h(w)o(e)g(ha)o(v)o(e)f(sacri\014ced)j
FF(\014)g FI(reductions)f(at)f(higher-lev)o(els.)f(In)o(tuitiv)o(ely)m
(,)f(the)i(example)e(ab)q(o)o(v)o(e)i(illustrates)g(that)150
2001 y(cross-stage)h(p)q(ersistence)h(arises)e(naturally)e(in)h(un)o(t)
o(yp)q(ed)h(MetaML)g(terms,)f(and)g(that)g(cross-stage)i(p)q
(ersistence)150 2076 y(mak)o(es)g(it)i(hard)f(to)h(limit)d
FF(\014)17 b FI(to)d(lev)o(el)h(0)f(in)g(a)g(consisten)o(t)i(\(that)f
(is,)f(con\015uen)o(t\))i(w)o(a)o(y)m(.)d(In)h(the)h(example)f(ab)q(o)o
(v)o(e,)150 2151 y(applying)9 b(the)i(lift-lik)o(e)e(term)h
FE(fn)h(x)f Fy(\))h(h)p FE(x)p Fy(i)g FI(to)f(a)g(function)h(causes)h
(all)d(the)i(redices)h(in)f(the)g(b)q(o)q(dy)g(of)f(that)g(function)150
2225 y(to)k(b)q(e)g(frozen.)p eop
%%Page: 105 116
105 115 bop 1862 0 a FB(105)150 192 y FD(6.7)56 b(A)19
b(Reduction)e(Seman)n(tics)h(for)g(CBN)h Fm(\025)p FD(-U)949
280 y FC(No)13 b(Nightingale)d(did)j(ever)g(chaunt)949
339 y(Mor)n(e)h(welc)n(ome)f(notes)f(to)h(we)n(ary)g(b)n(ands)949
398 y(Of)h(tr)n(avel)r(lers)e(in)h(some)g(shady)f(haunt,)949
458 y(A)o(mong)h(A)o(r)n(abian)e(sands:)949 517 y(A)j(voic)n(e)e(so)h
(thril)r(ling)e(ne'er)i(was)g(he)n(ar)n(d)949 577 y(In)g(spring-time)f
(fr)n(om)i(the)e(Cucko)n(o-bir)n(d,)949 636 y(Br)n(e)n(aking)g(the)h
(silenc)n(e)e(of)j(the)e(se)n(as)949 695 y(A)o(mong)h(the)g(farthest)e
(Hebrides.)1141 788 y(The)i(Solitary)f(R)n(e)n(ap)n(er)p
FB(,)f(Willia)q(m)k(W)m(ordsw)o(orth)150 878 y FI(The)f(syn)o(tax)g(of)
f FF(\025)p FI(-U)h(consists)h(of)f(the)g(set)h(of)e
FH(r)n(aw)18 b FI(expressions)d(and)f(v)n(alues)f(de\014ned)i(as)f
(follo)o(ws:)379 984 y FF(e)398 969 y FA(0)458 984 y
Fy(2)d FF(E)530 969 y FA(0)590 984 y FI(:=)g FF(v)20
b Fy(j)e FF(x)g Fy(j)g FF(e)806 969 y FA(0)832 984 y
FF(e)851 969 y FA(0)889 984 y Fy(j)g(h)p FF(e)954 969
y FA(1)973 984 y Fy(i)g(j)g FE(run)13 b FF(e)1125 969
y FA(0)379 1059 y FF(e)398 1044 y Ft(n)p FA(+)458 1059
y Fy(2)e FF(E)530 1044 y Ft(n)p FA(+)590 1059 y FI(:=)g
Fy(h)p FF(e)680 1044 y Ft(n)703 1059 y Fy(i)19 b(j)f
FF(i)h Fy(j)f FF(x)g Fy(j)g FF(e)922 1044 y Ft(n)p FA(+)977
1059 y FF(e)996 1044 y Ft(n)p FA(+)1063 1059 y Fy(j)g
FF(\025x:e)1172 1044 y Ft(n)p FA(+)1238 1059 y Fy(j)g(h)p
FF(e)1303 1044 y Ft(n)p FA(++)1377 1059 y Fy(i)h(j)g
FE(~)q FF(e)1484 1044 y Ft(n)1525 1059 y Fy(j)f FE(run)13
b FF(e)1643 1044 y Ft(n)p FA(+)379 1133 y FF(v)59 b Fy(2)11
b FF(V)69 b FI(:=)11 b FF(i)19 b Fy(j)f FF(\025x:e)787
1118 y FA(0)824 1133 y Fy(j)g(h)p FF(e)889 1118 y FA(0)908
1133 y Fy(i)p FF(:)150 1230 y FI(The)f(essen)o(tial)g(subtlet)o(y)h(in)
e(this)h(de\014nition)f(is)h(in)f(the)h(last)g(pro)q(duction)g(in)f
(the)h(set)h(of)e(v)n(alues:)g(Inside)h(the)150 1305
y(Brac)o(k)o(ets)e(of)f(a)f(co)q(de)i(v)n(alue,)e(what)g(is)h(needed)i
(is)d(simply)f FH(an)j(expr)n(ession)h(of)e(level)h(0)p
FI(.)150 1388 y(The)f(CBN)h(notions)e(of)g(reduction)i(of)e
FF(\025)p FI(-U)h(are)h(simply:)784 1494 y(\()p FF(\025x:e)879
1479 y FA(0)879 1504 y(1)898 1494 y FI(\))7 b FF(e)940
1479 y FA(0)940 1504 y(2)973 1494 y Fy(\000)-7 b(!)1040
1500 y Fr(\014)1056 1507 y(U)1096 1494 y FF(e)1115 1479
y FA(0)1115 1504 y(1)1134 1494 y FI([)p FF(x)11 b FI(:=)g
FF(e)1255 1479 y FA(0)1255 1504 y(2)1274 1494 y FI(])867
1569 y FE(~)q Fy(h)p FF(e)924 1554 y FA(0)943 1569 y
Fy(i)h(\000)-7 b(!)1038 1575 y Fr(E)1059 1582 y(U)1096
1569 y FF(e)1115 1554 y FA(0)820 1643 y FE(run)13 b Fy(h)p
FF(e)924 1628 y FA(0)943 1643 y Fy(i)e(\000)-6 b(!)1038
1649 y Fr(R)1059 1656 y(U)1096 1643 y FF(e)1115 1628
y FA(0)1134 1643 y FF(:)150 1740 y FI(Just)13 b(lik)o(e)f(the)h(rules)g
(for)f FF(\025)p FI(,)g(these)i(rules)f(are)g(in)o(tended)g(to)g(b)q(e)
g(applied)f(in)g(an)o(y)g(con)o(text.)g(This)h(calculus)f(allo)o(ws)150
1815 y(us)17 b(to)g(apply)f(the)h FF(\014)i FI(rule)e(to)g(an)o(y)f
(expression)i(that)e FH(lo)n(oks)i(like)e FI(a)g(lev)o(el)h(0)f
(application.)f(By)i(restricting)g(the)150 1890 y(b)q(o)q(dy)i(of)f
(the)i(lam)o(b)q(da)d(term)h(and)h(its)g(argumen)o(t)e(to)i(b)q(e)h(in)
e FF(E)1189 1875 y FA(0)1208 1890 y FI(,)g(the)i FF(\025)p
FI(-U)f(language)f(a)o(v)o(oids)g(the)i(con\015ict)150
1965 y(b)q(et)o(w)o(een)15 b(Escap)q(es)g(and)e FF(\014)k
FI(that)c(w)o(e)h(discussed)h(earlier)f(on)f(in)g(this)g(c)o(hapter,)h
(b)q(ecause)i(lev)o(el)d(0)g(terms)g(are)h(free)150 2039
y(of)f(top-lev)o(el)h(Escap)q(es.)150 2187 y FG(6.7.1)48
b(Sub)s(ject)13 b(Reduction)150 2303 y FI(Figure)18 b(6.1)f(summarizes)
f(the)i(language)f(CBN)i FF(\025)p FI(-U)f(that)g(w)o(e)g(presen)o(t)h
(and)f(study)g(in)g(this)f(section.)i(Note)150 2378 y(that)g(CBN)h
FF(\025)p FI(-U)g(also)f(enjo)o(ys)g(the)h(cleanliness)g(of)f(b)q(eing)
g(de\014ned)h(in)f(terms)g(of)g(the)h(standard)g(notion)f(of)150
2453 y(substitution.)150 2536 y(It)13 b(is)g(fairly)f(straigh)o(tforw)o
(ard)g(to)h(establish)g(that)g FF(\025)p FI(-U)h(preserv)o(es)h(t)o
(ypabilit)o(y)m(,)10 b(where)k(the)g(notion)e(of)h(t)o(yping)f(is)150
2610 y(that)i(of)f(the)i(t)o(yp)q(e)f(system)g(presen)o(ted)i(in)d
(Section)h(5.3:)p eop
%%Page: 106 117
106 116 bop 1862 0 a FB(106)150 178 y FI(Syn)o(tax:)379
267 y FF(e)398 252 y FA(0)458 267 y Fy(2)11 b FF(E)530
252 y FA(0)590 267 y FI(:=)g FF(v)20 b Fy(j)e FF(x)g
Fy(j)g FF(e)806 252 y FA(0)832 267 y FF(e)851 252 y FA(0)889
267 y Fy(j)g(h)p FF(e)954 252 y FA(1)973 267 y Fy(i)g(j)g
FE(run)13 b FF(e)1125 252 y FA(0)379 317 y FF(e)398 302
y Ft(n)p FA(+)458 317 y Fy(2)e FF(E)530 302 y Ft(n)p
FA(+)590 317 y FI(:=)g Fy(h)p FF(e)680 302 y Ft(n)703
317 y Fy(i)19 b(j)f FF(i)h Fy(j)f FF(x)g Fy(j)g FF(e)922
302 y Ft(n)p FA(+)977 317 y FF(e)996 302 y Ft(n)p FA(+)1063
317 y Fy(j)g FF(\025x:e)1172 302 y Ft(n)p FA(+)1238 317
y Fy(j)g(h)p FF(e)1303 302 y Ft(n)p FA(++)1377 317 y
Fy(i)h(j)g FE(~)q FF(e)1484 302 y Ft(n)1525 317 y Fy(j)f
FE(run)13 b FF(e)1643 302 y Ft(n)p FA(+)379 367 y FF(v)59
b Fy(2)11 b FF(V)69 b FI(:=)11 b FF(i)19 b Fy(j)f FF(\025x:e)787
352 y FA(0)824 367 y Fy(j)g(h)p FF(e)889 352 y FA(0)908
367 y Fy(i)150 456 y FI(Reductions:)784 537 y(\()p FF(\025x:e)879
521 y FA(0)879 547 y(1)898 537 y FI(\))7 b FF(e)940 521
y FA(0)940 547 y(2)973 537 y Fy(\000)-7 b(!)1040 543
y Fr(\014)1056 550 y(U)1096 537 y FF(e)1115 521 y FA(0)1115
547 y(1)1134 537 y FI([)p FF(x)11 b FI(:=)g FF(e)1255
521 y FA(0)1255 547 y(2)1274 537 y FI(])867 586 y FE(~)q
Fy(h)p FF(e)924 571 y FA(0)943 586 y Fy(i)h(\000)-7 b(!)1038
592 y Fr(E)1059 599 y(U)1096 586 y FF(e)1115 571 y FA(0)820
636 y FE(run)13 b Fy(h)p FF(e)924 621 y FA(0)943 636
y Fy(i)e(\000)-6 b(!)1038 642 y Fr(R)1059 649 y(U)1096
636 y FF(e)1115 621 y FA(0)724 788 y FG(Fig.)7 b(6.1.)14
b FI(The)g(CBN)h FF(\025)p FI(-U)f(Language)150 932 y
FG(Theorem)h(6.7.1)h(\(Sub)s(ject)d(Reduction)g(for)i(CBN)h
FF(\025)p FG(-U\))21 b Fy(8)p FF(n)11 b Fy(2)g Fo(N)p
FF(;)c(\000)15 b Fy(2)c FF(D)q(;)c(\034)16 b Fy(2)11
b FF(T)s(:)c Fy(8)p FF(e)1646 938 y FA(1)1666 932 y FF(;)g(e)1704
938 y FA(2)1734 932 y Fy(2)k FF(E)1806 917 y Ft(n)1828
932 y FF(:)681 1038 y(\000)17 b Fy(`)749 1021 y Ft(n)783
1038 y FF(e)802 1044 y FA(1)832 1038 y FI(:)12 b FF(\034)i
Fy(^)9 b FF(e)944 1044 y FA(1)974 1038 y Fy(\000)-7 b(!)13
b FF(e)1073 1044 y FA(2)1104 1038 y FI(=)-7 b Fy(\))11
b FF(\000)17 b Fy(`)1250 1021 y Ft(n)1285 1038 y FF(e)1304
1044 y FA(2)1334 1038 y FI(:)11 b FF(\034)r(:)150 1149
y FH(Pr)n(o)n(of.)20 b FI(The)11 b(pro)q(of)g(builds)f(on)h(the)g
(basic)g(prop)q(erties)h(of)e(the)i(t)o(yp)q(e)f(system)f(that)h(w)o(e)
g(ha)o(v)o(e)g(already)f(established)150 1214 y(in)j(Chapter)i(5.)e
(There)i(are)f(only)g(three)h(cases)g(that)f(need)h(to)f(b)q(e)g
(considered:)176 1320 y FG({)21 b FF(e)240 1326 y FA(3)259
1320 y FF(;)7 b(e)297 1326 y FA(4)329 1320 y Fy(2)14
b FF(E)404 1305 y FA(0)438 1320 y FI(and)i FF(e)540 1326
y FA(1)573 1320 y FI(=)e(\()p FF(\025x:e)714 1326 y FA(3)733
1320 y FI(\))g FF(e)782 1326 y FA(4)816 1320 y Fy(\000)-7
b(!)16 b FF(e)918 1326 y FA(3)937 1320 y FI([)p FF(x)d
FI(:=)h FF(e)1063 1326 y FA(4)1082 1320 y FI(])g(=)h
FF(e)1174 1326 y FA(2)1193 1320 y FI(.)g(Then)h(b)o(y)f
Fy(2)f FF(E)1464 1305 y FA(0)1498 1320 y FI(w)o(e)i(kno)o(w)f(that)h
FF(e)1782 1326 y FA(1)1815 1320 y Fy(2)e FF(E)1890 1305
y FA(0)1908 1320 y FI(.)221 1385 y(W)m(e)h(are)h(giv)o(en)f
FF(\000)k Fy(`)545 1370 y Ft(n)583 1385 y FI(\()p FF(\025x:e)678
1391 y FA(3)696 1385 y FI(\))12 b FF(e)743 1391 y FA(4)776
1385 y FI(:)i FF(\034)5 b FI(.)15 b(Then,)g(b)o(y)h(t)o(yping,)e(w)o(e)
i(kno)o(w)f FF(\000)k Fy(`)1418 1370 y Ft(n)1456 1385
y FF(e)1475 1391 y FA(4)1508 1385 y FI(:)14 b FF(\033)i
FI(and)g FF(\000)j Fy(`)1727 1370 y Ft(n)1764 1385 y
FI(\()p FF(\025x:e)1859 1391 y FA(3)1878 1385 y FI(\))14
b(:)221 1449 y FF(\033)e Fy(!)f FF(\034)5 b FI(.)18 b(Again,)e(b)o(y)i
(t)o(yping,)f(w)o(e)h(also)f(kno)o(w)g FF(\000)6 b FI(;)h
FF(x)17 b FI(:)h FF(\033)1117 1434 y Ft(n)1158 1449 y
Fy(`)1183 1434 y Ft(n)1224 1449 y FF(e)1243 1455 y FA(3)1280
1449 y FI(:)g FF(\034)5 b FI(.)17 b(By)h(substitution)g(w)o(e)g(kno)o
(w)g(that)221 1514 y FF(\000)e Fy(`)288 1499 y Ft(n)323
1514 y FF(e)342 1520 y FA(3)361 1514 y FI([)p FF(x)11
b FI(:=)g FF(e)482 1520 y FA(4)501 1514 y FI(])g(:)g
FF(\034)19 b FI(and)13 b(w)o(e)i(are)f(done.)176 1579
y FG({)21 b FF(e)240 1585 y FA(3)275 1579 y Fy(2)c FF(E)353
1564 y FA(0)388 1579 y FI(and)g FF(e)491 1585 y FA(1)527
1579 y Fy(\021)g FE(run)h Fy(h)p FF(e)685 1585 y FA(3)704
1579 y Fy(i)f(\000)-7 b(!)19 b FF(e)842 1585 y FA(3)877
1579 y Fy(\021)f FF(e)946 1585 y FA(2)964 1579 y FI(.)f(W)m(e)g(are)g
(giv)o(en)g FF(\000)22 b Fy(`)1325 1564 y Ft(n)1364 1579
y FE(run)13 b Fy(h)p FF(e)1468 1585 y FA(3)1487 1579
y Fy(i)k FI(:)f FF(\034)5 b FI(.)17 b(By)g(t)o(yping)f(w)o(e)i(get)221
1644 y FF(\000)253 1629 y FA(+)292 1644 y Fy(`)317 1629
y Ft(n)352 1644 y Fy(h)p FF(e)387 1650 y FA(3)406 1644
y Fy(i)12 b FI(:)g Fy(h)p FF(\034)5 b Fy(i)p FI(,)13
b(and)i(then)f FF(\000)746 1629 y FA(+)785 1644 y Fy(`)810
1629 y Ft(n)p FA(+)871 1644 y FF(e)890 1650 y FA(3)921
1644 y FI(:)e FF(\034)5 b FI(.)13 b(By)i(p)q(ersistence)i(of)c(t)o
(ypabilit)o(y)g(w)o(e)h(get)h FF(\000)i Fy(`)1707 1629
y Ft(n)1742 1644 y FF(e)1761 1650 y FA(3)1792 1644 y
FI(:)12 b FF(\034)19 b FI(and)221 1708 y(w)o(e)14 b(are)g(done.)176
1773 y FG({)21 b FF(e)240 1779 y FA(3)276 1773 y Fy(2)d
FF(E)355 1758 y FA(0)391 1773 y FI(and)g FF(e)495 1779
y FA(1)531 1773 y Fy(\021)h FE(run)f Fy(h)q FF(e)692
1779 y FA(3)711 1773 y Fy(i)g(\000)-7 b(!)19 b FF(e)850
1779 y FA(3)887 1773 y Fy(\021)f FF(e)956 1779 y FA(2)975
1773 y FI(.)f(W)m(e)h(are)g(giv)o(en)f FF(\000)23 b Fy(`)1339
1758 y Ft(n)p FA(+)1407 1773 y FE(~)p Fy(h)q FF(e)1464
1779 y FA(3)1483 1773 y Fy(i)18 b FI(:)f FF(\034)5 b
FI(.)17 b(By)h(t)o(yping)f(w)o(e)h(get)221 1838 y FF(\000)e
Fy(`)288 1823 y Ft(n)323 1838 y Fy(h)p FF(e)358 1844
y FA(3)377 1838 y Fy(i)c FI(:)f Fy(h)p FF(\034)5 b Fy(i)p
FI(,)13 b(and)h(then)g FF(\000)j Fy(`)751 1823 y Ft(n)p
FA(+)811 1838 y FF(e)830 1844 y FA(3)861 1838 y FI(:)11
b FF(\034)19 b FI(and)13 b(w)o(e)h(are)h(done.)1892 1911
y Fy(u)-28 b(t)150 2070 y FD(6.8)56 b(Con\015uence)150
2202 y FI(Establishing)12 b(the)h(con\015uence)i(prop)q(ert)o(y)f(in)e
(the)h(presence)i(of)d(the)i FF(\014)h FI(rule)e(can)g(b)q(e)g(in)o(v)o
(olv)o(ed,)e(largely)h(b)q(ecause)150 2277 y(substitution)h(can)f
(duplicate)h(redices,)g(and)g(establishing)f(that)g(these)i(redices)g
(are)f(not)f(a\013ected)i(b)o(y)e(substitu-)150 2352
y(tion)f(can)h(b)q(e)g(non-trivial.)e(Barendregt)j(presen)o(ts)h(a)d(n)
o(um)o(b)q(er)g(of)g(di\013eren)o(t)i(w)o(a)o(ys)e(for)g(pro)o(ving)g
(con\015uence,)i(and)150 2427 y(discusses)j(their)f(relativ)o(e)f
(merits)g([1].)f(Recen)o(tly)m(,)g(T)m(ak)n(ahashi)g(has)h(pro)q(duced)
i(a)e(concise)h(y)o(et)g(highly)e(rigorous)150 2501 y(tec)o(hnique)h
(for)e(pro)o(ving)g(con\015uence,)j(and)d(demonstrated)h(its)g
(application)f(in)g(a)h(v)n(ariet)o(y)f(of)g(settings,)h(includ-)150
2576 y(ing)j(pro)o(ving)g(some)g(subtle)h(prop)q(erties)h(of)f
(reduction)g(systems)g(suc)o(h)h(as)e(standardization)h([96].)e(The)i
(basic)150 2651 y(idea)11 b(that)h(T)m(ak)n(ahashi)d(promotes)i(is)h
(the)g(use)g(of)f(an)g(explicit)g(notion)g(of)f(a)i(parallel)e
(reduction.)i(While)e(the)i(idea)p eop
%%Page: 107 118
107 117 bop 1862 0 a FB(107)150 192 y FI(go)q(es)16 b(bac)o(k)g(to)f
(the)i(original)c(and)j(classic)g(\(y)o(et)g(unpublished\))g(w)o(orks)g
(of)f(T)m(ait)g(and)g(Martin-L\177)-21 b(of,)15 b(T)m(ak)n(ahashi)150
266 y(emphasizes)h(that)g(the)h(rather)g(v)o(erb)q(ose)g(notion)f(of)f
(residuals)h(\(see)i(Barendregt)f([1],)e(for)h(example,\))e(can)i(b)q
(e)150 341 y(completely)d(a)o(v)o(oided.)150 424 y(In)d(this)f
(section,)h(w)o(e)g(presen)o(t)h(a)e(pro)q(of)g(of)g(the)i
(con\015uence)g(of)e(CBN)h FF(\025)p FI(-U)g(that)f(follo)o(ws)f
(closely)i(the)g(dev)o(elopmen)o(t)150 499 y(in)h(the)h(in)o(tro)q
(duction)f(to)g(T)m(ak)n(ahashi's)e(pap)q(er.)j(The)f(CBN)h(reductions)
g(of)f FF(\025)p FI(-U)g(do)g(not)h(in)o(tro)q(duce)f(an)o(y)g(notable)
150 573 y(complications)17 b(to)j(the)g(pro)q(of,)f(and)g(it)g(is)g(as)
h(simple,)e(concise,)i(and)f(rigorous)g(as)h(the)g(one)g(presen)o(ted)h
(b)o(y)150 648 y(T)m(ak)n(ahashi.)150 763 y FG(De\014nitio)o(n)13
b(6.8.1)j(\(Con)o(text\))j FH(A)14 b FI(Con)o(text)h
FH(is)g(an)g(expr)n(ession)h(with)e(exactly)h(one)g(hole)g
FI([])p FH(.)589 872 y FF(C)f Fy(2)d Fo(C)21 b FI(:=)11
b([])j Fy(j)h FF(\025x:C)i Fy(j)d FF(C)c(e)15 b Fy(j)f
FF(e)7 b(C)18 b Fy(j)c(h)p FF(C)s Fy(i)h(j)h FE(~)q FF(C)h
Fy(j)d FE(run)f FF(C)q(:)150 975 y FH(We)18 b(write)e
FF(C)s FI([)p FF(e)p FI(])g FH(for)h(the)g(expr)n(ession)h(r)n
(esulting)e(fr)n(om)h(r)n(eplacing)g(\(\\\014l)r(ling"\))h(the)f(hole)h
FI([])e FH(in)h(the)h(c)n(ontext)f FF(C)150 1040 y FH(with)d(the)h
(expr)n(ession)g FF(e)p FH(.)150 1155 y FG(Lemma)g(6.8.2)h(\(Basic)f
(Prop)q(ert)o(y)f(of)i(Con)o(texts\))i Fy(8)p FF(C)d
Fy(2)c Fo(C)6 b FF(:)h Fy(8)p FF(e)14 b Fy(2)d FF(E)r(:)950
1261 y(C)s FI([)p FF(e)p FI(])f Fy(2)i FF(E)r(:)150 1371
y FH(Pr)n(o)n(of.)20 b FI(By)14 b(an)g(induction)f(on)h(the)h(deriv)n
(ation)d(of)i FF(C)g Fy(2)d Fo(C)6 b FI(.)811 b Fy(u)-28
b(t)150 1486 y FG(Remark)15 b(6.8.3)21 b FH(Fil)r(ling)d(a)g(hole)g(in)
h(a)f(c)n(ontext)h(c)n(an)f(involve)h(variable)e(c)n(aptur)n(e,)h(in)h
(the)f(sense)g(that)h(given)150 1551 y FF(C)14 b Fy(\021)e
FF(\025x:)p FI([])p FH(,)h FF(C)s FI([)p FF(x)p FI(])d
Fy(\021)i FF(\025x:x)p FH(,)i(and)h(the)g(binding)h(o)n(c)n(curr)n(enc)
n(e)e(of)h FF(x)g FH(in)g FF(C)i FH(is)e(not)g(r)n(ename)n(d.)150
1665 y FG(De\014nitio)o(n)e(6.8.4)j(\(P)o(arallel)c(Reduction\))18
b FH(The)11 b FI(parallel)e(reduction)j FH(r)n(elation)p
1493 1665 13 2 v 38 w Fy(\035)p 1573 1665 V 38 w(\022)g
FF(E)t Fy(\002)r FF(E)h FH(is)e(de\014ne)n(d)150 1730
y(as)k(fol)r(lows:)166 1865 y(1.)p 240 1855 124 2 v 246
1906 a FF(x)c Fy(\035)h FF(x)166 2010 y FH(2.)306 1975
y FF(e)325 1981 y FA(1)355 1975 y Fy(\035)f FF(e)427
1981 y FA(2)p 240 2000 272 2 v 246 2051 a FF(\025x:e)325
2057 y FA(1)355 2051 y Fy(\035)g FF(\025x:e)487 2057
y FA(2)166 2155 y FH(3.)246 2120 y FF(e)265 2126 y FA(1)296
2120 y Fy(\035)g FF(e)368 2126 y FA(3)429 2120 y FF(e)448
2126 y FA(2)479 2120 y Fy(\035)g FF(e)551 2126 y FA(4)p
240 2146 336 2 v 300 2196 a FF(e)319 2202 y FA(1)338
2196 y FF(e)357 2202 y FA(2)387 2196 y Fy(\035)g FF(e)459
2202 y FA(3)478 2196 y FF(e)497 2202 y FA(4)166 2300
y FH(4.)295 2265 y FF(e)314 2250 y FA(0)314 2275 y(1)345
2265 y Fy(\035)g FF(e)417 2271 y FA(3)478 2265 y FF(e)497
2250 y FA(0)497 2275 y(2)528 2265 y Fy(\035)g FF(e)600
2250 y FA(0)600 2275 y(4)p 240 2291 434 2 v 246 2342
a FI(\()p FF(\025x:e)341 2326 y FA(0)341 2352 y(1)360
2342 y FI(\))p FF(e)395 2326 y FA(0)395 2352 y(2)425
2342 y Fy(\035)g FF(e)497 2348 y FA(3)516 2342 y FI([)p
FF(x)g FI(:=)h FF(e)638 2326 y FA(0)638 2352 y(4)656
2342 y FI(])166 2446 y FH(5.)278 2411 y FF(e)297 2417
y FA(1)328 2411 y Fy(\035)f FF(e)400 2417 y FA(2)p 240
2436 217 2 v 246 2487 a Fy(h)p FF(e)281 2493 y FA(1)300
2487 y Fy(i)h(\035)f(h)p FF(e)416 2493 y FA(2)435 2487
y Fy(i)166 2591 y FH(6.)269 2556 y FF(e)288 2562 y FA(1)319
2556 y Fy(\035)g FF(e)391 2562 y FA(2)p 240 2581 199
2 v 247 2632 a FE(~)q FF(e)288 2638 y FA(1)319 2632 y
Fy(\035)h FE(~)q FF(e)414 2638 y FA(2)p eop
%%Page: 108 119
108 118 bop 1862 0 a FB(108)166 231 y FH(7.)274 196 y
FF(e)293 180 y FA(0)293 206 y(1)323 196 y Fy(\035)11
b FF(e)395 180 y FA(0)395 206 y(2)p 240 221 208 2 v 247
272 a FE(~)q Fy(h)p FF(e)304 257 y FA(0)304 282 y(1)323
272 y Fy(i)h(\035)f FF(e)423 257 y FA(0)423 282 y(2)166
375 y FH(8.)315 340 y FF(e)334 346 y FA(1)364 340 y Fy(\035)g
FF(e)436 346 y FA(2)p 240 366 290 2 v 246 417 a FE(run)i
FF(e)334 423 y FA(1)364 417 y Fy(\035)e FE(run)i FF(e)505
423 y FA(2)166 520 y FH(9.)297 485 y FF(e)316 469 y FA(0)316
495 y(1)346 485 y Fy(\035)e FF(e)418 469 y FA(0)418 495
y(2)p 240 510 253 2 v 246 561 a FE(run)i Fy(h)p FF(e)350
546 y FA(0)350 571 y(1)369 561 y Fy(i)f(\035)f FF(e)469
546 y FA(0)469 571 y(2)513 520 y FF(:)150 662 y FG(Remark)k(6.8.5)h
(\(Idemp)q(otence\))i FH(By)g(ignoring)f(rules)g(4,7,)g(and)h(9)f(in)g
(the)h(de\014nition)g(ab)n(ove,)f(it)g(is)g(e)n(asy)150
726 y(to)e(se)n(e)g(that)g FF(e)c Fy(\035)h FF(e)p FH(.)150
837 y FG(Lemma)j(6.8.6)h(\(P)o(arallel)d(Reduction)g(Prop)q(erties\))k
Fy(8)p FF(e)1156 843 y FA(1)1187 837 y Fy(2)11 b FF(E)r(:)166
940 y FH(1.)21 b Fy(8)p FF(e)263 946 y FA(2)293 940 y
Fy(2)11 b FF(E)r(:)c(e)403 946 y FA(1)433 940 y Fy(\000)-6
b(!)11 b FF(e)531 946 y FA(2)561 940 y FI(=)-7 b Fy(\))12
b FF(e)659 946 y FA(1)689 940 y Fy(\035)f FF(e)761 946
y FA(2)166 1004 y FH(2.)21 b Fy(8)p FF(e)263 1010 y FA(2)293
1004 y Fy(2)11 b FF(E)r(:)c(e)403 1010 y FA(1)433 1004
y Fy(\035)k FF(e)505 1010 y FA(2)536 1004 y FI(=)-7 b
Fy(\))11 b FF(e)633 1010 y FA(1)664 1004 y Fy(\000)-7
b(!)731 989 y Fs(\003)761 1004 y FF(e)780 1010 y FA(2)166
1068 y FH(3.)21 b Fy(8)p FF(e)263 1074 y FA(3)293 1068
y Fy(2)11 b FF(E)r(:)c(e)403 1074 y FA(2)422 1068 y FF(;)g(e)460
1074 y FA(4)490 1068 y Fy(2)k FF(E)562 1053 y FA(0)581
1068 y FF(:)c(e)619 1074 y FA(1)648 1068 y Fy(\035)12
b FF(e)721 1074 y FA(3)739 1068 y FF(;)7 b(e)777 1053
y FA(0)777 1078 y(2)807 1068 y Fy(\035)k FF(e)879 1053
y FA(0)879 1078 y(4)910 1068 y FI(=)-7 b Fy(\))11 b FF(e)1007
1074 y FA(1)1026 1068 y FI([)p FF(y)i FI(:=)f FF(e)1146
1053 y FA(0)1146 1078 y(2)1164 1068 y FI(])g Fy(\035)f
FF(e)1260 1074 y FA(3)1279 1068 y FI([)p FF(y)h FI(:=)g
FF(e)1398 1053 y FA(0)1398 1078 y(4)1417 1068 y FI(])p
FH(.)150 1174 y(Pr)n(o)n(of.)20 b FI(The)15 b(\014rst)h(is)f(pro)o(v)o
(ed)g(b)o(y)f(induction)h(on)f(the)i(con)o(text)f(of)g(the)g(redex,)h
(and)e(the)i(second)g(and)e(third)h(b)o(y)150 1239 y(induction)e(on)h
FF(e)411 1245 y FA(1)430 1239 y FI(.)1450 b Fy(u)-28
b(t)150 1350 y FG(Remark)15 b(6.8.7)21 b FH(F)m(r)n(om)15
b(1)g(and)g(2)g(ab)n(ove)h(we)e(c)n(an)i(se)n(e)f(that)g(that)f
Fy(\035)1242 1335 y Fs(\003)1261 1350 y FI(=)p Fy(\000)-6
b(!)1361 1335 y Fs(\003)1379 1350 y FH(.)150 1471 y FI(The)15
b(Ch)o(urc)o(h-Rosser)h(theorem)f([1])f(for)g Fy(\000)-6
b(!)14 b FI(follo)o(ws)f(from)g(T)m(ak)n(ahashi's)h(prop)q(ert)o(y)h
([96].)e(The)j(statemen)o(t)f(of)150 1545 y(T)m(ak)n(ahashi's)d(prop)q
(ert)o(y)j(uses)g(the)f(follo)o(wing)e(notion.)150 1656
y FG(De\014nitio)o(n)h(6.8.8)j(\(Star)e(Reduction\))k
FH(The)f FI(star)f(reduction)h FH(function)p 1390 1656
13 2 v 1403 1641 a Fs(\003)1437 1656 y FI(:)d FF(E)j
Fy(!)e FF(E)j FH(is)f(de\014ne)n(d)h(as)f(fol-)150 1721
y(lows:)166 1824 y(1.)k FF(x)245 1808 y Fs(\003)275 1824
y Fy(\021)12 b FF(x)166 1888 y FH(2.)21 b FI(\()p FF(\025x:e)316
1894 y FA(1)334 1888 y FI(\))350 1872 y Fs(\003)381 1888
y Fy(\021)12 b FF(\025x:e)504 1872 y Fs(\003)504 1898
y FA(1)166 1952 y FH(3.)21 b FI(\()p FF(e)256 1958 y
FA(1)275 1952 y FF(e)294 1958 y FA(2)313 1952 y FI(\))329
1936 y Fs(\003)359 1952 y Fy(\021)12 b FF(e)422 1936
y Fs(\003)422 1962 y FA(1)442 1952 y FF(e)461 1936 y
Fs(\003)461 1962 y FA(2)495 1952 y FH(if)i FF(e)554 1958
y FA(1)573 1952 y FF(e)592 1958 y FA(2)623 1952 y Fy(6\021)d
FI(\()p FF(\025x:e)761 1936 y FA(0)761 1962 y(3)780 1952
y FI(\))p FF(e)815 1936 y FA(0)815 1962 y(4)166 2016
y FH(4.)21 b FI(\(\()p FF(\025x:e)332 2000 y FA(0)332
2026 y(1)350 2016 y FI(\))p FF(e)385 2000 y FA(0)385
2026 y(2)404 2016 y FI(\))420 2000 y Fs(\003)451 2016
y Fy(\021)12 b FI(\()p FF(e)530 2000 y FA(0)530 2026
y(1)549 2016 y FI(\))565 2000 y Fs(\003)584 2016 y FI([)p
FF(x)f FI(:=)g(\()p FF(e)721 2000 y FA(0)721 2026 y(2)740
2016 y FI(\))756 2000 y Fs(\003)776 2016 y FI(])166 2080
y FH(5.)21 b Fy(h)p FF(e)256 2086 y FA(1)275 2080 y Fy(i)291
2059 y Fs(\003)321 2080 y Fy(\021)12 b(h)p FF(e)400 2064
y Fs(\003)400 2090 y FA(1)420 2080 y Fy(i)166 2144 y
FH(6.)21 b FI(\()q FE(~)q FF(e)279 2150 y FA(1)298 2144
y FI(\))314 2128 y Fs(\003)344 2144 y Fy(\021)13 b FE(~)q
FI(\()p FF(e)446 2128 y Fs(\003)446 2154 y FA(1)466 2144
y FI(\))i FH(if)g FE(~)q FF(e)579 2150 y FA(1)610 2144
y Fy(6\021)e FE(~)q Fy(h)p FF(e)712 2128 y FA(0)712 2154
y(2)731 2144 y Fy(i)166 2208 y FH(7.)21 b FI(\()q FE(~)q
Fy(h)p FF(e)295 2192 y FA(0)295 2218 y(1)314 2208 y Fy(i)p
FI(\))346 2192 y Fs(\003)377 2208 y Fy(\021)12 b FI(\()p
FF(e)456 2192 y FA(0)456 2218 y(1)475 2208 y FI(\))491
2192 y Fs(\003)166 2272 y FH(8.)21 b FI(\()p FE(run)12
b FF(e)324 2278 y FA(1)343 2272 y FI(\))359 2257 y Fs(\003)390
2272 y Fy(\021)g FE(run)g FI(\()p FF(e)537 2257 y Fs(\003)537
2282 y FA(1)557 2272 y FI(\))j FH(if)f FE(run)f FF(e)716
2278 y FA(1)746 2272 y Fy(6\021)f FE(run)h Fy(h)p FF(e)894
2257 y FA(0)894 2282 y(2)913 2272 y Fy(i)166 2336 y FH(9.)21
b FI(\()p FE(run)12 b Fy(h)p FF(e)340 2321 y FA(0)340
2346 y(1)359 2336 y Fy(i)q FI(\))392 2321 y Fs(\003)422
2336 y Fy(\021)g FI(\()p FF(e)501 2321 y FA(0)501 2346
y(1)520 2336 y FI(\))536 2321 y Fs(\003)555 2336 y FH(.)150
2446 y FG(Remark)j(6.8.9)21 b FH(By)16 b(a)f(simple)f(induction)i(on)f
FF(e)p FH(,)g(we)f(c)n(an)i(se)n(e)f(that)g FF(e)c Fy(\035)h
FF(e)1365 2431 y Fs(\003)1384 2446 y FH(.)150 2557 y
FG(Theorem)j(6.8.10)h(\(T)l(ak)m(ahashi's)f(Prop)q(ert)o(y\))j
Fy(8)p FF(e)1033 2563 y FA(1)1052 2557 y FF(;)7 b(e)1090
2563 y FA(2)1120 2557 y Fy(2)k FF(E)r(:)844 2660 y(e)863
2666 y FA(1)893 2660 y Fy(\035)g FF(e)965 2666 y FA(2)996
2660 y FI(=)-7 b Fy(\))11 b FF(e)1093 2666 y FA(2)1123
2660 y Fy(\035)g FF(e)1195 2643 y Fs(\003)1195 2670 y
FA(1)1215 2660 y FF(:)p eop
%%Page: 109 120
109 119 bop 1862 0 a FB(109)150 192 y FH(Pr)n(o)n(of.)20
b FI(By)14 b(induction)g(on)f FF(e)606 198 y FA(1)625
192 y FI(.)1255 b Fy(u)-28 b(t)150 312 y FI(The)14 b(follo)o(wing)e(t)o
(w)o(o)h(results)i(then)g(follo)o(w)d(in)h(sequence:)150
426 y FG(Notation)h(6.8.11)i(\(Relation)d(Comp)q(osition\))k
FH(F)m(or)e(any)g(two)g(r)n(elations)f Fy(\010)h FH(and)g
Fy(\012)p FH(,)g(we)g(write)e FF(a)c Fy(\010)h FF(b)f
Fy(\012)g FF(c)150 491 y FH(as)15 b(a)g(shorthand)h(for)e
FI(\()p FF(a)9 b Fy(\010)h FF(b)p FI(\))f Fy(^)g FI(\()p
FF(b)g Fy(\012)h FF(c)p FI(\))p FH(.)150 606 y FG(Lemma)15
b(6.8.12)h(\(P)o(arallel)d(Reduction)g(is)i(Diamond\))j
Fy(8)p FF(e)1200 612 y FA(1)1219 606 y FF(;)7 b(e;)g(e)1295
612 y FA(2)1325 606 y Fy(2)k FF(E)r(:)660 712 y(e)679
718 y FA(1)709 712 y Fy(\034)g FF(e)h Fy(\035)f FF(e)865
718 y FA(2)896 712 y FI(=)-7 b Fy(\))11 b FI(\()p Fy(9)p
FF(e)1032 695 y Fs(0)1056 712 y Fy(2)g FF(E)r(:)c(e)1166
718 y FA(1)1196 712 y Fy(\035)k FF(e)1268 695 y Fs(0)1292
712 y Fy(\034)g FF(e)1364 718 y FA(2)1383 712 y FI(\))p
FF(:)150 822 y FH(Pr)n(o)n(of.)20 b FI(T)m(ak)o(e)13
b FF(e)399 807 y Fs(0)423 822 y FI(=)f FF(e)486 807 y
Fs(\003)519 822 y FI(and)i(use)g(T)m(ak)n(ahashi's)f(prop)q(ert)o(y)m
(.)832 b Fy(u)-28 b(t)150 937 y FG(Theorem)15 b(6.8.13)h(\(CBN)g
FF(\025)p FG(-U)g(is)f(Con\015uen)o(t\))j Fy(8)p FF(e)1057
943 y FA(1)1076 937 y FF(;)7 b(e;)g(e)1152 943 y FA(2)1181
937 y Fy(2)k FF(E)r(:)571 1043 y(e)590 1049 y FA(1)620
1043 y Fy( )-7 b(\000)687 1026 y Fs(\003)718 1043 y FF(e)12
b Fy(\000)-7 b(!)816 1026 y Fs(\003)846 1043 y FF(e)865
1049 y FA(2)896 1043 y FI(=)g Fy(\))11 b FI(\()p Fy(9)p
FF(e)1032 1026 y Fs(0)1056 1043 y Fy(2)g FF(E)r(:)c(e)1166
1049 y FA(1)1196 1043 y Fy(\000)-7 b(!)1263 1026 y Fs(\003)1293
1043 y FF(e)1312 1026 y Fs(0)1336 1043 y Fy( )g(\000)1403
1026 y Fs(\003)1433 1043 y FF(e)1452 1049 y FA(2)1471
1043 y FI(\))p FF(:)150 1202 y FD(6.9)56 b(The)16 b(Soundness)h(of)g
(CBN)g Fm(\025)p FD(-U)g(Reductions)f(under)g(CBN)h Fm(\025)p
FD(-M)g(Big-Steps)150 1335 y FI(In)d(this)g(section,)g(w)o(e)g(sho)o(w)
g(that)g(CBN)h FF(\025)p FI(-U)f(reductions)h(preserv)o(e)h(observ)n
(ational)d(equiv)n(alence)1696 1320 y FA(4)1714 1335
y FI(,)h(where)h(our)150 1409 y(notion)e(of)g(observ)n(ation)h(is)g
(simply)e(the)i(termination)e(b)q(eha)o(vior)i(of)f(the)i(lev)o(el)e(0)
h FF(\025)p FI(-M)g(big-step)g(ev)n(aluation.)150 1492
y(Recall)f(from)f(Chapter)j(5,)e(Figure)h(5.3,)f(that)h(the)g(CBN)h
FF(\025)p FI(-M)f(seman)o(tics)f(is)h(sp)q(eci\014ed)i(b)o(y)e(a)f
(partial)g(function)p 152 1567 13 2 v 189 1540 a Ft(n)176
1567 y FF(,)-7 b Fy(!)p 237 1567 V 38 w FI(:)11 b FF(E)317
1552 y Ft(n)351 1567 y Fy(!)g FF(E)437 1552 y Ft(n)473
1567 y FI(as)j(follo)o(ws:)p 456 1769 110 2 v 462 1827
a FF(i)500 1799 y Ft(n)488 1826 y FF(,)-7 b Fy(!)545
1827 y FF(i)598 1778 y FI(In)o(t)p 868 1769 239 2 v 874
1827 a FF(\025x:e)979 1799 y FA(0)964 1826 y FF(,)g Fy(!)1022
1827 y FF(\025x:e)1139 1778 y FI(Lam)1341 1665 y FF(e)1360
1671 y FA(1)1405 1638 y(0)1390 1665 y FF(,)g Fy(!)11
b FF(\025x:e)1341 1740 y(e)p FI([)p FF(x)g FI(:=)g FF(e)1481
1746 y FA(2)1500 1740 y FI(])1538 1712 y FA(0)1523 1740
y FF(,)-7 b Fy(!)11 b FF(e)1600 1746 y FA(3)p 1329 1769
302 2 v 1382 1827 a FF(e)1401 1833 y FA(1)1433 1827 y
FF(e)1452 1833 y FA(2)1498 1799 y(0)1483 1826 y FF(,)-7
b Fy(!)1541 1827 y FF(e)1560 1833 y FA(3)1663 1778 y
FI(App)317 1928 y FF(e)336 1934 y FA(1)381 1900 y(0)366
1928 y FF(,)g Fy(!)11 b(h)p FF(e)459 1934 y FA(2)478
1928 y Fy(i)42 b FF(e)555 1934 y FA(2)600 1900 y(0)585
1928 y FF(,)-7 b Fy(!)11 b FF(e)662 1934 y FA(3)p 311
1957 376 2 v 392 2015 a FE(run)i FF(e)480 2021 y FA(1)525
1987 y(0)510 2014 y FF(,)-7 b Fy(!)568 2015 y FF(e)587
2021 y FA(3)719 1967 y FI(Run)p 915 1957 129 2 v 921
2015 a FF(x)956 1987 y Ft(n)p FA(+)956 2014 y FF(,)g
Fy(!)1014 2015 y FF(x)1076 1967 y FI(V)m(ar+)1298 1928
y FF(e)1317 1934 y FA(1)1348 1900 y Ft(n)p FA(+)1348
1928 y FF(,)g Fy(!)10 b FF(e)1424 1934 y FA(3)1485 1928
y FF(e)1504 1934 y FA(2)1534 1900 y Ft(n)p FA(+)1534
1928 y FF(,)-7 b Fy(!)11 b FF(e)1611 1934 y FA(4)p 1292
1957 344 2 v 1340 2015 a FF(e)1359 2021 y FA(1)1391 2015
y FF(e)1410 2021 y FA(2)1441 1987 y Ft(n)p FA(+)1441
2014 y FF(,)-7 b Fy(!)1498 2015 y FF(e)1517 2021 y FA(3)1550
2015 y FF(e)1569 2021 y FA(4)1668 1967 y FI(App+)408
2116 y FF(e)427 2122 y FA(1)457 2088 y Ft(n)p FA(+)457
2116 y FF(,)g Fy(!)11 b FF(e)534 2122 y FA(2)p 343 2145
276 2 v 348 2203 a FF(\025x:e)427 2209 y FA(1)457 2175
y Ft(n)p FA(+)457 2202 y FF(,)-7 b Fy(!)515 2203 y FF(\025x:e)594
2209 y FA(2)651 2155 y FI(Lam+)921 2116 y FF(e)940 2122
y FA(1)971 2088 y Ft(n)p FA(+)971 2116 y FF(,)g Fy(!)11
b FF(e)1048 2122 y FA(2)p 883 2145 222 2 v 889 2203 a
Fy(h)p FF(e)924 2209 y FA(1)943 2203 y Fy(i)984 2175
y Ft(n)971 2202 y FF(,)-7 b Fy(!)1029 2203 y(h)p FF(e)1064
2209 y FA(2)1083 2203 y Fy(i)1137 2155 y FI(Brk)1371
2116 y FF(e)1390 2122 y FA(1)1420 2088 y Ft(n)p FA(+)1420
2116 y FF(,)g Fy(!)11 b FF(e)1497 2122 y FA(2)p 1296
2145 294 2 v 1302 2203 a FE(run)i FF(e)1390 2209 y FA(1)1420
2175 y Ft(n)p FA(+)1420 2202 y FF(,)-7 b Fy(!)1478 2203
y FE(run)13 b FF(e)1566 2209 y FA(2)1623 2155 y FI(Run+)401
2304 y FF(e)420 2310 y FA(1)450 2276 y Ft(n)p FA(+)450
2304 y FF(,)-7 b Fy(!)11 b FF(e)527 2310 y FA(2)p 359
2333 229 2 v 366 2391 a FE(~)q FF(e)407 2397 y FA(1)438
2363 y Ft(n)p FA(++)450 2390 y FF(,)-7 b Fy(!)522 2391
y FE(~)q FF(e)563 2397 y FA(2)620 2343 y FI(Esc++)902
2304 y FF(e)921 2310 y FA(1)966 2276 y(0)951 2304 y FF(,)g
Fy(!)11 b(h)p FF(e)1044 2310 y FA(2)1063 2304 y Fy(i)p
896 2333 189 2 v 908 2391 a FE(~)p FF(e)948 2397 y FA(1)994
2363 y(1)979 2390 y FF(,)-7 b Fy(!)1037 2391 y FF(e)1056
2397 y FA(2)1118 2343 y FI(Esc.)p 150 2485 237 2 v 158
2512 a Fz(4)188 2528 y FB(A)9 b(reduction)i(seman)o(tics)f(for)f(a)g
(lam)o(b)q(da)h(calculus)i(is)d(generally)j(not)d(\\equal")i(to)e(a)g
(big-step)h(seman)o(tics.)g(F)m(or)f(example,)188 2573
y(the)16 b(reduction)h(seman)o(tics)g(for)f(the)f(lam)o(b)q(da)j
(calculus)f(can)f(do)g(\\reductions)i(under)f(lam)o(b)q(da",)g(and)f
(the)g(big-step)188 2619 y(seman)o(tics)i(generally)g(do)q(es)f(not.)f
(The)g(reader)g(is)h(referred)f(to)g(textb)q(o)q(oks)i(on)e(the)g
(seman)o(tics)i(for)e(more)g(detailed)188 2665 y(discussions)g([50,)7
b(103].)p eop
%%Page: 110 121
110 120 bop 1862 0 a FB(110)150 192 y FG(De\014nitio)o(n)13
b(6.9.1)j(\(Lev)o(el)e(0)i(T)l(ermination\))h Fy(8)p
FF(e)12 b Fy(2)f FF(E)1092 176 y FA(0)1111 192 y FF(:)817
298 y(e)5 b Fy(+)892 274 y Ft(\001)889 298 y FI(=)12
b(\()p Fy(9)p FF(v)i Fy(2)d FF(V)1078 281 y FA(0)1097
298 y FF(:)c(e)1161 270 y FA(0)1146 298 y FF(,)-7 b Fy(!)11
b FF(v)q FI(\))p FF(:)150 412 y FG(De\014nitio)o(n)i(6.9.2)j(\(Observ)m
(ational)d(Equiv)m(alence\))19 b FH(We)j(de\014ne)g Fy(\031)1336
418 y Ft(n)1359 412 y Fy(2)i FF(E)1444 397 y Ft(n)1480
412 y Fy(\002)15 b FF(E)1560 397 y Ft(n)1604 412 y FH(as)21
b(fol)r(lows:)g Fy(8)p FF(n)i Fy(2)150 477 y Fo(N)p FF(:)7
b Fy(8)p FF(e)243 483 y FA(1)259 477 y FF(;)g(e)297 483
y FA(2)327 477 y Fy(2)12 b FF(E)400 462 y Ft(n)422 477
y FF(:)447 583 y(e)466 589 y FA(1)497 583 y Fy(\031)529
589 y Ft(n)563 583 y FF(e)582 589 y FA(2)615 560 y Ft(\001)613
583 y FI(=)f Fy(8)p FF(C)k Fy(2)c Fo(C)6 b FF(:)h(C)s
FI([)p FF(e)873 589 y FA(1)893 583 y FI(])p FF(;)g(C)s
FI([)p FF(e)988 589 y FA(2)1006 583 y FI(])k Fy(2)g FF(E)1101
566 y FA(0)1131 583 y FI(=)-7 b Fy(\))11 b FI(\()p FF(C)s
FI([)p FF(e)1289 589 y FA(1)1308 583 y FI(])5 b Fy(+)22
b(\()-7 b(\))11 b FF(C)s FI([)p FF(e)1524 589 y FA(2)1542
583 y FI(])5 b Fy(+)11 b FI(\))p FF(:)150 698 y FG(Remark)k(6.9.3)21
b FH(The)12 b(de\014nition)g(says)g(that)g(two)f(terms)g(ar)n(e)g
(observational)r(ly)g(e)n(quivalent)h(exactly)g(when)g(they)150
763 y(c)n(an)k(b)n(e)f(inter)n(change)n(d)h(in)f(every)g(level)g(0)g
(term)g(without)f(a\013e)n(cting)i(the)g(level)e(0)i(termination)f(b)n
(ehavior)g(of)g(the)150 827 y(term.)150 942 y FG(Notation)f(6.9.4)21
b FH(We)15 b(wil)r(l)f(dr)n(op)h(the)g FF(U)k FH(subscript)c(fr)n(om)f
Fy(\000)-7 b(!)1174 948 y Fr(U)1213 942 y FH(in)15 b(the)g(r)n(est)f
(of)h(this)f(chapter.)150 1057 y FG(Theorem)h(6.9.5)h(\(CBN)g
FF(\025)p FG(-U)g(Reduction)d(is)i(Sound)f(under)g FF(\025)p
FG(-M)i(Big-Steps\))i Fy(8)p FF(n)e Fy(2)h Fo(N)p FF(:)7
b Fy(8)p FF(e)1803 1063 y FA(1)1819 1057 y FF(;)g(e)1857
1063 y FA(2)1892 1057 y Fy(2)150 1121 y FF(E)183 1106
y Ft(n)206 1121 y FF(:)823 1228 y(e)842 1234 y FA(1)873
1228 y Fy(\000)-7 b(!)13 b FF(e)972 1234 y FA(2)1003
1228 y FI(=)-7 b Fy(\))11 b FF(e)1100 1234 y FA(1)1131
1228 y Fy(\031)1163 1234 y Ft(n)1197 1228 y FF(e)1216
1234 y FA(2)1235 1228 y FF(:)150 1338 y FH(Pr)n(o)n(of.)20
b FI(By)14 b(the)h(de\014nition)e(of)g Fy(\031)680 1344
y Ft(n)703 1338 y FI(,)h(to)f(pro)o(v)o(e)h(our)g(goal)634
1444 y Fy(8)p FF(n)e Fy(2)f Fo(N)p FF(:)c Fy(8)p FF(e)826
1450 y FA(1)843 1444 y FF(;)g(e)881 1450 y FA(2)911 1444
y Fy(2)k FF(E)983 1427 y Ft(n)1005 1444 y FF(:)c(e)1043
1450 y FA(1)1073 1444 y Fy(\000)-6 b(!)13 b FF(e)1173
1450 y FA(2)1203 1444 y FI(=)-7 b Fy(\))12 b FF(e)1301
1450 y FA(1)1331 1444 y Fy(\031)1363 1450 y Ft(n)1398
1444 y FF(e)1417 1450 y FA(2)150 1551 y FI(is)i(to)f(pro)o(v)o(e)262
1657 y Fy(8)p FF(n)e Fy(2)g Fo(N)p FF(;)c(C)12 b Fy(2)f
Fo(C)6 b FF(:)h Fy(8)p FF(e)580 1663 y FA(1)602 1657
y FF(;)g(e)640 1663 y FA(2)670 1657 y Fy(2)k FF(E)742
1640 y Ft(n)764 1657 y FF(:)c(e)802 1663 y FA(1)832 1657
y Fy(\000)-6 b(!)13 b FF(e)932 1663 y FA(2)960 1657 y
Fy(^)c FF(C)s FI([)p FF(e)1061 1663 y FA(1)1079 1657
y FI(])p FF(;)e(C)s FI([)p FF(e)1174 1663 y FA(2)1191
1657 y FI(])k Fy(2)g FF(E)1286 1640 y FA(0)1317 1657
y FI(=)-7 b Fy(\))11 b FI(\()p FF(C)s FI([)p FF(e)1475
1663 y FA(1)1493 1657 y FI(])5 b Fy(+)23 b(\()-7 b(\))10
b FF(C)s FI([)p FF(e)1709 1663 y FA(2)1728 1657 y FI(])5
b Fy(+)11 b FI(\))p FF(:)150 1763 y FI(Noting)h(that)h(b)o(y)g(the)h
(compatibilit)o(y)c(of)i Fy(\000)-6 b(!)q FI(,)13 b(w)o(e)g(kno)o(w)f
(that)h Fy(8)p FF(n)f Fy(2)f Fo(N)p FF(;)c(C)12 b Fy(2)f
Fo(C)6 b FF(:)h Fy(8)p FF(e)1471 1769 y FA(1)1492 1763
y FF(;)g(e)1530 1769 y FA(2)1560 1763 y Fy(2)12 b FF(E)1633
1748 y Ft(n)1655 1763 y FF(:)7 b(e)1693 1769 y FA(1)1723
1763 y Fy(\000)-6 b(!)13 b FF(e)1823 1769 y FA(2)1853
1763 y FI(=)-7 b Fy(\))150 1828 y FF(C)s FI([)p FF(e)214
1834 y FA(1)232 1828 y FI(])11 b Fy(\000)-6 b(!)13 b
FF(C)s FI([)p FF(e)400 1834 y FA(2)418 1828 y FI(],)g(it)g(is)h
(su\016cien)o(t)g(to)g(pro)o(v)o(e)g(a)g(stronger)g(statemen)o(t:)206
1934 y Fy(8)p FF(n)e Fy(2)f Fo(N)p FF(;)c(C)k Fy(2)h
Fo(C)5 b FF(:)i Fy(8)p FF(e)524 1940 y FA(1)546 1934
y FF(;)g(e)584 1940 y FA(2)614 1934 y Fy(2)k FF(E)686
1917 y Ft(n)709 1934 y FF(:)c(C)s FI([)p FF(e)792 1940
y FA(1)809 1934 y FI(])k Fy(\000)-6 b(!)13 b FF(C)s FI([)p
FF(e)977 1940 y FA(2)995 1934 y FI(])c Fy(^)g FF(C)s
FI([)p FF(e)1117 1940 y FA(1)1135 1934 y FI(])p FF(;)e(C)s
FI([)p FF(e)1230 1940 y FA(2)1247 1934 y FI(])k Fy(2)g
FF(E)1342 1917 y FA(0)1372 1934 y FI(=)-7 b Fy(\))12
b FI(\()p FF(C)s FI([)p FF(e)1531 1940 y FA(1)1549 1934
y FI(])5 b Fy(+)23 b(\()-7 b(\))10 b FF(C)s FI([)p FF(e)1765
1940 y FA(2)1783 1934 y FI(])5 b Fy(+)11 b FI(\))p FF(:)150
2040 y FI(Noting)j(further)h(that)g Fy(8)p FF(n)d Fy(2)g
Fo(N)p FF(;)7 b(C)13 b Fy(2)f Fo(C)6 b FF(:)h Fy(8)p
FF(a;)g(b)14 b Fy(2)f FF(E)969 2025 y Ft(n)991 2040 y
FF(:)7 b(a)12 b Fy(\021)h FF(C)s FI([)p FF(b)p FI(])e
Fy(2)h FF(E)1248 2025 y FA(0)1279 2040 y FI(=)-7 b Fy(\))13
b FF(a)f Fy(2)h FF(E)1467 2025 y FA(0)1485 2040 y FI(,)h(it)g(is)h
(su\016cien)o(t)g(to)f(pro)o(v)o(e)150 2105 y(an)g(ev)o(en)g(stronger)h
(statemen)o(t:)636 2211 y Fy(8)p FF(e)678 2217 y FA(1)697
2211 y FF(;)7 b(e)735 2217 y FA(2)765 2211 y Fy(2)k FF(E)837
2194 y FA(0)856 2211 y FF(:)c(e)894 2217 y FA(1)924 2211
y Fy(\000)-7 b(!)13 b FF(e)1023 2217 y FA(2)1054 2211
y FI(=)-7 b Fy(\))11 b FI(\()p FF(e)1167 2217 y FA(1)1191
2211 y Fy(+)23 b(\()-7 b(\))11 b FF(e)1346 2217 y FA(2)1369
2211 y Fy(+)h FI(\))p FF(:)150 2318 y FI(This)i(goal)e(can)j(b)q(e)f
(brok)o(en)g(do)o(wn)g(in)o(to)f(t)o(w)o(o)g(parts:)156
2424 y(S1)676 2530 y Fy(8)p FF(e)718 2536 y FA(1)737
2530 y FF(;)7 b(e)775 2536 y FA(2)805 2530 y Fy(2)k FF(E)877
2513 y FA(0)896 2530 y FF(:)c(e)934 2536 y FA(1)964 2530
y Fy(\000)-7 b(!)13 b FF(e)1063 2536 y FA(2)1094 2530
y FI(=)-7 b Fy(\))11 b FI(\()p FF(e)1207 2536 y FA(1)1231
2530 y Fy(+)23 b FI(=)-7 b Fy(\))12 b FF(e)1377 2536
y FA(2)1400 2530 y Fy(+)g FI(\))p FF(;)221 2637 y FI(and)p
eop
%%Page: 111 122
111 121 bop 1862 0 a FB(111)156 192 y FI(S2)676 297 y
Fy(8)p FF(e)718 303 y FA(1)737 297 y FF(;)7 b(e)775 303
y FA(2)805 297 y Fy(2)k FF(E)877 280 y FA(0)896 297 y
FF(:)c(e)934 303 y FA(1)964 297 y Fy(\000)-7 b(!)13 b
FF(e)1063 303 y FA(2)1094 297 y FI(=)-7 b Fy(\))11 b
FI(\()p FF(e)1207 303 y FA(2)1231 297 y Fy(+)23 b FI(=)-7
b Fy(\))12 b FF(e)1377 303 y FA(1)1400 297 y Fy(+)g FI(\))p
FF(:)150 403 y FI(Let)i(us)h(consider)f(S1.)g(By)g(de\014nition)f(of)h
(termination,)d(it)j(sa)o(ys:)393 508 y Fy(8)p FF(e)435
514 y FA(1)454 508 y FF(;)7 b(e)492 514 y FA(2)522 508
y Fy(2)k FF(E)594 491 y FA(0)613 508 y FF(:)c(e)651 514
y FA(1)681 508 y Fy(\000)-7 b(!)13 b FF(e)780 514 y FA(2)811
508 y FI(=)-7 b Fy(\))11 b FI(\(\()p Fy(9)p FF(v)j Fy(2)d
FF(V)1050 491 y FA(0)1069 508 y FF(:)c(e)1107 514 y FA(1)1152
481 y(0)1137 508 y FF(,)-7 b Fy(!)11 b FF(v)q FI(\))h(=)-7
b Fy(\))11 b FI(\()p Fy(9)p FF(v)j Fy(2)d FF(V)1467 491
y FA(0)1486 508 y FF(:)c(e)1524 514 y FA(2)1569 481 y(0)1554
508 y FF(,)-7 b Fy(!)10 b FF(v)q FI(\)\))p FF(:)150 614
y FI(W)m(e)15 b(will)e(sho)o(w)i(that)g(big-step)g(ev)n(aluation)e(is)i
(included)g(in)g(reduction)g(\(Lemma)e(6.9.6\).)g(Th)o(us,)h(to)h(pro)o
(v)o(e)g(S2)150 679 y(it)f(is)f(enough)h(to)g(pro)o(v)o(e:)372
785 y Fy(8)p FF(e)414 791 y FA(1)433 785 y FF(;)7 b(e)471
791 y FA(2)501 785 y Fy(2)k FF(E)573 768 y FA(0)592 785
y FF(:)c(e)630 791 y FA(1)660 785 y Fy(\000)-7 b(!)13
b FF(e)759 791 y FA(2)790 785 y FI(=)-7 b Fy(\))11 b
FI(\(\()p Fy(9)p FF(v)j Fy(2)d FF(V)1029 768 y FA(0)1048
785 y FF(:)c(e)1086 791 y FA(1)1116 785 y Fy(\000)-7
b(!)1185 767 y Fs(\003)1216 785 y FF(v)q FI(\))12 b(=)-7
b Fy(\))11 b FI(\()p Fy(9)p FF(v)j Fy(2)d FF(V)1488 768
y FA(0)1507 785 y FF(:)c(e)1545 791 y FA(2)1590 757 y(0)1575
785 y FF(,)-7 b Fy(!)10 b FF(v)q FI(\)\))p FF(:)150 890
y FI(Con\015uence)16 b(\(Theorem)d(6.8.13\))g(tell)h(us)g(that)h(an)o
(y)f(t)o(w)o(o)f(reduction)i(paths)g(are)g(joinable,)d(so)j(w)o(e)f
(can)h(w)o(eak)o(en)150 955 y(our)f(goal)f(as)h(follo)o(ws:)150
1061 y Fy(8)p FF(e)192 1067 y FA(1)211 1061 y FF(;)7
b(e)249 1067 y FA(2)279 1061 y Fy(2)k FF(E)351 1044 y
FA(0)370 1061 y FF(:)c(e)408 1067 y FA(1)438 1061 y Fy(\000)-7
b(!)13 b FF(e)537 1067 y FA(2)568 1061 y FI(=)-7 b Fy(\))11
b FI(\(\()p Fy(9)p FF(v)j Fy(2)d FF(V)807 1044 y FA(0)826
1061 y FF(;)c(e)864 1067 y FA(3)894 1061 y Fy(2)k FF(E)r(:)c(e)1004
1067 y FA(1)1034 1061 y Fy(\000)-7 b(!)1103 1043 y Fs(\003)1134
1061 y FF(v)13 b Fy(\000)-7 b(!)1236 1043 y Fs(\003)1266
1061 y FF(e)1285 1067 y FA(3)1313 1061 y Fy(^)9 b FF(e)1369
1067 y FA(2)1400 1061 y Fy(\000)-7 b(!)1469 1043 y Fs(\003)1499
1061 y FF(e)1518 1067 y FA(3)1537 1061 y FI(\))12 b(=)-7
b Fy(\))11 b FI(\()p Fy(9)p FF(v)j Fy(2)d FF(V)1788 1044
y FA(0)1807 1061 y FF(:)c(e)1845 1067 y FA(2)1890 1033
y(0)1875 1061 y FF(,)-7 b Fy(!)11 b FF(v)q FI(\)\))150
1167 y(W)m(e)j(will)e(sho)o(w)i(\(Lemmas)e(6.9.15)g(and)i(Remark)f
(6.8.7\))f(that)j(an)o(y)e(reduction)i(that)f(starts)h(from)d(a)i(v)n
(alue)g(can)150 1231 y(only)f(lead)h(to)f(a)h(v)n(alue)f(\(at)h(the)h
(same)e(lev)o(el\).)g(Th)o(us)h(w)o(e)g(can)g(w)o(eak)o(en)g(further:)
157 1337 y Fy(8)p FF(e)199 1343 y FA(1)218 1337 y FF(;)7
b(e)256 1343 y FA(2)286 1337 y Fy(2)12 b FF(E)359 1320
y FA(0)377 1337 y FF(:)7 b(e)415 1343 y FA(1)445 1337
y Fy(\000)-6 b(!)13 b FF(e)545 1343 y FA(2)575 1337 y
FI(=)-7 b Fy(\))12 b FI(\(\()p Fy(9)p FF(v)q(;)7 b(v)769
1343 y FA(3)799 1337 y Fy(2)k FF(V)872 1320 y FA(0)891
1337 y FF(:)c(e)929 1343 y FA(1)958 1337 y Fy(\000)-6
b(!)1027 1320 y Fs(\003)1058 1337 y FF(v)13 b Fy(\000)-6
b(!)1160 1320 y Fs(\003)1191 1337 y FF(v)1211 1343 y
FA(3)1239 1337 y Fy(^)9 b FF(e)1295 1343 y FA(2)1325
1337 y Fy(\000)-7 b(!)1394 1320 y Fs(\003)1425 1337 y
FF(v)1445 1343 y FA(3)1463 1337 y FI(\))12 b(=)-7 b Fy(\))11
b FI(\()p Fy(9)p FF(v)j Fy(2)d FF(V)1714 1320 y FA(0)1733
1337 y FF(:)c(e)1771 1343 y FA(2)1816 1309 y(0)1801 1337
y FF(,)-7 b Fy(!)11 b FF(v)q FI(\)\))150 1443 y(In)j(other)h(w)o(ords,)
g(w)o(e)f(already)g(kno)o(w)g(that)g FF(e)869 1449 y
FA(2)903 1443 y FI(reduces)i(to)e(a)h(v)n(alue,)e(and)h(the)h(question)
g(is)f(really)g(whether)h(it)150 1507 y FH(evaluates)f
FI(to)g(a)g(v)n(alue.)e(F)m(ormally:)355 1613 y Fy(8)p
FF(e)397 1619 y FA(1)416 1613 y FF(;)7 b(e)454 1619 y
FA(2)484 1613 y Fy(2)k FF(E)556 1596 y FA(0)575 1613
y FF(:)c(e)613 1619 y FA(1)643 1613 y Fy(\000)-7 b(!)13
b FF(e)742 1619 y FA(2)773 1613 y FI(=)-7 b Fy(\))11
b FI(\(\()p Fy(9)p FF(v)926 1619 y FA(3)957 1613 y Fy(2)g
FF(V)1029 1596 y FA(0)1048 1613 y FF(:)c(e)1086 1619
y FA(2)1116 1613 y Fy(\000)-7 b(!)1185 1596 y Fs(\003)1216
1613 y FF(v)1236 1619 y FA(3)1254 1613 y FI(\))12 b(=)-7
b Fy(\))11 b FI(\()p Fy(9)p FF(v)j Fy(2)d FF(V)1505 1596
y FA(0)1524 1613 y FF(:)c(e)1562 1619 y FA(2)1607 1586
y(0)1592 1613 y FF(,)-7 b Fy(!)11 b FF(v)q FI(\)\))p
FF(:)150 1719 y FI(In)j(fact,)f(the)i(original)d(assumption)g(is)i(no)g
(longer)f(necessary)m(,)i(and)f(w)o(e)g(will)f(pro)o(v)o(e:)149
1825 y(T1)547 1930 y Fy(8)p FF(e)589 1936 y FA(2)620
1930 y Fy(2)e FF(E)692 1913 y FA(0)711 1930 y FF(:)c
FI(\(\()p Fy(9)p FF(v)805 1936 y FA(3)835 1930 y Fy(2)k
FF(V)908 1913 y FA(0)926 1930 y FF(:)c(e)964 1936 y FA(2)994
1930 y Fy(\000)-7 b(!)1063 1913 y Fs(\003)1094 1930 y
FF(v)1114 1936 y FA(3)1132 1930 y FI(\))12 b(=)-7 b Fy(\))12
b FI(\()p Fy(9)p FF(v)h Fy(2)e FF(V)1383 1913 y FA(0)1402
1930 y FF(:)c(e)1440 1936 y FA(2)1485 1903 y(0)1470 1930
y FF(,)-7 b Fy(!)11 b FF(v)q FI(\)\))p FF(:)150 2036
y FI(No)o(w)j(consider)g(S2.)g(By)g(de\014nition)f(of)g(termination,)f
(it)i(sa)o(ys:)393 2142 y Fy(8)p FF(e)435 2148 y FA(1)454
2142 y FF(;)7 b(e)492 2148 y FA(2)522 2142 y Fy(2)k FF(E)594
2124 y FA(0)613 2142 y FF(:)c(e)651 2148 y FA(1)681 2142
y Fy(\000)-7 b(!)13 b FF(e)780 2148 y FA(2)811 2142 y
FI(=)-7 b Fy(\))11 b FI(\(\()p Fy(9)p FF(v)j Fy(2)d FF(V)1050
2124 y FA(0)1069 2142 y FF(:)c(e)1107 2148 y FA(2)1152
2114 y(0)1137 2142 y FF(,)-7 b Fy(!)11 b FF(v)q FI(\))h(=)-7
b Fy(\))11 b FI(\()p Fy(9)p FF(v)j Fy(2)d FF(V)1467 2124
y FA(0)1486 2142 y FF(:)c(e)1524 2148 y FA(1)1569 2114
y(0)1554 2142 y FF(,)-7 b Fy(!)10 b FF(v)q FI(\)\))p
FF(:)150 2247 y FI(Again,)j(b)o(y)g(the)i(inclusion)e(of)g(ev)n
(aluation)g(in)g(reduction,)h(w)o(e)g(can)g(w)o(eak)o(en:)372
2353 y Fy(8)p FF(e)414 2359 y FA(1)433 2353 y FF(;)7
b(e)471 2359 y FA(2)501 2353 y Fy(2)k FF(E)573 2336 y
FA(0)592 2353 y FF(:)c(e)630 2359 y FA(1)660 2353 y Fy(\000)-7
b(!)13 b FF(e)759 2359 y FA(2)790 2353 y FI(=)-7 b Fy(\))11
b FI(\(\()p Fy(9)p FF(v)j Fy(2)d FF(V)1029 2336 y FA(0)1048
2353 y FF(:)c(e)1086 2359 y FA(2)1116 2353 y Fy(\000)-7
b(!)1185 2335 y Fs(\003)1216 2353 y FF(v)q FI(\))12 b(=)-7
b Fy(\))11 b FI(\()p Fy(9)p FF(v)j Fy(2)d FF(V)1488 2336
y FA(0)1507 2353 y FF(:)c(e)1545 2359 y FA(1)1590 2325
y(0)1575 2353 y FF(,)-7 b Fy(!)10 b FF(v)q FI(\)\))p
FF(:)150 2459 y FI(Giv)o(en)j(the)i(\014rst)f(assumption)f(in)g(this)h
(statemen)o(t)g(w)o(e)g(can)g(also)g(sa)o(y:)372 2564
y Fy(8)p FF(e)414 2570 y FA(1)433 2564 y FF(;)7 b(e)471
2570 y FA(2)501 2564 y Fy(2)k FF(E)573 2547 y FA(0)592
2564 y FF(:)c(e)630 2570 y FA(1)660 2564 y Fy(\000)-7
b(!)13 b FF(e)759 2570 y FA(2)790 2564 y FI(=)-7 b Fy(\))11
b FI(\(\()p Fy(9)p FF(v)j Fy(2)d FF(V)1029 2547 y FA(0)1048
2564 y FF(:)c(e)1086 2570 y FA(1)1116 2564 y Fy(\000)-7
b(!)1185 2547 y Fs(\003)1216 2564 y FF(v)q FI(\))12 b(=)-7
b Fy(\))11 b FI(\()p Fy(9)p FF(v)j Fy(2)d FF(V)1488 2547
y FA(0)1507 2564 y FF(:)c(e)1545 2570 y FA(1)1590 2537
y(0)1575 2564 y FF(,)-7 b Fy(!)10 b FF(v)q FI(\)\))p
FF(;)150 2670 y FI(and)k(w)o(e)g(no)f(longer)h(need)h(the)f(assumption)
f(as)h(it)g(is)f(su\016cien)o(t)i(to)e(sho)o(w:)p eop
%%Page: 112 123
112 122 bop 1862 0 a FB(112)149 192 y FI(T2)565 298 y
Fy(8)p FF(e)607 304 y FA(1)637 298 y Fy(2)11 b FF(E)709
281 y FA(0)728 298 y FF(:)c FI(\(\()p Fy(9)p FF(v)13
b Fy(2)e FF(V)908 281 y FA(0)926 298 y FF(:)c(e)964 304
y FA(1)994 298 y Fy(\000)-7 b(!)1063 280 y Fs(\003)1094
298 y FF(v)q FI(\))12 b(=)-7 b Fy(\))11 b FI(\()p Fy(9)p
FF(v)j Fy(2)d FF(V)1366 281 y FA(0)1385 298 y FF(:)c(e)1423
304 y FA(1)1468 270 y(0)1453 298 y FF(,)-7 b Fy(!)11
b FF(v)q FI(\)\))p FF(:)150 404 y FI(But)j(note)h(that)f(T1)f(and)h(T2)
f(are)i(iden)o(tical)e(goals.)g(They)h(state:)170 510
y(T)593 617 y Fy(8)p FF(e)d Fy(2)h FF(E)719 599 y FA(0)737
617 y FF(:)7 b FI(\(\()p Fy(9)p FF(v)13 b Fy(2)e FF(V)917
599 y FA(0)935 617 y FF(:)c(e)12 b Fy(\000)-7 b(!)1054
599 y Fs(\003)1084 617 y FF(v)q FI(\))13 b(=)-7 b Fy(\))11
b FI(\()p Fy(9)p FF(v)i Fy(2)f FF(V)1357 599 y FA(0)1376
617 y FF(:)7 b(e)1440 589 y FA(0)1425 617 y FF(,)-7 b
Fy(!)11 b FF(v)q FI(\)\))p FF(:)150 723 y FI(This)j(statemen)o(t)g(is)f
(a)h(direct)h(consequence)h(of)d(Lemma)e(6.9.7.)732 b
Fy(u)-28 b(t)150 843 y FI(It)14 b(is)g(easy)g(to)g(sho)o(w)g(that)g
FF(e)591 828 y FA(0)636 816 y(0)621 843 y FF(,)-7 b Fy(!)11
b FF(v)i FI(=)-7 b Fy(\))11 b FF(e)809 828 y FA(0)840
843 y Fy(\000)-7 b(!)909 826 y Fs(\003)939 843 y FF(v)q
FI(,)14 b(as)g(it)g(follo)o(ws)e(directly)i(from)e(the)j(follo)o(wing)c
(result:)150 950 y FG(Lemma)k(6.9.6)h(\(CBN)h FF(\025)p
FG(-M)f(is)f(in)g(CBN)h FF(\025)p FG(-U\))21 b Fy(8)p
FF(n)11 b Fy(2)g Fo(N)p FF(:)c Fy(8)p FF(e)j Fy(2)h FF(E)1290
934 y Ft(n)1312 950 y FF(;)c(v)13 b Fy(2)e FF(V)1437
934 y Ft(n)1459 950 y FF(:)853 1056 y(e)897 1028 y Ft(n)884
1056 y FF(,)-7 b Fy(!)11 b FF(v)i FI(=)-7 b Fy(\))11
b FF(e)h Fy(\000)-7 b(!)1153 1038 y Fs(\003)1184 1056
y FF(v)q(:)150 1166 y FH(Pr)n(o)n(of.)20 b FI(By)14 b(a)g(straigh)o
(tforw)o(ard)f(induction)h(on)f(the)i(heigh)o(t)e(of)h(the)g(judgemen)o
(t)f FF(e)1477 1139 y Ft(n)1464 1166 y FF(,)-7 b Fy(!)11
b FF(v)q FI(.)337 b Fy(u)-28 b(t)150 1287 y FI(What)14
b(is)h(harder)h(to)e(sho)o(w)h(is)g(the)g(\\con)o(v)o(erse",)g(that)g
(is,)f(that)h FF(e)1187 1272 y FA(0)1219 1287 y Fy(\000)-6
b(!)1288 1269 y Fs(\003)1320 1287 y FF(v)15 b FI(=)-7
b Fy(\))13 b FI(\()p Fy(9)p FF(v)1495 1272 y Fs(0)1520
1287 y Fy(2)g FF(V)1595 1272 y FA(0)1613 1287 y FF(:e)1644
1272 y FA(0)1691 1259 y(0)1676 1287 y FF(,)-7 b Fy(!)12
b FF(v)1756 1272 y Fs(0)1768 1287 y FI(\).)j(It)g(is)f(a)150
1361 y(consequence)i(of)e(the)g(follo)o(wing)d(stronger)k(result:)150
1468 y FG(Lemma)g(6.9.7)h(\(CBN)h FF(\025)p FG(-U)e(is)g(in)g(CBN)i
FF(\025)p FG(-M\))k Fy(8)p FF(e)11 b Fy(2)h FF(E)1143
1452 y FA(0)1161 1468 y FF(;)7 b(v)1200 1474 y FA(1)1230
1468 y Fy(2)k FF(V)1303 1452 y FA(0)1321 1468 y FF(:)653
1574 y(e)h Fy(\000)-6 b(!)753 1556 y Fs(\003)784 1574
y FF(v)804 1580 y FA(1)834 1574 y FI(=)f Fy(\))12 b FI(\()p
Fy(9)p FF(v)972 1580 y FA(3)1002 1574 y Fy(2)f FF(V)1075
1557 y FA(0)1093 1574 y FF(:)c(e)1157 1546 y FA(0)1143
1574 y FF(,)-7 b Fy(!)10 b FF(v)1220 1580 y FA(3)1251
1574 y Fy(\000)-7 b(!)1320 1556 y Fs(\003)1350 1574 y
FF(v)1370 1580 y FA(1)1389 1574 y FI(\))p FF(:)150 1684
y FH(Pr)n(o)n(of.)20 b FI(W)m(e)12 b(arriv)o(e)g(at)g(this)g(result)h
(b)o(y)f(an)g(adaptation)g(of)f(Plotkin's)g(pro)q(of)h(for)g(a)g
(similar)e(result)j(for)f(the)g(CBV)150 1749 y(and)i(CBN)g(lam)o(b)q
(da)e(calculi)h([68].)f(The)i(main)e(steps)j(in)f(the)g(dev)o(elopmen)o
(t)f(are:)168 1855 y(1.)20 b(W)m(e)13 b(strengthen)j(our)e(goal)e(to)i
(b)q(ecome:)689 1962 y FF(e)e Fy(\000)-7 b(!)789 1944
y Fs(\003)819 1962 y FF(v)839 1968 y FA(1)869 1962 y
FI(=)g Fy(\))12 b FI(\()p Fy(9)p FF(v)1007 1968 y FA(3)1037
1962 y Fy(2)g FF(V)1110 1944 y FA(0)1129 1962 y FF(:)7
b(e)1193 1934 y FA(0)1178 1962 y FF(,)-7 b Fy(!)11 b
FF(v)1256 1968 y FA(3)1286 1962 y Fy(\000)-7 b(!)1355
1944 y Fs(\003)1385 1962 y FF(v)1405 1968 y FA(1)1424
1962 y FI(\))p FF(:)168 2068 y FI(2.)20 b(W)m(e)d(de\014ne)i(a)e
FH(left)h(r)n(e)n(duction)g(function)907 2044 y Ft(n)883
2068 y Fy(7\000)-6 b(!)17 b FI(\(De\014nition)g(6.9.10\))f(suc)o(h)j
(that)e(\(Lemma)f(6.9.13\):)f Fy(8)p FF(e)j Fy(2)221
2133 y FF(E)254 2118 y FA(0)272 2133 y FF(;)7 b(v)13
b Fy(2)e FF(V)396 2118 y FA(0)415 2133 y FF(:)891 2239
y(e)947 2215 y FA(0)922 2239 y Fy(7\000)-7 b(!)988 2203
y Fs(\003)1019 2239 y FF(v)13 b Fy(\()-7 b(\))11 b FF(e)1185
2211 y FA(0)1171 2239 y FF(,)-7 b Fy(!)10 b FF(v)221
2345 y FI(and)18 b Fy(8)p FF(e)348 2351 y FA(1)367 2345
y FF(;)7 b(e)405 2351 y FA(2)444 2345 y Fy(2)20 b FF(E)525
2330 y FA(0)543 2345 y FF(:)7 b(e)581 2351 y FA(1)645
2322 y(0)620 2345 y Fy(7\000)-7 b(!)20 b FF(e)726 2351
y FA(2)765 2345 y FI(=)-7 b Fy(\))20 b FF(e)871 2351
y FA(1)910 2345 y Fy(\000)-7 b(!)22 b FF(e)1018 2351
y FA(2)1056 2345 y FI(\(Lemma)16 b(6.9.12\).)h(Th)o(us,)i(big-step)g
(ev)n(aluation)f(\(or)221 2410 y(simply)11 b(ev)n(aluation\))i(is)h
(exactly)g(a)f(c)o(hain)h(of)f(left)h(reductions)h(that)f(ends)h(in)e
(a)h(v)n(alue.)168 2475 y(3.)20 b(Our)14 b(goal)f(is)g(restated)j(as:)
669 2581 y FF(e)c Fy(\000)-7 b(!)769 2563 y Fs(\003)799
2581 y FF(v)819 2587 y FA(1)850 2581 y FI(=)g Fy(\))11
b FI(\()p Fy(9)p FF(v)987 2587 y FA(3)1017 2581 y Fy(2)h
FF(V)1090 2564 y FA(0)1109 2581 y FF(:)7 b(e)1183 2557
y FA(0)1158 2581 y Fy(7\000)-7 b(!)1225 2545 y Fs(\003)1255
2581 y FF(v)1275 2587 y FA(3)1306 2581 y Fy(\000)g(!)1375
2563 y Fs(\003)1405 2581 y FF(v)1425 2587 y FA(1)1444
2581 y FI(\))p FF(:)p eop
%%Page: 113 124
113 123 bop 1862 0 a FB(113)168 192 y FI(4.)20 b(F)m(or)13
b(tec)o(hnical)h(reasons,)g(the)h(pro)q(ofs)f(are)g(simpler)e(if)h(w)o
(e)h(use)h(a)f(parallel)e(reduction)j(relation)e Fy(\035)g
FI(\(De\014ni-)221 256 y(tion)h(6.9.14\))g(similar)e(to)j(the)h(one)g
(in)o(tro)q(duced)g(in)e(the)i(last)f(section.)h(Our)f(goal)f(is)h
(once)h(again)e(restated)221 321 y(as:)696 419 y FF(e)e
Fy(\035)769 395 y Fs(\003)799 419 y FF(v)819 425 y FA(1)850
419 y FI(=)-7 b Fy(\))11 b FI(\()p Fy(9)p FF(v)987 425
y FA(3)1017 419 y Fy(2)h FF(V)1090 402 y FA(0)1109 419
y FF(:)7 b(e)1183 396 y FA(0)1158 419 y Fy(7\000)-7 b(!)1225
383 y Fs(\003)1255 419 y FF(v)1275 425 y FA(3)1306 419
y Fy(\035)1347 395 y Fs(\003)1378 419 y FF(v)1398 425
y FA(1)1417 419 y FI(\))p FF(:)168 516 y FI(5.)20 b(The)e(left)g
(reduction)g(function)g(induces)h(a)e(v)o(ery)h(\014ne)h
(classi\014cation)e(on)h(terms)g(\(De\014nition)f(6.9.8\).)f(In)221
580 y(particular,)d(an)o(y)g(term)g FF(e)f Fy(2)f FF(E)704
565 y Ft(n)741 580 y FI(m)o(ust)i(b)q(e)h(exactly)g(one)g(of)g(the)g
(follo)o(wing)d(three)16 b(\(Lemma)11 b(6.9.9\):)217
642 y(\(a\))21 b(a)14 b FH(value)g FF(e)e Fy(2)f FF(V)535
627 y Ft(n)558 642 y FI(,)215 705 y(\(b\))21 b(a)14 b
FH(workable)f FF(e)f Fy(2)f FF(W)610 690 y Ft(n)633 705
y FI(,)i(or)220 768 y(\(c\))21 b(a)14 b FH(stuck)g FF(e)e
Fy(2)f FF(S)528 753 y Ft(n)551 768 y FI(,)221 830 y(where)16
b(mem)o(b)q(ership)e(in)h(eac)o(h)h(of)e(these)j(three)g(sets)f(is)g
(de\014ned)g(inductiv)o(ely)f(o)o(v)o(er)g(the)h(structure)i(of)c(the)
221 895 y(term.)i(W)m(e)h(write)h FF(v)541 879 y Ft(n)565
895 y FF(;)7 b(w)615 879 y Ft(n)654 895 y FI(and)18 b
FF(s)758 879 y Ft(n)798 895 y FI(to)g(refer)h(to)e(a)h(mem)o(b)q(er)e
(of)h(one)h(of)f(the)h(three)h(sets)g(ab)q(o)o(v)o(e,)e(resp)q(ec-)221
959 y(tiv)o(ely)m(.)g(Left)i(reduction)g(at)g(lev)o(el)g
FF(n)f FI(is)h(a)g(total)f(function)g(exactly)h(on)g(the)g(mem)o(b)q
(ers)f(of)g(the)i(set)f FF(W)1897 944 y Ft(n)221 1024
y FI(\(Lemma)12 b(6.9.11\).)h(Th)o(us,)h(left)h(reduction)h(is)e
(strictly)i(unde\014ned)g(on)f(non-w)o(ork)n(ables,)e(that)i(is,)g(it)f
(is)h(un-)221 1089 y(de\014ned)g(on)f(v)n(alues)f(and)h(on)g(stuc)o(k)h
(terms.)e(F)m(urthermore,)h(if)f(the)i(result)g(of)e(an)o(y)h(parallel)
f(reduction)h(is)g(a)221 1154 y(v)n(alue,)g(the)i(source)g(m)o(ust)f
(ha)o(v)o(e)g(b)q(een)h(either)h(a)e(v)n(alue)f(or)i(a)f(w)o(ork)n
(able)f(\(Lemma)f(6.9.15\).)g(W)m(e)i(will)f(refer)221
1218 y(to)f(this)h(prop)q(ert)o(y)h(of)e(parallel)g(reduction)i(as)f
FH(monotonicity)p FI(.)168 1281 y(6.)20 b(Using)d(the)h(ab)q(o)o(v)o(e)
f(classi\014cation,)g(w)o(e)h(break)f(our)h(goal)e(in)o(to)h(t)o(w)o(o)
g(cases,)h(dep)q(ending)g(on)g(whether)g(the)221 1346
y(starting)13 b(p)q(oin)o(t)h(is)g(a)f(v)n(alue)g(or)h(a)g(w)o(ork)n
(able:)217 1408 y(G1)20 b Fy(8)p FF(v)334 1414 y FA(1)353
1408 y FF(;)7 b(v)13 b Fy(2)e FF(V)477 1393 y FA(0)496
1408 y FF(:)756 1506 y(v)i Fy(\035)831 1481 y Fs(\003)861
1506 y FF(v)881 1512 y FA(1)912 1506 y FI(=)-7 b Fy(\))11
b FI(\()p Fy(9)p FF(v)1049 1512 y FA(3)1080 1506 y Fy(2)g
FF(V)1152 1489 y FA(0)1171 1506 y FF(:)c(v)12 b FI(=)g
FF(v)1286 1512 y FA(3)1316 1506 y Fy(\035)1358 1481 y
Fs(\003)1389 1506 y FF(v)1409 1512 y FA(1)1427 1506 y
FI(\))p FF(;)217 1602 y FI(G2)20 b Fy(8)p FF(w)13 b Fy(2)e
FF(W)441 1587 y FA(0)459 1602 y FF(;)c(v)13 b Fy(2)e
FF(V)584 1587 y FA(0)602 1602 y FF(:)716 1701 y(w)h Fy(\035)800
1676 y Fs(\003)830 1701 y FF(v)850 1707 y FA(1)881 1701
y FI(=)-7 b Fy(\))11 b FI(\()p Fy(9)p FF(v)1018 1707
y FA(3)1048 1701 y Fy(2)h FF(V)1121 1683 y FA(0)1140
1701 y FF(:)7 b(w)1226 1677 y FA(0)1201 1701 y Fy(7\000)-7
b(!)1267 1664 y FA(+)1307 1701 y FF(v)1327 1707 y FA(3)1357
1701 y Fy(\035)1398 1676 y Fs(\003)1429 1701 y FF(v)1449
1707 y FA(1)1468 1701 y FI(\))p FF(:)221 1797 y FI(It)14
b(is)f(ob)o(vious)g(that)h(G1)g(is)f(true.)i(Th)o(us,)e(G2)g(b)q
(ecomes)i(the)f(curren)o(t)h(goal.)168 1860 y(7.)20 b(By)d(the)i
(monotonicit)o(y)c(of)i(parallel)f(reduction,)i(it)f(is)h(clear)g(that)
f(all)g(the)h(in)o(termediate)f(terms)g(in)g(the)221
1925 y(reduction)f(c)o(hain)f FF(w)549 1910 y FA(0)582
1925 y Fy(\035)623 1900 y Fs(\003)657 1925 y FF(v)678
1910 y FA(0)677 1935 y(1)712 1925 y FI(are)h(either)h(w)o(ork)n(ables)e
(or)g(v)n(alues.)g(F)m(urthermore,)g(w)o(ork)n(ables)g(and)g(v)n(alues)
221 1990 y(do)h(not)h(in)o(terlea)o(v)o(e,)f(and)h(there)h(is)e
(exactly)h(one)g(transition)g(from)e(w)o(ork)n(ables)h(to)h(v)n(alues)f
(in)g(the)i(c)o(hain.)221 2055 y(Th)o(us,)13 b(this)h(c)o(hain)g(can)g
(b)q(e)g(visualized)g(as)g(follo)o(ws:)715 2153 y FF(w)746
2136 y FA(0)745 2163 y(1)776 2153 y Fy(\035)d FF(w)860
2136 y FA(0)859 2163 y(2)890 2153 y Fy(\035)g FF(:::w)1010
2136 y FA(0)1009 2163 y Ft(k)q Fs(\000)p FA(1)1082 2153
y Fy(\035)g FF(w)1166 2136 y FA(0)1165 2163 y Ft(k)1197
2153 y Fy(\035)g FF(v)1271 2136 y FA(0)1302 2153 y Fy(\035)1343
2128 y Fs(\003)1374 2153 y FF(v)1395 2136 y FA(0)1394
2163 y(1)1414 2153 y FF(:)221 2251 y FI(W)m(e)i(pro)o(v)o(e)h(that)g
(the)g(transition)g FF(w)786 2236 y FA(0)785 2263 y Ft(k)817
2251 y Fy(\035)d FF(v)891 2236 y FA(0)924 2251 y FI(can)j(b)q(e)g
(replaced)h(b)o(y)f(an)f(ev)n(aluation)g(\(Lemma)e(6.9.18\):)219
2312 y(R1)20 b Fy(8)p FF(w)13 b Fy(2)e FF(W)441 2297
y FA(0)459 2312 y FF(;)c(v)13 b Fy(2)e FF(V)584 2297
y FA(0)602 2312 y FF(:)752 2411 y(w)h Fy(\035)f FF(v)j
FI(=)-7 b Fy(\))11 b FI(\()p Fy(9)p FF(v)1018 2417 y
FA(2)1048 2411 y Fy(2)h FF(V)1121 2393 y FA(0)1140 2411
y FF(:)7 b(w)1226 2387 y FA(0)1201 2411 y Fy(7\000)-7
b(!)1267 2374 y FA(+)1307 2411 y FF(v)1327 2417 y FA(2)1357
2411 y Fy(\035)11 b FF(v)q FI(\))p FF(:)221 2507 y FI(With)j(this)h
(lemma,)d(w)o(e)j(kno)o(w)f(that)i(w)o(e)f(can)g(replace)h(the)g(c)o
(hain)f(ab)q(o)o(v)o(e)f(b)o(y)h(one)g(where)i(the)e(ev)n(aluation)221
2572 y(in)o(v)o(olv)o(ed)d(in)i(going)e(from)g(the)j(last)f(w)o(ork)n
(able)f(to)g(the)i(\014rst)g(v)n(alue)e(is)g(explicit:)689
2670 y FF(w)720 2653 y FA(0)719 2680 y(1)750 2670 y Fy(\035)e
FF(w)834 2653 y FA(0)833 2680 y(2)864 2670 y Fy(\035)g
FF(:::w)984 2653 y FA(0)983 2680 y Ft(k)q Fs(\000)p FA(1)1056
2670 y Fy(\035)g FF(w)1140 2653 y FA(0)1139 2680 y Ft(k)1195
2646 y FA(0)1170 2670 y Fy(7\000)-6 b(!)1237 2634 y FA(+)1276
2670 y FF(v)1297 2653 y FA(0)1296 2680 y(2)1328 2670
y Fy(\035)1369 2645 y Fs(\003)1400 2670 y FF(v)1421 2653
y FA(0)1420 2680 y(1)1440 2670 y FF(:)p eop
%%Page: 114 125
114 124 bop 1862 0 a FB(114)221 192 y FI(What)11 b(is)g(left)g(is)h
(then)g(to)f(\\push)h(bac)o(k")g(this)f(information)e(ab)q(out)i(the)h
(last)g(w)o(ork)n(able)e(in)i(the)g(c)o(hain)f(to)g(the)221
256 y(v)o(ery)j(\014rst)h(w)o(ork)n(able)f(in)g(the)h(c)o(hain.)f(This)
g(is)g(ac)o(hiev)o(ed)h(b)o(y)f(a)g(straigh)o(tforw)o(ard)g(iteration)g
(\(b)o(y)g(induction)221 321 y(o)o(v)o(er)f(the)i(n)o(um)o(b)q(er)e(of)
g FF(k)i FI(of)e(w)o(ork)n(ables)h(in)f(the)i(c)o(hain\))e(of)h(a)f
(result)i(that)f(w)o(e)g(pro)o(v)o(e)g(\(Lemma)d(6.9.20\):)219
384 y(R2)20 b Fy(8)p FF(w)344 390 y FA(1)363 384 y FF(;)7
b(w)412 390 y FA(2)441 384 y Fy(2)k FF(W)525 369 y FA(0)544
384 y FF(;)c(v)583 390 y FA(1)612 384 y Fy(2)12 b FF(V)685
369 y FA(0)704 384 y FF(:)634 487 y(w)664 493 y FA(1)694
487 y Fy(\035)f FF(w)777 493 y FA(2)832 463 y(0)807 487
y Fy(7\000)-6 b(!)874 450 y FA(+)913 487 y FF(v)933 493
y FA(1)963 487 y FI(=)f Fy(\))12 b FI(\()p Fy(9)p FF(v)1101
493 y FA(2)1131 487 y Fy(2)g FF(V)1204 469 y FA(0)1223
487 y FF(:)7 b(w)1272 493 y FA(1)1326 463 y(0)1301 487
y Fy(7\000)-7 b(!)1368 450 y FA(+)1407 487 y FF(v)1427
493 y FA(2)1457 487 y Fy(\035)11 b FF(v)1530 493 y FA(1)1549
487 y FI(\))p FF(:)221 588 y FI(With)j(this)h(result,)h(w)o(e)f(are)g
(able)g(to)g(mo)o(v)o(e)f(the)h(predicate)p 1178 588
13 2 v 1229 565 a FA(0)1204 588 y Fy(7\000)-7 b(!)1271
552 y FA(+)1312 588 y FF(v)1333 573 y FA(0)1332 599 y(3)1366
588 y Fy(\035)1407 564 y Fs(\003)1440 588 y FF(v)1461
573 y FA(0)1495 588 y FI(all)14 b(the)i(w)o(a)o(y)e(bac)o(k)h(to)g(the)
221 653 y(\014rst)f(w)o(ork)n(able)f(in)h(the)g(c)o(hain.)f(This)h
(step)g(can)g(b)q(e)h(visualized)e(as)h(follo)o(ws.)e(With)h(one)h
(application)e(of)i(R2)221 718 y(w)o(e)g(ha)o(v)o(e)f(the)i(c)o(hain:)
746 820 y FF(w)777 803 y FA(0)776 830 y(1)807 820 y Fy(\035)c
FF(w)891 803 y FA(0)890 830 y(2)921 820 y Fy(\035)g FF(:::w)1041
803 y FA(0)1040 830 y Ft(k)q Fs(\000)p FA(1)1138 797
y(0)1113 820 y Fy(7\000)-7 b(!)1180 784 y FA(+)1219 820
y FF(v)1240 803 y FA(0)1239 830 y(3)1271 820 y Fy(\035)1312
796 y Fs(\003)1343 820 y FF(v)1364 803 y FA(0)1363 830
y(1)1383 820 y FF(;)221 923 y FI(and)13 b(with)h FF(k)c
Fy(\000)f FI(2)14 b(applications)f(of)g(R2)g(w)o(e)h(ha)o(v)o(e:)878
1025 y FF(w)909 1008 y FA(0)908 1035 y(1)964 1001 y(0)939
1025 y Fy(7\000)-7 b(!)1006 989 y FA(+)1045 1025 y FF(v)1066
1008 y FA(0)1065 1035 y Ft(k)q FA(+1)1139 1025 y Fy(\035)1180
1000 y Fs(\003)1211 1025 y FF(v)1232 1008 y FA(0)1231
1035 y(1)1251 1025 y FF(;)221 1127 y FI(th)o(us)14 b(completing)e(the)j
(pro)q(of.)1892 1200 y Fy(u)-28 b(t)150 1317 y FI(In)16
b(the)g(rest)h(of)e(this)g(section,)h(w)o(e)g(presen)o(t)h(the)g
(de\014nitions)e(and)h(lemmas)d(men)o(tioned)h(ab)q(o)o(v)o(e.)h(It)h
(should)f(b)q(e)150 1392 y(noted)d(that)h(pro)o(ving)e(most)g(of)g(the)
i(lemmas)c(men)o(tioned)i(ab)q(o)o(v)o(e)h(require)h(generalizing)e
(the)i(lev)o(el)f(from)e(0)i(to)g FF(n)p FI(.)150 1466
y(In)f(the)g(rest)h(of)e(the)h(dev)o(elopmen)o(t,)f(w)o(e)h(presen)o(t)
h(the)f(generalized)h(forms,)d(whic)o(h)h(can)h(b)q(e)g(trivially)e
(instan)o(tiated)150 1541 y(to)14 b(the)g(statemen)o(ts)g(men)o(tioned)
f(ab)q(o)o(v)o(e.)150 1686 y FG(6.9.1)48 b(A)16 b(Basic)f
(Classi\014cation)e(of)j(T)l(erms)150 1789 y(De\014nitio)o(n)d(6.9.8)j
(\(Classes\))j FH(We)12 b(de\014ne)g(thr)n(e)n(e)f(judgements)h(on)g(r)
n(aw)f(\(that)g(is,)g(typ)n(e-fr)n(e)n(e\))f(classes:)h(V)m(alues)150
1854 y FF(V)183 1839 y Ft(n)206 1854 y FH(,)k(Workables)g
FF(W)480 1839 y Ft(n)502 1854 y FH(,)g(and)h(Stuck)f(terms)f
FF(S)866 1839 y Ft(n)890 1854 y FH(.)g(The)h(four)g(sets)f(ar)n(e)h
(de\014ne)n(d)h(as)f(fol)r(lows:)296 1949 y FF(v)317
1934 y FA(0)412 1949 y Fy(2)c FF(V)485 1934 y FA(0)581
1949 y FI(:=)h FF(\025x:e)716 1934 y FA(0)746 1949 y
Fy(j)f(h)p FF(v)806 1934 y FA(1)825 1949 y Fy(i)296 2014
y FF(v)317 1999 y FA(1)412 2014 y Fy(2)g FF(V)485 1999
y FA(1)581 2014 y FI(:=)h FF(x)f Fy(j)g FF(\025x:v)776
1999 y FA(1)806 2014 y Fy(j)g FF(v)850 1999 y FA(1)870
2014 y FF(v)891 1999 y FA(1)921 2014 y Fy(j)g(h)q FF(v)982
1999 y FA(2)1001 2014 y Fy(i)h(j)f FE(run)h FF(v)1141
1999 y FA(1)296 2078 y FF(v)317 2063 y Ft(n)p FA(++)412
2078 y Fy(2)f FF(V)485 2063 y Ft(n)p FA(++)581 2078 y
FI(:=)h FF(x)f Fy(j)g FF(\025x:v)776 2063 y Ft(n)p FA(++)861
2078 y Fy(j)g FF(v)905 2063 y Ft(n)p FA(++)980 2078 y
FF(v)1001 2063 y Ft(n)p FA(++)1086 2078 y Fy(j)g(h)p
FF(v)1146 2063 y Ft(n)p FA(+++)1246 2078 y Fy(i)h(j)g
FE(~)q FF(v)1341 2063 y Ft(n)p FA(+)1401 2078 y Fy(j)f
FE(run)i FF(v)1514 2063 y Ft(n)p FA(++)296 2143 y FF(w)327
2128 y FA(0)412 2143 y Fy(2)e FF(W)496 2128 y FA(0)581
2143 y FI(:=)h(\()p FF(\025x:e)732 2128 y FA(0)750 2143
y FI(\))g FF(e)797 2128 y FA(0)828 2143 y Fy(j)f FF(w)882
2128 y FA(0)912 2143 y FF(e)931 2128 y FA(0)961 2143
y Fy(j)g FE(run)i Fy(h)p FF(e)1088 2128 y FA(0)1107 2143
y Fy(i)f(j)f FE(run)h FF(w)1257 2128 y FA(0)1287 2143
y Fy(j)f(h)p FF(w)1357 2128 y FA(1)1376 2143 y Fy(i)296
2208 y FF(w)327 2193 y FA(1)412 2208 y Fy(2)g FF(W)496
2193 y FA(1)581 2208 y FI(:=)h FF(\025x:w)728 2193 y
FA(1)757 2208 y Fy(j)f FF(w)811 2193 y FA(1)841 2208
y FF(e)860 2193 y FA(1)891 2208 y Fy(j)g FF(v)935 2193
y FA(1)966 2208 y FF(w)997 2193 y FA(1)1027 2208 y Fy(j)g(h)p
FF(w)1097 2193 y FA(2)1115 2208 y Fy(i)h(j)g FE(~)q FF(w)1220
2193 y FA(0)1250 2208 y Fy(j)g FE(~)q Fy(h)p FF(e)1331
2193 y FA(0)1350 2208 y Fy(i)296 2273 y FF(w)327 2258
y Ft(n)p FA(++)412 2273 y Fy(2)f FF(W)496 2258 y Ft(n)p
FA(++)581 2273 y FI(:=)h FF(\025x:w)728 2258 y Ft(n)p
FA(++)812 2273 y Fy(j)f FF(w)866 2258 y Ft(n)p FA(++)951
2273 y FF(e)970 2258 y Ft(n)p FA(++)1056 2273 y Fy(j)g
FF(v)1100 2258 y Ft(n)p FA(++)1185 2273 y FF(w)1216 2258
y Ft(n)p FA(++)1301 2273 y Fy(j)g(h)q FF(w)1372 2258
y Ft(n)p FA(+++)1470 2273 y Fy(i)h(j)g FE(~)q FF(w)1575
2258 y Ft(n)p FA(+)296 2337 y FF(s)315 2322 y FA(0)412
2337 y Fy(2)f FF(S)478 2322 y FA(0)581 2337 y FI(:=)h
FF(x)f Fy(j)g FF(s)714 2322 y FA(0)745 2337 y FF(e)764
2322 y FA(0)794 2337 y Fy(j)g(h)p FF(v)854 2322 y FA(1)874
2337 y Fy(i)g FF(e)920 2322 y FA(0)951 2337 y Fy(j)g(h)p
FF(s)1009 2322 y FA(1)1028 2337 y Fy(i)h(j)f FE(run)h
FF(\025x:e)1226 2322 y FA(0)1256 2337 y Fy(j)f FE(run)i
FF(s)1367 2322 y FA(0)296 2402 y FF(s)315 2387 y FA(1)412
2402 y Fy(2)e FF(S)478 2387 y FA(1)581 2402 y FI(:=)h
FF(\025x:s)716 2387 y FA(1)746 2402 y Fy(j)f FF(s)788
2387 y FA(1)819 2402 y FF(e)838 2387 y FA(1)868 2402
y Fy(j)g FF(v)912 2387 y FA(1)943 2402 y FF(s)962 2387
y FA(1)992 2402 y Fy(j)h(h)p FF(s)1051 2387 y FA(2)1070
2402 y Fy(i)f(j)i FE(~)q FF(s)1163 2387 y FA(0)1193 2402
y Fy(j)f FE(~)q FF(\025x:e)1318 2387 y FA(0)1348 2402
y Fy(j)f FE(run)i FF(s)1459 2387 y FA(1)296 2467 y FF(s)315
2452 y Ft(n)p FA(++)412 2467 y Fy(2)e FF(S)478 2452 y
Ft(n)p FA(++)581 2467 y FI(:=)h FF(\025x:s)716 2452 y
Ft(n)p FA(++)801 2467 y Fy(j)f FF(s)843 2452 y Ft(n)p
FA(++)928 2467 y FF(e)947 2452 y Ft(n)p FA(++)1033 2467
y Fy(j)g FF(v)1077 2452 y Ft(n)p FA(++)1163 2467 y FF(s)1182
2452 y Ft(n)p FA(++)1267 2467 y Fy(j)g(h)p FF(s)1325
2452 y Ft(n)p FA(+++)1425 2467 y Fy(i)h(j)g FE(~)q FF(s)1518
2452 y Ft(n)p FA(+)1578 2467 y Fy(j)f FE(run)h FF(s)1688
2452 y Ft(n)p FA(++)1762 2467 y FF(:)150 2568 y FG(Lemma)j(6.9.9)h
(\(Basic)f(Prop)q(erties)e(of)j(Classes\))j Fy(8)p FF(n)12
b Fy(2)f Fo(N)p FF(:)166 2670 y FH(1.)21 b FF(V)254 2655
y Ft(n)277 2670 y FF(;)7 b(W)341 2655 y Ft(n)363 2670
y FF(;)g(S)409 2655 y Ft(n)443 2670 y Fy(\022)12 b FF(E)520
2655 y Ft(n)p eop
%%Page: 115 126
115 125 bop 1862 0 a FB(115)166 192 y FH(2.)21 b FF(V)254
176 y Ft(n)277 192 y FF(;)7 b(W)341 176 y Ft(n)363 192
y FF(;)g(S)409 176 y Ft(n)446 192 y FH(p)n(artition)15
b FF(E)650 176 y Ft(n)672 192 y FH(.)150 300 y(Pr)n(o)n(of.)20
b FI(All)13 b(these)i(prop)q(erties)h(are)e(easy)g(to)g(pro)o(v)o(e)g
(b)o(y)g(straigh)o(tforw)o(ard)f(induction.)168 404 y(1.)20
b(W)m(e)15 b(v)o(erify)h(the)h(claim)c(for)j(eac)o(h)h(case)g
(separately)m(,)f(b)o(y)g(induction)f(on)h FF(e)g Fy(2)f
FF(V)1475 389 y Ft(n)1498 404 y FI(,)g FF(e)h Fy(2)f
FF(W)1648 389 y Ft(n)1670 404 y FI(,)h(and)g FF(e)f Fy(2)g
FF(S)1885 389 y Ft(n)1908 404 y FI(,)221 469 y(resp)q(ectiv)o(ely)m(.)
168 533 y(2.)20 b(W)m(e)e(pro)o(v)o(e)g(that,)g FF(e)i
Fy(2)f FF(E)638 518 y Ft(n)679 533 y FI(is)f(in)g(exactly)g(one)h(of)f
(the)h(three)h(sets)g FF(V)1364 518 y Ft(n)1387 533 y
FF(;)7 b(W)1451 518 y Ft(n)1491 533 y FI(or)18 b FF(S)1573
518 y Ft(n)1597 533 y FI(.)g(The)h(pro)q(of)f(is)g(b)o(y)221
598 y(induction)13 b(on)h(the)g(judgemen)o(t)f FF(e)f
Fy(2)f FF(W)852 583 y Ft(n)875 598 y FI(.)i(This)h(pro)q(of)f(is)h
(direct)h(alb)q(eit)e(tedious.)1892 671 y Fy(u)-28 b(t)150
817 y FG(6.9.2)48 b(Left)15 b(Reduction)150 932 y FI(The)f(notion)f(of)
h(left)f(reduction)i(is)f(in)o(tended)g(to)g(capture)h(precisely)g(the)
f(reductions)h(p)q(erformed)f(b)o(y)f(the)i(big-)150
1007 y(step)h(seman)o(tics,)d(in)h(a)h(small-step)e(manner.)g(Note)i
(that)g(the)g(simplicit)o(y)d(of)i(the)h(de\014nition)g(dep)q(ends)h
(on)e(the)150 1081 y(fact)f(that)h(the)g(partial)e(function)h(b)q(eing)
g(de\014ned)h(is)g FH(not)j FI(de\014ned)d(on)g(v)n(alues.)e(That)h
(is,)g(w)o(e)g(exp)q(ect)i(that)f(there)150 1156 y(is)g(no)f
FF(e)i FI(suc)o(h)f(that)g FF(v)487 1141 y Ft(n)545 1133
y(n)522 1156 y Fy(7\000)-7 b(!)11 b FF(e)p FI(.)150 1269
y FG(De\014nitio)o(n)i(6.9.10)j(\(Left)e(Reduction\))k
FH(L)n(eft)g(r)n(e)n(duction)h(is)f(a)h(p)n(artial)f(function)p
1549 1269 13 2 v 1603 1245 a Ft(n)1580 1269 y Fy(7\000)-6
b(!)p 1668 1269 V 52 w FI(:)18 b FF(E)1763 1254 y Ft(n)1804
1269 y Fy(!)g FF(E)1897 1254 y Ft(n)150 1333 y FH(de\014ne)n(d)e(as)f
(fol)r(lows:)166 1466 y(1.)p 240 1457 480 2 v 246 1508
a FI(\()p FF(\025x:v)343 1493 y FA(1)342 1518 y(1)362
1508 y FI(\))d FF(v)411 1493 y FA(1)410 1518 y(2)467
1484 y(0)441 1508 y Fy(7\000)-6 b(!)11 b FF(v)541 1493
y FA(1)540 1518 y(1)560 1508 y FI([)p FF(x)g FI(:=)g
FF(v)683 1493 y FA(1)682 1518 y(2)703 1508 y FI(])166
1612 y FH(2.)p 240 1603 283 2 v 246 1654 a FE(run)i Fy(h)p
FF(v)352 1639 y FA(1)371 1654 y Fy(i)424 1630 y FA(0)399
1654 y Fy(7\000)-7 b(!)11 b FF(v)498 1639 y FA(1)166
1758 y FH(3.)p 240 1749 238 2 v 247 1800 a FE(~)q Fy(h)p
FF(v)306 1785 y FA(1)326 1800 y Fy(i)378 1776 y FA(1)353
1800 y Fy(7\000)-6 b(!)11 b FF(v)453 1785 y FA(1)166
1904 y FH(4.)306 1869 y FF(e)347 1845 y Ft(n)p FA(+)337
1869 y Fy(7\000)-7 b(!)11 b FF(e)434 1854 y Fs(0)p 240
1895 271 2 v 246 1946 a FF(\025x:e)347 1922 y Ft(n)p
FA(+)337 1946 y Fy(7\000)-7 b(!)11 b FF(\025x:e)494 1930
y Fs(0)166 2050 y FH(5.)296 2014 y FF(e)315 2020 y FA(1)368
1990 y Ft(n)345 2014 y Fy(7\000)-6 b(!)11 b FF(e)443
1999 y Fs(0)443 2024 y FA(1)p 240 2040 277 2 v 246 2091
a FF(e)265 2097 y FA(1)296 2091 y FF(e)315 2097 y FA(2)368
2067 y Ft(n)345 2090 y Fy(7\000)-6 b(!)424 2091 y FF(e)443
2075 y Fs(0)443 2101 y FA(1)473 2091 y FF(e)492 2097
y FA(2)166 2195 y FH(6.)327 2160 y FF(e)346 2166 y FA(2)387
2136 y Ft(n)p FA(+)377 2159 y Fy(7\000)f(!)455 2160 y
FF(e)474 2144 y Fs(0)474 2170 y FA(2)p 240 2185 340 2
v 246 2236 a FF(v)267 2218 y Ft(n)p FA(+)266 2247 y(1)327
2236 y FF(e)346 2242 y FA(2)387 2212 y Ft(n)p FA(+)377
2236 y Fy(7\000)g(!)11 b FF(v)476 2218 y Ft(n)p FA(+)475
2247 y(1)537 2236 y FF(e)556 2221 y Fs(0)556 2246 y FA(2)166
2340 y FH(7.)278 2305 y FF(e)320 2281 y Ft(n)p FA(+)309
2305 y Fy(7\000)-6 b(!)11 b FF(e)407 2290 y Fs(0)p 240
2331 217 2 v 246 2382 a Fy(h)p FF(e)p Fy(i)333 2358 y
Ft(n)309 2381 y Fy(7\000)-6 b(!)388 2382 y(h)p FF(e)423
2366 y Fs(0)435 2382 y Fy(i)166 2485 y FH(8.)269 2450
y FF(e)323 2426 y Ft(n)300 2450 y Fy(7\000)g(!)11 b FF(e)398
2435 y Fs(0)p 240 2476 198 2 v 247 2527 a FE(~)q FF(e)311
2503 y Ft(n)p FA(+)300 2526 y Fy(7\000)-6 b(!)380 2527
y FE(~)q FF(e)421 2511 y Fs(0)166 2631 y FH(9.)315 2595
y FF(e)369 2571 y Ft(n)346 2595 y Fy(7\000)f(!)11 b FF(e)443
2580 y Fs(0)p 240 2621 290 2 v 246 2672 a FE(run)i FF(e)369
2648 y Ft(n)346 2671 y Fy(7\000)-7 b(!)424 2672 y FE(run)13
b FF(e)512 2656 y Fs(0)549 2631 y FH(.)p eop
%%Page: 116 127
116 126 bop 1862 0 a FB(116)150 192 y FI(The)13 b(follo)o(wing)e(lemma)
e(sa)o(ys)k(that)g(the)h(set)g(of)e(w)o(ork)n(ables)g(c)o(haracterizes)
k(exactly)d(the)g(set)h(of)e(terms)h(that)g(can)150 266
y(b)q(e)i(adv)n(anced)f(b)o(y)f(left)h(reduction.)150
381 y FG(Lemma)h(6.9.11)h(\(Left)e(Reduction)f(and)j(Classes\))j
Fy(8)p FF(n)12 b Fy(2)f Fo(N)p FF(:)166 487 y FH(1.)21
b Fy(8)p FF(w)12 b Fy(2)f FF(W)370 472 y Ft(n)393 487
y FF(:)c FI(\()p Fy(9)p FF(e)470 472 y Fs(0)493 487 y
Fy(2)k FF(E)565 472 y Ft(n)588 487 y FF(:)c(w)672 464
y Ft(n)649 487 y Fy(7\000)-7 b(!)11 b FF(e)746 472 y
Fs(0)758 487 y FI(\))166 552 y FH(2.)21 b Fy(8)p FF(e)11
b Fy(2)h FF(E)347 537 y Ft(n)369 552 y FF(:)7 b FI(\()p
Fy(9)p FF(e)446 537 y Fs(0)469 552 y Fy(2)12 b FF(E)542
537 y Ft(n)564 552 y FF(:)7 b(e)637 528 y Ft(n)614 552
y Fy(7\000)-7 b(!)11 b FF(e)711 537 y Fs(0)723 552 y
FI(\))h(=)-7 b Fy(\))11 b FF(e)h Fy(2)f FF(W)944 537
y Ft(n)166 617 y FH(3.)21 b Fy(8)p FF(v)13 b Fy(2)e FF(V)349
602 y Ft(n)372 617 y FF(:)c Fy(:)p FI(\()p Fy(9)p FF(e)477
602 y Fs(0)500 617 y Fy(2)k FF(E)572 602 y Ft(n)595 617
y FF(:)c(v)669 593 y Ft(n)646 617 y Fy(7\000)-6 b(!)11
b FF(e)744 602 y Fs(0)756 617 y FI(\))166 681 y FH(4.)21
b Fy(8)p FF(s)12 b Fy(2)f FF(S)341 666 y Ft(n)364 681
y FF(:)c Fy(:)p FI(\()p Fy(9)p FF(e)469 666 y Fs(0)492
681 y Fy(2)k FF(E)564 666 y Ft(n)587 681 y FF(:)c(s)660
658 y Ft(n)636 681 y Fy(7\000)-6 b(!)11 b FF(e)734 666
y Fs(0)746 681 y FI(\))p FF(:)150 792 y FH(Pr)n(o)n(of.)20
b FI(W)m(e)12 b(only)g(need)h(to)g(pro)o(v)o(e)f(the)h(\014rst)g(t)o(w)
o(o,)f(and)g(the)h(second)h(t)o(w)o(o)e(follo)o(w.)e(The)j(\014rst)g
(one)g(is)f(b)o(y)g(straigh)o(t-)150 857 y(forw)o(ard)i(induction)h(on)
f(the)i(judgemen)o(t)e FF(e)f Fy(2)g FF(W)942 841 y Ft(n)965
857 y FI(.)h(The)h(second)h(is)f(also)f(b)o(y)g(straigh)o(tforw)o(ard)h
(induction)f(on)150 921 y(the)g(deriv)n(ation)f FF(e)435
906 y Ft(n)493 898 y(n)470 921 y Fy(7\000)-7 b(!)11 b
FF(e)567 906 y Fs(0)579 921 y FI(.)1301 b Fy(u)-28 b(t)150
1036 y FG(Lemma)15 b(6.9.12)h(\(Left)e(Reduction)f(and)j(CBN)g
FF(\025)p FG(-U\))21 b Fy(8)p FF(n)11 b Fy(2)g Fo(N)p
FF(:)c Fy(8)p FF(e)1327 1042 y FA(1)1344 1036 y FF(;)g(e)1382
1042 y FA(2)1412 1036 y Fy(2)k FF(E)1484 1021 y Ft(n)1506
1036 y FF(:)817 1142 y(e)836 1148 y FA(1)890 1119 y Ft(n)867
1142 y Fy(7\000)-7 b(!)11 b FF(e)964 1148 y FA(2)995
1142 y FI(=)-7 b Fy(\))11 b FF(e)1092 1148 y FA(1)1123
1142 y Fy(\000)-7 b(!)13 b FF(e)1222 1148 y FA(2)1241
1142 y FF(:)150 1253 y FH(Pr)n(o)n(of.)20 b FI(By)14
b(straigh)o(tforw)o(ard)g(induction)f(on)h(the)g(\014rst)h(judgemen)o
(t.)653 b Fy(u)-28 b(t)150 1367 y FG(Lemma)15 b(6.9.13)h(\(Left)e
(Reduction)f(and)j FF(\025)p FG(-M\))k Fy(8)p FF(n)12
b Fy(2)f Fo(N)p FF(:)c Fy(8)p FF(e)i Fy(2)j FF(E)1296
1352 y Ft(n)1318 1367 y FF(;)7 b(v)13 b Fy(2)e FF(V)1443
1352 y Ft(n)1465 1367 y FF(:)827 1473 y(e)881 1450 y
Ft(n)858 1473 y Fy(7\000)-7 b(!)925 1443 y Fs(\003)955
1473 y FF(v)14 b Fy(\()-7 b(\))10 b FF(e)1095 1456 y
Ft(n)1142 1446 y(n)1130 1473 y FF(,)-7 b Fy(!)10 b FF(v)1208
1456 y Ft(n)1231 1473 y FF(:)150 1584 y FH(Pr)n(o)n(of.)20
b FI(The)d(forw)o(ard)f(direction)h(is)g(b)o(y)f(induction)h(on)f(the)h
(length)g(of)f(the)h(deriv)n(ation,)f(and)g(then)i(o)o(v)o(er)e(the)150
1649 y(size)d(of)f FF(e)p FI(.)g(The)g(second)i(ordering)e(is)g(not)g
(needed)i(in)e(the)g(lam)o(b)q(da)e(calculus,)i(but)h(is)f(needed)h
(for)f(ev)n(aluation)f(at)150 1713 y(higher)i(lev)o(els.)g(The)g(pro)q
(of)g(pro)q(ceeds)i(b)o(y)e(a)f(case)i(analysis)f(on)f(the)i(\014rst)g
(left)f(reduction)g(in)g(the)g(left)g(reduction)150 1778
y(c)o(hain.)i(The)h(bac)o(kw)o(ard)g(direction)g(is)f(b)o(y)h(straigh)o
(tforw)o(ard)f(induction)h(on)f(the)i(heigh)o(t)e(of)g(the)i(deriv)n
(ation)e(of)150 1843 y FF(e)194 1815 y Ft(n)181 1843
y FF(,)-7 b Fy(!)11 b FF(v)q FI(.)1620 b Fy(u)-28 b(t)150
1991 y FG(6.9.3)48 b(P)o(arallel)13 b(Reduction)g(with)i(Complexit)o(y)
150 2107 y FI(In)d(order)g(to)g(pro)o(v)o(e)g(the)g(t)o(w)o(o)f(k)o(ey)
h(lemmas)d(presen)o(ted)14 b(in)d(this)h(section,)g(w)o(e)g(will)e
(need)j(to)e(reason)i(b)o(y)e(induction)150 2182 y(on)18
b(the)g(\\complexit)o(y")e(of)h(parallel)g(reduction.)h(Th)o(us,)g(w)o
(e)g(will)f(use)h(the)h(follo)o(wing)c(de\014nition)j(of)f(parallel)150
2256 y(reduction)e(with)e(an)h(asso)q(ciated)g(complexit)o(y)e
(measure:)150 2363 y FG(De\014nitio)o(n)h(6.9.14)j(\(P)o(arallel)c
(Reduction)h(with)i(Complexit)o(y\))j FH(Par)n(al)r(lel)c(r)n(e)n
(duction)p 1661 2363 13 2 v 1689 2332 a Ft(M)1685 2363
y Fy(\035)p 1741 2363 V 39 w FI(:)d FF(E)j Fy(!)d FF(E)150
2427 y FH(de\014ne)n(d)16 b(as)f(fol)r(lows:)166 2562
y(1.)p 240 2552 124 2 v 246 2611 a FF(x)294 2580 y FA(0)281
2611 y Fy(\035)d FF(x)p eop
%%Page: 117 128
117 127 bop 1862 0 a FB(117)166 240 y FH(2.)403 204 y
FF(e)422 190 y FA(0)422 215 y(1)456 174 y Ft(M)453 205
y Fy(\035)506 204 y FF(e)525 190 y Fs(0)525 215 y FA(1)586
204 y FF(e)605 190 y FA(0)605 215 y(2)642 174 y Ft(N)636
205 y Fy(\035)689 204 y FF(e)708 190 y Fs(0)708 215 y
FA(2)p 240 231 649 2 v 246 299 a FI(\()p FF(\025x:e)341
284 y FA(0)341 310 y(1)360 299 y FI(\))11 b FF(e)406
284 y FA(0)406 310 y(2)437 264 y Ft(M)s FA(+#\()p Ft(x;e)582
251 y Fk(0)582 272 y Fq(1)598 264 y FA(\))p Ft(N)s FA(+1)539
299 y Fy(\035)113 b FF(e)713 284 y Fs(0)713 310 y FA(1)732
299 y FI([)p FF(x)11 b FI(:=)g FF(e)853 284 y Fs(0)853
310 y FA(2)872 299 y FI(])166 413 y FH(3.)314 377 y FF(e)333
362 y FA(0)333 388 y(1)367 347 y Ft(M)364 377 y Fy(\035)g
FF(e)436 362 y Fs(0)436 388 y FA(1)p 240 403 289 2 v
246 463 a FE(run)i Fy(h)p FF(e)350 448 y FA(0)350 473
y(1)369 463 y Fy(i)397 432 y Ft(M)s FA(+1)414 463 y Fy(\035)29
b FF(e)504 448 y Fs(0)504 473 y FA(1)166 577 y FH(4.)292
541 y FF(e)311 526 y FA(0)311 551 y(1)344 510 y Ft(M)341
541 y Fy(\035)11 b FF(e)413 526 y Fs(0)413 551 y FA(1)p
240 567 243 2 v 247 627 a FE(~)q Fy(h)p FF(e)304 612
y FA(0)304 637 y(1)323 627 y Fy(i)351 596 y Ft(M)s FA(+1)369
627 y Fy(\035)28 b FF(e)458 612 y Fs(0)458 637 y FA(1)166
740 y FH(5.)306 705 y FF(e)325 711 y FA(1)359 674 y Ft(M)355
705 y Fy(\035)11 b FF(e)427 690 y Fs(0)427 715 y FA(1)p
240 731 272 2 v 246 790 a FF(\025x:e)325 796 y FA(1)359
760 y Ft(M)355 791 y Fy(\035)408 790 y FF(\025x:e)487
776 y Fs(0)487 801 y FA(1)166 904 y FH(6.)278 868 y FF(e)297
874 y FA(1)331 838 y Ft(M)328 869 y Fy(\035)381 868 y
FF(e)400 854 y Fs(0)400 879 y FA(1)p 240 895 217 2 v
246 954 a Fy(h)p FF(e)281 960 y FA(1)300 954 y Fy(i)331
924 y Ft(M)328 954 y Fy(\035)g(h)p FF(e)416 939 y Fs(0)416
965 y FA(1)435 954 y Fy(i)166 1068 y FH(7.)269 1032 y
FF(e)288 1038 y FA(1)322 1002 y Ft(M)319 1032 y Fy(\035)g
FF(e)391 1017 y Fs(0)391 1043 y FA(1)p 240 1058 199 2
v 247 1118 a FE(~)q FF(e)288 1124 y FA(1)322 1087 y Ft(M)319
1118 y Fy(\035)h FE(~)q FF(e)414 1103 y Fs(0)414 1128
y FA(1)166 1232 y FH(8.)315 1196 y FF(e)334 1202 y FA(1)368
1165 y Ft(M)364 1196 y Fy(\035)f FF(e)436 1181 y Fs(0)436
1206 y FA(1)p 240 1222 290 2 v 246 1282 a FE(run)i FF(e)334
1288 y FA(1)368 1251 y Ft(M)364 1282 y Fy(\035)e FE(run)i
FF(e)505 1267 y Fs(0)505 1292 y FA(1)166 1396 y FH(9.)246
1360 y FF(e)265 1366 y FA(1)299 1329 y Ft(M)296 1360
y Fy(\035)e FF(e)368 1345 y Fs(0)368 1370 y FA(1)429
1360 y FF(e)448 1366 y FA(2)485 1329 y Ft(N)479 1360
y Fy(\035)g FF(e)551 1345 y Fs(0)551 1370 y FA(2)p 240
1386 336 2 v 264 1445 a FF(e)283 1451 y FA(1)314 1445
y FF(e)333 1451 y FA(2)363 1415 y Ft(M)s FA(+)p Ft(N)387
1446 y Fy(\035)464 1445 y FF(e)483 1431 y Fs(0)483 1456
y FA(1)514 1445 y FF(e)533 1431 y Fs(0)533 1456 y FA(2)595
1396 y FF(;)150 1541 y FI(where)k(#\()p FF(x;)7 b(e)p
FI(\))13 b(is)h(the)g(n)o(um)o(b)q(er)g(of)f(o)q(ccurrences)k(of)c(the)
i(v)n(ariable)d FF(x)i FI(in)f(the)i(term)e FF(e)p FI(.)150
1624 y(There)h(is)f(a)f(sense)j(in)d(whic)o(h)h(parallel)e(reduction)j
(should)e(resp)q(ect)k(the)d(classes.)h(The)f(follo)o(wing)d(lemma)g
(expli-)150 1699 y(cates)15 b(these)g(prop)q(erties.)150
1812 y FG(Lemma)g(6.9.15)h(\(P)o(arallel)d(Reduction)g(and)i(Classes\))
20 b Fy(8)p FF(n)11 b Fy(2)g Fo(N)p FF(:)166 1922 y FH(1.)21
b Fy(8)p FF(e)263 1928 y FA(1)293 1922 y Fy(2)11 b FF(E)365
1907 y Ft(n)388 1922 y FF(;)c(e)426 1928 y FA(2)456 1922
y Fy(2)k FF(E)r(:)c(e)566 1928 y FA(1)599 1891 y Ft(M)596
1922 y Fy(\035)k FF(e)668 1928 y FA(2)699 1922 y FI(=)-7
b Fy(\))11 b FF(e)796 1928 y FA(2)826 1922 y Fy(2)h FF(E)899
1907 y Ft(n)166 1986 y FH(2.)21 b Fy(8)p FF(e)11 b Fy(2)h
FF(E)347 1971 y Ft(n)369 1986 y FF(;)7 b(v)13 b Fy(2)e
FF(V)494 1971 y Ft(n)516 1986 y FF(:)c(v)571 1956 y Ft(M)568
1986 y Fy(\035)k FF(e)h FI(=)-7 b Fy(\))11 b FF(e)h Fy(2)f
FF(V)834 1971 y Ft(n)166 2051 y FH(3.)21 b Fy(8)p FF(e)11
b Fy(2)h FF(E)347 2036 y Ft(n)369 2051 y FF(;)7 b(s)12
b Fy(2)f FF(S)485 2036 y Ft(n)508 2051 y FF(:)c(s)561
2020 y Ft(M)558 2051 y Fy(\035)k FF(e)h FI(=)-7 b Fy(\))11
b FF(e)h Fy(2)f FF(S)817 2036 y Ft(n)166 2115 y FH(4.)21
b Fy(8)p FF(e)11 b Fy(2)h FF(E)347 2100 y Ft(n)369 2115
y FF(;)7 b(w)12 b Fy(2)f FF(W)514 2100 y Ft(n)537 2115
y FF(:)c(e)590 2085 y Ft(M)586 2115 y Fy(\035)k FF(w)i
FI(=)-7 b Fy(\))11 b FF(e)h Fy(2)f FF(W)875 2100 y Ft(n)898
2115 y FF(:)150 2225 y FH(Pr)n(o)n(of.)20 b FI(The)d(\014rst)h(part)f
(of)g(this)g(lemma)c(is)k(pro)o(v)o(ed)g(b)o(y)g(straigh)o(tforw)o(ard)
f(induction)h(on)g(the)g(heigh)o(t)g(of)f(the)150 2289
y(reduction)f(deriv)n(ation.)e(It)i(is)f(then)h(enough)f(to)g
(establish)h(the)g(second)g(t)o(w)o(o)f(parts)h(of)f(this)g(lemma,)d
(and)j(then)150 2354 y(the)d(fourth)f(part)h(follo)o(ws)e(immedia)o
(tely)m(.)e(The)k(pro)q(of)f(of)g(the)h(\014rst)g(t)o(w)o(o)f(is)g
(also)g(b)o(y)g(a)g(straigh)o(tforw)o(ard)g(induction)150
2419 y(on)k(the)g(deriv)n(ations)g(of)f FF(e)f Fy(2)f
FF(V)641 2404 y Ft(n)678 2419 y FI(and)i FF(e)f Fy(2)f
FF(S)855 2404 y Ft(n)879 2419 y FI(,)i(resp)q(ectiv)o(ely)m(.)768
b Fy(u)-28 b(t)150 2532 y FG(Remark)15 b(6.9.16)21 b
FH(We)d(have)g(alr)n(e)n(ady)f(shown)g(that)g(p)n(ar)n(al)r(lel)g(r)n
(e)n(duction)g(without)g(c)n(omplexity)g(is)g(e)n(quivalent)150
2597 y(\(in)g(many)h(steps\))f(to)g(normal)g(r)n(e)n(duction)g(\(in)g
(many)h(steps\).)f(The)g(same)h(r)n(esult)e(applies)h(to)g(this)g
(annotate)n(d)150 2662 y(de\014nition.)p eop
%%Page: 118 129
118 128 bop 1862 0 a FB(118)150 192 y FG(Lemma)15 b(6.9.17)h
(\(Substitu)o(ti)o(on)c(for)j(P)o(arallel)e(Reduction)g(with)i
(Complexit)o(y\))j Fy(8)p FF(e)1659 198 y FA(4)1678 192
y FF(;)7 b(e)1716 198 y FA(5)1734 192 y FF(;)g(e)1772
198 y FA(6)1791 192 y FF(;)g(e)1829 198 y FA(7)1859 192
y Fy(2)k FF(E)r FH(,)150 256 y FF(X)q(;)c(Y)21 b Fy(2)11
b Fo(N)p FF(:)305 344 y(e)324 350 y FA(4)361 313 y Ft(X)355
344 y Fy(\035)g FF(e)427 350 y FA(5)455 344 y Fy(^)e
FF(e)511 327 y FA(0)511 354 y(6)549 313 y Ft(Y)541 344
y Fy(\035)i FF(e)613 350 y FA(7)644 344 y FI(=)-7 b Fy(\))11
b FI(\()p Fy(9)p FF(Z)k Fy(2)c Fo(N)p FF(:)c(e)913 350
y FA(4)930 344 y FI([)p FF(x)k FI(:=)g FF(e)1051 327
y FA(0)1051 354 y(6)1070 344 y FI(])1101 313 y Ft(Z)1093
344 y Fy(\035)g FF(e)1165 350 y FA(5)1184 344 y FI([)p
FF(x)g FI(:=)g FF(e)1305 350 y FA(7)1324 344 y FI(])e
Fy(^)g FF(Z)15 b Fy(\024)c FF(X)i FI(+)d(#\()p FF(x;)d(e)1670
350 y FA(5)1688 344 y FI(\))p FF(Y)i FI(\))p FF(:)150
440 y FH(Pr)n(o)n(of.)20 b FI(By)15 b(induction)g(on)f(the)h(heigh)o(t)
g(of)f(the)i(deriv)n(ation)d FF(e)1124 446 y FA(4)1162
409 y Ft(X)1156 440 y Fy(\035)g FF(e)1230 446 y FA(5)1249
440 y FI(.)h(\(A)h(direct)h(extension)f(of)g(the)g(pro)q(of)f(for)150
505 y(Lemma)d(5)j(on)f(page)h(137)f(of)h(Plotkin)f([68].\))1040
b Fy(u)-28 b(t)150 600 y FG(Lemma)15 b(6.9.18)h(\(T)l(ransition\))h
Fy(8)p FF(n;)7 b(X)15 b Fy(2)c Fo(N)p FF(:)c Fy(8)p FF(w)j
Fy(2)h FF(W)1081 585 y Ft(n)1103 600 y FF(;)c(v)13 b
Fy(2)e FF(V)1228 585 y Ft(n)1250 600 y FF(:)528 692 y(w)577
661 y Ft(X)571 692 y Fy(\035)g FF(v)i FI(=)-7 b Fy(\))11
b FI(\()p Fy(9)p FF(v)794 698 y FA(2)825 692 y Fy(2)g
FF(E)897 675 y Ft(n)920 692 y FF(;)c(Y)20 b Fy(2)11 b
Fo(N)p FF(:)c(w)1136 669 y Ft(n)1113 692 y Fy(7\000)-7
b(!)1180 662 y FA(+)1219 692 y FF(v)1239 698 y FA(2)1277
661 y Ft(Y)1269 692 y Fy(\035)11 b FF(v)q FI(\))f Fy(^)f
FF(Y)21 b(<)12 b(X)q(:)150 784 y FH(Pr)n(o)n(of.)20 b
FI(By)c(induction)f(on)h(the)g(complexit)o(y)e FF(X)20
b FI(and)15 b(then)i(on)e(the)i(size)f(of)f FF(w)q FI(.)g(\(A)h(direct)
h(com)o(bination)c(and)150 849 y(extension)i(of)e(pro)q(ofs)h(for)f
(Lemmas)f(6)h(and)h(7)g(of)f(Plotkin)g([68].\))720 b
Fy(u)-28 b(t)150 944 y FG(Lemma)15 b(6.9.19)h(\(P)o(erm)o(utati)o(on\))
h Fy(8)p FF(n;)7 b(X)14 b Fy(2)e Fo(N)p FF(:)7 b Fy(8)p
FF(w)1036 950 y FA(1)1052 944 y FF(;)g(w)1101 950 y FA(2)1130
944 y Fy(2)k FF(W)1214 929 y Ft(n)1237 944 y FF(;)c(e)1275
950 y FA(1)1305 944 y Fy(2)k FF(E)1377 929 y Ft(n)1399
944 y FF(:)577 1036 y(w)607 1042 y FA(1)643 1005 y Ft(X)637
1036 y Fy(\035)g FF(w)720 1042 y FA(2)773 1013 y Ft(n)750
1036 y Fy(7\000)-6 b(!)11 b FF(e)848 1042 y FA(1)878
1036 y FI(=)-7 b Fy(\))12 b FI(\()p Fy(9)p FF(e)1015
1042 y FA(2)1045 1036 y Fy(2)f FF(E)1117 1019 y Ft(n)1140
1036 y FF(:)c(w)1189 1042 y FA(1)1242 1013 y Ft(n)1218
1036 y Fy(7\000)-6 b(!)1285 1006 y FA(+)1324 1036 y FF(e)1343
1042 y FA(2)1374 1036 y Fy(\035)11 b FF(e)1446 1042 y
FA(1)1465 1036 y FI(\))p FF(:)150 1128 y FH(Pr)n(o)n(of.)20
b FI(By)13 b(induction)f(on)g(the)h(complexit)o(y)d FF(X)s
FI(,)j(and)f(b)o(y)g(a)g(case)i(analysis)d(on)i(the)g(last)f(case)h(of)
f(the)h(deriv)n(ation)150 1193 y(of)g FF(w)227 1199 y
FA(1)263 1162 y Ft(X)257 1193 y Fy(\035)e FF(w)340 1199
y FA(2)359 1193 y FI(.)i(\(A)h(direct)h(extension)f(of)g(Lemmas)d(8)j
(of)f(the)h(previous)h(reference.\))429 b Fy(u)-28 b(t)150
1288 y FG(Lemma)15 b(6.9.20)h(\(Push)e(Bac)o(k\))21 b
Fy(8)p FF(X)15 b Fy(2)c Fo(N)p FF(;)c(w)930 1294 y FA(1)946
1288 y FF(;)g(w)995 1294 y FA(2)1024 1288 y Fy(2)k FF(W)1108
1273 y FA(0)1127 1288 y FF(;)c(v)1166 1294 y FA(2)1196
1288 y Fy(2)k FF(V)1268 1273 y FA(0)1287 1288 y FF(:)564
1380 y(w)594 1386 y FA(1)630 1349 y Ft(X)624 1380 y Fy(\035)g
FF(w)707 1386 y FA(2)762 1357 y(0)737 1380 y Fy(7\000)-7
b(!)804 1344 y FA(+)843 1380 y FF(v)863 1386 y FA(1)893
1380 y FI(=)g Fy(\))11 b FI(\()p Fy(9)p FF(v)1030 1386
y FA(2)1061 1380 y Fy(2)g FF(V)1133 1363 y FA(0)1152
1380 y FF(:)c(w)1201 1386 y FA(1)1256 1357 y(0)1230 1380
y Fy(7\000)-6 b(!)1297 1344 y FA(+)1336 1380 y FF(v)1356
1386 y FA(2)1387 1380 y Fy(\035)11 b FF(v)1460 1386 y
FA(1)1478 1380 y FI(\))p FF(:)150 1472 y FH(Pr)n(o)n(of.)20
b FI(The)14 b(assumption)f(corresp)q(onds)j(to)e(a)f(c)o(hain)h(of)f
(reductions:)636 1559 y FF(w)666 1565 y FA(1)696 1559
y Fy(\035)e FF(w)779 1565 y FA(2)834 1536 y(0)809 1559
y Fy(7\000)-6 b(!)11 b FF(w)918 1565 y FA(3)973 1536
y(0)948 1559 y Fy(7\000)-7 b(!)11 b FF(:::w)1092 1565
y Ft(k)q Fs(\000)p FA(1)1190 1536 y(0)1165 1559 y Fy(7\000)-7
b(!)11 b FF(w)1273 1565 y Ft(k)1330 1536 y FA(0)1305
1559 y Fy(7\000)-7 b(!)11 b FF(v)1403 1565 y FA(1)1422
1559 y FF(:)150 1647 y FI(Applying)18 b(P)o(erm)o(utation)g(to)g
FF(w)666 1653 y FA(1)705 1647 y Fy(\035)h FF(w)796 1653
y FA(2)860 1623 y(0)834 1647 y Fy(7\000)-6 b(!)19 b FF(w)951
1653 y FA(3)989 1647 y FI(giv)o(es)f(us)i(\()p Fy(9)p
FF(e)1212 1653 y FA(2)1229 1645 y Fk(0)1262 1647 y Fy(2)g
FF(E)1343 1632 y Ft(n)1365 1647 y FF(:)7 b(w)1414 1653
y FA(1)1477 1623 y(0)1452 1647 y Fy(7\000)-6 b(!)1519
1611 y FA(+)1567 1647 y FF(e)1586 1653 y FA(2)1603 1645
y Fk(0)1636 1647 y Fy(\035)19 b FF(w)1727 1653 y FA(3)1746
1647 y FI(\).)f(By)h(the)150 1711 y(monotonicit)o(y)12
b(of)j(parallel)e(reduction,)j(w)o(e)f(kno)o(w)f(that)h(only)f(a)h(w)o
(ork)n(able)f(can)h(reduce)i(to)e(a)f(w)o(ork)n(able,)g(that)150
1776 y(is,)f(\()p Fy(9)p FF(w)272 1782 y FA(2)289 1774
y Fk(0)314 1776 y Fy(2)e FF(W)398 1761 y Ft(n)420 1776
y FF(:)c(w)469 1782 y FA(1)524 1753 y(0)499 1776 y Fy(7\000)-7
b(!)566 1740 y FA(+)605 1776 y FF(w)635 1782 y FA(2)652
1774 y Fk(0)676 1776 y Fy(\035)11 b FF(w)759 1782 y FA(3)777
1776 y FI(\).)j(No)o(w)f(w)o(e)h(ha)o(v)o(e)g(the)g(c)o(hain:)617
1864 y FF(w)647 1870 y FA(1)702 1840 y(0)677 1864 y Fy(7\000)-7
b(!)744 1827 y FA(+)783 1864 y FF(w)813 1870 y FA(2)830
1862 y Fk(0)854 1864 y Fy(\035)11 b FF(w)937 1870 y FA(3)992
1840 y(0)967 1864 y Fy(7\000)-7 b(!)11 b FF(:::w)1111
1870 y Ft(k)q Fs(\000)p FA(1)1209 1840 y(0)1184 1864
y Fy(7\000)-7 b(!)12 b FF(w)1293 1870 y Ft(k)1349 1840
y FA(0)1324 1864 y Fy(7\000)-6 b(!)11 b FF(v)1423 1870
y FA(1)1441 1864 y FF(:)150 1951 y FI(Rep)q(eating)j(this)g(step)h
FF(k)10 b Fy(\000)f FI(2)14 b(times)f(w)o(e)h(ha)o(v)o(e:)578
2039 y FF(w)608 2045 y FA(1)663 2015 y(0)638 2039 y Fy(7\000)-6
b(!)705 2002 y FA(+)744 2039 y FF(w)774 2045 y FA(2)791
2036 y Fk(0)840 2015 y FA(0)815 2039 y Fy(7\000)g(!)882
2002 y FA(+)921 2039 y FF(w)951 2045 y FA(3)968 2036
y Fk(0)1017 2015 y FA(0)992 2039 y Fy(7\000)g(!)1059
2002 y FA(+)1098 2039 y FF(:::w)1164 2045 y Ft(k)q Fs(\000)p
FA(1)1226 2036 y Fk(0)1248 2039 y Fy(\035)11 b FF(w)1331
2045 y Ft(k)1388 2015 y FA(0)1363 2039 y Fy(7\000)-7
b(!)11 b FF(v)1461 2045 y FA(1)1480 2039 y FF(:)150 2126
y FI(Applying)k(P)o(erm)o(utation)f(to)i FF(w)657 2132
y Ft(k)q Fs(\000)p FA(1)719 2124 y Fk(0)745 2126 y Fy(\035)e
FF(w)831 2132 y Ft(k)891 2102 y FA(0)866 2126 y Fy(7\000)-7
b(!)14 b FF(v)967 2132 y FA(1)1001 2126 y FI(giv)o(e)h(us)i(\()p
Fy(9)p FF(e)1202 2132 y Ft(k)1221 2124 y Fk(0)1248 2126
y Fy(2)d FF(E)1323 2111 y Ft(n)1346 2126 y FF(:)7 b(w)1395
2132 y Ft(k)q Fs(\000)p FA(1)1457 2124 y Fk(0)1508 2102
y FA(0)1483 2126 y Fy(7\000)-7 b(!)1550 2090 y FA(+)1592
2126 y FF(e)1611 2132 y Ft(k)1630 2124 y Fk(0)1657 2126
y Fy(\035)14 b FF(v)1733 2132 y FA(1)1752 2126 y FI(\).)h(By)h(the)150
2191 y(monotonicit)o(y)d(of)h(parallel)g(reduction,)h(w)o(e)g(kno)o(w)g
(that)g FF(e)1079 2197 y Ft(k)1098 2189 y Fk(0)1126 2191
y FI(can)g(only)g(b)q(e)g(a)g(v)n(alue)f(or)h(a)g(w)o(ork)n(able.)f(If)
h(it)f(is)h(a)150 2255 y(v)n(alue)e(then)i(w)o(e)f(ha)o(v)o(e)g(the)g
(c)o(hain:)569 2343 y FF(w)599 2349 y FA(1)655 2319 y(0)629
2343 y Fy(7\000)-6 b(!)696 2307 y FA(+)735 2343 y FF(w)765
2349 y FA(2)782 2341 y Fk(0)832 2319 y FA(0)806 2343
y Fy(7\000)g(!)873 2307 y FA(+)912 2343 y FF(w)942 2349
y FA(3)959 2341 y Fk(0)1009 2319 y FA(0)983 2343 y Fy(7\000)g(!)1050
2307 y FA(+)1089 2343 y FF(:::w)1155 2349 y Ft(k)q Fs(\000)p
FA(1)1217 2341 y Fk(0)1265 2319 y FA(0)1239 2343 y Fy(7\000)g(!)1306
2307 y FA(+)1345 2343 y FF(v)1365 2349 y Ft(k)1384 2341
y Fk(0)1409 2343 y Fy(\035)11 b FF(v)1482 2349 y FA(1)150
2430 y FI(and)20 b(w)o(e)h(are)g(done.)f(If)g(it)h(is)f(a)g(w)o(ork)n
(able,)f(then)j(applying)d(T)m(ransition)g(to)h FF(w)1446
2436 y Ft(k)1465 2428 y Fk(0)1500 2430 y Fy(\035)i FF(v)1584
2436 y FA(1)1624 2430 y FI(giv)o(es)e(us)h(\()p Fy(9)p
FF(v)1851 2436 y FA(2)1892 2430 y Fy(2)150 2495 y FF(V)183
2480 y Ft(n)206 2495 y FF(:)7 b(w)255 2501 y Ft(k)274
2493 y Fk(0)323 2472 y FA(0)297 2495 y Fy(7\000)-6 b(!)364
2459 y FA(+)403 2495 y FF(v)423 2501 y FA(2)454 2495
y Fy(\035)11 b FF(v)527 2501 y FA(1)545 2495 y FI(\).)j(This)g(means)f
(that)h(w)o(e)g(no)o(w)f(ha)o(v)o(e)h(the)h(c)o(hain:)487
2583 y FF(w)517 2589 y FA(1)572 2559 y(0)546 2583 y Fy(7\000)-6
b(!)613 2546 y FA(+)652 2583 y FF(w)682 2589 y FA(2)699
2580 y Fk(0)749 2559 y FA(0)724 2583 y Fy(7\000)f(!)790
2546 y FA(+)829 2583 y FF(w)859 2589 y FA(3)876 2580
y Fk(0)926 2559 y FA(0)901 2583 y Fy(7\000)g(!)967 2546
y FA(+)1007 2583 y FF(:::w)1073 2589 y Ft(k)q Fs(\000)p
FA(1)1135 2580 y Fk(0)1182 2559 y FA(0)1157 2583 y Fy(7\000)g(!)1223
2546 y FA(+)1262 2583 y FF(w)1292 2589 y Ft(k)1311 2580
y Fk(0)1361 2559 y FA(0)1335 2583 y Fy(7\000)h(!)1402
2546 y FA(+)1441 2583 y FF(v)1461 2589 y FA(2)1492 2583
y Fy(\035)11 b FF(v)1565 2589 y FA(1)150 2670 y FI(and)j(w)o(e)g(are)g
(done.)1434 b Fy(u)-28 b(t)p eop
%%Page: 119 130
119 129 bop 1862 0 a FB(119)150 192 y FG(6.9.4)48 b(Concluding)13
b(Remarks)150 298 y(Remark)i(6.9.21)h(\(Equational)e(Theory\))19
b FH(It)d(is)f(often)h(the)g(c)n(ase)g(that)g(an)g(e)n(quational)g(the)
n(ory)g(for)f(a)h(lan-)150 363 y(guage)e(wil)r(l)f(lo)n(ok)h(very)f
(similar)g(to)g(a)h(r)n(e)n(duction)g(semantics.)g(We)g(should)g(ther)n
(efor)n(e)f(p)n(oint)h(out)g(that)f(we)h(exp)n(e)n(ct)150
427 y(that)h(al)r(l)f(the)h(r)n(e)n(ductions)f(of)h FF(\025)p
FH(-U)g(to)f(hold)h(as)g(e)n(qualities.)f(Such)i(an)f(e)n(quational)g
(the)n(ory)g(is)f(useful)h(for)f(r)n(e)n(ason-)150 492
y(ing)h(ab)n(out)g(pr)n(o)n(gr)n(ams)g(in)g(gener)n(al,)f(and)i(for)e
(pr)n(oving)h(the)g(e)n(quivalenc)n(e)h(of)f(two)f(pr)n(o)n(gr)n(ams)g
(in)h(p)n(articular.)f(The)150 557 y(formal)d(development)h(and)g(the)f
(pr)n(actic)n(al)g(utility)f(of)i(such)g(an)g(e)n(quational)g(the)n
(ory)f(ar)n(e)g(stil)r(l)f(lar)n(gely)h(unexplor)n(e)n(d.)150
671 y FG(Remark)k(6.9.22)h(\(The)f(Strati\014cation)d(of)k
(Expressions\))i FH(It)d(is)h(ne)n(c)n(essary)g(to)f(str)n(atify)g(the)
h(set)f(of)h(ex-)150 736 y(pr)n(essions)f(into)h(expr)n(ession)f
(families.)g(In)g(p)n(articular,)g(our)g(notions)h(of)f(r)n(e)n
(duction)h(ar)n(e)f(c)n(ertainly)g FI(not)g FH(sound)150
801 y(if)i(we)g(do)h(not)f(explicitly)g(forbid)g(the)g(applic)n(ation)h
(of)f(the)h(big-step)f(semantic)g(function)h(on)g(terms)f(that)g(ar)n
(e)150 866 y(manifestly)f(not)h(at)g(the)g(right)f(level.)g(In)h(p)n
(articular,)f(c)n(onsider)h(the)g(term)j FE(~)5 b Fy(h)p
FF(i)p Fy(i)15 b(2)g FF(E)1524 851 y FA(1)1543 866 y
FH(.)h(If)h(this)f(term)g(is)h(sub-)150 930 y(je)n(cte)n(d)d(to)h(the)f
(big-step)g(semantic)h(function)g(at)f(level)g(0,)h(the)f(r)n(esult)g
(is)g(unde\014ne)n(d.)i(However,)d(if)h(we)g(optimize)150
995 y(this)i(term)g(using)h(the)g(Esc)n(ap)n(e)g(r)n(e)n(duction,)f(we)
h(get)f(b)n(ack)h(the)g(term)f FF(i)p FH(,)h(for)f(which)g(the)h
(big-step)f(semantics)h FI(is)150 1060 y FH(de\014ne)n(d.)e(As)e(such,)
h(the)g(str)n(ati\014c)n(ation)g(of)f(the)h(expr)n(essions)g(is)g
(crucial)f(to)h(the)g(c)n(orr)n(e)n(ctness)f(of)h(our)g(notions)g(of)
150 1125 y(r)n(e)n(duction.)150 1239 y FG(Remark)h(6.9.23)h(\(Non-left)
e(or)h(\\In)o(ternal")f(Reductions\))j FH(Many)f(standar)n(dization)f
(pr)n(o)n(ofs)g(\(such)h(as)150 1304 y(those)g(describ)n(e)n(d)f(by)h
(Bar)n(endr)n(e)n(gt)f([1])g(and)h(T)m(akahashi)g([96]\))g(employ)f
(\\c)n(omplementary")i(notions)f(of)f(r)n(e)n(duc-)150
1369 y(tion,)c(such)h(as)g(internal)f(r)n(e)n(duction)g(\(de\014ne)n(d)
i(simply)e(as)g(non-he)n(ad\).)i(The)e(development)h(pr)n(esente)n(d)g
(in)f(Plotkin)150 1434 y(\(and)i(her)n(e\),)e(do)n(es)i(not)f(r)n(e)n
(quir)n(e)f(the)h(intr)n(o)n(duction)g(of)g(such)h(notions.)f(While)h
(they)f(do)g(p)n(osses)h(inter)n(esting)e(pr)n(op-)150
1498 y(erties)16 b(in)h(our)g(setting)f(\(such)i(as)f(the)g(pr)n
(eservation)f(of)h(al)r(l)g(classes\),)f(they)h(ar)n(e)g(not)g(ne)n(e)n
(de)n(d)g(for)g(the)g(pr)n(o)n(ofs.)150 1563 y(Machkasova)j(and)g(T)m
(urb)n(ak)f([46])f(also)h(p)n(oint)g(out)h(that)f(c)n(omplementary)g(r)
n(e)n(ductions)g(pr)n(eserve)f(al)r(l)g(classes.)150
1628 y(Using)c(such)h(c)n(omplementary)f(notions,)h(it)f(may)h(b)n(e)f
(p)n(ossible)g(to)g(avoid)h(the)f(use)h(of)f(Plotkin)l('s)g(notion)h
(of)f(c)n(om-)150 1693 y(plexity,)g(although)h(the)g(r)n(est)f(of)g
(the)h(pr)n(o)n(of)f(r)n(emains)g(essential)r(ly)h(the)f(same.)h(We)g
(plan)g(to)f(further)g(investigate)150 1757 y(this)h(p)n(oint)g(in)g
(futur)n(e)f(work.)150 1872 y FG(Remark)h(6.9.24)h(\(Classes\))k
FH(Plotkin)e([68])g(only)h(names)f(the)h(set)f(of)g(values)h
(explicitly.)e(The)h(notions)h(of)150 1937 y(workables)d(and)i(stuck)f
(terms)g(employe)n(d)g(in)g(this)g(pr)n(esent)g(work)1197
1922 y FA(5)1232 1937 y FH(help)n(e)n(d)g(us)g(adapt)h(Plotkin)l('s)e
(te)n(chnique)i(to)150 2001 y(MetaML,)13 b(and)h(in)f(some)g(c)n(ases,)
g(to)g(shorten)g(the)h(development.)f(F)m(or)g(example,)g(we)f(have)i
(c)n(ombine)n(d)g(Plotkin)l('s)150 2066 y(L)n(emmas)j(6)h(and)g(7)g
(into)f(one)h(\(L)n(emma)g(6.9.18\).)f(We)h(exp)n(e)n(ct)g(that)f(our)g
(or)n(ganization)h(of)f(expr)n(essions)h(into)150 2131
y(values,)f(workables,)f(and)i(stuck)f(terms)f(may)h(also)g(b)n(e)g
(suitable)g(for)f(applying)h(Plotkin)l('s)g(te)n(chnique)g(to)g(other)
150 2196 y(pr)n(o)n(gr)n(amming)d(languages.)150 2310
y FG(Remark)h(6.9.25)h(\(Standardizati)o(on\))h FH(We)d(have)f(not)h
(found)g(ne)n(e)n(d)g(for)e(a)i(Standar)n(dization)g(The)n(or)n(em,)e
(or)150 2375 y(for)f(an)i(explicit)e(notion)i(of)f(standar)n(d)g(r)n(e)
n(duction.)g(A)o(lso,)f(our)h(development)h(has)f(avoide)n(d)h(L)n
(emma)f(9)g(of)g(Plotkin)150 2440 y([68],)i(and)i(the)f(non-trivial)f
(lexic)n(o)n(gr)n(aphic)h(or)n(dering)f(ne)n(e)n(de)n(d)i(for)e(pr)n
(oving)h(that)g(lemma.)p 150 2522 237 2 v 158 2549 a
Fz(5)189 2565 y FC(Such)h(a)g(classi\014c)n(atio)o(n)e(has)h(also)h(b)n
(e)n(en)f(employe)n(d)g(in)i(a)f(work)h(by)f(Hatcli\013)f(and)g(Danvy)g
([34],)h(wher)n(e)g(values)f(and)189 2611 y(stuck)e(terms)h(ar)n(e)g
(name)n(d.)g(A)o(t)g(the)f(time)h(of)g(writing)g(these)f(r)n(esults,)g
(we)h(had)g(not)f(found)g(a)h(name)g(for)g(\\workables")189
2656 y(in)f(the)g(liter)n(atur)n(e.)p eop
%%Page: 120 131
120 130 bop 1862 0 a FB(120)150 192 y FG(Remark)15 b(6.9.26)h
(\(Soundness)d(of)i(CBV)i FF(\025)p FG(-U\))j FH(A)o(n)14
b(additional)h(de)n(gr)n(e)n(e)f(of)g(c)n(ar)n(e)g(is)g(ne)n(e)n(de)n
(d)h(in)g(the)f(tr)n(e)n(at-)150 256 y(ment)21 b(of)g(CBV)g
FF(\025)p FH(-U.)f(In)i(p)n(articular,)e(the)h(notion)g(of)g(value)g
(induc)n(e)n(d)h(by)f(the)g(big-step)g(semantics)g(for)g(a)150
321 y(c)n(al)r(l-by-value)14 b(lamb)n(da)h(language)h(is)e(not)i(the)e
(same)h(as)g(the)g(notion)g(of)g(value)g(use)n(d)g(in)g(the)g(r)n(e)n
(duction)g(seman-)150 386 y(tics)h(for)f(c)n(al)r(l-by-value)h
(languages.)h(The)f(latter)f(typic)n(al)r(ly)h(c)n(ontains)h
(variables.)e(This)h(subtle)g(di\013er)n(enc)n(e)g(wil)r(l)150
451 y(r)n(e)n(quir)n(e)e(distinguishing)h(b)n(etwe)n(en)g(the)g(two)f
(notions)h(thr)n(oughout)h(the)f(soundness)h(pr)n(o)n(of.)p
eop
%%Page: 121 132
121 131 bop 868 1022 a FL(P)m(art)32 b(I)s(I)s(I)196
1275 y Fv(Appraisal)39 b(and)g(Recommen)o(dations)p eop
%%Page: 122 133
122 132 bop 822 424 a FL(Chapter)31 b(7)391 650 y(Discussion)k(and)d
(Related)h(W)-8 b(orks)150 899 y FI(The)17 b(In)o(tro)q(duction)f
(explained)g(the)g(motiv)n(ation)d(for)j(the)h(study)f(of)g(MetaML)g
(and)g(m)o(ulti-stage)e(languages.)150 974 y(P)o(art)h(I)g(explained)g
(the)h(basics)f(of)g(MetaML)g(and)g(ho)o(w)f(it)h(can)g(b)q(e)h(used)g
(to)f(dev)o(elop)g(m)o(ulti-stage)e(programs.)150 1049
y(P)o(art)j(I)q(I)h(explained)e(the)i(need)g(for)f(the)h(formal)c
(study)k(of)e(the)i(seman)o(tics)f(of)f(MetaML,)h(and)g(presen)o(ted)i
(the)150 1124 y(main)9 b(tec)o(hnical)i(results)h(of)f(our)g(w)o(ork.)f
(This)h(c)o(hapter)h(expands)g(on)f(some)f(p)q(oin)o(ts)h(that)g(w)o
(ould)f(ha)o(v)o(e)h(elsewhere)150 1198 y(distracted)k(from)d(the)j
(essen)o(tials)f(of)g(our)g(argumen)o(t.)150 1281 y(The)21
b(\014rst)g(three)g(sections)g(parallel)e(the)i(organization)e(of)g
(the)i(dissertation.)f(The)h(In)o(tro)q(duction)f(section)150
1356 y(reviews)g(the)g(motiv)n(ation)c(for)j(studying)h(man)o(ual)d
(staging,)h(and)h(explains)g(ho)o(w)g(this)g(dissertation)h(allo)o(ws)
150 1431 y(us)f(to)f(formalize)e(the)j(concept)g(of)f(a)g(stage,)g
(whic)o(h)g(w)o(as)g(an)g(informal)d(notion)j(in)g(the)h(In)o(tro)q
(duction.)f(The)150 1506 y(P)o(art)d(I)f(section)h(reviews)g(the)g
(curren)o(t)h(state)f(of)f(MetaML,)g(and)h(presen)o(ts)h(an)e
(explanation)f(of)h(wh)o(y)g(lam)o(b)q(da-)150 1580 y(abstraction)19
b(is)g(not)f(enough)h(for)f(staging.)g(In)h(this)f(section,)h(w)o(e)g
(also)f(discuss)i(the)g(practical)e(problem)g(of)150
1655 y(cross-stage)h(p)q(ortabilit)o(y)d(that)h(ha)o(ving)f
(cross-stage)j(p)q(ersistence)h(creates.)f(The)f(P)o(art)f(I)q(I)h
(section)g(discusses)150 1730 y(the)f(related)g(w)o(orks)f(m)o
(ulti-lev)o(el)e(sp)q(ecialization)i(and)g(m)o(ulti-lev)o(el)d
(languages,)j(and)g(p)q(ositions)g(our)g(w)o(ork)g(in)150
1804 y(this)d(con)o(text.)h(A)f(\014nal)g(section)h(reviews)g
(snapshots)g(from)e(the)i(history)f(of)g(quasi-quotation)f(in)h(formal)
d(logic,)150 1879 y(LISP)m(,)j(and)h(Prolog.)150 2028
y FD(7.1)56 b(In)n(tro)r(duction)150 2141 y FG(7.1.1)48
b(Wh)o(y)16 b(Man)o(ual)e(Staging?)150 2248 y FI(Giv)o(en)g(that)h
(partial)e(ev)n(aluation)g(p)q(erforms)i(staging)f(automatically)l(,)d
(it)j(is)h(reasonable)g(to)f(ask)h(wh)o(y)f(man)o(ual)150
2323 y(staging)i(is)h(of)f(in)o(terest.)i(There)g(is)f(a)f(n)o(um)o(b)q
(er)g(of)h(reasons)h(wh)o(y)e(man)o(ual)f(staging)h(is)h(b)q(oth)g(in)o
(teresting)g(and)150 2397 y(desirable:)150 2521 y FH(F)m(oundational:)
27 b FI(As)19 b(w)o(e)f(ha)o(v)o(e)g(seen)h(in)f(this)g(dissertation,)g
(the)g(subtlet)o(y)h(of)e(the)i(seman)o(tics)e(of)h(annotated)150
2595 y(programs)11 b(w)o(arran)o(ts)i(studying)g(them)f(in)g(relativ)o
(e)h(isolation,)d(and)j(without)f(the)h(added)g(complexit)o(y)e(of)h
(other)150 2670 y(partial)h(ev)n(aluation)f(issues)j(suc)o(h)g(as)f(BT)
m(A.)1004 2795 y(122)p eop
%%Page: 123 134
123 133 bop 1862 0 a FB(123)150 192 y FH(Pe)n(dago)n(gic)n(al:)23
b FI(Explaining)13 b(the)j(concept)h(of)d(staging)h(to)g(programmers)e
(is)i(a)g(c)o(hallenge.)g(F)m(or)g(example,)e(it)i(is)150
266 y(sometimes)d(hard)i(for)g(new)g(users)i(to)e(understand)h(the)g(w)
o(orkings)e(of)h(partial)f(ev)n(aluation)f(systems)i([38].)e(New)150
341 y(users)17 b(often)e(lac)o(k)g(a)g(go)q(o)q(d)g(men)o(tal)f(mo)q
(del)g(of)g(ho)o(w)h(partial)g(ev)n(aluation)f(systems)h(w)o(ork.)g(F)m
(urthermore,)g(new)150 416 y(users)g(are)g(often)f(uncertain:)176
532 y FG({)21 b FI(What)13 b(is)h(the)g(output)g(of)g(a)f(binding-time)
f(analysis?)176 607 y FG({)21 b FI(What)13 b(are)h(the)h(annotations?)e
(Ho)o(w)g(are)i(they)f(expressed?)176 681 y FG({)21 b
FI(What)13 b(do)h(they)g(really)f(mean?)150 798 y(The)f(answ)o(ers)i
(to)d(these)j(questions)f(are)f(crucial)g(to)g(the)h(e\013ectiv)o(e)g
(use)g(of)e(partial)g(ev)n(aluation.)f(Although)i(BT)m(A)150
872 y(is)17 b(an)g(in)o(v)o(olv)o(ed)f(pro)q(cess)j(that)f(requires)g
(sp)q(ecial)g(exp)q(ertise,)h(the)e(annotations)g(it)g(pro)q(duces)i
(are)f(relativ)o(ely)150 947 y(simple)9 b(and)h(easy)g(to)h
(understand.)g(Our)f(observ)n(ation)g(is)g(that)h(programmers)d(can)i
(understand)i(the)f(annotated)150 1022 y(output)j(of)f(BT)m(A,)g
(without)g(actually)f(kno)o(wing)h(ho)o(w)g(BT)m(A)g(w)o(orks.)g(Ha)o
(ving)g(a)g(programmi)o(ng)e(language)h(with)150 1096
y(explicit)j(staging)f(annotations)h(w)o(ould)f(help)h(users)i(of)d
(partial)g(ev)n(aluation)g(understand)i(more)f(of)f(the)i(issues)150
1171 y(in)o(v)o(olv)o(ed)9 b(in)g(staged)i(computation,)d(and,)h(hop)q
(efully)m(,)f(reduce)k(the)f(steep)g(learning)e(curv)o(e)i(curren)o
(tly)g(asso)q(ciated)150 1246 y(with)j(using)f(a)h(partial)f(ev)n
(aluator)g(e\013ectiv)o(ely)i([40].)150 1379 y FH(Pr)n(agmatic)i
(\(Performanc)n(e\):)24 b FI(Whenev)o(er)17 b(p)q(erformance)g(is)f(an)
g(issue,)h(con)o(trol)f(of)g(ev)n(aluation)f(order)j(is)e(im-)150
1453 y(p)q(ortan)o(t.)h(BT)m(A)f(optimizes)g(the)i(ev)n(aluation)d
(order)j(giv)o(en)e(the)i(time)d(of)h(arriv)n(al)g(of)g(inputs,)h(but)g
(sometimes)150 1528 y(it)e(is)g(just)g(easier)h(to)f(sa)o(y)g(what)h
(is)f(w)o(an)o(ted,)f(rather)i(than)g(to)f(force)g(a)g(BT)m(A)h(to)f
(disco)o(v)o(er)g(it)g([39].)e(Automatic)150 1603 y(analyses)h(suc)o(h)
h(as)e(BT)m(A)h(are)g(necessarily)h(incomplete,)e(and)g(can)h(only)f
(appro)o(ximate)f(the)j(kno)o(wledge)e(of)g(the)150 1678
y(programmer.)e(By)j(using)g(explicit)g(annotations,)f(the)h
(programmer)e(can)i(exploit)g(his)f(full)g(kno)o(wledge)h(of)f(the)150
1752 y(program)k(domain.)e(In)j(a)g(language)f(with)h(man)o(ual)e
(staging,)h(ha)o(ving)g(explicit)h(annotations)f(can)i(o\013er)f(the)
150 1827 y(programmer)e(a)j(w)o(ell)f(designed)h(bac)o(k-do)q(or)f(for)
h(dealing)e(with)i(instances)h(when)f(the)g(automatic)e(analysis)150
1902 y(reac)o(hes)e(its)f(limits.)150 2035 y FH(Pr)n(agmatic)j(\(T)m
(ermination)g(and)h(E\013e)n(cts\):)25 b FI(Annotations)16
b(can)h(alter)g(termination)e(b)q(eha)o(vior)h(in)h(t)o(w)o(o)f(w)o(a)o
(ys:)150 2109 y(1\))h(sp)q(ecialization)h(of)f(an)g(annotated)h
(program)e(can)i(fail)e(to)h(terminate,)g(and)g(2\))g(the)i(generated)g
(program)150 2184 y(itself)12 b(migh)o(t)f(ha)o(v)o(e)h(termination)f
(b)q(eha)o(vior)i(di\013ering)f(from)f(that)i(of)f(the)h(original)e
(program)g([40].)f(While)i(suc)o(h)150 2259 y(termination)j(questions)i
(are)g(the)h(sub)r(ject)g(of)e(activ)o(e)h(in)o(v)o(estigation)e(in)h
(partial)g(ev)n(aluation,)f(programmi)o(ng)150 2333 y(with)f(explicit)h
(annotation)e(giv)o(es)i(the)g(user)h(complete)e(con)o(trol)h(o)o(v)o
(er)f(\(and)h(resp)q(onsibilit)o(y)f(for\))h(termination)150
2408 y(b)q(eha)o(vior)g(in)g(a)g(staged)h(system.)e(F)m(or)h(example,)f
(an)o(y)g(recursiv)o(e)j(program)d(can)h(b)q(e)h(annotated)g(with)f
(staging)150 2483 y(annotations)h(in)h(t)o(w)o(o)f(fundamen)o(tally)e
(di\013eren)o(t)k(w)o(a)o(ys.)e(Consider)i(the)f(p)q(o)o(w)o(er)g
(function.)f(The)i(\014rst)f(w)o(a)o(y)g(of)150 2558
y(annotating)c(it)g(is)h(the)h(one)f(whic)o(h)f(w)o(e)i(ha)o(v)o(e)e
(discussed)j(in)d(this)h(dissertation:)221 2664 y FE(fun)g(exp')g
(\(n,x\))h(=)f(\(*)f(:)h(int)g Fy(\002)g(h)p FE(real)p
Fy(i)h(!)e(h)p FE(real)p Fy(i)i FE(*\))p eop
%%Page: 124 135
124 134 bop 1862 0 a FB(124)255 195 y FE(if)13 b(n)h(=)h(0)e(then)i
Fy(h)p FE(1.0)p Fy(i)407 260 y FE(else)g(if)e(even)i(n)g(then)g(sqr')f
(\(exp')g(\(n)h(div)f(2,x\)\))647 325 y(else)g Fy(h)p
FE(x)g(*)h(~)q(\(exp')g(\(n)f(-)g(1,x\)\))p Fy(i)p FE(.)150
412 y FI(The)g(second)h(w)o(a)o(y)e(of)h(annotating)f(it)g(is)h(as)g
(follo)o(ws:)221 501 y FE(fun)g(exp')g(\(n,x\))h(=)f(\(*)f(:)h(int)g
Fy(\002)g(h)p FE(real)p Fy(i)h(!)e(h)p FE(real)p Fy(i)i
FE(*\))255 565 y Fy(h)p FE(if)e(n)i(=)f(0)f(then)i(1.0)423
630 y(else)g(if)e(even)j(n)e(then)i(~)q(\(sqr')e(\(exp')h(\(n)f(div)g
(2,x\)\)\))663 695 y(else)g(x)g(*)h(~)q(\(exp')g(\(n)f(-)g(1,x\)\))p
Fy(i)p FE(.)150 782 y FI(In)o(tuitiv)o(ely)m(,)e(all)h(w)o(e)i(ha)o(v)o
(e)f(done)g(is)g(\\factored-out")g(the)h(Brac)o(k)o(ets)h(from)c(the)j
(Branc)o(hes)h(of)d(the)i(if-statemen)o(t)150 857 y(to)e(one)g(Brac)o
(k)o(et)h(around)e(the)i(whole)f(if-statemen)o(t.)e(This)i(function)f
(is)h(p)q(erfectly)h(w)o(ell-t)o(yp)q(ed,)e(but)h(the)h(anno-)150
931 y(tations)e(ha)o(v)o(e)f(just)h(created)i(a)d(non-terminating)f
(function)h(out)h(of)f(a)h(function)f(that)h(w)o(as)g(alw)o(a)o(ys)f
(terminating)150 1006 y(\(at)g(least)g(for)g(p)q(o)o(w)o(ers)g(of)g(0)f
(or)h(more\).)f(When)h(applied,)f(this)h(function)g(simply)e(mak)o(es)h
(rep)q(eated)i(calls)f(to)g(itself,)150 1081 y(constructing)j(bigger)f
(and)g(bigger)g(co)q(de)h(fragmen)o(ts.)d(In)i(partial)f(ev)n
(aluation,)f(this)j(problem)d(is)i(kno)o(wn)g(as)g FH(in-)150
1156 y(\014nite)h(unfolding)p FI(,)f(and)f(partial)g(ev)n(aluation)f
(systems)i(m)o(ust)e(tak)o(e)i(precautions)h(to)e(a)o(v)o(oid)f(it.)h
(In)h(MetaML,)f(the)150 1230 y(fact)f(that)h(there)h(are)f(suc)o(h)g
(anomalous)d(annotations)i(is)g(not)h(a)f(problem,)f(b)q(ecause)j(the)f
(programmer)d(sp)q(eci\014es)150 1305 y(explicitly)15
b(where)i(the)g(annotations)e(go.)g(In)h(particular,)f(whereas)j(with)d
(partial)g(ev)n(aluation)g(an)h(automatic)150 1380 y(analysis)c(\(BT)m
(A\))i(can)f(alter)g(the)h(termination)e(b)q(eha)o(vior)g(of)h(the)h
(program,)d(with)i(m)o(ulti-stage)e(programmi)o(ng)150
1455 y(the)i FH(pr)n(o)n(gr)n(ammer)f FI(is)g(the)h(one)g(who)f(has)h
(b)q(oth)g(con)o(trol)f(o)o(v)o(er,)g(and)h(resp)q(onsibilit)o(y)f
(for,)g(the)h(correctness)i(of)d(the)150 1529 y(termination)g(b)q(eha)o
(vior)i(of)f(the)i(annotated)f(program.)150 1663 y FG(7.1.2)48
b(The)15 b(Notion)g(of)g(a)h(Stage)150 1765 y FI(In)f(the)g(in)o(tro)q
(duction,)f(w)o(e)h(ga)o(v)o(e)f(the)h(in)o(tuitiv)o(e)f(explanation)g
(for)g(a)h(stage.)f(After)h(presen)o(ting)h(the)f(seman)o(tics)150
1840 y(for)i(MetaML,)g(w)o(e)h(can)f(no)o(w)g(pro)o(vide)g(a)g(more)f
(formal)f(de\014nition.)i(W)m(e)f(de\014ne)j(\(the)f(trace)g(of)s(\))f
FH(a)h(stage)j FI(as)150 1914 y FH(the)c(derivation)f(tr)n(e)n(e)g
(gener)n(ate)n(d)g(by)h(the)g(invo)n(c)n(ation)f(of)h(the)f(derivation)
h FE(run)12 b FF(e)1449 1887 y FA(0)1434 1914 y FF(,)-7
b Fy(!)14 b FF(v)q FI(.)h(\(See)i(the)f(Run)g(rule)f(in)150
1989 y(Chapter)f(5.\))f(Note)g(that)h(while)f(the)h(notion)e(of)h(a)g
(lev)o(el)g(is)g(de\014ned)i(with)e(resp)q(ect)i(to)e
FH(syntax)p FI(,)h(the)g(notion)f(of)f(a)150 2064 y(stage)i(is)g
(de\014ned)h(with)e(resp)q(ect)j(to)e FH(a)h(tr)n(ac)n(e)f(of)g(an)i
(op)n(er)n(ational)e(semantics)p FI(.)g(Although)f(quite)h(in)o(tuitiv)
o(e,)e(this)150 2139 y(distinction)j(w)o(as)f(not)h(alw)o(a)o(ys)f
(clear)i(to)f(us,)f(esp)q(ecially)i(that)f(there)h(do)q(es)g(not)f
(seem)f(to)h(b)q(e)h(an)o(y)e(comparable)150 2213 y(de\014nition)f(in)h
(the)g(literature)h(with)e(resp)q(ect)k(to)c(an)h(op)q(erational)f
(seman)o(tics.)150 2296 y(The)e(lev)o(els)f(of)g(the)h(subterms)g(of)f
(a)g(program)f(and)h(the)h(stages)h(in)o(v)o(olv)o(ed)d(in)h(the)h
(execution)g(of)f(the)h(program)e(can)150 2371 y(b)q(e)j(unrelated.)h
(A)f(program)e Fy(h)p FE(1+run)j Fy(h)p FE(4+2)p Fy(ii)f
FI(has)g(expressions)h(at)f(lev)o(els)g(0,)f(1,)g(and)h(2.)f(If)g(w)o
(e)h(de\014ne)h(the)g(\\lev)o(el)150 2446 y(of)d(a)g(program")f(as)h
(the)h(maxim)n(um)6 b(lev)o(el)k(of)g(an)o(y)g(of)g(its)g(sub)q
(expressions,)j(then)e(this)f(is)g(a)g(2-lev)o(el)g(program.)f(The)150
2521 y(ev)n(aluation)j(of)g(this)h(expression)h(\(whic)o(h)f(just)g(in)
o(v)o(olv)o(es)f(rebuilding)g(it\),)h(in)o(v)o(olv)o(es)f(no)g(deriv)n
(ations)h FE(run)f FF(e)1844 2493 y FA(0)1829 2521 y
FF(,)-7 b Fy(!)11 b FF(v)q FI(.)150 2595 y(On)j(the)f(other)h(hand,)f
(the)h(ev)n(aluation)e(of)g(sligh)o(tly)g(mo)q(di\014ed)g(2-lev)o(el)g
(program)g FE(run)h Fy(h)p FE(1+run)g Fy(h)p FE(4+2)p
Fy(ii)g FI(in)o(v)o(olv)o(es)150 2670 y(t)o(w)o(o)g(stages.)p
eop
%%Page: 125 136
125 135 bop 1862 0 a FB(125)150 192 y FI(T)m(o)15 b(further)h
(illustrate)f(the)h(distinction)f(b)q(et)o(w)o(een)i(lev)o(els)e(and)g
(stages,)h(let)f(us)h(de\014ne)g(the)g FH(numb)n(er)h(of)f(stages)150
266 y FI(of)c(a)h(program)f(as)h(the)h(n)o(um)o(b)q(er)e(of)h(times)f
(the)h(deriv)n(ation)g FE(run)f FF(e)1203 239 y FA(0)1188
266 y FF(,)-7 b Fy(!)11 b FF(v)j FI(is)f(used)h(in)f(its)g(ev)n
(aluation)1707 251 y FA(1)1724 266 y FI(.)g(Consider:)221
360 y FE(\(fn)h(x)g Fy(\))f FE(if)g(P)h(then)h(x)f(else)h(lift)o(\(run)
e(x\)\))h Fy(h)p FE(1+2)p Fy(i)p FE(.)150 451 y FI(where)e
FE(P)d FI(is)i(an)f(arbitrary)g(problem)f(\(in)h(other)h(w)o(ords,)f(a)
g(p)q(ossibly)g(non-terminating)e(program\).)h(The)i(n)o(um)o(b)q(er)
150 526 y(of)h(stages)h(in)f(this)h(program)e(is)h(not)g(statically)g
(decidable.)g(F)m(urthermore,)g(w)o(e)h(cannot)f(sa)o(y)m(,)g(in)g
(general,)g(whic)o(h)150 600 y(o)q(ccurrence)k(of)d(Run)g(will)f(b)q(e)
i(ultimately)d(resp)q(onsible)k(for)e(triggering)g(the)h(computation)d
(of)i(the)h(addition)e(in)150 675 y(expression)j Fy(h)p
FE(1+2)p Fy(i)p FI(.)150 758 y(Recognizing)h(this)h(mismatc)o(h)d(w)o
(as)j(a)f(useful)h(step)h(to)o(w)o(ards)f(\014nding)f(a)h(t)o(yp)q
(e-system)g(for)f(MetaML,)h(whic)o(h)150 833 y(emplo)o(ys)12
b(the)j(static)f(notion)f(of)h(lev)o(el)f(to)h(appro)o(ximate)e(the)i
(dynamic)e(notion)i(of)f(stage.)150 971 y FG(7.1.3)48
b(Co)q(de)16 b(Cannot)f(b)q(e)h(Added)e(to)h(SML)h(as)g(a)g(Datat)o(yp)
q(e)150 1077 y FI(The)d(simple)f(in)o(terpreter)i(for)f(MetaML)g
(discussed)h(in)f(Chapter)g(4)g(uses)h(a)e(datat)o(yp)q(e)h(to)g
(implem)o(en)o(t)e(the)i(co)q(de)150 1151 y(t)o(yp)q(e)h(constructor.)h
(An)f(in)o(teresting)h(question)f(is)g(whether)h(w)o(e)f(can)g
(de\014ne)h(some)e(similar)e(datat)o(yp)q(e)k(in)e(SML)150
1226 y FH(and)k FI(then)g(use)g(the)f(constructors)j(of)c(this)h(datat)
o(yp)q(e)h(in)e(place)i(MetaML's)f(Brac)o(k)o(ets)i(and)e(Escap)q(es.)h
(If)f(this)150 1301 y(w)o(ere)j(p)q(ossible,)g(then)g(w)o(e)f(could)g
(either)i(mak)o(e)d(the)i(datat)o(yp)q(e)f(used)i(in)e(the)h(in)o
(terpreter)h(a)o(v)n(ailable)c(to)i(the)150 1376 y(ob)r(ject)c
(language,)f(or,)g(w)o(e)g(can)h(a)o(v)o(oid)f(the)h(need)g(for)g(ha)o
(ving)e(to)h(implemen)o(t)e(a)j(full)e(in)o(terpreter)j(for)f(MetaML)
150 1450 y(altogether.)20 b(Unfortunately)m(,)f(there)j(is)e(a)g(n)o
(um)o(b)q(er)g(of)f(reasons)j(wh)o(y)e(MetaML's)g(co)q(de)h(t)o(yp)q(e)
g(constructor)150 1525 y(cannot)14 b(b)q(e)h(added)f(to)g(SML)f(as)h(a)
g(datat)o(yp)q(e.)150 1608 y(T)m(o)d(explain)g(these)i(reasons,)f
(assume)f(that)g(suc)o(h)i(a)e(datat)o(yp)q(e)h(exists)g(and)f(has)h
(some)f(declaration)g(of)g(the)h(form:)221 1707 y FE(datat)o(yp)q(e)j
('a)e(co)q(de)i(=)f(Int)g(of)f(...)524 1772 y Fy(j)34
b FE(V)o(a)o(r)14 b(of)f(...)524 1837 y Fy(j)34 b FE(Lam)14
b(of)f(...)524 1902 y Fy(j)34 b FE(App)15 b(of)e(...)524
1967 y Fy(j)34 b FE(...)150 2063 y FI(Essen)o(tially)12
b(ev)o(ery)h(single)f(v)n(arian)o(t)f(of)h(suc)o(h)h(a)f(datat)o(yp)q
(e)g(w)o(ould)f(con)o(tradict)i(some)e(basic)i(assumptions)e(ab)q(out)
150 2138 y(datat)o(yp)q(e)i(constructors.)h(T)m(o)d(see)j(this,)e
(recall)g(that)h(an)o(y)f(SML)g(datat)o(yp)q(e)h(construct)h(has)e(the)
h(follo)o(wing)d(t)o(yp)q(e:)799 2242 y FE(Constructo)o(r)j
FI(:)e FE(t)p FI([)1071 2225 y Fs(0)1082 2242 y FE(a)1102
2248 y Fu(i)1111 2242 y FI(])h Fy(!)1194 2225 y Fs(0)1206
2242 y FE(a)1226 2248 y Fu(i)1242 2242 y FE(T)150 2345
y FI(where)k FE(t)p FI([)305 2330 y Fs(0)316 2345 y FE(a)336
2351 y Fu(i)346 2345 y FI(])f(stands)g(for)g(a)g(t)o(yp)q(e)h(term)f
(that)g(is)g(closed)h(except)g(for)f(the)h(v)n(ariables)1507
2330 y Fs(0)1519 2345 y FE(a)1539 2351 y Fu(1)1557 2345
y FI(,..,)1612 2330 y Fs(0)1621 2345 y FE(a)1641 2351
y Fu(i)1651 2345 y FI(.)e(F)m(or)h(an)o(y)g(SML)150 2420
y(datat)o(yp)q(e,)f(w)o(e)g(also)f(get)h(a)g(deconstructor)i(with)d
(the)i(follo)o(wing)c(t)o(yp)q(e:)p 150 2490 237 2 v
158 2517 a Fz(1)188 2533 y FB(This)j(is)g(an)g(upp)q(er)g(b)q(ound)h
(on)f(what)f(one)h(ma)o(y)g(wish)g(to)f(de\014ne)h(as)g(the)f(n)o(um)o
(b)q(er)h(of)g FC(se)n(quentia)o(l)g FB(stages)g(in)g(a)g(m)o(ulti-)188
2579 y(stage)g(computation.)i(F)m(or)d(example,)i(elsewhere)g(w)o(e)e
(ha)o(v)o(e)h(de\014ned)h(the)f(n)o(um)o(b)q(er)h(of)e(stages)h(based)h
(on)f(a)f(data-\015o)o(w)188 2624 y(view)18 b(of)e(computation)j([93].)
d(The)h(de\014nition)i(giv)o(en)g(here)e(is)g(simplistic,)j(but)d(is)g
(su\016cien)o(t)h(for)f(illustratin)q(g)i(our)188 2670
y(p)q(oin)o(t.)p eop
%%Page: 126 137
126 136 bop 1862 0 a FB(126)779 301 y FE(Deconstructo)o(r)14
b FI(:)1064 284 y Fs(0)1076 301 y FE(a)1096 307 y Fu(i)1112
301 y FE(T)e Fy(!)f FE(t)p FI([)1239 284 y Fs(0)1250
301 y FE(a)1270 307 y Fu(i)1279 301 y FI(])150 453 y
FG(In)o(tegers)19 b FI(No)o(w)13 b(consider)i(the)g(case)f(of)g(in)o
(tegers.)g(The)g(in)o(teger)h(v)n(arian)o(t)d FE(EI)i
FI(should)f(ha)o(v)o(e)h(the)g(t)o(yp)q(e)877 645 y FE(EI)d
FI(:)g FE(int)h Fy(!)f FE(int)c(co)q(de)150 763 y FI(The)14
b(return)h(t)o(yp)q(e)f(is)g(not)f(p)q(olymorphic)f(enough:)h(W)m(e)h
(wish)f(to)h(de\014ne)g(a)g(datat)o(yp)q(e)1516 748 y
Fs(0)1527 763 y FE(a)g(co)q(de)h FI(and)e(the)i(return)150
838 y(t)o(yp)q(e)f(do)q(es)h(not)e(co)o(v)o(er)h(the)h(whole)e(datat)o
(yp)q(e.)g(This)h(problem)e(is)i(more)e(clear)j(when)f(w)o(e)g
(consider)g(the)g(t)o(yp)q(e)h(of)150 913 y(the)f(deconstructor:)853
1105 y FE(DeEI)d FI(:)g FE(int)c(co)q(de)14 b Fy(!)d
FE(int)150 1223 y FI(This)16 b(deconstructor)i(is)e(only)f(w)o(ell-t)o
(yp)q(ed)g(for)h FE(int)7 b(co)q(de)17 b FI(v)n(alues.)f(This)f(simple)
g(fact)h(means)f(that)h(w)o(e)g(cannot)150 1297 y(express)i(a)e(p)q
(olymorphic)f(iden)o(tit)o(y)h(function)g(for)971 1282
y Fs(0)983 1297 y FE(a)7 b(co)q(de)17 b FI(that)g(w)o(orks)f(b)o(y)g
(taking)g(apart)g(a)g(co)q(de)h(fragmen)o(t)150 1372
y(and)d(putting)f(it)h(bac)o(k)g(together.)150 1524 y
FG(V)l(ariables)19 b FI(The)14 b(v)n(ariable)f(v)n(arian)o(t)g
FE(EV)g FI(can)h(b)q(e)g(exp)q(ected)i(to)e(ha)o(v)o(e)g(the)g(t)o(yp)q
(e)871 1717 y FE(EV)d FI(:)g FE(t)c(va)o(r)12 b Fy(!)f
FE(t)c(co)q(de)150 1834 y FI(Again,)13 b(w)o(e)h(run)h(in)o(to)e(a)h
(problem)f(similar)f(to)i(the)g(one)h(ab)q(o)o(v)o(e,)e(b)q(ecause)j
(the)f(target)f(t)o(yp)q(e)h(is)f(not)g(completely)150
1909 y(p)q(olymorphic.)d(F)m(urthermore,)h(w)o(e)i(will)e(need)i(to)f
(in)o(tro)q(duce)h(an)f(explicit)g(notion)f(of)h(v)n(ariables)f(in)h
(the)h(form)e(of)150 1984 y(another)e(t)o(yp)q(e)g(constructor)610
1969 y Fs(0)621 1984 y FE(a)k(va)o(r)q FI(.)9 b(It)h(is)f(not)h(ob)o
(vious)f(whether)i(suc)o(h)f(a)f(t)o(yp)q(e)i(constructor)g(can)f(b)q
(e)g(in)o(tro)q(duced)150 2058 y(in)j(the)h(form)d(of)i(a)g(datat)o(yp)
q(e.)g(It)h(is)f(not)g(ev)o(en)h(clear)g(that)g(suc)o(h)g(a)f(t)o(yp)q
(e)h(constructor)h(can)e(b)q(e)h(in)o(tro)q(duced)g(in)f(a)150
2133 y(consisten)o(t)i(manner.)150 2285 y FG(Lam)o(b)q(da-abstraction)i
FI(The)d(lam)o(b)q(da-abstraction)e(v)n(arian)o(t)h FE(EL)h
FI(can)g(b)q(e)h(exp)q(ected)h(to)d(ha)o(v)o(e)h(the)g(t)o(yp)q(e)676
2478 y FE(EL)e FI(:)765 2460 y Fs(0)777 2478 y FE(a)7
b(va)o(r)j Fy(\002)f FI(\()930 2460 y Fs(0)942 2478 y
FE(b)e(co)q(de)p FI(\))13 b Fy(!)e FI(\()1154 2460 y
Fs(0)1166 2478 y FE(a)g Fy(!)1257 2460 y Fs(0)1269 2478
y FE(b)p FI(\))c FE(co)q(de)150 2595 y FI(Again,)15 b(w)o(e)h(run)h(in)
o(to)e(the)i(problem)d(of)i(the)g(target)h(t)o(yp)q(e)g(b)q(eing)f(not)
g(fully)e(co)o(v)o(ered.)j(In)f(addition,)e(the)j(\014rst)150
2670 y(o)q(ccurrence)k(of)419 2655 y Fs(0)430 2670 y
FE(b)d FI(is)g(more)f(complex)f(than)i(it)f(app)q(ears.)h(In)g
(particular,)f(it)h(should)f(b)q(e)i(p)q(ossible)f(that)f(the)p
eop
%%Page: 127 138
127 137 bop 1862 0 a FB(127)150 192 y FI(second)13 b(argumen)o(t)f(to)g
FE(EL)g FI(b)q(e)h(an)f(op)q(en)h(expression,)g(where)g(the)g(v)n
(ariable)e(b)q(ound)i(b)o(y)f(the)h(\014rst)g(argumen)o(t)e(can)150
266 y(o)q(ccur)16 b(free.)e(Th)o(us,)h(it)f(is)g(v)o(ery)h(lik)o(ely)e
(that)h(the)h(t)o(yp)q(e)1021 251 y Fs(0)1033 266 y FE(b)7
b(co)q(de)16 b FI(w)o(ould)d(b)q(e)j(insu\016cien)o(t)e(for)g
(describing)h(suc)o(h)g(a)150 341 y(fragmen)o(t,)c(as)j(the)g(fact)f
(that)h(it)f(is)g(a)752 326 y Fs(0)764 341 y FE(b)7 b(co)q(de)14
b FI(is)g(conditioned)f(b)o(y)g(\(at)g(least\))h(the)g(fact)f(that)h
(the)g(free)g(v)n(ariable)150 416 y(b)q(ound)i(b)o(y)g(this)g(lam)o(b)q
(da-abstraction)e(has)j(the)f(t)o(yp)q(e)1043 401 y Fs(0)1055
416 y FE(a)o FI(.)g(It)g(is)g(not)g(clear)h(ho)o(w)f(this)g(can)g(b)q
(e)h(accomplished)150 490 y(without)d(in)o(tro)q(ducing)f(additional)f
(substan)o(tial)i(mac)o(hinery)e(in)o(to)h(our)h(meta-language)e
(\(SML\).)150 648 y FG(Application)17 b FI(Finally)m(,)11
b(the)k(application)d(v)n(arian)o(t)h FE(EA)g FI(can)i(b)q(e)f(exp)q
(ected)i(to)e(ha)o(v)o(e)f(the)i(t)o(yp)q(e)676 847 y
FE(EA)c FI(:)g(\()786 830 y Fs(0)798 847 y FE(a)g Fy(!)889
830 y Fs(0)901 847 y FE(b)p FI(\))c FE(co)q(de)k Fy(\002)1083
830 y Fs(0)1095 847 y FE(a)c(co)q(de)13 b Fy(!)1274 830
y Fs(0)1285 847 y FE(b)7 b(co)q(de)150 972 y FI(Here,)17
b(w)o(e)g(do)f(not)h(run)g(in)o(to)e(the)j(same)d(problem)g(as)i(ab)q
(o)o(v)o(e:)f(the)h(target)g(t)o(yp)q(e)g(co)o(v)o(ers)g(the)g(whole)g
(domain.)150 1047 y(But)e(there)h(is)f(still)e(a)i(problem:)680
1032 y Fs(0)692 1047 y FE(a)g FI(is)f(a)g(free)i(t)o(yp)q(e)f(v)n
(ariable)e(in)i(the)g(t)o(yp)q(e)g(of)f(the)h(co-domain,)d(and)j(do)q
(es)g(not)150 1121 y(app)q(ear)e(in)e(the)i(t)o(yp)q(e)g(of)f(the)g
(domain.)e(It)i(ma)o(y)e(b)q(e)j(p)q(ossible)g(to)f(view)1258
1106 y Fs(0)1269 1121 y FE(a)g FI(as)h(an)f(existen)o(tially)f(quan)o
(ti\014ed)h(t)o(yp)q(e,)150 1196 y(but)i(it)g(is)f(not)h(ob)o(vious)f
(ho)o(w)h(this)g(w)o(ould)f(complicate)f(the)j(treatmen)o(t)f(of)f
(this)h(datat)o(yp)q(e.)150 1355 y FD(7.2)56 b(P)n(art)19
b(I:)f(The)g(Practice)g(of)h(Multi-Stage)e(Programming)150
1487 y FI(Sheard)12 b(dev)o(elop)q(ed)g(the)g(original)d(design)i(and)g
(implemen)o(tation)d(of)j(MetaML,)g(a)g(language)f(com)o(bining)f(a)i
(host)150 1562 y(of)i(desirable)i(language)e(features,)h(including:)176
1678 y FG({)21 b FI(Staging)12 b(annotations)176 1753
y FG({)21 b FI(Static)13 b(t)o(yping)176 1828 y FG({)21
b FI(Hindley-Milner)13 b(p)q(olymorphism)176 1903 y FG({)21
b FI(T)o(yp)q(e)14 b(inference.)150 2019 y(The)j(primary)d(goal)h(of)h
(the)g(design)h(is)f(to)g(pro)o(vide)g(a)g(language)f(w)o(ell-suited)h
(for)g(writing)f(program)f(genera-)150 2094 y(tors.)i(Tw)o(o)f
(implemen)o(tations)e(of)j(MetaML)g(ha)o(v)o(e)g(b)q(een)h(dev)o(elop)q
(ed.)f(The)g(\014rst)h(w)o(as)f(dev)o(elop)q(ed)h(b)o(y)e(Sheard)150
2168 y(b)q(et)o(w)o(een)f(1994)e(and)h(1996.)f(This)h(in)o(terpreter)h
(implemen)o(ted)d(a)i(pure)h(CBV)f(functional)f(language)g(with)h(p)q
(oly-)150 2243 y(morphic)j(t)o(yp)q(e)i(inference,)g(and)g(supp)q(ort)g
(for)f(recursiv)o(e)i(functions,)e(SML-st)o(yle)g(datat)o(yp)q(es,)h
(and)f(the)h(four)150 2318 y(staging)d(constructs)i(studied)f(in)f
(this)g(dissertation.)g(The)h(\014rst)g(implemen)o(tatio)o(n)d(w)o(as)i
(based)h(largely)e(on)h(an)150 2392 y(implemen)o(tatio)o(n)c(of)i
(CRML.)f(\(See)j(Section)f(7.2.3.\))d(The)j(dev)o(elopmen)o(t)f(of)g
(the)h(second)g(implemen)o(tation)c(b)o(y)150 2467 y(Sheard,)18
b(T)m(aha,)f(Benaissa)h(and)g(P)o(asalic)f(started)i(in)f(1996)f(and)g
(con)o(tin)o(ues)i(un)o(til)e(to)q(da)o(y)m(.)f(This)i(in)o(terpreter)
150 2542 y(aims)13 b(at)h(incorp)q(orating)g(full)g(SML)g(and)h
(extending)g(it)f(with)h(the)g(four)f(staging)g(constructs.)i(The)f
(highligh)o(ts)150 2617 y(of)e(MetaML)i(are:)p eop
%%Page: 128 139
128 138 bop 1862 0 a FB(128)176 192 y FG({)21 b(Cross-stage)10
b(p)q(ersistence.)e FI(The)j(abilit)o(y)e(to)h(use)h(v)n(ariables)f
(from)f(an)o(y)g(past)i(stage)g(is)f(crucial)h(to)f(writing)221
266 y(staged)i(programs)e(in)h(the)h(manner)f(to)g(whic)o(h)g
(programmers)f(are)i(accustomed.)f(Cross-stage)h(p)q(ersistence)221
341 y(pro)o(vides)f(a)g(solution)g(to)g(h)o(ygienic)f(macros)h(in)g(a)g
(t)o(yp)q(ed)h(language,)d(that)j(is,)f(macros)f(that)h(bind)g(iden)o
(ti\014ers)221 416 y(in)i(the)h(en)o(vironmen)o(t)f(of)h(de\014nition,)
f(whic)o(h)g(are)i(not)e(\\captured")i(in)e(the)i(en)o(vironmen)o(t)e
(of)g(use.)176 490 y FG({)21 b(Multi-stage)16 b(a)o(w)o(are)j(t)o(yp)q
(e)f(system.)e FI(The)h(t)o(yp)q(e)g(c)o(hec)o(k)o(er)h(rep)q(orts)g
(staging)e(errors)i(as)f(w)o(ell)f(as)g(t)o(yp)q(e)221
565 y(errors.)e(W)m(e)g(ha)o(v)o(e)f(found)h(the)g(in)o(teractiv)o(e)h
(t)o(yp)q(e)f(system)g(to)f(b)q(e)i(v)o(ery)f(useful)g(during)g
(staging.)176 640 y FG({)21 b(Displa)o(y)e(of)i(co)q(de.)e
FI(When)g(debugging,)f(it)h(is)f(imp)q(ortan)o(t)f(for)i(users)h(to)f
(b)q(e)h(able)e(to)h(read)h(the)f(co)q(de)221 715 y(pro)q(duced)e(b)o
(y)f(their)h(m)o(ulti-stage)d(programs.)g(Supp)q(orting)j(this)f
(MetaML)g(feature)h(requires)h(a)e(displa)o(y)221 789
y(mec)o(hanism)11 b(\(prett)o(y-prin)o(ter\))16 b(for)d(v)n(alues)h(of)
f(t)o(yp)q(e)h(co)q(de.)176 864 y FG({)21 b(Displa)o(y)11
b(of)i(constan)o(ts.)e FI(The)h(origin)f(of)h(a)g(cross-stage)h(p)q
(ersisten)o(t)h(constan)o(t)f(can)g(b)q(e)f(hard)h(to)f(iden)o(tify)m
(.)221 939 y(The)g(named)e Fu(\045)p 463 939 13 2 v 27
w FI(tags)h(pro)o(vide)h(an)f(appro)o(ximation)e(of)i(where)i(these)g
(constan)o(ts)f(came)f(from.)f(While)h(these)221 1013
y(tags)i(can)i(sometimes)d(b)q(e)i(misleading,)d(they)k(are)f(often)g
(quite)g(useful.)176 1088 y FG({)21 b(The)e(connection)d(b)q(et)o(w)o
(een)i Fy(h)p FE(A)p Fy(i)f(!)f(h)q FE(B)p Fy(i)j FG(and)f
Fy(h)p FE(A)f Fy(!)f FE(B)p Fy(i)p FG(.)h FI(Ha)o(ving)f(the)i(t)o(w)o
(o)e(mediating)f(functions)221 1163 y FE(back)g FI(and)e
FE(fo)o(rth)h FI(reduces)i(the)e(n)o(um)o(b)q(er)g(of)f(annotations)g
(needed)i(to)f(stage)h(programs.)176 1238 y FG({)21 b(Lift.)9
b FI(The)j(Lift)f(annotation)g(mak)o(es)f(it)i(p)q(ossible)f(to)h
(force)g(computation)e(in)h(an)g(early)h(stage)g(and)f(Lift)g(this)221
1312 y(v)n(alue)j(in)o(to)g(a)h(program)e(to)i(b)q(e)h(incorp)q(orated)
f(at)g(a)g(later)g(stage.)g(While)f(it)h(ma)o(y)e(seem)h(that)h
(cross-stage)221 1387 y(p)q(ersistence)21 b(mak)o(es)c(Lift)h
(unnecessary)m(,)h(Lift)f(helps)h(pro)q(ducing)g(co)q(de)g(that)f(is)h
(easier)g(to)f(understand,)221 1462 y(b)q(ecause)d(constan)o(ts)g(b)q
(ecome)f(explicit.)176 1536 y FG({)21 b(Safe)e FF(\014)j
FG(and)e(rebuild)o(in)o(g)d(optimizati)o(ons.)d FI(These)19
b(optimizations)c(impro)o(v)o(e)h(the)i(generated)h(co)q(de,)221
1611 y(and)13 b(often)h(mak)o(e)f(it)g(more)g(readable.)150
1759 y FG(7.2.1)48 b(Wh)o(y)16 b(Lam)o(b)q(da-Abstracti)o(on)d(is)i
(not)f(Enough)h(for)g(Multi-Stage)e(Programming)150 1875
y FI(It)g(ma)o(y)e(app)q(ear)j(that)f(staging)g(requires)h(only)f
(\\dela)o(y")f(and)h(\\force")g(op)q(erations)h(\(see)g(for)f(example)f
(Ok)n(asaki)150 1950 y(or)k(W)m(adler)f FH(et)i(al.)f
FI([65,)5 b(98],\))15 b(whic)o(h)h(can)h(b)q(e)f(implemen)o(ted)e(b)o
(y)i(lam)o(b)q(da-abstraction)e(and)i(application,)e(re-)150
2025 y(sp)q(ectiv)o(ely)m(.)g(While)f(this)h(ma)o(y)e(b)q(e)j(true)g
(for)e(certain)i(domains,)d(there)j(are)f(t)o(w)o(o)g(capabilities)f
(that)h(are)g(needed)150 2099 y(for)g(m)o(ulti-stage)d(programming)g
(and)i(are)i(not)e(pro)o(vided)h(b)o(y)g(\\dela)o(y")f(and)g(\\force":)
168 2216 y(1.)20 b(A)13 b(dela)o(y)o(ed)h(computation)e(m)o(ust)h(main)
o(tain)e(an)j(in)o(tensional)e(represen)o(tation)k(so)e(that)f(users)j
(can)e(insp)q(ect)221 2290 y(the)h(co)q(de)g(pro)q(duced)h(b)o(y)f
(their)g(generators,)g(and)g(so)g(that)f(it)h(can)f(b)q(e)i(either)f
(prin)o(ted)g(or)g(compiled.)e(In)h(a)221 2365 y(compiled)c(implemen)o
(tation,)f(lam)o(b)q(da-abstractions)i(lose)h(their)h(high-lev)o(el)e
(in)o(tensional)h(represen)o(tation,)221 2440 y(and)h(it)h(b)q(ecomes)g
(harder)h(to)e(insp)q(ect)i(or)f(prin)o(t)g(lam)o(b)q(da-abstractions)e
(at)i(run-time.)168 2514 y(2.)20 b(More)13 b(fundamen)o(tally)m(,)d(co)
q(de)k(generators)g(often)g(need)g(to)f(p)q(erform)f(\\ev)n(aluation)g
(under)i(lam)o(b)q(da".)c(Ev)n(al-)221 2589 y(uation)k(under)h(lam)o(b)
q(da)e(is)i(necessary)i(for)d(almost)f(an)o(y)h(staged)i(application)d
(that)i(p)q(erforms)f(some)g(kind)221 2664 y(of)i(unfolding,)g(and)h
(is)g(used)h(in)f(functions)g(suc)o(h)h(as)g FE(back)p
FI(.)g(It)f(is)g(not)g(clear)h(ho)o(w)f(the)h(e\013ect)h(of)e(Escap)q
(e)p eop
%%Page: 129 140
129 139 bop 1862 0 a FB(129)221 192 y FI(\(under)16 b(lam)o(b)q(da\))d
(can)j(b)q(e)g(imitated)e(in)h(the)h(CBV)g FF(\025)p
FI(-calculus)g(without)f(extending)h(it)f(with)g(additional)221
266 y(constructs.)150 382 y(T)m(o)j(further)h(explain)e(the)i(second)h
(p)q(oin)o(t,)d(w)o(e)i(will)e(sho)o(w)h(an)g(example)f(of)h(the)h
(result)g(of)f(enco)q(ding)h(of)e(the)150 457 y(op)q(erational)c(seman)
o(tics)g(of)h(MetaML)g(in)f(SML/NJ.)150 615 y FG(A)k(Sc)o(hema)e(for)h
(Enco)q(ding)f(MetaML)h(in)g(a)g(CBV)h(Language)f(with)f(E\013ects)21
b FI(The)15 b(essen)o(tial)g(ingre-)150 690 y(dien)o(ts)f(of)f(a)h
(program)e(that)i(requires)h(more)e(than)g(abstraction)h(and)g
(application)e(for)i(staging)f(are)h(Brac)o(k)o(ets,)150
764 y(dynamic)i(\(non-lev)o(el)h(0\))h(abstractions,)g(and)g(Escap)q
(es.)h(Lam)o(b)q(da-abstraction)d(o)o(v)o(er)i(unit)f(can)h(b)q(e)g
(used)h(to)150 839 y(enco)q(de)f(Brac)o(k)o(ets,)g(and)f(application)e
(to)i(unit)f(to)h(enco)q(de)h(Run.)e(Ho)o(w)o(ev)o(er,)h(Escap)q(e)h
(is)f(considerably)g(more)150 914 y(di\016cult)f(to)h(enco)q(de.)h(In)f
(particular,)f(the)i(expression)g(inside)f(an)g(Escap)q(e)h(has)f(to)g
(b)q(e)h(executed)h FH(b)n(efor)n(e)d FI(the)150 989
y(surrounding)e(dela)o(y)o(ed)f(computation)e(is)i(constructed.)j
(Implemen)o(ting)10 b(suc)o(h)k(an)f(enco)q(ding)h(is)f(di\016cult)f
(when)150 1063 y(v)n(ariables)17 b(in)o(tro)q(duced)h(inside)f(the)h
(dela)o(y)o(ed)f(expression)h(o)q(ccur)h(in)d(the)i(Escap)q(ed)h
(expression,)f(as)f(in)g(terms)150 1138 y(suc)o(h)e(as)f
Fy(h)p FE(fn)g(x)g Fy(\))g FE(~)q(\(f)g Fy(h)p FE(x)p
Fy(i)p FE(\))p Fy(i)p FI(.)150 1221 y(One)20 b(w)o(a)o(y)e(to)g
(imitate)f(this)i(b)q(eha)o(vior)g(uses)h(t)o(w)o(o)e(non-pure)i(SML)e
(features.)i(References)h(can)e(b)q(e)g(used)h(to)150
1296 y(sim)o(ulate)8 b(ev)n(aluation)h(under)i(lam)o(b)q(da,)c(and)j
(exceptions)h(to)f(sim)o(ulate)e(the)j(creation)f(of)g(uninitialized)e
(reference)150 1370 y(cells.)14 b(Consider)g(the)h(follo)o(wing)c
(sequence)16 b(of)d(MetaML)h(declarations:)221 1485 y
FE(fun)g(G)f(f)h(=)g Fy(h)p FE(fn)g(x)g Fy(\))h FE(~)q(\(f)e
Fy(h)p FE(x)p Fy(i)q FE(\))p Fy(i)221 1550 y FE(val)g(p)q(c)i(=)f(G)g
(\(fn)g(xc)g Fy(\))g(h)p FE(\()q(~)q(xc,)q(~)q(xc\))p
Fy(i)q FE(\))221 1615 y(val)f(p5)h(=)h(\(run)d(p)q(c\))j(5.)150
1724 y FI(The)f(corresp)q(onding)h(imitation)c(in)i(SML)h(w)o(ould)f(b)
q(e:)221 1830 y FE(exception)i(not)p 456 1830 13 2 v
16 w(y)o(et)p 523 1830 V 15 w(de\014ned)221 1895 y(val)e(unde\014ned)18
b(=)c(\(fn)g(\(\))g Fy(\))f FE(\(raise)i(not)p 843 1895
V 15 w(y)o(et)p 909 1895 V 15 w(de\014ned\)\))221 1960
y(fun)f(G)f(f)h(=)290 2025 y(let)g(val)g(xh)g(=)h(ref)f(unde\014ned)347
2089 y(val)g(xc)g(=)h(fn)f(\(\))g Fy(\))f FE(!xh)i(\(\))347
2154 y(val)f(nc)h(=)f(f)f(xc)290 2219 y(in)335 2284 y(fn)h(\(\))g
Fy(\))g FE(fn)g(x)g Fy(\))f FE(\(xh:=\(fn)i(\(\))f Fy(\))f
FE(x\);nc)i(\(\)\))290 2348 y(end;)221 2413 y(val)e(p)q(c)i(=)f(G)g
(\(fn)g(xc)g Fy(\))g FE(fn)g(\(\))g Fy(\))f FE(\(xc\(\),xc\(\)\)\))221
2478 y(val)g(p5)h(=)h(\(p)q(c)g(\(\)\))f(5.)150 2579
y FI(In)h(this)f(translation,)f(v)n(alues)i(of)f(t)o(yp)q(e)h
Fy(h)p FE('a)p Fy(i)f FI(are)h(enco)q(ded)h(b)o(y)e(dela)o(y)o(ed)g
(computations)g(of)g(t)o(yp)q(e)h FE(\(\))f Fy(!)26 b
FE('a)p FI(.)13 b(W)m(e)150 2654 y(b)q(egin)k(b)o(y)h(assigning)e(a)h
(lifted)g(unde\014ned)i(v)n(alue)d(to)i FE(unde\014ned)p
FI(.)i(No)o(w)d(w)o(e)h(are)g(ready)f(to)h(write)f(the)h(analog)p
eop
%%Page: 130 141
130 140 bop 1862 0 a FB(130)150 192 y FI(of)16 b(the)i(function)f
FE(G)p FI(.)f(Giv)o(en)g(a)h(function)g FE(f)p FI(,)f(the)i(function)f
FE(G)f FI(\014rst)i(creates)h(an)e(uninitialized)f(reference)j(cell)150
266 y FE(xh)p FI(.)14 b(This)g(reference)j(cell)d(corresp)q(onds)i(to)e
(the)h(o)q(ccurrences)i(of)d FE(x)g FI(in)f(the)i(application)e
FE(f)h Fy(h)p FE(x)p Fy(i)g FI(in)g(the)h(MetaML)150
341 y(de\014nition)f(of)f FE(G)p FI(.)h(In)o(tuitiv)o(ely)m(,)e(the)j
(fact)f(that)g FE(xh)h FI(is)f(uninitialized)f(corresp)q(onds)j(to)e
(the)h(fact)f(that)g FE(x)g FI(will)f(not)150 416 y(y)o(et)j(b)q(e)g(b)
q(ound)f(to)g(a)g(\014xed)h(v)n(alue)f(when)g(the)h(application)e
FE(f)h Fy(h)p FE(x)p Fy(i)h FI(is)f(to)g(b)q(e)h(p)q(erformed.)f(This)g
(facilit)o(y)e(is)j(v)o(ery)150 490 y(imp)q(ortan)o(t)c(in)i(MetaML,)f
(as)h(it)g(allo)o(ws)e(us)j(to)e(unfold)g(functions)h(lik)o(e)f
FE(f)h FI(on)f(\\dumm)o(y")e(v)n(ariables)i(lik)o(e)g
FE(x)p FI(.)h(The)150 565 y(expression)i FE(fn)e(\(\))h
Fy(\))f FE(!xh)h(\(\))g FI(is)f(a)h(dela)o(y)o(ed)f(lo)q(okup)g(of)f
FE(xh)p FI(.)i(This)f(dela)o(y)o(ed)h(computation)e(corresp)q(onds)j
(to)e(the)150 640 y(Brac)o(k)o(ets)20 b(surrounding)e
FE(x)g FI(in)g(the)h(expression)g FE(f)f Fy(h)p FE(x)p
Fy(i)q FI(.)g(No)o(w,)f(w)o(e)h(simply)f(p)q(erform)g(the)i
(application)e(of)g(the)150 715 y(function)f FE(f)g FI(to)g(this)g
(dela)o(y)o(ed)g(construction.)g(It)h(is)f(imp)q(ortan)o(t)e(to)i(note)
g(here)i(that)e(w)o(e)g(are)h(applying)d FE(f)i FI(as)g(it)150
789 y(is)h(passed)h(to)e(the)i(function)f FE(G)p FI(,)f(b)q(efore)h(w)o
(e)h(kno)o(w)e(what)h(v)n(alue)f FE(x)h FI(is)g(b)q(ound)g(to.)f
(Finally)m(,)f(the)i(b)q(o)q(dy)g(of)f(the)150 864 y(function)e
FE(G)h FI(returns)h(a)e(dela)o(y)o(ed)h(lam)o(b)q(da-abstraction,)d
(whic)o(h)i(\014rst)i(assigns)f(a)f(dela)o(y)o(ed)h(v)o(ersion)g(of)f
FE(x)g FI(to)h FE(xh)p FI(,)150 939 y(and)f(then)g(simply)e(includes)i
(an)g(applied)f(\(\\Escap)q(ed"\))j(v)o(ersion)e(of)f
FE(nc)i FI(in)e(the)i(b)q(o)q(dy)e(of)h(this)g(abstraction.)150
1022 y(The)f(transliteration)f(illustrates)h(the)g(adv)n(an)o(tage)f
(of)g(using)g(MetaML)h(rather)g(than)g(trying)f(to)h(enco)q(de)g(m)o
(ulti-)150 1096 y(stage)20 b(programs)f(using)g(lam)o(b)q
(da-abstractions,)e(references,)22 b(and)e(exceptions.)g(The)g(MetaML)g
(v)o(ersion)g(is)150 1171 y(shorter,)15 b(more)e(concise,)h(lo)q(oks)f
(lik)o(e)g(the)i(unstaged)f(v)o(ersion,)g(and)g(is)f(easier)i(to)f
(understand.)150 1254 y(One)k(migh)o(t)d(consider)j(an)e(implemen)o
(tation)e(of)i(MetaML)i(based)f(on)g(this)g(approac)o(h,)g(hidden)g
(under)h(some)150 1329 y(syn)o(tactic)i(sugar)g(to)f(alleviate)g(the)h
(disadv)n(an)o(tages)f(listed)h(ab)q(o)o(v)o(e.)f(The)h(lam)o(b)q
(da-dela)o(y)d(metho)q(d)i(has)g(the)150 1404 y(adv)n(an)o(tage)c(of)h
(b)q(eing)g(a)f(mac)o(hine-indep)q(enden)o(t)h(manipulation)d(of)i(lam)
o(b)q(da)f(terms.)i(Unfortunately)f(it)h(fails)150 1478
y(to)g(meet)f(the)i(in)o(tensional)e(represen)o(tation)i(criterion,)f
(and)g(also)f(incurs)i(some)e(o)o(v)o(erhead)h(not)g(\(necessarily\))
150 1553 y(incurred)f(in)f(the)h(MetaML)f(v)o(ersion.)g(In)g
(particular,)g(the)g(last)g(assignmen)o(t)f(to)h(the)h(reference)i
FE(xh)e FI(is)f(dela)o(y)o(ed,)150 1628 y(and)k(m)o(ust)g(b)q(e)h(rep)q
(eated)h(ev)o(ery)f(time)e(the)i(function)g(returned)h(b)o(y)e
FE(G)g FI(is)g(used.)h(The)g(same)f(happ)q(ens)h(with)150
1703 y(the)d(application)e(\(\\Escaping"\))h(of)g FE(nc)p
FI(.)h(Neither)g(of)f(these)h(exp)q(enses)i(w)o(ould)c(b)q(e)i
(incurred)h(b)o(y)e(the)h(MetaML)150 1777 y(v)o(ersion)d(of)f
FE(G)p FI(.)f(In)o(tuitiv)o(ely)m(,)g(these)j(op)q(erations)e(are)h(b)q
(eing)g(used)g(to)g(connect)g(the)h(meta-lev)o(el)d(v)n(ariable)g
FE(x)i FI(to)f(its)150 1852 y(corresp)q(onding)i(ob)r(ject-lev)o(el)f
FE(xh)p FI(.)g(In)g(MetaML,)g(these)h(o)o(v)o(erheads)g(w)o(ould)e(b)q
(e)i(incurred)g(exactly)f(once)g(during)150 1927 y(the)h(ev)n(aluation)
f(of)g FE(run)g(p)q(c)i FI(as)f(opp)q(osed)g(to)g(ev)o(ery)h(time)d
(the)j(function)e(resulting)h(from)e FE(p)q(c)j(\(\))f
FI(is)g(applied.)150 2074 y FG(7.2.2)48 b(Cross-Stage)14
b(P)o(ortabili)o(t)o(y)150 2190 y FI(Cross-stage)j(p)q(ersistence)i(is)
c(a)h(no)o(v)o(el)f(feature)i(of)e(MetaML)h(that)g(did)g(not)g({)f(to)h
(our)g(kno)o(wledge)g({)f(exist)h(in)150 2265 y(an)o(y)c(previous)i
(prop)q(osals)e(for)h(run-time)f(co)q(de)h(generation.)g(This)f
(language)g(feature)i(seems)f(highly)f(desirable)150
2340 y(in)h(run-time)g(co)q(de)i(generation)f(systems,)g(where)h(there)
g(is)e(generally)h(little)f(in)o(terest)i(in)f(insp)q(ecting)g(a)g
(source)150 2415 y(lev)o(el)k(represen)o(tation)i(of)d(programs.)g(But)
h(for)g(high-lev)o(el)f(program)g(generation,)h(cross-stage)h(p)q
(ersistence)150 2489 y(comes)c(at)g(a)g(price:)g(Some)f(parts)i(of)f
(generated)h(co)q(de)g(fragmen)o(t)e(ma)o(y)f(not)i(b)q(e)h(prin)o
(table.)f(F)m(or)f(example,)g(let)150 2564 y(us)g(consider)h(the)g
(follo)o(wing)c(simple)h(SML/NJ)i(session:)221 2670 y
FE(-)f(40+2;)p eop
%%Page: 131 142
131 141 bop 1862 0 a FB(131)221 195 y FE(val)13 b(it)h(=)g(42)g(:)f
(int)221 260 y(-)g(fn)h(x)g Fy(\))g FE(x;)221 325 y(val)f(it)h(=)g(fn)g
(:)25 b('a)13 b Fy(!)25 b FE('a.)150 422 y FI(The)16
b(result)f(of)g(ev)n(aluating)e(the)j(\014rst)g(v)n(ariable)e(is)h
(prin)o(ted)g(bac)o(k)g(as)g FE(42)p FI(,)f(but)i(not)f(the)g(result)h
(of)f(the)g(second.)150 497 y(Because)j(SML/NJ)e(is)g(a)g(compiled)e
(implemen)o(tation,)e(the)17 b(result)f(of)g(ev)n(aluating)e
FE(fn)j(x)f Fy(\))f FE(x)h FI(is)g(a)g(structure)150
572 y(con)o(taining)10 b(some)h(mac)o(hine)f(co)q(de.)i(This)f
(structure)i(is)e(not)h(prin)o(ted)f(bac)o(k)h(b)q(ecause)h(it)e(is)g
(mac)o(hine-dep)q(enden)o(t,)150 647 y(and)16 b(is)g(considered)i
(implemen)o(tation)13 b(detail.)i(But)i(indep)q(enden)o(tly)h(of)d
(whether)j(this)f(structure)h(should)e(b)q(e)150 721
y(prin)o(ted)i(or)g(not,)f(the)h(source-lev)o(el)h(represen)o(tation)g
(of)e(our)h(function)f(is)g(generally)h(not)f(main)o(tained)f(after)150
796 y(compilation.)6 b(The)k(lac)o(k)f(of)g(high-lev)o(el)g(represen)o
(tations)i(of)e(v)n(alues)g(at)h(run-time)e(is)i(the)g(reason)g(wh)o(y)
f(\\inlining")150 871 y(cross-stage)19 b(p)q(ersisten)o(t)g(v)n
(ariables)d(is)h(generally)g(not)g(p)q(ossible.)g(F)m(or)f(example,)g
(in)g(the)i(follo)o(wing)d(MetaML)150 945 y(session:)221
1047 y Fy(j)p FE(-)e(\(fn)h(y)g Fy(\))f(h)p FE(y)p Fy(i)q
FE(\))h(\(fn)g(x)g Fy(\))f FE(x\);)221 1112 y(val)g(it)h(=)g
Fy(h)p Fu(\045)p FE(y)p Fy(i)g FE(:)g Fy(h)d FE('a)j
Fy(!)25 b FE('a)p Fy(i)o FE(.)150 1209 y FI(w)o(e)15
b(cannot)f(return)h Fy(h)q FE(fn)f(x)g Fy(\))g FE(x)p
Fy(i)p FI(,)g(b)q(ecause)i(the)f(source-lev)o(el)g(represen)o(tation)h
(of)e FE(fn)g(x)h Fy(\))e FE(x)i FI(is)f(simply)e(lost)i(at)150
1284 y(the)g(p)q(oin)o(t)g(when)g(the)h(application)d(is)i(p)q
(erformed.)150 1367 y(Loss)19 b(of)e(prin)o(tabilit)o(y)g(p)q(oses)i(a)
f(practical)g(problem)f(if)g(the)i(\014rst)g(stage)g(of)e(a)h(m)o
(ulti-stage)f(computation)f(is)150 1442 y(p)q(erformed)e(on)g(one)g
(computer,)g(and)g(the)g(second)i(on)d(another.)i(In)f(this)g(case,)h
(w)o(e)f(need)h(to)f(\\p)q(ort")g(the)h(lo)q(cal)150
1517 y(en)o(vironmen)o(t)f(from)f(the)j(\014rst)g(mac)o(hine)e(to)g
(the)i(second.)g(Since)f(arbitrary)g(ob)r(jects,)h(suc)o(h)g(as)f
(functions)g(and)150 1591 y(closures,)g(can)g(b)q(e)f(b)q(ound)h(in)f
(this)g(lo)q(cal)f(en)o(vironmen)o(t,)g(this)h(em)o(b)q(edding)g(can)g
(cause)h(p)q(ortabilit)o(y)e(problems.)150 1666 y(Curren)o(tly)m(,)g
(MetaML)i(assumes)e(that)h(the)h(computing)d(en)o(vironmen)o(t)h(do)q
(es)i(not)e(c)o(hange)i(b)q(et)o(w)o(een)g(stages,)f(or)150
1741 y(more)e(generally)m(,)g(that)i(w)o(e)f(are)h(computing)e(in)h(an)
g FH(inte)n(gr)n(ate)n(d)h(system)p FI(.)e(Th)o(us,)h(curren)o(t)i
(MetaML)f(implemen-)150 1816 y(tations)d(lac)o(k)g FH(cr)n
(oss-platform)h(p)n(ortability)p FI(,)e(but)i(w)o(e)g(b)q(eliev)o(e)g
(that)g(this)f(limitation)d(can)k(b)q(e)h(reco)o(v)o(ered)g(through)150
1890 y(pic)o(kling)g(and)g(unpic)o(kling)g(tec)o(hniques.)150
2034 y FG(7.2.3)48 b(Linguist)o(ic)13 b(Re\015ection)g(and)i(Related)f
(MetaML)i(Researc)o(h)150 2147 y FH(\\Linguistic)e(r)n(e\015e)n(ction)f
(is)h(de\014ne)n(d)g(as)g(the)g(ability)f(of)g(a)h(pr)n(o)n(gr)n(am)f
(to)h(gener)n(ate)g(new)f(pr)n(o)n(gr)n(am)g(fr)n(agments)g(and)150
2222 y(to)f(inte)n(gr)n(ate)g(these)g(into)g(its)f(own)i(exe)n(cution)f
([89].")f FI(MetaML)g(is)g(a)g(descenden)o(t)i(of)d(CRML)g([79,)c(80,)g
(37],)j(whic)o(h)150 2296 y(in)16 b(turn)i(w)o(as)f(greatly)f
(in\015uenced)j(b)o(y)d(TRPL)h([77,)5 b(78].)16 b(All)g(three)i(of)f
(these)h(languages)e(supp)q(ort)i(linguistic)150 2371
y(re\015ection.)12 b(Both)f(CRML)g(and)g(TRPL)g(w)o(ere)h(t)o(w)o
(o-stage)f(languages)g(that)g(allo)o(w)o(ed)f(users)j(to)e(pro)o(vide)g
(compile-)150 2446 y(time)f(functions)h(\(m)o(uc)o(h)f(lik)o(e)g
(macros\))g(whic)o(h)h(directed)h(the)g(compiler)d(to)i(p)q(erform)f
(compile-time)e(reductions.)150 2521 y(Both)k(emphasized)f(the)h(use)g
(of)f(computations)f(o)o(v)o(er)i(represen)o(tations)h(of)e(a)g
(program's)f(datat)o(yp)q(e)h(de\014nitions.)150 2595
y(By)17 b(generating)f(functions)h(from)d(datat)o(yp)q(e)j
(de\014nitions,)f(it)f(w)o(as)i(p)q(ossible)f(to)g(create)i(sp)q
(eci\014c)g(instances)g(of)150 2670 y(generic)12 b(functions)g(suc)o(h)
g(as)f(equalit)o(y)f(functions,)h(prett)o(y)h(prin)o(ters,)g(and)f
(parsers)i([78].)c(This)i(facilit)o(y)f(pro)o(vided)p
eop
%%Page: 132 143
132 142 bop 1862 0 a FB(132)150 192 y FI(an)17 b(abstraction)h(mec)o
(hanism)d(not)i(a)o(v)n(ailable)f(in)h(traditional)f(languages.)g
(MetaML)i(impro)o(v)o(es)e(up)q(on)i(these)150 266 y(languages)e(b)o(y)
h(adding)f(h)o(ygienic)g(v)n(ariables,)g(generalizing)g(the)i(n)o(um)o
(b)q(er)e(of)g(stages,)h(and)g(emphasizing)e(the)150
341 y(soundness)g(of)f(its)g(t)o(yp)q(e)g(system.)150
424 y(Sheard)j(and)f(Nelson)h(in)o(v)o(estigate)f(a)g(t)o(w)o(o-stage)h
(language)e(for)h(the)h(purp)q(ose)h(of)d(program)g(generation)i([82].)
150 499 y(The)12 b(base)f(language)f(w)o(as)h(statically)g(t)o(yp)q
(ed,)g(and)g(dep)q(enden)o(t)i(t)o(yp)q(es)f(w)o(ere)g(used)g(to)f
(generate)h(a)f(wider)g(class)h(of)150 573 y(programs)h(than)h(is)g(p)q
(ossible)g(b)o(y)g(MetaML)g(restricted)j(to)d(t)o(w)o(o)f(stages.)i
(Sheard,)f(Shields)g(and)g(P)o(eyton-Jones)150 648 y([83])f(in)o(v)o
(estigate)h(a)g(dynamic)f(t)o(yp)q(e)i(system)f(for)g(m)o(ulti-staged)e
(programs)h(where)j(some)d(t)o(yp)q(e)i(obligations)e(of)150
723 y(staged)h(computations)f(can)h(b)q(e)h(put)f(o\013)f(till)g
(run-time.)150 881 y FD(7.3)56 b(P)n(art)19 b(I)r(I:)f(The)g(Theory)g
(of)h(Multi-Stage)e(Programming)150 1004 y FG(7.3.1)48
b(Multi-Lev)o(el)12 b(Sp)q(ecialization)150 1121 y FI(Gl)q(\177)-22
b(uc)o(k)19 b(and)g(J\034rgensen)i([29])d(in)o(tro)q(duced)j(the)f
(idea)f(of)g(m)o(ulti-lev)o(el)e(BT)m(A)i(\(MBT)m(A\))h(as)g(an)f
(e\016cien)o(t)h(and)150 1195 y(e\013ectiv)o(e)d(alternativ)o(e)f(to)f
(m)o(ultiple)f(self-application.)g(A)i(m)o(ulti-lev)o(el)d(language)i
(based)h(on)g(Sc)o(heme)f(is)h(used)150 1270 y(for)f(the)i(presen)o
(tation.)f(MetaML)g(has)f(few)o(er)i(primitiv)o(es)c(than)j(this)g
(language,)e(and)h(our)h(fo)q(cus)g(is)g(more)e(on)150
1345 y(program)i(generation)h(issues)i(rather)f(than)f(those)h(of)f(BT)
m(A.)g(All)g(in)o(termediate)f(results)j(in)e(their)g(w)o(ork)h(are)150
1419 y(prin)o(table,)e(that)g(is,)g(ha)o(v)o(e)h(an)f(in)o(tensional)f
(represen)o(tation.)j(In)f(MetaML,)f(cross-stage)i(p)q(ersistence)h
(allo)o(ws)150 1494 y(us)g(to)f(ha)o(v)o(e)g(in)o(termediate)g(results)
i(b)q(et)o(w)o(een)f(stages)h(that)e(con)o(tain)g(constan)o(ts)h(for)f
(whic)o(h)h(no)f(in)o(tensional)150 1569 y(represen)o(tation)d(is)f(a)o
(v)n(ailable.)150 1652 y(A)20 b(second)g(w)o(ork)f(b)o(y)h(Gl)q(\177)
-22 b(uc)o(k)18 b(and)i(J\034rgensen)h([30])d(demonstrates)h(that)h
(MBT)m(A)f(can)h(b)q(e)g(done)g(with)f(e\016-)150 1727
y(ciency)13 b(comparable)e(to)h(that)g(of)g(t)o(w)o(o-lev)o(el)f(BT)m
(A.)h(Their)h(MBT)m(A)f(is)g(implemen)o(ted)e(using)i(constrain)o
(t-solving)150 1801 y(tec)o(hniques.)j(The)f(MBT)m(A)g(is)g(t)o(yp)q
(e-based,)g(but)g(the)h(underlying)e(language)g(is)h(dynamically)d(t)o
(yp)q(ed.)150 1884 y(Gl)q(\177)-22 b(uc)o(k)17 b(and)h(J\034rgensen)i
(also)d(study)i(partial)e(ev)n(aluation)f(in)i(the)h(generalized)g(con)
o(text)f(where)h(inputs)g(can)150 1959 y(arriv)o(e)e(at)g(an)g
(arbitrary)g(n)o(um)o(b)q(er)f(of)g(times)h(rather)h(than)f(just)g(sp)q
(ecialization-time)e(and)i(run-time)f(in)g(the)150 2034
y(con)o(text)f(of)e(a)h(\015o)o(w-c)o(hart)g(language)f(called)h
(S-Graph-)p FF(n)f FI([31].)f(This)i(language)f(can)h(b)q(e)h(view)o
(ed)f(as)g(a)g(dynam-)150 2108 y(ically)i(t)o(yp)q(ed)j(m)o(ulti-lev)o
(el)c(programmi)o(ng)g(language.)h(S-Graph-)p FF(n)h
FI(w)o(as)h(not)f(designed)i(for)e(h)o(uman)f(use)j(\(as)150
2183 y(a)c(programmi)o(ng)d(language\),)i(but)h(rather,)g(for)g(b)q
(eing)f(pro)q(ducing)h(automatically)d(b)o(y)j(program)e(generators.)
150 2258 y(One)19 b(of)e(the)i(con)o(tributions)f(of)f(this)h
(dissertation)h(is)f(emphasising)e(that)i(programmers)e(can)j(write)f
(useful)150 2333 y(m)o(ulti-stage)d(programs)h(directly)h(in)g(an)f
(appropriate)i(programmi)o(ng)c(language)i(\(suc)o(h)i(as)f(MetaML\),)g
(and)150 2407 y(that)12 b(while)f(an)g(automatic)e(analyses)j(suc)o(h)g
(as)g(BT)m(A)f(and)h(MBT)m(A)f(can)h(b)q(e)g(v)o(ery)g(useful,)f(they)h
(are)g(not,)f(strictly)150 2482 y(sp)q(eaking,)i(necessary)j(for)e(m)o
(ulti-stage)e(programmi)o(ng.)150 2565 y(Hatcli\013)j(and)g(Gl)q(\177)
-22 b(uc)o(k)14 b(study)i(the)g(issues)g(in)o(v)o(olv)o(ed)e(in)h(the)h
(implemen)o(tati)o(on)c(of)j(a)g(language)f(lik)o(e)h(S-Graph-)p
FF(n)150 2640 y FI([35].)e(The)i(syn)o(tax)g(of)f(S-Graph-)p
FF(n)g FI(explicitly)g(captures)i(all)d(the)j(information)c(necessary)k
(for)f(sp)q(ecifying)f(the)p eop
%%Page: 133 144
133 143 bop 1862 0 a FB(133)150 192 y FI(staging)14 b(of)g(a)g
(computation:)e(eac)o(h)j(construct)h(is)e(annotated)h(with)f(a)g(n)o
(um)o(b)q(er)g(indicating)f(the)i(stage)g(during)150
266 y(whic)o(h)j(it)f(is)h(to)g(b)q(e)g(executed,)h(and)f(all)f(v)n
(ariables)g(are)h(annotated)g(with)g(a)f(n)o(um)o(b)q(er)g(indicating)g
(the)i(stage)150 341 y(of)e(their)h(a)o(v)n(ailabilit)o(y)l(.)c(The)k
(annotations)f(of)g(this)h(language)f(w)o(ere)h(one)g(of)f(our)h(motiv)
n(ations)d(for)i(studying)150 416 y(lev)o(el-annotations)11
b(in)h(MetaML.)h(\(See)g FF(\025)p FI(-T)f(of)g(App)q(endix)h(A.\))f
(One)h(notable)f(di\013erence)j(is)d(that)g(the)h(explicit)150
490 y(lev)o(el)f(annotations)h(of)f FF(\025)p FI(-T)g(re\015ect)j(\\in)
o(tended")e(usage-time)e(as)i(opp)q(osed)h(to)e(a)o(v)n(ailabilit)o(y)d
(time.)i(Av)n(ailabilit)o(y)150 565 y(in)k(our)h(formalism)o(s)d(has)j
(generally)f(b)q(een)i(re\015ected)h(at)d(the)h(lev)o(el)g(of)f(the)h
(t)o(yp)q(e)g(system,)f(and)g(in)g(the)i(t)o(yping)150
640 y(en)o(vironmen)o(t.)8 b(S-Graph-)p FF(n)i FI(is)g(dynamically)d(t)
o(yp)q(ed,)j(and)g(the)g(syn)o(tax)g(and)g(formal)d(seman)o(tics)j(of)f
(the)i(language)150 715 y(are)h(sizable.)f(Programmi)o(ng)e(directly)i
(in)g(S-Graph-)p FF(n)g FI(w)o(ould)f(require)i(the)g(user)h(to)e
(annotate)g(ev)o(ery)h(construct)150 789 y(and)i(v)n(ariable)e(with)i
(stage)g(annotations,)e(and)i(ensuring)g(the)g(consistency)i(of)d(the)h
(annotations)f(is)h(the)g(user's)150 864 y(resp)q(onsibilit)o(y)m(.)g
(These)i(explicit)e(annotations)h(are)g(not)g(necessarily)h(a)f
(serious)h(dra)o(wbac)o(k,)e(as)h(the)h(language)150
939 y(w)o(as)j(in)o(tended)h(primarily)d(as)j(an)f(in)o(ternal)g
(language)f(for)i(program)d(transformation)h(systems.)h(Ho)o(w)o(ev)o
(er,)150 1013 y(w)o(e)h(b)q(eliev)o(e)g(that)f(further)i(simplifying)16
b(this)k(language)e(could)i(mak)o(e)e(v)o(erifying)g(the)j(correctness)
h(of)d(suc)o(h)150 1088 y(program)13 b(transformation)g(systems)i
(easier.)g(Finally)m(,)e(Hatcli\013)h(and)h(Gl)q(\177)-22
b(uc)o(k)14 b(ha)o(v)o(e)h(also)f(iden)o(ti\014ed)h FH(language-)150
1163 y(indep)n(endenc)n(e)j FI(of)13 b(the)g(in)o(ternal)g(represen)o
(tation)i(of)e(\\co)q(de")g(as)h(an)f(imp)q(ortan)o(t)e(c)o
(haracteristic)k(of)e(an)o(y)f(m)o(ulti-)150 1238 y(stage)i(language.)
150 1321 y(Gl)q(\177)-22 b(uc)o(k,)16 b(Hatcli\013)h(and)g
(J\034rgensen)h(con)o(tin)o(ue)f(the)h(study)g(of)e(S-Graph-)p
FF(n)p FI(,)g(fo)q(cusing)h(on)g(issue)h(of)e(generaliza-)150
1395 y(tion)d(of)g(data)h(in)f(m)o(ulti-lev)o(el)e(transformation)h
(systems)i(\(suc)o(h)g(as)g(self-applicable)f(partial)f(ev)n
(aluation\))h([28].)150 1470 y(This)i(w)o(ork)g(adv)o(o)q(cates)g
(S-Graph-)p FF(n)g FI(as)g(an)g(appropriate)g(represen)o(tation)h(for)f
(meta-system)e(hierarc)o(hies.)j(In)150 1545 y(essence,)f(a)d
(meta-system)f(hierarc)o(h)o(y)i(is)f(a)g(sequence)j(of)c
(meta-programs)f(where)k(eac)o(h)f(meta-program)d(is)i(ma-)150
1619 y(nipulating)k(the)i(next)g(program)e(in)h(the)h(sequence.)h
(Roughly)d(sp)q(eaking,)h(generalization)g(\(more)g(precisely)m(,)150
1694 y(\014nding)c(the)g(most)f(sp)q(eci\014c)j(generalization\))d(is)h
(the)h(pro)q(cess)h(of)e(\014nding)f(the)i(most)e(precise)i(c)o
(haracterization)150 1769 y(of)f(an)h(expression)h(in)e(terms)h(its)g
(p)q(osition)f(in)g(the)i(hierarc)o(h)o(y)m(.)e(The)h(w)o(ork)g(iden)o
(ti\014es)g(and)g(addresses)i(t)o(w)o(o)d(fun-)150 1844
y(damen)o(tal)e(problems)h(that)h(arise)g(in)f(when)h(considering)g
(suc)o(h)h(hierarc)o(hies,)f(namely)e(the)j FH(sp)n(ac)n(e)g(c)n
(onsumption)150 1918 y(pr)n(oblem)f FI(and)g(the)h FH(invarianc)n(e)h
(pr)n(oblem)p FI(.)e(The)h(space)g(consumption)e(problem)h(arises)h
(due)g(to)f(the)h(p)q(ossibilit)o(y)150 1993 y(of)g(enco)q(ding)h(ob)r
(ject-programs)g(m)o(ultiple)d(times)i(in)h(suc)o(h)g(a)g(hierarc)o(h)o
(y)m(.)f(The)i(space)g(consumption)d(problem)150 2068
y(cannot)h(b)q(e)h(seen)g(in)e(our)h(w)o(ork,)g(b)q(ecause)h(w)o(e)f
(ha)o(v)o(e)g(either)h(used)g(lev)o(el-annotated)e(terms)h(\()p
FF(\025)p FI(-T)g(of)g(App)q(endix)150 2143 y(A\),)f(whic)o(h)g(are)g
(similar)e(in)i(spirit)g(to)g(the)g(S-Graph-)p FF(n)g
FI(solution,)f(or)h(ab)q(olished)g(the)g(quest)h(for)f(distinguishing)
150 2217 y(unenco)q(ded)20 b(and)e(enco)q(ded)i(terms)e(\()p
FF(\025)p FI(-U)h(of)f(Chapter)h(6\).)e(The)i(in)o(v)n(ariance)f
(problem)f(arises)i(when)g(a)f(pro-)150 2292 y(gram)e(transformation)f
(is)i(not)h(in)o(v)n(arian)o(t)d(under)k(the)f(enco)q(ding)f(op)q
(eration.)g(In)g(MetaML,)h(the)g(in)o(v)n(ariance)150
2367 y(problem)13 b(is)h(roughly)f(comparable)g(to)h(a)g
(transformation)f(that)h(w)o(orks)g(on)g(a)g(lev)o(el)g(0)g
FF(\025)p FI(-T)g(term,)f(but)i(cannot)150 2441 y(con)o(tin)o(ue)j(to)g
(w)o(ork)g(on)g(the)g(same)f(term)h(when)g(it)g(is)g(promoted.)f(Note)h
(that)g(suc)o(h)h(problem)e FH(c)n(annot)i FI(arise)150
2516 y(with)e FF(\025)p FI(-U)g(terms,)f(as)h(unenco)q(ded)i(and)e
(enco)q(ded)h(terms)f(are)g(syn)o(tactically)f(indistinguishable.)g
(The)h(w)o(ork)150 2591 y(on)e(S-Graph-)p FF(n)f FI(sho)o(ws)i(ho)o(w)f
(the)h(t)o(w)o(o)e(problems)h(describ)q(ed)i(ab)q(o)o(v)o(e)d(can)i(b)q
(e)g(a)o(v)o(oided)e(using)h(the)h(m)o(ulti-lev)o(el)150
2666 y(data)h(structures)j(of)d(S-Graph-)p FF(n)f FI([35].)g(This)h
(feature)h(of)f(S-Graph-)p FF(n)f FI(is)i(highly)e(desirable)i(for)f
(the)g(success)p eop
%%Page: 134 145
134 144 bop 1862 0 a FB(134)150 192 y FI(of)16 b(m)o(ulti-lev)o(el)f
(transformations)g(b)q(ecause)k(generalization)d(of)g(data)h(should)g
(b)q(e)g(precise)i(regardless)f(of)e(the)150 266 y(n)o(um)o(b)q(er)d
(of)g(lev)o(els)h(in)o(v)o(olv)o(ed)f(in)g(the)i(m)o(ulti-lev)o(el)c
(transformation.)150 349 y(Because)i(a)o(v)o(oiding)d(the)i(use)g(of)f
(lev)o(el-annotated)g(terms)g(\(as)h(in)f FF(\025)p FI(-U\))h(can)f
(simplify)e(the)j(language,)e(it)h(remains)150 424 y(an)16
b(in)o(teresting)h(and)f(op)q(en)h(question)f(w)o(eather)h(ab)q
(olishing)e(the)i(distinction)f(b)q(et)o(w)o(een)i(unenco)q(ded)g(and)e
(en-)150 499 y(co)q(ded)d(terms)g(can)f(also)g(b)q(e)h(applied)f(to)g
(S-Graph-)p FF(n)p FI(.)f(F)m(urthermore,)h(b)q(ecause)i(the)f(tec)o
(hnical)g(dev)o(elopmen)o(t)f(of)150 573 y(the)i(notion)g(of)f
(generalizations)h(has)g(some)f(similariti)o(es)f(with)i(the)g
(problems)f(with)g(substitution)h(that)g(arose)150 648
y(in)e(the)i(con)o(text)f(of)g(MetaML,)f(it)h(is)f(reasonable)i(to)e
(exp)q(ect)j(to)d(reap)i(more)e(b)q(ene\014ts)i(if)e(lev)o(el)h
(annotations)f(can)150 723 y(b)q(e)j(a)o(v)o(oided)e(in)g(S-Graph-)p
FF(n)p FI(.)150 871 y FG(7.3.2)48 b(T)o(yp)q(e)16 b(Systems)e(for)h(Op)
q(en)g(and)g(Closed)g(Co)q(de)150 987 y FI(T)o(yp)q(ed)e(languages)f
(for)h(manipulating)c(co)q(de)14 b(fragmen)o(ts)d(ha)o(v)o(e)i(t)o
(ypically)e(had)i(either)g(a)g(t)o(yp)q(e)g(constructor)h(for)150
1062 y(op)q(en)e(co)q(de)h([32,)6 b(22,)g(94],)k(or)i(a)g(t)o(yp)q(e)g
(constructor)i(for)d(closed)i(co)q(de)g([62,)5 b(23,)h(102].)k
(Languages)i(with)g(op)q(en)g(co)q(de)150 1136 y(t)o(yp)q(es)j(are)f
(useful)h(in)e(the)i(study)g(of)e(partial)g(ev)n(aluation.)f(T)o
(ypically)m(,)g(they)j(pro)o(vide)f(constructs)i(for)d(building)150
1211 y(and)h(com)o(bining)d(co)q(de)j(fragmen)o(ts)f(with)g(free)i(v)n
(ariables,)d(but)i(do)g(not)f(allo)o(w)f(for)i(executing)g(suc)o(h)h
(fragmen)o(ts.)150 1286 y(Being)e(able)g(to)f(construct)j(op)q(en)e
(fragmen)o(ts)f(enables)i(the)f(user)h(to)f(force)g(computations)f
(\\under)h(a)g(lam)o(b)q(da".)150 1360 y(Executing)20
b(co)q(de)g(fragmen)o(ts)f(in)g(suc)o(h)h(languages)f(is)g(hard)h(b)q
(ecause)h(co)q(de)f(can)g(con)o(tain)f(\\not-y)o(et-b)q(ound)150
1435 y(iden)o(ti\014ers".)13 b(In)g(con)o(trast,)h(languages)e(with)h
(closed)h(co)q(de)g(t)o(yp)q(es)g(ha)o(v)o(e)f(b)q(een)h(adv)o(o)q
(cated)g(as)f(mo)q(dels)f(for)h(run-)150 1510 y(time)d(\(mac)o(hine\))g
(co)q(de)i(generation.)e(T)o(ypically)m(,)f(they)i(pro)o(vide)g
(constructs)i(for)e(building)e(and)i(executing)h(co)q(de)150
1585 y(fragmen)o(ts,)g(but)i(do)g(not)g(allo)o(w)e(for)i(forcing)f
(computations)f(\\under)j(a)f(lam)o(b)q(da".)150 1668
y(In)g(what)g(follo)o(ws,)d(w)o(e)k(review)f(these)h(languages)f(in)f
(more)g(detail.)150 1815 y FG(7.3.3)48 b(Nielson)14 b(&)i(Nielson)e
(and)h(Gomard)f(&)i(Jones)150 1932 y FI(Nielson)9 b(and)g(Nielson)g
(pioneered)i(the)f(in)o(v)o(estigation)e(of)h(m)o(ulti-lev)o(el)d
(languages)j(with)g(their)h(w)o(ork)f(on)g(t)o(w)o(o-lev)o(el)150
2006 y(functional)j(languages)h([58,)5 b(62,)h(59,)g(60].)12
b(They)i(ha)o(v)o(e)f(dev)o(elop)q(ed)g(an)g(extensiv)o(e)i(theory)e
(for)g(the)h(denotational)150 2081 y(seman)o(tics)j(of)g(t)o(w)o(o-lev)
o(el)g(languages,)f(including)h(their)h(use)g(as)g(a)f(framew)o(ork)f
(for)h(abstract)i(in)o(terpretation)150 2156 y([61].)12
b(Their)h(framew)o(ork)f(allo)o(ws)g(for)i(a)f(\\)p FF(B)r
FI(-lev)o(el")g(language,)f(where)i FF(B)i FI(is)e(an)f(arbitrary)m(,)g
(p)q(ossibly)g(partially-)150 2231 y(ordered)21 b(set.)f(Recen)o(tly)m
(,)f(Nielson)h(and)f(Nielson)h(ha)o(v)o(e)f(also)g(prop)q(osed)i(an)f
(algebraic)f(framew)o(ork)f(for)h(the)150 2305 y(sp)q(eci\014cation)c
(of)e(m)o(ulti-lev)o(el)e(t)o(yp)q(e)j(systems)g([63,)6
b(64].)150 2388 y(Gomard)13 b(and)h(Jones)i([32])d(prop)q(osed)i(a)f
(statically-t)o(yp)q(ed)h(t)o(w)o(o-lev)o(el)e(language)h(to)g(explain)
g(the)i(w)o(orkings)e(of)150 2463 y(a)e(partial)f(ev)n(aluator)h(for)g
(the)h(un)o(t)o(yp)q(ed)f FF(\025)p FI(-calculus.)g(This)h(language)e
(is)h(the)h(basis)f(for)g(man)o(y)f(BT)m(As.)h(It)g(allo)o(ws)150
2538 y(the)17 b(treatmen)o(t)e(of)h(expressions)h(con)o(taining)e(free)
i(v)n(ariables.)d(Our)j(treatmen)o(t)f(of)f(ob)r(ject-lev)o(el)h(v)n
(ariables)f(in)150 2612 y(the)f(implemen)o(tation)d(seman)o(tics)i(is)h
(inspired)g(b)o(y)g(their)g(w)o(ork.)p eop
%%Page: 135 146
135 145 bop 1862 0 a FB(135)150 192 y FG(7.3.4)48 b(Multi-Lev)o(el)12
b(Languages)j(and)g(Logical)f(Mo)q(dalities)150 308 y
FI(In)d(our)f(researc)o(h,)i(w)o(e)f(ha)o(v)o(e)f(emphasized)g(the)i
(pragmatic)c(imp)q(ortance)i(of)g(b)q(eing)h(able)f(to)g(com)o(bine)f
(cross-stage)150 382 y(p)q(ersistence,)18 b(\\ev)n(aluation)d(under)i
(lam)o(b)q(da")c(\(or)k(\\sym)o(b)q(olic)d(computation"\),)f(and)j(b)q
(eing)g(able)g(to)g(execute)150 457 y(co)q(de.)d(In)f(this)h(section,)g
(w)o(e)f(review)h(some)f(of)g(the)h(basic)f(features)i(of)e(t)o(w)o(o)g
(imp)q(ortan)o(t)e(statically-t)o(yp)q(ed)i(m)o(ulti-)150
532 y(lev)o(el)i(languages)f(that)h(are)g(closely)g(related)g(to)g(our)
g(w)o(ork.)150 615 y(Da)o(vies)d(and)f(Pfenning)h(presen)o(t)i(a)d
(statically-t)o(yp)q(ed)h(m)o(ulti-stage)e(language)h
FF(\025)1403 600 y Fi(\003)1431 615 y FI(,)h(motiv)n(ated)e(b)o(y)i
(constructiv)o(e)150 690 y(mo)q(dal)e(logic)i([23].)f(They)i(sho)o(w)g
(that)f(there)i(is)f(a)f(Curry-Ho)o(w)o(ard)h(isomorphism)c(b)q(et)o(w)
o(een)13 b FF(\025)1620 675 y Fi(\003)1660 690 y FI(and)f(the)g(mo)q
(dal)150 764 y(logic)g(S4.)g(They)h(also)f(sho)o(w)h(that)f
FF(\025)716 749 y Fi(\003)757 764 y FI(t)o(yp)q(e)i(system)e(is)h
(equiv)n(alen)o(t)f(to)g(the)i(binding-time)c(analysis)i(of)g(Nielson)
150 839 y(and)h(Nielson.)f(The)i(language)e(pro)o(vides)h(a)f(closed)i
(co)q(de)g(t)o(yp)q(e)f(constructor)i Fh(\003)e FI(that)g(is)g(closely)
g(related)h(to)e(the)150 914 y(Closed)h(t)o(yp)q(e)g(of)g
FF(\025)446 899 y FE(BN)505 914 y FI(.)g(The)g(language)f(has)h(t)o(w)o
(o)f(constructs,)j(b)q(o)o(x)e(and)f(let-b)q(o)o(x,)g(whic)o(h)h
(corresp)q(ond)i(roughly)150 989 y(to)f(Close)g(and)f(Op)q(en,)i(resp)q
(ectiv)o(ely)m(.)150 1072 y(Da)o(vies)i(extends)i(the)f(Curry-Ho)o(w)o
(ard)f(isomorphism)d(to)k(a)f(relation)g(b)q(et)o(w)o(een)i(linear)e
(temp)q(oral)f(logic)g(and)150 1146 y(the)j(t)o(yp)q(e)g(system)f(for)g
(a)g(m)o(ulti-lev)o(el)e(language)i([22].)e(He)j(presen)o(ts)h(a)f
(language)e FF(\025)1528 1131 y Fs(\015)1582 1146 y FI(that)h(allo)o
(ws)f(staged)150 1221 y(expressions)j(to)f(con)o(tain)f(free)i(v)n
(ariables.)d(The)i(language)f(pro)o(vides)h(an)f(op)q(en)h(co)q(de)h(t)
o(yp)q(e)f(constructor)h Fy(\015)150 1296 y FI(that)c(corresp)q(onds)i
(closely)d(to)h(MetaML's)g(co)q(de)h(t)o(yp)q(e.)e(The)i
FF(\025)1176 1281 y Fs(\015)1227 1296 y FI(has)f(t)o(w)o(o)f
(constructs)j FE(next)e FI(and)g FE(p)o(rev)h FI(that)150
1370 y(corresp)q(ond)e(closely)f(to)g(MetaML's)g(Brac)o(k)o(ets)h(and)f
(Escap)q(e,)h(resp)q(ectiv)o(ely)m(.)150 1453 y(In)d(collab)q(oration)e
(with)h(Moggi,)f(Benaissa,)i(and)f(Sheard,)h(the)g(presen)o(t)h(author)
f(presen)o(ts)h FH(AIM)f FI(\(An)g(Idealized)150 1528
y(MetaML\))19 b([55],)e(whic)o(h)i(extends)h(MetaML)f(with)f(an)h
(analog)e(of)h(the)h(Bo)o(x)g(t)o(yp)q(e)g(of)f FF(\025)1583
1513 y Fi(\003)1630 1528 y FI(yielding)g(a)g(more)150
1603 y(expressiv)o(e)h(language,)c(y)o(et)j(has)f(a)g(simpler)e(t)o
(yping)i(judgmen)o(t)e(than)i(MetaML.)g(W)m(e)g(can)g(em)o(b)q(ed)g
(all)f(three)150 1678 y(languages)j(in)o(to)g FH(AIM)h
FI([55])605 1663 y FA(2)622 1678 y FI(.)f(W)m(e)g(view)g
FF(\025)855 1663 y FE(BN)934 1678 y FI(as)h(a)f(cut-do)o(wn)h(v)o
(ersion)g(of)f FH(AIM)g FI(that)h(w)o(e)g(exp)q(ect)h(to)e(b)q(e)150
1752 y(su\016cien)o(tly)14 b(expressiv)o(e)h(for)f(the)g(purp)q(oses)i
(of)d(m)o(ulti-stage)f(programmi)o(ng.)150 1835 y(The)j(Closed)h(t)o
(yp)q(e)f(constructor)i(of)d FF(\025)759 1820 y FE(BN)834
1835 y FI(is)h(essen)o(tially)g(a)f(strict)i(v)o(ersion)f(of)g(the)g
(Bo)o(x)g(t)o(yp)q(e)h(constructor)h(of)150 1910 y FH(AIM)p
FI(.)10 b(The)i(presen)o(t)g(author)f(prop)q(osed)h(that)f(the)h
(laziness)f(of)f(the)i(Bo)o(x)f(t)o(yp)q(e)g(constructor)i(of)d
FH(AIM)p FI(,)g(and)h(of)f(the)150 1985 y Fh(\003)j FI(t)o(yp)q(e)h
(constructor)g(of)f FF(\025)577 1970 y Fi(\003)605 1985
y FI(,)g(can)g(b)q(e)g(dropp)q(ed.)h(The)f(motiv)n(ation)d(for)j(this)g
(prop)q(osal)f(is)h(as)g(follo)o(ws:)e(In)i FH(AIM)p
FI(,)150 2060 y(the)h(Bo)o(x)g(construct)h(dela)o(ys)f(its)f(argumen)o
(t.)f(T)m(o)h(the)h(programmer,)d(this)j(means)f(that)g(there)i(are)f
(t)o(w)o(o)g(\\co)q(de")150 2134 y(t)o(yp)q(es)e(in)e
FH(AIM)p FI(,)g(one)h(for)f(closed)i(co)q(de,)f(and)f(one)h(for)f(op)q
(en)h(co)q(de.)g(Ha)o(ving)f(t)o(w)o(o)g(di\013eren)o(t)i(co)q(de)f(t)o
(yp)q(es)h(can)f(cause)150 2209 y(some)f(confusion)h(from)f(the)i(p)q
(oin)o(t)f(of)f(view)h(of)g(m)o(ulti-stage)e(programming,)e(b)q(ecause)
13 b(manipulating)c(v)n(alues)i(of)150 2284 y(t)o(yp)q(e)i([)p
Fy(h)o FF(A)p Fy(i)q FI(])e(w)o(ould)h(b)q(e)h(read)f(as)h(\\closed)f
(co)q(de)h(of)f(op)q(en)g(co)q(de)h(of)f FF(A)p FI(".)f(Not)i(only)e
(is)h(this)g(reading)g(cum)o(b)q(ersome,)150 2358 y(it)18
b(mak)o(es)f(it)h(\(unnecessarily\))i(harder)f(for)e(the)i(programmer)d
(to)i(reason)h(ab)q(out)f FH(when)h FI(computations)e(are)150
2433 y(p)q(erformed.)h(F)m(or)g(these)i(reasons,)f(in)f
FF(\025)794 2418 y FE(BN)872 2433 y FI(w)o(e)h(mak)o(e)e(the)j
(pragmatic)c(decision)j(that)g(Closed)g(should)f(not)p
150 2513 237 2 v 158 2540 a Fz(2)188 2556 y FB(This)11
b(claim)g(is)g(presen)o(ted)g(as)f(a)g(theorem)g(together)h(with)f(a)g
(pro)q(of)h([55],)e(but)h(w)o(e)g(ha)o(v)o(e)g(iden)o(ti\014ed)j(some)d
(shortcomings)188 2602 y(in)k(statemen)o(t)e(of)g(the)h(theorem)f(and)h
(its)g(pro)q(of.)g(Correcting)g(the)g(em)o(b)q(edding)h(of)e(MetaML)h
(and)g Fx(\025)1650 2586 y Fg(\015)1695 2602 y FB(is)g(simple,)g(but)
188 2647 y(the)h(em)o(b)q(edding)h(of)d Fx(\025)514 2632
y Ff(\003)554 2647 y FB(is)h(more)g(subtle.)h(Nev)o(ertheless,)g(w)o(e)
f(still)i(exp)q(ect)e(this)h(em)o(b)q(edding)h(to)e(hold.)p
eop
%%Page: 136 147
136 146 bop 1862 0 a FB(136)150 192 y FI(dela)o(y)13
b(its)g(argumen)o(t,)f(and)h(so,)g(t)o(yp)q(es)h(suc)o(h)g(as)g([)p
Fy(h)p FF(A)p Fy(i)p FI(])f(can)g(b)q(e)h(read)g(as)f(simply)f
(\\closed)h(co)q(de)i(of)d FF(A)p FI(".)h(In)g(other)150
266 y(w)o(ords,)f(w)o(e)g(prop)q(ose)h(to)f(use)h(the)g(Necessit)o(y)g
(mo)q(dalit)o(y)d(only)h(for)h(asserting)g(closedness,)i(and)e(not)g
(for)g FH(delaying)150 341 y FI(ev)n(aluation.)150 424
y(Another)i(di\013erence)h(is)e(that)g FH(AIM)h FI(w)o(as)f(a)g(\\sup)q
(erset")i(of)d(the)i(three)h(languages)d(that)h(w)o(e)h(had)f(studied)h
(\(that)150 499 y(is,)c FF(\025)224 484 y Fs(\015)260
499 y FI(,)g FF(\025)306 484 y Fi(\003)334 499 y FI(,)g(and)h
(MetaML\),)g(while)f FF(\025)759 484 y FE(BN)829 499
y FI(is)h FH(not)p FI(.)f(On)h(the)h(one)f(hand,)f(w)o(e)h(exp)q(ect)h
(that)f FF(\025)1565 484 y Fs(\015)1611 499 y FI(can)g(b)q(e)h(em)o(b)q
(edded)150 573 y(in)o(to)f(the)i FH(op)n(en)g(fr)n(agment)f
FI(of)f FH(AIM)p FI(,)g(and)h FF(\025)823 558 y Fi(\003)863
573 y FI(in)o(to)f(the)h FH(close)n(d)i(fr)n(agment)d
FI([55].)f(F)m(ormal)f(supp)q(ort)k(for)e(this)h(claim)150
648 y(w)o(ould)k(establish)h(a)f(strong)h(relation)f(b)q(et)o(w)o(een)i
(the)f(closed)g(co)q(de)h(and)e(op)q(en)h(co)q(de)h(t)o(yp)q(es)f(of)f
FH(AIM)h FI(and)f(the)150 723 y(Necessit)o(y)k(and)f(Next)g(mo)q
(dalities)d(of)i(mo)q(dal)f(and)h(temp)q(oral)f(logic.)h(The)h(em)o(b)q
(edding)e(of)h FF(\025)1675 708 y Fs(\015)1729 723 y
FI(and)h FF(\025)1839 708 y Fi(\003)1885 723 y FI(in)150
798 y FH(AIM)e FI(can)f(b)q(e)h(turned)h(in)o(to)e(an)g(em)o(b)q
(edding)g(in)g FF(\025)960 783 y FE(BN)1019 798 y FI(.)g(\(The)h(em)o
(b)q(edding)f(of)g FF(\025)1438 783 y Fi(\003)1482 798
y FI(needs)i(to)f(b)q(e)g(mo)q(di\014ed)e(to)150 872
y(tak)o(e)f(in)o(to)e(accoun)o(t)i(the)g(fact)g(that)f(Closed)h(in)f
FF(\025)924 857 y FE(BN)997 872 y FI(is)g(strict,)h(that)g(is,)f(it)g
(do)q(es)h(not)f(dela)o(y)g(the)h(ev)n(aluation)f(of)150
947 y(its)i(argumen)o(t.\))f(On)h(the)g(other)h(hand,)e(the)i(em)o(b)q
(edding)e(of)g(MetaML)i(in)e FH(AIM)h(c)n(annot)h FI(b)q(e)g(adapted)f
(for)f(the)150 1022 y(follo)o(wing)d(t)o(w)o(o)j(reasons:)168
1138 y(1.)20 b FF(\025)245 1123 y FE(B)o(N)315 1138 y
FI(do)q(es)11 b(not)g(ha)o(v)o(e)f(full)f(cross-stage)k(p)q
(ersistence.)g(Not)d(ha)o(ving)g(cross-stage)i(p)q(ersistence)h
(simpli\014es)c(the)221 1213 y(categorical)j(mo)q(del.)e(A)o(t)j(the)g
(same)e(time,)g(from)f(the)j(pragmatic)e(p)q(oin)o(t)h(of)g(view,)f
(cross-stage)j(p)q(ersistence)221 1287 y(for)f(closed)i(t)o(yp)q(es)f
(is)g(exp)q(ected)i(to)e(su\016ce,)168 1362 y(2.)20 b
FF(\025)245 1347 y FE(B)o(N)317 1362 y FI(do)q(es)15
b(not)e(ha)o(v)o(e)g(Run.)g(W)m(e)g(w)o(ere)i(not)e(able)g(to)h(\014nd)
g(a)f(general)g(categorical)h(in)o(terpretation)g(for)f(this)221
1437 y(construct,)18 b(though)f(it)g(is)g(p)q(ossible)h(to)f(in)o
(terpret)i(Run)e(in)f(a)i(particular,)e(concrete)j(mo)q(del)d([5].)g(A)
o(t)h(the)221 1512 y(same)11 b(time,)f(the)j(pragmatic)d(need)j(for)f
(Run)g(disapp)q(ears)h(in)f(the)g(presence)j(of)d FE(safe)p
1536 1512 13 2 v 15 w(run)q FI(,)f(whic)o(h)h(do)q(es)h(ha)o(v)o(e)221
1586 y(a)g(natural)h(categorical)f(in)o(terpretation.)150
1703 y(T)m(o)e(our)g(kno)o(wledge,)f(our)i(w)o(ork)f(is)g(the)h
(\014rst)g(successful)h(attempt)d(to)i(de\014ne)g(a)f(sound)g(t)o(yp)q
(e)h(system)f(com)o(bining)150 1777 y(Brac)o(k)o(ets,)16
b(Escap)q(e)g(and)e(a)h(safe)f(w)o(a)o(y)g(for)h(executing)g(co)q(de)h
(in)e(the)h(same)f(language.)f(W)m(e)h(ha)o(v)o(e)h(ac)o(hiev)o(ed)g
(this)150 1852 y(com)o(bination)e(\014rst)i(in)g(the)h(con)o(text)f(of)
g(MetaML,)g(then)g(in)g(the)g(more)f(expressiv)o(e)j(con)o(text)f(of)e
(of)h FH(AIM)p FI(,)f(and)150 1927 y(ev)o(en)o(tually)f(in)h
FF(\025)421 1912 y FE(BN)480 1927 y FI(.)150 2074 y FG(7.3.5)48
b(An)15 b(Ov)o(erview)g(of)h(Multi-lev)o(e)o(l)d(Languages)150
2191 y FI(Figure)j(7.1)f(is)i(a)e(summary)f(of)i(the)g(distinguishing)f
(c)o(haracteristics)j(of)e(some)f(of)h(the)h(languages)e(discussed)150
2265 y(here.)d(F)m(or)g(Stages,)f(\\2")g(mean)g(it)g(is)h(a)f(t)o(w)o
(o-lev)o(el)g(language,)f(and)i(\\+")f(means)g(m)o(ulti-lev)o(el.)e(F)m
(or)i(static)h(t)o(yping,)150 2340 y(\\1")18 b(means)f(only)g(\014rst)j
(lev)o(el)e(is)g(c)o(hec)o(k)o(ed.)h(Re\015ection)g(refers)g(to)f(the)h
(presence)i(of)d(a)g(Run-lik)o(e)f(construct.)150 2415
y(P)o(ersistence)e(refers)f(to)f(the)g(presence)j(of)c(cross-state)i(p)
q(ersistence.)h(P)o(ortabilit)o(y)d(refers)i(to)e(the)i(prin)o(tabilit)
o(y)d(of)150 2490 y(all)i(co)q(de)h(generated)i(at)d(run-time.)p
eop
%%Page: 137 148
137 147 bop 1862 0 a FB(137)p 198 152 1663 2 v 197 288
2 137 v 204 187 a Fe(F)l(acilit)o(y)p 439 288 V 98 w(Example)p
622 288 V 16 w FB(Nielson)14 b(&)629 233 y(Nielson)629
278 y([62])p 799 288 V 806 187 a(Gomard)806 233 y(&)42
b(Jones)806 278 y([32])p 976 288 V 982 187 a(Gl)q(\177)-20
b(uc)o(k)38 b(&)982 233 y(J\034rgensen)982 278 y([29])p
1152 288 V 1159 187 a(Hatcli\013)1159 233 y(&)f(Gl)q(\177)-20
b(uc)o(k)1159 278 y([35])p 1329 288 V 1336 187 a Fx(\025)1358
171 y Ff(\003)1397 187 y FB([23])p 1506 288 V 55 w Fx(\025)1534
171 y Fg(\015)1580 187 y FB([22])p 1682 288 V 49 w(MetaML,)1689
233 y FC(AIM)o FB(,)1689 286 y Fx(\025)1711 270 y Fw(BN)p
1859 288 V 198 289 1663 2 v 197 335 2 46 v 204 321 a
FB(Stages)p 439 335 V 135 w Fn(h)p Fx(\025)p Fw(x.x)p
Fn(i)p 622 335 V 158 w FB(2)p 799 335 V 158 w(2)p 976
335 V 152 w(+)p 1152 335 V 146 w(+)p 1329 335 V 147 w(+)p
1506 335 V 147 w(+)p 1682 335 V 146 w(+)p 1859 335 V
198 337 1663 2 v 197 382 2 46 v 204 369 a(Static)13 b(T)o(yping)p
437 382 V 622 382 V 265 w(Y)p 799 382 V 153 w(1)p 976
382 V 152 w(N)p 1152 382 V 148 w(N)p 1329 382 V 148 w(Y)p
1506 382 V 147 w(Y)p 1682 382 V 148 w(Y)p 1859 382 V
198 384 1663 2 v 197 430 2 46 v 204 416 a(Re\015ection)p
439 430 V 76 w Fw(run)g(o)o(r)g(eval)p 623 430 V 79 w
FB(N)p 799 430 V 148 w(N)p 976 430 V 147 w(N)p 1152 430
V 148 w(N)p 1329 430 V 148 w(Y)p 1506 430 V 147 w(N)p
1682 430 V 148 w(Y)p 1859 430 V 198 431 1663 2 v 197
477 2 46 v 204 463 a(P)o(ersistence)p 439 477 V 57 w
Fx(\025)p Fw(f.)p Fn(h)p Fx(\025)p Fw(x.f)f(x)p Fn(i)p
622 477 V 84 w FB(N)p 799 477 V 148 w(N)p 976 477 V 147
w(N)p 1152 477 V 148 w(N)p 1329 477 V 148 w(N)p 1506
477 V 147 w(N)p 1682 477 V 148 w(Y)p 1859 477 V 198 479
1663 2 v 197 524 2 46 v 204 511 a(P)o(ortabilit)o(y)p
439 524 V 622 524 V 315 w(Y)p 799 524 V 148 w(Y)p 976
524 V 147 w(Y)p 1152 524 V 148 w(Y)p 1329 524 V 148 w(Y)p
1506 524 V 147 w(Y)p 1682 524 V 148 w(N)p 1859 524 V
198 526 1663 2 v 719 601 a FG(Fig.)c(7.1.)14 b FI(Comparativ)o(e)e(F)m
(eature)i(Set)150 738 y FG(7.3.6)48 b(A)16 b(Closer)f(Lo)q(ok)h(at)f
Fp(\025)700 723 y Fi(\003)728 738 y FG(,)h Fp(\025)785
723 y Fd(\015)841 738 y FG(and)f Fc(AIM)150 848 y FI(T)m(o)d(clarify)g
(the)h(relation)f(b)q(et)o(w)o(een)j(MetaML)e(and)f(the)i(other)f(m)o
(ulti-lev)o(el)d(languages,)i(w)o(e)h(tak)o(e)g(a)f(closer)i(lo)q(ok)
150 923 y(at)j(the)g(syn)o(tax,)f(t)o(yp)q(e)h(system)g(and)f(seman)o
(tics)h(of)f FF(\025)1011 908 y Fi(\003)1039 923 y FI(,)g
FF(\025)1091 908 y Fs(\015)1127 923 y FI(,)g(and)g FH(AIM)p
FI(.)h(W)m(e)f(adopt)g(the)i(follo)o(wing)c(uni\014ed)150
998 y(notation)f(for)h(t)o(yp)q(es:)762 1106 y FF(\034)i
Fy(2)c FF(T)17 b FI(:=)11 b FF(b)j Fy(j)g FF(\034)1008
1112 y FA(1)1038 1106 y Fy(!)d FF(\034)1109 1112 y FA(2)1141
1106 y Fy(j)j(h)p FF(\034)5 b Fy(i)14 b(j)f FE([)p FF(\034)5
b FE(])150 1214 y FI(In)15 b(order,)g(the)g(pro)q(ductions)h(corresp)q
(ond)g(to)f(base)g(t)o(yp)q(es,)g(functions,)g(\(op)q(en\))g(co)q(de)h
(fragmen)o(ts,)d(and)h(closed)150 1289 y(co)q(de)h(fragmen)o(ts.)150
1372 y(The)g(\014rst)f(language,)f FF(\025)530 1357 y
Fi(\003)558 1372 y FI(,)h(features)h(function)f(and)g(closed)g(co)q(de)
h(t)o(yp)q(es.)g(T)o(yping)e(judgmen)o(ts)g(ha)o(v)o(e)h(the)h(form)150
1447 y FF(\001)p FI(;)7 b FF(\000)16 b Fy(`)e FF(e)e
FI(:)f FF(\034)5 b FI(,)13 b(where)i FF(\001;)7 b(\000)16
b Fy(2)11 b FF(D)i FI(:=)f([])17 b Fy(j)11 b FF(x)g FI(:)g
FF(\034)r(;)c(\001)p FI(.)13 b(The)i(syn)o(tax)f(for)f
FF(\025)1272 1432 y Fi(\003)1314 1447 y FI(is)h(as)g(follo)o(ws:)568
1560 y FF(e)e Fy(2)f FF(E)j FI(:=)d FF(c)j Fy(j)f FF(x)h
Fy(j)f FF(\025x:e)h Fy(j)f FF(e)7 b(e)15 b Fy(j)e FE(b)q(o)o(x)f
FF(e)i Fy(j)g FE(let)g(b)q(o)o(x)g FF(x)d FI(=)h FF(e)i
FE(in)g FF(e)150 1663 y FI(The)g(t)o(yp)q(e)h(system)e(of)h
FF(\025)538 1648 y Fi(\003)580 1663 y FI(is:)567 1773
y FF(\001)p FI(;)7 b FF(\000)16 b Fy(`)e FF(c)d FI(:)h
FF(\034)773 1779 y Ft(c)907 1773 y FF(\001)p FI(;)7 b
FF(\000)16 b Fy(`)e FF(x)d FI(:)g FF(\034)26 b FI(if)13
b FF(\034)j FI(=)c FF(\001)p FI(\()p FF(x)p FI(\))i(or)g
FF(\000)6 b FI(\()p FF(x)p FI(\))655 1871 y FF(\001)p
FI(;)h FF(\000)q(;)g(x)i FI(:)i FF(\034)829 1877 y FA(1)860
1871 y Fy(`)j FF(e)d FI(:)g FF(\034)970 1877 y FA(2)p
623 1899 398 2 v 629 1957 a FF(\001)p FI(;)c FF(\000)16
b Fy(`)e FF(\025x:e)d FI(:)g FF(\034)895 1963 y FA(1)925
1957 y Fy(!)g FF(\034)996 1963 y FA(2)1187 1871 y FF(\001)p
FI(;)c Fy(;)j(`)k FF(e)e FI(:)f FF(\034)p 1128 1899 320
2 v 1134 1957 a(\001)p FI(;)c FF(\000)15 b Fy(`)f FE(b)q(o)o(x)e
FF(e)g FI(:)f([)p FF(\034)5 b FI(])719 2066 y FF(\001)p
FI(;)i FF(\000)16 b Fy(`)e FF(e)873 2072 y FA(1)904 2066
y FI(:)d FF(\034)945 2072 y FA(1)975 2066 y Fy(!)g FF(\034)1046
2072 y FA(2)1106 2066 y FF(\001)p FI(;)c FF(\000)16 b
Fy(`)e FF(e)1260 2072 y FA(2)1291 2066 y FI(:)d FF(\034)1332
2072 y FA(1)p 714 2094 643 2 v 894 2152 a FF(\001)p FI(;)c
FF(\000)16 b Fy(`)e FF(e)1048 2158 y FA(1)1067 2152 y
FF(e)1086 2158 y FA(2)1116 2152 y FI(:)d FF(\034)1157
2158 y FA(2)696 2261 y FF(\001)p FI(;)c FF(\000)16 b
Fy(`)e FF(e)850 2267 y FA(1)880 2261 y FI(:)d([)p FF(\034)933
2267 y FA(1)952 2261 y FI(])41 b FF(\001;)7 b(x)j FI(:)h
FF(\034)1134 2267 y FA(1)1153 2261 y FI(;)c FF(\000)16
b Fy(`)e FF(e)1272 2267 y FA(2)1303 2261 y FI(:)d FF(\034)1344
2267 y FA(2)p 690 2290 679 2 v 753 2347 a FF(\001)p FI(;)c
FF(\000)16 b Fy(`)e FE(let)g(b)q(o)o(x)g FF(x)d FI(=)h
FF(e)1118 2353 y FA(1)1151 2347 y FE(in)i FF(e)1215 2353
y FA(2)1246 2347 y FI(:)d FF(\034)1287 2353 y FA(2)1387
2299 y FI(.)150 2438 y(While)17 b(there)i(are)f(some)e(sup)q
(er\014cial)j(di\013erences,)g(this)f(t)o(yp)q(e)g(system)f(is)h(essen)
o(tially)f(the)h(same)f(as)h(that)g(of)150 2512 y FF(\025)174
2497 y FE(BN)247 2512 y FI(without)c(the)g(\(op)q(en\))h(co)q(de)g(t)o
(yp)q(e.)150 2595 y FF(\025)174 2580 y Fs(\015)209 2595
y FI(,)i(MetaML)g(and)f FH(AIM)h FI(feature)g(function)g(and)f(op)q(en)
i(co)q(de)f(t)o(yp)q(es.)g(T)o(yping)f(judgmen)o(ts)g(ha)o(v)o(e)g(the)
i(form)150 2670 y FF(\000)h Fy(`)220 2655 y Ft(n)256
2670 y FF(e)12 b FI(:)f FF(\034)5 b FI(,)15 b(where)h
FF(\000)j Fy(2)13 b FF(D)i FI(:=)e([])20 b Fy(j)13 b
FF(x)g FI(:)g FF(\034)827 2655 y Ft(n)849 2670 y FF(;)7
b(\001)14 b FI(and)h FF(n)g FI(is)g(a)g(natural)g(n)o(um)o(b)q(er)f
(called)h(the)g FH(level)g FI(of)f(the)i(term.)p eop
%%Page: 138 149
138 148 bop 1862 0 a FB(138)150 192 y FI(The)14 b(syn)o(tax)g(for)g
FF(\025)456 176 y Fs(\015)505 192 y FI(is)g(as)g(follo)o(ws:)716
297 y FF(e)e Fy(2)f FF(E)j FI(:=)d FF(c)j Fy(j)f FF(x)h
Fy(j)f FF(\025x:e)h Fy(j)f FF(e)7 b(e)15 b Fy(j)e(h)p
FF(e)p Fy(i)i(j)f FE(~)q FF(e:)150 392 y FI(The)g(t)o(yp)q(e)h(system)e
(for)h FF(\025)554 377 y Fs(\015)603 392 y FI(is:)666
496 y FF(\000)j Fy(`)734 481 y Ft(n)768 496 y FF(c)12
b FI(:)f FF(\034)839 502 y Ft(c)974 496 y FF(\000)16
b Fy(`)1041 481 y Ft(n)1076 496 y FF(x)11 b FI(:)g FF(\034)26
b FI(if)13 b FF(\034)1239 481 y Ft(n)1273 496 y FI(=)f
FF(\000)6 b FI(\()p FF(x)p FI(\))880 590 y FF(\000)q(;)h(x)j
FI(:)h FF(\034)1006 575 y Ft(n)1001 600 y FA(1)1040 590
y Fy(`)1065 575 y Ft(n)1100 590 y FF(e)g FI(:)h FF(\034)1172
596 y FA(2)p 852 619 366 2 v 858 676 a FF(\000)17 b Fy(`)926
661 y Ft(n)960 676 y FF(\025x:e)12 b FI(:)f FF(\034)1092
682 y FA(1)1122 676 y Fy(!)g FF(\034)1193 682 y FA(2)752
782 y FF(\000)17 b Fy(`)820 767 y Ft(n)854 782 y FF(e)873
788 y FA(1)904 782 y FI(:)11 b FF(\034)945 788 y FA(1)975
782 y Fy(!)g FF(\034)1046 788 y FA(2)1106 782 y FF(\000)17
b Fy(`)1174 767 y Ft(n)1209 782 y FF(e)1228 788 y FA(2)1258
782 y FI(:)11 b FF(\034)1299 788 y FA(1)p 746 811 578
2 v 903 869 a FF(\000)17 b Fy(`)971 853 y Ft(n)1006 869
y FF(e)1025 875 y FA(1)1057 869 y FF(e)1076 875 y FA(2)1107
869 y FI(:)11 b FF(\034)1148 875 y FA(2)760 974 y FF(\000)17
b Fy(`)828 959 y Ft(n)p FA(+)887 974 y FF(e)12 b FI(:)f
FF(\034)p 734 1003 256 2 v 740 1061 a(\000)17 b Fy(`)808
1045 y Ft(n)842 1061 y Fy(h)q FF(e)p Fy(i)12 b FI(:)f
Fy(h)p FF(\034)5 b Fy(i)1110 974 y FF(\000)17 b Fy(`)1178
959 y Ft(n)1213 974 y FF(e)12 b FI(:)f Fy(h)p FF(\034)5
b Fy(i)p 1096 1003 240 2 v 1102 1061 a FF(\000)17 b Fy(`)1170
1045 y Ft(n)p FA(+)1231 1061 y FE(~)q FF(e)12 b FI(:)f
FF(\034)150 1144 y FI(This)20 b(t)o(yp)q(e)h(system)e(is)h(v)o(ery)h
(similar)c(to)j(that)g(of)g(MetaML,)g(but)g(without)g(cross-stage)h(p)q
(ersistence)i(and)150 1219 y(without)16 b(the)g(Run)g(construct.)h(In)f
(other)g(w)o(ords,)g(the)g(t)o(yp)q(e)h(system)e(of)h(MetaML)g(can)g(b)
q(e)g(ac)o(hiev)o(ed)h(b)o(y)e(the)150 1294 y(addition)e(of)g(the)i
(follo)o(wing)c(t)o(w)o(o)i(rules:)710 1397 y FF(\000)k
Fy(`)778 1382 y Ft(n)812 1397 y FF(x)11 b FI(:)g FF(\034)26
b FI(if)13 b FF(\034)975 1382 y Ft(m)1018 1397 y FI(=)f
FF(\000)6 b FI(\()p FF(x)p FI(\))13 b(and)h FF(m)e Fy(\024)f
FF(n)916 1492 y(\000)948 1476 y FA(+)986 1492 y Fy(`)1011
1476 y Ft(n)1045 1492 y FF(e)h FI(:)f Fy(h)p FF(\034)5
b Fy(i)p 905 1520 260 2 v 911 1578 a FF(\000)17 b Fy(`)979
1562 y Ft(n)1013 1578 y FE(run)c FF(e)f FI(:)f FF(\034)150
1668 y FI(MetaML)19 b(uses)h(a)e(more)g(relaxed)h(t)o(yp)q(e)g(rule)g
(for)g(v)n(ariables)e(than)i FF(\025)1273 1653 y Fs(\015)1309
1668 y FI(,)f(in)g(that)h(v)n(ariables)f(can)h(b)q(e)g(b)q(ound)150
1743 y(at)g(a)g(lev)o(el)g(lo)o(w)o(er)g(than)g(the)h(lev)o(el)f(where)
h(they)g(are)g(used.)f(This)h(relaxation)e(is)h(cross-stage)i(p)q
(ersistence.)150 1818 y(F)m(urthermore,)13 b(MetaML)i(extends)g(the)f
(syn)o(tax)g(of)f FF(\025)1000 1803 y Fs(\015)1050 1818
y FI(with)g FE(run)i FF(e)p FI(.)150 1901 y FH(AIM)20
b FI([55])e(extends)i(MetaML)g(with)f(an)h(analog)e(of)h(the)h(Bo)o(x)f
(t)o(yp)q(e)h(of)f FF(\025)1368 1886 y Fi(\003)1396 1901
y FI(,)g(yielding)g(a)g(more)f(expressiv)o(e)150 1975
y(language,)12 b(and)i(y)o(et)g(has)g(a)f(simpler)g(t)o(yping)g
(judgmen)o(t)f(than)i(MetaML.)f(The)h(syn)o(tax)g(of)f
FH(AIM)h FI(extends)h(that)150 2050 y(of)e(MetaML)i(as)e(follo)o(ws:)
622 2132 y FF(e)f Fy(2)f FF(E)i FI(:=)f FF(c)i Fy(j)f
FF(x)h Fy(j)f FF(\025x:e)h Fy(j)f FF(e)7 b(e)14 b Fy(j)g(h)p
FF(e)p Fy(i)g(j)h FE(~)q FF(e)f Fy(j)792 2207 y FE(run)e
FF(e)g FE(with)h Fy(f)p FF(x)1023 2213 y Ft(i)1047 2207
y FI(=)f FF(e)1110 2213 y Ft(i)1124 2207 y Fy(j)p FF(i)g
Fy(2)f FF(m)p Fy(g)j(j)792 2282 y FE(b)q(o)o(x)e FF(e)g
FE(with)g Fy(f)p FF(x)1027 2288 y Ft(i)1052 2282 y FI(=)f
FF(e)1114 2288 y Ft(i)1129 2282 y Fy(j)p FF(i)g Fy(2)g
FF(m)p Fy(g)j(j)g FE(unb)q(o)o(x)e FF(e:)150 2363 y FI(Run-with)j
(generalizes)j(Run)d(of)h(MetaML,)g(in)g(that)g(it)g(allo)o(ws)f(the)i
(use)g(of)e(additional)f(v)n(ariables)i FF(x)1782 2369
y Ft(i)1812 2363 y FI(in)f(the)150 2438 y(b)q(o)q(dy)f(of)f
FF(e)h FI(if)f(they)i(satisfy)e(certain)i(t)o(yping)e(requiremen)o(ts.)
150 2521 y FH(AIM)i FI(is)g(essen)o(tially)g(the)h(union)e(of)h(all)f
(the)h(languages)g(describ)q(ed)i(ab)q(o)o(v)o(e,)d(with)h(the)g
(addition)f(of)h(Run-with)150 2595 y(construct,)j(generalizing)e(the)h
(Run)f(construct)i(of)e(MetaML,)g(and)h(with)f(a)g(reform)o(ulation)e
(of)i(the)h(rules)g(for)150 2670 y(Closed)d(t)o(yp)q(e:)p
eop
%%Page: 139 150
139 149 bop 1862 0 a FB(139)620 203 y FF(\000)17 b Fy(`)688
187 y Ft(n)722 203 y FF(e)741 209 y Ft(i)767 203 y FI(:)11
b FE([)p FF(\034)820 209 y Ft(i)834 203 y FE(])41 b FF(\000)919
187 y FA(+)946 203 y FF(;)7 b Fy(f)p FF(x)1010 209 y
Ft(i)1035 203 y FI(:)k FE([)p FF(\034)1088 209 y Ft(i)1102
203 y FE(])1114 181 y Ft(n)1136 203 y Fy(j)p FF(i)h Fy(2)f
FF(m)p Fy(g)h(`)1307 187 y Ft(n)1341 203 y FF(e)g FI(:)f
Fy(h)p FF(\034)5 b Fy(i)p 614 231 842 2 v 799 289 a FF(\000)17
b Fy(`)867 274 y Ft(n)902 289 y FE(run)12 b FF(e)g FE(with)g
FF(x)1111 295 y Ft(i)1136 289 y FI(=)g FF(e)1199 295
y Ft(i)1225 289 y FI(:)f FF(\034)679 400 y(\000)17 b
Fy(`)747 385 y Ft(n)781 400 y FF(e)800 406 y Ft(i)826
400 y FI(:)11 b FE([)p FF(\034)879 406 y Ft(i)893 400
y FE(])41 b Fy(f)p FF(x)991 406 y Ft(i)1016 400 y FI(:)11
b FE([)p FF(\034)1069 406 y Ft(i)1083 400 y FE(])1095
379 y FA(0)1114 400 y Fy(j)p FF(i)g Fy(2)g FF(m)p Fy(g)h(`)1284
385 y FA(0)1315 400 y FF(e)f FI(:)g FF(\034)p 673 429
725 2 v 785 487 a(\000)17 b Fy(`)853 471 y Ft(n)887 487
y FE(b)q(o)o(x)12 b FF(e)g FE(with)g FF(x)1101 493 y
Ft(i)1127 487 y FI(=)f FF(e)1189 493 y Ft(i)1215 487
y FI(:)g FE([)p FF(\034)5 b FE(])933 598 y FF(\000)17
b Fy(`)1001 582 y Ft(n)1036 598 y FF(e)12 b FI(:)f FE([)p
FF(\034)5 b FE(])p 882 627 307 2 v 888 684 a FF(\000)16
b Fy(`)955 669 y Ft(n)990 684 y FE(unb)q(o)o(x)d FF(e)f
FI(:)f FF(\034)150 779 y FI(The)j(op)q(erational)f(seman)o(tics)h(of)f
FH(AIM)h FI(and)g(its)g(sub-languages)f(is:)458 870 y
Fx(e)476 874 y Fz(1)517 845 y(0)503 870 y Fx(,)-6 b Fn(!)11
b Fx(\025x:e)38 b(e)686 874 y Fz(2)727 845 y(0)714 870
y Fx(,)-6 b Fn(!)10 b Fx(v)786 874 y Fz(1)841 870 y Fx(e)p
FB([)p Fx(x)g FB(:=)h Fx(v)973 874 y Fz(1)989 870 y FB(])1025
845 y Fz(0)1011 870 y Fx(,)-6 b Fn(!)10 b Fx(v)1083 874
y Fz(2)p 452 894 655 2 v 687 944 a Fx(e)705 948 y Fz(1)735
944 y Fx(e)753 948 y Fz(2)795 919 y(0)781 944 y Fx(,)-6
b Fn(!)10 b Fx(v)853 948 y Fz(2)p 1180 894 221 2 v 1186
944 a Fx(\025x:e)1283 919 y Fz(0)1269 944 y Fx(,)-6 b
Fn(!)10 b Fx(\025x:e)1481 870 y(e)1523 845 y Fz(0)1509
870 y Fx(,)-6 b Fn(!)10 b(h)p Fx(v)q Fn(i)p 1475 894
144 2 v 1486 944 a Fw(~)q Fx(e)1548 919 y Fz(1)1535 944
y Fx(,)-6 b Fn(!)10 b Fx(v)413 1007 y(e)431 1011 y Fl(i)468
982 y Fz(0)455 1008 y Fx(,)-6 b Fn(!)508 1007 y Fx(v)527
1011 y Fl(i)p 175 1032 604 2 v 180 1081 a Fw(b)q(o)o(x)11
b Fx(e)f Fw(with)g Fx(x)378 1085 y Fl(i)402 1081 y FB(=)g
Fx(e)460 1085 y Fl(i)498 1057 y Fz(0)484 1082 y Fx(,)-6
b Fn(!)537 1081 y Fw(b)q(o)o(x)11 b Fx(e)p FB([)p Fx(x)656
1085 y Fl(i)679 1081 y FB(:=)f Fx(v)749 1085 y Fl(i)762
1081 y FB(])858 1007 y Fx(e)900 982 y Fz(0)886 1008 y
Fx(,)-6 b Fn(!)940 1007 y Fw(b)q(o)o(x)10 b Fx(e)1025
992 y Fg(0)1075 1007 y Fx(e)1093 992 y Fg(0)1128 982
y Fz(0)1114 1008 y Fx(,)-6 b Fn(!)1168 1007 y Fx(v)p
852 1032 342 2 v 918 1081 a Fw(unb)q(o)o(x)10 b Fx(e)1068
1057 y Fz(0)1054 1082 y Fx(,)-6 b Fn(!)1107 1081 y Fx(v)1273
1007 y(e)1291 1011 y Fl(i)1329 982 y Fz(0)1315 1008 y
Fx(,)g Fn(!)1368 1007 y Fx(v)1387 1011 y Fl(i)1438 1007
y Fx(e)p FB([)p Fx(x)1489 1011 y Fl(i)1513 1007 y FB(:=)10
b Fx(v)1583 1011 y Fl(i)1596 1007 y FB(])1631 982 y Fz(0)1617
1008 y Fx(,)-6 b Fn(!)1670 1007 y(h)p Fx(v)1705 992 y
Fg(0)1716 1007 y Fn(i)39 b Fx(v)1790 992 y Fg(0)1789
1014 y Fz(0)1830 982 y(0)1816 1008 y Fx(,)-6 b Fn(!)1870
1007 y Fx(v)p 1267 1032 629 2 v 1395 1081 a Fw(run)10
b Fx(e)h Fw(with)f Fx(x)1589 1085 y Fl(i)1612 1081 y
FB(=)h Fx(e)1671 1085 y Fl(i)1708 1057 y Fz(0)1695 1082
y Fx(,)-6 b Fn(!)1748 1081 y Fx(v)231 1145 y(e)260 1120
y Fl(n)p Fz(+)260 1145 y Fx(,)g Fn(!)10 b Fx(v)p 195
1169 174 2 v 201 1216 a Fn(h)p Fx(e)p Fn(i)271 1190 y
Fl(n)260 1215 y Fx(,)-6 b Fn(!)313 1216 y(h)p Fx(v)q
Fn(i)p 442 1169 120 2 v 448 1219 a Fx(x)481 1194 y Fl(n)p
Fz(+)481 1219 y Fx(,)g Fn(!)10 b Fx(x)p 636 1169 109
2 v 86 w(c)669 1194 y Fl(n)p Fz(+)669 1219 y Fx(,)-6
b Fn(!)10 b Fx(c)824 1145 y(e)842 1149 y Fz(1)870 1120
y Fl(n)p Fz(+)870 1145 y Fx(,)-6 b Fn(!)10 b Fx(v)942
1149 y Fz(1)998 1145 y Fx(e)1016 1149 y Fz(2)1044 1120
y Fl(n)p Fz(+)1044 1145 y Fx(,)-6 b Fn(!)10 b Fx(v)1116
1149 y Fz(2)p 818 1169 321 2 v 863 1219 a Fx(e)881 1223
y Fz(1)911 1219 y Fx(e)929 1223 y Fz(2)956 1194 y Fl(n)p
Fz(+)956 1219 y Fx(,)-6 b Fn(!)11 b Fx(v)1029 1223 y
Fz(1)1058 1219 y Fx(v)1077 1223 y Fz(2)1480 1145 y Fx(e)1498
1149 y Fl(i)1522 1120 y(n)p Fz(+)1522 1145 y Fx(,)-6
b Fn(!)10 b Fx(v)1594 1149 y Fl(i)p 1213 1169 663 2 v
1218 1219 a Fw(b)q(o)o(x)h Fx(e)f Fw(with)g Fx(x)1416
1223 y Fl(i)1440 1219 y FB(=)g Fx(e)1498 1223 y Fl(i)1522
1194 y(n)p Fz(+)1522 1219 y Fx(,)-6 b Fn(!)10 b Fw(b)q(o)o(x)h
Fx(e)f Fw(with)g Fx(x)1773 1223 y Fl(i)1796 1219 y FB(=)h
Fx(v)1856 1223 y Fl(i)292 1282 y Fx(e)320 1257 y Fl(n)p
Fz(+)320 1282 y Fx(,)-6 b Fn(!)10 b Fx(v)p 231 1306 224
2 v 237 1356 a(\025x:e)320 1331 y Fl(n)p Fz(+)320 1357
y Fx(,)-6 b Fn(!)373 1356 y Fx(\025x:v)567 1282 y(e)595
1257 y Fl(n)p Fz(+)595 1282 y Fx(,)g Fn(!)11 b Fx(v)p
528 1306 180 2 v 535 1356 a Fw(~)q Fx(e)584 1331 y Fl(n)p
Fz(++)595 1357 y Fx(,)-6 b Fn(!)661 1356 y Fw(~)q Fx(v)894
1282 y(e)923 1257 y Fl(n)p Fz(+)923 1282 y Fx(,)g Fn(!)10
b Fx(v)p 781 1306 328 2 v 787 1356 a Fw(unb)q(o)o(x)g
Fx(e)923 1331 y Fl(n)p Fz(+)923 1357 y Fx(,)-6 b Fn(!)976
1356 y Fw(unb)q(o)o(x)10 b Fx(v)1358 1282 y(e)1376 1286
y Fl(i)1400 1257 y(n)p Fz(+)1400 1282 y Fx(,)-6 b Fn(!)10
b Fx(v)1472 1286 y Fl(i)1562 1282 y Fx(e)1590 1257 y
Fl(n)p Fz(+)1590 1282 y Fx(,)-6 b Fn(!)11 b Fx(v)p 1183
1306 657 2 v 1189 1356 a Fw(run)f Fx(e)h Fw(with)e Fx(x)1382
1360 y Fl(i)1406 1356 y FB(=)h Fx(e)1464 1360 y Fl(i)1488
1331 y(n)p Fz(+)1488 1357 y Fx(,)-6 b Fn(!)1541 1356
y Fw(run)11 b Fx(v)h Fw(with)d Fx(x)1737 1360 y Fl(i)1761
1356 y FB(=)h Fx(v)1820 1360 y Fl(i)150 1558 y FG(7.3.7)48
b(Categorical)14 b(Seman)o(tics)g(of)h(Tw)o(o-)h(and)f(Multi-Lev)o(el)e
(Languages)150 1673 y FI(Moggi)e(adv)o(o)q(cates)j(a)e
(category-theoretic)i(approac)o(h)f(to)g(t)o(w)o(o-lev)o(el)e
(languages)h(and)h(uses)h(indexed)f(categories)150 1747
y(to)f(dev)o(elop)g(mo)q(dels)f(for)h(t)o(w)o(o)f(languages)h(similar)e
(to)i FF(\025)1019 1732 y Fi(\003)1059 1747 y FI(and)g
FF(\025)1162 1732 y Fs(\015)1209 1747 y FI([53],)f(stressing)i(the)g
(formal)c(analogies)i(with)150 1822 y(a)g(categorical)h(accoun)o(t)g
(of)f(phase)i(distinction)e(and)h(mo)q(dule)e(languages.)h(He)h(also)f
(p)q(oin)o(ts)h(out)g(that)g(the)g(use)h(of)150 1897
y(stateful)d(functions)g(suc)o(h)h(as)f FH(gensym)k FI(or)c
FH(newname)k FI(in)c(the)h(seman)o(tics)e(mak)o(es)g(their)i(use)g(for)
e(formal)f(reasoning)150 1972 y(hard.)17 b(The)g(big-step)g(seman)o
(tics)g(presen)o(ted)i(in)d(this)h(dissertation)h(a)o(v)o(oids)d(the)j
(use)g(of)e(a)h FH(gensym)s FI(.)g(He)h(also)150 2046
y(p)q(oin)o(ts)f(out)f(that)h(t)o(w)o(o-lev)o(el)f(languages)h
(generally)f(ha)o(v)o(e)h(not)f(b)q(een)i(presen)o(ted)h(along)d(with)g
(an)h(equational)150 2121 y(calculus.)12 b(Our)g(reduction)h(seman)o
(tics)e(has)h(eliminated)e(this)i(problem)e(for)i(MetaML,)f(and)h(to)g
(our)g(kno)o(wledge,)150 2196 y(is)i(the)g(\014rst)h(correct)h(presen)o
(tation)e(of)g(a)f(m)o(ulti-stage)f(language)h(using)h(a)f(reduction)i
(seman)o(tics)1698 2181 y FA(3)1716 2196 y FI(.)150 2279
y(Moggi)f FH(et)i(al.)e FI([6])g(presen)o(ts)j(a)e(careful)g
(categorical)g(analysis)f(of)g(the)i(in)o(teractions)f(b)q(et)o(w)o
(een)i(the)e(t)o(w)o(o)g(logical)150 2354 y(mo)q(dalities)i(studied)i
(b)o(y)g(Da)o(vies)f(and)h(Pfenning)g([23,)5 b(22])18
b(and)h(computational)d(monads)i([52].)e(This)j(w)o(ork)150
2428 y(builds)13 b(on)h(a)g(previous)g(study)g([5])f(in)g(the)i(the)f
(categorical)g(seman)o(tics)f(of)g(m)o(ulti-lev)o(el)e(languages,)i
(whic)o(h)h(has)150 2503 y(greatly)c(in\015uenced)i(the)f(design)g(of)f
FH(AIM)g FI(and)h FF(\025)911 2488 y FE(BN)970 2503 y
FI(.)f(In)h(particular,)e(this)i(study)g(of)f(the)h(categorical)f
(seman)o(tics)p 150 2582 237 2 v 158 2608 a Fz(3)188
2624 y FB(An)k(earlier)h(attempt)f(to)f(devise)i(suc)o(h)f(a)g
(reduction)h(seman)o(tics)g([91])e(is)h(\015a)o(w)o(ed.)f(It)g(w)o(as)h
(based)g(on)g(lev)o(el-annotated)188 2670 y(terms,)f(and)h(therefore)f
(su\013ers)h(from)f(the)g(complications)j(that)d(are)g(addressed)i(b)o
(y)e Fx(\025)p FB(-T.)p eop
%%Page: 140 151
140 150 bop 1862 0 a FB(140)150 192 y FI(w)o(as)12 b(highly)f
(instrumen)o(tal)f(in)i(ac)o(hieving)f(a)h(seman)o(tically)d(sound)k
(in)o(tegration)e(of)g(the)i(t)o(w)o(o)e(logical)f(mo)q(dalities)150
266 y(in)j FF(\025)222 251 y FE(BN)282 266 y FI(.)150
401 y FG(7.3.8)48 b(Lev)o(el-Annotati)o(on)o(s)150 503
y FI(Lev)o(el)14 b(annotations)g(ha)o(v)o(e)f(b)q(een)j(used,)e(for)g
(example,)e(b)o(y)i(Russell)g(to)g(address)h(the)g(parado)o(x)e(he)i(p)
q(oin)o(ted)f(out)150 578 y(to)j(F)m(rege)301 563 y FA(4)338
578 y FI([101],)e(b)o(y)i(Quine)h(in)f(his)h(system)f(New)h(F)m
(oundations)e(for)h(logic)g([70],)e(b)o(y)j(Cardelli)e(in)h(his)g(t)o
(yp)q(e)150 653 y(system)12 b(with)g(phase)h(distinction)f([11],)f(b)o
(y)h(Dan)o(vy)f(and)i(Malmkj\032r)d(in)i(a)g(study)h(of)e(the)i
(re\015ectiv)o(e)h(to)o(w)o(er)f([19],)150 728 y(and)h(b)o(y)f(Gl)q
(\177)-22 b(uc)o(k)14 b(and)f(collab)q(orators)h([29,)5
b(30])13 b(in)g(their)i(m)o(ulti-lev)o(el)c(programmi)o(ng)g
(languages.)150 811 y(In)18 b(this)g(dissertation,)g(our)g(exp)q
(erience)i(w)o(as)e(that)g(lev)o(el-annotations)e(are)j(useful)f(as)g
(part)g(of)f(a)h(predicate)150 885 y(classifying)i(terms)g(at)h(v)n
(arious)f(lev)o(els,)g(whereas)i(annotating)e(the)h(subterms)g
(themselv)o(es)g(with)f(lev)o(els)h(is)150 960 y(instructiv)o(e)c(but)f
(not)g(necessarily)h(practical)f(for)g(direct)g(reasoning)g(ab)q(out)g
(programs)f(at)h(the)g(source)i(lev)o(el.)150 1035 y(Dan)o(vy)12
b(and)h(Malmkj\032r)e(seem)i(to)g(ha)o(v)o(e)g(had)g(a)g(similar)d(exp)
q(erience)16 b(in)c(their)i(study)f(of)g(the)h(re\015ectiv)o(e)g(to)o
(w)o(er.)150 1179 y FG(Reduction)i(Seman)o(tics)g(and)i(Equational)e
(Theories)h(for)h(Multi-Lev)o(el)d(Languages)23 b FI(Muller)16
b(has)150 1254 y(studied)i(the)h(reduction)f(seman)o(tics)g(of)f
FE(quote)i FI(and)f FE(eval)g FI(in)f(the)i(con)o(text)f(of)f(LISP)h
([56].)e(Muller)i(observ)o(ed)150 1329 y(that)12 b(his)g(form)o
(ulation)d(of)i(these)j(constructs)g(breaks)f(con\015uence.)g(The)g
(reason)f(for)g(this)g(seems)g(to)g(b)q(e)h(that)f(his)150
1403 y(calculus)i(distinguishes)g(b)q(et)o(w)o(een)h(s-expressions)g
(and)f(represen)o(tations)h(of)e(s-expressions.)i(Muller)f(prop)q(oses)
150 1478 y(a)f(closedness)i(restriction)g(in)d(the)i(notion)f(of)g
(reduction)h(for)f FE(eval)h FI(and)f(sho)o(ws)g(that)h(this)f
(restores)j(con\015uence.)150 1561 y(Muller)c(has)h(also)f(studied)i
(the)f(reduction)g(seman)o(tics)f(of)g(the)i FF(\025)p
FI(-calculus)e(extended)j(with)d(represen)o(tations)j(of)150
1636 y FF(\025)f FI(terms,)e(and)h(with)g(a)h(notion)e(of)h
FF(\014)j FI(reduction)e(on)f(these)i(represen)o(tations)g([57].)d
(Muller)h(observ)o(ed)h(that)g(this)150 1710 y(calculus)g(lac)o(ks)g
(con\015uence,)h(and)f(uses)h(a)e(t)o(yp)q(e)i(system)e(to)h(restore)i
(con\015uence.)150 1793 y(In)9 b(b)q(oth)h(of)f(Muller's)g(studies,)h
(the)g(language)e(can)i(express)h(taking)d(ob)r(ject-co)q(de)j(apart)e
(\(in)o(tensional)g(analysis\).)150 1876 y(W)m(and)16
b(has)g(studied)i(the)f(equational)e(theory)j(for)e(LISP)h
(meta-programm)n(ing)c(construct)19 b FE(fexp)o(r)e FI(and)f(found)150
1951 y(that)g(\\the)h(theory)g(of)f FE(fexp)o(r)p FI(s)h(is)f(trivial")
f(in)h(the)h(sense)h(that)f(the)g FF(\014)r FI(-rule)g(\(or)f(\\seman)o
(tic)f(equalit)o(y"\))h(is)g(not)150 2026 y(v)n(alid)g(on)i
FE(fexp)o(r)p FI(s)h([99].)d(W)m(and,)h(ho)o(w)o(ev)o(er,)g(predicted)j
(that)e(there)h(are)f(other)h(meta-programm)o(i)o(ng)c(systems)150
2101 y(with)g(a)f(more)h(in)o(teresting)g(equational)f(theory)m(.)h(As)
g(evidenced)i(b)o(y)d(CBN)i FF(\025)p FI(-U,)f(MetaML)g(is)g(an)g
(example)f(of)150 2175 y(suc)o(h)h(a)e(system.)150 2321
y FD(7.4)56 b(On)19 b(the)f(History)f(of)i(Quotation)150
2440 y FI(F)m(ormal)c(logic)h(is)h(a)g(w)o(ell-dev)o(elop)q(ed)g
(discipline)g(from)e(whic)o(h)i(programming)d(languages)j(researc)o(h)i
(inherits)150 2515 y(man)o(y)c(tec)o(hniques.)k(It)e(is)g(therefore)i
(illuminati)o(ng)14 b(to)k(review)f(one)h(of)f(the)h(foundational)d(w)o
(orks)j(in)e(formal)p 150 2582 237 2 v 158 2608 a Fz(4)188
2624 y FB(As)c(Russell)i(is)e(often)g(view)o(ed)g(as)g(the)g(father)f
(of)h(t)o(yp)q(e)g(theory)m(,)g(w)o(e)f(can)h(also)h(view)f(his)g
(notion)i(of)d(lev)o(el)i(as)f(primordial)188 2670 y(to)h(to)q(da)o(ys)
h(notion)h(of)d(t)o(yp)q(es.)p eop
%%Page: 141 152
141 151 bop 1862 0 a FB(141)150 192 y FI(logic)15 b(that)i(is)f
(closely)g(related)h(to)f(the)h(dev)o(elopmen)o(t)e(presen)o(ted)k(in)d
(this)g(dissertation,)g(and)g(to)h(review)f(the)150 266
y(w)o(ork)e(done)g(in)f(the)i(con)o(text)f(of)g(LISP)g(on)f(migrating)f
(this)h(w)o(ork)h(in)o(to)f(the)i(programmi)o(ng)c(languages)i(arena.)
150 397 y FG(7.4.1)48 b(Quasi-Quotes.)13 b(Or,)j(Quine's)e(\\Corners")
150 497 y FH(Quasi-quotes)h FI(are)e(a)e(formal)e(notation)i(dev)o
(elop)q(ed)i(b)o(y)e(the)i(logician)d(Willard)g(v)n(an)h(Orman)g(Quine)
h(to)f(empha-)150 572 y(size)16 b(some)f(seman)o(tics)g(subtleties)h
(in)o(v)o(olv)o(ed)e(in)h(the)h(construction)h(of)e(logical)f(form)o
(ulae.)e(Quine)k(in)o(tro)q(duced)150 647 y(quasi-quotes)d(to)h(formal)
d(logic)h(around)h(1940)g(as)g(a)g(w)o(a)o(y)g(of)g(distinguishing)f(b)
q(et)o(w)o(een)i(the)g(meaning)e(denoted)150 721 y(b)o(y)i(some)g(syn)o
(tax,)f(and)h(the)h(syn)o(tax)g(itself)f([71].)e(His)i(motiv)n(ations)e
(seems)i(to)g(lie)g(primarily)e(in)i(the)h(fact)f(that)150
796 y(v)n(ariables)f(where)i(used)g(in)e(three)j(seman)o(tically)11
b(distinct)k(w)o(a)o(ys.)150 879 y(In)9 b(this)h(section)g(w)o(e)f
(presen)o(t)i(t)o(w)o(o)e(excerpts)i(from)d(Quine's)h(original)f
(writings)g(that)i(are)f(largely)g(self-explanatory)m(.)150
1020 y FG(The)18 b(Greek)g(Letter)f(Con)o(v)o(en)o(tion)k
FI(W)m(e)16 b(b)q(egin)g(with)g(Quine's)h(description)g(of)e(the)i
(state-of-the-art)g(for)150 1095 y(dealing)d(with)g(ob)r(ject-programs)
h(at)f(that)h(time,)e(namely)g FH(the)j(Gr)n(e)n(ek)f(letter)g(c)n
(onvention)p FI(.)g(In)g FH(Essay)h(V:)f(New)150 1170
y(F)m(oundations)h(for)e(Mathematic)n(al)h(L)n(o)n(gic)f
FI([71,)e(P)o(age)i(83])f(Quine)h(writes:)221 1265 y
FH(\\In)i(stating)f(the)h(de\014nitions,)g(Gr)n(e)n(ek)f(letters)f(`)p
FF(\013)p FH(',)h(`)p FF(\014)r FH(',)g(`)p FF(\015)r
FH(',)h(`)p FF(\036)p FH(',)e(`)p FF( )q FH(',)h(`)p
FF(\037)p FH(',)g(and)h(`)p FF(!)q FH(')g(wil)r(l)e(b)n(e)h(use)n(d)h
(to)221 1340 y(r)n(efer)f(to)i(expr)n(essions.)g(The)f(letters)g(`)p
FF(\036)p FH(',)f FF( )q FH(',)i(`)p FF(\037)p FH(',)f(and)i(`)p
FF(!)q FH(')e(wil)r(l)f(r)n(efer)h(to)h(any)g(formulas,)f(and)i(`)p
FF(\013)p FH(',)221 1415 y(`)p FF(\014)r FH(',)d(and)h(`)p
FF(\015)r FH(')g(wil)r(l)e(r)n(efer)g(to)i(variables.)e(When)j(they)f
(ar)n(e)f(emb)n(e)n(dde)n(d)h(among)g(signs)g(b)n(elonging)g(to)f(the)
221 1489 y(lo)n(gic)n(al)g(language)j(itself,)d(the)i(whole)f(is)g(to)h
(r)n(efer)e(to)h(the)h(expr)n(ession)g(forme)n(d)f(by)h(so)f(emb)n(e)n
(dding)h(the)221 1564 y(expr)n(essions)12 b(r)n(eferr)n(e)n(d)e(to)j
(by)f(those)g(Gr)n(e)n(ek)g(letters.)f(Thus,)h(`)p FI(\()p
FF(\036)f Fy(j)g FF( )q FI(\))p FH(')i(wil)r(l)e(r)n(efer)g(to)h(the)g
(formula)g(which)221 1639 y(is)f(forme)n(d)h(by)g(putting)h(the)f
(formulas)f FF(\036)h FH(and)h FF( )q FH(,)f(whatever)g(they)g(may)h(b)
n(e,)e(in)i(the)f(r)n(esp)n(e)n(ctive)f(blanks)h(of)221
1713 y(`)p FI(\()34 b Fy(j)g FI(\))p FH('.)12 b(The)g(expr)n(ession)g
(`)p FI(\()p FF(\036)g Fy(j)f FF( )q FI(\))p FH(')h(itself)f(is)h(not)h
(a)f(formula,)f(but)i(a)f(noun)h(describing)f(a)h(formula;)e(it)221
1788 y(is)g(short)h(for)g(the)g(description)g(`the)g(formula)f(forme)n
(d)h(by)g(writing)f(a)i(left)e(p)n(ar)n(enthesis,)h(fol)r(lowe)n(d)f
(by)h(the)221 1863 y(formula)g FF(\036)p FH(,)h(fol)r(lowe)n(d)f(by)i
(a)f(str)n(oke,)f(fol)r(lowe)n(d)h(by)g(the)g(formula)g
FF( )q FH(,)g(fol)r(lowe)n(d)g(by)g(a)h(right)e(p)n(ar)n(enthesis',)221
1938 y(etc.)h(Such)j(use)e(of)g(Gr)n(e)n(ek)g(letter)f(has)i(no)g(plac)
n(e)f(in)g(the)g(language)i(under)e(discussion,)h(but)f(pr)n(ovides)g
(a)221 2012 y(me)n(ans)h(of)g(discussing)g(that)g(language.")150
2112 y FI(T)m(o)d(rephrase,)i FF(\013)p FI(,)d FF(\014)r
FI(,)i(and)g FF(\015)i FI(range)e(o)o(v)o(er)f FH(obje)n(ct-language)j
(variable)e(names)p FI(,)g(and)f FF(\036)p FI(,)g FF( )q
FI(,)h FF(\037)p FI(,)f(and)g FF(!)i FI(range)f(o)o(v)o(er)150
2187 y(expressions.)j(Note)f(the)g(use)h(of)e(single-quotes)h(`)p
934 2187 13 2 v 15 w(')f(that)h(w)o(as)f(the)i(standard)f(at)f(the)i
(time)d(for)i(talking)e(ab)q(out)150 2261 y(ob)r(ject-terms.)150
2403 y FG(The)j(Problem)f(and)h(The)g(Solution)i FI(In)c(the)i(next)f
(c)o(hapter,)g FH(Essay)h(VI:)f(L)n(o)n(gic)g(and)h(The)g(R)n(ei\014c)n
(ation)g(of)150 2477 y(Universals)d FI([71,)f(P)o(age)h(111],)f(Quine)i
(con)o(trasts)g(the)g(seman)o(tic)f(di\013erences)i(b)q(et)o(w)o(een)g
(the)f(usage)g(of)f(v)n(ariables)150 2552 y(in)g(the)i(expression)911
2648 y(\()p Fy(9)d FF(\013)p FI(\)\()p FF(\036)20 b Fy(_)g
FF( )q FI(\))677 b(\(7.1\))p eop
%%Page: 142 153
142 152 bop 1862 0 a FB(142)150 192 y FI(and)14 b(the)g(expression)937
303 y FF(p)23 b Fy(\))f FF(p)9 b Fy(^)g FF(p)702 b FI(\(7.2\))150
414 y(where)12 b FF(p)e FI(is)g(a)g(particular)g(name)g(in)g(an)g(ob)r
(ject-language,)g(sa)o(y)g(prop)q(ositional)f(logic,)g(that)h(is)h
(under)g(discussion.)150 497 y(Quine)j(explains)419 482
y FA(5)438 497 y FI(:)221 599 y FH(\\)j(...)e(`)p FF(\036)p
FH(')h(c)n(ontr)n(asts)g(with)g(`)p FF(p)p FH(')g(in)h(two)f(b)n(asic)h
(ways.)f(First,)f(`)p FF(\036)p FH(')h(is)g(a)h(variable,)f(taking)h
(sentenc)n(es)g(as)221 664 y(values;)i(`)p FF(p)p FH(',)f(c)n(onstrue)n
(d)h(schematic)n(al)r(ly,)f(is)h(not)g(a)h(variable)e(\(in)h(the)g
(value-taking)h(sense\))f(at)g(al)r(l.)221 728 y(Se)n(c)n(ond,)14
b(`)p FF(\036)p FH(')f(is)h(gr)n(ammatic)n(al)r(ly)e(substantival,)i(o)
n(c)n(cupying)h(the)f(plac)n(e)g(of)f(names)i(of)e(sentenc)n(es;)i(`)p
FF(p)p FH(')e(is)221 793 y(gr)n(ammatic)n(al)r(ly)g(sentential,)i(o)n
(c)n(cupying)h(the)f(plac)n(e)g(of)g(sentenc)n(es.)221
857 y(This)g(latter)f(c)n(ontr)n(ast)i(is)f(danger)n(ously)h(obscur)n
(e)n(d)g(by)f(the)h(usage)g(7.1)1319 842 y FA(6)1338
857 y FH(,)f(which)h(shows)f(the)h(Gr)n(e)n(ek)f(let-)221
922 y(ters)h(`)p FF(\036)p FH(')h(and)h(`)p FF( )q FH(')g(in)f
(sentential)h(r)n(ather)e(than)i(substantival)g(p)n(ositions.)f(But)h
(this)f(usage)h(would)f(b)n(e)221 987 y(nonsense)i(exc)n(ept)f(for)f
(the)g(sp)n(e)n(cial)h(and)g(arti\014cial)f(c)n(onvention)i(of)e(Essay)
i(V)e(\(p.)h(83\))1620 971 y FA(7)1656 987 y FH(c)n(onc)n(erning)221
1051 y(the)d(emb)n(e)n(dding)g(of)g(Gr)n(e)n(ek)g(letters)f(among)i
(signs)f(of)g(the)g(lo)n(gic)n(al)g(language.)g(A)n(c)n(c)n(or)n(ding)g
(to)g(that)g(c)n(on-)221 1116 y(vention,)g(the)g(usage)g(7.1)g(is)g
(shorthand)g(for)g(the)g(unmisle)n(ading)g(substantive:)291
1179 y(the)k(r)n(esult)f(of)h(putting)h(the)f(variable)f
FF(\013)h FH(and)h(the)f(sentenc)n(es)g FF(\036)g FH(and)h
FF( )g FH(in)f(the)h(r)n(esp)n(e)n(ctive)291 1244 y(blanks)15
b(of)g(`)p FI(\()p Fy(9)35 b FI(\)\()g Fy(_)f FI(\))p
FH('.)221 1307 y(Her)n(e)15 b(the)i(Gr)n(e)n(ek)f(letters)f(cle)n(arly)
h(o)n(c)n(cur)g(in)h(noun)g(p)n(ositions)g(\(r)n(eferring)d
FI(to)j FH(a)f(variable)g(and)h(to)g(two)221 1371 y(statements\),)e
(and)h(the)f(whole)g(is)h(a)f(noun)i(in)e(turn.)g(In)h(some)f(of)h(my)f
(writings,)f(for)h(example)h([69])1818 1356 y FA(8)1837
1371 y FH(,)221 1436 y(I)i(have)h(insiste)n(d)f(on)h(\014tting)f(the)g
(misle)n(ading)g(usage)h(7.1)g(with)e(a)i(safety)f(devic)n(e)h(in)f
(the)g(form)g(of)g(a)221 1501 y(mo)n(di\014e)n(d)d(typ)n(e)g(of)g
(quotation)g(marks,)g(thus:)890 1602 y Fh(p)p FI(\()p
Fy(9)d FF(\013)p FI(\)\()p FF(\036)20 b Fy(_)g FF( )q
FI(\))p Fh(q)221 1714 y FH(These)f(marks)f(rightly)g(suggest)h(that)g
(the)g(whole)g(is,)f(like)h(an)g(or)n(dinary)g(quotation,)g(a)g
(substantive)221 1788 y(which)h(r)n(efers)f FI(to)i FH(an)g(expr)n
(ession;)g(also)f(they)h(c)n(onspicuously)h(isolate)e(those)h(p)n
(ortions)f(of)h(text)f(in)221 1863 y(which)14 b(the)h(c)n(ombine)n(d)g
(use)g(of)f(Gr)n(e)n(ek)g(letters)g(and)h(lo)n(gic)n(al)f(signs)h(is)f
(to)g(b)n(e)h(o)n(dd)r(ly)g(c)n(onstrue)n(d.)g(In)g(most)221
1938 y(of)20 b(the)g(liter)n(atur)n(e,)e(however,)i(these)g
(quasi-quotation)h(marks)f(ar)n(e)g(omitte)n(d.)f(The)i(usage)f(of)h
(most)221 2013 y(lo)n(gicians)16 b(who)h(take)h(c)n(ar)n(e)e(to)h(pr)n
(eserve)g(the)g(semantic)g(distinctions)g(at)g(al)r(l)f(is)h(that)g
(exempli\014e)n(d)g(by)221 2087 y(Essay)e(V)g(\(though)g(c)n(ommonly)g
(with)g(German)g(or)f(b)n(oldfac)n(e)h(L)n(atin)g(letters)f(inste)n(ad)
h(of)g(Gr)n(e)n(ek\).")150 2200 y FI(T)m(o)q(da)o(y)m(,)d(Quine's)h
(quasi-quotes)h(are)g(a)f(standard)h(to)q(ol)f(for)g(distinguishing)f
(b)q(et)o(w)o(een)j(ob)r(ject-language)e(terms)150 2274
y(and)h(meta-language)d(terms.)j(\(See)h(for)e(example)g([1,)5
b(16,)h(51].\))p 150 2353 237 2 v 158 2380 a Fz(5)188
2396 y FB(F)m(o)q(otnotes)16 b(in)g(the)e(follo)o(wing)j(quotation)g
(will)f(p)q(oin)o(t)g(out)f(when)g(a)g(reference)g(is)h(n)o(um)o(b)q
(ered)g(with)f(resp)q(ect)g(to)g(this)188 2442 y(dissertation)e(\()p
FC(meta-level)t FB(\))7 b(or)j(to)f(Quine's)i(b)q(o)q(ok)g(\()p
FC(obje)n(ct-level)s FB(\).)6 b(Dw)o(elling)13 b(on)d(this)h(concrete)f
(example)i(of)d(problems)188 2487 y(that)j(arise)h(when)e(w)o(e)g(w)o
(an)o(t)h(to)f(b)q(e)h(formal)g(ab)q(out)h(the)e(seman)o(tics)i(of)f(m)
o(ulti-lev)o(el)i(expressions)g(seemed)e(appropriate)188
2533 y(for)h(this)h(dissertation.)158 2563 y Fz(6)189
2579 y FC(Meta-level)e(e)n(quation)e(numb)n(er.)158 2608
y Fz(7)189 2624 y FC(Obje)n(ct-level)h(p)n(age)h(numb)n(er.)158
2654 y Fz(8)189 2670 y FC(Meta-level)g(citation)f(numb)n(er.)p
eop
%%Page: 143 154
143 153 bop 1862 0 a FB(143)150 192 y FG(7.4.2)48 b(LISP's)15
b(Bac)o(k-Quote)g(and)g(Comma)150 297 y FI(Lik)o(e)e(man)o(y)f(go)q(o)q
(d)i(ideas)f(from)f(mathematics)g(and)i(logic)e({)i(suc)o(h)g(as)g(t)o
(yp)q(es)h(and)e(the)i FF(\025)p FI(-calculus)f({)f(that)h(w)o(ere)150
372 y(reincarnated)k(in)e(one)h(form)f(or)g(the)i(other)f(in)g
(programmi)o(ng)d(languages,)i(so)g(w)o(ere)i(Quine's)f(quasi-quotes.)
150 447 y FH(Back-quote)g FI(and)c FH(c)n(omma)j FI(app)q(eared)e(in)f
(LISP)g(when)g(Timoth)o(y)e(Hart)i(in)o(tro)q(duced)h(macros)e(to)h
(the)h(language)150 521 y([88].)k(T)m(o)h(illustrate)h(the)g(b)q(eha)o
(vior)g(of)f(bac)o(k-quote,)g(comma,)e(and)i(ev)n(al,)g(consider)i(the)
f(follo)o(wing)d(simple)150 596 y(Sc)o(heme)d([73])e(session:)150
692 y Fb(>)22 b(\(define)e(f)i(\(lambda)e(\(x\))h(`\(+)g(,x)h(,x\)\)\))
150 757 y(>)g(\(f)f(1\))150 821 y(\(+)g(1)h(1\))150 886
y(>)g(\(eval)e(\(f)i(1\)\))150 951 y(2)150 1057 y FI(Steele)15
b(and)f(Gabriel)f(write)h([88]:)221 1160 y FH(\\The)20
b(b)n(ack-quote)h(syntax)g(was)f(p)n(articularly)f(p)n(owerful)g(when)i
(neste)n(d.)f(This)g(o)n(c)n(curr)n(e)n(d)g(primarily)221
1235 y(within)e(macr)n(o-de\014ning)h(macr)n(os;)g(b)n(e)n(c)n(ause)g
(such)g(wer)n(e)f(c)n(o)n(de)n(d)h(primarily)f(by)h(wizar)n(ds,)e(the)i
(ability)221 1309 y(to)i(write)e(and)j(interpr)n(et)e(neste)n(d)h(b)n
(ack-quote)h(expr)n(essions)f(was)g(so)n(on)g(surr)n(ounde)n(d)g(by)h
(a)f(c)n(ertain)221 1384 y(mystique.)16 b(A)o(lan)g(Bawden)h(of)f(MIT)g
(ac)n(quir)n(e)n(d)h(a)f(p)n(articular)f(r)n(eputation)i(as)f(b)n
(ack-quote-meister)g(in)221 1459 y(the)f(e)n(arly)f(days)h(of)g(Lisp)g
(Machine.")150 1564 y FI(And)c(ev)o(en)g(though)g(the)g(adv)o(en)o(t)g
(of)f(the)i(bac)o(k-quote)e(and)h(the)g(macro)f(mec)o(hanisms)f(w)o(as)
h(a)h FH(\\le)n(ap)h(in)g(expr)n(essive)150 1639 y(p)n(ower")s
FI(,)h(there)i(where)g(some)e(problems:)221 1742 y FH(\\Macr)n(os)h(ar)
n(e)g(fr)n(aught)g(with)g(the)g(same)h(kinds)f(of)g(sc)n(oping)h(pr)n
(oblems)f(and)h(ac)n(cidental)g(name)f(c)n(aptur)n(e)221
1817 y(that)f(had)h(ac)n(c)n(omp)n(anie)n(d)g(sp)n(e)n(cial)f
(variables.)f(The)h(pr)n(oblem)g(in)g(Lisp)h(macr)n(os,)e(fr)n(om)h
(the)g(time)g(of)g(Hart)221 1892 y(in)f(1963)g(to)g(the)g(mid-1980's,)g
(is)g(that)g(a)g(macr)n(o)f(c)n(al)r(l)h(exp)n(ands)h(into)f(an)g(expr)
n(essions)g(that)g(is)g(c)n(omp)n(ose)n(d)221 1966 y(of)i(symb)n(ols)h
(that)g(have)g(no)h(attache)n(d)f(semantics.")150 2072
y FI(Th)o(us,)c(while)g(bac)o(k-quote)g(had)h(some)e(of)h(the)h
(\\spirit")f(of)f(quasi-quote,)h(it)g(did)g(not)g(quite)g(capture)i
(the)f(seman-)150 2147 y(tics)f(spirit)f(of)f(Quine's)i(construct:)g
(While)f(quasi-quote)g(w)o(as)g(in)o(v)o(en)o(ted)g(to)g(clarify)g
(binding)f(issues,)i(bac)o(k-quote)150 2222 y(su\013ered)i(from)d(a)i
(v)n(ariet)o(y)f(of)g(seman)o(tic)f(problems.)h(These)h(problems)f(ma)o
(y)f(ha)o(v)o(e)h(b)q(een)i(partly)e(due)h(to)g(the)g(fact)150
2296 y(that)i(bac)o(k-quote)h(seems)f(to)g(ha)o(v)o(e)g(b)q(een)h
(primarily)d(a)i(construct)i(for)d(con)o(v)o(enien)o(tly)h
(constructing)i(lists,)d(and)150 2371 y(the)g(fact)g(that)f(these)i
(lists)f(can)f(also)g(happ)q(en)h(to)g(represen)o(t)i(programs)c(w)o
(as)h(probably)g(somewhat)g(secondary)m(.)150 2446 y(It)i(is)h(also)e
(w)o(orth)h(noting)g(that)g(the)h(ease)h(with)d(whic)o(h)i(programs)e
(can)h(b)q(e)h(manipulate)d(in)i(LISP)h(encourages)150
2521 y(meta-programm)o(i)o(ng.)f(Ho)o(w)o(ev)o(er,)j(it)f(should)h(b)q
(e)h(noted)g(that)f(this)g(enco)q(ding)g(do)q(es)h(not)f(pro)o(vide)g
(an)o(y)f(auto-)150 2595 y(matic)d(renaming)g(supp)q(ort)j(needed)g
(for)e(a)g(correct)j(treatmen)o(t)d(of)g(b)q(ound)h(v)n(ariables)f(in)g
(meta-programm)o(i)o(ng)150 2670 y(systems.)p eop
%%Page: 144 155
144 154 bop 1862 0 a FB(144)150 192 y FI(The)12 b(Sc)o(heme)g(comm)o
(unit)o(y)c(con)o(tin)o(ued)k(the)h(dev)o(elopmen)o(t)d(of)i(these)h
(features.)f FH(\\Ne)n(arly)h(everyone)g(agr)n(e)n(e)n(d)g(that)150
266 y(macr)n(o)i(facilities)f(wer)n(e)h(invaluable)h(in)f(principle)g
(and)h(in)g(pr)n(actic)n(e)f(but)g(lo)n(oke)n(d)h(down)g(up)n(on)g(e)n
(ach)g(p)n(articular)150 341 y(instanc)n(e)e(as)g(a)g(sort)f(of)g
(shameful)h(family)f(se)n(cr)n(et.)g(If)g(only)h(The)g(R)o(ight)f
(Thing)h(c)n(ould)g(b)n(e)f(found!")h FI([88].)c(Clinger)150
416 y(and)k(Rees)i(clari\014ed)e(the)h(problem)e(of)h(renaming)f(in)h
(macros)g(using)g(an)g(analogy)f(with)h(reductions)i(in)e(the)h
FF(\025)p FI(-)150 490 y(calculus)e([13].)f(In)h(particular,)f(they)i
(explained)f(wh)o(y)g(there)h(is)f(a)g(need)h(for)f(renaming)f(at)h
(run-time,)e(and)i(wh)o(y)150 565 y(static)f(renaming)d(is)i(not)g
(enough.)g(In)g(the)h FF(\025)p FI(-calculus,)f(run-time)f(corresp)q
(onds)k(to)d FF(\014)r FI(-reductions,)h(and)f(renam-)150
640 y(ing)k(corresp)q(onds)k(to)d FF(\013)p FI(-renamings.)e(In)i(the)h
FF(\025)p FI(-calculus,)f(b)q(oth)g(kinds)g(of)g(reductions)h(m)o(ust)e
(b)q(e)i(in)o(terlea)o(v)o(ed)150 715 y(b)q(ecause)f
FF(\014)h FI(reductions)f(can)e(in)o(v)o(olv)o(e)f(duplication)g(and)i
(then)g(re-com)o(bination)d(\(th)o(us)j(p)q(oten)o(tial)f(con\015ict\))
h(of)150 789 y(co)q(de.)d(Hygienic)f(macros)f(w)o(ere)i(later)g(dev)o
(elop)q(ed)g(b)o(y)f(Kohlb)q(ec)o(k)o(er,)h(F)m(riedman,)d(F)m
(elleisen,)h(and)h(Duba)g([44])f(and)150 864 y(pro)o(vided)k(a)g(means)
f(for)g(de\014ning)h(and)g(using)g(macros)f(without)g(needing)i(to)e(w)
o(orry)h(ab)q(out)g(acciden)o(tal)g(name)150 939 y(capture.)h(Ba)o
(wden)f([3])f(giv)o(es)g(a)h(detailed)g(historical)f(review)h(of)g(the)
g(history)g(of)f(quasi-quotations)g(in)g(LISP)m(.)150
1096 y FG(A)19 b(Comparison)d(of)i(MetaML)h(and)e(LISP)23
b FI(MetaML's)17 b(Brac)o(k)o(ets,)g(Escap)q(e,)g(and)f(Run)g(are)g
(analogous)150 1171 y(to)f(LISP's)g(bac)o(k-quote,)g(comma,)d(and)j(ev)
n(al)f(constructs:)j(Brac)o(k)o(ets)f(are)g(similar)d(to)i(bac)o
(k-quote,)g(Escap)q(e)h(is)150 1246 y(similar)10 b(to)h(comma,)e(and)j
(Run)g(is)g(similar)d(to)j(ev)n(al)f(under)i(the)g(empt)o(y)e(en)o
(vironmen)o(t.)f(But)j(the)g(analogy)d(is)i(not)150 1321
y(p)q(erfect.)17 b(LISP)f(do)q(es)h(not)f(ensure)i(that)e(v)n(ariables)
f(\(atoms\))g(o)q(ccurring)i(in)e(a)h(bac)o(k-quoted)g(expressions)i
(are)150 1395 y(b)q(ound)e(according)f(to)g(the)h(rules)g(of)f(static)h
(scoping.)f(F)m(or)g(example)f Fb(`\(plus)20 b(3)i(5\))15
b FI(do)q(es)h FH(not)k FI(bind)15 b Fb(plus)f FI(in)150
1470 y(the)f(scop)q(e)h(where)g(the)g(term)e(is)h FH(pr)n(o)n(duc)n(e)n
(d)p FI(.)f(W)m(e)h(view)g(addressing)g(this)g(problem)e(as)i(an)g(imp)
q(ortan)o(t)e(feature)j(of)150 1545 y(MetaML.)e(W)m(e)g(also)g(view)g
(MetaML's)h(seman)o(tics)f(as)g(a)g(concise)i(formalization)9
b(of)j(the)h(seman)o(tics)f(for)g(LISP's)150 1619 y(three)18
b(constructs)442 1604 y FA(9)463 1619 y FI(,)e(but)h(with)g(static)g
(scoping.)f(This)h(view)f(is)h(similar)d(in)j(spirit)f(to)h(Smith's)e
(seman)o(tically)150 1694 y(motiv)n(ated)d(LISP)i([85,)5
b(86].)12 b(Finally)m(,)f(whereas)k(LISP)f(is)g(dynamically)d(t)o(yp)q
(ed,)i(MetaML)i(is)e(statically)g(t)o(yp)q(ed.)150 1777
y(MetaML's)22 b(annotations)e(can)i(also)f(b)q(e)h(view)o(ed)f(as)g
(pro)o(viding)g(a)g(simple)e(but)j(statically)e(t)o(yp)q(ed)i(macro-)
150 1852 y(expansion)12 b(system.)f(But)i(it)f(is)g(also)f(imp)q(ortan)
o(t)g(to)h(note)g(that)g(the)h(annotations)e(do)h(not)g(allo)o(w)f(the)
h(de\014nition)150 1927 y(of)18 b(new)g(language)f(constructs)j(or)f
(binding)e(mec)o(hanisms,)e(as)k(is)f(often)g(exp)q(ected)i(from)c
(macro-expansion)150 2001 y(systems.)150 2084 y(It)i(is)g(w)o(orth)g
(noting)g(that)g(Hart)g(also)f(used)i FH(gensym)g FI(to)f(explicitly)f
(a)o(v)o(oid)g(capture)i(issues)g(in)f(his)g(original)150
2159 y(rep)q(ort)h(on)e(macros)g([88].)e(T)m(o)q(da)o(y)m(,)h(this)h
(tric)o(k)h(is)g(still)e(closely)i(asso)q(ciated)g(with)f(the)h(use)h
(of)e(bac)o(k-quote)g(in)150 2234 y(Sc)o(heme)c(or)g(LISP)m(.)g(As)g(w)
o(e)h(ha)o(v)o(e)f(p)q(oin)o(ted)g(out)g(in)g(Chapter)h(4,)e(managing)f
(renaming)g(in)i(this)h(manner)e(can)h(b)q(e)150 2309
y(esp)q(ecially)g(di\016cult)g(in)f(the)i(presence)h(of)e(functional)f
(v)n(alues.)g(Th)o(us,)h(alleviating)e(the)i(need)h(for)f(suc)o(h)h
(stateful)150 2383 y(construct)i(in)d(a)h(meta-programm)n(ing)d
(language)i(is)g(an)h(in)o(v)n(aluable)e(b)q(ene\014t)j(of)e(MetaML.)
150 2466 y(Finally)m(,)j(w)o(e)i(should)g(p)q(oin)o(t)f(out)h(that)h
(bac)o(k-quote)f(and)g(comma)d(are)k(themselv)o(es)f(macros)f(in)h
(LISP)m(.)f(This)150 2541 y(state)g(of)f(a\013airs)g(leads)g(to)h(t)o
(w)o(o)e(more)h(concerns.)h(First,)g(they)f(ha)o(v)o(e)h(non-trivial)d
(formal)g(seman)o(tics)i(\(ab)q(out)p 150 2624 237 2
v 158 2651 a Fz(9)188 2666 y FB(When)e(used)g(in)g(the)f(restricted)h
(con)o(text)g(of)e(program)i(generation.)p eop
%%Page: 145 156
145 155 bop 1862 0 a FB(145)150 192 y FI(t)o(w)o(o)11
b(pages)h(of)f(LISP)h(co)q(de\).)h(Second,)f(b)q(ecause)h(of)e(the)i(w)
o(a)o(y)e(they)h(expand)g(at)f(parse-time,)g(they)h(can)g(lead)g(to)f
(a)150 266 y(represen)o(tation)i(o)o(v)o(erhead)f(exp)q(onen)o(tial)g
(in)f(the)h(n)o(um)o(b)q(er)f(of)g(lev)o(els)h(in)f(a)h(m)o(ulti-lev)o
(el)d(program)h([30].)g(MetaML)150 341 y(a)o(v)o(oids)j(b)q(oth)h
(problems)f(b)o(y)h(a)f(direct)i(treatmen)o(t)f(of)f(Brac)o(k)o(et)i
(and)e(Escap)q(e)j(as)e(language)f(constructs.)150 489
y FG(Remark)i(on)g(Meta-Programming)d(in)i(Prolog)19
b FI(Just)14 b(as)f(the)h(similarit)o(y)d(b)q(et)o(w)o(een)j(the)g
(represen)o(tation)150 553 y(of)h(programs)g(and)g(the)h(represen)o
(tation)i(of)d(data)g(mak)o(es)g(meta-programm)o(i)o(ng)e(in)i(LISP)h
(attractiv)o(e,)f(it)h(also)150 618 y(mak)o(es)h(meta-programm)o(i)o
(ng)e(in)i(Prolog)g(attractiv)o(e)h([90,)6 b(47].)16
b(Prolog)h(to)q(o)h(supp)q(orts)h(in)o(tensional)e(analysis)150
683 y(o)o(v)o(er)f(co)q(de,)g(in)g(that)g(it)f FH(\\al)r(lows)i(the)f
(pr)n(o)n(gr)n(ammer)g(to)h(examine)g(and)g(alter)f(the)h(pr)n(o)n(gr)n
(am)f(\(the)h(clauses)g(that)150 748 y(ar)n(e)i(use)n(d)g(to)g(satisfy)
g(his)g(go)n(als\).)f(This)h(is)g(p)n(articularly)e(str)n(aightforwar)n
(d,)g(b)n(e)n(c)n(ause)j(a)f(clause)g(c)n(an)h(b)n(e)f(se)n(en)150
813 y(as)h(just)g(an)h(or)n(dinary)f(Pr)n(olo)n(g)f(structur)n(e.)g
(Ther)n(efor)n(e)g(Pr)n(olo)n(g)h(pr)n(ovides)g(built-in)g(pr)n(e)n
(dic)n(ates)f(to)h(al)r(low)g(the)150 877 y(pr)n(o)n(gr)n(ammer)14
b(to:)176 984 y FG({)21 b FH(Construct)14 b(a)h(structur)n(e)f(r)n(epr)
n(esenting)h(a)g(clause)g(in)g(the)g(datab)n(ase,)176
1048 y FG({)21 b FH(A)n(dd)15 b(a)g(clause,)g(r)n(epr)n(esente)n(d)f
(by)h(a)g(given)g(structur)n(e,)f(to)h(the)g(datab)n(ase,)176
1113 y FG({)21 b FH(R)n(emove)15 b(a)g(clause,)g(r)n(epr)n(esente)n(d)f
(by)h(a)h(given)f(structur)n(e,)e(fr)n(om)i(the)g(datab)n(ase.")g
FI([14])150 1229 y(The)e(application)f(of)h(the)g(results)h(of)f(our)g
(exp)q(erience)i(with)e(MetaML)g(to)g(Prolog)f(are)i(curren)o(tly)g
(unexplored.)150 1304 y(But)f(at)f(least)g(on)g(the)h(surface,)g(there)
h(seem)e(to)g(b)q(e)h(some)e(common)f(themes.)h(F)m(or)h(example,)f
(Prolog,)g(data)h(can)150 1379 y(b)q(e)h(\\run")g(using)g(the)g
FE(call)g FI(predicate.)h(But)f(there)i(again,)c(problems)h(with)g(v)n
(ariables)g(b)q(eing)h(\\a)o(v)n(ailable)e(at)h(the)150
1453 y(righ)o(t)h(time")g(sho)o(w)h(up:)221 1570 y FH(\\[...])d(most)i
(Pr)n(olo)n(g)f(implementations)h(r)n(elax)f(the)h(r)n(estriction)e(we)
i(have)g(imp)n(ose)n(d)g(on)g(lo)n(gic)f(pr)n(o)n(gr)n(ams,)221
1644 y(that)g(the)h(go)n(als)f(in)h(the)f(b)n(o)n(dy)h(of)g(a)f(clause)
h(must)g(b)n(e)f(non-variable)h(terms.)f(The)g FI(meta-v)n(ariable)d
(facilit)o(y)221 1719 y FH(al)r(lows)17 b(a)i(variable)e(to)i(app)n(e)n
(ar)f(as)g(a)h(go)n(al)f(in)g(a)h(c)n(onjunctive)g(go)n(al)f(or)g(in)g
(the)g(b)n(o)n(dy)h(of)f(the)g(clause.)221 1794 y(During)h(the)g(c)n
(omputation,)h(by)f(the)h(time)e(it)h(is)g(c)n(al)r(le)n(d,)f(the)i
(variable)e(must)i(b)n(e)f(instantiate)n(d)g(to)g(a)221
1869 y(term.)c(It)h(wil)r(l)f(then)i(b)n(e)f(tr)n(e)n(ate)n(d)g(as)g
(usual.)h(If)f(the)g(variable)g(is)g(not)h(instantiate)n(d)f(when)h(it)
f(c)n(omes)g(to)221 1943 y(b)n(e)e(c)n(al)r(le)n(d,)h(an)g(err)n(or)f
(is)g(r)n(ep)n(orte)n(d.")h FI([90])150 2060 y(It)j(will)f(b)q(e)i(in)o
(teresting)g(to)f(see)h(if)e(these)j(problems)d(arising)h(in)f
(meta-programm)o(ing)e(in)j(a)f(Prolog)h(can)g(b)q(e)150
2134 y(addressed)f(in)d(a)h(w)o(a)o(y)f(similar)f(to)h(the)i(w)o(a)o(y)
e(w)o(e)h(ha)o(v)o(e)g(addressed)i(some)d(of)g(these)j(basic)e
(meta-programm)o(i)o(ng)150 2209 y(questions)f(for)g(a)g(functional)e
(language.)p eop
%%Page: 146 157
146 156 bop 822 436 a FL(Chapter)31 b(8)803 662 y(Conclusion)949
859 y FC(The)14 b(single)e(biggest)f(pr)n(oblem)i(in)g(c)n(ommunic)n
(ation)949 918 y(is)h(the)e(il)r(lusion)g(that)g(it)h(has)g(taken)f
(plac)n(e.)1481 1011 y FB(George)i(Bernard)g(Sha)o(w)150
1191 y FI(In)j(this)h(c)o(hapter,)g(w)o(e)f(review)h(and)f(appraise)h
(our)f(\014ndings)h(and)f(the)h(exten)o(t)g(to)g(whic)o(h)f(they)h
(supp)q(ort)g(our)150 1265 y(thesis.)e(W)m(e)f(outline)g(future)i(w)o
(ork,)d(and)i(p)q(ose)g(some)f(op)q(en)h(questions)g(that)g(w)o(e)g(b)q
(eliev)o(e)g(are)g(of)f(signi\014cance)150 1340 y(to)f(the)g(researc)o
(h)i(comm)o(unit)o(y)l(.)150 1499 y FD(8.1)56 b(Review)150
1631 y FI(This)12 b(dissertation)g(rep)q(orts)h(on)f(the)h(results)g
(of)e(scrutinizing)h(the)g(design)h(and)e(implemen)o(tation)e(of)i(the)
h(m)o(ulti-)150 1706 y(stage)j(programming)c(language)i(MetaML.)i(Our)g
(approac)o(h)g(to)f(studying)g(MetaML)h(has)g(b)q(een)h(to)e(formalize)
150 1781 y(its)h(seman)o(tics)f(and)h(t)o(yp)q(e)g(system,)f(and)h(the)
g(prop)q(erties)h(w)o(e)f(exp)q(ect)i(them)d(to)g(enjo)o(y)m(.)g(In)h
(doing)f(so,)g(w)o(e)h(ha)o(v)o(e)150 1856 y(iden)o(ti\014ed)g(a)g(v)n
(ariet)o(y)g(of)f(subtleties)i(related)g(to)f(m)o(ulti-stage)e
(programmi)o(ng,)f(and)j(pro)o(vided)g(solutions)f(to)h(a)150
1930 y(n)o(um)o(b)q(er)g(of)g(them.)g(Our)h(results)h(include)f(v)n
(arious)f(forms)f(of)h(formal)f(seman)o(tics)h(for)g(MetaML,)h(in)f
(addition)150 2005 y(to)f(a)h(sound)g(t)o(yp)q(e)g(system.)f(Our)h
(study)g(has)g(also)f(resulted)i(in)e(a)g(prop)q(osal)h(for)f(a)g
(re\014ned)i(t)o(yp)q(e)f(system,)f(and)150 2080 y(a)g(re\014ned)h
(view)e(of)h(the)g(pro)q(cess)i(of)d(dev)o(eloping)g(program)g
(generators)i(using)e(MetaML.)150 2163 y(In)k(Chapters)h(2)f(and)g(3,)g
(w)o(e)g(sa)o(w)g(ho)o(w)g(MetaML)h(is)f(a)g(promising)e(framew)o(ork)g
(for)i(meta-programm)o(i)o(ng)d(in)150 2238 y(general,)j(and)g(for)f
(staging)h(in)f(particular.)g(W)m(e)h(sa)o(w)g(ho)o(w)g(staging)f(allo)
o(ws)g(us)h(to)g(distribute)h(the)f(cost)h(of)e(a)150
2312 y(computation)d(o)o(v)o(er)i(more)e(than)i(one)g(stage)g(of)f
(computation.)f(This)h(goal)g(w)o(as)g(ac)o(hiev)o(ed)h(in)f(the)i
(case)f(of)f(the)150 2387 y(term-rewriting)h(example,)g(and)h(in)g(the)
h(case)g(of)e(other,)i(more)e(concise)i(examples)e(suc)o(h)i(as)g(the)g
(p)q(o)o(w)o(er)f(and)150 2462 y(mem)o(b)q(er)c(functions.)h(Our)g(exp)
q(erience)j(with)d(programmi)o(ng)d(in)j(MetaML)h(help)q(ed)g(us)g
(recognize)g(m)o(ulti-stage)150 2536 y(computation)e(as)i(a)g(simple,)e
(natural,)h(and)g(clear)i(computational)c(phenomenon:)176
2653 y FG({)21 b FI(It)14 b(is)f(simple)g(b)q(ecause)i(it)f(requires)h
(only)e(three)i(annotations)e(to)h(explain.)1004 2795
y(146)p eop
%%Page: 147 158
147 157 bop 1862 0 a FB(147)176 192 y FG({)21 b FI(It)15
b(is)h(natural)f(b)q(ecause)i(it)e(app)q(ears)i(to)e(b)q(e)h(distinct)g
(from)e(translation,)g(another)i(imp)q(ortan)o(t)e(computa-)221
266 y(tional)9 b(phenomenon)h(that)g(w)o(e)h(ha)o(v)o(e)g(describ)q(ed)
h(in)e(in)o(tro)q(duction)h(to)f(this)h(dissertation.)f(It)h(is)f(also)
g(natural)221 341 y(b)q(ecause)15 b(it)f(applies,)f(at)h(least)g(in)f
(principle,)g(to)h(b)q(oth)g(CBV)g(and)g(CBN)h(ev)n(aluation)d
(strategies.)176 416 y FG({)21 b FI(It)14 b(is)f(clear)i(b)q(ecause)g
(it)f(can)g(b)q(e)g(easily)g(describ)q(ed)h(and)f(demonstrated)g(with)g
(mathematical)c(rigor.)150 532 y(But)j(while)f(w)o(e)h(emphasize)g(the)
g(promise)f(that)g(m)o(ulti-stage)f(programmi)o(ng)f(exhibits,)i(w)o(e)
h(also)f(caution)g(that,)150 607 y(at)j(least)h(in)f(its)h(curren)o(t)h
(incarnation,)e(m)o(ulti-stage)e(programming)f(has)k(some)f(limitatio)o
(ns.)e(Most)j(notably)m(,)150 681 y(the)e(term-rewriting)e(example)g
(needed)i(to)f(b)q(e)h(rewritten)g(in)f(CPS)g(in)g(order)g(to)g(allo)o
(w)f(for)g(b)q(etter)j(staging.)d(A)o(t)150 756 y(this)17
b(p)q(oin)o(t,)f(the)h(question)g(of)g(whether)h(the)f(CPS)g
(transformation)e(can)i(b)q(e)h(a)o(v)o(oided)e(or)h(not)f(is)h(still)f
(op)q(en.)150 831 y(\(See)f(Section)f(8.4.\))150 914
y(In)g(Chapter)g(4,)g(w)o(e)g(sa)o(w)g(that)g(a)f(direct)i(approac)o(h)
f(to)g(extending)g(a)f(simple)g(in)o(terpreter)j(for)d(a)h(CBV)g(lam)o
(b)q(da)150 989 y(calculus)g(to)f(a)h(m)o(ulti-lev)o(el)c(language)j
(suc)o(h)i(as)e(MetaML)h(can)g(b)q(e)g(di\016cult.)f(On)h(one)g(hand,)f
(this)g(di\016cult)o(y)g(is)150 1063 y(surprising,)e(b)q(ecause)i
(these)g(simple)d(in)o(terpreters)k(can)e(b)q(e)g(extended)h(to)e
(incorp)q(orate)h(p)q(o)o(w)o(erful)f(and)g(seman)o(ti-)150
1138 y(cally)g(complex)g(features)i(suc)o(h)g(as)g(side)f(e\013ects)i
(and)e(exceptions.)h(On)g(the)f(other)h(hand,)f(suc)o(h)h(di\016cult)o
(y)e(is)h(not)150 1213 y(surprising,)h(b)q(ecause)i(the)f(essen)o(tial)
g(\\tric)o(k")f(b)q(ehind)h(these)h(in)o(terpreters)g(is)f(that)f(they)
h(are)g(rei\014ers:)g FH(R)n(ei\014ers)150 1287 y FI(tak)o(e)k(ob)r
(ject-lev)o(el)f(concepts)j(and)d(map)f(them)g(directly)i(to)g
(meta-lev)o(el)e(concepts.)i(F)m(or)f(example,)f(in)o(tegers)150
1362 y(are)d(mapp)q(ed)f(to)h(in)o(tegers,)g(lam)o(b)q(da-abstractions)
e(are)i(mapp)q(ed)f(to)g(lam)o(b)q(da-abstractions,)f(applications)h
(are)150 1437 y(mapp)q(ed)j(to)h(applications,)e(conditionals)h(to)g
(conditionals,)g(and)g(recursion)i(to)f(recursion.)h(Multi-lev)o(el)d
(fea-)150 1512 y(tures)h(of)f(ob)r(ject-programs,)f(suc)o(h)i(as)f
(Brac)o(k)o(ets,)h(Escap)q(es,)g(and)f(Run,)g(cannot)g(b)q(e)h(in)o
(terpreted)g(naturally)e(in)150 1586 y(this)h(\\rei\014er")g(st)o(yle)h
(b)q(ecause)g(this)f(st)o(yle)h(can)f(only)f(w)o(ork)h(when)g(the)h
(feature)f(w)o(e)g(wish)g(to)g(in)o(terpret)h(already)150
1661 y(has)f(a)g(coun)o(terpart)h(in)e(the)i(meta-language.)c(This)j
(prerequisite)h(is)f(not)g(satis\014ed)g(for)g(m)o(ulti-lev)o(el)d
(features.)150 1744 y(In)i(Chapter)i(5,)d(w)o(e)i(presen)o(ted)i(a)d
(deterministic)g(seman)o(tics)g(that)g(is)h(more)e(suitable)h(for)h
(formally)c(sp)q(ecifying)150 1819 y(the)17 b(seman)o(tics)f(of)g
(MetaML.)g(W)m(e)h(sho)o(w)o(ed)f(ho)o(w)h(a)f(formal)e(t)o(yp)q
(e-safet)o(y)j(prop)q(ert)o(y)g(can)g(b)q(e)g(established)g(for)150
1893 y(a)g(subset)h(of)e(MetaML)h(that)g(w)o(e)g(called)g
FF(\025)p FI(-M.)g(W)m(e)f(then)i(p)q(oin)o(ted)e(out)h(an)g
(expressivit)o(y)h(limitati)o(on)c(in)i(the)150 1968
y(basic)c(t)o(yp)q(e)g(system)f(for)h(MetaML,)f(and)h(presen)o(ted)h(a)
f(prop)q(osal)f(that)h(a)o(v)o(oids)e(this)i(problem.)e(W)m(e)h(argued)
h(that)150 2043 y(this)j(prop)q(osal)f(for)g(an)g(extended)i(MetaML)f
(is)f(a)g(b)q(etter)i(matc)o(h)e(for)g(a)g(m)o(ulti-stage)e
(programming)f(metho)q(d.)150 2118 y(Ho)o(w)o(ev)o(er,)j(our)g(curren)o
(t)h(practical)f(exp)q(erience)i(with)e(this)f(prop)q(osed)i(language)e
(is)h(still)f(limited.)150 2201 y(In)g(Chapter)h(6,)e(w)o(e)h(studied)h
(the)f(reduction)h(seman)o(tics)f(for)f(a)h(subset)i(of)d(MetaML)h
(that)g(w)o(e)h(called)e FF(\025)p FI(-U,)h(and)150 2275
y(sa)o(w)h(that)h(it)f(is)g(hard)h(to)f(limit)e FF(\014)17
b FI(reduction)e(to)g(lev)o(el)f(0)g(in)g(MetaML,)g(that)h(is,)f(it)g
(is)g(hard)h(to)f(stop)h(seman)o(tic)150 2350 y(equalit)o(y)h(at)g(the)
h(meta-lev)o(el)e(from)g(\\leaking")g(in)o(to)h(the)h(ob)r(ject-lev)o
(el.)f(The)h(alternativ)o(e)g(in)o(terpretation)g(of)150
2425 y(our)c(observ)n(ations)g(is)g(that)g(it)g(is)f(more)g(natural)h
(to)g(allo)o(w)e(seman)o(tic)h(equalit)o(y)g(at)h(all)f(lev)o(els)h(in)
g(MetaML.)g(The)150 2500 y(essen)o(tial)k(reason)g(is)f(that)g(the)h
(lev)o(el)f(of)f(a)h(ra)o(w)g(MetaML)h(terms)f(is)g(not)g(\\lo)q(cal")f
(information)f(that)i(can)g(b)q(e)150 2574 y(determined)c(just)g(b)o(y)
f(lo)q(oking)f(at)i(the)g(term.)f(Rather,)g(the)i(lev)o(el)e(of)g(a)h
(term)f(is)h(determined)f(from)f(the)j(con)o(text.)150
2649 y(Because)18 b(of)e(substitution)h(\(in)f(general\))h(and)f
(cross-stage)i(p)q(ersistence)h(\(in)e(particular\),)e(w)o(e)i(are)g
(forced)g(to)p eop
%%Page: 148 159
148 158 bop 1862 0 a FB(148)150 192 y FI(allo)o(w)10
b FF(\014)k FI(to)e(\\leak")f(in)o(to)g(higher)h(lev)o(els.)f(This)h
(\\leak)n(age")e(of)h(the)i FF(\014)r FI(-rule)f(could)g(b)q(e)g(in)o
(terpreted)h(as)f(a)g(desirable)150 266 y(phenomenon)19
b(b)q(ecause)i(it)e(w)o(ould)f(allo)o(w)g(implemen)o(tatio)o(ns)f(of)i
(MetaML)h(to)f(p)q(erform)f(a)h(wider)h(range)g(of)150
341 y(seman)o(tics-preserving)g(optimizations)c(on)j(programs.)f(If)h
(w)o(e)g(accept)i(this)e(in)o(terpretation)g(and)g(therefore)150
416 y(accept)g(allo)o(wing)c FF(\014)20 b FI(at)d(all)f(lev)o(els,)h(w)
o(e)h(need)g(to)f(b)q(e)h(careful)g(ab)q(out)f(in)o(tro)q(ducing)g(in)o
(tensional)g(analysis.)f(In)150 490 y(particular,)c(the)g(direct)i
(\(deterministic\))e(w)o(a)o(y)f(of)h(in)o(tro)q(ducing)g(in)o
(tensional)f(analysis)h(on)g(co)q(de)h(w)o(ould)e(lead)h(to)150
565 y(an)i(incoheren)o(t)h(reduction)f(seman)o(tics)g(and)f(equational)
g(theories.)150 724 y FD(8.2)56 b(Summary)16 b(of)j(Results)150
857 y FI(W)m(e)13 b(summarize)f(the)j(k)o(ey)f(results)h(as)f(follo)o
(ws:)168 981 y(1.)20 b(Programmi)o(ng:)d(By)k(staging)f(a)g(n)o(um)o(b)
q(er)f(of)h(programs)f(in)h(MetaML,)h(w)o(e)f(illustrated)h(the)g(p)q
(oten)o(tial)221 1056 y(of)c(m)o(ulti-stage)g(programmi)o(ng,)e(and)j
(p)q(oin)o(ted)g(out)h(some)e(w)o(eaknesses)j(of)e(the)h(approac)o(h.)f
(Staging)f(in)221 1130 y(MetaML)h(is)g(a)g(promising)e(and)i(in)o
(tuitiv)o(e)f(pro)q(cess.)j(The)e(main)e(w)o(eakness)j(w)o(e)g(iden)o
(ti\014ed)f(is)g(that)g(the)221 1205 y(term-rewriting)13
b(example)f(had)i(to)g(b)q(e)g(rewritten)h(in)f(CPS)g(so)g(that)g(b)q
(etter)h(staging)e(w)o(as)h(ac)o(hiev)o(ed.)168 1280
y(2.)20 b(Implemen)o(tatio)o(n:)15 b(W)m(e)i(iden)o(ti\014ed)h(a)g(v)n
(ariet)o(y)f(of)g(anomalies)f(in)h(the)h(implemen)o(tation,)c(and)k
(suggested)221 1355 y(corrections)d(to)f(man)o(y)f(of)g(them.)g(The)i
(main)d(example)h(presen)o(ted)j(in)e(this)g(dissertation)h(w)o(as)f
(the)h(\015a)o(w)o(ed)221 1429 y(treatmen)o(t)e(of)h(hidden)g(free-v)n
(ariables,)f(to)h(whic)o(h)f(w)o(e)i(prop)q(osed)f(a)g(solution)f
(using)h(the)g(idea)g(of)f(a)h(co)o(v)o(er.)168 1504
y(3.)20 b(Seman)o(tics:)15 b(In)i(order)h(to)f(understand)h(ho)o(w)e(w)
o(e)i(can)f(ensure)h(the)g(safet)o(y)f(of)f(generated)i(programs,)e(w)o
(e)221 1579 y(ha)o(v)o(e)c(studied)i(the)f(formal)e(seman)o(tics)h(of)g
(MetaML)i(in)e(man)o(y)f(st)o(yles.)i(The)g(t)o(w)o(o)g(form)o
(ulations)d(presen)o(ted)221 1654 y(in)16 b(this)g(dissertation)h(w)o
(ere)g(the)g(reduction)h(and)e(big-step)h(seman)o(tics.)e(The)i
(reduction)g(seman)o(tics)f(and)221 1728 y(the)e(pro)q(ofs)f(of)g(its)g
(con\015uence)j(and)d(soundness)i(\(in)e(the)h(CBN)g(case\))h(are)f(no)
o(v)o(el,)e(indep)q(enden)o(t)j(tec)o(hnical)221 1803
y(results.)168 1878 y(4.)20 b(T)o(yp)q(e)e(System:)g(W)m(e)g(iden)o
(ti\014ed)h(v)n(arious)e(w)o(a)o(ys)h(in)g(whic)o(h)h(\\m)o(ulti-stage)
d(programs)h(go)h FF(W)6 b(r)q(ong)q FI(,")18 b(and)221
1952 y(dev)o(elop)q(ed)e(examples)f(that)h(demonstrated)g(that)g(some)f
(t)o(yp)q(e)i(systems)f(w)o(ere)h(to)q(o)e(w)o(eak)h(or)g(to)q(o)g
(strong)221 2027 y(for)d(MetaML.)168 2102 y(5.)20 b(Meta-Programming)o
(:)14 b(W)m(e)j(iden)o(ti\014ed)g(coherence)i(\(and)e(in)g(turn,)g
(con\015uence\))i(as)e(a)g(prop)q(ert)o(y)h(that)f(is)221
2177 y(violated)c(b)o(y)h(trying)f(to)h(ha)o(v)o(e)g(seman)o(tic)f
(equalit)o(y)h(\()p FF(\014)r FI(\))h(and)e(in)o(tensional)h
(\(structural\))h(analysis)e(on)h(co)q(de)221 2251 y(in)f(MetaML.)150
2410 y FD(8.3)56 b(Appraisal)19 b(of)f(Results)150 2543
y FI(Our)c(thesis)f(is)g(that)g(MetaML)g(is)g(a)g(w)o(ell-designed)g
(language)f(that)h(is)g(useful)g(in)f(dev)o(eloping)g(meta-programs)150
2617 y(and)i(program)e(generators.)j(W)m(e)e(brok)o(e)h(do)o(wn)g(the)g
(thesis)h(in)o(to)e(three)i(main)d(h)o(yp)q(otheses:)p
eop
%%Page: 149 160
149 159 bop 1862 0 a FB(149)113 192 y FI(H1.)44 b FH(MetaML)15
b(is)f(a)h(useful)g(me)n(dium)f(for)g(meta-pr)n(o)n(gr)n(amming.)f
FI(In)h(Chapter)g(2,)f(w)o(e)h(ha)o(v)o(e)f(explained)h(the)g(idea)221
266 y(of)e(staging,)g(and)h(ho)o(w)g(it)g(is)g(easy)g(to)g(see)i(that)e
(it)g(can)g(reduce)i(cost)f(in)f(the)g(abstract)i(setting)e(of)g(the)g
(CBV)221 341 y(and)e(CBN)i(lam)o(b)q(da)c(calculus.)j(W)m(e)g(ha)o(v)o
(e)f(giv)o(en)h(small)d(example)i(applications)g(in)g(Chapter)i(3)f
(and)f(a)h(more)221 416 y(substan)o(tial)h(example)g(in)g(Chapter)i(4.)
113 487 y(H2.)44 b FH(MetaML)11 b(c)n(an)h(b)n(e)f(plac)n(e)n(d)g(on)h
(a)f(standar)n(d,)g(formal)f(foundation)i(wher)n(eby)f(staging)g
(annotations)i(ar)n(e)d(viewe)n(d)221 561 y(as)j(language)i(c)n
(onstructs)f(amenable)g(to)g(the)f(formal)g(te)n(chniques)i(of)e(pr)n
(o)n(gr)n(amming)g(languages.)h FI(In)e(Chap-)221 636
y(ters)17 b(5)f(w)o(e)h(presen)o(ted)i(a)d(big-step)g(seman)o(tics)g
(for)g(a)g(core)i(subset)g(of)d(MetaML,)i(together)g(with)f(a)g(t)o(yp)
q(e)221 711 y(system.)g(In)h(Chapter)g(6)g(w)o(e)g(presen)o(ted)i(a)d
(reduction)i(seman)o(tics)e(for)h(this)g(core)g(subset)i(and)d(pro)o(v)
o(ed)h(it)221 785 y(con\015uen)o(t)d(and)g(sound)g(in)g(the)g(CBN)g
(case.)113 856 y(H3.)44 b FH(MetaML)11 b(in)g(p)n(articular,)f(and)i
(multi-level)d(languages)j(in)f(gener)n(al,)g(c)n(an)g(b)n(e)g(impr)n
(ove)n(d)g(b)n(oth)g(in)g(their)g(design)221 931 y(and)20
b(implementation)g(by)g(what)g(we)g(have)g(le)n(arne)n(d)g(while)f
(building)h(MetaML's)g(formal)f(foundations.)221 1006
y FI(In)h(Chapter)h(4)g(w)o(e)f(ha)o(v)o(e)h(iden)o(ti\014ed)f(subtle)h
(and)g(previously)f(unkno)o(wn)g(problems)g(that)g(can)h(riddle)221
1081 y(implem)o(en)o(tations)16 b(of)i(m)o(ulti-stage)e(languages.)h
(Iden)o(tifying)h(man)o(y)e(of)i(these)i(problems)e(w)o(as)g(a)g
(direct)221 1155 y(consequence)i(of)d(studying)g(the)h(formal)d(seman)o
(tics)j(of)f(MetaML.)g(In)h(Chapter)g(5,)f(w)o(e)h(ha)o(v)o(e)f(prop)q
(osed)221 1230 y(adding)e(an)h(explicit)g(t)o(yp)q(e)g(constructor)i
(for)e(expressing)i(closedness)g(in)d(MetaML,)i(and)f(argued)g(for)g
(its)221 1305 y(utilit)o(y)g(in)i(supp)q(orting)g(m)o(ulti-stage)e
(programming)f(in)i(MetaML.)h(In)g(Chapter)h(6,)e(w)o(e)i(explained)e
(the)221 1379 y(p)q(oten)o(tially)d(negativ)o(e)h(e\013ects)i(of)d
(adding)h(deterministic)f(in)o(tensional)h(analysis)f(in)h(a)g(direct)h
(manner)e(to)221 1454 y(MetaML.)150 1587 y FG(8.3.1)48
b(Limitati)o(ons)13 b(F)l(uture)h(W)l(orks)150 1688 y
FI(The)g(w)o(ork)g(presen)o(ted)i(in)d(this)h(dissertation)h(can)f(b)q
(e)g(impro)o(v)o(ed)e(in)i(a)f(n)o(um)o(b)q(er)h(of)f(w)o(a)o(ys:)168
1785 y(1.)20 b(F)m(ormal)10 b(relations)i(should)g(b)q(e)i(established)
f(b)q(et)o(w)o(een)h(the)f(v)n(arious)f(form)o(ulations)e(of)i(the)h
(seman)o(tics.)f(The)221 1860 y(reduction)j(seman)o(tics)f(should)g(b)q
(e)h(also)f(sho)o(wn)h(to)f(resp)q(ect)j(the)e(big-step)g(seman)o(tics)
f(in)g(the)h(CBV)g(case,)221 1934 y(as)f(w)o(e)g(ha)o(v)o(e)f(done)i
(for)e(the)i(CBN)f(case.)168 2005 y(2.)20 b(The)c(implemen)o(tation)d
(should)k(b)q(e)g(v)n(alidated)e(with)h(resp)q(ect)j(to)d(one)h(of)e
(the)i(abstract)h(form)o(ulations)c(of)221 2080 y(the)h(seman)o(tics.)f
(A)g(go)q(o)q(d)h(candidate)g(seems)g(to)f(b)q(e)h(the)h(big-step)f
(seman)o(tics,)e(b)q(ecause)k(it)d(is)h(the)g(closest)221
2155 y(to)e(the)i(implemen)o(tati)o(on.)168 2225 y(3.)20
b(The)13 b(prop)q(osed)h(extension)f(to)g(MetaML)h(should)e(b)q(e)i
(incorp)q(orated)f(in)o(to)g(the)g(implemen)o(tation,)c(and)k(this)221
2300 y(implem)o(en)o(tation)h(should)i(b)q(e)i(used)f(to)g(dev)o(elop)g
(more)f(substan)o(tial)g(examples)g(than)h(the)g(one)g(w)o(e)g(ha)o(v)o
(e)221 2375 y(presen)o(ted)e(in)e(this)h(dissertation.)f(It)h(will)e(b)
q(e)i(imp)q(ortan)o(t)e(to)h(understand)i(the)f(practical)g
(implications)d(of)221 2450 y(the)j(extensions)h(that)f(w)o(e)g(ha)o(v)
o(e)g(prop)q(osed,)g(esp)q(ecially)g(from)e(the)j(programmer's)c(p)q
(oin)o(t)j(of)f(view.)168 2521 y(4.)20 b(The)10 b(sub)r(ject)i
(reduction)g(and)e(t)o(yp)q(e-safet)o(y)h(results)g(should)g(b)q(e)g
(extended)h(to)e(a)g(Hindley-Milner)g(p)q(olymor-)221
2595 y(phic)i(t)o(yp)q(e)h(system,)f(and)g(the)h(decidabilit)o(y)e(of)h
(the)h(t)o(yp)q(e)g(system)f(in)g(the)h(ligh)o(t)e(of)h(the)h(curren)o
(t)h(extensions)221 2670 y(should)f(b)q(e)i(v)o(eri\014ed.)p
eop
%%Page: 150 161
150 160 bop 1862 0 a FB(150)168 192 y FI(5.)20 b(The)d(relationship)g
(b)q(et)o(w)o(een)i(m)o(ulti-stage)d(programmi)o(ng)f(partial)h(ev)n
(aluation)g(concepts)j(suc)o(h)g(as)e(self-)221 266 y(application)11
b(and)h(the)h(F)m(utam)o(ura)e(pro)r(jections)i([40])e(has)i(not)f(b)q
(een)i(addressed)g(in)e(this)h(dissertation,)f(and)221
341 y(remains)g(as)i(future)h(w)o(ork.)150 494 y FD(8.4)56
b(Op)r(en)18 b(Problems)f(and)i(Promising)e(Researc)n(h)h(Directions)
150 622 y FI(The)f(w)o(ork)f(presen)o(ted)i(in)e(this)g(dissertation)g
(has)h(directed)g(our)g(atten)o(tion)f(to)g(man)o(y)e(imp)q(ortan)o(t)g
(questions)150 696 y(relating)20 b(to)g(m)o(ulti-stage)e(computation)g
(in)i(general,)g(and)g(MetaML)g(in)g(particular.)g(Here)h(is)f(the)h
(list)f(of)150 771 y(questions)14 b(that)g(w)o(e)h(see)g(as)f
(signi\014can)o(t:)168 881 y(1.)20 b FH(Can)c(we)g(make)g(the)g(close)n
(dness)h(annotations)g(implicit)e(in)h(the)g(terms)f(of)h(the)g(pr)n(o)
n(gr)n(amming)g(language?)221 955 y FI(In)d(particular,)f(the)i(term)e
(language)h(of)f FF(\025)886 940 y FE(BN)959 955 y FI(is)h(v)o(erb)q
(ose,)g(and)g(has)h(lost)e(some)h(of)f(the)i(simplicit)o(y)d(of)h(core)
221 1030 y(MetaML,)g(whic)o(h)h(had)g(only)f(three)i(constructs)h(for)e
(staging.)f(In)h FF(\025)1285 1015 y FE(BN)1344 1030
y FI(,)f(asserting)i(that)f(a)g(co)q(de)g(fragmen)o(t)221
1105 y(is)i(closed)g(\(using)h([)p 528 1105 13 2 v 14
w(]\))f(has)g(b)q(ecome)g(part)h(of)e(the)i(resp)q(onsibilities)g(of)e
(the)i(programmer.)d(It)i(remains)f(an)221 1180 y(op)q(en)i(question)g
(whether)i(there)f(exists)g(a)e(statically)h(t)o(yp)q(ed)g(language)f
(with)h(the)h(expressivit)o(y)f(of)g FF(\025)1861 1165
y FE(BN)221 1254 y FI(y)o(et)e(needs)h(only)e(three)i(additional)d
(constructs)k(to)e(realize)g(staging.)168 1328 y(2.)20
b FH(Can)g(we)h(avoid)g(the)f(ne)n(e)n(d)h(for)f(r)n(ewriting)f(pr)n(o)
n(gr)n(ams)h(in)h(CPS)g(b)n(efor)n(e)f(staging?)25 b
FI(The)c(term-rewriting)221 1402 y(example)11 b(in)g(Chapter)i(3)f(sho)
o(ws)h(that)f(further)i(optimizations)c(on)i(the)h(generated)g(co)q(de)
g(can)g(b)q(e)g(useful.)f(It)221 1477 y(ma)o(y)h(b)q(e)j(p)q(ossible,)f
(through)g(the)h(use)g(of)f(an)g FF(\021)972 1483 y Ft(v)992
1477 y FI(-lik)o(e)f(reduction,)i(to)f(pro)q(duce)h(optimal)d(results)j
(without)221 1552 y(ha)o(ving)g(the)j(user)f(rewrite)h(the)f(program)f
(in)g(CPS.)g(Bondorf)h(has)g(studied)g(impro)o(ving)d(binding)i(times)
221 1627 y(without)c(resorting)g(to)h(explicit)f(CPS)g(con)o(v)o
(ersion)h([9].)e(The)h(w)o(ork)g(of)g(Sabry)h(and)f(W)m(adler)f
(suggests)j(that)221 1701 y(the)f(use)h(of)e(Moggi's)g
FF(\025)589 1707 y Ft(c)620 1701 y FI(ma)o(y)f(also)h(b)q(e)h(relev)n
(an)o(t)g(to)g(dealing)f(with)h(this)f(problem)g([76].)168
1775 y(3.)20 b FH(Can)c(MetaML)h(b)n(e)g(c)n(ompile)n(d)f(using)h(the)f
(tr)n(aditional)g(functional)h(pr)n(o)n(gr)n(amming)f(language)h(c)n
(ompilation)221 1849 y(te)n(chniques?)25 b FI(Compiling)17
b(MetaML)k(requires)g(staging)e(its)h(seman)o(tics,)g(and)f(will)g(rev)
o(eal)h(new)h(design)221 1924 y(options)e(that)i(need)g(to)f(b)q(e)h
(pursued)h(and)e(understo)q(o)q(d.)h(Mo)q(del-theoretic)g(in)o
(terpretation)g(functions)221 1999 y(seem)12 b(to)h(ha)o(v)o(e)g(pro)o
(vided)g(a)g(go)q(o)q(d)g(starting)g(p)q(oin)o(t)f(for)h(suc)o(h)h
(researc)o(h)h(in)e(the)g(past,)g(and)g(w)o(e)g(b)q(eliev)o(e)h(that)
221 2074 y(this)g(will)e(also)h(b)q(e)i(the)f(case)h(for)f(MetaML.)221
2147 y(F)m(urthermore,)j(b)o(y)h(exp)q(osing)h(the)g(Safe-run)f
(constan)o(t)h(to)f(programmers,)e(they)j(will)d(ev)o(en)o(tually)i(ha)
o(v)o(e)221 2222 y(new)c(demands)f(for)h(con)o(trolling)f(the)h(b)q
(eha)o(vior)g(of)f(this)h(new)h(op)q(eration,)e(and)h(will)f(therefore)
i(p)q(ose)g(more)221 2296 y(in)o(teresting)i(questions)g(for)f(the)h
(dev)o(elop)q(ers)h(of)e(compilers)g(supp)q(orting)h(this)f(construct.)
i(Safe-run)f(is)f(a)221 2371 y(w)o(a)o(y)9 b(for)h(the)h(user)g(to)f
(\\app)q(eal)g(to)g(the)h(higher)f(p)q(o)o(w)o(er)h(of)e(the)i
(compiler)e(dev)o(elop)q(er)i(and)f(to)g(a)o(v)o(oid)f(meddling)221
2446 y(with)k(the)i(complex)d(and)i(fragile)f(implemen)o(tatio)o(n)e
(details,")i(and)h(the)h(user)g(will)d(necessary)k(b)q(e)f(pic)o(ky)e
(in)221 2521 y(sp)q(ecifying)f(what)g(he)h(is)f(asking)g(for:)f(A)i
(ligh)o(t-w)o(eigh)o(t)d(compilation)g(phase)j(that)f(pro)q(duces)i
(mac)o(hine)d(co)q(de)221 2595 y(quic)o(kly)m(,)e(or)i(a)g(hea)o(vy-w)o
(eigh)o(t)g(phase)h(that)f(tak)o(es)h(longer)f(but)h(pro)q(duces)g
(more)f(e\016cien)o(t)g(co)q(de?)h(Compiling)221 2670
y(for)h(memory)e(or)j(for)g(sp)q(eed?)p eop
%%Page: 151 162
151 161 bop 1862 0 a FB(151)168 192 y FI(4.)20 b FH(Is)d(ther)n(e)f(a)h
(mo)n(dular)g(way)g(for)g(supp)n(orting)g(a)g(heter)n(o)n(gene)n(ous)h
(meta-pr)n(o)n(gr)n(amming)e(language)i(b)n(ase)n(d)f(on)221
266 y(MetaML?)h FI(By)12 b(fo)q(cusing)g(on)g(the)h(staging)e(asp)q
(ect)j(of)d(meta-programm)o(ing)o(,)e(this)j(dissertation)h(presen)o
(ted)221 341 y(a)f(n)o(um)o(b)q(er)f(of)h(concrete)i(solutions)e(to)g
(fundamen)o(tal)e(problems)h(in)h(staging.)f(Ho)o(w)o(ev)o(er,)h(as)h
(w)o(e)f(men)o(tioned)221 416 y(in)j(the)i(in)o(tro)q(duction,)e
(another)i(imp)q(ortan)o(t)d(application)h(for)h(meta-programm)o(i)o
(ng)d(is)j(translation.)f(W)m(e)221 490 y(b)q(eliev)o(e)i(that)g(our)g
(w)o(ork)g(can)g(b)q(e)h(extended)g(in)f(a)f(fairly)g(natural)h(w)o(a)o
(y)f(to)h(allo)o(w)e(the)j(manipulation)c(of)221 565
y(m)o(ultiple)i(di\013eren)o(t)k(ob)r(ject-languages)g(at)f(the)g(same)
g(time.)e(In)i(particular,)g(w)o(e)g(can)g(index)g(the)h(co)q(de)221
640 y(t)o(yp)q(e)c(b)o(y)g(the)h(name)e(of)h(a)g(language,)f(for)h
(whic)o(h)g(there)i(is)e(an)g(asso)q(ciated)h(syn)o(tax,)f(and)g(sp)q
(ecial)h(t)o(yping)221 715 y(rules.)d(Suc)o(h)g(a)g(sc)o(heme)g(is)g
(implicit)d(in)i(the)i(meta-language)d(used)j(b)o(y)e(Jones)i(\(see)g
(for)f(example)f([40]\))f(for)221 789 y(describing)i(partial)f(ev)n
(aluation.)221 864 y(W)m(e)g(b)q(eliev)o(e)h(that)g(suc)o(h)g(a)g
(framew)o(ork)e(ma)o(y)g(ev)o(en)j(b)q(e)f(appropriate)g(for)f(dealing)
g(run-time)g(co)q(de)h(genera-)221 939 y(tion.)9 b(Run-time)g(co)q(de)i
(generation)f(is)h(concerned)h(with)e(the)h(e\016cien)o(t)g(generation)
f(of)g(sp)q(ecialized)h(mac)o(hine)221 1013 y(co)q(de)j(at)e(run-time.)
g(While)g(a)h(compiled)f(implem)o(en)o(tation)e(of)j(MetaML)g(can)h
(pro)o(vide)f(a)f(v)o(ersion)i(of)e(Safe-)221 1088 y(run)17
b(that)g(generates)i(mac)o(hine)d(co)q(de,)h(it)g(is)g(implicitly)d
(assumed)i(to)h(b)q(e)h(making)c(calls)j(to)g(a)g(compiler,)221
1163 y(whic)o(h)f(is)g(generally)g(not)g(considered)i(fast)e(enough)h
(for)f(run-time)f(co)q(de)i(generation.)f(If)g(mac)o(hine)f(co)q(de)221
1238 y(is)j(considered)i(as)e(a)h(t)o(yp)q(ed)g(language,)e(w)o(e)h(b)q
(eliev)o(e)h(that)g(it)f(can)h(b)q(e)g(incorp)q(orated)g(in)o(to)f(a)g
(Heteroge-)221 1312 y(neous)e(MetaML)h(setting.)f(With)f(the)i(ongoing)
e(researc)o(h)j(e\013orts)f(on)f(t)o(yp)q(ed)h(assem)o(bly)e
(languages,)g(this)221 1387 y(p)q(ossibilit)o(y)d(is)i(not)g(far-fetc)o
(hed.)168 1462 y(5.)20 b FH(A)o(r)n(e)c(ther)n(e)h(pr)n(actic)n(al,)f
(sound)i(typ)n(e)f(systems)g(for)f(expr)n(essing)h(tag-less)g(r)n
(ei\014ers?)f FI(In)g(Chapter)h(4,)e(w)o(e)i(ex-)221
1536 y(plained)11 b(the)h(subtleties)h(in)e(implemen)o(ting)d(a)k
(language)f(lik)o(e)f(MetaML)j(in)e(the)h(con)o(text)h(of)e(an)g(in)o
(terpreter)221 1611 y(that)g(w)o(e)h(ha)o(v)o(e)f(describ)q(ed)j(as)d
(\\essen)o(tially)g(a)h(rei\014er".)f(Suc)o(h)h(in)o(terpreters)i(can)e
(b)q(e)g(of)f(great)h(utilit)o(y)e(if)g(they)221 1686
y(are)15 b(staged,)g(b)q(ecause)i(they)f(then)g(are)f(total)g(maps)e
(from)h(ob)r(ject-programs)g(to)h(meta-programs.)e(If)h(the)221
1761 y(meta-language)g(has)j(a)f(compiled)f(implemen)o(tation,)e
(rei\014ers)18 b(pro)o(vide)e(us)h(with)f(a)h(v)o(ery)g(simple)e(means)
221 1835 y(for)g(implemen)o(ting)d(compilers)j(for)g(man)o(y)f
(languages)h(that)h(are)g(\\similar")d(to)j(\(in)f(the)h(sense)i(that)d
(they)221 1910 y(are)g(syn)o(tactically)f(sugared)i(subsets)h(of)s(\))d
(the)i(meta-language.)c(Ho)o(w)o(ev)o(er,)j(one)g(problem)f(remains:)g
(The)221 1985 y(in)o(terpreters)g(presen)o(ted)g(in)e(Chapter)g(4)g(do)
g(not)g(map)e(ob)r(ject-programs)i(to)g(meta-programs,)d(but)j(rather)
221 2060 y(to)g(a)h(datat)o(yp)q(e)g(carrying)f(meta-programs.)e(The)j
(tags)g(in)g(this)f(datat)o(yp)q(e)h(in)o(tro)q(duce)h(a)e(lev)o(el)h
(of)f(run-time)221 2134 y(o)o(v)o(erhead)f(that)f(is)h(not)g(necessary)
h(if)e(the)i(ob)r(ject-program)e(is)g(w)o(ell-t)o(yp)q(ed.)g(While)g
(it)g(is)h(curren)o(tly)h(p)q(ossible)221 2209 y(to)j(express)j(a)e
(tag-less)g(rei\014er)g(in)g(un)o(t)o(yp)q(ed)g(MetaML,)g(it)g(is)f
(not)h(t)o(ypable)g(in)f(MetaML's)h(t)o(yp)q(e)h(system.)221
2284 y(The)h(problem)e(of)h(\014nding)g(an)h(appropriate)f(t)o(yp)q(e)i
(system)e(that)h(w)o(ould)f(allo)o(w)f(us)i(to)f(express)j(tag-less)221
2358 y(rei\014ers)15 b(remains)e(op)q(en.)168 2433 y(6.)20
b FH(A)o(r)n(e)15 b(ther)n(e)g(pr)n(actic)n(al,)g(the)n(or)n(etic)n(al)
r(ly)g(sound)i(appr)n(o)n(aches)g(for)f(al)r(lowing)f(the)h(pr)n(o)n
(gr)n(amer)f(to)h(sp)n(e)n(cify)g(opti-)221 2508 y(mizations)g(on)i
(MetaML)g(c)n(o)n(de?)k FI(W)m(e)15 b(ha)o(v)o(e)h(p)q(oin)o(ted)h(out)
f(there)h(there)h(is)e(a)g(con\015ict)h(b)q(et)o(w)o(een)g(allo)o(wing)
221 2583 y(optimizations)c(on)j(ob)r(ject-co)q(de)h(and)f(in)o
(tensional)f(analysis.)g(But)h(there)h(is)f(no)g(ob)o(vious)f(problem)f
(with)p eop
%%Page: 152 163
152 162 bop 1862 0 a FB(152)221 192 y FI(asso)q(ciating)10
b FH(domain-sp)n(e)n(ci\014c)j(optimization)i FI(to)10
b(sp)q(eci\014c)j(instances)f(of)f(the)h(co)q(de)g(datat)o(yp)q(e.)e
(The)i(seman-)221 266 y(tics)g(of)f(suc)o(h)i(a)e(datat)o(yp)q(e)h(w)o
(ould)f(then)i(b)q(e)f(de\014ned)h(mo)q(dulo)d(the)i(optimizations,)d
(and)j(the)g(optimizations)221 341 y(themselv)o(es)h(can)h(b)q(e)g
(applied)f(b)o(y)g(the)i(compiler)d(non-deterministically)m(.)e(F)m
(urthermore,)j(with)h(practical,)221 416 y(statically)j(v)o
(eri\014able)h(metho)q(ds)h(for)f(establishing)g(con\015uence)i(of)e(a)
g(set)i(of)d(rewrite)j(rules,)f(it)f(ma)o(y)e(b)q(e)221
490 y(p)q(ossible)e(to)f(further)i(simplify)c(the)k(seman)o(tics)e(of)g
(suc)o(h)i(a)f FH(domain-sp)n(e)n(ci\014c)h(c)n(o)n(de)h(typ)n(e)s
FI(.)p eop
%%Page: 153 164
153 163 bop 776 436 a FL(App)s(endix)32 b(A)289 662 y(A)h(Calculus)h
(with)e(Lev)m(el)j(Annotations)1099 859 y FC(Celery,)13
b(r)n(aw)1099 918 y(Develops)f(the)g(jaw,)1099 977 y(But)h(c)n(elery,)g
(stewe)n(d,)1099 1037 y(Is)h(mor)n(e)f(quietly)f(chewe)n(d.)1513
1129 y(Celery)p FB(,)f(Ogden)j(Nash)150 1309 y FI(This)i(app)q(endix)g
(presen)o(ts)i(an)d(alternativ)o(e)h(approac)o(h)g(to)g(the)g
(reduction)h(seman)o(tics)e(of)h(MetaML.)g(W)m(e)f(had)150
1384 y(explored)h(this)g(approac)o(h,)f(but)h(did)f(not)h(dev)o(elop)g
(it)f(fully)m(,)e(as)j(it)f(in)o(v)o(olv)o(es)g(a)g(substan)o(tially)g
(larger)h(calculus)150 1459 y(than)i(the)h(one)g(presen)o(ted)i(in)c
(Chapter)j(6.)d(This)h(app)q(endix)h(also)f(explains)g(in)g(more)f
(detail)h(ho)o(w)g(w)o(orking)150 1533 y(to)o(w)o(ards)12
b(a)g(Sub)r(ject)h(Reduction)f(lemma)d(as)k(our)f(guide)g(help)q(ed)g
(us)h(arriv)o(e)f(at)g(the)h(t)o(yp)q(e)f(system)g(for)g(MetaML.)150
1692 y FD(A.1)56 b(The)18 b Fm(\025)p FD(-T)h(Language)150
1825 y FI(T)m(o)13 b(a)o(v)o(oid)f(the)i(problems)f(discussed)i(at)f
(the)g(b)q(eginning)f(of)g(Chapter)i(6,)d(w)o(e)i(in)o(tro)q(duce)h
(Bubbles)p 1719 1786 44 2 v 1719 1837 2 52 v 1736 1825
13 2 v 1761 1837 2 52 v 1719 1839 44 2 v 71 w(in)o(to)e(our)150
1900 y(language)j(at)g(lev)o(els)h(higher)f(than)h(0)f(as)h(a)f(means)g
(of)g(explicitly)g(con)o(trolling)f(the)i(elimination)d(of)i(Escap)q
(es.)150 1974 y(F)m(urthermore,)e(w)o(e)g(build)g(on)g(the)h(simple)e
(observ)n(ation)h(that)g(the)h(set)g(of)f(expressions)i(and)e(the)h
(set)g(of)f(v)n(alues)150 2049 y(for)g(the)g FF(\025)g
FI(language)f(can)h(b)q(e)h(de\014ned)g(as)f(follo)o(ws:)855
2155 y FF(e)g Fy(2)d FF(E)j FI(:=)e FF(v)20 b Fy(j)e
FF(x)g Fy(j)g FF(e)7 b(e)855 2230 y(v)13 b Fy(2)e FF(V)21
b FI(:=)12 b FF(i)18 b Fy(j)g FF(\025x:e)150 2327 y FI(The)e(m)o(utual)
d(recursion)j(in)f(the)h(de\014nition)f(is)g(not)g(strictly)h
(necessary)h(|)e(as)g(w)o(e)g(ha)o(v)o(e)g(seen)i(in)e(Chapter)h(6,)150
2401 y(w)o(e)i(can)f(de\014ne)i(expressions)g(\014rst,)f(then)g(v)n
(alues)f(|)g(but)h(w)o(e)g(ha)o(v)o(e)f(also)g(found)g(that)h(the)g
(compactness)g(of)150 2476 y(this)c(de\014nition)f(can)h(pa)o(y-o\013)f
(when)h(w)o(e)g(extend)h(a)e(core)i(language)e FF(\025)h
FI(with)f(more)g(syn)o(tactic)h(constructs.)i(The)1004
2795 y(153)p eop
%%Page: 154 165
154 164 bop 1862 0 a FB(154)150 192 y FI(resulting)14
b(m)o(ulti-lev)o(el)d(calculus,)j(called)f FF(\025)p
FI(-T,)h(has)g(the)g(follo)o(wing)d(syn)o(tax:)333 298
y FF(e)352 282 y FA(0)412 298 y Fy(2)g FF(E)484 282 y
FA(0)544 298 y FI(:=)g FF(v)20 b Fy(j)e FF(x)693 282
y FA(0)730 298 y Fy(j)g FF(e)779 282 y FA(0)805 298 y
FF(e)824 282 y FA(0)861 298 y Fy(j)g(h)p FF(e)926 282
y FA(1)945 298 y Fy(i)h(j)f FE(run)12 b FF(e)1097 282
y FA(0)333 372 y FF(e)352 357 y Ft(n)p FA(+)412 372 y
Fy(2)f FF(E)484 357 y Ft(n)p FA(+)544 372 y FI(:=)p 599
332 71 2 v 599 385 2 53 v 25 w FF(e)632 357 y Ft(n)p
668 385 V 599 387 71 2 v 688 372 a Fy(j)18 b FF(i)732
357 y Ft(n)p FA(+)799 372 y Fy(j)g FF(x)853 357 y Ft(n)p
FA(+)919 372 y Fy(j)g FF(e)968 357 y Ft(n)p FA(+)1023
372 y FF(e)1042 357 y Ft(n)p FA(+)1109 372 y Fy(j)g FF(\025x:e)1218
357 y Ft(n)p FA(+)1284 372 y Fy(j)g(h)p FF(e)1349 357
y Ft(n)p FA(++)1423 372 y Fy(i)h(j)g FE(~)q FF(e)1530
357 y Ft(n)1571 372 y Fy(j)f FE(run)13 b FF(e)1689 357
y Ft(n)p FA(+)333 447 y FF(v)59 b Fy(2)11 b FF(V)69 b
FI(:=)11 b FF(i)613 432 y FA(0)651 447 y Fy(j)17 b FF(\025x:e)759
432 y FA(0)796 447 y Fy(j)h(h)p 842 401 67 2 v 842 459
2 59 v 15 w FF(e)876 432 y FA(0)p 907 459 V 842 461 67
2 v 909 447 a Fy(i)150 552 y FI(V)m(alues)g(are)g(either)h(lev)o(el)e
(0)h(in)o(tegers,)g(lam)o(b)q(da)d(terms,)i(or)h(co)q(de)h(fragmen)o
(ts.)d(Note)i(that)g(w)o(e)g(ha)o(v)o(e)g(further)150
627 y(sp)q(eci\014ed)d(that)f(the)g(co)q(de)g(fragmen)o(ts)f(m)o(ust)f
(b)q(e)j(Bubbles.)f(The)g(primary)e(role)h(of)g(Bubbles)i(is)e(to)h
(ensure)h(that)150 702 y(there)g(are)e(no)g(lev)o(el)g(1)h(Escap)q(es)h
(in)e(a)g(co)q(de)h(v)n(alue.)e(It)h(is)h(also)e(imp)q(ortan)o(t)g(to)h
(note)h(that)f(w)o(e)h(ha)o(v)o(e)f(no)o(w)g(re\014ned)150
776 y(our)g(notion)g(of)f(lev)o(el)h(to)g(tak)o(e)g(Bubbles)h(in)o(to)f
(accoun)o(t.)g(The)g(lev)o(el)g(of)g(a)g(term)f(is)h(the)h(n)o(um)o(b)q
(er)e(of)h(surrounding)150 851 y(Brac)o(k)o(ets,)h(less)g(surrounding)f
(Escap)q(es)i FH(and)g(Bubbles)p FI(.)e(In)o(tuitiv)o(ely)m(,)e(k)o
(eeping)i(trac)o(k)g(of)g(this)g(re\014ned)h(notion)f(of)150
926 y(lev)o(els)g(in)g(the)g(terms)g(will)f(allo)o(w)f(us)j(to)f
(deduce)h(the)g(exact)g(state)g(of)e(rebuilding)h(that)g(the)g(term)g
(has)g(reac)o(hed.)150 1001 y(\(W)m(e)h(illustrate)f(this)h(p)q(oin)o
(t)g(with)f(a)h(concrete)i(example)c(in)i(Section)g(A.1.5.\))150
1115 y FG(Remark)h(A.1.1)i(\(Notation\))h FH(We)g(wil)r(l)e(simply)h
(write)g FF(e)p FH(,)g FF(v)q FH(,)h FF(E)r FH(,)g FF(V)27
b FH(whenever)17 b(the)h(index)g(is)g(cle)n(ar)f(fr)n(om)150
1180 y(the)e(c)n(ontext.)150 1328 y FG(A.1.1)48 b(Notions)14
b(of)i(Reduction.)d(Or,)j(Calculating)d(with)i(Bubbles)150
1444 y FI(No)o(w)e(w)o(e)g(ha)o(v)o(e)h(enough)f(structure)i(in)e(the)h
(terms)f(to)g(direct)h(reduction)g(in)f(a)g(sensible)h(manner,)e(and)h
(without)150 1519 y(need)i(for)e(con)o(textual)h(information.)d(The)j
(three)h(basic)f(notions)g(of)f(reduction)i(for)e(the)i
FF(\025)p FI(-T)f(language)f(are:)779 1625 y(\()p FF(\025x:e)874
1610 y FA(0)874 1635 y(1)892 1625 y FI(\))7 b FF(e)934
1610 y FA(0)934 1635 y(2)968 1625 y Fy(\000)-7 b(!)1035
1631 y Fr(\014)1051 1638 y(T)1090 1625 y FF(e)1109 1610
y FA(0)1109 1635 y(1)1128 1625 y FI([)p FF(x)11 b FI(::=)g
FF(e)1261 1610 y FA(0)1261 1635 y(2)1280 1625 y FI(])833
1699 y FE(~)q Fy(h)p 871 1653 V 871 1712 2 59 v 14 w
FF(e)904 1684 y FA(0)p 936 1712 V 871 1714 67 2 v 937
1699 a Fy(i)h(\000)-6 b(!)1033 1705 y Fr(E)1054 1712
y(T)p 1090 1653 V 1090 1712 2 59 v 1104 1699 a FF(e)1123
1684 y FA(0)p 1155 1712 V 1090 1714 67 2 v 786 1774 a
FE(run)13 b Fy(h)p 871 1728 V 871 1787 2 59 v 14 w FF(e)904
1759 y FA(0)p 936 1787 V 871 1789 67 2 v 937 1774 a Fy(i)f(\000)-7
b(!)1032 1780 y Fr(R)1053 1787 y(T)p 1090 1728 V 1090
1787 2 59 v 1104 1774 a FF(e)1123 1759 y FA(0)p 1155
1787 V 1090 1789 67 2 v 150 1871 a FI(The)11 b FF(\014)255
1877 y Ft(T)292 1871 y FI(rule)f(is)h(essen)o(tially)f
FF(\014)j FI(restricted)f(to)f(lev)o(el)f(0,)f(but)i(with)f(an)g(extra)
h(precaution)g(tak)o(en)f(in)g(the)h(de\014nition)150
1946 y(of)g(substitution)g(to)h(preserv)o(e)h(lev)o(el-annotatedness)f
(when)g(the)g(v)n(ariable)f FF(x)g FI(app)q(ears)h(at)f(a)g(lev)o(el)g
(higher)h(than)f(0)150 2020 y(in)g(the)i(b)q(o)q(dy)f(of)f(the)i(lam)o
(b)q(da)c(term.)i(In)h(particular)g FF(e)997 2026 y FA(1)1016
2020 y FI([)p FF(x)f FI(::=)f FF(e)1148 2026 y FA(2)1167
2020 y FI(])i(denotes)h(a)f FH(sp)n(e)n(cial)f FI(notion)g(of)h
(substitution)1890 2005 y FA(1)1908 2020 y FI(:)p 150
2103 237 2 v 158 2130 a Fz(1)188 2146 y FB(In)k(the)g(treatmen)o(t)h
(of)e(this)i(c)o(hapter,)g(w)o(e)e(use)h(Barendregt's)h(con)o(v)o(en)o
(tion)h(for)e(free)g(and)g(b)q(ound)i(v)n(ariables)g([1].)d(In)188
2191 y(essence,)k(this)g(con)o(v)o(en)o(tion)h(states)e(that,)g(for)g
(an)o(y)h(set)f(of)g(terms)g(used)h(in)g(a)f(pro)q(of)g(or)g(a)g
(de\014nition,)j(all)e(b)q(ound)188 2237 y(v)n(ariables)d(are)d(c)o
(hosen)h(to)f(b)q(e)g(di\013eren)o(t)h(from)f(the)g(free)g(v)n
(ariables.)p eop
%%Page: 155 166
155 165 bop 1862 0 a FB(155)706 289 y FF(i)720 274 y
Ft(n)743 289 y FI([)p FF(x)11 b FI(::=)g FF(e)p FI(])23
b(=)12 b FF(i)969 274 y Ft(n)701 364 y FF(x)725 349 y
FA(0)743 364 y FI([)p FF(x)f FI(::=)g FF(e)p FI(])23
b(=)12 b FF(e)671 439 y(x)695 424 y Ft(n)p FA(+)743 439
y FI([)p FF(x)f FI(::=)g FF(e)p FI(])23 b(=)12 b(\()p
FF(x)995 424 y Ft(n)1017 439 y FI([)p FF(x)f FI(::=)g
FF(e)p FI(]\))1178 424 y FA(+)698 514 y FF(y)719 499
y Ft(n)743 514 y FI([)p FF(x)g FI(::=)g FF(e)p FI(])23
b(=)12 b FF(y)976 499 y Ft(n)1368 514 y FF(x)g Fy(6)p
FI(=)g FF(y)601 588 y FI(\()p FF(e)636 594 y FA(1)666
588 y FF(e)685 594 y FA(2)704 588 y FI(\))720 573 y Ft(n)743
588 y FI([)p FF(x)f FI(::=)g FF(e)p FI(])23 b(=)12 b
FF(e)974 594 y FA(1)992 588 y FI([)p FF(x)f FI(::=)g
FF(e)p FI(])h FF(e)1168 594 y FA(2)1186 588 y FI([)p
FF(x)f FI(::=)g FF(e)p FI(])615 663 y(\()p FF(\025y)q(:e)707
669 y FA(1)727 663 y FI(\)[)p FF(x)g FI(::=)g FF(e)p
FI(])23 b(=)12 b(\()p FF(\025z)r(:)p FI(\()p FF(e)1063
669 y FA(1)1082 663 y FI([)p FF(z)r(=y)q FI(][)p FF(x)e
FI(::=)h FF(e)p FI(]\)\))955 738 y FF(z)i Fy(62)e FF(F)6
b(V)j FI(\()p FF(e;)e(e)1165 744 y FA(1)1184 738 y FI(\))168
b FF(x)12 b Fy(6)p FI(=)g FF(y)673 813 y Fy(h)p FF(e)708
819 y FA(1)727 813 y Fy(i)p FI([)p FF(x)f FI(::=)g FF(e)p
FI(])23 b(=)12 b Fy(h)p FF(e)990 819 y FA(1)1009 813
y FI([)p FF(x)e FI(::=)h FF(e)p FI(])p Fy(i)683 887 y
FE(~)q FF(e)724 893 y FA(1)743 887 y FI([)p FF(x)g FI(::=)g
FF(e)p FI(])23 b(=)13 b FE(~)q FI(\()p FF(e)1013 893
y FA(1)1032 887 y FI([)p FF(x)d FI(::=)h FF(e)p FI(]\))604
962 y(\()p FE(run)i FF(e)708 968 y FA(1)727 962 y FI(\)[)p
FF(x)e FI(::=)g FF(e)p FI(])23 b(=)12 b FE(run)g FI(\()p
FF(e)1058 968 y FA(1)1077 962 y FI([)p FF(x)f FI(::=)g
FF(e)p FI(]\))p 693 1006 51 2 v 693 1049 2 43 v 707 1037
a FF(a)p 741 1049 V 693 1051 51 2 v 14 w FI([)p FF(x)g
FI(::=)g FF(e)p FI(])23 b(=)p 955 993 195 2 v 955 1060
2 67 v 26 w FF(a)p FI([)p FF(x)10 b FI(::=)h FF(e)p FI(])p
1148 1060 V 955 1062 195 2 v 150 1140 a(and)j(where)h(Promotion)p
559 1140 13 2 v 572 1125 a FA(+)611 1140 y FI(:)c FF(E)i
Fy(!)e FF(E)16 b FI(is)e(a)g(total)f(function)g(inductiv)o(ely)h(as)g
(follo)o(ws:)910 1246 y(\()p FF(i)940 1231 y Ft(n)964
1246 y FI(\))980 1225 y FA(+)1019 1246 y FI(=)e FF(i)1077
1231 y Ft(n)p FA(+)901 1321 y FI(\()p FF(x)941 1306 y
Ft(n)964 1321 y FI(\))980 1300 y FA(+)1019 1321 y FI(=)g
FF(x)1087 1306 y Ft(n)p FA(+)860 1395 y FI(\()p FF(e)895
1401 y FA(1)926 1395 y FF(e)945 1401 y FA(2)964 1395
y FI(\))980 1374 y FA(+)1019 1395 y FI(=)g FF(e)1082
1401 y FA(1)1101 1380 y(+)1140 1395 y FF(e)1159 1401
y FA(2)1178 1380 y(+)869 1470 y FI(\()p FF(\025x:e)p
FI(\))980 1449 y FA(+)1019 1470 y FI(=)g FF(\025x:e)1142
1455 y FA(+)928 1545 y Fy(h)p FF(e)p Fy(i)980 1524 y
FA(+)1019 1545 y FI(=)g Fy(h)p FF(e)1098 1530 y FA(+)1126
1545 y Fy(i)905 1620 y FI(\()q FE(~)q FF(e)p FI(\))980
1599 y FA(+)1019 1620 y FI(=)h FE(~)q FI(\()p FF(e)1121
1604 y FA(+)1149 1620 y FI(\))859 1694 y(\()p FE(run)g
FF(e)p FI(\))980 1673 y FA(+)1019 1694 y FI(=)f(\()p
FE(run)h FF(e)1167 1679 y FA(+)1194 1694 y FI(\))p 932
1739 48 2 v 932 1781 2 43 v 946 1769 a FF(e)p 978 1781
V 932 1783 48 2 v 980 1747 a FA(+)1019 1769 y FI(=)p
1063 1723 76 2 v 1063 1781 2 58 v 26 w FF(e)1096 1754
y FA(+)p 1136 1781 V 1063 1783 76 2 v 150 1866 a FI(Th)o(us)e(the)g
(only)f(non-standard)h(feature)h(of)e(this)g(de\014nition)h(of)f
(substitution)h(is)f(the)i(case)f(of)f(v)n(ariables)g(at)h(lev)o(els)
150 1941 y(higher)k(than)f(0.)g(This)h(case)g(arises)g(exactly)g(when)g
(a)f(cross-stage)j(p)q(ersisten)o(t)f(v)n(ariable)d(is)i(b)q(eing)f
(eliminated.)150 2015 y(F)m(or)20 b(example,)e(the)i(notion)f(of)h(lev)
o(el-annotatedness)h(still)e(allo)o(ws)f(terms)i(suc)o(h)h(as)f
FF(\025x:)p Fy(h)o FF(x)p Fy(i)p FI(.)g(W)m(e)f(c)o(hose)i(to)150
2090 y(use)14 b(the)h(non-standard)f(notion)e(of)h(substitution)h
(rather)h(than)e(using)h(more)e(sophisticated)j(w)o(ell-formedness)150
2165 y(conditions.)j(In)h(particular,)g(the)g(latter)h(approac)o(h)f(w)
o(ould)f(require)i(us)f(to)g(mak)o(e)f(cross-stage)i(p)q(ersistence)150
2239 y(explicit)f(in)f(the)i(language)f(rather)h(than)f(implicit,)d
(and)j(is)g(lik)o(ely)f(to)h(complicate)f(the)h(formal)e(treatmen)o(t)
150 2314 y(rather)e(than)f(to)f(simplify)e(it.)150 2462
y FG(A.1.2)48 b(Bubble)14 b(Reductions)150 2578 y FI(No)o(w)g(w)o(e)h
(come)f(to)g(the)i(main)c(feature)j(of)f(the)i FF(\025)p
FI(-T)e(calculus,)h(namely)m(,)c(the)16 b(use)f(of)f(a)g(set)i(of)e
(reduction)h(rules)150 2653 y(that)e(mimi)o(c)e(the)j(b)q(eha)o(vior)f
(of)f(the)i(\\rebuilding")e(functions.)h(These)h(reduction)g(rules)g
(start)g(at)f(the)g(lea)o(v)o(es)h(of)p eop
%%Page: 156 167
156 166 bop 1862 0 a FB(156)150 192 y FI(a)14 b(dela)o(y)o(ed)f(term,)g
(and)h(b)q(egin)g(propagating)e(a)i(Bubble)g(up)o(w)o(ards.)898
284 y FF(i)912 269 y Ft(n)p FA(+)983 284 y Fy(\000)-7
b(!)1050 290 y Fr(B)q Fq(1)1087 297 y Fr(T)p 1123 244
66 2 v 1123 297 2 53 v 1137 284 a FF(i)1151 269 y Ft(n)p
1187 297 V 1123 299 66 2 v 888 359 a FF(x)912 344 y Ft(n)p
FA(+)983 359 y Fy(\000)g(!)1050 365 y Fr(B)q Fq(2)1087
372 y Fr(T)p 1123 319 75 2 v 1123 371 2 53 v 1137 359
a FF(x)1161 344 y Ft(n)p 1196 371 V 1123 373 75 2 v 808
394 71 2 v 808 456 2 63 v 822 434 a FF(e)841 419 y Ft(n)841
444 y FA(1)p 877 456 V 808 458 71 2 v 890 394 V 890 456
2 63 v 904 434 a FF(e)923 419 y Ft(n)923 444 y FA(2)p
958 456 V 890 458 71 2 v 983 434 a Fy(\000)g(!)1050 440
y Fr(B)q Fq(3)1087 447 y Fr(T)p 1123 394 124 2 v 1123
456 2 63 v 1137 434 a FF(e)1156 419 y Ft(n)1156 444 y
FA(1)1191 434 y FF(e)1210 419 y Ft(n)1210 444 y FA(2)p
1245 456 V 1123 458 124 2 v 830 510 a FF(\025x:)p 890
470 71 2 v 890 523 2 53 v 14 w(e)923 495 y Ft(n)p 958
523 V 890 525 71 2 v 983 510 a Fy(\000)g(!)1050 516 y
Fr(B)q Fq(4)1087 523 y Fr(T)p 1123 469 130 2 v 1123 523
2 54 v 1137 510 a FF(\025x:e)1216 495 y Ft(n)p 1251 523
V 1123 525 130 2 v 832 585 a Fy(h)p 848 540 96 2 v 848
598 2 58 v 14 w FF(e)881 570 y Ft(n)p FA(+)p 942 598
V 848 600 96 2 v 944 585 a Fy(i)23 b(\000)-7 b(!)1050
591 y Fr(B)q Fq(5)1087 598 y Fr(T)p 1123 540 128 2 v
1123 608 2 69 v 1137 585 a Fy(h)p FF(e)1172 570 y Ft(n)p
FA(+)1221 585 y Fy(i)p 1249 608 V 1123 610 128 2 v 868
662 a FE(~)p 890 622 71 2 v 890 674 2 53 v 15 w FF(e)923
647 y Ft(n)p 958 674 V 890 676 71 2 v 983 662 a Fy(\000)g(!)1050
668 y Fr(B)q Fq(6)1087 675 y Fr(T)p 1123 621 94 2 v 1123
674 2 53 v 1138 662 a FE(~)q FF(e)1179 647 y Ft(n)p 1215
674 V 1123 676 94 2 v 821 737 a FE(run)p 890 697 71 2
v 890 749 2 53 v 27 w FF(e)923 722 y Ft(n)p 958 749 V
890 751 71 2 v 983 737 a Fy(\000)g(!)1050 743 y Fr(B)q
Fq(7)1087 750 y Fr(T)p 1123 697 139 2 v 1123 749 2 53
v 1137 737 a FE(run)13 b FF(e)1225 722 y Ft(n)p 1260
749 V 1123 751 139 2 v 150 820 a FI(In)o(tuitiv)o(ely)m(,)c(a)h(Bubble)
h(around)g(a)f(term)g(will)f(assert)j(that)f(it)f(is)h(\\free)g(of)f
(top-lev)o(el)g(escap)q(es".)i(The)f(k)o(ey)g(concept)150
895 y(is)f(that)f(a)h(dela)o(y)o(ed)f(term)g(free)i(of)e(top-lev)o(el)g
(escap)q(es)j(can)d(b)q(e)i(treated)g(as)e(a)h(normal)d(program)h(from)
g(the)j(previous)150 970 y(lev)o(el.)h(Note)h(further)g(that)g(Bubble)g
(reductions)g(\\generate")h(a)e(Bubble)h(surrounding)g(the)g(whole)f
(term)g(either)150 1044 y(from)k(a)h(lev)o(el)h(annotation)e(\(in)h
(the)i(case)f(of)f(in)o(tegers)i(and)e(v)n(ariables\))g(or)h(from)e
(Bubbles)i(surrounding)g(all)150 1119 y(subterms.)13
b(If)h(w)o(e)g(can)g(mak)o(e)e(a)h(term)g(generate)i(enough)f
(surrounding)g(Bubbles)g(so)g(that)g(what)f(is)h(left)f(of)g(the)150
1194 y(term)g(reac)o(hes)j(lev)o(el)d(0,)g FF(\014)k
FI(at)d(lev)o(el)f(0)h(b)q(ecomes)g(applicable)f(to)h(what)f(is)h(left)
g(of)f(the)i(term.)150 1331 y FG(A.1.3)48 b(Deriving)13
b(a)j(T)o(yp)q(e)g(Rule)e(for)h(Bubble)f(and)h(Run)150
1436 y FI(The)g(question)g(no)o(w)f(is)g(whether)i(w)o(e)f(can)f(syn)o
(thesis)i(the)f(t)o(yp)q(e)g(system)g(for)f(the)h(language)e(describ)q
(ed)k(ab)q(o)o(v)o(e,)150 1511 y(and)d(whether)h(there)g(is)f(an)o(y)f
(systematic)h(w)o(a)o(y)f(of)g(approac)o(hing)h(this)f(question.)150
1594 y(Starting)f(from)f(the)i(t)o(yp)q(e)g(system)g(for)f(Brac)o(k)o
(ets)i(and)e(Escap)q(es,)i(w)o(e)f(will)e(explain)h(ho)o(w)g(one)h(can)
f(arriv)o(e)h(at)f(the)150 1669 y(extra)j(rules)h(for)e(Bubble)h(and)g
(Run)f(b)o(y)h(analysing)e(the)j(reduction)f(rules.)g(The)g(t)o(yp)q(e)
h(system)e(is)h(a)f(judgmen)o(t)150 1744 y FF(\000)20
b Fy(`)221 1728 y Ft(n)259 1744 y FF(e)c FI(:)f FF(\034)20
b FI(where)e FF(e)d Fy(2)g FF(E)592 1728 y Ft(n)614 1744
y FI(,)h FF(\034)k Fy(2)15 b FF(T)22 b FI(is)16 b(a)f(t)o(yp)q(e,)h
(and)g FF(\000)21 b Fy(2)14 b FF(D)k FI(is)e(an)g(en)o(vironmen)o(t,)e
(and)i(where)h(t)o(yp)q(es)g(and)150 1818 y(en)o(vironmen)o(ts)c(are)h
(de\014ned)h(as)f(follo)o(ws:)789 1903 y FF(\034)25 b
Fy(2)11 b FF(T)23 b FI(:=)11 b FF(b)19 b Fy(j)f FF(\034)1058
1909 y FA(1)1088 1903 y Fy(!)11 b FF(\034)1159 1909 y
FA(2)1196 1903 y Fy(j)18 b(h)p FF(\034)5 b Fy(i)789 1978
y FF(\000)17 b Fy(2)11 b FF(D)i FI(:=)e([])18 b Fy(j)11
b FF(x)g FI(:)g FF(\034)1119 1963 y Ft(i)1133 1978 y
FF(;)c(\000)150 2061 y FI(The)14 b(un)o(usual)g(thing)f(ab)q(out)g
(this)h(de\014nition)f(is)h(the)g(use)h(of)e(an)g(in)o(teger)h
FF(i)g FI(in)g(the)g(bindings)f(of)g(en)o(vironmen)o(ts.)150
2136 y(W)m(e)j(will)f(explain)h(ho)o(w)g(the)h(Bubble)g(reductions)h
(motiv)n(ate)c(this)j(particular)f(generalization.)f(W)m(e)i(will)e
(also)150 2211 y(need)e(t)o(w)o(o)f(simple)f(op)q(erations)h(on)g(en)o
(vironmen)o(ts,)f(namely)g FF(\000)1146 2196 y FA(+)1185
2211 y FI(and)h FF(\000)1296 2196 y Fs(\000)1323 2211
y FI(,)g(whic)o(h)g(incremen)o(t)g(and)g(decremen)o(t)150
2285 y(\(resp)q(ectiv)o(ely\))k(indices)e(on)g(all)e(bindings)i(in)f
FF(\000)6 b FI(.)150 2368 y(The)14 b(t)o(w)o(o)g(extra)g(rules)h(that)f
(are)g(needed)h(are)g(as)e(follo)o(ws:)685 2453 y FF(\000)717
2438 y Fs(\000)756 2453 y Fy(`)781 2438 y Ft(n)816 2453
y FF(e)f FI(:)f FF(\034)p 672 2482 233 2 v 672 2520 a(\000)17
b Fy(`)740 2508 y Ft(n)p FA(+)p 800 2490 48 2 v 800 2532
2 43 v 814 2520 a FF(e)p 846 2532 V 800 2534 48 2 v 26
w FI(:)11 b FF(\034)919 2492 y FI(Bubble)1110 2453 y
FF(\000)1142 2438 y FA(+)1181 2453 y Fy(`)1206 2438 y
Ft(n)1240 2453 y FF(e)h FI(:)f Fy(h)p FF(\034)5 b Fy(i)p
1106 2482 248 2 v 1106 2520 a FF(\000)17 b Fy(`)1174
2508 y Ft(n)1208 2520 y FE(run)c FF(e)f FI(:)f FF(\034)1367
2492 y FI(Run)150 2595 y(T)m(rying)i(to)h(pro)o(v)o(e)f(Sub)r(ject)i
(Reduction)f(for)g(the)g FF(\025)p FI(-T)g(language)f(pro)o(vides)h(us)
g(with)g(concrete)i(motiv)n(atio)o(n)11 b(for)150 2670
y(these)j(t)o(w)o(o)e(t)o(yping)g(rules.)h(A)f(Sub)r(ject)i(Reduction)e
(lemma)e(sa)o(ys)j(that)f(ev)o(ery)h(reduction)h(preserv)o(es)h(t)o
(ypabilit)o(y)m(.)p eop
%%Page: 157 168
157 167 bop 1862 0 a FB(157)150 192 y FI(In)13 b(other)i(w)o(ords,)e
(kno)o(wing)f FH(only)i FI(that)f(the)h(left-hand)g(side)f(of)g(a)g
(reduction)i(is)e(t)o(ypable,)g(w)o(e)g(m)o(ust)g(b)q(e)h(able)f(to)150
266 y(sho)o(w)f(that)g(the)h(righ)o(t-hand)f(side)g(of)g(the)h
(reduction)f(is)g(also)g(t)o(ypable.)f(In)i(what)f(follo)o(ws,)e(w)o(e)
i(will)f(explain)g(ho)o(w)150 341 y(this)j(\\pro)o(v)n(abilit)o(y")d
(prop)q(ert)o(y)k(help)q(ed)f(us)h(in)e(syn)o(thesising)h(the)h(t)o(w)o
(o)e(new)i(t)o(yp)q(e)f(rules.)150 424 y(Let)f(us)f(b)q(egin)g(with)g
(Bubble.)g(The)h(Bubble)f(reduction)h(for)f(v)n(ariables)f(is,)h(op)q
(erationally)m(,)e(aimed)g(at)i(capturing)150 499 y(the)k(fact)f(that)h
(this)f(v)n(ariable)f(is)i(free)g(of)f(Escap)q(es,)h(and)f(this)h(rule)
g(w)o(as)f(our)g(basis)h(for)f(dev)o(eloping)f(the)i(rules)150
573 y(for)f(the)h(un)o(t)o(yp)q(ed)g(language.)e(There)i(are)g(man)o(y)
d(reduction)j(rules)g(for)f(Bubble,)g(eac)o(h)h(a)f(p)q(oten)o(tial)g
(source)i(of)150 648 y(\(di\013eren)o(t\))f(insigh)o(ts)e(in)o(to)g
(what)g(the)h(t)o(yp)q(e)h(rule)e(for)h(Bubble)g(should)f(lo)q(ok)g
(lik)o(e.)f(It)i(is)f(crucial)g(when)i(lo)q(oking)150
723 y(for)c(insigh)o(ts)h(to)g(pic)o(k)f(the)i(simplest)e(rule)h(that)g
(will)e(suggest)j(the)f(most)f(concrete)j(constrain)o(t.)d(In)h(this)g
(case,)g(it)150 798 y(is)g(the)g(Bubble)h(rule)f(for)g(v)n(ariables.)f
(The)h(most)f(imp)q(ortan)o(t)f(feature)j(of)e(this)h(rule)g(is)g(that)
g(it)g(do)q(es)g(not)g(in)o(v)o(olv)o(e)150 872 y(Bubbles)j(on)f(its)g
(left-hand)g(side.)g(The)h(same)e(is)i(true)g(for)f(the)g(rule)h(for)f
(in)o(tegers,)g(but)h(the)g(rule)f(for)g(in)o(tegers)150
947 y(do)q(es)h(not)f(in)o(v)o(olv)o(e)f(an)o(y)h(\\use")h(of)f(the)g
(en)o(vironmen)o(t.)f(No)o(w,)h(let)g(us)h(consider)g(exactly)f(what)h
(information)c(is)150 1022 y(a)o(v)n(ailable)h(when)j(w)o(e)f(kno)o(w)g
(that)g(the)h(left)f(hand)g(side)h(of)f(the)g(Bubble)h(rule)g(for)f(v)n
(ariables)f(\(B-2\))i(is)f(t)o(ypable.)150 1096 y(In)h(other)g(w)o
(ords,)g(what)f(do)h(w)o(e)g(kno)o(w)f(when)h FF(\000)k
Fy(`)966 1081 y Ft(n)p FA(+)1029 1096 y FF(x)1053 1081
y Ft(n)p FA(+)1116 1096 y FI(:)14 b FF(\034)20 b FI(holds?)15
b(All)g(w)o(e)h(kno)o(w)f(is)h(that)g FF(\000)6 b FI(\()p
FF(x)p FI(\))14 b(=)h FF(\034)1861 1081 y Ft(n)p FA(+)1908
1096 y FI(.)150 1171 y(What)f(w)o(e)h(w)o(an)o(t)g(to)g(pro)o(v)o(e,)f
(in)g(general,)h(is)g(that)f(the)i(left-hand)e(side)h(is)g(t)o(ypable.)
f(More)h(precisely)m(,)g(w)o(e)g(w)o(an)o(t)150 1246
y(to)e(mak)o(e)f(sure)i(that)g(it)f(is)g(t)o(ypable)g(under)h(the)g
(same)e(en)o(vironmen)o(t,)g(at)h(the)h(same)e(lev)o(el,)h(and)g(with)g
(the)h(same)150 1321 y(t)o(yp)q(e.)g(In)f(other)h(w)o(ords,)g(w)o(e)f
(w)o(an)o(t)g(to)h(b)q(e)g(able)f(to)h(pro)o(v)o(e)f(that)h
FF(\000)j Fy(`)1220 1306 y Ft(n)p FA(+)p 1280 1281 75
2 v 1280 1333 2 53 v 1294 1321 a FF(x)1318 1306 y Ft(n)p
1353 1333 V 1280 1335 75 2 v 1366 1321 a FI(:)11 b FF(\034)5
b FI(.)13 b(W)m(e)g(w)o(an)o(t)g(to)g(\014nd)h(a)f FH(uniform)150
1395 y FI(w)o(a)o(y)i(of)f(inferring)h(this)h(result.)f(The)h(notion)f
(of)g(uniformit)o(y)d(here)17 b(is)e(hard)h(to)f(de\014ne,)h(but)f(let)
h(us)g(tak)o(e)f(it)g(to)150 1470 y(mean)e(\\a)g(simple)f(w)o(a)o(y".)h
(More)h(concretely)m(,)h(giv)o(en)e(the)h(follo)o(wing)e(sc)o(hema:)754
1558 y(?)f Fy(`)810 1543 y Ft(n)845 1558 y FF(x)g FI(:)g(?)p
720 1588 238 2 v 720 1626 a FF(\000)17 b Fy(`)788 1614
y Ft(n)p FA(+)p 848 1595 52 2 v 848 1638 2 43 v 862 1626
a FF(x)p 898 1638 V 848 1640 52 2 v 25 w FI(:)11 b FF(\034)971
1597 y FI(A)j(New)g(Rule)g(Sc)o(hema)o FF(:)150 1696
y FI(No)o(w)f(w)o(e)h(consider)g(the)g(follo)o(wing)d(question:)j(What)
f(are)h(the)g(simplest)e(transformations)g(\(on)i(en)o(vironmen)o(ts)
150 1770 y(and)j(t)o(yp)q(es\))i(that)f(w)o(ould)e(let)i(us)g
(\014ll-in)e(the)i(missing)e(parts,)i(that)f(w)o(ould)g(let)h(us)g
(succeed)i(in)d(pro)o(ving)f(the)150 1845 y(concrete)i(problem)c(of)i
(t)o(yp)q(e)g(preserv)n(ation)g(for)g(the)g(Bubble)h(reduction)f(for)g
(v)n(ariables?)f(Again,)f(w)o(e)i(already)150 1920 y(ha)o(v)o(e)d(a)g
(rule)g(for)g(v)n(ariables,)f(so,)h(w)o(e)g(follo)o(w)e(the)j(deriv)n
(ation)e(tree)i(\(sc)o(hema\))f(one)h(lev)o(el)e(up)h(using)g(the)h(v)n
(ariable)150 1995 y(rule,)g(to)f(get)i(a)e(simpler)g(equation:)813
2083 y(?\()p FF(x)p FI(\))e(=?)952 2068 y Ft(n)p 810
2112 169 2 v 810 2150 a FI(?)g Fy(`)866 2138 y Ft(n)900
2150 y FF(x)g FI(:)h(?)992 2122 y(V)m(ar)i(on)f(Sc)o(hema)150
2220 y(Recalling)e(that)h(what)h(w)o(e)f(kno)o(w)g(from)f(the)i
(left-hand)f(side)g(of)g(the)h(rule)g(is)f FF(\000)6
b FI(\()p FF(x)p FI(\))11 b(=)h FF(\034)1513 2205 y Ft(n)p
FA(+)1561 2220 y FI(,)f(w)o(e)i(see)h(that)e(w)o(e)h(can)150
2295 y(\014ll)h(in)h(the)h(sc)o(hema)e(?\()p FF(x)p FI(\))d(=?)618
2280 y Ft(n)656 2295 y FI(as)k FF(\000)740 2280 y Fs(\000)768
2295 y FI(\()p FF(x)p FI(\))c(=)h FF(\034)902 2280 y
Ft(n)924 2295 y FI(.)j(W)m(e)g(then)h(propagate)f(this)g(information)d
(bac)o(k)j(to)g(our)h(new)150 2370 y(rule)e(sc)o(hema,)f(to)h(get)g
(the)g(follo)o(wing)e(concrete)k(Bubble)e(rule:)724 2458
y FF(\000)756 2443 y Fs(\000)795 2458 y Fy(`)820 2443
y Ft(n)854 2458 y FF(x)e FI(:)f FF(\034)p 711 2487 238
2 v 711 2525 a(\000)17 b Fy(`)779 2513 y Ft(n)p FA(+)p
839 2495 52 2 v 839 2538 2 43 v 853 2525 a FF(x)p 889
2538 V 839 2540 52 2 v 26 w FI(:)11 b FF(\034)962 2497
y FI(Concrete)16 b(Bubble)e(Rule)150 2595 y(What)e(w)o(e)g(ha)o(v)o(e)h
(argued)f(so)h(far)e(is)i(that)f(if)f(this)i(rule)f(holds,)g(sub)r
(ject)i(reduction)f(w)o(ould)e(hold.)g(But)i(w)o(e)g(still)e(do)150
2670 y(not)j(ha)o(v)o(e)g(a)f(useful)h(rule,)g(b)q(ecause)i(this)e
(rule)g(is)g(only)f(for)h(v)n(ariables.)e(T)m(o)i(arriv)o(e)f(at)h(a)g
(useful)g(rule)g(candidate,)p eop
%%Page: 158 169
158 168 bop 1862 0 a FB(158)150 192 y FI(w)o(e)14 b(generalize)h(the)f
(o)q(ccurrence)j(of)c(the)i(v)n(ariable)d FF(x)i FI(to)g(an)f
(arbitrary)h(expression)h(to)f(get:)754 288 y FF(\000)786
273 y Fs(\000)825 288 y Fy(`)850 273 y Ft(n)885 288 y
FF(e)e FI(:)f FF(\034)p 741 317 233 2 v 741 355 a(\000)17
b Fy(`)809 343 y Ft(n)p FA(+)p 869 325 48 2 v 869 368
2 43 v 883 355 a FF(e)p 915 368 V 869 370 48 2 v 26 w
FI(:)11 b FF(\034)988 327 y FI(Bubble)k(\(T)m(en)o(tativ)o(e\))150
433 y(Again,)10 b(w)o(e)h(can)g(use)h(sub)r(ject-reduction)i(to)d(test)
h(the)f(v)n(alidit)o(y)e(of)i(this)g(more)f(general)i(rule.)e(Indeed,)i
(using)f(this)150 508 y(rule,)h(w)o(e)g(can)h(sho)o(w)f(that)g(all)f
(Bubble)h(reductions)i(preserv)o(e)g(t)o(yping)d(\(note)i(that)f(w)o(e)
g(cannot)g(do)g(that)h(for)e(Run)150 583 y(y)o(et,)i(b)q(ecause)h(w)o
(e)f(are)h(ignoring)d(the)i(presence)j(of)c(its)h(t)o(yp)q(e)g(rule)g
(for)g(no)o(w\).)f(This)h(progress)h(is)e(promising,)f(but)150
657 y(the)17 b(road)f(to)g(completely)f(justifying)g(this)i(rule)f
(still)g(requires)h(ensuring)g(that)g(it)e(preserv)o(es)k
(substitutivit)o(y)m(,)150 732 y(and)14 b(ev)o(en)o(tually)m(,)e(that)i
(w)o(e)g(do)g(ha)o(v)o(e)g(t)o(yp)q(e-safet)o(y)g(for)f(our)h
(language.)150 815 y(With)f(this)g(promising)e(Bubble)j(rule,)f(w)o(e)g
(can)h(use)g(either)g(of)e(the)i(t)o(w)o(o)f(rules)h(that)f(in)o(v)o
(olv)o(e)f(Run)h(and)g(Bubble,)150 890 y(w)o(e)h(infer)g(a)g(\\uniform)
d(sc)o(hema")i(for)h(Run)f(in)h(the)g(same)f(w)o(a)o(y)g(that)h(w)o(e)g
(ha)o(v)o(e)g(done)g(for)g(Bubble.)150 1030 y FG(A.1.4)48
b(Sub)s(ject)13 b(Reduction)150 1139 y FI(W)m(e)k(will)f(no)o(w)g
(consolidate)h(the)h(observ)n(ations)f(made)f(in)h(this)g(section)h(in)
o(to)f(a)g(formal)e(Sub)r(ject)j(Reduction)150 1213 y(lemma.)11
b(Figure)k(A.1)g(summarizes)e(the)i(language)f FF(\025)p
FI(-T)h(that)g(w)o(e)g(presen)o(t)i(and)d(study)i(in)e(this)h(section,)
g(with)150 1288 y(the)f(exception)h(of)e(the)i(length)o(y)f
(de\014nition)f(of)g(the)i(non-standard)f(notion)f(of)g(substitution)p
1641 1288 13 2 v 29 w([)p 1667 1288 V 26 w(::=)p 1761
1288 V 26 w(].)150 1371 y(The)20 b(follo)o(wing)d(lemma)g(tells)j(us)g
(that)g(an)o(y)f(term)g(t)o(ypable)g(at)h(one)g(lev)o(el)f(remains)g(t)
o(ypable)h(at)f(the)h(next)150 1446 y(lev)o(el.)c(F)m(urthermore,)g(w)o
(e)i(can)f(also)f(increase)i(\(b)o(y)f(one\))g(the)h(lev)o(el)f(of)f
(an)o(y)g(subset)j(of)d(the)i(v)n(ariables)e(in)g(the)150
1521 y(en)o(vironmen)o(t)d(under)i(whic)o(h)e(the)i(term)e(is)h(t)o
(ypable.)150 1626 y FG(Lemma)h(A.1.2)i(\(Promotion)o(\))g
FH(If)e FF(\000)795 1632 y FA(1)813 1626 y FF(;)7 b(\000)858
1632 y FA(2)887 1626 y Fy(`)912 1610 y Ft(n)947 1626
y FF(e)966 1632 y FA(1)996 1626 y FI(:)k FF(\034)1037
1632 y FA(1)1071 1626 y FH(then)k FF(\000)1189 1632 y
FA(1)1207 1626 y FF(;)7 b(\000)1258 1608 y FA(+)1252
1637 y(2)1296 1626 y Fy(`)1321 1610 y Ft(n)p FA(+)1381
1626 y FF(e)1400 1608 y FA(+)1400 1637 y(1)1440 1626
y FI(:)k FF(\034)1481 1632 y FA(1)1500 1626 y FH(.)150
1731 y FG(Lemma)k(A.1.3)i(\(Co-Promotion)o(\))h FH(If)c
FF(\000)869 1737 y FA(1)887 1731 y FF(;)7 b(\000)932
1737 y FA(2)962 1731 y Fy(`)987 1715 y Ft(n)1021 1731
y FF(e)1040 1737 y FA(1)1071 1731 y FI(:)k FF(\034)1112
1737 y FA(1)1145 1731 y FH(then)16 b FF(\000)1264 1737
y FA(1)1282 1731 y FF(;)7 b(\000)1333 1713 y Fs(\000)1327
1742 y FA(2)1371 1731 y Fy(`)1396 1715 y Ft(n)1431 1731
y FF(e)1450 1737 y FA(1)1480 1731 y FI(:)k FF(\034)1521
1737 y FA(1)1540 1731 y FH(.)150 1836 y FG(Lemma)k(A.1.4)i(\(Generali)o
(zed)c(Substitu)o(ti)o(on)o(\))18 b FH(If)e FF(\000)1101
1821 y Ft(i)1095 1846 y FA(1)1114 1836 y FF(;)7 b(\000)1165
1821 y Ft(i)1159 1846 y FA(2)1178 1836 y FI(;)g FF(x)14
b FI(:)g FF(\034)1284 1821 y Ft(i)1279 1846 y FA(2)1313
1836 y Fy(`)1338 1821 y Ft(n)1376 1836 y FF(e)1395 1842
y FA(1)1429 1836 y FI(:)h FF(\034)1474 1842 y FA(1)1509
1836 y FH(and)j FF(\000)1618 1842 y FA(2)1651 1836 y
Fy(`)1676 1821 y FA(0)1710 1836 y FF(e)1729 1842 y FA(2)1763
1836 y FI(:)c FF(\034)1807 1842 y FA(2)1843 1836 y FH(then)150
1900 y FF(\000)182 1885 y Ft(i)176 1911 y FA(1)195 1900
y FF(;)7 b(\000)246 1885 y Ft(i)240 1911 y FA(2)270 1900
y Fy(`)295 1885 y Ft(n)330 1900 y FF(e)349 1906 y FA(1)368
1900 y FI([)p FF(x)j FI(::=)h FF(e)500 1906 y FA(2)519
1900 y FI(])g(:)g FF(\034)583 1906 y FA(1)602 1900 y
FH(.)150 2005 y FG(Corollary)j(A.1.5)j(\(Substi)o(tu)o(ti)o(on\))g
FH(If)10 b FF(\000)869 2011 y FA(2)888 2005 y FI(;)d
FF(x)j FI(:)h FF(\034)987 1990 y FA(0)982 2016 y(2)1017
2005 y Fy(`)1042 1990 y FA(0)1073 2005 y FF(e)1092 2011
y FA(1)1122 2005 y FI(:)g FF(\034)1163 2011 y FA(1)1193
2005 y FH(and)g FF(\000)1295 2011 y FA(2)1325 2005 y
Fy(`)1350 1990 y FA(0)1380 2005 y FF(e)1399 2011 y FA(2)1430
2005 y FI(:)g FF(\034)1471 2011 y FA(2)1500 2005 y FH(then)g
FF(\000)1614 2011 y FA(2)1644 2005 y Fy(`)1669 1990 y
FA(0)1700 2005 y FF(e)1719 2011 y FA(1)1737 2005 y FI([)p
FF(x)g FI(::=)g FF(e)1870 2011 y FA(2)1889 2005 y FI(])g(:)150
2070 y FF(\034)168 2076 y FA(1)187 2070 y FH(.)150 2175
y FG(Theorem)k(A.1.6)h(\(Sub)s(ject)d(Reduction)g(for)i(CBN)i
FF(\025)p FG(-T\))j Fy(8)p FF(n)12 b Fy(2)f Fo(N)p FF(;)c(\000)14
b Fy(2)e FF(D)q(;)7 b(\034)16 b Fy(2)11 b FF(T)s(:)p
Fy(8)p FF(e)1648 2181 y FA(1)1667 2175 y FF(;)c(e)1705
2181 y FA(2)1735 2175 y Fy(2)12 b FF(E)1808 2160 y Ft(n)1830
2175 y FF(:)681 2272 y(\000)17 b Fy(`)749 2255 y Ft(n)783
2272 y FF(e)802 2278 y FA(1)832 2272 y FI(:)12 b FF(\034)i
Fy(^)9 b FF(e)944 2278 y FA(1)974 2272 y Fy(\000)-7 b(!)13
b FF(e)1073 2278 y FA(2)1104 2272 y FI(=)-7 b Fy(\))11
b FF(\000)17 b Fy(`)1250 2255 y Ft(n)1285 2272 y FF(e)1304
2278 y FA(2)1334 2272 y FI(:)11 b FF(\034)r(:)150 2412
y FG(A.1.5)48 b(T)l(o)o(w)o(ards)15 b(Con\015uence)150
2521 y FI(The)h(k)o(ey)g(observ)n(ation)f(to)h(b)q(e)g(made)f(ab)q(out)
h(the)g(new)g(calculus)g(is)g(that)g(the)g(promotion)e(p)q(erformed)h
(in)g(the)150 2595 y(substitution)h(do)q(es)g(not)f(injure)h
(con\015uence:)h(Bubbles)f(allo)o(w)e(us)i(to)f(reco)o(v)o(er)i
(con\015uence.)g(F)m(or)e(example,)f(let)150 2670 y(us)g(reconsider)i
(the)e(example)f(from)f(Section)i(6.6:)p eop
%%Page: 159 170
159 169 bop 1862 0 a FB(159)150 526 y FI(Syn)o(tax:)333
615 y FF(e)352 600 y FA(0)412 615 y Fy(2)11 b FF(E)484
600 y FA(0)544 615 y FI(:=)g FF(v)20 b Fy(j)e FF(x)693
600 y FA(0)730 615 y Fy(j)g FF(e)779 600 y FA(0)805 615
y FF(e)824 600 y FA(0)861 615 y Fy(j)g(h)p FF(e)926 600
y FA(1)945 615 y Fy(i)h(j)f FE(run)12 b FF(e)1097 600
y FA(0)333 672 y FF(e)352 657 y Ft(n)p FA(+)412 672 y
Fy(2)f FF(E)484 657 y Ft(n)p FA(+)544 672 y FI(:=)p 599
632 71 2 v 599 684 2 53 v 25 w FF(e)632 657 y Ft(n)p
668 684 V 599 686 71 2 v 688 672 a Fy(j)18 b FF(i)732
657 y Ft(n)p FA(+)799 672 y Fy(j)g FF(x)853 657 y Ft(n)p
FA(+)919 672 y Fy(j)g FF(e)968 657 y Ft(n)p FA(+)1023
672 y FF(e)1042 657 y Ft(n)p FA(+)1109 672 y Fy(j)g FF(\025x:e)1218
657 y Ft(n)p FA(+)1284 672 y Fy(j)g(h)p FF(e)1349 657
y Ft(n)p FA(++)1423 672 y Fy(i)h(j)g FE(~)q FF(e)1530
657 y Ft(n)1571 672 y Fy(j)f FE(run)13 b FF(e)1689 657
y Ft(n)p FA(+)333 734 y FF(v)59 b Fy(2)11 b FF(V)69 b
FI(:=)11 b FF(i)613 719 y FA(0)651 734 y Fy(j)17 b FF(\025x:e)759
719 y FA(0)796 734 y Fy(j)h(h)p 842 688 67 2 v 842 747
2 59 v 15 w FF(e)876 719 y FA(0)p 907 747 V 842 749 67
2 v 909 734 a Fy(i)150 824 y FI(Reductions:)771 904 y(\()p
FF(\025x:e)866 889 y FA(0)866 915 y(1)885 904 y FI(\))7
b FF(e)927 889 y FA(0)927 915 y(2)968 904 y Fy(\000)-7
b(!)1035 910 y Fr(\014)1051 917 y(T)1098 904 y FF(e)1117
889 y FA(0)1117 915 y(1)1136 904 y FI([)p FF(x)10 b FI(::=)h
FF(e)1268 889 y FA(0)1268 915 y(2)1287 904 y FI(])825
967 y FE(~)q Fy(h)p 864 921 V 864 980 2 59 v 15 w FF(e)897
952 y FA(0)p 928 980 V 864 982 67 2 v 930 967 a Fy(i)19
b(\000)-6 b(!)1033 973 y Fr(E)1054 980 y(T)p 1098 921
V 1098 980 2 59 v 1112 967 a FF(e)1131 952 y FA(0)p 1162
980 V 1098 982 67 2 v 779 1030 a FE(run)12 b Fy(h)p 864
984 V 864 1043 2 59 v 15 w FF(e)897 1015 y FA(0)p 928
1043 V 864 1045 67 2 v 930 1030 a Fy(i)19 b(\000)-7 b(!)1032
1036 y Fr(R)1053 1043 y(T)p 1098 984 V 1098 1043 2 59
v 1112 1030 a FF(e)1131 1015 y FA(0)p 1162 1043 V 1098
1045 67 2 v 872 1087 a FF(i)886 1072 y Ft(n)p FA(+)957
1087 y Fy(\000)h(!)1025 1093 y Fr(B)q Fq(1)1062 1100
y Fr(T)p 1098 1047 66 2 v 1098 1099 2 53 v 1112 1087
a FF(i)1126 1072 y Ft(n)p 1161 1099 V 1098 1101 66 2
v 863 1143 a FF(x)887 1128 y Ft(n)p FA(+)957 1143 y Fy(\000)g(!)1025
1149 y Fr(B)q Fq(2)1062 1156 y Fr(T)p 1098 1103 75 2
v 1098 1156 2 53 v 1112 1143 a FF(x)1136 1128 y Ft(n)p
1171 1156 V 1098 1158 75 2 v 782 1160 71 2 v 782 1223
2 63 v 797 1200 a FF(e)816 1185 y Ft(n)816 1210 y FA(1)p
851 1223 V 782 1225 71 2 v 864 1160 V 864 1223 2 63 v
878 1200 a FF(e)897 1185 y Ft(n)897 1210 y FA(2)p 933
1223 V 864 1225 71 2 v 957 1200 a Fy(\000)g(!)1025 1206
y Fr(B)q Fq(3)1062 1213 y Fr(T)p 1098 1160 124 2 v 1098
1223 2 63 v 1112 1200 a FF(e)1131 1185 y Ft(n)1131 1210
y FA(1)1165 1200 y FF(e)1184 1185 y Ft(n)1184 1210 y
FA(2)p 1220 1223 V 1098 1225 124 2 v 805 1267 a FF(\025x:)p
865 1227 71 2 v 865 1280 2 53 v 13 w(e)897 1252 y Ft(n)p
933 1280 V 865 1282 71 2 v 957 1267 a Fy(\000)g(!)1025
1273 y Fr(B)q Fq(4)1062 1280 y Fr(T)p 1098 1226 130 2
v 1098 1280 2 54 v 1112 1267 a FF(\025x:e)1191 1252 y
Ft(n)p 1226 1280 V 1098 1282 130 2 v 806 1329 a Fy(h)p
823 1284 96 2 v 823 1342 2 58 v 15 w FF(e)856 1314 y
Ft(n)p FA(+)p 917 1342 V 823 1344 96 2 v 918 1329 a Fy(i)23
b(\000)-6 b(!)1025 1335 y Fr(B)q Fq(5)1062 1342 y Fr(T)p
1098 1284 128 2 v 1098 1352 2 69 v 1112 1329 a Fy(h)p
FF(e)1147 1314 y Ft(n)p FA(+)1195 1329 y Fy(i)p 1224
1352 V 1098 1354 128 2 v 842 1396 a FE(~)p 864 1356 71
2 v 864 1409 2 53 v 15 w FF(e)897 1381 y Ft(n)p 933 1409
V 864 1411 71 2 v 957 1396 a Fy(\000)g(!)1025 1402 y
Fr(B)q Fq(6)1062 1409 y Fr(T)p 1098 1356 94 2 v 1098
1409 2 53 v 1113 1396 a FE(~)q FF(e)1154 1381 y Ft(n)p
1189 1409 V 1098 1411 94 2 v 796 1453 a FE(run)p 864
1413 71 2 v 864 1465 2 53 v 26 w FF(e)897 1438 y Ft(n)p
933 1465 V 864 1467 71 2 v 957 1453 a Fy(\000)g(!)1025
1459 y Fr(B)q Fq(7)1062 1466 y Fr(T)p 1098 1413 139 2
v 1098 1465 2 53 v 1112 1453 a FE(run)12 b FF(e)1199
1438 y Ft(n)p 1235 1465 V 1098 1467 139 2 v 150 1542
a FI(T)o(yp)q(es)j(and)e(T)o(yp)q(e)i(En)o(vironmen)o(ts:)789
1631 y FF(\034)25 b Fy(2)11 b FF(T)23 b FI(:=)11 b FF(b)19
b Fy(j)f FF(\034)1058 1637 y FA(1)1088 1631 y Fy(!)11
b FF(\034)1159 1637 y FA(2)1196 1631 y Fy(j)18 b(h)p
FF(\034)5 b Fy(i)789 1681 y FF(\000)17 b Fy(2)11 b FF(D)i
FI(:=)e([])18 b Fy(j)11 b FF(x)g FI(:)g FF(\034)1119
1666 y Ft(i)1133 1681 y FI(;)c FF(\000)150 1770 y FI(T)o(yp)q(e)14
b(Rules:)p 905 1880 198 2 v 905 1918 a FF(\000)j Fy(`)973
1906 y Ft(n)1008 1918 y FF(i)11 b FI(:)g FE(int)1117
1890 y FI(In)o(t)270 1996 y FF(\000)6 b FI(\()p FF(x)p
FI(\))k(=)i FF(\034)435 1981 y FA(\()p Ft(n)p Fs(\000)p
Ft(m)p FA(\))p 270 2017 270 2 v 313 2055 a FF(\000)k
Fy(`)380 2043 y Ft(n)415 2055 y FF(x)11 b FI(:)g FF(\034)553
2026 y FI(V)m(ar)688 1996 y FF(x)g FI(:)g FF(\034)769
1981 y Fs(0)781 1975 y Ft(n)803 1996 y FI(;)c FF(\000)17
b Fy(`)890 1981 y Ft(n)924 1996 y FF(e)12 b FI(:)f FF(\034)p
676 2017 338 2 v 676 2055 a(\000)17 b Fy(`)744 2043 y
Ft(n)778 2055 y FF(\025x:e)11 b FI(:)g FF(\034)914 2043
y Fs(0)937 2055 y Fy(!)h FF(\034)1027 2026 y FI(Lam)1167
1996 y FF(\000)k Fy(`)1234 1981 y Ft(n)1269 1996 y FF(e)1288
2002 y FA(2)1318 1996 y FI(:)11 b FF(\034)1364 1981 y
Fs(0)1417 1996 y FF(\000)17 b Fy(`)1485 1981 y Ft(n)1520
1996 y FF(e)1539 2002 y FA(1)1569 1996 y FI(:)11 b FF(\034)1615
1981 y Fs(0)1638 1996 y Fy(!)g FF(\034)p 1167 2017 548
2 v 1317 2055 a(\000)17 b Fy(`)1385 2043 y Ft(n)1419
2055 y FF(e)1438 2061 y FA(1)1469 2055 y FF(e)1488 2061
y FA(2)1518 2055 y FI(:)11 b FF(\034)1728 2026 y FI(App)293
2126 y FF(\000)16 b Fy(`)360 2111 y Ft(n)p FA(+)420 2126
y FF(e)c FI(:)f FF(\034)p 273 2148 244 2 v 273 2186 a(\000)17
b Fy(`)341 2174 y Ft(n)375 2186 y Fy(h)p FF(e)p Fy(i)12
b FI(:)g Fy(h)p FF(\034)5 b Fy(i)530 2157 y FI(Brk)664
2126 y FF(\000)17 b Fy(`)732 2111 y Ft(n)767 2126 y FF(e)11
b FI(:)h Fy(h)p FF(\034)5 b Fy(i)p 656 2148 228 2 v 656
2186 a FF(\000)17 b Fy(`)724 2174 y Ft(n)p FA(+)785 2186
y FE(~)q FF(e)12 b FI(:)f FF(\034)898 2157 y FI(Esc)1043
2124 y FF(\000)1075 2109 y Fs(\000)1114 2124 y Fy(`)1139
2109 y Ft(n)1174 2124 y FF(e)h FI(:)f FF(\034)p 1030
2146 233 2 v 1030 2184 a(\000)17 b Fy(`)1098 2172 y Ft(n)p
FA(+)p 1158 2153 48 2 v 1158 2196 2 43 v 1172 2184 a
FF(e)p 1204 2196 V 1158 2198 48 2 v 26 w FI(:)11 b FF(\034)1277
2155 y FI(Bubble)1468 2124 y FF(\000)1500 2109 y FA(+)1539
2124 y Fy(`)1564 2109 y Ft(n)1598 2124 y FF(e)h FI(:)f
Fy(h)p FF(\034)5 b Fy(i)p 1464 2146 248 2 v 1464 2184
a FF(\000)17 b Fy(`)1532 2172 y Ft(n)1566 2184 y FE(run)c
FF(e)f FI(:)f FF(\034)1725 2155 y FI(Run)469 2314 y FG(Fig.)c(A.1.)15
b FI(The)f(Reduction)g(Seman)o(tics)f(and)h(T)o(yp)q(e)g(System)f(for)h
FF(\025)p FI(-T)p eop
%%Page: 160 171
160 170 bop 1862 0 a FB(160)221 195 y FE(\(fn)14 b(x)g
Fy(\))f(h)p FE(x)408 180 y FA(1)427 195 y Fy(i)p FE(\))h(\(fn)g(y)g
Fy(\))f FE(\(fn)i(x)f Fy(\))f FE(x)797 180 y FA(0)816
195 y FE(\))h(5)867 180 y FA(0)885 195 y FE(\).)150 297
y FI(As)g(w)o(e)g(sa)o(w)g(b)q(efore,)g(if)f(w)o(e)i(p)q(erform)e(the)h
(outermost)g(redex)g(w)o(e)h(get:)221 403 y Fy(h)p FE(fn)f(y)g
Fy(\))f FE(\(fn)h(x)g Fy(\))f FE(x)544 388 y FA(1)563
403 y FE(\))h(5)614 388 y FA(1)633 403 y Fy(i)p FE(.)150
504 y FI(And)e(there)i(are)e(still)g(no)g FF(\014)570
510 y Ft(T)608 504 y FI(redices)i(left.)e(But)g(there)i
FH(ar)n(e)h FI(Bubble)d(reductions)i(that)e(allo)o(w)e(us)j(to)f
(\014rst)h(deriv)o(e:)221 610 y Fy(h)p FE(fn)h(y)g Fy(\))f
FE(\(fn)h(x)g Fy(\))p 525 564 66 2 v 525 623 2 59 v 28
w FE(x)559 595 y FA(0)p 590 623 V 525 625 66 2 v 591
610 a FE(\))p 621 564 68 2 v 621 623 2 59 v 29 w(5)657
595 y FA(0)p 687 623 V 621 625 68 2 v 689 610 a Fy(i)p
FE(.)150 712 y FI(then)221 818 y Fy(h)p FE(fn)g(y)g Fy(\))p
373 772 203 2 v 373 830 2 59 v 27 w FE(fn)g(x)g Fy(\))f
FE(x)542 803 y FA(0)p 574 830 V 373 832 203 2 v 589 772
68 2 v 589 830 2 59 v 603 818 a FE(5)624 803 y FA(0)p
655 830 V 589 832 68 2 v 657 818 a Fy(i)p FE(.)150 919
y FI(then)221 1025 y Fy(h)p FE(fn)h(y)g Fy(\))p 373 979
288 2 v 373 1048 2 70 v 27 w FE(\(fn)g(x)g Fy(\))g FE(x)559
1010 y FA(0)577 1025 y FE(\))g(5)628 1010 y FA(0)p 659
1048 V 373 1050 288 2 v 661 1025 a Fy(i)p FE(.)150 1127
y FI(reco)o(v)o(ering)g(the)h(desired)g FF(\014)583 1133
y Ft(T)623 1127 y FI(redex)g(whic)o(h)f(w)o(e)g(can)g(p)q(erform)f(to)h
(get:)221 1233 y Fy(h)p FE(fn)g(y)g Fy(\))p 373 1187
68 2 v 373 1245 2 59 v 27 w FE(5)408 1218 y FA(0)p 439
1245 V 373 1247 68 2 v 441 1233 a Fy(i)p FE(.)150 1334
y FI(F)m(urthermore,)f(b)q(oth)h(reduction)h(sequences)h(can)e(b)q(e)h
(reduced)h(to)d(the)i(common)c(term:)221 1440 y Fy(h)p
237 1394 204 2 v 237 1461 2 67 v 14 w FE(fn)j(y)g Fy(\))f
FE(5)408 1425 y FA(0)p 439 1461 V 237 1463 204 2 v 441
1440 a Fy(i)p FE(.)150 1542 y FI(The)h(follo)o(wing)c(lemma)h
(formalizes)g(the)j(claim)d(that)j(w)o(e)f(can)h(alw)o(a)o(ys)e(reco)o
(v)o(er)j(the)f(lev)o(el)f(0)g(redices)i(in)e(a)g(term)150
1616 y(ev)o(en)i(if)e(the)h(term)f(has)h(b)q(een)h(promoted)e(during)h
(a)f(substitution.)150 1731 y FG(Lemma)i(A.1.7)i(\(E\013erv)o
(escence\))h FF(e)800 1716 y FA(+)840 1731 y Fy(!)882
1716 y Fs(\003)p 912 1701 48 2 v 912 1743 2 43 v 926
1731 a FH(e)p 958 1743 V 912 1745 48 2 v 150 1855 a FI(Th)o(us,)e(ev)o
(en)h(though)f(this)g(prop)q(ert)o(y)i(w)o(as)e(not)g(our)g(goal,)f(w)o
(e)h(do)g(get)h(a)f(carefully)g(restricted)i(form)d(of)g
FF(\014)k FI(at)150 1930 y(lev)o(els)14 b(higher)g(than)g(0)f(in)h
FF(\025)p FI(-T.)150 2013 y(W)m(e)f(exp)q(ect)j(that)e(this)g(calculus)
g(is)f(con\015uen)o(t,)i(but)f(w)o(e)g(do)g(not)f(rep)q(ort)i(a)f
(formal)d(pro)q(of)j(of)f(suc)o(h)h(a)g(prop)q(ert)o(y)m(.)150
2088 y(W)m(e)19 b(do)g(rep)q(ort)h(a)f(formal)e(pro)q(of)i(of)g
(con\015uence)i(for)e(a)g(more)f(concise)i(calculus)g(that)f(w)o(e)h
(presen)o(t)h(in)d(the)150 2163 y(Section)c(6.7.)150
2310 y FG(A.1.6)48 b(Remark)16 b(on)f Fp(\025)p FG(-U)150
2427 y FI(Studying)10 b(the)h FF(\025)p FI(-T)f(language)f(has)h(allo)o
(w)o(ed)f(us)i(to)f(illustrate)g(ho)o(w)g(carefully)g(restricting)h
(reductions)g(can)g(yield)150 2501 y(a)j(promising)f(calculus)i(for)f
(MetaML.)h(But)g FF(\025)p FI(-T)g(has)f(a)h(large)f(n)o(um)o(b)q(er)g
(of)g(rules,)h(and)g(uses)g(a)g(non-standard)150 2576
y(notion)d(of)g(substitution.)g(Both)h(these)h(features)g(can)f(mak)o
(e)e(it,)g(at)i(least,)f(incon)o(v)o(enien)o(t)h(for)f(p)q(encil)h(and)
f(pap)q(er)150 2651 y(reasoning.)j(The)i FF(\025)p FI(-U)f(language)f
(has)h(a)g(smaller)e(set)j(of)e(reduction)i(rules,)f(and)g(uses)h(a)f
(standard)g(notion)g(of)p eop
%%Page: 161 172
161 171 bop 1862 0 a FB(161)150 192 y FI(substitution.)15
b(In)o(tuitiv)o(ely)m(,)f FF(\025)p FI(-U)i(mo)o(v)o(ed)e(the)i(burden)
g(of)g(recognizing)f(that)h(a)f(piece)i(of)e(co)q(de)h(is)g(free)g(of)f
(top)150 266 y(lev)o(el)d(Escap)q(es)i(from)d(the)i(ob)r(ject-language)
f(bac)o(k)g(to)h(the)f(meta-language:)e FF(\025)p FI(-T)j(trac)o(ks)g
(freedom)e(of)h(top)g(lev)o(el)150 341 y(Escap)q(es)k(using)e(Bubbles,)
h(and)g FF(\025)p FI(-U)f(trac)o(ks)h(freedom)f(of)g(top)g(lev)o(el)g
(Escap)q(e)i(b)o(y)f(testing)f(for)h(mem)o(b)q(ership)d(in)150
416 y(the)17 b(set)g FF(E)324 401 y FA(0)342 416 y FI(.)f(As)h(Bubbles)
f(w)o(ere)i(themselv)o(es)e(in)o(tro)q(duced)h(to)f(\\\014x")f(lev)o
(el)h(annotations,)f(whic)o(h)h(themselv)o(es)150 490
y(w)o(ere)g(an)g(ob)r(ject-lev)o(el)g(co)q(di\014cation)f(of)g(a)g
(meta-lev)o(el)f(concept,)i(w)o(e)g(ha)o(v)o(e)f(gone)h(full)e(circle:)
i(A)o(ttempting)e(to)150 565 y(exploit)g(one)h(meta-lev)o(el)e
(concept:)i(lev)o(els,)f(w)o(e)h(ha)o(v)o(e)f(iden)o(ti\014ed)h(a)f
(more)g(fundamen)o(tal)e(meta-lev)o(el)h(concept:)150
640 y(freedom)g(of)g(top-lev)o(el)h(Escap)q(es.)150 788
y FG(A.1.7)48 b(Remark)16 b(on)f(Lev)o(el)f(Annotations)150
904 y FI(It)g(should)g(b)q(e)g(noted)h(that)f(while)f(lev)o(el)h
(annotations)f(can)h(b)q(e)h(highly)e(illumi)o(nating,)d(they)15
b(suggest)f(that)h(it)e(is)150 979 y(appropriate)j(to)f(ha)o(v)o(e)h
(the)g(inside)f(of)g(lev)o(el)h FF(n)f FI(Brac)o(k)o(ets)i
FH(always)e FI(b)q(e)i(a)e(mem)o(b)q(er)f(of)h(a)g(set)i(of)e(v)n
(alues)g(of)g(lev)o(el)150 1053 y FF(n)p FI(+.)f(But)i(this)e(is)h(not)
f(generally)h(true.)g(In)f(fact,)h(lev)o(el)f(annotations)g(get)h(in)f
(the)h(w)o(a)o(y)f(of)g(unifying)g(the)h(set)h(of)150
1128 y(v)n(alues)e FF(V)307 1113 y FA(1)340 1128 y FI(with)f(the)i(set)
f(of)g(expression)h FF(E)851 1113 y FA(0)869 1128 y FI(,)f(whic)o(h)f
(is)h(an)g(imp)q(ortan)o(t)e(feature)j(of)e FF(\025)p
FI(-U.)150 1276 y FG(A.1.8)48 b(Remark)16 b(on)f(Big-Step)e(Seman)o
(tics,)h(Lev)o(el)g(Annotations)f(and)i(Bubbles)150 1392
y FI(The)d(determinism)d(of)h(the)i(big-step)f(seman)o(tics)g(seems)g
(to)g(alleviate)f(the)i(need)g(for)e(explicit)h(lev)o(el-annotations)
150 1467 y(and)h(the)g(Bubble)g(construct.)h(W)m(e)e(presen)o(ted)j
(the)f(big-step)e(seman)o(tics)h(for)f(the)h(to)o(y)g(language)f
FF(\025)p FI(-M)g(that)h(do)q(es)150 1541 y(not)j(ha)o(v)o(e)g
(explicit)f(lev)o(el-annotations)g(on)h(terms.)f(De\014ning)h(the)g
(big-step)g(seman)o(tics)g(for)g(a)f(language)g(with)150
1616 y(lev)o(el-annotations)9 b(\(suc)o(h)i(as)f FF(\025)p
FI(-T\))g(can)h(b)q(e)f(done)h(in)e(essen)o(tially)h(the)h(same)e(w)o
(a)o(y)m(,)g(but)h(w)o(ould)f(b)q(e)i(more)e(v)o(erb)q(ose.)150
1691 y(In)14 b(particular,)f(w)o(e)h(w)o(ould)f(ha)o(v)o(e)h(to)g
(explicitly)f(pass)h(around)g(the)g(lev)o(el-annotation)f(\\baggage".)
150 1774 y(De\014ning)j(the)i(big-step)f(seman)o(tics)f(for)g
FF(\025)p FI(-T)h(w)o(ould)f(require)h(adding)f(a)h(rule)g(that)g(sa)o
(ys)f(that)h(rebuilding)f(a)150 1849 y(Bubble)g(expression)g(is)f
(idemp)q(oten)o(t.)f(W)m(e)h(exp)q(ect)i(that)e(a)g(big-step)h(seman)o
(tics)f(with)f(explicit)h(Bubbles)h(will)150 1923 y(ha)o(v)o(e)g(sup)q
(erior)h(p)q(erformance)f(to)h(one)f(without)g(Bubbles,)h(b)q(ecause)h
(the)f(idemp)q(otence)f(rule)h(for)f(rebuilding)150 1998
y(Bubbles)f(w)o(ould)e(allo)o(w)f(us)i(to)g(a)o(v)o(oid)f(redundan)o(t)
h(rebuilding.)f(This)h(seman)o(tics)f(is)h(still)f(largely)g
(unexplored.)p eop
%%Page: 162 173
162 172 bop 764 436 a FL(Bibliograph)m(y)192 677 y FI([1])19
b Fa(Barendregt,)e(H.)g(P.)22 b FH(The)15 b(L)n(amb)n(da)i(Calculus:)e
(Its)g(Syntax)i(and)g(Semantics)p FI(,)e(revised)g(ed.)22
b(North-)256 752 y(Holland,)12 b(Amsterdam,)g(1984.)192
826 y([2])19 b Fa(Barendregt,)13 b(H.)f(P.)h FI(Lam)o(b)q(da)c(calculi)
h(with)g(t)o(yp)q(es.)k(In)d FH(Handb)n(o)n(ok)i(of)e(L)n(o)n(gic)h(in)
g(Computer)g(Scienc)n(e)p FI(,)256 901 y(S.)h(Abramsky)m(,)f(D.)h(M.)g
(Gabba)o(y)m(,)e(and)j(T.)f(S.)g(E.)g(Maibaum,)e(Eds.)j(Oxford)f(Univ)o
(ersit)o(y)h(Press,)h(Oxford,)256 976 y(1991.)192 1051
y([3])k Fa(Ba)l(wden,)d(A.)h FI(Quasiquotation)12 b(in)h(LISP.)k(In)c
FH(A)o(CM)h(SIGPLAN)g(Workshop)h(on)g(Partial)e(Evaluation)256
1125 y(and)18 b(Semantics-Base)n(d)f(Pr)n(o)n(gr)n(am)f(Manipulation)k
FI(\(San)c(An)o(tonio,)f(Jan.)g(1999\),)g(pp.)g(88{99.)23
b(In)o(vited)256 1200 y(talk.)192 1275 y([4])c Fa(Benaissa,)h
(Z.-E.-A.,)e(Bria)o(ud,)g(D.,)i(Lescanne,)g(P.,)e(and)h(R)o
(ouyer-Degli,)h(J.)25 b FF(\025\027)s FI(,)15 b(a)h(calcu-)256
1349 y(lus)j(of)g(explicit)g(substitutions)h(whic)o(h)f(preserv)o(es)i
(strong)f(normalisation.)31 b FH(Journal)20 b(of)f(F)m(unctional)256
1424 y(Pr)n(o)n(gr)n(amming)14 b(6)p FI(,)g(5)f(\(Sept.)i(1996\),)d
(699{722.)192 1499 y([5])19 b Fa(Benaissa,)g(Z.)e(E.-A.,)h(Moggi,)e
(E.,)i(T)l(aha,)h(W.,)f(and)g(Sheard,)h(T.)k FI(A)16
b(categorical)f(analysis)g(of)256 1574 y(m)o(ulti-lev)o(el)9
b(languages)i(\(extended)i(abstract\).)i(T)m(ec)o(h.)c(Rep.)g
(CSE-98-018,)f(Departmen)o(t)h(of)g(Computer)256 1648
y(Science,)k(Oregon)f(Graduate)g(Institute,)g(Dec.)g(1998.)j(Av)n
(ailable)c(from)f([66].)192 1723 y([6])19 b Fa(Benaissa,)i(Z.)f(E.-A.,)
g(Moggi,)f(E.,)h(T)l(aha,)i(W.,)e(and)h(Sheard,)g(T.)30
b FI(Logical)16 b(mo)q(dalities)g(and)256 1798 y(m)o(ulti-stage)i
(programming)o(.)34 b(In)20 b FH(F)m(e)n(der)n(ate)n(d)g(L)n(o)n(gic)g
(Confer)n(enc)n(e)h(\(FL)n(oC\))f(Satel)r(lite)g(Workshop)h(on)256
1873 y(Intuitionistic)14 b(Mo)n(dal)i(L)n(o)n(gics)e(and)i(Applic)n
(ations)f(\(IMLA\))g FI(\(July)f(1999\).)j(In)d(press.)192
1947 y([7])19 b Fa(Bondorf,)e(A.)h FI(A)c(self-applicable)f(partial)f
(ev)n(aluator)h(for)g(term)h(rewriting)f(systems.)18
b(In)13 b FH(T)m(APSOFT)256 2022 y('89.)e(Pr)n(o)n(c)n(e)n(e)n(dings)g
(of)g(the)h(The)n(ory)f(and)g(Pr)n(actic)n(e)g(of)g(Softwar)n(e)g
(Development,)g(Bar)n(c)n(elona,)h(Sp)n(ain)h FI(\(Mar.)256
2097 y(1989\),)g(Lecture)i(Notes)g(in)e(Computer)g(Science,)i
(Springer-V)m(erlag,)e(pp.)h(81{95.)192 2171 y([8])19
b Fa(Bondorf,)i(A.)27 b FH(Self-Applic)n(able)17 b(Partial)f
(Evaluation)p FI(.)28 b(PhD)17 b(thesis,)g(Univ)o(ersit)o(y)g(of)f(Cop)
q(enhagen,)256 2246 y(1990.)192 2321 y([9])j Fa(Bondorf,)j(A.)32
b FI(Impro)o(ving)16 b(binding)i(times)f(without)h(explicit)g(CPS-con)o
(v)o(ersion.)32 b(In)18 b FH(1992)i(A)o(CM)256 2396 y(Confer)n(enc)n(e)
e(on)h(Lisp)f(and)h(F)m(unctional)g(Pr)n(o)n(gr)n(amming.)e(San)i(F)m
(r)n(ancisc)n(o,)f(California)i FI(\(June)e(1992\),)256
2470 y(pp.)c(1{10.)171 2545 y([10])19 b Fa(Cardelli)p
FI(.)14 b(T)o(yp)q(e)e(systems.)i(In)e FH(The)g(Computer)h(Scienc)n(e)g
(and)g(Engine)n(ering)g(Handb)n(o)n(ok)p FI(.)f(CR)o(C)f(Press,)256
2620 y(1997.)1004 2795 y(162)p eop
%%Page: 163 174
163 173 bop 1862 0 a FB(163)171 192 y FI([11])19 b Fa(Cardelli,)13
b(L.)i FI(Phase)d(distinctions)f(in)g(t)o(yp)q(e)g(theory)m(.)j
(\(Unpublished)d(man)o(uscript.\))f(Av)n(ailable)g(online)256
266 y(from)i FE(http://www.luca.demon.co.uk/Bibliography)m(.html)p
FI(,)h(1988.)k(Last)d(view)o(ed)g(August)h(1999.)171
341 y([12])k Fa(Cardelli,)13 b(L.)h FI(T)o(yp)q(eful)c(programming.)g
(In)g FH(F)m(ormal)i(Description)g(of)g(Pr)n(o)n(gr)n(amming)f(Conc)n
(epts)p FI(,)g(E.)f(J.)256 416 y(Neuhold)h(and)f(M.)g(P)o(aul,)g(Eds.,)
g(IFIP)h(State-of-the-Art)g(Rep)q(orts.)g(Springer-V)m(erlag,)f(New)h
(Y)m(ork,)e(1991,)256 490 y(pp.)14 b(431{507.)171 565
y([13])19 b Fa(Clinger,)h(W.,)h(and)f(Rees,)h(J.)31 b
FI(Macros)18 b(that)g(w)o(ork.)30 b(In)18 b FH(Confer)n(enc)n(e)h(R)n
(e)n(c)n(or)n(d)g(of)f(the)h(18th)g(A)o(n-)256 640 y(nual)14
b(A)o(CM)e(Symp)n(osium)i(on)g(Principles)e(of)h(Pr)n(o)n(gr)n(amming)g
(L)n(anguages)h(\(POPL)f('91\))h FI(\(Orlando,)d(Jan.)256
715 y(1991\),)i(A)o(CM)g(Press,)j(pp.)d(155{162.)171
789 y([14])19 b Fa(Clocksin,)d(W.)g(F.,)g(and)g(Mellish,)h(C.)f(S.)j
FH(Pr)n(o)n(gr)n(amming)14 b(in)h(Pr)n(olo)n(g)p FI(.)i(Springer-V)m
(erlag,)d(1981.)171 864 y([15])19 b Fa(Consel,)k(C.,)f(and)g(D)o(anvy,)
i(O.)35 b FI(F)m(or)19 b(a)g(b)q(etter)j(supp)q(ort)e(of)f(static)h
(data)f(\015o)o(w.)34 b(In)19 b FH(F)m(unctional)256
939 y(Pr)n(o)n(gr)n(amming)g(L)n(anguages)h(and)g(Computer)f(A)o(r)n
(chite)n(ctur)n(e)h FI(\(Cam)o(bridge,)d(Aug.)h(1991\),)f(v)o(ol.)g
(523)h(of)256 1013 y FH(L)n(e)n(ctur)n(e)c(Notes)h(in)g(Computer)g
(Scienc)n(e)p FI(,)f(Springer-V)m(erlag,)f(pp.)g(496{519.)171
1088 y([16])19 b Fa(Curr)m(y,)e(H.)f(B.,)h(and)g(Feys,)g(R.)j
FH(Combinatory)15 b(L)n(o)n(gic,)g(V)m(olume)g(I)p FI(.)k
(North-Holland,)13 b(Amsterdam,)256 1163 y(1958.)k(Second)e(prin)o
(ting)e(1968.)171 1238 y([17])19 b Fa(D)o(anvy,)14 b(O.)e
FI(Across)f(the)f(bridge)g(b)q(et)o(w)o(een)h(re\015ection)g(and)f
(partial)e(ev)n(aluation.)i(In)g FH(Partial)g(Evaluation)256
1312 y(and)19 b(Mixe)n(d)f(Computation)j FI(\(1988\),)16
b(D.)h(Bjorner,)g(A.)g(P)m(.)g(Ersho)o(v,)g(and)g(N.)g(D.)f(Jones,)i
(Eds.,)f(North-)256 1387 y(Holland,)12 b(pp.)i(83{116.)171
1462 y([18])19 b Fa(D)o(anvy,)j(O.)29 b FI(T)o(yp)q(e-directed)19
b(partial)d(ev)n(aluation.)27 b(In)18 b FH(A)o(CM)f(Symp)n(osium)i(on)g
(Principles)e(of)h(Pr)n(o-)256 1536 y(gr)n(amming)d(L)n(anguages)j
FI(\(Florida,)13 b(Jan.)g(1996\),)g(A)o(CM)h(Press,)h(pp.)e(242{257.)
171 1611 y([19])19 b Fa(D)o(anvy,)g(O.,)f(and)g(Malmkj\032r,)f(K.)22
b FI(In)o(tensions)16 b(and)f(extensions)h(in)e(a)h(re\015ectiv)o(e)i
(to)o(w)o(er.)k(In)15 b FH(Pr)n(o-)256 1686 y(c)n(e)n(e)n(dings)h(of)f
(the)h(1988)g(A)o(CM)g(Confer)n(enc)n(e)f(on)h(LISP)g(and)h(F)m
(unctional)f(Pr)n(o)n(gr)n(amming)i FI(\(1988\),)13 b(A)o(CM)256
1761 y(Press,)i(pp.)f(327{341.)171 1835 y([20])19 b Fa(D)o(anvy,)g(O.,)
d(Malmkjaer,)i(K.,)f(and)g(P)l(alsber)o(g,)g(J.)i FI(The)c(essence)i
(of)d(eta-expansion)g(in)g(partial)256 1910 y(ev)n(aluation.)j
FH(LISP)e(and)h(Symb)n(olic)f(Computation)g(1)p FI(,)e(19)h(\(1995\).)
171 1985 y([21])19 b Fa(D)o(anvy,)d(O.,)d(Malmkjaer,)i(K.,)f(and)g(P)l
(alsber)o(g,)g(J.)h FI(Eta-expansion)c(do)q(es)i(the)f(tric)o(k.)i(T)m
(ec)o(h.)d(Rep.)256 2060 y(RS-95-41,)h(Univ)o(ersit)o(y)i(of)f(Aarh)o
(us,)h(Aarh)o(us,)g(Aug.)f(1995.)171 2134 y([22])19 b
Fa(D)o(a)l(vies,)g(R.)24 b FI(A)16 b(temp)q(oral-logic)d(approac)o(h)i
(to)h(binding-time)d(analysis.)22 b(In)16 b FH(Pr)n(o)n(c)n(e)n(e)n
(dings,)g(11)1802 2119 y FA(th)1852 2134 y FH(A)o(n-)256
2209 y(nual)i(IEEE)g(Symp)n(osium)h(on)f(L)n(o)n(gic)f(in)h(Computer)f
(Scienc)n(e)k FI(\(New)d(Brunswic)o(k,)f(July)g(1996\),)e(IEEE)256
2284 y(Computer)e(So)q(ciet)o(y)h(Press,)h(pp.)f(184{195.)171
2358 y([23])19 b Fa(D)o(a)l(vies,)j(R.,)f(and)g(Pfenning,)g(F.)31
b FI(A)19 b(mo)q(dal)d(analysis)h(of)h(staged)h(computation.)29
b(In)18 b FH(23r)n(d)h(A)o(n-)256 2433 y(nual)14 b(A)o(CM)f(Symp)n
(osium)h(on)g(Principles)f(of)g(Pr)n(o)n(gr)n(amming)g(L)n(anguages)h
(\(POPL'96\))g FI(\(St.)e(P)o(etersburg)256 2508 y(Beac)o(h,)i(Jan.)g
(1996\),)e(pp.)i(258{270.)171 2583 y([24])19 b Fa(Dersho)o(witz,)h(N.)
29 b FI(Computing)16 b(with)h(rewrite)i(systems.)29 b
FH(Information)18 b(and)h(Contr)n(ol)f(65)23 b FI(\(1985\),)256
2657 y(122{157.)p eop
%%Page: 164 175
164 174 bop 1862 0 a FB(164)171 192 y FI([25])19 b Fa(Di)12
b(Cosmo,)h(R.)g FH(Isomorphisms)f(of)f(T)m(yp)n(es:)h(fr)n(om)f
FF(\025)p FH(-c)n(alculus)g(to)h(information)f(r)n(etrieval)g(and)h
(language)256 266 y(design)p FI(.)18 b(Birkh\177)-21
b(auser,)15 b(1995.)171 341 y([26])k Fa(Engler,)c(D.)g(R.,)g(Hsieh,)f
(W.)h(C.,)f(and)h(Kaashoek,)i(M.)e(F.)h FI(`C:)c(A)g(language)g(for)g
(high-lev)o(el,)f(e\016-)256 416 y(cien)o(t,)h(and)g(mac)o(hine-indep)q
(enden)o(t)g(dynaic)g(co)q(de)g(generation.)k(In)c FH(Confer)n(enc)n(e)
h(R)n(e)n(c)n(or)n(d)g(of)g(POPL)g('96:)256 490 y(The)19
b FI(23)387 475 y FA(rd)438 490 y FH(A)o(CM)g(SIGPLAN-SIGA)o(CT)f(Symp)
n(osium)i(on)f(Principles)f(of)h(Pr)n(o)n(gr)n(amming)f(L)n(anguages)
256 565 y FI(\(St.)c(P)o(etersburg)i(Beac)o(h,)e(Jan.)f(1996\),)g(pp.)g
(131{144.)171 640 y([27])19 b Fa(Friedman,)14 b(D.)h(P.,)f(and)h(W)-5
b(and,)16 b(M.)g FI(Rei\014cation:)11 b(Re\015ection)h(without)g
(metaph)o(ysics.)j(In)e FH(Confer-)256 715 y(enc)n(e)18
b(R)n(e)n(c)n(or)n(d)e(of)h(the)g(1984)h(A)o(CM)f(Symp)n(osium)h(on)f
(LISP)h(and)f(F)m(unctional)h(Pr)n(o)n(gr)n(amming)h
FI(\(Austin,)256 789 y(Aug.)13 b(1984\),)g(pp.)g(348{355.)171
864 y([28])19 b Fa(Gl)313 861 y(\177)312 864 y(uck,)c(R.,)g(Ha)m
(tcliff,)f(J.,)g(and)h(J\034r)o(gensen,)g(J.)g FI(Generalization)d(in)g
(hierarc)o(hies)h(of)f(online)f(pro-)256 939 y(gram)h(sp)q
(ecialization)g(systems.)17 b(In)d FH(L)n(o)n(gic-Base)n(d)g(Pr)n(o)n
(gr)n(am)g(Synthesis)h(and)g(T)m(r)n(ansformation)g FI(\(1999\),)256
1013 y(v)o(ol.)d(1559)h(of)h FH(L)n(e)n(ctur)n(e)g(Notes)h(in)g
(Computer)f(Scienc)n(e)p FI(,)g(Springer-V)m(erlag,)f(pp.)h(179{198.)
171 1088 y([29])19 b Fa(Gl)313 1085 y(\177)312 1088 y(uck,)14
b(R.,)e(and)h(J\034r)o(gensen,)h(J.)e FI(E\016cien)o(t)f(m)o(ulti-lev)o
(el)d(generating)i(extensions)i(for)e(program)f(sp)q(e-)256
1163 y(cialization.)16 b(In)d FH(Pr)n(o)n(gr)n(amming)h(L)n(anguages:)h
(Implementations,)f(L)n(o)n(gics)h(and)g(Pr)n(o)n(gr)n(ams)e
(\(PLILP'95\))256 1238 y FI(\(1995\),)h(S.)h(D.)f(Swierstra)j(and)e(M.)
f(Hermenegildo,)g(Eds.,)h(v)o(ol.)f(982)h(of)f FH(L)n(e)n(ctur)n(e)i
(Notes)g(in)g(Computer)256 1312 y(Scienc)n(e)p FI(,)e(Springer-V)m
(erlag,)f(pp.)h(259{278.)171 1387 y([30])19 b Fa(Gl)313
1384 y(\177)312 1387 y(uck,)g(R.,)f(and)g(J\034r)o(gensen,)g(J.)23
b FI(F)m(ast)15 b(binding-time)e(analysis)i(for)g(m)o(ulti-lev)o(el)e
(sp)q(ecialization.)256 1462 y(In)g FH(Persp)n(e)n(ctives)g(of)h
(System)g(Informatics)i FI(\(1996\),)11 b(D.)h(Bj\034rner,)h(M.)f(Bro)o
(y)m(,)g(and)h(I.)f(V.)g(P)o(ottosin,)g(Eds.,)256 1536
y(v)o(ol.)g(1181)h(of)h FH(L)n(e)n(ctur)n(e)g(Notes)h(in)g(Computer)f
(Scienc)n(e)p FI(,)g(Springer-V)m(erlag,)f(pp.)h(261{272.)171
1611 y([31])19 b Fa(Gl)313 1608 y(\177)312 1611 y(uck,)f(R.,)g(and)g
(J\034r)o(gensen,)g(J.)j FI(An)15 b(automatic)f(program)f(generator)j
(for)f(m)o(ulti-lev)o(el)d(sp)q(ecial-)256 1686 y(ization.)17
b FH(LISP)f(and)f(Symb)n(olic)g(Computation)g(10)p FI(,)f(2)g
(\(1997\),)f(113{158.)171 1761 y([32])19 b Fa(Gomard,)j(C.)f(K.,)g(and)
g(Jones,)h(N.)e(D.)33 b FI(A)19 b(partial)f(ev)n(aluator)g(for)g(un)o
(t)o(yp)q(ed)h(lam)o(b)q(da)d(calculus.)256 1835 y FH(Journal)f(of)g(F)
m(unctional)g(Pr)n(o)n(gr)n(amming)f(1)p FI(,)g(1)f(\(Jan.)h(1991\),)f
(21{69.)171 1910 y([33])19 b Fa(Gunter,)e(C.)f(A.)i FH(Semantics)d(of)g
(Pr)n(o)n(gr)n(amming)f(L)n(anguages)p FI(.)20 b(MIT)13
b(Press,)i(1992.)171 1985 y([34])k Fa(Ha)m(tcliff,)14
b(J.,)f(and)i(D)o(anvy,)h(O.)f FI(Th)o(unks)d(and)g(the)g
FF(\025)p FI(-calculus.)j FH(Journal)e(of)g(F)m(unctional)h(Pr)n(o)n
(gr)n(am-)256 2060 y(ming)h(7)p FI(,)f(3)f(\(Ma)o(y)h(1997\),)e
(303{319.)171 2134 y([35])19 b Fa(Ha)m(tcliff,)13 b(J.,)f(and)h(Gl)674
2131 y(\177)673 2134 y(uck,)h(R.)g FI(Reasoning)c(ab)q(out)g(hierarc)o
(hies)i(of)e(online)g(sp)q(ecialization)g(systems.)256
2209 y(In)20 b FH(Partial)f(Evaluation)k FI(\(1996\),)c(v)o(ol.)f(1110)
g(of)h FH(L)n(e)n(ctur)n(e)h(Notes)g(in)g(Computer)g(Scienc)n(e)p
FI(,)g(Springer-)256 2284 y(V)m(erlag,)13 b(pp.)g(161{182.)171
2358 y([36])19 b Fa(Hindley,)j(J.)g(R.)35 b FH(Basic)20
b(Simple)g(T)m(yp)n(e)g(The)n(ory)p FI(,)f(v)o(ol.)f(42)h(of)g
FH(Cambridge)g(T)m(r)n(acts)g(in)h(The)n(or)n(etic)n(al)256
2433 y(Computer)15 b(Scienc)n(e)p FI(.)j(Cam)o(bridge)12
b(Univ)o(ersit)o(y)i(Press,)h(Cam)o(bridge,)d(1997.)171
2508 y([37])19 b Fa(Hook,)14 b(J.,)f(and)h(Sheard,)h(T.)f
FI(A)e(seman)o(tics)f(of)g(compile-tim)o(e)e(re\015ection.)15
b(T)m(ec)o(h.)c(Rep.)g(CSE)h(93-019,)256 2583 y(Oregon)i(Graduate)g
(Institute,)h(1993.)i(Av)n(ailable)12 b(from)g([66].)p
eop
%%Page: 165 176
165 175 bop 1862 0 a FB(165)171 192 y FI([38])19 b Fa(Jones,)g(N.)g(D.)
26 b FI(Mix)16 b(ten)h(y)o(ears)g(later.)25 b(In)17 b
FH(Pr)n(o)n(c)n(e)n(e)n(dings)g(of)g(the)g(A)o(CM)g(SIGPLAN)h(Symp)n
(osium)f(on)256 266 y(Partial)i(Evaluation)h(and)g(Semantics-b)n(ase)n
(d)h(Pr)n(o)n(gr)n(am)d(Manipulation)23 b FI(\(June)d(1995\),)e(A)o(CM)
h(Press,)256 341 y(A)o(CM)14 b(Press,)h(pp.)e(24{38.)171
416 y([39])19 b Fa(Jones,)h(N.)f(D.)30 b FI(What)17 b(not)g(to)g(do)g
(when)h(writing)f(an)g(in)o(terpreter)i(for)e(sp)q(ecialisation.)27
b(In)18 b FH(Partial)256 490 y(Evaluation)d FI(\(1996\),)9
b(v)o(ol.)g(1110)h(of)g FH(L)n(e)n(ctur)n(e)h(Notes)h(in)g(Computer)g
(Scienc)n(e)p FI(,)f(Springer-V)m(erlag,)f(pp.)g(216{)256
565 y(237.)171 640 y([40])19 b Fa(Jones,)j(N.)f(D.,)i(Gomard,)f(C.)f
(K.,)h(and)g(Sestoft,)g(P.)34 b FH(Partial)19 b(Evaluation)i(and)f(A)o
(utomatic)256 715 y(Pr)n(o)n(gr)n(am)14 b(Gener)n(ation)p
FI(.)k(Pren)o(tice-Hall,)c(1993.)171 789 y([41])19 b
Fa(Jones,)13 b(N.)f(D.,)h(Sestoft,)g(P.,)g(and)g(Sonder)o(graard,)h(H.)
f FI(An)e(exp)q(erimen)o(t)f(in)g(partial)g(ev)n(aluation:)256
864 y(The)16 b(generation)g(of)f(a)h(compiler)e(generator.)25
b(In)15 b FH(R)n(ewriting)h(T)m(e)n(chniques)h(and)g(Applic)n(ations)i
FI(\(1985\),)256 939 y(v)o(ol.)12 b(202)i(of)f FH(L)n(e)n(ctur)n(e)h
(Notes)h(in)g(Computer)g(Scienc)n(e)p FI(,)f(Springer-V)m(erlag,)f(pp.)
g(124{140.)171 1013 y([42])19 b Fa(J\034rring,)14 b(U.,)h(and)g
(Scherlis,)g(W.)g(L.)i FI(Compilers)11 b(and)i(staging)f
(transformations.)i(In)f FH(Thirte)n(enth)256 1088 y(A)o(CM)i(Symp)n
(osium)g(on)h(Principles)e(of)h(Pr)n(o)n(gr)n(amming)g(L)n(anguages,)g
(St.)g(Petersbur)n(g,)f(Florida)j FI(\(1986\),)256 1163
y(A)o(CM)d(Press,)h(pp.)e(86{96.)171 1238 y([43])19 b
Fa(Kiebur)m(tz,)12 b(R.)f(B.,)h(McKinney,)h(L.,)f(Bell,)g(J.,)g(Hook,)g
(J.,)g(K)o(oto)o(v,)g(A.,)g(Lewis,)f(J.,)g(Oliv)l(a,)i(D.,)256
1312 y(Sheard,)19 b(T.,)e(Smith,)g(I.,)h(and)g(W)-5 b(al)m(ton,)19
b(L.)k FI(A)15 b(soft)o(w)o(are)g(engineering)h(exp)q(erimen)o(t)f(in)g
(soft)o(w)o(are)256 1387 y(comp)q(onen)o(t)k(generation.)37
b(In)20 b FH(18th)h(International)g(Confer)n(enc)n(e)g(in)f(Softwar)n
(e)g(Engine)n(ering)k FI(\(Mar.)256 1462 y(1996\),)13
b(pp.)g(542{553.)171 1536 y([44])19 b Fa(K)o(ohlbecker,)e(E.)f(E.,)g
(Friedman,)g(D.)g(P.,)g(Felleisen,)g(M.,)g(and)h(Duba,)g(B.)i
FI(Hygienic)13 b(macro)256 1611 y(expansion.)18 b FH(A)o(CM)d(Confer)n
(enc)n(e)f(on)i(LISP)f(and)h(F)m(unctional)f(Pr)n(o)n(gr)n(amming)i
FI(\(Aug.)d(1986\),)e(151{161.)171 1686 y([45])19 b Fa(Leone,)f(M.,)f
(and)g(Lee,)g(P.)j FI(Deferred)c(compilation:)11 b(The)k(automation)d
(of)i(run-time)f(co)q(de)i(genera-)256 1761 y(tion.)j(T)m(ec)o(h.)13
b(Rep.)h(CMU-CS-93-225,)e(Carnegie)i(Mellon)f(Univ)o(ersit)o(y)m(,)g
(Dec.)h(1993.)171 1835 y([46])19 b Fa(Ma)o(chkaso)o(v)l(a,)k(E.,)d(and)
h(Turbak,)g(F.)f(A.)30 b FI(A)18 b(calculus)g(for)f(link-time)e
(compilation)g(\(extended)256 1910 y(abstract\).)h(\(Unpublished)c(man)
o(uscript.\))f(By)h(w)o(a)o(y)f(of)h(F)m(ranklyn)f(A.)g(T)m(urbak)h(\()
p FE(fturbak@w)o(ellesley)m(.edu)p FI(\),)256 1985 y(June)j(1999.)171
2060 y([47])k Fa(Maier,)g(D.,)h(and)g(W)-5 b(arren,)20
b(D.)f(S.)28 b FH(Computing)18 b(with)f(lo)n(gic:)g(L)n(o)n(gic)g(pr)n
(o)n(gr)n(amming)g(with)g(Pr)n(olo)n(g)p FI(.)256 2134
y(The)d(Benjamin/Cumm)o(i)o(ngs)d(Publishing)j(Compan)o(y)m(,)c(Inc.,)k
(1988.)171 2209 y([48])19 b Fa(Milner,)h(R.)29 b FI(A)17
b(theory)g(of)g(t)o(yp)q(e)h(p)q(olymorphism)13 b(in)k(programming)o(.)
25 b FH(Journal)18 b(of)g(Computer)f(and)256 2284 y(System)e(Scienc)n
(es)h(17)k FI(\(1978\),)12 b(348{375.)171 2358 y([49])19
b Fa(Milner,)e(R.,)g(Tofte,)g(M.,)g(Harper,)g(R.,)g(and)h(Ma)o(cQueen,)
g(D.)j FH(The)15 b(De\014nition)i(of)e(Standar)n(d)256
2433 y(ML)g(\(R)n(evise)n(d\))p FI(.)j(MIT)c(Press,)h(1997.)171
2508 y([50])k Fa(Mitchell,)d(J.)f(C.)k FH(F)m(oundations)d(for)e(Pr)n
(o)n(gr)n(amming)g(L)n(anguages)p FI(.)19 b(MIT)14 b(Press,)h(Cam)o
(bridge,)d(1996.)171 2583 y([51])19 b Fa(Mogensen,)c(T.)e(\035.)h
FI(E\016cien)o(t)e(self-in)o(terpretation)g(in)f(lam)o(b)q(da)e
(calculus.)14 b FH(F)m(unctional)f(Pr)n(o)n(gr)n(amming)256
2657 y(2)p FI(,)h(3)f(\(July)h(1992\),)f(345{364.)p eop
%%Page: 166 177
166 176 bop 1862 0 a FB(166)171 192 y FI([52])19 b Fa(Moggi,)12
b(E.)h FI(Notions)d(of)g(computation)f(and)h(monads.)h
FH(Information)h(and)g(Computation)g(93)p FI(,)f(1)f(\(1991\).)171
266 y([53])19 b Fa(Moggi,)f(E.)27 b FI(A)16 b(categorical)h(accoun)o(t)
g(of)f(t)o(w)o(o-lev)o(el)g(languages.)25 b(In)17 b FH(Mathematics)g(F)
m(oundations)i(of)256 341 y(Pr)n(o)n(gr)n(amming)14 b(Semantics)k
FI(\(1997\),)13 b(Elsevier)h(Science.)171 416 y([54])19
b Fa(Moggi,)e(E.,)g(T)l(aha,)h(W.,)g(Benaissa,)g(Z.,)f(and)h(Sheard,)h
(T.)j FI(An)15 b(idealized)g(MetaML:)g(Simpler,)256 490
y(and)h(more)e(expressiv)o(e)j(\(includes)g(pro)q(ofs\).)23
b(T)m(ec)o(h.)15 b(Rep.)h(CSE-98-017,)d(OGI,)i(Oct.)h(1998.)23
b(Av)n(ailable)256 565 y(from)12 b([66].)171 640 y([55])19
b Fa(Moggi,)e(E.,)g(T)l(aha,)h(W.,)g(Benaissa,)g(Z.,)f(and)h(Sheard,)h
(T.)j FI(An)15 b(idealized)g(MetaML:)g(Simpler,)256 715
y(and)i(more)e(expressiv)o(e.)29 b(In)16 b FH(Eur)n(op)n(e)n(an)i(Symp)
n(osium)h(on)f(Pr)n(o)n(gr)n(amming)e(\(ESOP\))j FI(\(1999\),)d(v)o
(ol.)f(1576)256 789 y(of)g FH(L)n(e)n(ctur)n(e)i(Notes)f(in)h(Computer)
f(Scienc)n(e)p FI(,)h(Springer-V)m(erlag,)e(pp.)g(193{207.)22
b(An)16 b(extended)i(v)o(ersion)256 864 y(app)q(ears)d(in)e([54].)171
939 y([56])19 b Fa(Muller,)e(R.)i FI(M-LISP:)13 b(A)h(represen)o
(tation-indep)q(enden)o(t)i(dialect)e(of)f(LISP)h(with)f(reduction)i
(seman-)256 1013 y(tics.)f FH(A)o(CM)e(T)m(r)n(ansactions)g(on)g(Pr)n
(o)n(gr)n(amming)g(L)n(anguages)h(and)g(Systems)g(14)p
FI(,)d(4)h(\(Oct.)h(1992\),)d(589{616.)171 1088 y([57])19
b Fa(Muller,)j(R.)30 b FI(A)18 b(staging)f(calculus)i(and)e(its)h
(application)f(to)g(the)i(v)o(eri\014cation)e(of)h(translators.)30
b(In)256 1163 y FH(Confer)n(enc)n(e)17 b(R)n(e)n(c)n(or)n(d)f(of)h
(POPL)f('94:)h(21st)g(A)o(CM)f(SIGPLAN-SIGA)o(CT)g(Symp)n(osium)h(on)h
(Principles)256 1238 y(of)d(Pr)n(o)n(gr)n(amming)f(L)n(anguages)19
b FI(\(P)o(ortland,)13 b(Jan.)g(1994\),)g(pp.)g(389{396.)171
1312 y([58])19 b Fa(Nielson,)i(F.)32 b FI(Program)17
b(transformations)g(in)h(a)g(denotational)g(setting.)32
b FH(A)o(CM)19 b(T)m(r)n(ansactions)f(on)256 1387 y(Pr)n(o)n(gr)n
(amming)c(L)n(anguages)i(and)g(Systems)f(7)p FI(,)f(3)f(\(July)h
(1985\),)f(359{379.)171 1462 y([59])19 b Fa(Nielson,)c(F.)h
FI(Correctness)g(of)c(co)q(de)h(generation)g(from)e(a)h(t)o(w)o(o-lev)o
(el)g(meta-language.)h(In)g FH(Pr)n(o)n(c)n(e)n(e)n(dings)256
1536 y(of)g(the)h(Eur)n(op)n(e)n(an)g(Symp)n(osium)g(on)g(Pr)n(o)n(gr)n
(amming)f(\(ESOP)g(86\))i FI(\(Saarbr)q(\177)-22 b(uc)o(k)o(en,)12
b(Mar.)g(1986\),)f(v)o(ol.)g(213)256 1611 y(of)i FH(L)n(e)n(ctur)n(e)i
(Notes)g(in)f(Computer)h(Scienc)n(e)p FI(,)f(Springer,)g(pp.)f(30{40.)
171 1686 y([60])19 b Fa(Nielson,)14 b(F.)f FI(Tw)o(o-lev)o(el)e(seman)o
(tics)f(and)h(abstract)h(in)o(terpretation.)i FH(The)n(or)n(etic)n(al)d
(Computer)h(Scienc)n(e)256 1761 y(69)p FI(,)i(2)f(\(Dec.)i(1989\),)d
(117{242.)171 1835 y([61])19 b Fa(Nielson,)f(F.,)f(and)h(Nielson,)g(H.)
f(R.)23 b FI(Tw)o(o-lev)o(el)14 b(seman)o(tics)h(and)g(co)q(de)h
(generation.)22 b FH(The)n(or)n(etic)n(al)256 1910 y(Computer)15
b(Scienc)n(e)g(56)p FI(,)f(1)g(\(Jan.)f(1988\),)g(59{133.)171
1985 y([62])19 b Fa(Nielson,)d(F.,)f(and)h(Nielson,)f(H.)g(R.)j
FH(Two-L)n(evel)13 b(F)m(unctional)i(L)n(anguages)p FI(.)j(No.)12
b(34)h(in)g(Cam)o(bridge)256 2060 y(T)m(racts)h(in)g(Theoretical)g
(Computer)f(Science.)i(Cam)o(bridge)d(Univ)o(ersit)o(y)i(Press,)h(Cam)o
(bridge,)d(1992.)171 2134 y([63])19 b Fa(Nielson,)h(F.,)f(and)h
(Nielson,)g(H.)g(R.)28 b FI(Multi-lev)o(el)16 b(lam)o(b)q(da-calculi:)e
(An)j(algebraic)g(description.)256 2209 y(In)j FH(Partial)f(Evaluation)
i(International)g(Seminar,)f(Dagstuhl)h(Castle,)e(Germany,)i(Sele)n
(cte)n(d)f(Pap)n(ers)256 2284 y FI(\(1996\),)13 b(v)o(ol.)f(1110)h(of)g
FH(L)n(e)n(ctur)n(e)i(Notes)f(in)h(Computer)g(Scienc)n(e)p
FI(,)f(Springer-V)m(erlag,)f(pp.)h(338{354.)171 2358
y([64])19 b Fa(Nielson,)k(F.,)f(and)h(Nielson,)g(H.)f(R.)38
b FI(A)20 b(prescriptiv)o(e)h(framew)o(ork)e(for)g(designing)h(m)o
(ulti-lev)o(el)256 2433 y(lam)o(b)q(da-calculi.)10 b(In)h
FH(Pr)n(o)n(c)n(e)n(e)n(dings)g(of)h(the)g(Symp)n(osium)h(on)g(Partial)
e(Evaluation)h(and)h(Semantics-Base)n(d)256 2508 y(Pr)n(o)n(gr)n(am)h
(Manipulation)k FI(\(Amsterdam,)12 b(June)j(1997\),)d(A)o(CM)i(Press,)h
(pp.)f(193{202.)171 2583 y([65])19 b Fa(Okasaki,)f(C.)h
FH(Pur)n(ely)c(F)m(unctional)h(Data)g(Structur)n(es)p
FI(.)i(PhD)c(thesis,)h(Sc)o(ho)q(ol)f(of)f(Computer)h(Science,)256
2657 y(Carnegie)g(Mellon)f(Univ)o(ersit)o(y)m(,)g(1996.)p
eop
%%Page: 167 178
167 177 bop 1862 0 a FB(167)171 192 y FI([66])19 b(Oregon)27
b(Graduate)f(Institute)i(T)m(ec)o(hnical)e(Rep)q(orts.)g(P)m(.O.)g(Bo)o
(x)g(91000,)f(P)o(ortland,)g(OR)h(97291-)256 266 y(1000,USA.)36
b(Av)n(ailable)18 b(online)i(from)e FE(ftp://cse.ogi.edu/pub/tech-rep)q
(o)o(rts/README.html)p FI(.)38 b(Last)256 341 y(view)o(ed)14
b(August)h(1999.)171 416 y([67])k Fa(P)l(a)o(ulson,)j(L.)29
b FH(ML)19 b(for)e(the)h(Working)h(Pr)n(o)n(gr)n(ammer)p
FI(,)d(second)i(ed.)29 b(Cam)o(bridge)15 b(Univ)o(ersit)o(y)j(Press,)
256 490 y(1992.)171 565 y([68])h Fa(Plotkin,)13 b(G.)f(D.)h
FI(Call-b)o(y-name,)7 b(call-b)o(y-v)n(alue)i(and)h(the)h(lam)o(b)q
(da-calculus.)f FH(The)n(or)n(etic)n(al)g(Computer)256
640 y(Scienc)n(e)16 b(1)j FI(\(1975\),)13 b(125{159.)171
715 y([69])19 b Fa(Quine,)g(W.)f(V.)g(O.)25 b FH(Mathematic)n(al)17
b(L)n(o)n(gic)p FI(,)e(revised)i(ed.)25 b(Harv)n(ard)15
b(Univ)o(ersit)o(y)h(Press,)h(1951.)24 b(First)256 789
y(published)14 b(in)g(1940)e(b)o(y)i(Norton.)171 864
y([70])19 b Fa(Quine,)e(W.)f(V.)f(O.)k FH(Set)c(The)n(ory)g(and)g(Its)g
(L)n(o)n(gic)p FI(.)j(Harv)n(ard)13 b(Univ)o(ersit)o(y)h(Press,)h(Cam)o
(bridge,)d(1963.)171 939 y([71])19 b Fa(Quine,)e(W.)f(V.)f(O.)k
FH(F)m(r)n(om)14 b(a)h(L)n(o)n(gic)n(al)g(Point)g(of)g(View)p
FI(,)d(second,)j(revised)g(ed.)j(Harp)q(er)d(&)f(Ro)o(w,)f(1971.)171
1013 y([72])19 b Fa(Reade,)g(C.)25 b FH(Elements)17 b(of)f(F)m
(unctional)i(Pr)n(o)n(gr)n(amming)p FI(.)23 b(In)o(ternational)16
b(Computer)f(Science)i(Series.)256 1088 y(Addison-W)m(esley)m(,)c(W)m
(okingham)o(,)e(1989.)171 1163 y([73])19 b Fa(Rees,)26
b(J.,)f(Clinger,)g(W.,)g(Abelson,)h(H.,)f(Ad)o(ams)g(IV,)g(N.)g(I.,)g
(Bar)m(tley,)i(D.,)f(Br)o(ooks,)256 1238 y(G.,)20 b(D)o(ybvig,)g(R.)g
(K.,)f(Friedman,)h(D.)g(P.,)f(Halstead,)h(R.,)g(Hanson,)h(C.,)f(Ha)m
(ynes,)h(C.)e(T.,)256 1312 y(K)o(ohlbecker,)j(E.,)e(O)o(xley,)i(D.,)f
(Pitman,)f(K.)h(M.,)g(R)o(ozas,)g(G.)g(J.,)f(Sussman,)i(G.)f(J.,)f(and)
256 1387 y(W)-5 b(and,)15 b(M.)g FI(Revised)610 1368
y FA(4)640 1387 y FI(rep)q(ort)e(on)f(the)g(algorithmic)d(language)i
(Sc)o(heme.)j(T)m(ec)o(h.)e(Rep.)f(AI)h(Memo)e(848b,)256
1462 y(MIT)k(Press,)h(No)o(v.)e(1992.)171 1536 y([74])19
b Fa(Reynolds,)14 b(J.)e(C.)h FI(De\014nitional)c(in)o(terpreters)j
(for)e(higher-order)h(programming)c(languages.)12 b(In)e
FH(A)o(CM)256 1611 y(National)15 b(Confer)n(enc)n(e)i
FI(\(1972\),)c(A)o(CM,)g(pp.)g(717{740.)171 1686 y([75])19
b Fa(Reynolds,)c(J.)e(C.)h FI(De\014nitional)c(in)o(terpreters)k(for)d
(higher-order)h(programmi)o(ng)c(languages.)14 b FH(Higher-)256
1761 y(Or)n(der)f(and)i(Symb)n(olic)f(Computation)h(11)p
FI(,)e(4)g(\(1998\).)j(\(Reprin)o(ted)e(from)d(the)j(pro)q(ceedings)g
(of)f(the)g(25th)256 1835 y(A)o(CM)h(National)e(Conference)k(\(1972\))d
([74]\).)171 1910 y([76])19 b Fa(Sabr)m(y,)c(A.,)e(and)h(W)-5
b(adler,)15 b(P.)f FI(A)e(re\015ection)g(on)f(call-b)o(y-v)n(alue.)i
(In)e FH(Pr)n(o)n(c)n(e)n(e)n(dings)i(of)f(the)h(1996)g(A)o(CM)256
1985 y(SIGPLAN)i(International)g(Confer)n(enc)n(e)f(on)i(F)m(unctional)
f(Pr)n(o)n(gr)n(amming)h FI(\(Philadelphia,)c(Ma)o(y)h(1996\),)256
2060 y(pp.)h(13{24.)171 2134 y([77])19 b Fa(Sheard,)k(T.)36
b FI(A)19 b(user's)i(guide)e(to)h(TRPL,)f(a)g(compile-tim)o(e)e
(re\015ectiv)o(e)k(programming)16 b(language.)256 2209
y(T)m(ec)o(h.)e(Rep.)g(COINS)h(90-109,)e(Dept.)h(of)g(Computer)g(and)g
(Information)e(Science,)k(Univ)o(ersit)o(y)e(of)g(Mas-)256
2284 y(sac)o(h)o(usetts,)h(1990.)171 2358 y([78])k Fa(Sheard,)e(T.)i
FI(Automatic)13 b(generation)h(and)f(use)i(of)f(abstract)g(structure)j
(op)q(erators.)i FH(A)o(CM)14 b(T)m(r)n(ansac-)256 2433
y(tions)h(on)g(Pr)n(o)n(gr)n(amming)g(L)n(anguages)h(and)f(Systems)g
(13)p FI(,)f(4)g(\(Oct.)g(1991\),)f(531{557.)171 2508
y([79])19 b Fa(Sheard,)42 b(T.)88 b FI(Guide)37 b(to)g(using)g(CRML,)f
(compile-time)e(re\015ectiv)o(e)39 b(ML.)88 b(Av)n(ailable)256
2583 y FE(http://www.cse.ogi.edu/)q(~)r(shea)o(rd/CRML.html)p
FI(.)13 b(Last)h(view)o(ed)h(August)f(1999,)e(Oct.)j(1993.)p
eop
%%Page: 168 179
168 178 bop 1862 0 a FB(168)171 192 y FI([80])19 b Fa(Sheard,)k(T.)34
b FI(T)o(yp)q(e)19 b(parametric)g(programmi)o(ng.)30
b(T)m(ec)o(h.)19 b(Rep.)g(CSE-93-018,)e(Oregon)j(Graduate)256
266 y(Institute,)14 b(1993.)j(Av)n(ailable)12 b(from)h([66].)171
341 y([81])19 b Fa(Sheard,)24 b(T.)37 b FI(A)20 b(t)o(yp)q(e-directed,)
i(on-line)d(partial)h(ev)n(aluator)f(for)h(a)g(p)q(olymorphic)e
(language.)36 b(In)256 416 y FH(Pr)n(o)n(c)n(e)n(e)n(dings)15
b(of)g(the)g(Symp)n(osium)g(on)h(Partial)e(Evaluation)i(and)f
(Semantics-Base)n(d)h(Pr)n(o)n(gr)n(am)e(Manip-)256 490
y(ulation)j FI(\(Amsterdam,)12 b(June)j(1997\),)d(pp.)i(22{3.)171
565 y([82])19 b Fa(Sheard,)c(T.,)e(and)g(Nelson,)i(N.)f
FI(T)o(yp)q(e)d(safe)h(abstractions)g(using)f(program)e(generators.)15
b(T)m(ec)o(h.)c(Rep.)256 640 y(CSE-95-013,)h(Oregon)j(Graduate)e
(Institute,)i(1995.)i(Av)n(ailable)12 b(from)g([66].)171
715 y([83])19 b Fa(Shields,)i(M.,)f(Sheard,)h(T.,)f(and)g(Jones,)g(S.)g
(P.)30 b FI(Dynamic)15 b(t)o(yping)i(through)g(staged)i(t)o(yp)q(e)f
(in-)256 789 y(ference.)26 b(In)16 b FH(Pr)n(o)n(c)n(e)n(e)n(dings)h
(of)g(the)g(25th)g(A)o(CM)g(SIGPLAN-SIGA)o(CT)g(Symp)n(osium)g(on)h
(Principles)e(of)256 864 y(Pr)n(o)n(gr)n(amming)e(L)n(anguages)19
b FI(\(Jan.)13 b(1998\),)g(pp.)g(289{302.)171 939 y([84])19
b Fa(Smara)o(gd)o(akis,)g(Y.,)e(and)g(Ba)m(tor)m(y,)i(D.)j
FI(Distil:)13 b(A)i(transformation)e(library)i(for)f(data)h
(structures.)256 1013 y(In)f FH(USENIX)h(Confer)n(enc)n(e)g(on)g
(Domain-Sp)n(e)n(ci\014c)h(L)n(anguages)j FI(\(Oct.)14
b(1997\),)f(pp.)g(257{270.)171 1088 y([85])19 b Fa(Smith,)12
b(B.)f(C.)h FH(R)n(e\015e)n(ction)g(and)g(Semantics)f(in)h(a)f(Pr)n(o)n
(c)n(e)n(dur)n(al)f(L)n(anguage)p FI(.)j(PhD)d(thesis,)g(Massac)o(h)o
(usetts)256 1163 y(Institute)15 b(of)e(T)m(ec)o(hnology)m(,)f(Jan.)i
(1982.)171 1238 y([86])19 b Fa(Smith,)i(B.)h(C.)33 b
FI(Re\015ection)19 b(and)g(seman)o(tics)g(in)f(LISP.)34
b(In)19 b FH(A)o(CM)g(Symp)n(osium)h(on)g(Principles)f(of)256
1312 y(Pr)n(o)n(gr)n(amming)14 b(L)n(anguages)19 b FI(\(Jan.)13
b(1984\),)g(pp.)g(23{35.)171 1387 y([87])19 b Fa(Smith,)e(D.)24
b FI(KIDS:)14 b(A)i(semi-automati)o(c)d(program)h(dev)o(elopmen)o(t)g
(system.)22 b FH(IEEE)17 b(T)m(r)n(ansactions)e(on)256
1462 y(Softwar)n(e)f(Engine)n(ering)i(|)f(Sp)n(e)n(cial)g(Issue)g(on)g
(F)m(ormal)g(Metho)n(ds)g(16)p FI(,)f(9)f(\(Sept.)i(1990\),)d
(1024{1043.)171 1536 y([88])19 b Fa(Steele,)g(Jr.,)f(G.)h(L.,)g(and)g
(Gabriel,)g(R.)g(P.)25 b FI(The)17 b(ev)o(olution)e(of)h(LISP.)25
b(In)16 b FH(Pr)n(o)n(c)n(e)n(e)n(dings)h(of)g(the)256
1611 y(Confer)n(enc)n(e)d(on)h(History)e(of)h(Pr)n(o)n(gr)n(amming)g(L)
n(anguages)k FI(\(New)c(Y)m(ork,)e(Apr.)h(1993\),)f(R.)g(L.)g(W)m
(exelblat,)256 1686 y(Ed.,)h(v)o(ol.)g(28\(3\))g(of)g
FH(A)o(CM)i(Sigplan)g(Notic)n(es)p FI(,)e(A)o(CM)h(Press,)h(pp.)f
(231{270.)171 1761 y([89])19 b Fa(Stemple,)i(D.,)h(St)m(anton,)g(R.)f
(B.,)g(Sheard,)h(T.,)e(Philbr)o(o)o(w,)h(P.,)g(Morrison,)h(R.,)f
(Kirby,)256 1835 y(G.)e(N.)g(C.,)f(Fegaras,)h(L.,)g(Cooper,)h(R.)f(L.,)
g(Connor,)h(R.)f(C.)f(H.,)h(A)l(tkinson,)h(M.)e(P.,)h(and)256
1910 y(Ala)o(gic,)13 b(S.)k FI(T)o(yp)q(e-safe)12 b(linguistic)f
(re\015ection:)i(A)f(generator)h(tec)o(hnology)m(.)h(T)m(ec)o(h.)e
(Rep.)g(FIDE/92/49,)256 1985 y(ESPRIT)i(BRA)g(Pro)r(ject)h(3070)e
(FIDE,)g(1992.)171 2060 y([90])19 b Fa(Sterling,)g(L.,)h(and)g(Shapir)o
(o,)h(E.)28 b FH(The)17 b(A)o(rt)g(of)h(Pr)n(olo)n(g)p
FI(,)e(second)i(ed.)28 b(MIT)17 b(Press,)h(Cam)o(bridge,)256
2134 y(1994.)171 2209 y([91])h Fa(T)l(aha,)k(W.,)f(Benaissa,)g
(Z.-E.-A.,)f(and)h(Sheard,)h(T.)34 b FI(Multi-stage)18
b(programming:)d(Axioma-)256 2284 y(tization)i(and)h(t)o(yp)q(e-safet)o
(y)m(.)31 b(In)18 b FH(25th)h(International)f(Col)r(lo)n(quium)h(on)g
(A)o(utomata,)g(L)n(anguages,)g(and)256 2358 y(Pr)n(o)n(gr)n(amming)14
b FI(\(Aalb)q(org,)9 b(July)i(1998\),)e(v)o(ol.)g(1443)h(of)g
FH(L)n(e)n(ctur)n(e)h(Notes)h(in)g(Computer)g(Scienc)n(e)p
FI(,)f(pp.)f(918{)256 2433 y(929.)171 2508 y([92])19
b Fa(T)l(aha,)14 b(W.,)f(and)g(Hook,)h(J.)f FI(The)f(anatom)o(y)c(of)i
(a)h(comp)q(onen)o(t)f(generation)h(system.)i(In)e FH(International)256
2583 y(Workshop)16 b(on)f(the)g(Principles)f(of)h(Softwar)n(e)f
(Evolution)k FI(\(Ky)o(oto,)13 b(Apr.)h(1998\).)p eop
%%Page: 169 180
169 179 bop 1862 0 a FB(169)171 192 y FI([93])19 b Fa(T)l(aha,)g(W.,)e
(and)h(Sheard,)h(T.)j FI(F)m(acets)16 b(of)f(m)o(ulti-stage)e
(computation)g(in)i(soft)o(w)o(are)g(arc)o(hitectures.)256
266 y(T)m(ec)o(h.)f(Rep.)f(CSE-97-010,)f(Oregon)j(Graduate)f
(Institute,)g(1997.)j(Av)n(ailable)12 b(from)g([66].)171
341 y([94])19 b Fa(T)l(aha,)13 b(W.,)e(and)h(Sheard,)g(T.)f
FI(Multi-stage)e(programming)d(with)j(explicit)g(annotations.)h(In)f
FH(Pr)n(o)n(c)n(e)n(e)n(d-)256 416 y(ings)16 b(of)g(the)f(A)o
(CM-SIGPLAN)h(Symp)n(osium)h(on)f(Partial)f(Evaluation)h(and)h
(semantic)f(b)n(ase)n(d)g(pr)n(o)n(gr)n(am)256 490 y(manipulations)g
(PEPM'97,)g(A)o(mster)n(dam)h FI(\(1997\),)c(A)o(CM,)h(pp.)g(203{217.)j
(An)e(extended)h(and)e(revised)256 565 y(v)o(ersion)g(app)q(ears)h(in)e
([95].)171 640 y([95])19 b Fa(T)l(aha,)d(W.,)e(and)g(Sheard,)i(T.)f
FI(MetaML:)d(Multi-stage)g(programming)d(with)i(explicit)h
(annotations.)256 715 y FH(The)n(or)n(etic)n(al)i(Computer)g(Scienc)n
(e)i(248)p FI(,)e(1-2)f(\(In)h(Press\).)171 789 y([96])19
b Fa(T)l(akahashi,)k(M.)33 b FI(P)o(arallel)17 b(reductions)j(in)e
FF(\025)p FI(-calculus.)32 b FH(Information)19 b(and)h(Computation)g
(118)p FI(,)e(1)256 864 y(\(Apr.)c(1995\),)f(120{127.)171
939 y([97])19 b Fa(Veldhuizen,)c(T.)e(L.)j FI(C++)c(templates)g(as)g
(partial)e(ev)n(aluation.)k(In)e FH(A)o(CM)g(SIGPLAN)i(Workshop)f(on)
256 1013 y(Partial)k(Evaluation)g(and)h(Semantics-Base)n(d)h(Pr)n(o)n
(gr)n(am)d(Manipulation)21 b FI(\(San)16 b(An)o(tonio,)f(Jan.)h
(1999\),)256 1088 y(O.)e(Dan)o(vy)m(,)e(Ed.,)h(Univ)o(ersit)o(y)h(of)f
(Aarh)o(us,)h(Dept.)g(of)f(Computer)g(Science,)i(pp.)e(13{18.)171
1163 y([98])19 b Fa(W)-5 b(adler,)15 b(P.,)g(T)l(aha,)h(W.,)e(and)h(Ma)
o(cQueen,)h(D.)f(B.)h FI(Ho)o(w)d(to)f(add)g(laziness)h(to)f(a)h
(strict)g(language)256 1238 y(withouth)j(ev)o(en)i(b)q(eing)f(o)q(dd.)
26 b(In)17 b FH(Pr)n(o)n(c)n(e)n(e)n(dings)g(of)h(the)f(1998)h(A)o(CM)g
(Workshop)g(on)g(ML)f FI(\(Baltimore,)256 1312 y(Sept.)d(1998\),)f(pp.)
g(24{30.)171 1387 y([99])19 b Fa(W)-5 b(and,)23 b(M.)35
b FI(The)20 b(theory)g(of)f(fexprs)h(is)g(trivial.)33
b FH(Lisp)20 b(and)h(Symb)n(olic)f(Computation)h(10)k
FI(\(1998\),)256 1462 y(189{199.)150 1536 y([100])19
b Fa(W)-5 b(and,)21 b(M.,)e(and)i(Friedman,)e(D.)h(P.)29
b FI(The)18 b(m)o(ystery)f(of)f(the)i(to)o(w)o(er)g(rev)o(ealed:)f(A)h
(non-re\015ectiv)o(e)256 1611 y(description)d(of)e(the)i(re\015ectiv)o
(e)h(to)o(w)o(er.)j(In)14 b FH(Meta-L)n(evel)h(A)o(r)n(chite)n(ctur)n
(es)f(and)i(R)n(e\015e)n(ction)p FI(,)e(P)m(.)f(Maes)i(and)256
1686 y(D.)e(Nardi,)g(Eds.)h(Elsevier)h(Science,)g(1988,)d(pp.)i
(111{134.)150 1761 y([101])19 b Fa(Whitehead,)k(A.)e(N.,)h(and)h(R)o
(ussell,)g(B.)36 b FH(Principia)20 b(Mathematic)n(a)p
FI(.)35 b(Cam)o(bridge)18 b(Univ)o(ersit)o(y)256 1835
y(Press,)d(Cam)o(bridge,)d(1925.)150 1910 y([102])19
b Fa(Wickline,)h(P.,)g(Lee,)g(P.,)g(and)h(Pfenning,)f(F.)30
b FI(Run-time)16 b(co)q(de)i(generation)g(and)f(Mo)q(dal-ML.)256
1985 y(In)c FH(Pr)n(o)n(c)n(e)n(e)n(dings)g(of)h(the)f(A)o(CM)h
(SIGPLAN'98)g(Confer)n(enc)n(e)f(on)h(Pr)n(o)n(gr)n(amming)f(L)n
(anguage)i(Design)f(and)256 2060 y(Implementation)h(\(PLDI\))h
FI(\(Mon)o(treal,)d(June)i(1998\),)e(pp.)g(224{235.)150
2134 y([103])19 b Fa(Winskel,)g(G.)24 b FH(The)17 b(F)m(ormal)e
(Semantics)i(of)g(Pr)n(o)n(gr)n(amming)f(L)n(anguages:)h(A)o(n)g(Intr)n
(o)n(duction.)24 b FI(F)m(oun-)256 2209 y(dations)14
b(of)f(Computing)f(series.)i(MIT)g(Press,)h(F)m(eb.)f(1993.)150
2284 y([104])19 b Fa(Wright,)13 b(A.)g(K.,)h(and)h(Felleisen,)f(M.)h
FI(A)d(syn)o(tactic)g(approac)o(h)g(to)g(t)o(yp)q(e)g(soundness.)k
FH(Information)256 2358 y(and)g(Computation)f(115)p FI(,)f(1)g(\(No)o
(v.)f(1994\),)f(38{94.)p eop
%%Page: 170 181
170 180 bop 650 436 a FL(Biographical)36 b(Note)150 685
y FI(W)m(alid)16 b(T)m(aha)h(w)o(as)h(b)q(orn)g(on)g(April)g(17th,)f
(1972,)f(in)i(T)m(an)o(ta,)f(Egypt.)g(He)i(sp)q(en)o(t)g(the)g(sc)o(ho)
q(ol)f(y)o(ear)g(1985/86)150 760 y(attending)d(Corv)n(allis)e(High-Sc)o
(ho)q(ol,)h(Corv)n(allis,)f(Oregon.)i(He)h(completed)e(the)i(Oxford)f
(Univ)o(ersit)o(y)g(General)150 835 y(Certi\014cate)j(of)e(Education)h
(Ordinary)g(lev)o(el)g(examinations)e(at)i(Ku)o(w)o(ait)f(English)h(Sc)
o(ho)q(ol,)f(Salw)o(a,)f(Ku)o(w)o(ait,)150 909 y(in)f(1987.)g(W)m(alid)
f(w)o(en)o(t)i(o\013)g(to)g(study)g(what)g(w)o(as)g(at)g(\014rst)g(Mec)
o(hanical)g(Engineering,)g(then)g(Electrical)h(Engi-)150
984 y(neering,)e(then)h(ev)o(en)o(tually)f(Computer)g(Engineering,)f
(at)i(Ku)o(w)o(ait)e(Univ)o(ersit)o(y)m(.)h(During)f(his)h(college)g
(studies,)150 1059 y(he)19 b(in)o(terned)h(a)f(n)o(um)o(b)q(er)f(of)g
(times)g(at)h(Asea)h(Bro)o(wn)f(Bo)o(v)o(eri,)f(Baden,)h(Switzerland,)g
(under)h(the)f(sup)q(ervi-)150 1134 y(sion)d(of)g(Dr.)g(Karl)g(Imhof.)e
(A)o(t)j(Ku)o(w)o(ait)f(Univ)o(ersit)o(y)m(,)f(Prof.)h(Manso)q(or)h
(Sarw)o(ar's)f(Programming)d(Languages)150 1208 y(course)j(in)o(tro)q
(duced)g(W)m(alid)e(to)h(functional)f(programmi)o(ng.)e(Because)17
b(of)d(the)i(Arabian)f(Gulf)f(con\015ict,)h(a)g(one)150
1283 y(w)o(eek)f(v)n(acation)f(turned)h(in)o(to)f(a)g(sc)o(ho)q(ol)g(y)
o(ear)h(at)f(the)h(Univ)o(ersit)o(y)g(of)f(Alexandria,)f(and)h(t)o(w)o
(o)g(in)o(ternships)i(\(one)150 1358 y(with)i(Sc)o(hlum)o(b)q(erger)h
(in)f(Alexandria,)g(Egypt,)g(and)h(Linz,)f(Austria,)h(and)g(one)g(with)
f(Asea)h(Bro)o(wn)g(Bo)o(v)o(eri,)150 1432 y(Baden,)h(Switzerland\).)g
(Ev)o(en)o(tually)m(,)e(W)m(alid)f(meandered)j(bac)o(k)g(to)f(Ku)o(w)o
(ait)h(Univ)o(ersit)o(y)f(and)h(\014nished)g(his)150
1507 y(senior)14 b(pro)r(ject)i(on)d(compiling)f(LISP)i(to)g(P)o
(ascal,)f(and)h(completed)g(the)g(Bac)o(helors)h(of)f(Science)h(in)f
(Computer)150 1582 y(Science)h(and)f(Engineering)g(in)f(1993.)150
1665 y(After)20 b(graduation,)e(W)m(alid)f(sp)q(en)o(t)j(t)o(w)o(o)f
(mon)o(ths)f(at)h(the)h(G\177)-21 b(othe)19 b(Institut,)g(Bremen,)g
(German)o(y)m(,)e(studying)150 1740 y(German)9 b(on)h(a)f(sc)o
(holarship)h(from)f(the)h(German)f(go)o(v)o(ernmen)o(t.)f(He)j(then)g
(returned)h(to)d(Ku)o(w)o(ait)h(to)g(con)o(template)150
1814 y(the)17 b(future.)g(When)g(he)h(got)e(tired,)h(he)g(joined)f(the)
i(Masters)g(program)d(in)h(Electrical)h(Engineering)g(for)g(one)150
1889 y(semester,)c(and)g(then)g(w)o(ork)o(ed)g(as)g(a)f(Soft)o(w)o(are)
h(Engineer)g(at)g(the)g(O\016ce)h(of)e(the)h(Vice)g(Presiden)o(t)i(for)
d(Planning)150 1964 y(A\013airs)i(at)g(Ku)o(w)o(ait)f(Univ)o(ersit)o(y)
m(.)150 2047 y(During)f(this)h(y)o(ear,)f(Prof.)g(Khalid)g(Al-Saqabi)f
(of)h(Ku)o(w)o(ait)h(Univ)o(ersit)o(y)f(w)o(as)h(on)f(sabbatical)g(at)h
(some)f(\\Oregon)150 2122 y(Graduate)k(Institute".)g(Prof.)f(Khalid)g
(w)o(as)h(ob)o(viously)e(ha)o(ving)h(to)q(o)h(m)o(uc)o(h)e(fun)i(at)g
(OGI,)f(and)h(insisted)g(that)150 2196 y(W)m(alid)c(apply)h(there)i
(for)f(the)g(PhD)g(program.)e(And)i(so)g(he)g(did.)150
2279 y(A)o(t)f(OGI,)g(Prof.)g(Da)o(vid)f(Maier)h(made)f(math)g(lo)q(ok)
g(in)o(teresting)i(again.)d(Prof.)i(James)g(Ho)q(ok)g(lured)g(W)m(alid)
f(in)o(to)150 2354 y(sp)q(ending)18 b(the)f(next)h(four)f(y)o(ears)g
(of)g(his)g(life)f(w)o(orking)g(on)h(seman)o(tics)g(in)g(P)o(acSoft.)f
(W)m(alid's)f(advisor,)i(Prof.)150 2429 y(Tim)12 b(Sheard,)i(w)o(as)g
(starting)g(to)f(w)o(ork)h(on)g(a)f(most)g(in)o(triguing)f(creature)k
(called)e(MetaML.)150 2512 y(During)e(his)h(Do)q(ctoral)f(studies)i(at)
f(the)g(Oregon)g(Graduate)g(Institute,)g(Bea)o(v)o(erton,)g(Oregon,)g
(W)m(alid)e(in)o(terned)150 2587 y(for)g(four)f(mon)o(ths)g(at)h(Lucen)
o(t)h(Bell)e(Lab)q(oratories,)h(Murry)g(Hill,)e(New)j(Jersey)m(,)g(w)o
(orking)e(with)g(Dr.)g(Phil)h(W)m(adler)150 2661 y(on)j(implem)o(en)o
(ting)d(W)m(adler's)i(prop)q(osal)h(for)f(lazy)h(ML)f(datat)o(yp)q(es.)
1004 2795 y(170)p eop
%%Page: 171 182
171 181 bop 1862 0 a FB(171)150 192 y FI(Curren)o(tly)m(,)16
b(W)m(alid)e(is)i(a)g(P)o(ost-do)q(ctoral)h(F)m(ello)o(w)e(at)h(the)h
(Departmen)o(t)e(of)h(Computing)e(Sciences,)k(Chalmers)150
266 y(Univ)o(ersit)o(y)c(of)f(T)m(ec)o(hnology)m(,)f(Gothen)o(b)q(org,)
h(Sw)o(eden.)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
